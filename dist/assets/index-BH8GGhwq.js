var sK=Object.defineProperty;var lK=(e,t,n)=>t in e?sK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Er=(e,t,n)=>lK(e,typeof t!="symbol"?t+"":t,n);function K4(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in e)){const d=Object.getOwnPropertyDescriptor(i,s);d&&Object.defineProperty(e,s,d.get?d:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const d of s)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(s){const d={};return s.integrity&&(d.integrity=s.integrity),s.referrerPolicy&&(d.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?d.credentials="include":s.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(s){if(s.ep)return;s.ep=!0;const d=n(s);fetch(s.href,d)}})();var cK=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var X4={exports:{}},PC={},Z4={exports:{}},io={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=Symbol.for("react.element"),uK=Symbol.for("react.portal"),dK=Symbol.for("react.fragment"),hK=Symbol.for("react.strict_mode"),fK=Symbol.for("react.profiler"),pK=Symbol.for("react.provider"),mK=Symbol.for("react.context"),gK=Symbol.for("react.forward_ref"),vK=Symbol.for("react.suspense"),_K=Symbol.for("react.memo"),yK=Symbol.for("react.lazy"),VF=Symbol.iterator;function xK(e){return e===null||typeof e!="object"?null:(e=VF&&e[VF]||e["@@iterator"],typeof e=="function"?e:null)}var Y4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J4=Object.assign,Q4={};function Vv(e,t,n){this.props=e,this.context=t,this.refs=Q4,this.updater=n||Y4}Vv.prototype.isReactComponent={};Vv.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Vv.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ej(){}ej.prototype=Vv.prototype;function fA(e,t,n){this.props=e,this.context=t,this.refs=Q4,this.updater=n||Y4}var pA=fA.prototype=new ej;pA.constructor=fA;J4(pA,Vv.prototype);pA.isPureReactComponent=!0;var UF=Array.isArray,tj=Object.prototype.hasOwnProperty,mA={current:null},nj={key:!0,ref:!0,__self:!0,__source:!0};function rj(e,t,n){var i,s={},d=null,f=null;if(t!=null)for(i in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(d=""+t.key),t)tj.call(t,i)&&!nj.hasOwnProperty(i)&&(s[i]=t[i]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var y=Array(o),b=0;b<o;b++)y[b]=arguments[b+2];s.children=y}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)s[i]===void 0&&(s[i]=o[i]);return{$$typeof:Wx,type:e,key:d,ref:f,props:s,_owner:mA.current}}function bK(e,t){return{$$typeof:Wx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function gA(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wx}function wK(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var HF=/\/+/g;function Q2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wK(""+e.key):t.toString(36)}function Zw(e,t,n,i,s){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(d){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case Wx:case uK:f=!0}}if(f)return f=e,s=s(f),e=i===""?"."+Q2(f,0):i,UF(s)?(n="",e!=null&&(n=e.replace(HF,"$&/")+"/"),Zw(s,t,n,"",function(b){return b})):s!=null&&(gA(s)&&(s=bK(s,n+(!s.key||f&&f.key===s.key?"":(""+s.key).replace(HF,"$&/")+"/")+e)),t.push(s)),1;if(f=0,i=i===""?".":i+":",UF(e))for(var o=0;o<e.length;o++){d=e[o];var y=i+Q2(d,o);f+=Zw(d,t,n,y,s)}else if(y=xK(e),typeof y=="function")for(e=y.call(e),o=0;!(d=e.next()).done;)d=d.value,y=i+Q2(d,o++),f+=Zw(d,t,n,y,s);else if(d==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function aw(e,t,n){if(e==null)return e;var i=[],s=0;return Zw(e,i,"","",function(d){return t.call(n,d,s++)}),i}function SK(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ul={current:null},Yw={transition:null},CK={ReactCurrentDispatcher:ul,ReactCurrentBatchConfig:Yw,ReactCurrentOwner:mA};function ij(){throw Error("act(...) is not supported in production builds of React.")}io.Children={map:aw,forEach:function(e,t,n){aw(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return aw(e,function(){t++}),t},toArray:function(e){return aw(e,function(t){return t})||[]},only:function(e){if(!gA(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};io.Component=Vv;io.Fragment=dK;io.Profiler=fK;io.PureComponent=fA;io.StrictMode=hK;io.Suspense=vK;io.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CK;io.act=ij;io.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=J4({},e.props),s=e.key,d=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(d=t.ref,f=mA.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(y in t)tj.call(t,y)&&!nj.hasOwnProperty(y)&&(i[y]=t[y]===void 0&&o!==void 0?o[y]:t[y])}var y=arguments.length-2;if(y===1)i.children=n;else if(1<y){o=Array(y);for(var b=0;b<y;b++)o[b]=arguments[b+2];i.children=o}return{$$typeof:Wx,type:e.type,key:s,ref:d,props:i,_owner:f}};io.createContext=function(e){return e={$$typeof:mK,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pK,_context:e},e.Consumer=e};io.createElement=rj;io.createFactory=function(e){var t=rj.bind(null,e);return t.type=e,t};io.createRef=function(){return{current:null}};io.forwardRef=function(e){return{$$typeof:gK,render:e}};io.isValidElement=gA;io.lazy=function(e){return{$$typeof:yK,_payload:{_status:-1,_result:e},_init:SK}};io.memo=function(e,t){return{$$typeof:_K,type:e,compare:t===void 0?null:t}};io.startTransition=function(e){var t=Yw.transition;Yw.transition={};try{e()}finally{Yw.transition=t}};io.unstable_act=ij;io.useCallback=function(e,t){return ul.current.useCallback(e,t)};io.useContext=function(e){return ul.current.useContext(e)};io.useDebugValue=function(){};io.useDeferredValue=function(e){return ul.current.useDeferredValue(e)};io.useEffect=function(e,t){return ul.current.useEffect(e,t)};io.useId=function(){return ul.current.useId()};io.useImperativeHandle=function(e,t,n){return ul.current.useImperativeHandle(e,t,n)};io.useInsertionEffect=function(e,t){return ul.current.useInsertionEffect(e,t)};io.useLayoutEffect=function(e,t){return ul.current.useLayoutEffect(e,t)};io.useMemo=function(e,t){return ul.current.useMemo(e,t)};io.useReducer=function(e,t,n){return ul.current.useReducer(e,t,n)};io.useRef=function(e){return ul.current.useRef(e)};io.useState=function(e){return ul.current.useState(e)};io.useSyncExternalStore=function(e,t,n){return ul.current.useSyncExternalStore(e,t,n)};io.useTransition=function(){return ul.current.useTransition()};io.version="18.3.1";Z4.exports=io;var I=Z4.exports;const Wt=jv(I),qx=K4({__proto__:null,default:Wt},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EK=I,TK=Symbol.for("react.element"),IK=Symbol.for("react.fragment"),PK=Object.prototype.hasOwnProperty,MK=EK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RK={key:!0,ref:!0,__self:!0,__source:!0};function oj(e,t,n){var i,s={},d=null,f=null;n!==void 0&&(d=""+n),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(f=t.ref);for(i in t)PK.call(t,i)&&!RK.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)s[i]===void 0&&(s[i]=t[i]);return{$$typeof:TK,type:e,key:d,ref:f,props:s,_owner:MK.current}}PC.Fragment=IK;PC.jsx=oj;PC.jsxs=oj;X4.exports=PC;var Ee=X4.exports,aj={exports:{}},Kl={},sj={exports:{}},lj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ze,Ue){var We=ze.length;ze.push(Ue);e:for(;0<We;){var Be=We-1>>>1,Xe=ze[Be];if(0<s(Xe,Ue))ze[Be]=Ue,ze[We]=Xe,We=Be;else break e}}function n(ze){return ze.length===0?null:ze[0]}function i(ze){if(ze.length===0)return null;var Ue=ze[0],We=ze.pop();if(We!==Ue){ze[0]=We;e:for(var Be=0,Xe=ze.length,qe=Xe>>>1;Be<qe;){var at=2*(Be+1)-1,Ke=ze[at],tt=at+1,vt=ze[tt];if(0>s(Ke,We))tt<Xe&&0>s(vt,Ke)?(ze[Be]=vt,ze[tt]=We,Be=tt):(ze[Be]=Ke,ze[at]=We,Be=at);else if(tt<Xe&&0>s(vt,We))ze[Be]=vt,ze[tt]=We,Be=tt;else break e}}return Ue}function s(ze,Ue){var We=ze.sortIndex-Ue.sortIndex;return We!==0?We:ze.id-Ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var f=Date,o=f.now();e.unstable_now=function(){return f.now()-o}}var y=[],b=[],C=1,P=null,A=3,D=!1,k=!1,B=!1,N=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function K(ze){for(var Ue=n(b);Ue!==null;){if(Ue.callback===null)i(b);else if(Ue.startTime<=ze)i(b),Ue.sortIndex=Ue.expirationTime,t(y,Ue);else break;Ue=n(b)}}function Y(ze){if(B=!1,K(ze),!k)if(n(y)!==null)k=!0,xe(Z);else{var Ue=n(b);Ue!==null&&Te(Y,Ue.startTime-ze)}}function Z(ze,Ue){k=!1,B&&(B=!1,j(se),se=-1),D=!0;var We=A;try{for(K(Ue),P=n(y);P!==null&&(!(P.expirationTime>Ue)||ze&&!fe());){var Be=P.callback;if(typeof Be=="function"){P.callback=null,A=P.priorityLevel;var Xe=Be(P.expirationTime<=Ue);Ue=e.unstable_now(),typeof Xe=="function"?P.callback=Xe:P===n(y)&&i(y),K(Ue)}else i(y);P=n(y)}if(P!==null)var qe=!0;else{var at=n(b);at!==null&&Te(Y,at.startTime-Ue),qe=!1}return qe}finally{P=null,A=We,D=!1}}var te=!1,ne=null,se=-1,ee=5,de=-1;function fe(){return!(e.unstable_now()-de<ee)}function ye(){if(ne!==null){var ze=e.unstable_now();de=ze;var Ue=!0;try{Ue=ne(!0,ze)}finally{Ue?ge():(te=!1,ne=null)}}else te=!1}var ge;if(typeof V=="function")ge=function(){V(ye)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,Se=we.port2;we.port1.onmessage=ye,ge=function(){Se.postMessage(null)}}else ge=function(){N(ye,0)};function xe(ze){ne=ze,te||(te=!0,ge())}function Te(ze,Ue){se=N(function(){ze(e.unstable_now())},Ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ze){ze.callback=null},e.unstable_continueExecution=function(){k||D||(k=!0,xe(Z))},e.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<ze?Math.floor(1e3/ze):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return n(y)},e.unstable_next=function(ze){switch(A){case 1:case 2:case 3:var Ue=3;break;default:Ue=A}var We=A;A=Ue;try{return ze()}finally{A=We}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ze,Ue){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var We=A;A=ze;try{return Ue()}finally{A=We}},e.unstable_scheduleCallback=function(ze,Ue,We){var Be=e.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?Be+We:Be):We=Be,ze){case 1:var Xe=-1;break;case 2:Xe=250;break;case 5:Xe=1073741823;break;case 4:Xe=1e4;break;default:Xe=5e3}return Xe=We+Xe,ze={id:C++,callback:Ue,priorityLevel:ze,startTime:We,expirationTime:Xe,sortIndex:-1},We>Be?(ze.sortIndex=We,t(b,ze),n(y)===null&&ze===n(b)&&(B?(j(se),se=-1):B=!0,Te(Y,We-Be))):(ze.sortIndex=Xe,t(y,ze),k||D||(k=!0,xe(Z))),ze},e.unstable_shouldYield=fe,e.unstable_wrapCallback=function(ze){var Ue=A;return function(){var We=A;A=Ue;try{return ze.apply(this,arguments)}finally{A=We}}}})(lj);sj.exports=lj;var AK=sj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OK=I,ql=AK;function sr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cj=new Set,ex={};function Qp(e,t){wv(e,t),wv(e+"Capture",t)}function wv(e,t){for(ex[e]=t,e=0;e<t.length;e++)cj.add(t[e])}var Dd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),RP=Object.prototype.hasOwnProperty,DK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,GF={},WF={};function LK(e){return RP.call(WF,e)?!0:RP.call(GF,e)?!1:DK.test(e)?WF[e]=!0:(GF[e]=!0,!1)}function zK(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kK(e,t,n,i){if(t===null||typeof t>"u"||zK(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dl(e,t,n,i,s,d,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=d,this.removeEmptyString=f}var ws={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ws[e]=new dl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ws[t]=new dl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ws[e]=new dl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ws[e]=new dl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ws[e]=new dl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ws[e]=new dl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ws[e]=new dl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ws[e]=new dl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ws[e]=new dl(e,5,!1,e.toLowerCase(),null,!1,!1)});var vA=/[\-:]([a-z])/g;function _A(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(vA,_A);ws[t]=new dl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(vA,_A);ws[t]=new dl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(vA,_A);ws[t]=new dl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ws[e]=new dl(e,1,!1,e.toLowerCase(),null,!1,!1)});ws.xlinkHref=new dl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ws[e]=new dl(e,1,!1,e.toLowerCase(),null,!0,!0)});function yA(e,t,n,i){var s=ws.hasOwnProperty(t)?ws[t]:null;(s!==null?s.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kK(t,n,s,i)&&(n=null),i||s===null?LK(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,i=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Nd=OK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sw=Symbol.for("react.element"),Kg=Symbol.for("react.portal"),Xg=Symbol.for("react.fragment"),xA=Symbol.for("react.strict_mode"),AP=Symbol.for("react.profiler"),uj=Symbol.for("react.provider"),dj=Symbol.for("react.context"),bA=Symbol.for("react.forward_ref"),OP=Symbol.for("react.suspense"),DP=Symbol.for("react.suspense_list"),wA=Symbol.for("react.memo"),zh=Symbol.for("react.lazy"),hj=Symbol.for("react.offscreen"),qF=Symbol.iterator;function n0(e){return e===null||typeof e!="object"?null:(e=qF&&e[qF]||e["@@iterator"],typeof e=="function"?e:null)}var Ta=Object.assign,eI;function w0(e){if(eI===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);eI=t&&t[1]||""}return`
`+eI+e}var tI=!1;function nI(e,t){if(!e||tI)return"";tI=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var i=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){i=b}e.call(t.prototype)}else{try{throw Error()}catch(b){i=b}e()}}catch(b){if(b&&i&&typeof b.stack=="string"){for(var s=b.stack.split(`
`),d=i.stack.split(`
`),f=s.length-1,o=d.length-1;1<=f&&0<=o&&s[f]!==d[o];)o--;for(;1<=f&&0<=o;f--,o--)if(s[f]!==d[o]){if(f!==1||o!==1)do if(f--,o--,0>o||s[f]!==d[o]){var y=`
`+s[f].replace(" at new "," at ");return e.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",e.displayName)),y}while(1<=f&&0<=o);break}}}finally{tI=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?w0(e):""}function FK(e){switch(e.tag){case 5:return w0(e.type);case 16:return w0("Lazy");case 13:return w0("Suspense");case 19:return w0("SuspenseList");case 0:case 2:case 15:return e=nI(e.type,!1),e;case 11:return e=nI(e.type.render,!1),e;case 1:return e=nI(e.type,!0),e;default:return""}}function LP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Xg:return"Fragment";case Kg:return"Portal";case AP:return"Profiler";case xA:return"StrictMode";case OP:return"Suspense";case DP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dj:return(e.displayName||"Context")+".Consumer";case uj:return(e._context.displayName||"Context")+".Provider";case bA:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case wA:return t=e.displayName||null,t!==null?t:LP(e.type)||"Memo";case zh:t=e._payload,e=e._init;try{return LP(e(t))}catch{}}return null}function NK(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return LP(t);case 8:return t===xA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function lf(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function BK(e){var t=fj(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,d=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(f){i=""+f,d.call(this,f)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(f){i=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function lw(e){e._valueTracker||(e._valueTracker=BK(e))}function pj(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=fj(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function RS(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zP(e,t){var n=t.checked;return Ta({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function KF(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=lf(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mj(e,t){t=t.checked,t!=null&&yA(e,"checked",t,!1)}function kP(e,t){mj(e,t);var n=lf(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?FP(e,t.type,n):t.hasOwnProperty("defaultValue")&&FP(e,t.type,lf(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function XF(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function FP(e,t,n){(t!=="number"||RS(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var S0=Array.isArray;function uv(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+lf(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,i&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function NP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(sr(91));return Ta({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ZF(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(sr(92));if(S0(n)){if(1<n.length)throw Error(sr(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:lf(n)}}function gj(e,t){var n=lf(t.value),i=lf(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function YF(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function vj(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function BP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?vj(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var cw,_j=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(cw=cw||document.createElement("div"),cw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=cw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function tx(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var z0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$K=["Webkit","ms","Moz","O"];Object.keys(z0).forEach(function(e){$K.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),z0[t]=z0[e]})});function yj(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||z0.hasOwnProperty(e)&&z0[e]?(""+t).trim():t+"px"}function xj(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,s=yj(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,s):e[n]=s}}var jK=Ta({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $P(e,t){if(t){if(jK[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(sr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(sr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(sr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(sr(62))}}function jP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var VP=null;function SA(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var UP=null,dv=null,hv=null;function JF(e){if(e=Zx(e)){if(typeof UP!="function")throw Error(sr(280));var t=e.stateNode;t&&(t=DC(t),UP(e.stateNode,e.type,t))}}function bj(e){dv?hv?hv.push(e):hv=[e]:dv=e}function wj(){if(dv){var e=dv,t=hv;if(hv=dv=null,JF(e),t)for(e=0;e<t.length;e++)JF(t[e])}}function Sj(e,t){return e(t)}function Cj(){}var rI=!1;function Ej(e,t,n){if(rI)return e(t,n);rI=!0;try{return Sj(e,t,n)}finally{rI=!1,(dv!==null||hv!==null)&&(Cj(),wj())}}function nx(e,t){var n=e.stateNode;if(n===null)return null;var i=DC(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(sr(231,t,typeof n));return n}var HP=!1;if(Dd)try{var r0={};Object.defineProperty(r0,"passive",{get:function(){HP=!0}}),window.addEventListener("test",r0,r0),window.removeEventListener("test",r0,r0)}catch{HP=!1}function VK(e,t,n,i,s,d,f,o,y){var b=Array.prototype.slice.call(arguments,3);try{t.apply(n,b)}catch(C){this.onError(C)}}var k0=!1,AS=null,OS=!1,GP=null,UK={onError:function(e){k0=!0,AS=e}};function HK(e,t,n,i,s,d,f,o,y){k0=!1,AS=null,VK.apply(UK,arguments)}function GK(e,t,n,i,s,d,f,o,y){if(HK.apply(this,arguments),k0){if(k0){var b=AS;k0=!1,AS=null}else throw Error(sr(198));OS||(OS=!0,GP=b)}}function em(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Tj(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function QF(e){if(em(e)!==e)throw Error(sr(188))}function WK(e){var t=e.alternate;if(!t){if(t=em(e),t===null)throw Error(sr(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(s===null)break;var d=s.alternate;if(d===null){if(i=s.return,i!==null){n=i;continue}break}if(s.child===d.child){for(d=s.child;d;){if(d===n)return QF(s),e;if(d===i)return QF(s),t;d=d.sibling}throw Error(sr(188))}if(n.return!==i.return)n=s,i=d;else{for(var f=!1,o=s.child;o;){if(o===n){f=!0,n=s,i=d;break}if(o===i){f=!0,i=s,n=d;break}o=o.sibling}if(!f){for(o=d.child;o;){if(o===n){f=!0,n=d,i=s;break}if(o===i){f=!0,i=d,n=s;break}o=o.sibling}if(!f)throw Error(sr(189))}}if(n.alternate!==i)throw Error(sr(190))}if(n.tag!==3)throw Error(sr(188));return n.stateNode.current===n?e:t}function Ij(e){return e=WK(e),e!==null?Pj(e):null}function Pj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Pj(e);if(t!==null)return t;e=e.sibling}return null}var Mj=ql.unstable_scheduleCallback,eN=ql.unstable_cancelCallback,qK=ql.unstable_shouldYield,KK=ql.unstable_requestPaint,Ba=ql.unstable_now,XK=ql.unstable_getCurrentPriorityLevel,CA=ql.unstable_ImmediatePriority,Rj=ql.unstable_UserBlockingPriority,DS=ql.unstable_NormalPriority,ZK=ql.unstable_LowPriority,Aj=ql.unstable_IdlePriority,MC=null,Ou=null;function YK(e){if(Ou&&typeof Ou.onCommitFiberRoot=="function")try{Ou.onCommitFiberRoot(MC,e,void 0,(e.current.flags&128)===128)}catch{}}var Gc=Math.clz32?Math.clz32:eX,JK=Math.log,QK=Math.LN2;function eX(e){return e>>>=0,e===0?32:31-(JK(e)/QK|0)|0}var uw=64,dw=4194304;function C0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function LS(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,s=e.suspendedLanes,d=e.pingedLanes,f=n&268435455;if(f!==0){var o=f&~s;o!==0?i=C0(o):(d&=f,d!==0&&(i=C0(d)))}else f=n&~s,f!==0?i=C0(f):d!==0&&(i=C0(d));if(i===0)return 0;if(t!==0&&t!==i&&!(t&s)&&(s=i&-i,d=t&-t,s>=d||s===16&&(d&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-Gc(t),s=1<<n,i|=e[n],t&=~s;return i}function tX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nX(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,d=e.pendingLanes;0<d;){var f=31-Gc(d),o=1<<f,y=s[f];y===-1?(!(o&n)||o&i)&&(s[f]=tX(o,t)):y<=t&&(e.expiredLanes|=o),d&=~o}}function WP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Oj(){var e=uw;return uw<<=1,!(uw&4194240)&&(uw=64),e}function iI(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Kx(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gc(t),e[t]=n}function rX(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Gc(n),d=1<<s;t[s]=0,i[s]=-1,e[s]=-1,n&=~d}}function EA(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Gc(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}var jo=0;function Dj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Lj,TA,zj,kj,Fj,qP=!1,hw=[],Jh=null,Qh=null,ef=null,rx=new Map,ix=new Map,Nh=[],iX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tN(e,t){switch(e){case"focusin":case"focusout":Jh=null;break;case"dragenter":case"dragleave":Qh=null;break;case"mouseover":case"mouseout":ef=null;break;case"pointerover":case"pointerout":rx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ix.delete(t.pointerId)}}function i0(e,t,n,i,s,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:d,targetContainers:[s]},t!==null&&(t=Zx(t),t!==null&&TA(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function oX(e,t,n,i,s){switch(t){case"focusin":return Jh=i0(Jh,e,t,n,i,s),!0;case"dragenter":return Qh=i0(Qh,e,t,n,i,s),!0;case"mouseover":return ef=i0(ef,e,t,n,i,s),!0;case"pointerover":var d=s.pointerId;return rx.set(d,i0(rx.get(d)||null,e,t,n,i,s)),!0;case"gotpointercapture":return d=s.pointerId,ix.set(d,i0(ix.get(d)||null,e,t,n,i,s)),!0}return!1}function Nj(e){var t=Ap(e.target);if(t!==null){var n=em(t);if(n!==null){if(t=n.tag,t===13){if(t=Tj(n),t!==null){e.blockedOn=t,Fj(e.priority,function(){zj(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jw(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=KP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);VP=i,n.target.dispatchEvent(i),VP=null}else return t=Zx(n),t!==null&&TA(t),e.blockedOn=n,!1;t.shift()}return!0}function nN(e,t,n){Jw(e)&&n.delete(t)}function aX(){qP=!1,Jh!==null&&Jw(Jh)&&(Jh=null),Qh!==null&&Jw(Qh)&&(Qh=null),ef!==null&&Jw(ef)&&(ef=null),rx.forEach(nN),ix.forEach(nN)}function o0(e,t){e.blockedOn===t&&(e.blockedOn=null,qP||(qP=!0,ql.unstable_scheduleCallback(ql.unstable_NormalPriority,aX)))}function ox(e){function t(s){return o0(s,e)}if(0<hw.length){o0(hw[0],e);for(var n=1;n<hw.length;n++){var i=hw[n];i.blockedOn===e&&(i.blockedOn=null)}}for(Jh!==null&&o0(Jh,e),Qh!==null&&o0(Qh,e),ef!==null&&o0(ef,e),rx.forEach(t),ix.forEach(t),n=0;n<Nh.length;n++)i=Nh[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Nh.length&&(n=Nh[0],n.blockedOn===null);)Nj(n),n.blockedOn===null&&Nh.shift()}var fv=Nd.ReactCurrentBatchConfig,zS=!0;function sX(e,t,n,i){var s=jo,d=fv.transition;fv.transition=null;try{jo=1,IA(e,t,n,i)}finally{jo=s,fv.transition=d}}function lX(e,t,n,i){var s=jo,d=fv.transition;fv.transition=null;try{jo=4,IA(e,t,n,i)}finally{jo=s,fv.transition=d}}function IA(e,t,n,i){if(zS){var s=KP(e,t,n,i);if(s===null)pI(e,t,i,kS,n),tN(e,i);else if(oX(s,e,t,n,i))i.stopPropagation();else if(tN(e,i),t&4&&-1<iX.indexOf(e)){for(;s!==null;){var d=Zx(s);if(d!==null&&Lj(d),d=KP(e,t,n,i),d===null&&pI(e,t,i,kS,n),d===s)break;s=d}s!==null&&i.stopPropagation()}else pI(e,t,i,null,n)}}var kS=null;function KP(e,t,n,i){if(kS=null,e=SA(i),e=Ap(e),e!==null)if(t=em(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Tj(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return kS=e,null}function Bj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XK()){case CA:return 1;case Rj:return 4;case DS:case ZK:return 16;case Aj:return 536870912;default:return 16}default:return 16}}var $h=null,PA=null,Qw=null;function $j(){if(Qw)return Qw;var e,t=PA,n=t.length,i,s="value"in $h?$h.value:$h.textContent,d=s.length;for(e=0;e<n&&t[e]===s[e];e++);var f=n-e;for(i=1;i<=f&&t[n-i]===s[d-i];i++);return Qw=s.slice(e,1<i?1-i:void 0)}function eS(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fw(){return!0}function rN(){return!1}function Xl(e){function t(n,i,s,d,f){this._reactName=n,this._targetInst=s,this.type=i,this.nativeEvent=d,this.target=f,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(d):d[o]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?fw:rN,this.isPropagationStopped=rN,this}return Ta(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fw)},persist:function(){},isPersistent:fw}),t}var Uv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},MA=Xl(Uv),Xx=Ta({},Uv,{view:0,detail:0}),cX=Xl(Xx),oI,aI,a0,RC=Ta({},Xx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RA,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==a0&&(a0&&e.type==="mousemove"?(oI=e.screenX-a0.screenX,aI=e.screenY-a0.screenY):aI=oI=0,a0=e),oI)},movementY:function(e){return"movementY"in e?e.movementY:aI}}),iN=Xl(RC),uX=Ta({},RC,{dataTransfer:0}),dX=Xl(uX),hX=Ta({},Xx,{relatedTarget:0}),sI=Xl(hX),fX=Ta({},Uv,{animationName:0,elapsedTime:0,pseudoElement:0}),pX=Xl(fX),mX=Ta({},Uv,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gX=Xl(mX),vX=Ta({},Uv,{data:0}),oN=Xl(vX),_X={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xX[e])?!!t[e]:!1}function RA(){return bX}var wX=Ta({},Xx,{key:function(e){if(e.key){var t=_X[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=eS(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RA,charCode:function(e){return e.type==="keypress"?eS(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?eS(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),SX=Xl(wX),CX=Ta({},RC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aN=Xl(CX),EX=Ta({},Xx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RA}),TX=Xl(EX),IX=Ta({},Uv,{propertyName:0,elapsedTime:0,pseudoElement:0}),PX=Xl(IX),MX=Ta({},RC,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),RX=Xl(MX),AX=[9,13,27,32],AA=Dd&&"CompositionEvent"in window,F0=null;Dd&&"documentMode"in document&&(F0=document.documentMode);var OX=Dd&&"TextEvent"in window&&!F0,jj=Dd&&(!AA||F0&&8<F0&&11>=F0),sN=" ",lN=!1;function Vj(e,t){switch(e){case"keyup":return AX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zg=!1;function DX(e,t){switch(e){case"compositionend":return Uj(t);case"keypress":return t.which!==32?null:(lN=!0,sN);case"textInput":return e=t.data,e===sN&&lN?null:e;default:return null}}function LX(e,t){if(Zg)return e==="compositionend"||!AA&&Vj(e,t)?(e=$j(),Qw=PA=$h=null,Zg=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jj&&t.locale!=="ko"?null:t.data;default:return null}}var zX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!zX[e.type]:t==="textarea"}function Hj(e,t,n,i){bj(i),t=FS(t,"onChange"),0<t.length&&(n=new MA("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var N0=null,ax=null;function kX(e){tV(e,0)}function AC(e){var t=Qg(e);if(pj(t))return e}function FX(e,t){if(e==="change")return t}var Gj=!1;if(Dd){var lI;if(Dd){var cI="oninput"in document;if(!cI){var uN=document.createElement("div");uN.setAttribute("oninput","return;"),cI=typeof uN.oninput=="function"}lI=cI}else lI=!1;Gj=lI&&(!document.documentMode||9<document.documentMode)}function dN(){N0&&(N0.detachEvent("onpropertychange",Wj),ax=N0=null)}function Wj(e){if(e.propertyName==="value"&&AC(ax)){var t=[];Hj(t,ax,e,SA(e)),Ej(kX,t)}}function NX(e,t,n){e==="focusin"?(dN(),N0=t,ax=n,N0.attachEvent("onpropertychange",Wj)):e==="focusout"&&dN()}function BX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return AC(ax)}function $X(e,t){if(e==="click")return AC(t)}function jX(e,t){if(e==="input"||e==="change")return AC(t)}function VX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zc=typeof Object.is=="function"?Object.is:VX;function sx(e,t){if(Zc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!RP.call(t,s)||!Zc(e[s],t[s]))return!1}return!0}function hN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fN(e,t){var n=hN(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hN(n)}}function qj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?qj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Kj(){for(var e=window,t=RS();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=RS(e.document)}return t}function OA(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function UX(e){var t=Kj(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&qj(n.ownerDocument.documentElement,n)){if(i!==null&&OA(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,d=Math.min(i.start,s);i=i.end===void 0?d:Math.min(i.end,s),!e.extend&&d>i&&(s=i,i=d,d=s),s=fN(n,d);var f=fN(n,i);s&&f&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),d>i?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var HX=Dd&&"documentMode"in document&&11>=document.documentMode,Yg=null,XP=null,B0=null,ZP=!1;function pN(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ZP||Yg==null||Yg!==RS(i)||(i=Yg,"selectionStart"in i&&OA(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),B0&&sx(B0,i)||(B0=i,i=FS(XP,"onSelect"),0<i.length&&(t=new MA("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Yg)))}function pw(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Jg={animationend:pw("Animation","AnimationEnd"),animationiteration:pw("Animation","AnimationIteration"),animationstart:pw("Animation","AnimationStart"),transitionend:pw("Transition","TransitionEnd")},uI={},Xj={};Dd&&(Xj=document.createElement("div").style,"AnimationEvent"in window||(delete Jg.animationend.animation,delete Jg.animationiteration.animation,delete Jg.animationstart.animation),"TransitionEvent"in window||delete Jg.transitionend.transition);function OC(e){if(uI[e])return uI[e];if(!Jg[e])return e;var t=Jg[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Xj)return uI[e]=t[n];return e}var Zj=OC("animationend"),Yj=OC("animationiteration"),Jj=OC("animationstart"),Qj=OC("transitionend"),eV=new Map,mN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _f(e,t){eV.set(e,t),Qp(t,[e])}for(var dI=0;dI<mN.length;dI++){var hI=mN[dI],GX=hI.toLowerCase(),WX=hI[0].toUpperCase()+hI.slice(1);_f(GX,"on"+WX)}_f(Zj,"onAnimationEnd");_f(Yj,"onAnimationIteration");_f(Jj,"onAnimationStart");_f("dblclick","onDoubleClick");_f("focusin","onFocus");_f("focusout","onBlur");_f(Qj,"onTransitionEnd");wv("onMouseEnter",["mouseout","mouseover"]);wv("onMouseLeave",["mouseout","mouseover"]);wv("onPointerEnter",["pointerout","pointerover"]);wv("onPointerLeave",["pointerout","pointerover"]);Qp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var E0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qX=new Set("cancel close invalid load scroll toggle".split(" ").concat(E0));function gN(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,GK(i,t,void 0,e),e.currentTarget=null}function tV(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var d=void 0;if(t)for(var f=i.length-1;0<=f;f--){var o=i[f],y=o.instance,b=o.currentTarget;if(o=o.listener,y!==d&&s.isPropagationStopped())break e;gN(s,o,b),d=y}else for(f=0;f<i.length;f++){if(o=i[f],y=o.instance,b=o.currentTarget,o=o.listener,y!==d&&s.isPropagationStopped())break e;gN(s,o,b),d=y}}}if(OS)throw e=GP,OS=!1,GP=null,e}function ua(e,t){var n=t[tM];n===void 0&&(n=t[tM]=new Set);var i=e+"__bubble";n.has(i)||(nV(t,e,2,!1),n.add(i))}function fI(e,t,n){var i=0;t&&(i|=4),nV(n,e,i,t)}var mw="_reactListening"+Math.random().toString(36).slice(2);function lx(e){if(!e[mw]){e[mw]=!0,cj.forEach(function(n){n!=="selectionchange"&&(qX.has(n)||fI(n,!1,e),fI(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mw]||(t[mw]=!0,fI("selectionchange",!1,t))}}function nV(e,t,n,i){switch(Bj(t)){case 1:var s=sX;break;case 4:s=lX;break;default:s=IA}n=s.bind(null,t,n,e),s=void 0,!HP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),i?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function pI(e,t,n,i,s){var d=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var f=i.tag;if(f===3||f===4){var o=i.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(f===4)for(f=i.return;f!==null;){var y=f.tag;if((y===3||y===4)&&(y=f.stateNode.containerInfo,y===s||y.nodeType===8&&y.parentNode===s))return;f=f.return}for(;o!==null;){if(f=Ap(o),f===null)return;if(y=f.tag,y===5||y===6){i=d=f;continue e}o=o.parentNode}}i=i.return}Ej(function(){var b=d,C=SA(n),P=[];e:{var A=eV.get(e);if(A!==void 0){var D=MA,k=e;switch(e){case"keypress":if(eS(n)===0)break e;case"keydown":case"keyup":D=SX;break;case"focusin":k="focus",D=sI;break;case"focusout":k="blur",D=sI;break;case"beforeblur":case"afterblur":D=sI;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=iN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=dX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=TX;break;case Zj:case Yj:case Jj:D=pX;break;case Qj:D=PX;break;case"scroll":D=cX;break;case"wheel":D=RX;break;case"copy":case"cut":case"paste":D=gX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=aN}var B=(t&4)!==0,N=!B&&e==="scroll",j=B?A!==null?A+"Capture":null:A;B=[];for(var V=b,K;V!==null;){K=V;var Y=K.stateNode;if(K.tag===5&&Y!==null&&(K=Y,j!==null&&(Y=nx(V,j),Y!=null&&B.push(cx(V,Y,K)))),N)break;V=V.return}0<B.length&&(A=new D(A,k,null,n,C),P.push({event:A,listeners:B}))}}if(!(t&7)){e:{if(A=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",A&&n!==VP&&(k=n.relatedTarget||n.fromElement)&&(Ap(k)||k[Ld]))break e;if((D||A)&&(A=C.window===C?C:(A=C.ownerDocument)?A.defaultView||A.parentWindow:window,D?(k=n.relatedTarget||n.toElement,D=b,k=k?Ap(k):null,k!==null&&(N=em(k),k!==N||k.tag!==5&&k.tag!==6)&&(k=null)):(D=null,k=b),D!==k)){if(B=iN,Y="onMouseLeave",j="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(B=aN,Y="onPointerLeave",j="onPointerEnter",V="pointer"),N=D==null?A:Qg(D),K=k==null?A:Qg(k),A=new B(Y,V+"leave",D,n,C),A.target=N,A.relatedTarget=K,Y=null,Ap(C)===b&&(B=new B(j,V+"enter",k,n,C),B.target=K,B.relatedTarget=N,Y=B),N=Y,D&&k)t:{for(B=D,j=k,V=0,K=B;K;K=Dg(K))V++;for(K=0,Y=j;Y;Y=Dg(Y))K++;for(;0<V-K;)B=Dg(B),V--;for(;0<K-V;)j=Dg(j),K--;for(;V--;){if(B===j||j!==null&&B===j.alternate)break t;B=Dg(B),j=Dg(j)}B=null}else B=null;D!==null&&vN(P,A,D,B,!1),k!==null&&N!==null&&vN(P,N,k,B,!0)}}e:{if(A=b?Qg(b):window,D=A.nodeName&&A.nodeName.toLowerCase(),D==="select"||D==="input"&&A.type==="file")var Z=FX;else if(cN(A))if(Gj)Z=jX;else{Z=BX;var te=NX}else(D=A.nodeName)&&D.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(Z=$X);if(Z&&(Z=Z(e,b))){Hj(P,Z,n,C);break e}te&&te(e,A,b),e==="focusout"&&(te=A._wrapperState)&&te.controlled&&A.type==="number"&&FP(A,"number",A.value)}switch(te=b?Qg(b):window,e){case"focusin":(cN(te)||te.contentEditable==="true")&&(Yg=te,XP=b,B0=null);break;case"focusout":B0=XP=Yg=null;break;case"mousedown":ZP=!0;break;case"contextmenu":case"mouseup":case"dragend":ZP=!1,pN(P,n,C);break;case"selectionchange":if(HX)break;case"keydown":case"keyup":pN(P,n,C)}var ne;if(AA)e:{switch(e){case"compositionstart":var se="onCompositionStart";break e;case"compositionend":se="onCompositionEnd";break e;case"compositionupdate":se="onCompositionUpdate";break e}se=void 0}else Zg?Vj(e,n)&&(se="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(se="onCompositionStart");se&&(jj&&n.locale!=="ko"&&(Zg||se!=="onCompositionStart"?se==="onCompositionEnd"&&Zg&&(ne=$j()):($h=C,PA="value"in $h?$h.value:$h.textContent,Zg=!0)),te=FS(b,se),0<te.length&&(se=new oN(se,e,null,n,C),P.push({event:se,listeners:te}),ne?se.data=ne:(ne=Uj(n),ne!==null&&(se.data=ne)))),(ne=OX?DX(e,n):LX(e,n))&&(b=FS(b,"onBeforeInput"),0<b.length&&(C=new oN("onBeforeInput","beforeinput",null,n,C),P.push({event:C,listeners:b}),C.data=ne))}tV(P,t)})}function cx(e,t,n){return{instance:e,listener:t,currentTarget:n}}function FS(e,t){for(var n=t+"Capture",i=[];e!==null;){var s=e,d=s.stateNode;s.tag===5&&d!==null&&(s=d,d=nx(e,n),d!=null&&i.unshift(cx(e,d,s)),d=nx(e,t),d!=null&&i.push(cx(e,d,s))),e=e.return}return i}function Dg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vN(e,t,n,i,s){for(var d=t._reactName,f=[];n!==null&&n!==i;){var o=n,y=o.alternate,b=o.stateNode;if(y!==null&&y===i)break;o.tag===5&&b!==null&&(o=b,s?(y=nx(n,d),y!=null&&f.unshift(cx(n,y,o))):s||(y=nx(n,d),y!=null&&f.push(cx(n,y,o)))),n=n.return}f.length!==0&&e.push({event:t,listeners:f})}var KX=/\r\n?/g,XX=/\u0000|\uFFFD/g;function _N(e){return(typeof e=="string"?e:""+e).replace(KX,`
`).replace(XX,"")}function gw(e,t,n){if(t=_N(t),_N(e)!==t&&n)throw Error(sr(425))}function NS(){}var YP=null,JP=null;function QP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var eM=typeof setTimeout=="function"?setTimeout:void 0,ZX=typeof clearTimeout=="function"?clearTimeout:void 0,yN=typeof Promise=="function"?Promise:void 0,YX=typeof queueMicrotask=="function"?queueMicrotask:typeof yN<"u"?function(e){return yN.resolve(null).then(e).catch(JX)}:eM;function JX(e){setTimeout(function(){throw e})}function mI(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(i===0){e.removeChild(s),ox(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=s}while(n);ox(t)}function tf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xN(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Hv=Math.random().toString(36).slice(2),Ru="__reactFiber$"+Hv,ux="__reactProps$"+Hv,Ld="__reactContainer$"+Hv,tM="__reactEvents$"+Hv,QX="__reactListeners$"+Hv,eZ="__reactHandles$"+Hv;function Ap(e){var t=e[Ru];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ld]||n[Ru]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=xN(e);e!==null;){if(n=e[Ru])return n;e=xN(e)}return t}e=n,n=e.parentNode}return null}function Zx(e){return e=e[Ru]||e[Ld],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qg(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(sr(33))}function DC(e){return e[ux]||null}var nM=[],ev=-1;function yf(e){return{current:e}}function da(e){0>ev||(e.current=nM[ev],nM[ev]=null,ev--)}function ia(e,t){ev++,nM[ev]=e.current,e.current=t}var cf={},Ns=yf(cf),Rl=yf(!1),Vp=cf;function Sv(e,t){var n=e.type.contextTypes;if(!n)return cf;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var s={},d;for(d in n)s[d]=t[d];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Al(e){return e=e.childContextTypes,e!=null}function BS(){da(Rl),da(Ns)}function bN(e,t,n){if(Ns.current!==cf)throw Error(sr(168));ia(Ns,t),ia(Rl,n)}function rV(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var s in i)if(!(s in t))throw Error(sr(108,NK(e)||"Unknown",s));return Ta({},n,i)}function $S(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||cf,Vp=Ns.current,ia(Ns,e),ia(Rl,Rl.current),!0}function wN(e,t,n){var i=e.stateNode;if(!i)throw Error(sr(169));n?(e=rV(e,t,Vp),i.__reactInternalMemoizedMergedChildContext=e,da(Rl),da(Ns),ia(Ns,e)):da(Rl),ia(Rl,n)}var Sd=null,LC=!1,gI=!1;function iV(e){Sd===null?Sd=[e]:Sd.push(e)}function tZ(e){LC=!0,iV(e)}function xf(){if(!gI&&Sd!==null){gI=!0;var e=0,t=jo;try{var n=Sd;for(jo=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Sd=null,LC=!1}catch(s){throw Sd!==null&&(Sd=Sd.slice(e+1)),Mj(CA,xf),s}finally{jo=t,gI=!1}}return null}var tv=[],nv=0,jS=null,VS=0,cc=[],uc=0,Up=null,Td=1,Id="";function Cp(e,t){tv[nv++]=VS,tv[nv++]=jS,jS=e,VS=t}function oV(e,t,n){cc[uc++]=Td,cc[uc++]=Id,cc[uc++]=Up,Up=e;var i=Td;e=Id;var s=32-Gc(i)-1;i&=~(1<<s),n+=1;var d=32-Gc(t)+s;if(30<d){var f=s-s%5;d=(i&(1<<f)-1).toString(32),i>>=f,s-=f,Td=1<<32-Gc(t)+s|n<<s|i,Id=d+e}else Td=1<<d|n<<s|i,Id=e}function DA(e){e.return!==null&&(Cp(e,1),oV(e,1,0))}function LA(e){for(;e===jS;)jS=tv[--nv],tv[nv]=null,VS=tv[--nv],tv[nv]=null;for(;e===Up;)Up=cc[--uc],cc[uc]=null,Id=cc[--uc],cc[uc]=null,Td=cc[--uc],cc[uc]=null}var Gl=null,Vl=null,ma=!1,Vc=null;function aV(e,t){var n=hc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function SN(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gl=e,Vl=tf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gl=e,Vl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Up!==null?{id:Td,overflow:Id}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hc(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gl=e,Vl=null,!0):!1;default:return!1}}function rM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function iM(e){if(ma){var t=Vl;if(t){var n=t;if(!SN(e,t)){if(rM(e))throw Error(sr(418));t=tf(n.nextSibling);var i=Gl;t&&SN(e,t)?aV(i,n):(e.flags=e.flags&-4097|2,ma=!1,Gl=e)}}else{if(rM(e))throw Error(sr(418));e.flags=e.flags&-4097|2,ma=!1,Gl=e}}}function CN(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gl=e}function vw(e){if(e!==Gl)return!1;if(!ma)return CN(e),ma=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!QP(e.type,e.memoizedProps)),t&&(t=Vl)){if(rM(e))throw sV(),Error(sr(418));for(;t;)aV(e,t),t=tf(t.nextSibling)}if(CN(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(sr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Vl=tf(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Vl=null}}else Vl=Gl?tf(e.stateNode.nextSibling):null;return!0}function sV(){for(var e=Vl;e;)e=tf(e.nextSibling)}function Cv(){Vl=Gl=null,ma=!1}function zA(e){Vc===null?Vc=[e]:Vc.push(e)}var nZ=Nd.ReactCurrentBatchConfig;function s0(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(sr(309));var i=n.stateNode}if(!i)throw Error(sr(147,e));var s=i,d=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===d?t.ref:(t=function(f){var o=s.refs;f===null?delete o[d]:o[d]=f},t._stringRef=d,t)}if(typeof e!="string")throw Error(sr(284));if(!n._owner)throw Error(sr(290,e))}return e}function _w(e,t){throw e=Object.prototype.toString.call(t),Error(sr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function EN(e){var t=e._init;return t(e._payload)}function lV(e){function t(j,V){if(e){var K=j.deletions;K===null?(j.deletions=[V],j.flags|=16):K.push(V)}}function n(j,V){if(!e)return null;for(;V!==null;)t(j,V),V=V.sibling;return null}function i(j,V){for(j=new Map;V!==null;)V.key!==null?j.set(V.key,V):j.set(V.index,V),V=V.sibling;return j}function s(j,V){return j=af(j,V),j.index=0,j.sibling=null,j}function d(j,V,K){return j.index=K,e?(K=j.alternate,K!==null?(K=K.index,K<V?(j.flags|=2,V):K):(j.flags|=2,V)):(j.flags|=1048576,V)}function f(j){return e&&j.alternate===null&&(j.flags|=2),j}function o(j,V,K,Y){return V===null||V.tag!==6?(V=SI(K,j.mode,Y),V.return=j,V):(V=s(V,K),V.return=j,V)}function y(j,V,K,Y){var Z=K.type;return Z===Xg?C(j,V,K.props.children,Y,K.key):V!==null&&(V.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===zh&&EN(Z)===V.type)?(Y=s(V,K.props),Y.ref=s0(j,V,K),Y.return=j,Y):(Y=sS(K.type,K.key,K.props,null,j.mode,Y),Y.ref=s0(j,V,K),Y.return=j,Y)}function b(j,V,K,Y){return V===null||V.tag!==4||V.stateNode.containerInfo!==K.containerInfo||V.stateNode.implementation!==K.implementation?(V=CI(K,j.mode,Y),V.return=j,V):(V=s(V,K.children||[]),V.return=j,V)}function C(j,V,K,Y,Z){return V===null||V.tag!==7?(V=Fp(K,j.mode,Y,Z),V.return=j,V):(V=s(V,K),V.return=j,V)}function P(j,V,K){if(typeof V=="string"&&V!==""||typeof V=="number")return V=SI(""+V,j.mode,K),V.return=j,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case sw:return K=sS(V.type,V.key,V.props,null,j.mode,K),K.ref=s0(j,null,V),K.return=j,K;case Kg:return V=CI(V,j.mode,K),V.return=j,V;case zh:var Y=V._init;return P(j,Y(V._payload),K)}if(S0(V)||n0(V))return V=Fp(V,j.mode,K,null),V.return=j,V;_w(j,V)}return null}function A(j,V,K,Y){var Z=V!==null?V.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return Z!==null?null:o(j,V,""+K,Y);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case sw:return K.key===Z?y(j,V,K,Y):null;case Kg:return K.key===Z?b(j,V,K,Y):null;case zh:return Z=K._init,A(j,V,Z(K._payload),Y)}if(S0(K)||n0(K))return Z!==null?null:C(j,V,K,Y,null);_w(j,K)}return null}function D(j,V,K,Y,Z){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return j=j.get(K)||null,o(V,j,""+Y,Z);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case sw:return j=j.get(Y.key===null?K:Y.key)||null,y(V,j,Y,Z);case Kg:return j=j.get(Y.key===null?K:Y.key)||null,b(V,j,Y,Z);case zh:var te=Y._init;return D(j,V,K,te(Y._payload),Z)}if(S0(Y)||n0(Y))return j=j.get(K)||null,C(V,j,Y,Z,null);_w(V,Y)}return null}function k(j,V,K,Y){for(var Z=null,te=null,ne=V,se=V=0,ee=null;ne!==null&&se<K.length;se++){ne.index>se?(ee=ne,ne=null):ee=ne.sibling;var de=A(j,ne,K[se],Y);if(de===null){ne===null&&(ne=ee);break}e&&ne&&de.alternate===null&&t(j,ne),V=d(de,V,se),te===null?Z=de:te.sibling=de,te=de,ne=ee}if(se===K.length)return n(j,ne),ma&&Cp(j,se),Z;if(ne===null){for(;se<K.length;se++)ne=P(j,K[se],Y),ne!==null&&(V=d(ne,V,se),te===null?Z=ne:te.sibling=ne,te=ne);return ma&&Cp(j,se),Z}for(ne=i(j,ne);se<K.length;se++)ee=D(ne,j,se,K[se],Y),ee!==null&&(e&&ee.alternate!==null&&ne.delete(ee.key===null?se:ee.key),V=d(ee,V,se),te===null?Z=ee:te.sibling=ee,te=ee);return e&&ne.forEach(function(fe){return t(j,fe)}),ma&&Cp(j,se),Z}function B(j,V,K,Y){var Z=n0(K);if(typeof Z!="function")throw Error(sr(150));if(K=Z.call(K),K==null)throw Error(sr(151));for(var te=Z=null,ne=V,se=V=0,ee=null,de=K.next();ne!==null&&!de.done;se++,de=K.next()){ne.index>se?(ee=ne,ne=null):ee=ne.sibling;var fe=A(j,ne,de.value,Y);if(fe===null){ne===null&&(ne=ee);break}e&&ne&&fe.alternate===null&&t(j,ne),V=d(fe,V,se),te===null?Z=fe:te.sibling=fe,te=fe,ne=ee}if(de.done)return n(j,ne),ma&&Cp(j,se),Z;if(ne===null){for(;!de.done;se++,de=K.next())de=P(j,de.value,Y),de!==null&&(V=d(de,V,se),te===null?Z=de:te.sibling=de,te=de);return ma&&Cp(j,se),Z}for(ne=i(j,ne);!de.done;se++,de=K.next())de=D(ne,j,se,de.value,Y),de!==null&&(e&&de.alternate!==null&&ne.delete(de.key===null?se:de.key),V=d(de,V,se),te===null?Z=de:te.sibling=de,te=de);return e&&ne.forEach(function(ye){return t(j,ye)}),ma&&Cp(j,se),Z}function N(j,V,K,Y){if(typeof K=="object"&&K!==null&&K.type===Xg&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case sw:e:{for(var Z=K.key,te=V;te!==null;){if(te.key===Z){if(Z=K.type,Z===Xg){if(te.tag===7){n(j,te.sibling),V=s(te,K.props.children),V.return=j,j=V;break e}}else if(te.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===zh&&EN(Z)===te.type){n(j,te.sibling),V=s(te,K.props),V.ref=s0(j,te,K),V.return=j,j=V;break e}n(j,te);break}else t(j,te);te=te.sibling}K.type===Xg?(V=Fp(K.props.children,j.mode,Y,K.key),V.return=j,j=V):(Y=sS(K.type,K.key,K.props,null,j.mode,Y),Y.ref=s0(j,V,K),Y.return=j,j=Y)}return f(j);case Kg:e:{for(te=K.key;V!==null;){if(V.key===te)if(V.tag===4&&V.stateNode.containerInfo===K.containerInfo&&V.stateNode.implementation===K.implementation){n(j,V.sibling),V=s(V,K.children||[]),V.return=j,j=V;break e}else{n(j,V);break}else t(j,V);V=V.sibling}V=CI(K,j.mode,Y),V.return=j,j=V}return f(j);case zh:return te=K._init,N(j,V,te(K._payload),Y)}if(S0(K))return k(j,V,K,Y);if(n0(K))return B(j,V,K,Y);_w(j,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,V!==null&&V.tag===6?(n(j,V.sibling),V=s(V,K),V.return=j,j=V):(n(j,V),V=SI(K,j.mode,Y),V.return=j,j=V),f(j)):n(j,V)}return N}var Ev=lV(!0),cV=lV(!1),US=yf(null),HS=null,rv=null,kA=null;function FA(){kA=rv=HS=null}function NA(e){var t=US.current;da(US),e._currentValue=t}function oM(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function pv(e,t){HS=e,kA=rv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ml=!0),e.firstContext=null)}function mc(e){var t=e._currentValue;if(kA!==e)if(e={context:e,memoizedValue:t,next:null},rv===null){if(HS===null)throw Error(sr(308));rv=e,HS.dependencies={lanes:0,firstContext:e}}else rv=rv.next=e;return t}var Op=null;function BA(e){Op===null?Op=[e]:Op.push(e)}function uV(e,t,n,i){var s=t.interleaved;return s===null?(n.next=n,BA(t)):(n.next=s.next,s.next=n),t.interleaved=n,zd(e,i)}function zd(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var kh=!1;function $A(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dV(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ad(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function nf(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Co&2){var s=i.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),i.pending=t,zd(e,n)}return s=i.interleaved,s===null?(t.next=t,BA(i)):(t.next=s.next,s.next=t),i.interleaved=t,zd(e,n)}function tS(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,EA(e,n)}}function TN(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var s=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};d===null?s=d=f:d=d.next=f,n=n.next}while(n!==null);d===null?s=d=t:d=d.next=t}else s=d=t;n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:d,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function GS(e,t,n,i){var s=e.updateQueue;kh=!1;var d=s.firstBaseUpdate,f=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var y=o,b=y.next;y.next=null,f===null?d=b:f.next=b,f=y;var C=e.alternate;C!==null&&(C=C.updateQueue,o=C.lastBaseUpdate,o!==f&&(o===null?C.firstBaseUpdate=b:o.next=b,C.lastBaseUpdate=y))}if(d!==null){var P=s.baseState;f=0,C=b=y=null,o=d;do{var A=o.lane,D=o.eventTime;if((i&A)===A){C!==null&&(C=C.next={eventTime:D,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var k=e,B=o;switch(A=t,D=n,B.tag){case 1:if(k=B.payload,typeof k=="function"){P=k.call(D,P,A);break e}P=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=B.payload,A=typeof k=="function"?k.call(D,P,A):k,A==null)break e;P=Ta({},P,A);break e;case 2:kh=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,A=s.effects,A===null?s.effects=[o]:A.push(o))}else D={eventTime:D,lane:A,tag:o.tag,payload:o.payload,callback:o.callback,next:null},C===null?(b=C=D,y=P):C=C.next=D,f|=A;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;A=o,o=A.next,A.next=null,s.lastBaseUpdate=A,s.shared.pending=null}}while(!0);if(C===null&&(y=P),s.baseState=y,s.firstBaseUpdate=b,s.lastBaseUpdate=C,t=s.shared.interleaved,t!==null){s=t;do f|=s.lane,s=s.next;while(s!==t)}else d===null&&(s.shared.lanes=0);Gp|=f,e.lanes=f,e.memoizedState=P}}function IN(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],s=i.callback;if(s!==null){if(i.callback=null,i=n,typeof s!="function")throw Error(sr(191,s));s.call(i)}}}var Yx={},Du=yf(Yx),dx=yf(Yx),hx=yf(Yx);function Dp(e){if(e===Yx)throw Error(sr(174));return e}function jA(e,t){switch(ia(hx,t),ia(dx,e),ia(Du,Yx),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:BP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=BP(t,e)}da(Du),ia(Du,t)}function Tv(){da(Du),da(dx),da(hx)}function hV(e){Dp(hx.current);var t=Dp(Du.current),n=BP(t,e.type);t!==n&&(ia(dx,e),ia(Du,n))}function VA(e){dx.current===e&&(da(Du),da(dx))}var Ca=yf(0);function WS(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vI=[];function UA(){for(var e=0;e<vI.length;e++)vI[e]._workInProgressVersionPrimary=null;vI.length=0}var nS=Nd.ReactCurrentDispatcher,_I=Nd.ReactCurrentBatchConfig,Hp=0,Ea=null,ts=null,ds=null,qS=!1,$0=!1,fx=0,rZ=0;function Ms(){throw Error(sr(321))}function HA(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zc(e[n],t[n]))return!1;return!0}function GA(e,t,n,i,s,d){if(Hp=d,Ea=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nS.current=e===null||e.memoizedState===null?sZ:lZ,e=n(i,s),$0){d=0;do{if($0=!1,fx=0,25<=d)throw Error(sr(301));d+=1,ds=ts=null,t.updateQueue=null,nS.current=cZ,e=n(i,s)}while($0)}if(nS.current=KS,t=ts!==null&&ts.next!==null,Hp=0,ds=ts=Ea=null,qS=!1,t)throw Error(sr(300));return e}function WA(){var e=fx!==0;return fx=0,e}function Tu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ds===null?Ea.memoizedState=ds=e:ds=ds.next=e,ds}function gc(){if(ts===null){var e=Ea.alternate;e=e!==null?e.memoizedState:null}else e=ts.next;var t=ds===null?Ea.memoizedState:ds.next;if(t!==null)ds=t,ts=e;else{if(e===null)throw Error(sr(310));ts=e,e={memoizedState:ts.memoizedState,baseState:ts.baseState,baseQueue:ts.baseQueue,queue:ts.queue,next:null},ds===null?Ea.memoizedState=ds=e:ds=ds.next=e}return ds}function px(e,t){return typeof t=="function"?t(e):t}function yI(e){var t=gc(),n=t.queue;if(n===null)throw Error(sr(311));n.lastRenderedReducer=e;var i=ts,s=i.baseQueue,d=n.pending;if(d!==null){if(s!==null){var f=s.next;s.next=d.next,d.next=f}i.baseQueue=s=d,n.pending=null}if(s!==null){d=s.next,i=i.baseState;var o=f=null,y=null,b=d;do{var C=b.lane;if((Hp&C)===C)y!==null&&(y=y.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),i=b.hasEagerState?b.eagerState:e(i,b.action);else{var P={lane:C,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};y===null?(o=y=P,f=i):y=y.next=P,Ea.lanes|=C,Gp|=C}b=b.next}while(b!==null&&b!==d);y===null?f=i:y.next=o,Zc(i,t.memoizedState)||(Ml=!0),t.memoizedState=i,t.baseState=f,t.baseQueue=y,n.lastRenderedState=i}if(e=n.interleaved,e!==null){s=e;do d=s.lane,Ea.lanes|=d,Gp|=d,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xI(e){var t=gc(),n=t.queue;if(n===null)throw Error(sr(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,d=t.memoizedState;if(s!==null){n.pending=null;var f=s=s.next;do d=e(d,f.action),f=f.next;while(f!==s);Zc(d,t.memoizedState)||(Ml=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),n.lastRenderedState=d}return[d,i]}function fV(){}function pV(e,t){var n=Ea,i=gc(),s=t(),d=!Zc(i.memoizedState,s);if(d&&(i.memoizedState=s,Ml=!0),i=i.queue,qA(vV.bind(null,n,i,e),[e]),i.getSnapshot!==t||d||ds!==null&&ds.memoizedState.tag&1){if(n.flags|=2048,mx(9,gV.bind(null,n,i,s,t),void 0,null),fs===null)throw Error(sr(349));Hp&30||mV(n,t,s)}return s}function mV(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ea.updateQueue,t===null?(t={lastEffect:null,stores:null},Ea.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function gV(e,t,n,i){t.value=n,t.getSnapshot=i,_V(t)&&yV(e)}function vV(e,t,n){return n(function(){_V(t)&&yV(e)})}function _V(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zc(e,n)}catch{return!0}}function yV(e){var t=zd(e,1);t!==null&&Wc(t,e,1,-1)}function PN(e){var t=Tu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:px,lastRenderedState:e},t.queue=e,e=e.dispatch=aZ.bind(null,Ea,e),[t.memoizedState,e]}function mx(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Ea.updateQueue,t===null?(t={lastEffect:null,stores:null},Ea.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function xV(){return gc().memoizedState}function rS(e,t,n,i){var s=Tu();Ea.flags|=e,s.memoizedState=mx(1|t,n,void 0,i===void 0?null:i)}function zC(e,t,n,i){var s=gc();i=i===void 0?null:i;var d=void 0;if(ts!==null){var f=ts.memoizedState;if(d=f.destroy,i!==null&&HA(i,f.deps)){s.memoizedState=mx(t,n,d,i);return}}Ea.flags|=e,s.memoizedState=mx(1|t,n,d,i)}function MN(e,t){return rS(8390656,8,e,t)}function qA(e,t){return zC(2048,8,e,t)}function bV(e,t){return zC(4,2,e,t)}function wV(e,t){return zC(4,4,e,t)}function SV(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function CV(e,t,n){return n=n!=null?n.concat([e]):null,zC(4,4,SV.bind(null,t,e),n)}function KA(){}function EV(e,t){var n=gc();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&HA(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function TV(e,t){var n=gc();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&HA(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function IV(e,t,n){return Hp&21?(Zc(n,t)||(n=Oj(),Ea.lanes|=n,Gp|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ml=!0),e.memoizedState=n)}function iZ(e,t){var n=jo;jo=n!==0&&4>n?n:4,e(!0);var i=_I.transition;_I.transition={};try{e(!1),t()}finally{jo=n,_I.transition=i}}function PV(){return gc().memoizedState}function oZ(e,t,n){var i=of(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},MV(e))RV(t,n);else if(n=uV(e,t,n,i),n!==null){var s=sl();Wc(n,e,i,s),AV(n,t,i)}}function aZ(e,t,n){var i=of(e),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(MV(e))RV(t,s);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var f=t.lastRenderedState,o=d(f,n);if(s.hasEagerState=!0,s.eagerState=o,Zc(o,f)){var y=t.interleaved;y===null?(s.next=s,BA(t)):(s.next=y.next,y.next=s),t.interleaved=s;return}}catch{}finally{}n=uV(e,t,s,i),n!==null&&(s=sl(),Wc(n,e,i,s),AV(n,t,i))}}function MV(e){var t=e.alternate;return e===Ea||t!==null&&t===Ea}function RV(e,t){$0=qS=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function AV(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,EA(e,n)}}var KS={readContext:mc,useCallback:Ms,useContext:Ms,useEffect:Ms,useImperativeHandle:Ms,useInsertionEffect:Ms,useLayoutEffect:Ms,useMemo:Ms,useReducer:Ms,useRef:Ms,useState:Ms,useDebugValue:Ms,useDeferredValue:Ms,useTransition:Ms,useMutableSource:Ms,useSyncExternalStore:Ms,useId:Ms,unstable_isNewReconciler:!1},sZ={readContext:mc,useCallback:function(e,t){return Tu().memoizedState=[e,t===void 0?null:t],e},useContext:mc,useEffect:MN,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,rS(4194308,4,SV.bind(null,t,e),n)},useLayoutEffect:function(e,t){return rS(4194308,4,e,t)},useInsertionEffect:function(e,t){return rS(4,2,e,t)},useMemo:function(e,t){var n=Tu();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Tu();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=oZ.bind(null,Ea,e),[i.memoizedState,e]},useRef:function(e){var t=Tu();return e={current:e},t.memoizedState=e},useState:PN,useDebugValue:KA,useDeferredValue:function(e){return Tu().memoizedState=e},useTransition:function(){var e=PN(!1),t=e[0];return e=iZ.bind(null,e[1]),Tu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Ea,s=Tu();if(ma){if(n===void 0)throw Error(sr(407));n=n()}else{if(n=t(),fs===null)throw Error(sr(349));Hp&30||mV(i,t,n)}s.memoizedState=n;var d={value:n,getSnapshot:t};return s.queue=d,MN(vV.bind(null,i,d,e),[e]),i.flags|=2048,mx(9,gV.bind(null,i,d,n,t),void 0,null),n},useId:function(){var e=Tu(),t=fs.identifierPrefix;if(ma){var n=Id,i=Td;n=(i&~(1<<32-Gc(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=fx++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=rZ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},lZ={readContext:mc,useCallback:EV,useContext:mc,useEffect:qA,useImperativeHandle:CV,useInsertionEffect:bV,useLayoutEffect:wV,useMemo:TV,useReducer:yI,useRef:xV,useState:function(){return yI(px)},useDebugValue:KA,useDeferredValue:function(e){var t=gc();return IV(t,ts.memoizedState,e)},useTransition:function(){var e=yI(px)[0],t=gc().memoizedState;return[e,t]},useMutableSource:fV,useSyncExternalStore:pV,useId:PV,unstable_isNewReconciler:!1},cZ={readContext:mc,useCallback:EV,useContext:mc,useEffect:qA,useImperativeHandle:CV,useInsertionEffect:bV,useLayoutEffect:wV,useMemo:TV,useReducer:xI,useRef:xV,useState:function(){return xI(px)},useDebugValue:KA,useDeferredValue:function(e){var t=gc();return ts===null?t.memoizedState=e:IV(t,ts.memoizedState,e)},useTransition:function(){var e=xI(px)[0],t=gc().memoizedState;return[e,t]},useMutableSource:fV,useSyncExternalStore:pV,useId:PV,unstable_isNewReconciler:!1};function Nc(e,t){if(e&&e.defaultProps){t=Ta({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function aM(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Ta({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var kC={isMounted:function(e){return(e=e._reactInternals)?em(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=sl(),s=of(e),d=Ad(i,s);d.payload=t,n!=null&&(d.callback=n),t=nf(e,d,s),t!==null&&(Wc(t,e,s,i),tS(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=sl(),s=of(e),d=Ad(i,s);d.tag=1,d.payload=t,n!=null&&(d.callback=n),t=nf(e,d,s),t!==null&&(Wc(t,e,s,i),tS(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=sl(),i=of(e),s=Ad(n,i);s.tag=2,t!=null&&(s.callback=t),t=nf(e,s,i),t!==null&&(Wc(t,e,i,n),tS(t,e,i))}};function RN(e,t,n,i,s,d,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,d,f):t.prototype&&t.prototype.isPureReactComponent?!sx(n,i)||!sx(s,d):!0}function OV(e,t,n){var i=!1,s=cf,d=t.contextType;return typeof d=="object"&&d!==null?d=mc(d):(s=Al(t)?Vp:Ns.current,i=t.contextTypes,d=(i=i!=null)?Sv(e,s):cf),t=new t(n,d),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=kC,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=d),t}function AN(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&kC.enqueueReplaceState(t,t.state,null)}function sM(e,t,n,i){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},$A(e);var d=t.contextType;typeof d=="object"&&d!==null?s.context=mc(d):(d=Al(t)?Vp:Ns.current,s.context=Sv(e,d)),s.state=e.memoizedState,d=t.getDerivedStateFromProps,typeof d=="function"&&(aM(e,t,d,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&kC.enqueueReplaceState(s,s.state,null),GS(e,n,s,i),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Iv(e,t){try{var n="",i=t;do n+=FK(i),i=i.return;while(i);var s=n}catch(d){s=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:t,stack:s,digest:null}}function bI(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function lM(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var uZ=typeof WeakMap=="function"?WeakMap:Map;function DV(e,t,n){n=Ad(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){ZS||(ZS=!0,_M=i),lM(e,t)},n}function LV(e,t,n){n=Ad(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var s=t.value;n.payload=function(){return i(s)},n.callback=function(){lM(e,t)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(n.callback=function(){lM(e,t),typeof i!="function"&&(rf===null?rf=new Set([this]):rf.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),n}function ON(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new uZ;var s=new Set;i.set(t,s)}else s=i.get(t),s===void 0&&(s=new Set,i.set(t,s));s.has(n)||(s.add(n),e=CZ.bind(null,e,t,n),t.then(e,e))}function DN(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function LN(e,t,n,i,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ad(-1,1),t.tag=2,nf(n,t,1))),n.lanes|=1),e)}var dZ=Nd.ReactCurrentOwner,Ml=!1;function ol(e,t,n,i){t.child=e===null?cV(t,null,n,i):Ev(t,e.child,n,i)}function zN(e,t,n,i,s){n=n.render;var d=t.ref;return pv(t,s),i=GA(e,t,n,i,d,s),n=WA(),e!==null&&!Ml?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,kd(e,t,s)):(ma&&n&&DA(t),t.flags|=1,ol(e,t,i,s),t.child)}function kN(e,t,n,i,s){if(e===null){var d=n.type;return typeof d=="function"&&!nO(d)&&d.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=d,zV(e,t,d,i,s)):(e=sS(n.type,null,i,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!(e.lanes&s)){var f=d.memoizedProps;if(n=n.compare,n=n!==null?n:sx,n(f,i)&&e.ref===t.ref)return kd(e,t,s)}return t.flags|=1,e=af(d,i),e.ref=t.ref,e.return=t,t.child=e}function zV(e,t,n,i,s){if(e!==null){var d=e.memoizedProps;if(sx(d,i)&&e.ref===t.ref)if(Ml=!1,t.pendingProps=i=d,(e.lanes&s)!==0)e.flags&131072&&(Ml=!0);else return t.lanes=e.lanes,kd(e,t,s)}return cM(e,t,n,i,s)}function kV(e,t,n){var i=t.pendingProps,s=i.children,d=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ia(ov,jl),jl|=n;else{if(!(n&1073741824))return e=d!==null?d.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ia(ov,jl),jl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=d!==null?d.baseLanes:n,ia(ov,jl),jl|=i}else d!==null?(i=d.baseLanes|n,t.memoizedState=null):i=n,ia(ov,jl),jl|=i;return ol(e,t,s,n),t.child}function FV(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function cM(e,t,n,i,s){var d=Al(n)?Vp:Ns.current;return d=Sv(t,d),pv(t,s),n=GA(e,t,n,i,d,s),i=WA(),e!==null&&!Ml?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,kd(e,t,s)):(ma&&i&&DA(t),t.flags|=1,ol(e,t,n,s),t.child)}function FN(e,t,n,i,s){if(Al(n)){var d=!0;$S(t)}else d=!1;if(pv(t,s),t.stateNode===null)iS(e,t),OV(t,n,i),sM(t,n,i,s),i=!0;else if(e===null){var f=t.stateNode,o=t.memoizedProps;f.props=o;var y=f.context,b=n.contextType;typeof b=="object"&&b!==null?b=mc(b):(b=Al(n)?Vp:Ns.current,b=Sv(t,b));var C=n.getDerivedStateFromProps,P=typeof C=="function"||typeof f.getSnapshotBeforeUpdate=="function";P||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(o!==i||y!==b)&&AN(t,f,i,b),kh=!1;var A=t.memoizedState;f.state=A,GS(t,i,f,s),y=t.memoizedState,o!==i||A!==y||Rl.current||kh?(typeof C=="function"&&(aM(t,n,C,i),y=t.memoizedState),(o=kh||RN(t,n,o,i,A,y,b))?(P||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=y),f.props=i,f.state=y,f.context=b,i=o):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{f=t.stateNode,dV(e,t),o=t.memoizedProps,b=t.type===t.elementType?o:Nc(t.type,o),f.props=b,P=t.pendingProps,A=f.context,y=n.contextType,typeof y=="object"&&y!==null?y=mc(y):(y=Al(n)?Vp:Ns.current,y=Sv(t,y));var D=n.getDerivedStateFromProps;(C=typeof D=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(o!==P||A!==y)&&AN(t,f,i,y),kh=!1,A=t.memoizedState,f.state=A,GS(t,i,f,s);var k=t.memoizedState;o!==P||A!==k||Rl.current||kh?(typeof D=="function"&&(aM(t,n,D,i),k=t.memoizedState),(b=kh||RN(t,n,b,i,A,k,y)||!1)?(C||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(i,k,y),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(i,k,y)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||o===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=k),f.props=i,f.state=k,f.context=y,i=b):(typeof f.componentDidUpdate!="function"||o===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),i=!1)}return uM(e,t,n,i,d,s)}function uM(e,t,n,i,s,d){FV(e,t);var f=(t.flags&128)!==0;if(!i&&!f)return s&&wN(t,n,!1),kd(e,t,d);i=t.stateNode,dZ.current=t;var o=f&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&f?(t.child=Ev(t,e.child,null,d),t.child=Ev(t,null,o,d)):ol(e,t,o,d),t.memoizedState=i.state,s&&wN(t,n,!0),t.child}function NV(e){var t=e.stateNode;t.pendingContext?bN(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bN(e,t.context,!1),jA(e,t.containerInfo)}function NN(e,t,n,i,s){return Cv(),zA(s),t.flags|=256,ol(e,t,n,i),t.child}var dM={dehydrated:null,treeContext:null,retryLane:0};function hM(e){return{baseLanes:e,cachePool:null,transitions:null}}function BV(e,t,n){var i=t.pendingProps,s=Ca.current,d=!1,f=(t.flags&128)!==0,o;if((o=f)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(d=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ia(Ca,s&1),e===null)return iM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=i.children,e=i.fallback,d?(i=t.mode,d=t.child,f={mode:"hidden",children:f},!(i&1)&&d!==null?(d.childLanes=0,d.pendingProps=f):d=BC(f,i,0,null),e=Fp(e,i,n,null),d.return=t,e.return=t,d.sibling=e,t.child=d,t.child.memoizedState=hM(n),t.memoizedState=dM,e):XA(t,f));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return hZ(e,t,f,i,o,s,n);if(d){d=i.fallback,f=t.mode,s=e.child,o=s.sibling;var y={mode:"hidden",children:i.children};return!(f&1)&&t.child!==s?(i=t.child,i.childLanes=0,i.pendingProps=y,t.deletions=null):(i=af(s,y),i.subtreeFlags=s.subtreeFlags&14680064),o!==null?d=af(o,d):(d=Fp(d,f,n,null),d.flags|=2),d.return=t,i.return=t,i.sibling=d,t.child=i,i=d,d=t.child,f=e.child.memoizedState,f=f===null?hM(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},d.memoizedState=f,d.childLanes=e.childLanes&~n,t.memoizedState=dM,i}return d=e.child,e=d.sibling,i=af(d,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function XA(e,t){return t=BC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function yw(e,t,n,i){return i!==null&&zA(i),Ev(t,e.child,null,n),e=XA(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hZ(e,t,n,i,s,d,f){if(n)return t.flags&256?(t.flags&=-257,i=bI(Error(sr(422))),yw(e,t,f,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(d=i.fallback,s=t.mode,i=BC({mode:"visible",children:i.children},s,0,null),d=Fp(d,s,f,null),d.flags|=2,i.return=t,d.return=t,i.sibling=d,t.child=i,t.mode&1&&Ev(t,e.child,null,f),t.child.memoizedState=hM(f),t.memoizedState=dM,d);if(!(t.mode&1))return yw(e,t,f,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var o=i.dgst;return i=o,d=Error(sr(419)),i=bI(d,i,void 0),yw(e,t,f,i)}if(o=(f&e.childLanes)!==0,Ml||o){if(i=fs,i!==null){switch(f&-f){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|f)?0:s,s!==0&&s!==d.retryLane&&(d.retryLane=s,zd(e,s),Wc(i,e,s,-1))}return tO(),i=bI(Error(sr(421))),yw(e,t,f,i)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=EZ.bind(null,e),s._reactRetry=t,null):(e=d.treeContext,Vl=tf(s.nextSibling),Gl=t,ma=!0,Vc=null,e!==null&&(cc[uc++]=Td,cc[uc++]=Id,cc[uc++]=Up,Td=e.id,Id=e.overflow,Up=t),t=XA(t,i.children),t.flags|=4096,t)}function BN(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),oM(e.return,t,n)}function wI(e,t,n,i,s){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=i,d.tail=n,d.tailMode=s)}function $V(e,t,n){var i=t.pendingProps,s=i.revealOrder,d=i.tail;if(ol(e,t,i.children,n),i=Ca.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&BN(e,n,t);else if(e.tag===19)BN(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(ia(Ca,i),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&WS(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),wI(t,!1,s,n,d);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&WS(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}wI(t,!0,n,null,d);break;case"together":wI(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function iS(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kd(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Gp|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(sr(153));if(t.child!==null){for(e=t.child,n=af(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=af(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function fZ(e,t,n){switch(t.tag){case 3:NV(t),Cv();break;case 5:hV(t);break;case 1:Al(t.type)&&$S(t);break;case 4:jA(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,s=t.memoizedProps.value;ia(US,i._currentValue),i._currentValue=s;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(ia(Ca,Ca.current&1),t.flags|=128,null):n&t.child.childLanes?BV(e,t,n):(ia(Ca,Ca.current&1),e=kd(e,t,n),e!==null?e.sibling:null);ia(Ca,Ca.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return $V(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ia(Ca,Ca.current),i)break;return null;case 22:case 23:return t.lanes=0,kV(e,t,n)}return kd(e,t,n)}var jV,fM,VV,UV;jV=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};fM=function(){};VV=function(e,t,n,i){var s=e.memoizedProps;if(s!==i){e=t.stateNode,Dp(Du.current);var d=null;switch(n){case"input":s=zP(e,s),i=zP(e,i),d=[];break;case"select":s=Ta({},s,{value:void 0}),i=Ta({},i,{value:void 0}),d=[];break;case"textarea":s=NP(e,s),i=NP(e,i),d=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=NS)}$P(n,i);var f;n=null;for(b in s)if(!i.hasOwnProperty(b)&&s.hasOwnProperty(b)&&s[b]!=null)if(b==="style"){var o=s[b];for(f in o)o.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(ex.hasOwnProperty(b)?d||(d=[]):(d=d||[]).push(b,null));for(b in i){var y=i[b];if(o=s!=null?s[b]:void 0,i.hasOwnProperty(b)&&y!==o&&(y!=null||o!=null))if(b==="style")if(o){for(f in o)!o.hasOwnProperty(f)||y&&y.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in y)y.hasOwnProperty(f)&&o[f]!==y[f]&&(n||(n={}),n[f]=y[f])}else n||(d||(d=[]),d.push(b,n)),n=y;else b==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,o=o?o.__html:void 0,y!=null&&o!==y&&(d=d||[]).push(b,y)):b==="children"?typeof y!="string"&&typeof y!="number"||(d=d||[]).push(b,""+y):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(ex.hasOwnProperty(b)?(y!=null&&b==="onScroll"&&ua("scroll",e),d||o===y||(d=[])):(d=d||[]).push(b,y))}n&&(d=d||[]).push("style",n);var b=d;(t.updateQueue=b)&&(t.flags|=4)}};UV=function(e,t,n,i){n!==i&&(t.flags|=4)};function l0(e,t){if(!ma)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Rs(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function pZ(e,t,n){var i=t.pendingProps;switch(LA(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rs(t),null;case 1:return Al(t.type)&&BS(),Rs(t),null;case 3:return i=t.stateNode,Tv(),da(Rl),da(Ns),UA(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(vw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vc!==null&&(bM(Vc),Vc=null))),fM(e,t),Rs(t),null;case 5:VA(t);var s=Dp(hx.current);if(n=t.type,e!==null&&t.stateNode!=null)VV(e,t,n,i,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(sr(166));return Rs(t),null}if(e=Dp(Du.current),vw(t)){i=t.stateNode,n=t.type;var d=t.memoizedProps;switch(i[Ru]=t,i[ux]=d,e=(t.mode&1)!==0,n){case"dialog":ua("cancel",i),ua("close",i);break;case"iframe":case"object":case"embed":ua("load",i);break;case"video":case"audio":for(s=0;s<E0.length;s++)ua(E0[s],i);break;case"source":ua("error",i);break;case"img":case"image":case"link":ua("error",i),ua("load",i);break;case"details":ua("toggle",i);break;case"input":KF(i,d),ua("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!d.multiple},ua("invalid",i);break;case"textarea":ZF(i,d),ua("invalid",i)}$P(n,d),s=null;for(var f in d)if(d.hasOwnProperty(f)){var o=d[f];f==="children"?typeof o=="string"?i.textContent!==o&&(d.suppressHydrationWarning!==!0&&gw(i.textContent,o,e),s=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(d.suppressHydrationWarning!==!0&&gw(i.textContent,o,e),s=["children",""+o]):ex.hasOwnProperty(f)&&o!=null&&f==="onScroll"&&ua("scroll",i)}switch(n){case"input":lw(i),XF(i,d,!0);break;case"textarea":lw(i),YF(i);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(i.onclick=NS)}i=s,t.updateQueue=i,i!==null&&(t.flags|=4)}else{f=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vj(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=f.createElement(n,{is:i.is}):(e=f.createElement(n),n==="select"&&(f=e,i.multiple?f.multiple=!0:i.size&&(f.size=i.size))):e=f.createElementNS(e,n),e[Ru]=t,e[ux]=i,jV(e,t,!1,!1),t.stateNode=e;e:{switch(f=jP(n,i),n){case"dialog":ua("cancel",e),ua("close",e),s=i;break;case"iframe":case"object":case"embed":ua("load",e),s=i;break;case"video":case"audio":for(s=0;s<E0.length;s++)ua(E0[s],e);s=i;break;case"source":ua("error",e),s=i;break;case"img":case"image":case"link":ua("error",e),ua("load",e),s=i;break;case"details":ua("toggle",e),s=i;break;case"input":KF(e,i),s=zP(e,i),ua("invalid",e);break;case"option":s=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=Ta({},i,{value:void 0}),ua("invalid",e);break;case"textarea":ZF(e,i),s=NP(e,i),ua("invalid",e);break;default:s=i}$P(n,s),o=s;for(d in o)if(o.hasOwnProperty(d)){var y=o[d];d==="style"?xj(e,y):d==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&_j(e,y)):d==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&tx(e,y):typeof y=="number"&&tx(e,""+y):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ex.hasOwnProperty(d)?y!=null&&d==="onScroll"&&ua("scroll",e):y!=null&&yA(e,d,y,f))}switch(n){case"input":lw(e),XF(e,i,!1);break;case"textarea":lw(e),YF(e);break;case"option":i.value!=null&&e.setAttribute("value",""+lf(i.value));break;case"select":e.multiple=!!i.multiple,d=i.value,d!=null?uv(e,!!i.multiple,d,!1):i.defaultValue!=null&&uv(e,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=NS)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rs(t),null;case 6:if(e&&t.stateNode!=null)UV(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(sr(166));if(n=Dp(hx.current),Dp(Du.current),vw(t)){if(i=t.stateNode,n=t.memoizedProps,i[Ru]=t,(d=i.nodeValue!==n)&&(e=Gl,e!==null))switch(e.tag){case 3:gw(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&gw(i.nodeValue,n,(e.mode&1)!==0)}d&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Ru]=t,t.stateNode=i}return Rs(t),null;case 13:if(da(Ca),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ma&&Vl!==null&&t.mode&1&&!(t.flags&128))sV(),Cv(),t.flags|=98560,d=!1;else if(d=vw(t),i!==null&&i.dehydrated!==null){if(e===null){if(!d)throw Error(sr(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(sr(317));d[Ru]=t}else Cv(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rs(t),d=!1}else Vc!==null&&(bM(Vc),Vc=null),d=!0;if(!d)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Ca.current&1?ns===0&&(ns=3):tO())),t.updateQueue!==null&&(t.flags|=4),Rs(t),null);case 4:return Tv(),fM(e,t),e===null&&lx(t.stateNode.containerInfo),Rs(t),null;case 10:return NA(t.type._context),Rs(t),null;case 17:return Al(t.type)&&BS(),Rs(t),null;case 19:if(da(Ca),d=t.memoizedState,d===null)return Rs(t),null;if(i=(t.flags&128)!==0,f=d.rendering,f===null)if(i)l0(d,!1);else{if(ns!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=WS(e),f!==null){for(t.flags|=128,l0(d,!1),i=f.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)d=n,e=i,d.flags&=14680066,f=d.alternate,f===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=f.childLanes,d.lanes=f.lanes,d.child=f.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=f.memoizedProps,d.memoizedState=f.memoizedState,d.updateQueue=f.updateQueue,d.type=f.type,e=f.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ia(Ca,Ca.current&1|2),t.child}e=e.sibling}d.tail!==null&&Ba()>Pv&&(t.flags|=128,i=!0,l0(d,!1),t.lanes=4194304)}else{if(!i)if(e=WS(f),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),l0(d,!0),d.tail===null&&d.tailMode==="hidden"&&!f.alternate&&!ma)return Rs(t),null}else 2*Ba()-d.renderingStartTime>Pv&&n!==1073741824&&(t.flags|=128,i=!0,l0(d,!1),t.lanes=4194304);d.isBackwards?(f.sibling=t.child,t.child=f):(n=d.last,n!==null?n.sibling=f:t.child=f,d.last=f)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=Ba(),t.sibling=null,n=Ca.current,ia(Ca,i?n&1|2:n&1),t):(Rs(t),null);case 22:case 23:return eO(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?jl&1073741824&&(Rs(t),t.subtreeFlags&6&&(t.flags|=8192)):Rs(t),null;case 24:return null;case 25:return null}throw Error(sr(156,t.tag))}function mZ(e,t){switch(LA(t),t.tag){case 1:return Al(t.type)&&BS(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tv(),da(Rl),da(Ns),UA(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return VA(t),null;case 13:if(da(Ca),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(sr(340));Cv()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return da(Ca),null;case 4:return Tv(),null;case 10:return NA(t.type._context),null;case 22:case 23:return eO(),null;case 24:return null;default:return null}}var xw=!1,zs=!1,gZ=typeof WeakSet=="function"?WeakSet:Set,Wr=null;function iv(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Da(e,t,i)}else n.current=null}function pM(e,t,n){try{n()}catch(i){Da(e,t,i)}}var $N=!1;function vZ(e,t){if(YP=zS,e=Kj(),OA(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var s=i.anchorOffset,d=i.focusNode;i=i.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var f=0,o=-1,y=-1,b=0,C=0,P=e,A=null;t:for(;;){for(var D;P!==n||s!==0&&P.nodeType!==3||(o=f+s),P!==d||i!==0&&P.nodeType!==3||(y=f+i),P.nodeType===3&&(f+=P.nodeValue.length),(D=P.firstChild)!==null;)A=P,P=D;for(;;){if(P===e)break t;if(A===n&&++b===s&&(o=f),A===d&&++C===i&&(y=f),(D=P.nextSibling)!==null)break;P=A,A=P.parentNode}P=D}n=o===-1||y===-1?null:{start:o,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(JP={focusedElem:e,selectionRange:n},zS=!1,Wr=t;Wr!==null;)if(t=Wr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Wr=e;else for(;Wr!==null;){t=Wr;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var B=k.memoizedProps,N=k.memoizedState,j=t.stateNode,V=j.getSnapshotBeforeUpdate(t.elementType===t.type?B:Nc(t.type,B),N);j.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var K=t.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(sr(163))}}catch(Y){Da(t,t.return,Y)}if(e=t.sibling,e!==null){e.return=t.return,Wr=e;break}Wr=t.return}return k=$N,$N=!1,k}function j0(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&e)===e){var d=s.destroy;s.destroy=void 0,d!==void 0&&pM(t,n,d)}s=s.next}while(s!==i)}}function FC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function mM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function HV(e){var t=e.alternate;t!==null&&(e.alternate=null,HV(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ru],delete t[ux],delete t[tM],delete t[QX],delete t[eZ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GV(e){return e.tag===5||e.tag===3||e.tag===4}function jN(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GV(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=NS));else if(i!==4&&(e=e.child,e!==null))for(gM(e,t,n),e=e.sibling;e!==null;)gM(e,t,n),e=e.sibling}function vM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(vM(e,t,n),e=e.sibling;e!==null;)vM(e,t,n),e=e.sibling}var xs=null,Bc=!1;function Ah(e,t,n){for(n=n.child;n!==null;)WV(e,t,n),n=n.sibling}function WV(e,t,n){if(Ou&&typeof Ou.onCommitFiberUnmount=="function")try{Ou.onCommitFiberUnmount(MC,n)}catch{}switch(n.tag){case 5:zs||iv(n,t);case 6:var i=xs,s=Bc;xs=null,Ah(e,t,n),xs=i,Bc=s,xs!==null&&(Bc?(e=xs,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xs.removeChild(n.stateNode));break;case 18:xs!==null&&(Bc?(e=xs,n=n.stateNode,e.nodeType===8?mI(e.parentNode,n):e.nodeType===1&&mI(e,n),ox(e)):mI(xs,n.stateNode));break;case 4:i=xs,s=Bc,xs=n.stateNode.containerInfo,Bc=!0,Ah(e,t,n),xs=i,Bc=s;break;case 0:case 11:case 14:case 15:if(!zs&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var d=s,f=d.destroy;d=d.tag,f!==void 0&&(d&2||d&4)&&pM(n,t,f),s=s.next}while(s!==i)}Ah(e,t,n);break;case 1:if(!zs&&(iv(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Da(n,t,o)}Ah(e,t,n);break;case 21:Ah(e,t,n);break;case 22:n.mode&1?(zs=(i=zs)||n.memoizedState!==null,Ah(e,t,n),zs=i):Ah(e,t,n);break;default:Ah(e,t,n)}}function VN(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new gZ),t.forEach(function(i){var s=TZ.bind(null,e,i);n.has(i)||(n.add(i),i.then(s,s))})}}function Fc(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i];try{var d=e,f=t,o=f;e:for(;o!==null;){switch(o.tag){case 5:xs=o.stateNode,Bc=!1;break e;case 3:xs=o.stateNode.containerInfo,Bc=!0;break e;case 4:xs=o.stateNode.containerInfo,Bc=!0;break e}o=o.return}if(xs===null)throw Error(sr(160));WV(d,f,s),xs=null,Bc=!1;var y=s.alternate;y!==null&&(y.return=null),s.return=null}catch(b){Da(s,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qV(t,e),t=t.sibling}function qV(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Fc(t,e),wu(e),i&4){try{j0(3,e,e.return),FC(3,e)}catch(B){Da(e,e.return,B)}try{j0(5,e,e.return)}catch(B){Da(e,e.return,B)}}break;case 1:Fc(t,e),wu(e),i&512&&n!==null&&iv(n,n.return);break;case 5:if(Fc(t,e),wu(e),i&512&&n!==null&&iv(n,n.return),e.flags&32){var s=e.stateNode;try{tx(s,"")}catch(B){Da(e,e.return,B)}}if(i&4&&(s=e.stateNode,s!=null)){var d=e.memoizedProps,f=n!==null?n.memoizedProps:d,o=e.type,y=e.updateQueue;if(e.updateQueue=null,y!==null)try{o==="input"&&d.type==="radio"&&d.name!=null&&mj(s,d),jP(o,f);var b=jP(o,d);for(f=0;f<y.length;f+=2){var C=y[f],P=y[f+1];C==="style"?xj(s,P):C==="dangerouslySetInnerHTML"?_j(s,P):C==="children"?tx(s,P):yA(s,C,P,b)}switch(o){case"input":kP(s,d);break;case"textarea":gj(s,d);break;case"select":var A=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!d.multiple;var D=d.value;D!=null?uv(s,!!d.multiple,D,!1):A!==!!d.multiple&&(d.defaultValue!=null?uv(s,!!d.multiple,d.defaultValue,!0):uv(s,!!d.multiple,d.multiple?[]:"",!1))}s[ux]=d}catch(B){Da(e,e.return,B)}}break;case 6:if(Fc(t,e),wu(e),i&4){if(e.stateNode===null)throw Error(sr(162));s=e.stateNode,d=e.memoizedProps;try{s.nodeValue=d}catch(B){Da(e,e.return,B)}}break;case 3:if(Fc(t,e),wu(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ox(t.containerInfo)}catch(B){Da(e,e.return,B)}break;case 4:Fc(t,e),wu(e);break;case 13:Fc(t,e),wu(e),s=e.child,s.flags&8192&&(d=s.memoizedState!==null,s.stateNode.isHidden=d,!d||s.alternate!==null&&s.alternate.memoizedState!==null||(JA=Ba())),i&4&&VN(e);break;case 22:if(C=n!==null&&n.memoizedState!==null,e.mode&1?(zs=(b=zs)||C,Fc(t,e),zs=b):Fc(t,e),wu(e),i&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!C&&e.mode&1)for(Wr=e,C=e.child;C!==null;){for(P=Wr=C;Wr!==null;){switch(A=Wr,D=A.child,A.tag){case 0:case 11:case 14:case 15:j0(4,A,A.return);break;case 1:iv(A,A.return);var k=A.stateNode;if(typeof k.componentWillUnmount=="function"){i=A,n=A.return;try{t=i,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(B){Da(i,n,B)}}break;case 5:iv(A,A.return);break;case 22:if(A.memoizedState!==null){HN(P);continue}}D!==null?(D.return=A,Wr=D):HN(P)}C=C.sibling}e:for(C=null,P=e;;){if(P.tag===5){if(C===null){C=P;try{s=P.stateNode,b?(d=s.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(o=P.stateNode,y=P.memoizedProps.style,f=y!=null&&y.hasOwnProperty("display")?y.display:null,o.style.display=yj("display",f))}catch(B){Da(e,e.return,B)}}}else if(P.tag===6){if(C===null)try{P.stateNode.nodeValue=b?"":P.memoizedProps}catch(B){Da(e,e.return,B)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===e)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===e)break e;for(;P.sibling===null;){if(P.return===null||P.return===e)break e;C===P&&(C=null),P=P.return}C===P&&(C=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:Fc(t,e),wu(e),i&4&&VN(e);break;case 21:break;default:Fc(t,e),wu(e)}}function wu(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(GV(n)){var i=n;break e}n=n.return}throw Error(sr(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(tx(s,""),i.flags&=-33);var d=jN(e);vM(e,d,s);break;case 3:case 4:var f=i.stateNode.containerInfo,o=jN(e);gM(e,o,f);break;default:throw Error(sr(161))}}catch(y){Da(e,e.return,y)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _Z(e,t,n){Wr=e,KV(e)}function KV(e,t,n){for(var i=(e.mode&1)!==0;Wr!==null;){var s=Wr,d=s.child;if(s.tag===22&&i){var f=s.memoizedState!==null||xw;if(!f){var o=s.alternate,y=o!==null&&o.memoizedState!==null||zs;o=xw;var b=zs;if(xw=f,(zs=y)&&!b)for(Wr=s;Wr!==null;)f=Wr,y=f.child,f.tag===22&&f.memoizedState!==null?GN(s):y!==null?(y.return=f,Wr=y):GN(s);for(;d!==null;)Wr=d,KV(d),d=d.sibling;Wr=s,xw=o,zs=b}UN(e)}else s.subtreeFlags&8772&&d!==null?(d.return=s,Wr=d):UN(e)}}function UN(e){for(;Wr!==null;){var t=Wr;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:zs||FC(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!zs)if(n===null)i.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Nc(t.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var d=t.updateQueue;d!==null&&IN(t,d,i);break;case 3:var f=t.updateQueue;if(f!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}IN(t,f,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var y=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var C=b.memoizedState;if(C!==null){var P=C.dehydrated;P!==null&&ox(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(sr(163))}zs||t.flags&512&&mM(t)}catch(A){Da(t,t.return,A)}}if(t===e){Wr=null;break}if(n=t.sibling,n!==null){n.return=t.return,Wr=n;break}Wr=t.return}}function HN(e){for(;Wr!==null;){var t=Wr;if(t===e){Wr=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Wr=n;break}Wr=t.return}}function GN(e){for(;Wr!==null;){var t=Wr;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{FC(4,t)}catch(y){Da(t,n,y)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var s=t.return;try{i.componentDidMount()}catch(y){Da(t,s,y)}}var d=t.return;try{mM(t)}catch(y){Da(t,d,y)}break;case 5:var f=t.return;try{mM(t)}catch(y){Da(t,f,y)}}}catch(y){Da(t,t.return,y)}if(t===e){Wr=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Wr=o;break}Wr=t.return}}var yZ=Math.ceil,XS=Nd.ReactCurrentDispatcher,ZA=Nd.ReactCurrentOwner,fc=Nd.ReactCurrentBatchConfig,Co=0,fs=null,Za=null,bs=0,jl=0,ov=yf(0),ns=0,gx=null,Gp=0,NC=0,YA=0,V0=null,Tl=null,JA=0,Pv=1/0,wd=null,ZS=!1,_M=null,rf=null,bw=!1,jh=null,YS=0,U0=0,yM=null,oS=-1,aS=0;function sl(){return Co&6?Ba():oS!==-1?oS:oS=Ba()}function of(e){return e.mode&1?Co&2&&bs!==0?bs&-bs:nZ.transition!==null?(aS===0&&(aS=Oj()),aS):(e=jo,e!==0||(e=window.event,e=e===void 0?16:Bj(e.type)),e):1}function Wc(e,t,n,i){if(50<U0)throw U0=0,yM=null,Error(sr(185));Kx(e,n,i),(!(Co&2)||e!==fs)&&(e===fs&&(!(Co&2)&&(NC|=n),ns===4&&Bh(e,bs)),Ol(e,i),n===1&&Co===0&&!(t.mode&1)&&(Pv=Ba()+500,LC&&xf()))}function Ol(e,t){var n=e.callbackNode;nX(e,t);var i=LS(e,e===fs?bs:0);if(i===0)n!==null&&eN(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&eN(n),t===1)e.tag===0?tZ(WN.bind(null,e)):iV(WN.bind(null,e)),YX(function(){!(Co&6)&&xf()}),n=null;else{switch(Dj(i)){case 1:n=CA;break;case 4:n=Rj;break;case 16:n=DS;break;case 536870912:n=Aj;break;default:n=DS}n=n6(n,XV.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function XV(e,t){if(oS=-1,aS=0,Co&6)throw Error(sr(327));var n=e.callbackNode;if(mv()&&e.callbackNode!==n)return null;var i=LS(e,e===fs?bs:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=JS(e,i);else{t=i;var s=Co;Co|=2;var d=YV();(fs!==e||bs!==t)&&(wd=null,Pv=Ba()+500,kp(e,t));do try{wZ();break}catch(o){ZV(e,o)}while(!0);FA(),XS.current=d,Co=s,Za!==null?t=0:(fs=null,bs=0,t=ns)}if(t!==0){if(t===2&&(s=WP(e),s!==0&&(i=s,t=xM(e,s))),t===1)throw n=gx,kp(e,0),Bh(e,i),Ol(e,Ba()),n;if(t===6)Bh(e,i);else{if(s=e.current.alternate,!(i&30)&&!xZ(s)&&(t=JS(e,i),t===2&&(d=WP(e),d!==0&&(i=d,t=xM(e,d))),t===1))throw n=gx,kp(e,0),Bh(e,i),Ol(e,Ba()),n;switch(e.finishedWork=s,e.finishedLanes=i,t){case 0:case 1:throw Error(sr(345));case 2:Ep(e,Tl,wd);break;case 3:if(Bh(e,i),(i&130023424)===i&&(t=JA+500-Ba(),10<t)){if(LS(e,0)!==0)break;if(s=e.suspendedLanes,(s&i)!==i){sl(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=eM(Ep.bind(null,e,Tl,wd),t);break}Ep(e,Tl,wd);break;case 4:if(Bh(e,i),(i&4194240)===i)break;for(t=e.eventTimes,s=-1;0<i;){var f=31-Gc(i);d=1<<f,f=t[f],f>s&&(s=f),i&=~d}if(i=s,i=Ba()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*yZ(i/1960))-i,10<i){e.timeoutHandle=eM(Ep.bind(null,e,Tl,wd),i);break}Ep(e,Tl,wd);break;case 5:Ep(e,Tl,wd);break;default:throw Error(sr(329))}}}return Ol(e,Ba()),e.callbackNode===n?XV.bind(null,e):null}function xM(e,t){var n=V0;return e.current.memoizedState.isDehydrated&&(kp(e,t).flags|=256),e=JS(e,t),e!==2&&(t=Tl,Tl=n,t!==null&&bM(t)),e}function bM(e){Tl===null?Tl=e:Tl.push.apply(Tl,e)}function xZ(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var s=n[i],d=s.getSnapshot;s=s.value;try{if(!Zc(d(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bh(e,t){for(t&=~YA,t&=~NC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Gc(t),i=1<<n;e[n]=-1,t&=~i}}function WN(e){if(Co&6)throw Error(sr(327));mv();var t=LS(e,0);if(!(t&1))return Ol(e,Ba()),null;var n=JS(e,t);if(e.tag!==0&&n===2){var i=WP(e);i!==0&&(t=i,n=xM(e,i))}if(n===1)throw n=gx,kp(e,0),Bh(e,t),Ol(e,Ba()),n;if(n===6)throw Error(sr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ep(e,Tl,wd),Ol(e,Ba()),null}function QA(e,t){var n=Co;Co|=1;try{return e(t)}finally{Co=n,Co===0&&(Pv=Ba()+500,LC&&xf())}}function Wp(e){jh!==null&&jh.tag===0&&!(Co&6)&&mv();var t=Co;Co|=1;var n=fc.transition,i=jo;try{if(fc.transition=null,jo=1,e)return e()}finally{jo=i,fc.transition=n,Co=t,!(Co&6)&&xf()}}function eO(){jl=ov.current,da(ov)}function kp(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ZX(n)),Za!==null)for(n=Za.return;n!==null;){var i=n;switch(LA(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&BS();break;case 3:Tv(),da(Rl),da(Ns),UA();break;case 5:VA(i);break;case 4:Tv();break;case 13:da(Ca);break;case 19:da(Ca);break;case 10:NA(i.type._context);break;case 22:case 23:eO()}n=n.return}if(fs=e,Za=e=af(e.current,null),bs=jl=t,ns=0,gx=null,YA=NC=Gp=0,Tl=V0=null,Op!==null){for(t=0;t<Op.length;t++)if(n=Op[t],i=n.interleaved,i!==null){n.interleaved=null;var s=i.next,d=n.pending;if(d!==null){var f=d.next;d.next=s,i.next=f}n.pending=i}Op=null}return e}function ZV(e,t){do{var n=Za;try{if(FA(),nS.current=KS,qS){for(var i=Ea.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}qS=!1}if(Hp=0,ds=ts=Ea=null,$0=!1,fx=0,ZA.current=null,n===null||n.return===null){ns=1,gx=t,Za=null;break}e:{var d=e,f=n.return,o=n,y=t;if(t=bs,o.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var b=y,C=o,P=C.tag;if(!(C.mode&1)&&(P===0||P===11||P===15)){var A=C.alternate;A?(C.updateQueue=A.updateQueue,C.memoizedState=A.memoizedState,C.lanes=A.lanes):(C.updateQueue=null,C.memoizedState=null)}var D=DN(f);if(D!==null){D.flags&=-257,LN(D,f,o,d,t),D.mode&1&&ON(d,b,t),t=D,y=b;var k=t.updateQueue;if(k===null){var B=new Set;B.add(y),t.updateQueue=B}else k.add(y);break e}else{if(!(t&1)){ON(d,b,t),tO();break e}y=Error(sr(426))}}else if(ma&&o.mode&1){var N=DN(f);if(N!==null){!(N.flags&65536)&&(N.flags|=256),LN(N,f,o,d,t),zA(Iv(y,o));break e}}d=y=Iv(y,o),ns!==4&&(ns=2),V0===null?V0=[d]:V0.push(d),d=f;do{switch(d.tag){case 3:d.flags|=65536,t&=-t,d.lanes|=t;var j=DV(d,y,t);TN(d,j);break e;case 1:o=y;var V=d.type,K=d.stateNode;if(!(d.flags&128)&&(typeof V.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(rf===null||!rf.has(K)))){d.flags|=65536,t&=-t,d.lanes|=t;var Y=LV(d,o,t);TN(d,Y);break e}}d=d.return}while(d!==null)}QV(n)}catch(Z){t=Z,Za===n&&n!==null&&(Za=n=n.return);continue}break}while(!0)}function YV(){var e=XS.current;return XS.current=KS,e===null?KS:e}function tO(){(ns===0||ns===3||ns===2)&&(ns=4),fs===null||!(Gp&268435455)&&!(NC&268435455)||Bh(fs,bs)}function JS(e,t){var n=Co;Co|=2;var i=YV();(fs!==e||bs!==t)&&(wd=null,kp(e,t));do try{bZ();break}catch(s){ZV(e,s)}while(!0);if(FA(),Co=n,XS.current=i,Za!==null)throw Error(sr(261));return fs=null,bs=0,ns}function bZ(){for(;Za!==null;)JV(Za)}function wZ(){for(;Za!==null&&!qK();)JV(Za)}function JV(e){var t=t6(e.alternate,e,jl);e.memoizedProps=e.pendingProps,t===null?QV(e):Za=t,ZA.current=null}function QV(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=mZ(n,t),n!==null){n.flags&=32767,Za=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ns=6,Za=null;return}}else if(n=pZ(n,t,jl),n!==null){Za=n;return}if(t=t.sibling,t!==null){Za=t;return}Za=t=e}while(t!==null);ns===0&&(ns=5)}function Ep(e,t,n){var i=jo,s=fc.transition;try{fc.transition=null,jo=1,SZ(e,t,n,i)}finally{fc.transition=s,jo=i}return null}function SZ(e,t,n,i){do mv();while(jh!==null);if(Co&6)throw Error(sr(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(sr(177));e.callbackNode=null,e.callbackPriority=0;var d=n.lanes|n.childLanes;if(rX(e,d),e===fs&&(Za=fs=null,bs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||bw||(bw=!0,n6(DS,function(){return mv(),null})),d=(n.flags&15990)!==0,n.subtreeFlags&15990||d){d=fc.transition,fc.transition=null;var f=jo;jo=1;var o=Co;Co|=4,ZA.current=null,vZ(e,n),qV(n,e),UX(JP),zS=!!YP,JP=YP=null,e.current=n,_Z(n),KK(),Co=o,jo=f,fc.transition=d}else e.current=n;if(bw&&(bw=!1,jh=e,YS=s),d=e.pendingLanes,d===0&&(rf=null),YK(n.stateNode),Ol(e,Ba()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],i(s.value,{componentStack:s.stack,digest:s.digest});if(ZS)throw ZS=!1,e=_M,_M=null,e;return YS&1&&e.tag!==0&&mv(),d=e.pendingLanes,d&1?e===yM?U0++:(U0=0,yM=e):U0=0,xf(),null}function mv(){if(jh!==null){var e=Dj(YS),t=fc.transition,n=jo;try{if(fc.transition=null,jo=16>e?16:e,jh===null)var i=!1;else{if(e=jh,jh=null,YS=0,Co&6)throw Error(sr(331));var s=Co;for(Co|=4,Wr=e.current;Wr!==null;){var d=Wr,f=d.child;if(Wr.flags&16){var o=d.deletions;if(o!==null){for(var y=0;y<o.length;y++){var b=o[y];for(Wr=b;Wr!==null;){var C=Wr;switch(C.tag){case 0:case 11:case 15:j0(8,C,d)}var P=C.child;if(P!==null)P.return=C,Wr=P;else for(;Wr!==null;){C=Wr;var A=C.sibling,D=C.return;if(HV(C),C===b){Wr=null;break}if(A!==null){A.return=D,Wr=A;break}Wr=D}}}var k=d.alternate;if(k!==null){var B=k.child;if(B!==null){k.child=null;do{var N=B.sibling;B.sibling=null,B=N}while(B!==null)}}Wr=d}}if(d.subtreeFlags&2064&&f!==null)f.return=d,Wr=f;else e:for(;Wr!==null;){if(d=Wr,d.flags&2048)switch(d.tag){case 0:case 11:case 15:j0(9,d,d.return)}var j=d.sibling;if(j!==null){j.return=d.return,Wr=j;break e}Wr=d.return}}var V=e.current;for(Wr=V;Wr!==null;){f=Wr;var K=f.child;if(f.subtreeFlags&2064&&K!==null)K.return=f,Wr=K;else e:for(f=V;Wr!==null;){if(o=Wr,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:FC(9,o)}}catch(Z){Da(o,o.return,Z)}if(o===f){Wr=null;break e}var Y=o.sibling;if(Y!==null){Y.return=o.return,Wr=Y;break e}Wr=o.return}}if(Co=s,xf(),Ou&&typeof Ou.onPostCommitFiberRoot=="function")try{Ou.onPostCommitFiberRoot(MC,e)}catch{}i=!0}return i}finally{jo=n,fc.transition=t}}return!1}function qN(e,t,n){t=Iv(n,t),t=DV(e,t,1),e=nf(e,t,1),t=sl(),e!==null&&(Kx(e,1,t),Ol(e,t))}function Da(e,t,n){if(e.tag===3)qN(e,e,n);else for(;t!==null;){if(t.tag===3){qN(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(rf===null||!rf.has(i))){e=Iv(n,e),e=LV(t,e,1),t=nf(t,e,1),e=sl(),t!==null&&(Kx(t,1,e),Ol(t,e));break}}t=t.return}}function CZ(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=sl(),e.pingedLanes|=e.suspendedLanes&n,fs===e&&(bs&n)===n&&(ns===4||ns===3&&(bs&130023424)===bs&&500>Ba()-JA?kp(e,0):YA|=n),Ol(e,t)}function e6(e,t){t===0&&(e.mode&1?(t=dw,dw<<=1,!(dw&130023424)&&(dw=4194304)):t=1);var n=sl();e=zd(e,t),e!==null&&(Kx(e,t,n),Ol(e,n))}function EZ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),e6(e,n)}function TZ(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(sr(314))}i!==null&&i.delete(t),e6(e,n)}var t6;t6=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rl.current)Ml=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ml=!1,fZ(e,t,n);Ml=!!(e.flags&131072)}else Ml=!1,ma&&t.flags&1048576&&oV(t,VS,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;iS(e,t),e=t.pendingProps;var s=Sv(t,Ns.current);pv(t,n),s=GA(null,t,i,e,s,n);var d=WA();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Al(i)?(d=!0,$S(t)):d=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$A(t),s.updater=kC,t.stateNode=s,s._reactInternals=t,sM(t,i,e,n),t=uM(null,t,i,!0,d,n)):(t.tag=0,ma&&d&&DA(t),ol(null,t,s,n),t=t.child),t;case 16:i=t.elementType;e:{switch(iS(e,t),e=t.pendingProps,s=i._init,i=s(i._payload),t.type=i,s=t.tag=PZ(i),e=Nc(i,e),s){case 0:t=cM(null,t,i,e,n);break e;case 1:t=FN(null,t,i,e,n);break e;case 11:t=zN(null,t,i,e,n);break e;case 14:t=kN(null,t,i,Nc(i.type,e),n);break e}throw Error(sr(306,i,""))}return t;case 0:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:Nc(i,s),cM(e,t,i,s,n);case 1:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:Nc(i,s),FN(e,t,i,s,n);case 3:e:{if(NV(t),e===null)throw Error(sr(387));i=t.pendingProps,d=t.memoizedState,s=d.element,dV(e,t),GS(t,i,null,n);var f=t.memoizedState;if(i=f.element,d.isDehydrated)if(d={element:i,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){s=Iv(Error(sr(423)),t),t=NN(e,t,i,n,s);break e}else if(i!==s){s=Iv(Error(sr(424)),t),t=NN(e,t,i,n,s);break e}else for(Vl=tf(t.stateNode.containerInfo.firstChild),Gl=t,ma=!0,Vc=null,n=cV(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Cv(),i===s){t=kd(e,t,n);break e}ol(e,t,i,n)}t=t.child}return t;case 5:return hV(t),e===null&&iM(t),i=t.type,s=t.pendingProps,d=e!==null?e.memoizedProps:null,f=s.children,QP(i,s)?f=null:d!==null&&QP(i,d)&&(t.flags|=32),FV(e,t),ol(e,t,f,n),t.child;case 6:return e===null&&iM(t),null;case 13:return BV(e,t,n);case 4:return jA(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Ev(t,null,i,n):ol(e,t,i,n),t.child;case 11:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:Nc(i,s),zN(e,t,i,s,n);case 7:return ol(e,t,t.pendingProps,n),t.child;case 8:return ol(e,t,t.pendingProps.children,n),t.child;case 12:return ol(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,s=t.pendingProps,d=t.memoizedProps,f=s.value,ia(US,i._currentValue),i._currentValue=f,d!==null)if(Zc(d.value,f)){if(d.children===s.children&&!Rl.current){t=kd(e,t,n);break e}}else for(d=t.child,d!==null&&(d.return=t);d!==null;){var o=d.dependencies;if(o!==null){f=d.child;for(var y=o.firstContext;y!==null;){if(y.context===i){if(d.tag===1){y=Ad(-1,n&-n),y.tag=2;var b=d.updateQueue;if(b!==null){b=b.shared;var C=b.pending;C===null?y.next=y:(y.next=C.next,C.next=y),b.pending=y}}d.lanes|=n,y=d.alternate,y!==null&&(y.lanes|=n),oM(d.return,n,t),o.lanes|=n;break}y=y.next}}else if(d.tag===10)f=d.type===t.type?null:d.child;else if(d.tag===18){if(f=d.return,f===null)throw Error(sr(341));f.lanes|=n,o=f.alternate,o!==null&&(o.lanes|=n),oM(f,n,t),f=d.sibling}else f=d.child;if(f!==null)f.return=d;else for(f=d;f!==null;){if(f===t){f=null;break}if(d=f.sibling,d!==null){d.return=f.return,f=d;break}f=f.return}d=f}ol(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,i=t.pendingProps.children,pv(t,n),s=mc(s),i=i(s),t.flags|=1,ol(e,t,i,n),t.child;case 14:return i=t.type,s=Nc(i,t.pendingProps),s=Nc(i.type,s),kN(e,t,i,s,n);case 15:return zV(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:Nc(i,s),iS(e,t),t.tag=1,Al(i)?(e=!0,$S(t)):e=!1,pv(t,n),OV(t,i,s),sM(t,i,s,n),uM(null,t,i,!0,e,n);case 19:return $V(e,t,n);case 22:return kV(e,t,n)}throw Error(sr(156,t.tag))};function n6(e,t){return Mj(e,t)}function IZ(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hc(e,t,n,i){return new IZ(e,t,n,i)}function nO(e){return e=e.prototype,!(!e||!e.isReactComponent)}function PZ(e){if(typeof e=="function")return nO(e)?1:0;if(e!=null){if(e=e.$$typeof,e===bA)return 11;if(e===wA)return 14}return 2}function af(e,t){var n=e.alternate;return n===null?(n=hc(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function sS(e,t,n,i,s,d){var f=2;if(i=e,typeof e=="function")nO(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case Xg:return Fp(n.children,s,d,t);case xA:f=8,s|=8;break;case AP:return e=hc(12,n,t,s|2),e.elementType=AP,e.lanes=d,e;case OP:return e=hc(13,n,t,s),e.elementType=OP,e.lanes=d,e;case DP:return e=hc(19,n,t,s),e.elementType=DP,e.lanes=d,e;case hj:return BC(n,s,d,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uj:f=10;break e;case dj:f=9;break e;case bA:f=11;break e;case wA:f=14;break e;case zh:f=16,i=null;break e}throw Error(sr(130,e==null?e:typeof e,""))}return t=hc(f,n,t,s),t.elementType=e,t.type=i,t.lanes=d,t}function Fp(e,t,n,i){return e=hc(7,e,i,t),e.lanes=n,e}function BC(e,t,n,i){return e=hc(22,e,i,t),e.elementType=hj,e.lanes=n,e.stateNode={isHidden:!1},e}function SI(e,t,n){return e=hc(6,e,null,t),e.lanes=n,e}function CI(e,t,n){return t=hc(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function MZ(e,t,n,i,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=iI(0),this.expirationTimes=iI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=iI(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rO(e,t,n,i,s,d,f,o,y){return e=new MZ(e,t,n,o,y),t===1?(t=1,d===!0&&(t|=8)):t=0,d=hc(3,null,null,t),e.current=d,d.stateNode=e,d.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$A(d),e}function RZ(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kg,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function r6(e){if(!e)return cf;e=e._reactInternals;e:{if(em(e)!==e||e.tag!==1)throw Error(sr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Al(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(sr(171))}if(e.tag===1){var n=e.type;if(Al(n))return rV(e,n,t)}return t}function i6(e,t,n,i,s,d,f,o,y){return e=rO(n,i,!0,e,s,d,f,o,y),e.context=r6(null),n=e.current,i=sl(),s=of(n),d=Ad(i,s),d.callback=t??null,nf(n,d,s),e.current.lanes=s,Kx(e,s,i),Ol(e,i),e}function $C(e,t,n,i){var s=t.current,d=sl(),f=of(s);return n=r6(n),t.context===null?t.context=n:t.pendingContext=n,t=Ad(d,f),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=nf(s,t,f),e!==null&&(Wc(e,s,f,d),tS(e,s,f)),f}function QS(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function KN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function iO(e,t){KN(e,t),(e=e.alternate)&&KN(e,t)}function AZ(){return null}var o6=typeof reportError=="function"?reportError:function(e){console.error(e)};function oO(e){this._internalRoot=e}jC.prototype.render=oO.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(sr(409));$C(e,t,null,null)};jC.prototype.unmount=oO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wp(function(){$C(null,e,null,null)}),t[Ld]=null}};function jC(e){this._internalRoot=e}jC.prototype.unstable_scheduleHydration=function(e){if(e){var t=kj();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nh.length&&t!==0&&t<Nh[n].priority;n++);Nh.splice(n,0,e),n===0&&Nj(e)}};function aO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function VC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function XN(){}function OZ(e,t,n,i,s){if(s){if(typeof i=="function"){var d=i;i=function(){var b=QS(f);d.call(b)}}var f=i6(t,i,e,0,null,!1,!1,"",XN);return e._reactRootContainer=f,e[Ld]=f.current,lx(e.nodeType===8?e.parentNode:e),Wp(),f}for(;s=e.lastChild;)e.removeChild(s);if(typeof i=="function"){var o=i;i=function(){var b=QS(y);o.call(b)}}var y=rO(e,0,!1,null,null,!1,!1,"",XN);return e._reactRootContainer=y,e[Ld]=y.current,lx(e.nodeType===8?e.parentNode:e),Wp(function(){$C(t,y,n,i)}),y}function UC(e,t,n,i,s){var d=n._reactRootContainer;if(d){var f=d;if(typeof s=="function"){var o=s;s=function(){var y=QS(f);o.call(y)}}$C(t,f,e,s)}else f=OZ(n,t,e,s,i);return QS(f)}Lj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=C0(t.pendingLanes);n!==0&&(EA(t,n|1),Ol(t,Ba()),!(Co&6)&&(Pv=Ba()+500,xf()))}break;case 13:Wp(function(){var i=zd(e,1);if(i!==null){var s=sl();Wc(i,e,1,s)}}),iO(e,1)}};TA=function(e){if(e.tag===13){var t=zd(e,134217728);if(t!==null){var n=sl();Wc(t,e,134217728,n)}iO(e,134217728)}};zj=function(e){if(e.tag===13){var t=of(e),n=zd(e,t);if(n!==null){var i=sl();Wc(n,e,t,i)}iO(e,t)}};kj=function(){return jo};Fj=function(e,t){var n=jo;try{return jo=e,t()}finally{jo=n}};UP=function(e,t,n){switch(t){case"input":if(kP(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=DC(i);if(!s)throw Error(sr(90));pj(i),kP(i,s)}}}break;case"textarea":gj(e,n);break;case"select":t=n.value,t!=null&&uv(e,!!n.multiple,t,!1)}};Sj=QA;Cj=Wp;var DZ={usingClientEntryPoint:!1,Events:[Zx,Qg,DC,bj,wj,QA]},c0={findFiberByHostInstance:Ap,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LZ={bundleType:c0.bundleType,version:c0.version,rendererPackageName:c0.rendererPackageName,rendererConfig:c0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ij(e),e===null?null:e.stateNode},findFiberByHostInstance:c0.findFiberByHostInstance||AZ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ww=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ww.isDisabled&&ww.supportsFiber)try{MC=ww.inject(LZ),Ou=ww}catch{}}Kl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DZ;Kl.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aO(t))throw Error(sr(200));return RZ(e,t,null,n)};Kl.createRoot=function(e,t){if(!aO(e))throw Error(sr(299));var n=!1,i="",s=o6;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=rO(e,1,!1,null,null,n,!1,i,s),e[Ld]=t.current,lx(e.nodeType===8?e.parentNode:e),new oO(t)};Kl.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(sr(188)):(e=Object.keys(e).join(","),Error(sr(268,e)));return e=Ij(t),e=e===null?null:e.stateNode,e};Kl.flushSync=function(e){return Wp(e)};Kl.hydrate=function(e,t,n){if(!VC(t))throw Error(sr(200));return UC(null,e,t,!0,n)};Kl.hydrateRoot=function(e,t,n){if(!aO(e))throw Error(sr(405));var i=n!=null&&n.hydratedSources||null,s=!1,d="",f=o6;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),t=i6(t,null,e,1,n??null,s,!1,d,f),e[Ld]=t.current,lx(e),i)for(e=0;e<i.length;e++)n=i[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new jC(t)};Kl.render=function(e,t,n){if(!VC(t))throw Error(sr(200));return UC(null,e,t,!1,n)};Kl.unmountComponentAtNode=function(e){if(!VC(e))throw Error(sr(40));return e._reactRootContainer?(Wp(function(){UC(null,null,e,!1,function(){e._reactRootContainer=null,e[Ld]=null})}),!0):!1};Kl.unstable_batchedUpdates=QA;Kl.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!VC(n))throw Error(sr(200));if(e==null||e._reactInternals===void 0)throw Error(sr(38));return UC(e,t,n,!1,i)};Kl.version="18.3.1-next-f1338f8080-20240426";function a6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a6)}catch(e){console.error(e)}}a6(),aj.exports=Kl;var ku=aj.exports;const vx=jv(ku),zZ=K4({__proto__:null,default:vx},[ku]);var s6,ZN=ku;s6=ZN.createRoot,ZN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _x(){return _x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_x.apply(this,arguments)}var Vh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Vh||(Vh={}));const YN="popstate";function kZ(e){e===void 0&&(e={});function t(i,s){let{pathname:d,search:f,hash:o}=i.location;return wM("",{pathname:d,search:f,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){return typeof s=="string"?s:c6(s)}return NZ(t,n,null,e)}function Ya(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function l6(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function FZ(){return Math.random().toString(36).substr(2,8)}function JN(e,t){return{usr:e.state,key:e.key,idx:t}}function wM(e,t,n,i){return n===void 0&&(n=null),_x({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Gv(t):t,{state:n,key:t&&t.key||i||FZ()})}function c6(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function Gv(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function NZ(e,t,n,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:d=!1}=i,f=s.history,o=Vh.Pop,y=null,b=C();b==null&&(b=0,f.replaceState(_x({},f.state,{idx:b}),""));function C(){return(f.state||{idx:null}).idx}function P(){o=Vh.Pop;let N=C(),j=N==null?null:N-b;b=N,y&&y({action:o,location:B.location,delta:j})}function A(N,j){o=Vh.Push;let V=wM(B.location,N,j);b=C()+1;let K=JN(V,b),Y=B.createHref(V);try{f.pushState(K,"",Y)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;s.location.assign(Y)}d&&y&&y({action:o,location:B.location,delta:1})}function D(N,j){o=Vh.Replace;let V=wM(B.location,N,j);b=C();let K=JN(V,b),Y=B.createHref(V);f.replaceState(K,"",Y),d&&y&&y({action:o,location:B.location,delta:0})}function k(N){let j=s.location.origin!=="null"?s.location.origin:s.location.href,V=typeof N=="string"?N:c6(N);return V=V.replace(/ $/,"%20"),Ya(j,"No window.location.(origin|href) available to create URL for href: "+V),new URL(V,j)}let B={get action(){return o},get location(){return e(s,f)},listen(N){if(y)throw new Error("A history only accepts one active listener");return s.addEventListener(YN,P),y=N,()=>{s.removeEventListener(YN,P),y=null}},createHref(N){return t(s,N)},createURL:k,encodeLocation(N){let j=k(N);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:A,replace:D,go(N){return f.go(N)}};return B}var QN;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(QN||(QN={}));function BZ(e,t,n){return n===void 0&&(n="/"),$Z(e,t,n)}function $Z(e,t,n,i){let s=typeof t=="string"?Gv(t):t,d=h6(s.pathname||"/",n);if(d==null)return null;let f=u6(e);jZ(f);let o=null;for(let y=0;o==null&&y<f.length;++y){let b=QZ(d);o=ZZ(f[y],b)}return o}function u6(e,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let s=(d,f,o)=>{let y={relativePath:o===void 0?d.path||"":o,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};y.relativePath.startsWith("/")&&(Ya(y.relativePath.startsWith(i),'Absolute route path "'+y.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),y.relativePath=y.relativePath.slice(i.length));let b=Np([i,y.relativePath]),C=n.concat(y);d.children&&d.children.length>0&&(Ya(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),u6(d.children,t,C,b)),!(d.path==null&&!d.index)&&t.push({path:b,score:KZ(b,d.index),routesMeta:C})};return e.forEach((d,f)=>{var o;if(d.path===""||!((o=d.path)!=null&&o.includes("?")))s(d,f);else for(let y of d6(d.path))s(d,f,y)}),t}function d6(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,s=n.endsWith("?"),d=n.replace(/\?$/,"");if(i.length===0)return s?[d,""]:[d];let f=d6(i.join("/")),o=[];return o.push(...f.map(y=>y===""?d:[d,y].join("/"))),s&&o.push(...f),o.map(y=>e.startsWith("/")&&y===""?"/":y)}function jZ(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:XZ(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const VZ=/^:[\w-]+$/,UZ=3,HZ=2,GZ=1,WZ=10,qZ=-2,e3=e=>e==="*";function KZ(e,t){let n=e.split("/"),i=n.length;return n.some(e3)&&(i+=qZ),t&&(i+=HZ),n.filter(s=>!e3(s)).reduce((s,d)=>s+(VZ.test(d)?UZ:d===""?GZ:WZ),i)}function XZ(e,t){return e.length===t.length&&e.slice(0,-1).every((i,s)=>i===t[s])?e[e.length-1]-t[t.length-1]:0}function ZZ(e,t,n){let{routesMeta:i}=e,s={},d="/",f=[];for(let o=0;o<i.length;++o){let y=i[o],b=o===i.length-1,C=d==="/"?t:t.slice(d.length)||"/",P=YZ({path:y.relativePath,caseSensitive:y.caseSensitive,end:b},C),A=y.route;if(!P)return null;Object.assign(s,P.params),f.push({params:s,pathname:Np([d,P.pathname]),pathnameBase:rY(Np([d,P.pathnameBase])),route:A}),P.pathnameBase!=="/"&&(d=Np([d,P.pathnameBase]))}return f}function YZ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=JZ(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let d=s[0],f=d.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:i.reduce((b,C,P)=>{let{paramName:A,isOptional:D}=C;if(A==="*"){let B=o[P]||"";f=d.slice(0,d.length-B.length).replace(/(.)\/+$/,"$1")}const k=o[P];return D&&!k?b[A]=void 0:b[A]=(k||"").replace(/%2F/g,"/"),b},{}),pathname:d,pathnameBase:f,pattern:e}}function JZ(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),l6(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,o,y)=>(i.push({paramName:o,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),i]}function QZ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return l6(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function h6(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function eY(e,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:s=""}=typeof e=="string"?Gv(e):e;return{pathname:n?n.startsWith("/")?n:tY(n,t):t,search:iY(i),hash:oY(s)}}function tY(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function EI(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nY(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function f6(e,t){let n=nY(e);return t?n.map((i,s)=>s===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function p6(e,t,n,i){i===void 0&&(i=!1);let s;typeof e=="string"?s=Gv(e):(s=_x({},e),Ya(!s.pathname||!s.pathname.includes("?"),EI("?","pathname","search",s)),Ya(!s.pathname||!s.pathname.includes("#"),EI("#","pathname","hash",s)),Ya(!s.search||!s.search.includes("#"),EI("#","search","hash",s)));let d=e===""||s.pathname==="",f=d?"/":s.pathname,o;if(f==null)o=n;else{let P=t.length-1;if(!i&&f.startsWith("..")){let A=f.split("/");for(;A[0]==="..";)A.shift(),P-=1;s.pathname=A.join("/")}o=P>=0?t[P]:"/"}let y=eY(s,o),b=f&&f!=="/"&&f.endsWith("/"),C=(d||f===".")&&n.endsWith("/");return!y.pathname.endsWith("/")&&(b||C)&&(y.pathname+="/"),y}const Np=e=>e.join("/").replace(/\/\/+/g,"/"),rY=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),iY=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,oY=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function aY(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const m6=["post","put","patch","delete"];new Set(m6);const sY=["get",...m6];new Set(sY);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},yx.apply(this,arguments)}const sO=I.createContext(null),lY=I.createContext(null),Jx=I.createContext(null),HC=I.createContext(null),tm=I.createContext({outlet:null,matches:[],isDataRoute:!1}),g6=I.createContext(null);function Qx(){return I.useContext(HC)!=null}function GC(){return Qx()||Ya(!1),I.useContext(HC).location}function v6(e){I.useContext(Jx).static||I.useLayoutEffect(e)}function _6(){let{isDataRoute:e}=I.useContext(tm);return e?bY():cY()}function cY(){Qx()||Ya(!1);let e=I.useContext(sO),{basename:t,future:n,navigator:i}=I.useContext(Jx),{matches:s}=I.useContext(tm),{pathname:d}=GC(),f=JSON.stringify(f6(s,n.v7_relativeSplatPath)),o=I.useRef(!1);return v6(()=>{o.current=!0}),I.useCallback(function(b,C){if(C===void 0&&(C={}),!o.current)return;if(typeof b=="number"){i.go(b);return}let P=p6(b,JSON.parse(f),d,C.relative==="path");e==null&&t!=="/"&&(P.pathname=P.pathname==="/"?t:Np([t,P.pathname])),(C.replace?i.replace:i.push)(P,C.state,C)},[t,i,f,d,e])}function uY(e,t){return dY(e,t)}function dY(e,t,n,i){Qx()||Ya(!1);let{navigator:s}=I.useContext(Jx),{matches:d}=I.useContext(tm),f=d[d.length-1],o=f?f.params:{};f&&f.pathname;let y=f?f.pathnameBase:"/";f&&f.route;let b=GC(),C;if(t){var P;let N=typeof t=="string"?Gv(t):t;y==="/"||(P=N.pathname)!=null&&P.startsWith(y)||Ya(!1),C=N}else C=b;let A=C.pathname||"/",D=A;if(y!=="/"){let N=y.replace(/^\//,"").split("/");D="/"+A.replace(/^\//,"").split("/").slice(N.length).join("/")}let k=BZ(e,{pathname:D}),B=gY(k&&k.map(N=>Object.assign({},N,{params:Object.assign({},o,N.params),pathname:Np([y,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?y:Np([y,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),d,n,i);return t&&B?I.createElement(HC.Provider,{value:{location:yx({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:Vh.Pop}},B):B}function hY(){let e=xY(),t=aY(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),n?I.createElement("pre",{style:s},n):null,null)}const fY=I.createElement(hY,null);class pY extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?I.createElement(tm.Provider,{value:this.props.routeContext},I.createElement(g6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mY(e){let{routeContext:t,match:n,children:i}=e,s=I.useContext(sO);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),I.createElement(tm.Provider,{value:t},i)}function gY(e,t,n,i){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),e==null){var d;if(!n)return null;if(n.errors)e=n.matches;else if((d=i)!=null&&d.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let f=e,o=(s=n)==null?void 0:s.errors;if(o!=null){let C=f.findIndex(P=>P.route.id&&(o==null?void 0:o[P.route.id])!==void 0);C>=0||Ya(!1),f=f.slice(0,Math.min(f.length,C+1))}let y=!1,b=-1;if(n&&i&&i.v7_partialHydration)for(let C=0;C<f.length;C++){let P=f[C];if((P.route.HydrateFallback||P.route.hydrateFallbackElement)&&(b=C),P.route.id){let{loaderData:A,errors:D}=n,k=P.route.loader&&A[P.route.id]===void 0&&(!D||D[P.route.id]===void 0);if(P.route.lazy||k){y=!0,b>=0?f=f.slice(0,b+1):f=[f[0]];break}}}return f.reduceRight((C,P,A)=>{let D,k=!1,B=null,N=null;n&&(D=o&&P.route.id?o[P.route.id]:void 0,B=P.route.errorElement||fY,y&&(b<0&&A===0?(wY("route-fallback"),k=!0,N=null):b===A&&(k=!0,N=P.route.hydrateFallbackElement||null)));let j=t.concat(f.slice(0,A+1)),V=()=>{let K;return D?K=B:k?K=N:P.route.Component?K=I.createElement(P.route.Component,null):P.route.element?K=P.route.element:K=C,I.createElement(mY,{match:P,routeContext:{outlet:C,matches:j,isDataRoute:n!=null},children:K})};return n&&(P.route.ErrorBoundary||P.route.errorElement||A===0)?I.createElement(pY,{location:n.location,revalidation:n.revalidation,component:B,error:D,children:V(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):V()},null)}var y6=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(y6||{}),x6=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(x6||{});function vY(e){let t=I.useContext(sO);return t||Ya(!1),t}function _Y(e){let t=I.useContext(lY);return t||Ya(!1),t}function yY(e){let t=I.useContext(tm);return t||Ya(!1),t}function b6(e){let t=yY(),n=t.matches[t.matches.length-1];return n.route.id||Ya(!1),n.route.id}function xY(){var e;let t=I.useContext(g6),n=_Y(),i=b6();return t!==void 0?t:(e=n.errors)==null?void 0:e[i]}function bY(){let{router:e}=vY(y6.UseNavigateStable),t=b6(x6.UseNavigateStable),n=I.useRef(!1);return v6(()=>{n.current=!0}),I.useCallback(function(s,d){d===void 0&&(d={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,yx({fromRouteId:t},d)))},[e,t])}const t3={};function wY(e,t,n){t3[e]||(t3[e]=!0)}function SY(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Su(e){let{to:t,replace:n,state:i,relative:s}=e;Qx()||Ya(!1);let{future:d,static:f}=I.useContext(Jx),{matches:o}=I.useContext(tm),{pathname:y}=GC(),b=_6(),C=p6(t,f6(o,d.v7_relativeSplatPath),y,s==="path"),P=JSON.stringify(C);return I.useEffect(()=>b(JSON.parse(P),{replace:n,state:i,relative:s}),[b,P,s,n,i]),null}function Tp(e){Ya(!1)}function CY(e){let{basename:t="/",children:n=null,location:i,navigationType:s=Vh.Pop,navigator:d,static:f=!1,future:o}=e;Qx()&&Ya(!1);let y=t.replace(/^\/*/,"/"),b=I.useMemo(()=>({basename:y,navigator:d,static:f,future:yx({v7_relativeSplatPath:!1},o)}),[y,o,d,f]);typeof i=="string"&&(i=Gv(i));let{pathname:C="/",search:P="",hash:A="",state:D=null,key:k="default"}=i,B=I.useMemo(()=>{let N=h6(C,y);return N==null?null:{location:{pathname:N,search:P,hash:A,state:D,key:k},navigationType:s}},[y,C,P,A,D,k,s]);return B==null?null:I.createElement(Jx.Provider,{value:b},I.createElement(HC.Provider,{children:n,value:B}))}function EY(e){let{children:t,location:n}=e;return uY(SM(t),n)}new Promise(()=>{});function SM(e,t){t===void 0&&(t=[]);let n=[];return I.Children.forEach(e,(i,s)=>{if(!I.isValidElement(i))return;let d=[...t,s];if(i.type===I.Fragment){n.push.apply(n,SM(i.props.children,d));return}i.type!==Tp&&Ya(!1),!i.props.index||!i.props.children||Ya(!1);let f={id:i.props.id||d.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=SM(i.props.children,d)),n.push(f)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const TY="6";try{window.__reactRouterVersion=TY}catch{}const IY="startTransition",n3=qx[IY];function PY(e){let{basename:t,children:n,future:i,window:s}=e,d=I.useRef();d.current==null&&(d.current=kZ({window:s,v5Compat:!0}));let f=d.current,[o,y]=I.useState({action:f.action,location:f.location}),{v7_startTransition:b}=i||{},C=I.useCallback(P=>{b&&n3?n3(()=>y(P)):y(P)},[y,b]);return I.useLayoutEffect(()=>f.listen(C),[f,C]),I.useEffect(()=>SY(i),[i]),I.createElement(CY,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:f,future:i})}var r3;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(r3||(r3={}));var i3;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(i3||(i3={}));var w6={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(cK,function(){var n,i,s;function d(o,y){if(!n)n=y;else if(!i)i=y;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",C={};n(C),s=y(C),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}d(["exports"],function(o){var y=1e-6,b=typeof Float32Array<"u"?Float32Array:Array;function C(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=l*v-p*h;return _?(c[0]=v*(_=1/_),c[1]=-h*_,c[2]=-p*_,c[3]=l*_,c):null}function P(){var c=new b(9);return b!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function A(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=r[4],w=r[5],T=r[6],M=r[7],L=r[8];return c[0]=_*L-w*M,c[1]=p*M-h*L,c[2]=h*w-p*_,c[3]=w*T-v*L,c[4]=l*L-p*T,c[5]=p*v-l*w,c[6]=v*M-_*T,c[7]=h*T-l*M,c[8]=l*_-h*v,c}function D(c,r,l){var h=r[0],p=r[1],v=r[2],_=r[3],w=r[4],T=r[5],M=r[6],L=r[7],z=r[8],F=l[0],G=l[1],W=l[2],J=l[3],oe=l[4],le=l[5],he=l[6],me=l[7],be=l[8];return c[0]=F*h+G*_+W*M,c[1]=F*p+G*w+W*L,c[2]=F*v+G*T+W*z,c[3]=J*h+oe*_+le*M,c[4]=J*p+oe*w+le*L,c[5]=J*v+oe*T+le*z,c[6]=he*h+me*_+be*M,c[7]=he*p+me*w+be*L,c[8]=he*v+me*T+be*z,c}function k(){var c=new b(16);return b!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c}function B(c){var r=new b(16);return r[0]=c[0],r[1]=c[1],r[2]=c[2],r[3]=c[3],r[4]=c[4],r[5]=c[5],r[6]=c[6],r[7]=c[7],r[8]=c[8],r[9]=c[9],r[10]=c[10],r[11]=c[11],r[12]=c[12],r[13]=c[13],r[14]=c[14],r[15]=c[15],r}function N(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function j(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=r[4],w=r[5],T=r[6],M=r[7],L=r[8],z=r[9],F=r[10],G=r[11],W=r[12],J=r[13],oe=r[14],le=r[15],he=l*w-h*_,me=l*T-p*_,be=l*M-v*_,Ne=h*T-p*w,Ae=h*M-v*w,He=p*M-v*T,Ze=L*J-z*W,et=L*oe-F*W,Tt=L*le-G*W,ct=z*oe-F*J,At=z*le-G*J,Bt=F*le-G*oe,qt=he*Bt-me*At+be*ct+Ne*Tt-Ae*et+He*Ze;return qt?(c[0]=(w*Bt-T*At+M*ct)*(qt=1/qt),c[1]=(p*At-h*Bt-v*ct)*qt,c[2]=(J*He-oe*Ae+le*Ne)*qt,c[3]=(F*Ae-z*He-G*Ne)*qt,c[4]=(T*Tt-_*Bt-M*et)*qt,c[5]=(l*Bt-p*Tt+v*et)*qt,c[6]=(oe*be-W*He-le*me)*qt,c[7]=(L*He-F*be+G*me)*qt,c[8]=(_*At-w*Tt+M*Ze)*qt,c[9]=(h*Tt-l*At-v*Ze)*qt,c[10]=(W*Ae-J*be+le*he)*qt,c[11]=(z*be-L*Ae-G*he)*qt,c[12]=(w*et-_*ct-T*Ze)*qt,c[13]=(l*ct-h*et+p*Ze)*qt,c[14]=(J*me-W*Ne-oe*he)*qt,c[15]=(L*Ne-z*me+F*he)*qt,c):null}function V(c,r,l){var h=r[0],p=r[1],v=r[2],_=r[3],w=r[4],T=r[5],M=r[6],L=r[7],z=r[8],F=r[9],G=r[10],W=r[11],J=r[12],oe=r[13],le=r[14],he=r[15],me=l[0],be=l[1],Ne=l[2],Ae=l[3];return c[0]=me*h+be*w+Ne*z+Ae*J,c[1]=me*p+be*T+Ne*F+Ae*oe,c[2]=me*v+be*M+Ne*G+Ae*le,c[3]=me*_+be*L+Ne*W+Ae*he,c[4]=(me=l[4])*h+(be=l[5])*w+(Ne=l[6])*z+(Ae=l[7])*J,c[5]=me*p+be*T+Ne*F+Ae*oe,c[6]=me*v+be*M+Ne*G+Ae*le,c[7]=me*_+be*L+Ne*W+Ae*he,c[8]=(me=l[8])*h+(be=l[9])*w+(Ne=l[10])*z+(Ae=l[11])*J,c[9]=me*p+be*T+Ne*F+Ae*oe,c[10]=me*v+be*M+Ne*G+Ae*le,c[11]=me*_+be*L+Ne*W+Ae*he,c[12]=(me=l[12])*h+(be=l[13])*w+(Ne=l[14])*z+(Ae=l[15])*J,c[13]=me*p+be*T+Ne*F+Ae*oe,c[14]=me*v+be*M+Ne*G+Ae*le,c[15]=me*_+be*L+Ne*W+Ae*he,c}function K(c,r,l){var h,p,v,_,w,T,M,L,z,F,G,W,J=l[0],oe=l[1],le=l[2];return r===c?(c[12]=r[0]*J+r[4]*oe+r[8]*le+r[12],c[13]=r[1]*J+r[5]*oe+r[9]*le+r[13],c[14]=r[2]*J+r[6]*oe+r[10]*le+r[14],c[15]=r[3]*J+r[7]*oe+r[11]*le+r[15]):(p=r[1],v=r[2],_=r[3],w=r[4],T=r[5],M=r[6],L=r[7],z=r[8],F=r[9],G=r[10],W=r[11],c[0]=h=r[0],c[1]=p,c[2]=v,c[3]=_,c[4]=w,c[5]=T,c[6]=M,c[7]=L,c[8]=z,c[9]=F,c[10]=G,c[11]=W,c[12]=h*J+w*oe+z*le+r[12],c[13]=p*J+T*oe+F*le+r[13],c[14]=v*J+M*oe+G*le+r[14],c[15]=_*J+L*oe+W*le+r[15]),c}function Y(c,r,l){var h=l[0],p=l[1],v=l[2];return c[0]=r[0]*h,c[1]=r[1]*h,c[2]=r[2]*h,c[3]=r[3]*h,c[4]=r[4]*p,c[5]=r[5]*p,c[6]=r[6]*p,c[7]=r[7]*p,c[8]=r[8]*v,c[9]=r[9]*v,c[10]=r[10]*v,c[11]=r[11]*v,c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15],c}function Z(c,r,l){var h=Math.sin(l),p=Math.cos(l),v=r[4],_=r[5],w=r[6],T=r[7],M=r[8],L=r[9],z=r[10],F=r[11];return r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[4]=v*p+M*h,c[5]=_*p+L*h,c[6]=w*p+z*h,c[7]=T*p+F*h,c[8]=M*p-v*h,c[9]=L*p-_*h,c[10]=z*p-w*h,c[11]=F*p-T*h,c}function te(c,r,l){var h=Math.sin(l),p=Math.cos(l),v=r[0],_=r[1],w=r[2],T=r[3],M=r[8],L=r[9],z=r[10],F=r[11];return r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[0]=v*p-M*h,c[1]=_*p-L*h,c[2]=w*p-z*h,c[3]=T*p-F*h,c[8]=v*h+M*p,c[9]=_*h+L*p,c[10]=w*h+z*p,c[11]=T*h+F*p,c}function ne(c,r,l){var h=Math.sin(l),p=Math.cos(l),v=r[0],_=r[1],w=r[2],T=r[3],M=r[4],L=r[5],z=r[6],F=r[7];return r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[0]=v*p+M*h,c[1]=_*p+L*h,c[2]=w*p+z*h,c[3]=T*p+F*h,c[4]=M*p-v*h,c[5]=L*p-_*h,c[6]=z*p-w*h,c[7]=F*p-T*h,c}function se(c,r){return c[0]=r[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=r[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=r[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function ee(c,r,l){var h,p,v,_=l[0],w=l[1],T=l[2],M=Math.sqrt(_*_+w*w+T*T);return M<y?null:(_*=M=1/M,w*=M,T*=M,h=Math.sin(r),p=Math.cos(r),c[0]=_*_*(v=1-p)+p,c[1]=w*_*v+T*h,c[2]=T*_*v-w*h,c[3]=0,c[4]=_*w*v-T*h,c[5]=w*w*v+p,c[6]=T*w*v+_*h,c[7]=0,c[8]=_*T*v+w*h,c[9]=w*T*v-_*h,c[10]=T*T*v+p,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function de(c,r){var l=r[0],h=r[1],p=r[2],v=r[4],_=r[5],w=r[6],T=r[8],M=r[9],L=r[10];return c[0]=Math.sqrt(l*l+h*h+p*p),c[1]=Math.sqrt(v*v+_*_+w*w),c[2]=Math.sqrt(T*T+M*M+L*L),c}function fe(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=l+l,w=h+h,T=p+p,M=l*_,L=h*_,z=h*w,F=p*_,G=p*w,W=p*T,J=v*_,oe=v*w,le=v*T;return c[0]=1-z-W,c[1]=L+le,c[2]=F-oe,c[3]=0,c[4]=L-le,c[5]=1-M-W,c[6]=G+J,c[7]=0,c[8]=F+oe,c[9]=G-J,c[10]=1-M-z,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}var ye=V;function ge(){var c=new b(3);return b!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function we(c){var r=new b(3);return r[0]=c[0],r[1]=c[1],r[2]=c[2],r}function Se(c){var r=c[0],l=c[1],h=c[2];return Math.sqrt(r*r+l*l+h*h)}function xe(c,r,l){var h=new b(3);return h[0]=c,h[1]=r,h[2]=l,h}function Te(c,r,l,h){return c[0]=r,c[1]=l,c[2]=h,c}function ze(c,r,l){return c[0]=r[0]+l[0],c[1]=r[1]+l[1],c[2]=r[2]+l[2],c}function Ue(c,r,l){return c[0]=r[0]-l[0],c[1]=r[1]-l[1],c[2]=r[2]-l[2],c}function We(c,r,l){return c[0]=r[0]*l[0],c[1]=r[1]*l[1],c[2]=r[2]*l[2],c}function Be(c,r,l){return c[0]=Math.min(r[0],l[0]),c[1]=Math.min(r[1],l[1]),c[2]=Math.min(r[2],l[2]),c}function Xe(c,r,l){return c[0]=Math.max(r[0],l[0]),c[1]=Math.max(r[1],l[1]),c[2]=Math.max(r[2],l[2]),c}function qe(c,r,l){return c[0]=r[0]*l,c[1]=r[1]*l,c[2]=r[2]*l,c}function at(c,r,l,h){return c[0]=r[0]+l[0]*h,c[1]=r[1]+l[1]*h,c[2]=r[2]+l[2]*h,c}function Ke(c,r){var l=r[0]-c[0],h=r[1]-c[1],p=r[2]-c[2];return Math.sqrt(l*l+h*h+p*p)}function tt(c,r){var l=r[0]-c[0],h=r[1]-c[1],p=r[2]-c[2];return l*l+h*h+p*p}function vt(c){var r=c[0],l=c[1],h=c[2];return r*r+l*l+h*h}function Pt(c,r){return c[0]=-r[0],c[1]=-r[1],c[2]=-r[2],c}function ft(c,r){var l=r[0],h=r[1],p=r[2],v=l*l+h*h+p*p;return v>0&&(v=1/Math.sqrt(v)),c[0]=r[0]*v,c[1]=r[1]*v,c[2]=r[2]*v,c}function Nt(c,r){return c[0]*r[0]+c[1]*r[1]+c[2]*r[2]}function Rt(c,r,l){var h=r[0],p=r[1],v=r[2],_=l[0],w=l[1],T=l[2];return c[0]=p*T-v*w,c[1]=v*_-h*T,c[2]=h*w-p*_,c}function pt(c,r,l,h){var p=r[0],v=r[1],_=r[2];return c[0]=p+h*(l[0]-p),c[1]=v+h*(l[1]-v),c[2]=_+h*(l[2]-_),c}function yt(c,r,l){var h=r[0],p=r[1],v=r[2],_=l[3]*h+l[7]*p+l[11]*v+l[15];return c[0]=(l[0]*h+l[4]*p+l[8]*v+l[12])/(_=_||1),c[1]=(l[1]*h+l[5]*p+l[9]*v+l[13])/_,c[2]=(l[2]*h+l[6]*p+l[10]*v+l[14])/_,c}function xt(c,r,l){var h=r[0],p=r[1],v=r[2];return c[0]=h*l[0]+p*l[3]+v*l[6],c[1]=h*l[1]+p*l[4]+v*l[7],c[2]=h*l[2]+p*l[5]+v*l[8],c}function bt(c,r,l){var h=l[0],p=l[1],v=l[2],_=l[3],w=r[0],T=r[1],M=r[2],L=p*M-v*T,z=v*w-h*M,F=h*T-p*w;return c[0]=w+_*(L+=L)+p*(F+=F)-v*(z+=z),c[1]=T+_*z+v*L-h*F,c[2]=M+_*F+h*z-p*L,c}function Ct(c){return c[0]=0,c[1]=0,c[2]=0,c}function tn(c,r){return c[0]===r[0]&&c[1]===r[1]&&c[2]===r[2]}var Zt=Ue,In=We,Cn=Se;function Mt(){var c=new b(4);return b!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function hn(c,r,l){return c[0]=r[0]*l,c[1]=r[1]*l,c[2]=r[2]*l,c[3]=r[3]*l,c}function Jt(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=l*l+h*h+p*p+v*v;return _>0&&(_=1/Math.sqrt(_)),c[0]=l*_,c[1]=h*_,c[2]=p*_,c[3]=v*_,c}function Ut(c,r,l){var h=r[0],p=r[1],v=r[2],_=r[3];return c[0]=l[0]*h+l[4]*p+l[8]*v+l[12]*_,c[1]=l[1]*h+l[5]*p+l[9]*v+l[13]*_,c[2]=l[2]*h+l[6]*p+l[10]*v+l[14]*_,c[3]=l[3]*h+l[7]*p+l[11]*v+l[15]*_,c}function Tn(){var c=new b(4);return b!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function On(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function Kn(c,r,l){l*=.5;var h=r[0],p=r[1],v=r[2],_=r[3],w=Math.sin(l),T=Math.cos(l);return c[0]=h*T+_*w,c[1]=p*T+v*w,c[2]=v*T-p*w,c[3]=_*T-h*w,c}function Un(c,r,l){l*=.5;var h=r[0],p=r[1],v=r[2],_=r[3],w=Math.sin(l),T=Math.cos(l);return c[0]=h*T-v*w,c[1]=p*T+_*w,c[2]=v*T+h*w,c[3]=_*T-p*w,c}ge(),Mt();var Pn,Qn,un,nn=Jt,$n=(Pn=ge(),Qn=xe(1,0,0),un=xe(0,1,0),function(c,r,l){var h=Nt(r,l);return h<-.999999?(Rt(Pn,Qn,r),Cn(Pn)<1e-6&&Rt(Pn,un,r),ft(Pn,Pn),function(p,v,_){_*=.5;var w=Math.sin(_);p[0]=w*v[0],p[1]=w*v[1],p[2]=w*v[2],p[3]=Math.cos(_)}(c,Pn,Math.PI),c):h>.999999?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(Rt(Pn,r,l),c[0]=Pn[0],c[1]=Pn[1],c[2]=Pn[2],c[3]=1+h,nn(c,c))});function Ln(){var c=new b(2);return b!=Float32Array&&(c[0]=0,c[1]=0),c}function qn(c,r){var l=new b(2);return l[0]=c,l[1]=r,l}function er(c,r,l){return c[0]=r,c[1]=l,c}function tr(c,r,l){return c[0]=r[0]+l[0],c[1]=r[1]+l[1],c}function Jn(c,r,l){return c[0]=r[0]-l[0],c[1]=r[1]-l[1],c}function Ir(c,r,l){return c[0]=r[0]*l,c[1]=r[1]*l,c}function _r(c){var r=c[0],l=c[1];return Math.sqrt(r*r+l*l)}function $r(c,r){var l=r[0],h=r[1],p=l*l+h*h;return p>0&&(p=1/Math.sqrt(p)),c[0]=r[0]*p,c[1]=r[1]*p,c}function mr(c,r){return c[0]*r[0]+c[1]*r[1]}Tn(),Tn(),P();var yi,Vr,Kr=Jn;function Rr(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}Ln();var ii=function(){if(Vr)return yi;function c(r,l,h,p){this.cx=3*r,this.bx=3*(h-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=l,this.p2x=h,this.p2y=p}return Vr=1,yi=c,c.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,l){if(l===void 0&&(l=1e-6),r<0)return 0;if(r>1)return 1;for(var h=r,p=0;p<8;p++){var v=this.sampleCurveX(h)-r;if(Math.abs(v)<l)return h;var _=this.sampleCurveDerivativeX(h);if(Math.abs(_)<1e-6)break;h-=v/_}var w=0,T=1;for(h=r,p=0;p<20&&(v=this.sampleCurveX(h),!(Math.abs(v-r)<l));p++)r>v?w=h:T=h,h=.5*(T-w)+w;return h},solve:function(r,l){return this.sampleCurveY(this.solveCurveX(r,l))}},yi}(),Hr=Rr(ii);function ut(c,r){this.x=c,this.y=r}function ur(c,r){if(Array.isArray(c)){if(!Array.isArray(r)||c.length!==r.length)return!1;for(let l=0;l<c.length;l++)if(!ur(c[l],r[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&r!==null){if(typeof r!="object"||Object.keys(c).length!==Object.keys(r).length)return!1;for(const l in c)if(!ur(c[l],r[l]))return!1;return!0}return c===r}ut.prototype={clone(){return new ut(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,r){return this.clone()._rotateAround(c,r)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const r=c.x-this.x,l=c.y-this.y;return r*r+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,r){return Math.atan2(this.x*r-this.y*c,this.x*c+this.y*r)},_matMult(c){const r=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=r,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const r=Math.cos(c),l=Math.sin(c),h=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=h,this},_rotateAround(c,r){const l=Math.cos(c),h=Math.sin(c),p=r.y+h*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-h*(this.y-r.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:ut},ut.convert=function(c){if(c instanceof ut)return c;if(Array.isArray(c))return new ut(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new ut(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};const fr=Math.PI/180,Fn=180/Math.PI;function Gt(c){return c*fr}function mn(c){return c*Fn}const Xn=[[0,0],[1,0],[1,1],[0,1]];function gr(c){if(c<=0)return 0;if(c>=1)return 1;const r=c*c,l=r*c;return 4*(c<.5?l:3*(c-r)+l-.75)}function je(c,r,l,h){const p=new Hr(c,r,l,h);return function(v){return p.solve(v)}}const re=je(.25,.1,.25,1);function ie(c,r,l){return Math.min(l,Math.max(r,c))}function _e(c,r,l){return(l=ie((l-c)/(r-c),0,1))*l*(3-2*l)}function Re(c,r,l){const h=l-r,p=((c-r)%h+h)%h+r;return p===r?l:p}function De(c,r,l){if(!c.length)return l(null,[]);let h=c.length;const p=new Array(c.length);let v=null;c.forEach((_,w)=>{r(_,(T,M)=>{T&&(v=T),p[w]=M,--h==0&&l(v,p)})})}let Ge=1;function ot(){return Ge++}function Ye(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log2(c)))}function rt(c,r){c.forEach(l=>{r[l]&&(r[l]=r[l].bind(r))})}function zt(c,r,l){const h={};for(const p in c)h[p]=r.call(this,c[p],p,c);return h}function it(c,r,l){const h={};for(const p in c)r.call(this,c[p],p,c)&&(h[p]=c[p]);return h}function $t(c){return Array.isArray(c)?c.map($t):typeof c=="object"&&c?zt(c,$t):c}function Qt(c,r){for(let l=0;l<c.length;l++)if(r.indexOf(c[l])>=0)return!0;return!1}const Ft={};function jt(c){Ft[c]||(typeof console<"u"&&console.warn(c),Ft[c]=!0)}function rn(c,r,l){return(l.y-c.y)*(r.x-c.x)>(r.y-c.y)*(l.x-c.x)}function yn(c){let r=0;for(let l,h,p=0,v=c.length,_=v-1;p<v;_=p++)l=c[p],h=c[_],r+=(h.x-l.x)*(l.y+h.y);return r}function rr([c,r,l]){const h=Gt(r+90),p=Gt(l);return{x:c*Math.cos(h)*Math.sin(p),y:c*Math.sin(h)*Math.sin(p),z:c*Math.cos(p),azimuthal:r,polar:l}}function En(c){return(typeof self<"u"||c!==void 0)&&typeof WorkerGlobalScope<"u"&&(c!==void 0?c:self)instanceof WorkerGlobalScope}function Zn(c){const r={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,p,v)=>{const _=p||v;return r[h]=!_||_.toLowerCase(),""}),r["max-age"]){const l=parseInt(r["max-age"],10);isNaN(l)?delete r["max-age"]:r["max-age"]=l}return r}let ar=null;function qr(c,r){return[c[4*r],c[4*r+1],c[4*r+2],c[4*r+3]]}function Ar(c,r,l,h){for(;r<l;){const p=r+l>>1;c[p]<h?r=p+1:l=p}return r}function yr(c,r,l,h){for(;r<l;){const p=r+l>>1;c[p]<=h?r=p+1:l=p}return r}function Jr(c){return c>0?1/(1.001-c):1+c}function ni(c){return c>0?1-1/(1.001-c):-c}function Qr(c,r,l){return(c-r.min)*(l.max-l.min)/(r.max-r.min)+l.min}const li={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!li.API_URL)return null;try{const c=new URL(li.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ui(c){return li.API_URL_REGEX.test(c)}function oo(c){return li.API_SPRITE_REGEX.test(c)}let Ti,wr,nr,xi,oi,Li;function ki(){return Ti==null&&(Ti=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ti}const ho={now:()=>xi!==void 0?xi:performance.now(),setNow(c){xi=c},restoreNow(){xi=void 0},frame(c){const r=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(c,r=0){const{width:l,height:h}=c;oi||(oi=document.createElement("canvas"));const p=oi.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>oi.width||h>oi.height)&&(oi.width=l,oi.height=h),p.clearRect(-r,-r,l+2*r,h+2*r),p.drawImage(c,0,0,l,h),p.getImageData(-r,-r,l+2*r,h+2*r)},resolveURL:c=>(wr||(wr=document.createElement("a")),wr.href=c,wr.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(nr==null&&(nr=window.matchMedia("(prefers-reduced-motion: reduce)")),nr.matches)},hasCanvasFingerprintNoise(){if(Li!==void 0)return Li;if(!ki())return Li=!1,!1;const c=new OffscreenCanvas(85,1),r=c.getContext("2d",{willReadFrequently:!0});let l=0;for(let p=0;p<c.width;++p)r.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,r.fillRect(p,0,1,1);const h=r.getImageData(0,0,c.width,c.height);l=0;for(let p=0;p<h.data.length;++p)if(p%4!=3&&l++!==h.data[p])return Li=!0,!0;return Li=!1,!1}};function Uo(c,r){const l=c.indexOf("?");if(l<0)return`${c}?${new URLSearchParams(r).toString()}`;const h=new URLSearchParams(c.slice(l));for(const p in r)h.set(p,r[p]);return`${c.slice(0,l)}?${h.toString()}`}function Qo(c,r={persistentParams:[]}){const l=c.indexOf("?");if(l<0)return c;const h=new URLSearchParams,p=new URLSearchParams(c.slice(l));for(const _ of r.persistentParams){const w=p.get(_);w&&h.set(_,w)}const v=h.toString();return`${c.slice(0,l)}${v.length>0?`?${v}`:""}`}const Ho="mapbox-tiles";let ea=500,Oo=50;const Br=["language","worldview","jobid"];let Xr,eo;function qo(){try{return caches}catch{}}function Eo(){const c=qo();c&&Xr==null&&(Xr=c.open(Ho))}let Go=1/0;const Ia={supported:!1,testSupport:function(c){!Ss&&sa&&(Ku?Xu(c):Ko=c)}};let Ko,sa,Ss=!1,Ku=!1;const Ja=typeof self<"u"?self:{};function Xu(c){const r=c.createTexture();c.bindTexture(c.TEXTURE_2D,r);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,sa),c.isContextLost())return;Ia.supported=!0}catch{}c.deleteTexture(r),Ss=!0}Ja.document&&(sa=Ja.document.createElement("img"),sa.onload=function(){Ko&&Xu(Ko),Ko=null,Ku=!0},sa.onerror=function(){Ss=!0,Ko=null},sa.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Dr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Dr);class ti extends Error{constructor(r,l,h){l===401&&Ui(h)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=l,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Do=En()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,No=function(c,r){if(!(/^file:/.test(l=c.url)||/^file:/.test(Do())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,p){const v=new AbortController,_=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Do(),referrerPolicy:h.referrerPolicy,signal:v.signal});let w=!1,T=!1;const M=(L=_.url).indexOf("sku=")>0&&Ui(L);var L;h.type==="json"&&_.headers.set("Accept","application/json");const z=(G,W,J)=>{if(T)return;if(G&&G.message!=="SecurityError"&&jt(G.toString()),W&&J)return F(W);const oe=Date.now();fetch(_).then(le=>{if(le.ok){const he=M?le.clone():null;return F(le,he,oe)}return p(new ti(le.statusText,le.status,h.url))}).catch(le=>{le.name!=="AbortError"&&p(new Error(`${le.message} ${h.url}`))})},F=(G,W,J)=>{(h.type==="arrayBuffer"?G.arrayBuffer():h.type==="json"?G.json():G.text()).then(oe=>{T||(W&&J&&function(le,he,me){if(Eo(),Xr==null)return;const be=Zn(he.headers.get("Cache-Control")||"");if(be["no-store"])return;const Ne={status:he.status,statusText:he.statusText,headers:new Headers};he.headers.forEach((Ze,et)=>Ne.headers.set(et,Ze)),be["max-age"]&&Ne.headers.set("Expires",new Date(me+1e3*be["max-age"]).toUTCString());const Ae=Ne.headers.get("Expires");if(!Ae||new Date(Ae).getTime()-me<42e4)return;let He=Qo(le.url,{persistentParams:Br});if(he.status===206){const Ze=le.headers.get("Range");if(!Ze)return;Ne.status=200,He=Uo(He,{range:Ze})}(function(Ze,et){if(eo===void 0)try{new Response(new ReadableStream),eo=!0}catch{eo=!1}eo?et(Ze.body):Ze.blob().then(et).catch(Tt=>jt(Tt.message))})(he,Ze=>{const et=new Response((Tt=he.status)!==200&&Tt!==404&&[101,103,204,205,304].includes(Tt)?null:Ze,Ne);var Tt;Eo(),Xr!=null&&Xr.then(ct=>ct.put(He,et)).catch(ct=>jt(ct.message))})}(_,W,J),w=!0,p(null,oe,G.headers))}).catch(oe=>{T||p(new Error(oe.message))})};return M?function(G,W){if(Eo(),Xr==null)return W(null);Xr.then(J=>{let oe=Qo(G.url,{persistentParams:Br});const le=G.headers.get("Range");le&&(oe=Uo(oe,{range:le})),J.match(oe).then(he=>{const me=function(be){if(!be)return!1;const Ne=new Date(be.headers.get("Expires")||0),Ae=Zn(be.headers.get("Cache-Control")||"");return Number(Ne)>Date.now()&&!Ae["no-cache"]}(he);J.delete(oe).catch(W),me&&J.put(oe,he.clone()).catch(W),W(null,he,me)}).catch(W)}).catch(W)}(_,z):z(null,null),{cancel:()=>{T=!0,w||v.abort()}}}(c,r);if(En(self)&&self.worker.actor)return self.worker.actor.send("getResource",c,r,void 0,!0)}var l;return function(h,p){const v=new XMLHttpRequest;v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const _ in h.headers)v.setRequestHeader(_,h.headers[_]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=()=>{p(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let _=v.response;if(h.type==="json")try{_=JSON.parse(v.response)}catch(T){return p(T)}const w=new Headers;v.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(T=>{const M=T.split(": "),L=M.shift(),z=M.join(": ");w.append(L,z)}),p(null,_,w)}else p(new ti(v.statusText,v.status,h.url))},v.send(h.body),{cancel:()=>v.abort()}}(c,r)},bo=function(c,r){return No(Object.assign(c,{type:"arrayBuffer"}),r)};function ci(c){const r=document.createElement("a");return r.href=c,r.protocol===location.protocol&&r.host===location.host}const Zu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let iu,Yl;iu=[],Yl=0;const i_=function(c,r){if(Ia.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Yl>=li.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:c,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return iu.push(v),v}Yl++;let l=!1;const h=()=>{if(!l)for(l=!0,Yl--;iu.length&&Yl<li.MAX_PARALLEL_IMAGE_REQUESTS;){const v=iu.shift(),{requestParameters:_,callback:w,cancelled:T}=v;T||(v.cancel=i_(_,w).cancel)}},p=bo(c,(v,_,w)=>{h(),v?r(v):_&&(self.createImageBitmap?function(T,M){const L=new Blob([new Uint8Array(T)],{type:"image/png"});createImageBitmap(L).then(z=>{M(null,z)}).catch(z=>{M(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(T,M)=>r(T,M,w)):function(T,M){const L=new Image;L.onload=()=>{M(null,L),URL.revokeObjectURL(L.src),L.onload=null,requestAnimationFrame(()=>{L.src=Zu})},L.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(T)],{type:"image/png"});L.src=T.byteLength?URL.createObjectURL(z):Zu}(_,(T,M)=>r(T,M,w)))});return{cancel:()=>{p.cancel(),h()}}};var Ef,Tf,If,Yu={exports:{}},gb={exports:{}},cm={exports:{}},ZE=function(){if(If)return Yu.exports;If=1;var c=(Ef||(Ef=1,gb.exports=function(l,h){var p,v,_,w,T,M,L,z;for(v=l.length-(p=3&l.length),_=h,T=3432918353,M=461845907,z=0;z<v;)L=255&l.charCodeAt(z)|(255&l.charCodeAt(++z))<<8|(255&l.charCodeAt(++z))<<16|(255&l.charCodeAt(++z))<<24,++z,_=27492+(65535&(w=5*(65535&(_=(_^=L=(65535&(L=(L=(65535&L)*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*M+(((L>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(L=0,p){case 3:L^=(255&l.charCodeAt(z+2))<<16;case 2:L^=(255&l.charCodeAt(z+1))<<8;case 1:_^=L=(65535&(L=(L=(65535&(L^=255&l.charCodeAt(z)))*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*M+(((L>>>16)*M&65535)<<16)&4294967295}return _^=l.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),gb.exports),r=(Tf||(Tf=1,cm.exports=function(l,h){for(var p,v=l.length,_=h^v,w=0;v>=4;)p=1540483477*(65535&(p=255&l.charCodeAt(w)|(255&l.charCodeAt(++w))<<8|(255&l.charCodeAt(++w))<<16|(255&l.charCodeAt(++w))<<24))+((1540483477*(p>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++w;switch(v){case 3:_^=(255&l.charCodeAt(w+2))<<16;case 2:_^=(255&l.charCodeAt(w+1))<<8;case 1:_=1540483477*(65535&(_^=255&l.charCodeAt(w)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),cm.exports);return Yu.exports=c,Yu.exports.murmur3=c,Yu.exports.murmur2=r,Yu.exports}(),Pf=Rr(ZE);class Hs{constructor(r,...l){Object.assign(this,l[0]||{}),this.type=r}}class Mf extends Hs{constructor(r,l={}){super("error",Object.assign({error:r},l))}}function jd(c,r,l){l[c]&&l[c].indexOf(r)!==-1||(l[c]=l[c]||[],l[c].push(r))}function Rf(c,r,l){if(l&&l[c]){const h=l[c].indexOf(r);h!==-1&&l[c].splice(h,1)}}class xc{on(r,l){return this._listeners=this._listeners||{},jd(r,l,this._listeners),this}off(r,l){return Rf(r,l,this._listeners),Rf(r,l,this._oneTimeListeners),this}once(r,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},jd(r,l,this._oneTimeListeners),this):new Promise(h=>{this.once(r,h)})}fire(r,l){const h=typeof r=="string"?new Hs(r,l):r,p=h.type;if(this.listens(p)){h.target=this;const v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const T of v)T.call(this,h);const _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const T of _)Rf(p,T,this._oneTimeListeners),T.call(this,h);const w=this._eventedParent;if(w){const T=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(h,T),w.fire(h)}}else h instanceof Mf&&console.error(h.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,l){return this._eventedParent=r,this._eventedParentData=l,this}}class la{constructor(r){typeof r=="string"?this.name=r:(this.name=r.name,this.iconsetId=r.iconsetId)}static from(r){return new la(r)}static toString(r){return r.iconsetId?`${r.name}${r.iconsetId}`:r.name}static parse(r){const[l,h]=r.split("");return new la({name:l,iconsetId:h})}static isEqual(r,l){return r.name===l.name&&r.iconsetId===l.iconsetId}toString(){return la.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var o_,a_={},s_=function(){if(o_)return a_;o_=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(v){return(v=Math.round(v))<0?0:v>255?255:v}function l(v){return r(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function h(v){return(_=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:_>1?1:_;var _}function p(v,_,w){return w<0?w+=1:w>1&&(w-=1),6*w<1?v+(_-v)*w*6:2*w<1?_:3*w<2?v+(_-v)*(2/3-w)*6:v}try{a_.parseCSSColor=function(v){var _,w=v.replace(/ /g,"").toLowerCase();if(w in c)return c[w].slice();if(w[0]==="#")return w.length===4?(_=parseInt(w.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:w.length===7&&(_=parseInt(w.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var T=w.indexOf("("),M=w.indexOf(")");if(T!==-1&&M+1===w.length){var L=w.substr(0,T),z=w.substr(T+1,M-(T+1)).split(","),F=1;switch(L){case"rgba":if(z.length!==4)return null;F=h(z.pop());case"rgb":return z.length!==3?null:[l(z[0]),l(z[1]),l(z[2]),F];case"hsla":if(z.length!==4)return null;F=h(z.pop());case"hsl":if(z.length!==3)return null;var G=(parseFloat(z[0])%360+360)%360/360,W=h(z[1]),J=h(z[2]),oe=J<=.5?J*(W+1):J+W-J*W,le=2*J-oe;return[r(255*p(le,oe,G+1/3)),r(255*p(le,oe,G)),r(255*p(le,oe,G-1/3)),F];default:return null}}return null}}catch{}return a_}();class Mi{constructor(r,l,h,p=1){this.r=r,this.g=l,this.b=h,this.a=p}static parse(r){if(!r)return;if(r instanceof Mi)return r;if(typeof r!="string")return;const l=s_.parseCSSColor(r);return l?new Mi(l[0]/255,l[1]/255,l[2]/255,l[3]):void 0}toString(){const[r,l,h,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*r)},${Math.round(255*l)},${Math.round(255*h)},${p})`}toNonPremultipliedRenderColor(r){const{r:l,g:h,b:p,a:v}=this;return new vb(r,l,h,p,v)}toPremultipliedRenderColor(r){const{r:l,g:h,b:p,a:v}=this;return new _b(r,l*v,h*v,p*v,v)}clone(){return new Mi(this.r,this.g,this.b,this.a)}}class l_{constructor(r,l,h,p,v,_=!1){if(this.premultiplied=!1,this.premultiplied=_,r){const w=r.image.height,T=w*w;this.premultiplied?(l=v===0?0:l/v*(w-1),h=v===0?0:h/v*(w-1),p=v===0?0:p/v*(w-1)):(l*=w-1,h*=w-1,p*=w-1);const M=Math.floor(l),L=Math.floor(h),z=Math.floor(p),F=Math.ceil(l),G=Math.ceil(h),W=Math.ceil(p),J=l-M,oe=h-L,le=p-z,he=r.image.data,me=4*(M+L*T+z*w),be=4*(M+L*T+W*w),Ne=4*(M+G*T+z*w),Ae=4*(M+G*T+W*w),He=4*(F+L*T+z*w),Ze=4*(F+L*T+W*w),et=4*(F+G*T+z*w),Tt=4*(F+G*T+W*w);if(me<0||Tt>=he.length)throw new Error("out of range");this.r=vr(vr(vr(he[me],he[be],le),vr(he[Ne],he[Ae],le),oe),vr(vr(he[He],he[Ze],le),vr(he[et],he[Tt],le),oe),J)/255*(this.premultiplied?v:1),this.g=vr(vr(vr(he[me+1],he[be+1],le),vr(he[Ne+1],he[Ae+1],le),oe),vr(vr(he[He+1],he[Ze+1],le),vr(he[et+1],he[Tt+1],le),oe),J)/255*(this.premultiplied?v:1),this.b=vr(vr(vr(he[me+2],he[be+2],le),vr(he[Ne+2],he[Ae+2],le),oe),vr(vr(he[He+2],he[Ze+2],le),vr(he[et+2],he[Tt+2],le),oe),J)/255*(this.premultiplied?v:1),this.a=v}else this.r=l,this.g=h,this.b=p,this.a=v}toArray(){const{r,g:l,b:h,a:p}=this;return[255*r,255*l,255*h,p]}toHslaArray(){let{r,g:l,b:h,a:p}=this;if(this.premultiplied){if(p===0)return[0,0,0,0];const W=1/p;r*=W,l*=W,h*=W}const v=Math.min(Math.max(r,0),1),_=Math.min(Math.max(l,0),1),w=Math.min(Math.max(h,0),1),T=Math.min(v,_,w),M=Math.max(v,_,w),L=M-T,z=.5*(T+M);if(L===0)return[0,0,100*z,p];const F=z>.5?L/(2-M-T):L/(M+T);let G;switch(M){case v:G=60*((_-w)/L+(_<w?6:0));break;case _:G=60*((w-v)/L+2);break;default:G=60*((v-_)/L+4)}return[G,100*F,100*z,p]}toArray01(){const{r,g:l,b:h,a:p}=this;return[r,l,h,p]}toArray01Scaled(r){const{r:l,g:h,b:p}=this;return[l*r,h*r,p*r]}toArray01Linear(){const{r,g:l,b:h,a:p}=this;return[Math.pow(r,2.2),Math.pow(l,2.2),Math.pow(h,2.2),p]}}class vb extends l_{constructor(r,l,h,p,v){super(r,l,h,p,v,!1)}}class _b extends l_{constructor(r,l,h,p,v){super(r,l,h,p,v,!0)}}function vr(c,r,l){return c*(1-l)+r*l}function Af(c,r,l){return c.map((h,p)=>vr(h,r[p],l))}Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0),Mi.red=new Mi(1,0,0,1),Mi.blue=new Mi(0,0,1,1);var bc=Object.freeze({__proto__:null,array:Af,color:function(c,r,l){return new Mi(vr(c.r,r.r,l),vr(c.g,r.g,l),vr(c.b,r.b,l),vr(c.a,r.a,l))},number:vr});class fl extends Error{constructor(r,l){super(l),this.message=l,this.key=r}}class pl{constructor(r,l=[]){this.parent=r,this.bindings={};for(const[h,p]of l)this.bindings[h]=p}concat(r){return new pl(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Vd={kind:"null"},Yn={kind:"number"},gi={kind:"string"},Ii={kind:"boolean"},Cs={kind:"color"},Ud={kind:"object"},Ai={kind:"value"},Of={kind:"collator"},Ju={kind:"formatted"},Df={kind:"resolvedImage"};function Pa(c,r){return{kind:"array",itemType:c,N:r}}function ta(c){if(c.kind==="array"){const r=ta(c.itemType);return typeof c.N=="number"?`array<${r}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${r}>`}return c.kind}const YE=[Vd,Yn,gi,Ii,Cs,Ju,Ud,Pa(Ai),Df];function Lf(c,r){if(r.kind==="error")return null;if(c.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Lf(c.itemType,r.itemType))&&(typeof c.N!="number"||c.N===r.N))return null}else{if(c.kind===r.kind)return null;if(c.kind==="value"){for(const l of YE)if(!Lf(l,r))return null}}return`Expected ${ta(c)} but found ${ta(r)} instead.`}function c_(c,r){return r.some(l=>l.kind===c.kind)}function zf(c,r){return r.some(l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c)}function um(c,r){return c.kind==="array"&&r.kind==="array"?c.N===r.N&&um(c.itemType,r.itemType):c.kind===r.kind}class u_{constructor(r,l,h){this.sensitivity=r?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,l){return this.collator.compare(r,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class kf{constructor(r,l,h,p,v){this.text=r.normalize?r.normalize():r,this.image=l,this.scale=h,this.fontStack=p,this.textColor=v}}class xa{constructor(r){this.sections=r}static fromString(r){return new xa([new kf(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||!!r.image&&r.image.hasPrimary())}static factory(r){return r instanceof xa?r:xa.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const l of this.sections){if(l.image){const p=l.image.getPrimary().id.toString();r.push(["image",p]);continue}r.push(l.text);const h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toNonPremultipliedRenderColor(null).toArray())),r.push(h)}return r}}class wc{constructor(r,l={}){if(this.id=la.from(r),this.options=Object.assign({},l),l.transform){const{a:h,b:p,c:v,d:_,e:w,f:T}=l.transform;this.options.transform=new DOMMatrix([h,p,v,_,w,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:r,b:l,c:h,d:p,e:v,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:r,b:l,c:h,d:p,e:v,f:_}})}static parse(r){let l,h,p,v;try{({name:l,iconsetId:h,params:p,transform:v}=JSON.parse(r)||{})}catch{return null}if(!l)return null;const{a:_,b:w,c:T,d:M,e:L,f:z}=v||{};return new wc({name:l,iconsetId:h},{params:p,transform:new DOMMatrix([_,w,T,M,L,z])})}scaleSelf(r,l){return this.options.transform.scaleSelf(r,l),this}}class gs{constructor(r,l,h,p,v=!1){this.primaryId=la.from(r),this.primaryOptions=l,h&&(this.secondaryId=la.from(h)),this.secondaryOptions=p,this.available=v}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new wc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new wc(this.secondaryId,this.secondaryOptions):null}static from(r){return typeof r=="string"?gs.build({name:r}):r}static build(r,l,h,p){return!r||typeof r=="object"&&!("name"in r)?null:new gs(r,h,l,p)}}function dm(c,r,l,h){return typeof c=="number"&&c>=0&&c<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[c,r,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[c,r,l,h]:[c,r,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Hd(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Mi||c instanceof u_||c instanceof xa||c instanceof gs)return!0;if(Array.isArray(c)){for(const r of c)if(!Hd(r))return!1;return!0}if(typeof c=="object"){for(const r in c)if(!Hd(c[r]))return!1;return!0}return!1}function fa(c){if(c===null)return Vd;if(typeof c=="string")return gi;if(typeof c=="boolean")return Ii;if(typeof c=="number")return Yn;if(c instanceof Mi)return Cs;if(c instanceof u_)return Of;if(c instanceof xa)return Ju;if(c instanceof gs)return Df;if(Array.isArray(c)){const r=c.length;let l;for(const h of c){const p=fa(h);if(l){if(l===p)continue;l=Ai;break}l=p}return Pa(l||Ai,r)}return Ud}function Jl(c){const r=typeof c;return c===null?"":r==="string"||r==="number"||r==="boolean"?String(c):c instanceof xa||c instanceof gs||c instanceof Mi?c.toString():JSON.stringify(c)}class Sc{constructor(r,l){this.type=r,this.value=l}static parse(r,l){if(r.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Hd(r[1]))return l.error("invalid value");const h=r[1];let p=fa(h);const v=l.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new Sc(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Mi?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof xa?this.value.serialize():this.value}}class Lo{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const jr={string:gi,number:Yn,boolean:Ii,object:Ud};class Hn{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");let h,p=1;const v=r[0];if(v==="array"){let w,T;if(r.length>2){const M=r[1];if(typeof M!="string"||!(M in jr)||M==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);w=jr[M],p++}else w=Ai;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return l.error('The length argument to "array" must be a positive integer literal',2);T=r[2],p++}h=Pa(w,T)}else h=jr[v];const _=[];for(;p<r.length;p++){const w=l.parse(r[p],p,Ai);if(!w)return null;_.push(w)}return new Hn(h,_)}evaluate(r){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(r);if(!Lf(this.type,fa(h)))return h;if(l===this.args.length-1)throw new Lo(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${ta(fa(h))} but was expected to be of type ${ta(this.type)}.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,l=[r.kind];if(r.kind==="array"){const h=r.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){l.push(h.kind);const p=r.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(h=>h.serialize()))}}class Qu{constructor(r){this.type=Ju,this.sections=r}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");const p=[];let v=!1;for(let _=1;_<=r.length-1;++_){const w=r[_];if(v&&typeof w=="object"&&!Array.isArray(w)){v=!1;let T=null;if(w["font-scale"]&&(T=l.parseObjectValue(w["font-scale"],_,"font-scale",Yn),!T))return null;let M=null;if(w["text-font"]&&(M=l.parseObjectValue(w["text-font"],_,"text-font",Pa(gi)),!M))return null;let L=null;if(w["text-color"]&&(L=l.parseObjectValue(w["text-color"],_,"text-color",Cs),!L))return null;const z=p[p.length-1];z.scale=T,z.font=M,z.textColor=L}else{const T=l.parse(r[_],_,Ai);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new Qu(p)}evaluate(r){return new xa(this.sections.map(l=>{const h=l.content.evaluate(r);return um(fa(h),Df)?new kf("",h,null,null,null):new kf(Jl(h),null,l.scale?l.scale.evaluate(r):null,l.font?l.font.evaluate(r).join(","):null,l.textColor?l.textColor.evaluate(r):null)}))}eachChild(r){for(const l of this.sections)r(l.content),l.scale&&r(l.scale),l.font&&r(l.font),l.textColor&&r(l.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const l of this.sections){r.push(l.content.serialize());const h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),r.push(h)}return r}}class Tr{constructor(r,l,h,p){this._imageWarnHistory={},this.type=Df,this.namePrimary=r,this.nameSecondary=l,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(r,l){if(r.length<2)return l.error("Expected two or more arguments.");let h=1;const p=[];function v(){if(h<r.length){const w=l.parse(r[h],h++,gi);return w?(p.push({image:w,options:{}}),!0):(l.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(h<r.length){const T=r[h];if((w=T)===null||typeof w!="object"||Array.isArray(w))return!0;const M=T.params,L=T.iconset,z=l.concat(h);if(!M&&!L)return h++,!0;if(M){if(typeof M!="object"||M.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const F={},G=z.concat(void 0,"params");for(const W in M){if(!W)return G.error("Image parameter name should be non-empty"),!1;const J=G.concat(void 0,W).parse(M[W],void 0,Cs,void 0,{typeAnnotation:"coerce"});if(!J)return!1;F[W]=J}p[p.length-1].options.params=F}if(L){if(typeof L!="object"||L.constructor!==Object)return z.error('Image options "iconset" should be an object'),!1;if(!L.id)return z.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=L}return h++,!0}var w;return!0}for(let w=0;w<2;w++)if(!v()||!_())return;return new Tr(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(r,l){const h={};if(l){for(const p in l)if(l[p])try{h[p]=l[p].evaluate(r)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(r){const l={name:this.namePrimary.evaluate(r),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(r),iconsetId:this.iconsetIdSecondary}:void 0,p=gs.build(l,h,this.paramsPrimary?this.evaluateParams(r,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(r,this.paramsSecondary):void 0);if(p&&r.availableImages){const v=p.getPrimary().id;if(p.available=r.availableImages.some(_=>la.isEqual(_,v)),p.available){const _=p.getSecondary()?p.getSecondary().id:null;_&&(p.available=r.availableImages.some(w=>la.isEqual(w,_)))}}return p}eachChild(r){if(r(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&r(this.paramsPrimary[l]);if(this.nameSecondary&&(r(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&r(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(r,l){const h={};if(l&&(h.iconset={id:l}),r){h.params={};for(const p in r)r[p]&&(h.params[p]=r[p].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const r=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&r.push(l)}if(this.nameSecondary&&(r.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&r.push(l)}return r}}function Gd(c){return xr(c)?"string":Ff(c)?"number":fm(c)?"boolean":Array.isArray(c)?"array":c===null?"null":hm(c)?"object":typeof c}function hm(c){return c!=null&&!Array.isArray(c)&&typeof c!="function"&&!(c instanceof String||c instanceof Number||c instanceof Boolean)&&typeof c=="object"}function xr(c){return typeof c=="string"||c instanceof String}function Ff(c){return typeof c=="number"||c instanceof Number}function fm(c){return typeof c=="boolean"||c instanceof Boolean}const yb={"to-boolean":Ii,"to-color":Cs,"to-number":Yn,"to-string":gi};class Ql{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[0],p=[];let v=Vd;if(h==="to-array"){if(!Array.isArray(r[1]))return null;const _=r[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);v=Pa(l.expectedType.itemType,_)}else{if(!(_>0&&Hd(r[1][0])))return null;v=Pa(fa(r[1][0]),_)}for(let w=0;w<_;w++){const T=r[1][w];let M;if(Array.isArray(T))M=l.parse(T,void 0,v.itemType);else{const L=Gd(T);if(L!==v.itemType.kind)return l.error(`Expected ${v.itemType.kind} but found ${L}.`);M=l.registry.literal.parse(["literal",T===void 0?null:T],l)}if(!M)return null;p.push(M)}}else{if((h==="to-boolean"||h==="to-string")&&r.length!==2)return l.error("Expected one argument.");v=yb[h];for(let _=1;_<r.length;_++){const w=l.parse(r[_],_,Ai);if(!w)return null;p.push(w)}}return new Ql(v,p)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let l,h;for(const p of this.args){if(l=p.evaluate(r),h=null,l instanceof Mi)return l;if(typeof l=="string"){const v=r.parseColor(l);if(v)return v}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:dm(l[0],l[1],l[2],l[3]),!h))return new Mi(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Lo(h||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const h of this.args){if(l=h.evaluate(r),l===null)return 0;const p=Number(l);if(!isNaN(p))return p}throw new Lo(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?xa.fromString(Jl(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?gs.build(Jl(this.args[0].evaluate(r))):this.type.kind==="array"?this.args.map(l=>l.evaluate(r)):Jl(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Tr(this.args[0]).serialize();const r=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{r.push(l.serialize())}),r}}const pm=["Unknown","Point","LineString","Polygon"];class Ma{constructor(r,l,h){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=l,this.iconImageUseTheme=h}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?pm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:h,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*l-r[0])+this.featureDistanceData.bearing[1]*(p*l-r[1])}return 0}parseColor(r){let l=this._parseColorCache[r];return l||(l=this._parseColorCache[r]=Mi.parse(r)),l}getConfig(r){return this.options?this.options.get(r):null}}class Qa{constructor(r,l,h,p,v){this.name=r,this.type=l,this._evaluate=h,this.args=p,this._overloadIndex=v}evaluate(r){if(!this._evaluate){const l=Qa.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,l){const h=r[0],p=Qa.definitions[h];if(!p)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=[];let T=null,M=-1;for(const[L,z]of _){if(Array.isArray(L)&&L.length!==r.length-1)continue;w.push(L),M++,T=new Cm(l.registry,l.path,null,l.scope,void 0,l._scope,l.options,l.iconImageUseTheme);const F=[];let G=!1;for(let W=1;W<r.length;W++){const J=r[W],oe=Array.isArray(L)?L[W-1]:L.type,le=T.parse(J,1+F.length,oe);if(!le){G=!0;break}F.push(le)}if(!G)if(Array.isArray(L)&&L.length!==F.length)T.error(`Expected ${L.length} arguments, but found ${F.length} instead.`);else{for(let W=0;W<F.length;W++){const J=Array.isArray(L)?L[W]:L.type,oe=F[W];T.concat(W+1).checkSubtype(J,oe.type)}if(T.errors.length===0)return new Qa(h,v,z,F,M)}}if(w.length===1)l.errors.push(...T.errors);else{const L=(w.length?w:_.map(([F])=>F)).map(ed).join(" | "),z=[];for(let F=1;F<r.length;F++){const G=l.parse(r[F],1+z.length);if(!G)return null;z.push(ta(G.type))}l.error(`Expected arguments of type ${L}, but found (${z.join(", ")}) instead.`)}return null}static register(r,l){Qa.definitions=l;for(const h in l)r[h]=Qa}}function ed(c){return Array.isArray(c)?`(${c.map(ta).join(", ")})`:`(${ta(c.type)}...)`}class Wd{constructor(r,l,h){this.type=Of,this.locale=h,this.caseSensitive=r,this.diacriticSensitive=l}static parse(r,l){if(r.length!==2)return l.error("Expected one argument.");const h=r[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");const p=h["case-sensitive"]===void 0?l.parse(!1,1,Ii):l.parseObjectValue(h["case-sensitive"],1,"case-sensitive",Ii);if(!p)return null;const v=h["diacritic-sensitive"]===void 0?l.parse(!1,1,Ii):l.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",Ii);if(!v)return null;let _=null;return h.locale&&(_=l.parseObjectValue(h.locale,1,"locale",gi),!_)?null:new Wd(p,v,_)}evaluate(r){return new u_(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}function Cc(c,r,l=0,h=c.length-1,p=JE){for(;h>l;){if(h-l>600){const T=h-l+1,M=r-l+1,L=Math.log(T),z=.5*Math.exp(2*L/3),F=.5*Math.sqrt(L*z*(T-z)/T)*(M-T/2<0?-1:1);Cc(c,r,Math.max(l,Math.floor(r-M*z/T+F)),Math.min(h,Math.floor(r+(T-M)*z/T+F)),p)}const v=c[r];let _=l,w=h;for(Ra(c,l,r),p(c[h],v)>0&&Ra(c,l,h);_<w;){for(Ra(c,_,w),_++,w--;p(c[_],v)<0;)_++;for(;p(c[w],v)>0;)w--}p(c[l],v)===0?Ra(c,l,w):(w++,Ra(c,w,h)),w<=r&&(l=w+1),r<=w&&(h=w-1)}}function Ra(c,r,l){const h=c[r];c[r]=c[l],c[l]=h}function JE(c,r){return c<r?-1:c>r?1:0}function QE(c){let r=0;for(let l,h,p=0,v=c.length,_=v-1;p<v;_=p++)l=c[p],h=c[_],r+=(h.x-l.x)*(l.y+h.y);return r}function Nf(c,r){c[0]=Math.min(c[0],r[0]),c[1]=Math.min(c[1],r[1]),c[2]=Math.max(c[2],r[0]),c[3]=Math.max(c[3],r[1])}function ou(c,r){return!(c[0]<=r[0]||c[2]>=r[2]||c[1]<=r[1]||c[3]>=r[3])}function xb(c,r,l){const h=c[0]-r[0],p=c[1]-r[1],v=c[0]-l[0],_=c[1]-l[1];return h*_-v*p==0&&h*v<=0&&p*_<=0}function ml(c,r,l=!1){let h=!1;for(let w=0,T=r.length;w<T;w++){const M=r[w];for(let L=0,z=M.length,F=z-1;L<z;F=L++){const G=M[F],W=M[L];if(xb(c,G,W))return l;(v=G)[1]>(p=c)[1]!=(_=W)[1]>p[1]&&p[0]<(_[0]-v[0])*(p[1]-v[1])/(_[1]-v[1])+v[0]&&(h=!h)}}var p,v,_;return h}function bb(c,r,l,h){const p=h[0]-l[0],v=h[1]-l[1],_=(c[0]-l[0])*v-p*(c[1]-l[1]),w=(r[0]-l[0])*v-p*(r[1]-l[1]);return _>0&&w<0||_<0&&w>0}function mm(c,r,l,h){return(p=[h[0]-l[0],h[1]-l[1]])[0]*(v=[r[0]-c[0],r[1]-c[1]])[1]-p[1]*v[0]!=0&&!(!bb(c,r,l,h)||!bb(l,h,c,r));var p,v}function Bf(c){const r=new ut(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new ut(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of c[0])r.x>h.x&&(r.x=h.x),r.y>h.y&&(r.y=h.y),l.x<h.x&&(l.x=h.x),l.y<h.y&&(l.y=h.y);return{min:r,max:l}}const au=8192;function eT(c,r){const l=(180+c[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(l*p*au),Math.round(h*p*au)]}function wb(c,r){for(let l=0;l<r.length;l++)if(ml(c,r[l]))return!0;return!1}function tT(c,r,l){for(const h of l)for(let p=0,v=h.length,_=v-1;p<v;_=p++)if(mm(c,r,h[_],h[p]))return!0;return!1}function su(c,r){for(let l=0;l<c.length;++l)if(!ml(c[l],r))return!1;for(let l=0;l<c.length-1;++l)if(tT(c[l],c[l+1],r))return!1;return!0}function nT(c,r){for(let l=0;l<r.length;l++)if(su(c,r[l]))return!0;return!1}function d_(c,r,l){const h=[];for(let p=0;p<c.length;p++){const v=[];for(let _=0;_<c[p].length;_++){const w=eT(c[p][_],l);Nf(r,w),v.push(w)}h.push(v)}return h}function gm(c,r,l){const h=[];for(let p=0;p<c.length;p++){const v=d_(c[p],r,l);h.push(v)}return h}function h_(c,r,l,h){if(c[0]<l[0]||c[0]>l[2]){const p=.5*h;let v=c[0]-l[0]>p?-h:l[0]-c[0]>p?h:0;v===0&&(v=c[0]-l[2]>p?-h:l[2]-c[0]>p?h:0),c[0]+=v}Nf(r,c)}function f_(c,r,l,h){const p=Math.pow(2,h.z)*au,v=[h.x*au,h.y*au],_=[];if(!c)return _;for(const w of c)for(const T of w){const M=[T.x+v[0],T.y+v[1]];h_(M,r,l,p),_.push(M)}return _}function gl(c,r,l,h){const p=Math.pow(2,h.z)*au,v=[h.x*au,h.y*au],_=[];if(!c)return _;for(const T of c){const M=[];for(const L of T){const z=[L.x+v[0],L.y+v[1]];Nf(r,z),M.push(z)}_.push(M)}if(r[2]-r[0]<=p/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of _)for(const M of T)h_(M,r,l,p)}var w;return _}class td{constructor(r,l){this.type=Ii,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Hd(r[1])){const h=r[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const v=h.features[p].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new td(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new td(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new td(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,h){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(h.type==="Polygon"){const w=d_(h.coordinates,v,_),T=f_(l.geometry(),p,v,_);if(!ou(p,v))return!1;for(const M of T)if(!ml(M,w))return!1}if(h.type==="MultiPolygon"){const w=gm(h.coordinates,v,_),T=f_(l.geometry(),p,v,_);if(!ou(p,v))return!1;for(const M of T)if(!wb(M,w))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,h){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],_=l.canonicalID();if(!_)return!1;if(h.type==="Polygon"){const w=d_(h.coordinates,v,_),T=gl(l.geometry(),p,v,_);if(!ou(p,v))return!1;for(const M of T)if(!su(M,w))return!1}if(h.type==="MultiPolygon"){const w=gm(h.coordinates,v,_),T=gl(l.geometry(),p,v,_);if(!ou(p,v))return!1;for(const M of T)if(!nT(M,w))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const $f={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},p_=1/298.257223563,m_=p_*(2-p_),qd=Math.PI/180;class Kd{static fromTile(r,l,h){const p=Math.PI*(1-2*(r+.5)/Math.pow(2,l)),v=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/qd;return new Kd(v,h)}static get units(){return $f}constructor(r,l){if(r===void 0)throw new Error("No latitude given.");if(l&&!$f[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys($f).join(", ")}`);const h=6378.137*qd*(l?$f[l]:1),p=Math.cos(r*qd),v=1/(1-m_*(1-p*p)),_=Math.sqrt(v);this.kx=h*_*p,this.ky=h*_*v*(1-m_)}distance(r,l){const h=Gs(r[0]-l[0])*this.kx,p=(r[1]-l[1])*this.ky;return Math.sqrt(h*h+p*p)}bearing(r,l){const h=Gs(l[0]-r[0])*this.kx;return Math.atan2(h,(l[1]-r[1])*this.ky)/qd}destination(r,l,h){const p=h*qd;return this.offset(r,Math.sin(p)*l,Math.cos(p)*l)}offset(r,l,h){return[r[0]+l/this.kx,r[1]+h/this.ky]}lineDistance(r){let l=0;for(let h=0;h<r.length-1;h++)l+=this.distance(r[h],r[h+1]);return l}area(r){let l=0;for(let h=0;h<r.length;h++){const p=r[h];for(let v=0,_=p.length,w=_-1;v<_;w=v++)l+=Gs(p[v][0]-p[w][0])*(p[v][1]+p[w][1])*(h?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(r,l){let h=0;if(l<=0)return r[0];for(let p=0;p<r.length-1;p++){const v=r[p],_=r[p+1],w=this.distance(v,_);if(h+=w,h>l)return vm(v,_,(l-(h-w))/w)}return r[r.length-1]}pointToSegmentDistance(r,l,h){let[p,v]=l,_=Gs(h[0]-p)*this.kx,w=(h[1]-v)*this.ky;if(_!==0||w!==0){const T=(Gs(r[0]-p)*this.kx*_+(r[1]-v)*this.ky*w)/(_*_+w*w);T>1?(p=h[0],v=h[1]):T>0&&(p+=_/this.kx*T,v+=w/this.ky*T)}return _=Gs(r[0]-p)*this.kx,w=(r[1]-v)*this.ky,Math.sqrt(_*_+w*w)}pointOnLine(r,l){let h=1/0,p=r[0][0],v=r[0][1],_=0,w=0;for(let T=0;T<r.length-1;T++){let M=r[T][0],L=r[T][1],z=Gs(r[T+1][0]-M)*this.kx,F=(r[T+1][1]-L)*this.ky,G=0;z===0&&F===0||(G=(Gs(l[0]-M)*this.kx*z+(l[1]-L)*this.ky*F)/(z*z+F*F),G>1?(M=r[T+1][0],L=r[T+1][1]):G>0&&(M+=z/this.kx*G,L+=F/this.ky*G)),z=Gs(l[0]-M)*this.kx,F=(l[1]-L)*this.ky;const W=z*z+F*F;W<h&&(h=W,p=M,v=L,_=T,w=G)}return{point:[p,v],index:_,t:Math.max(0,Math.min(1,w))}}lineSlice(r,l,h){let p=this.pointOnLine(h,r),v=this.pointOnLine(h,l);if(p.index>v.index||p.index===v.index&&p.t>v.t){const M=p;p=v,v=M}const _=[p.point],w=p.index+1,T=v.index;!g_(h[w],_[0])&&w<=T&&_.push(h[w]);for(let M=w+1;M<=T;M++)_.push(h[M]);return g_(h[T],v.point)||_.push(v.point),_}lineSliceAlong(r,l,h){let p=0;const v=[];for(let _=0;_<h.length-1;_++){const w=h[_],T=h[_+1],M=this.distance(w,T);if(p+=M,p>r&&v.length===0&&v.push(vm(w,T,(r-(p-M))/M)),p>=l)return v.push(vm(w,T,(l-(p-M))/M)),v;p>r&&v.push(T)}return v}bufferPoint(r,l){const h=l/this.ky,p=l/this.kx;return[r[0]-p,r[1]-h,r[0]+p,r[1]+h]}bufferBBox(r,l){const h=l/this.ky,p=l/this.kx;return[r[0]-p,r[1]-h,r[2]+p,r[3]+h]}insideBBox(r,l){return Gs(r[0]-l[0])>=0&&Gs(r[0]-l[2])<=0&&r[1]>=l[1]&&r[1]<=l[3]}}function g_(c,r){return c[0]===r[0]&&c[1]===r[1]}function vm(c,r,l){const h=Gs(r[0]-c[0]);return[c[0]+h*l,c[1]+(r[1]-c[1])*l]}function Gs(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class _m{constructor(r=[],l=(h,p)=>h<p?-1:h>p?1:0){if(this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:l,compare:h}=this,p=l[r];for(;r>0;){const v=r-1>>1,_=l[v];if(h(p,_)>=0)break;l[r]=_,r=v}l[r]=p}_down(r){const{data:l,compare:h}=this,p=this.length>>1,v=l[r];for(;r<p;){let _=1+(r<<1);const w=_+1;if(w<this.length&&h(l[w],l[_])<0&&(_=w),h(l[_],v)>=0)break;l[r]=l[_],r=_}l[r]=v}}var fn=8192;function v_(c,r){return r.dist-c.dist}const Xd=100,Zd=50;function jf(c){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==c.length)return!1;for(let l=0;l<r.length;l++)if(r[l]!==c[l])return!1;return!0}function Vf(c){return c[1]-c[0]+1}function ec(c,r){const l=c[1]>=c[0]&&c[1]<r;return l||console.warn("Distance Expression: Index is out of range"),l}function ym(c,r){if(c[0]>c[1])return[null,null];const l=Vf(c);if(r){if(l===2)return[c,null];const h=Math.floor(l/2);return[[c[0],c[0]+h],[c[0]+h,c[1]]]}{if(l===1)return[c,null];const h=Math.floor(l/2)-1;return[[c[0],c[0]+h],[c[0]+h+1,c[1]]]}}function vl(c,r){const l=[1/0,1/0,-1/0,-1/0];if(!ec(r,c.length))return l;for(let h=r[0];h<=r[1];++h)Nf(l,c[h]);return l}function ei(c){const r=[1/0,1/0,-1/0,-1/0];for(let l=0;l<c.length;++l)for(let h=0;h<c[l].length;++h)Nf(r,c[l][h]);return r}function Yd(c,r,l){if(jf(c)||jf(r))return NaN;let h=0,p=0;return c[2]<r[0]&&(h=r[0]-c[2]),c[0]>r[2]&&(h=c[0]-r[2]),c[1]>r[3]&&(p=c[1]-r[3]),c[3]<r[1]&&(p=r[1]-c[3]),l.distance([0,0],[h,p])}function rT(c){return 360*c-180}function iT(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function xm(c,r){const l=Math.pow(2,r.z),h=(c.y/fn+r.y)/l;return[rT((c.x/fn+r.x)/l),iT(h)]}function oT(c,r){const l=[];for(let h=0;h<c.length;++h)l.push(xm(c[h],r));return l}function fo(c,r,l){const h=l.pointOnLine(r,c).point;return l.distance(c,h)}function Sb(c,r,l,h,p){const v=l.slice(h[0],h[1]+1);let _=1/0;for(let w=r[0];w<=r[1];++w)if((_=Math.min(_,fo(c[w],v,p)))===0)return 0;return _}function __(c,r,l,h,p){const v=Math.min(p.pointToSegmentDistance(c,l,h),p.pointToSegmentDistance(r,l,h)),_=Math.min(p.pointToSegmentDistance(l,c,r),p.pointToSegmentDistance(h,c,r));return Math.min(v,_)}function aT(c,r,l,h,p){if(!ec(r,c.length)||!ec(h,l.length))return NaN;let v=1/0;for(let _=r[0];_<r[1];++_)for(let w=h[0];w<h[1];++w){if(mm(c[_],c[_+1],l[w],l[w+1]))return 0;v=Math.min(v,__(c[_],c[_+1],l[w],l[w+1],p))}return v}function sT(c,r,l,h,p){if(!ec(r,c.length)||!ec(h,l.length))return NaN;let v=1/0;for(let _=r[0];_<=r[1];++_)for(let w=h[0];w<=h[1];++w)if((v=Math.min(v,p.distance(c[_],l[w])))===0)return v;return v}function lT(c,r,l){if(ml(c,r,!0))return 0;let h=1/0;for(const p of r){const v=p.length;if(v<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[v-1]&&(h=Math.min(h,l.pointToSegmentDistance(c,p[v-1],p[0])))===0||(h=Math.min(h,fo(c,p,l)))===0)return h}return h}function cT(c,r,l,h){if(!ec(r,c.length))return NaN;for(let v=r[0];v<=r[1];++v)if(ml(c[v],l,!0))return 0;let p=1/0;for(let v=r[0];v<r[1];++v)for(const _ of l)for(let w=0,T=_.length,M=T-1;w<T;M=w++){if(mm(c[v],c[v+1],_[M],_[w]))return 0;p=Math.min(p,__(c[v],c[v+1],_[M],_[w],h))}return p}function Cb(c,r){for(const l of c)for(let h=0;h<=l.length-1;++h)if(ml(l[h],r,!0))return!0;return!1}function uT(c,r,l,h=1/0){const p=ei(c),v=ei(r);if(h!==1/0&&Yd(p,v,l)>=h)return h;if(ou(p,v)){if(Cb(c,r))return 0}else if(Cb(r,c))return 0;let _=h;for(const w of c)for(let T=0,M=w.length,L=M-1;T<M;L=T++)for(const z of r)for(let F=0,G=z.length,W=G-1;F<G;W=F++){if(mm(w[L],w[T],z[W],z[F]))return 0;_=Math.min(_,__(w[L],w[T],z[W],z[F],l))}return _}function bm(c,r,l,h,p,v,_){if(v===null||_===null)return;const w=Yd(vl(h,v),vl(p,_),l);w<r&&c.push({dist:w,range1:v,range2:_})}function dT(c,r,l,h,p=1/0){let v=Math.min(h.distance(c[0],l[0][0]),p);if(v===0)return v;const _=new _m([{dist:0,range1:[0,c.length-1],range2:[0,0]}],v_),w=r?Zd:Xd,T=ei(l);for(;_.length;){const M=_.pop();if(M.dist>=v)continue;const L=M.range1;if(Vf(L)<=w){if(!ec(L,c.length))return NaN;if(r){const z=cT(c,L,l,h);if((v=Math.min(v,z))===0)return v}else for(let z=L[0];z<=L[1];++z){const F=lT(c[z],l,h);if((v=Math.min(v,F))===0)return v}}else{const z=ym(L,r);if(z[0]!==null){const F=Yd(vl(c,z[0]),T,h);F<v&&_.push({dist:F,range1:z[0],range2:[0,0]})}if(z[1]!==null){const F=Yd(vl(c,z[1]),T,h);F<v&&_.push({dist:F,range1:z[1],range2:[0,0]})}}}return v}function Eb(c,r,l,h,p,v=1/0){let _=Math.min(v,p.distance(c[0],l[0]));if(_===0)return _;const w=new _m([{dist:0,range1:[0,c.length-1],range2:[0,l.length-1]}],v_),T=r?Zd:Xd,M=h?Zd:Xd;for(;w.length;){const L=w.pop();if(L.dist>=_)continue;const z=L.range1,F=L.range2;if(Vf(z)<=T&&Vf(F)<=M){if(!ec(z,c.length)||!ec(F,l.length))return NaN;if(r&&h?_=Math.min(_,aT(c,z,l,F,p)):r||h?r&&!h?_=Math.min(_,Sb(l,F,c,z,p)):!r&&h&&(_=Math.min(_,Sb(c,z,l,F,p))):_=Math.min(_,sT(c,z,l,F,p)),_===0)return _}else{const G=ym(z,r),W=ym(F,h);bm(w,_,p,c,l,G[0],W[0]),bm(w,_,p,c,l,G[0],W[1]),bm(w,_,p,c,l,G[1],W[0]),bm(w,_,p,c,l,G[1],W[1])}}return _}function y_(c,r,l,h,p=1/0){let v=p;const _=vl(c,[0,c.length-1]);for(const w of l)if(!(v!==1/0&&Yd(_,vl(w,[0,w.length-1]),h)>=v)&&(v=Math.min(v,Eb(c,r,w,!0,h,v)),v===0))return v;return v}function wm(c,r,l,h,p=1/0){let v=p;const _=vl(c,[0,c.length-1]);for(const w of l){if(v!==1/0&&Yd(_,ei(w),h)>=v)continue;const T=dT(c,r,w,h,v);if(isNaN(T))return T;if((v=Math.min(v,T))===0)return v}return v}function x_(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class nd{constructor(r,l){this.type=Yn,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(Hd(r[1])){const h=r[1];if(h.type==="FeatureCollection"){for(let p=0;p<h.features.length;++p)if(x_(h.features[p].geometry.type))return new nd(h,h.features[p].geometry)}else if(h.type==="Feature"){if(x_(h.geometry.type))return new nd(h,h.geometry)}else if(x_(h.type))return new nd(h,h)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const l=r.geometry(),h=r.canonicalID();if(l!=null&&h!=null){if(r.geometryType()==="Point")return function(p,v,_){const w=[];for(const M of p)for(const L of M)w.push(xm(L,v));const T=new Kd(w[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?Eb(w,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T):_.type==="MultiLineString"?y_(w,!1,_.coordinates,T):_.type==="Polygon"||_.type==="MultiPolygon"?wm(w,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,T):null}(l,h,this.geometries);if(r.geometryType()==="LineString")return function(p,v,_){const w=[];for(const M of p){const L=[];for(const z of M)L.push(xm(z,v));w.push(L)}const T=new Kd(w[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return y_(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",w,T);if(_.type==="MultiLineString"){let M=1/0;for(let L=0;L<_.coordinates.length;L++){const z=y_(_.coordinates[L],!0,w,T,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}if(_.type==="Polygon"||_.type==="MultiPolygon"){let M=1/0;for(let L=0;L<w.length;L++){const z=wm(w[L],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,T,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return null}(l,h,this.geometries);if(r.geometryType()==="Polygon")return function(p,v,_){const w=[];for(const M of function(L,z){const F=L.length;if(F<=1)return[L];const G=[];let W,J;for(let oe=0;oe<F;oe++){const le=QE(L[oe]);le!==0&&(L[oe].area=Math.abs(le),J===void 0&&(J=le<0),J===le<0?(W&&G.push(W),W=[L[oe]]):W.push(L[oe]))}return W&&G.push(W),G}(p)){const L=[];for(let z=0;z<M.length;++z)L.push(oT(M[z],v));w.push(L)}const T=new Kd(w[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return wm(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",w,T);if(_.type==="MultiLineString"){let M=1/0;for(let L=0;L<_.coordinates.length;L++){const z=wm(_.coordinates[L],!0,w,T,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return _.type==="Polygon"||_.type==="MultiPolygon"?function(M,L,z){let F=1/0;for(const G of M)for(const W of L){const J=uT(G,W,z,F);if(isNaN(J))return J;if((F=Math.min(F,J))===0)return F}return F}(_.type==="Polygon"?[_.coordinates]:_.coordinates,w,T):null}(l,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Jd(c){if(c instanceof Qa&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof td||c instanceof nd)return!1;if(c instanceof eh)return c.featureConstant;let r=!0;return c.eachChild(l=>{r&&!Jd(l)&&(r=!1)}),r}function Uf(c){if(c instanceof Qa&&c.name==="feature-state")return!1;let r=!0;return c.eachChild(l=>{r&&!Uf(l)&&(r=!1)}),r}function Qd(c,r){if(c instanceof Qa&&r.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild(h=>{l&&!Qd(h,r)&&(l=!1)}),l}function Tb(c,r,l){return[c,r,l].filter(Boolean).join("")}function b_(c,r){switch(c){case"string":return Jl(r);case"number":return+r;case"boolean":return!!r;case"color":return Mi.parse(r);case"formatted":return xa.fromString(Jl(r));case"resolvedImage":return gs.build(Jl(r))}return r}function Ib(c,r,l,h){return h!==void 0&&(c=h*Math.round(c/h)),r!==void 0&&c<r&&(c=r),l!==void 0&&c>l&&(c=l),c}class eh{constructor(r,l,h,p=!1){this.type=r,this.key=l,this.scope=h,this.featureConstant=p}static parse(r,l){let h=l.expectedType;if(h==null&&(h=Ai),r.length<2||r.length>3)return l.error("Invalid number of arguments for 'config' expression.");const p=l.parse(r[1],1);if(!(p instanceof Sc))return l.error("Key name of 'config' expression must be a string literal.");let v,_=!0;const w=Jl(p.value);if(r.length>=3){const T=l.parse(r[2],2);if(!(T instanceof Sc))return l.error("Scope of 'config' expression must be a string literal.");v=Jl(T.value)}if(l.options){const T=Tb(w,v,l._scope),M=l.options.get(T);M&&(_=Jd(M.value||M.default))}return new eh(h,w,v,_)}evaluate(r){const l=Tb(this.key,this.scope,r.scope),h=r.getConfig(l);if(!h)return null;const{type:p,value:v,values:_,minValue:w,maxValue:T,stepValue:M}=h,L=h.default.evaluate(r);let z=L;if(v){const F=r.scope;r.scope=(F||"").split("").slice(1).join(""),z=v.evaluate(r),r.scope=F}return p&&(z=b_(p,z)),z===void 0||w===void 0&&T===void 0&&M===void 0||(typeof z=="number"?z=Ib(z,w,T,M):Array.isArray(z)&&(z=z.map(F=>typeof F=="number"?Ib(F,w,T,M):F))),v!==void 0&&z!==void 0&&_&&!_.includes(z)&&(z=L,p&&(z=b_(p,z))),(p&&p!==this.type||z!==void 0&&!um(fa(z),this.type))&&(z=b_(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.scope),r}}class Sm{constructor(r,l){this.type=l.type,this.name=r,this.boundExpression=l}static parse(r,l){if(r.length!==2||typeof r[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const h=r[1];return l.scope.has(h)?new Sm(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Cm{constructor(r,l=[],h,p=new pl,v=[],_,w,T){this.registry=r,this.path=l,this.key=l.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=p,this.errors=v,this.expectedType=h,this._scope=_,this.options=w,this.iconImageUseTheme=T}parse(r,l,h,p,v={}){return l||h?this.concat(l,null,h,p)._parse(r,v):this._parse(r,v)}parseObjectValue(r,l,h,p,v,_={}){return this.concat(l,h,p,v)._parse(r,_)}_parse(r,l){function h(p,v,_){return _==="assert"?new Hn(v,[p]):_==="coerce"?new Ql(v,[p]):p}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof r[0]=="string"?this.registry[r[0]]:void 0;if(p){let v=p.parse(r,this);if(!v)return null;if(this.expectedType){const _=this.expectedType,w=v.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||w.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(_,w))return null}else v=h(v,_,l.typeAnnotation||"coerce");else v=h(v,_,l.typeAnnotation||"assert")}if(!(v instanceof Sc)&&v.type.kind!=="resolvedImage"&&w_(v)){const _=new Ma(this._scope,this.options,this.iconImageUseTheme);try{v=new Sc(v.type,v.evaluate(_))}catch(w){return this.error(w.message),null}}return v}return Ql.parse(["to-array",r],this)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,l,h,p){let v=typeof r=="number"?this.path.concat(r):this.path;v=typeof l=="string"?v.concat(l):v;const _=p?this.scope.concat(p):this.scope;return new Cm(this.registry,v,h||null,_,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(r,...l){const h=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new fl(h,r))}checkSubtype(r,l){const h=Lf(r,l);return h&&this.error(h),h}}function w_(c){if(c instanceof Sm)return w_(c.boundExpression);if(c instanceof Qa&&c.name==="error"||c instanceof Wd||c instanceof td||c instanceof nd||c instanceof eh)return!1;const r=c instanceof Ql||c instanceof Hn;let l=!0;return c.eachChild(h=>{l=r?l&&w_(h):l&&h instanceof Sc}),!!l&&Jd(c)&&Qd(c,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Em(c,r){const l=c.length-1;let h,p,v=0,_=l,w=0;for(;v<=_;)if(w=Math.floor((v+_)/2),h=c[w],p=c[w+1],h<=r){if(w===l||r<p)return w;v=w+1}else{if(!(h>r))throw new Lo("Input is not a number.");_=w-1}return 0}class Hf{constructor(r,l,h){this.type=r,this.input=l,this.labels=[],this.outputs=[];for(const[p,v]of h)this.labels.push(p),this.outputs.push(v)}static parse(r,l){if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(r[1],1,Yn);if(!h)return null;const p=[];let v=null;l.expectedType&&l.expectedType.kind!=="value"&&(v=l.expectedType);for(let _=1;_<r.length;_+=2){const w=_===1?-1/0:r[_],T=r[_+1],M=_,L=_+1;if(typeof w!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=w)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const z=l.parse(T,L,v);if(!z)return null;v=v||z.type,p.push([w,z])}return new Hf(v,h,p)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=l[0])return h[0].evaluate(r);const v=l.length;return p>=l[v-1]?h[v-1].evaluate(r):h[Em(l,p)].evaluate(r)}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&r.push(this.labels[l]),r.push(this.outputs[l].serialize());return r}}const Pb=.95047,Mb=1.08883,Rb=4/29,th=6/29,Tm=3*th*th,hT=th*th*th,Ab=Math.PI/180,fT=180/Math.PI;function S_(c){return c>hT?Math.pow(c,1/3):c/Tm+Rb}function C_(c){return c>th?c*c*c:Tm*(c-Rb)}function Im(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Pm(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function rd(c){const r=Pm(c.r),l=Pm(c.g),h=Pm(c.b),p=S_((.4124564*r+.3575761*l+.1804375*h)/Pb),v=S_((.2126729*r+.7151522*l+.072175*h)/1);return{l:116*v-16,a:500*(p-v),b:200*(v-S_((.0193339*r+.119192*l+.9503041*h)/Mb)),alpha:c.a}}function E_(c){let r=(c.l+16)/116,l=isNaN(c.a)?r:r+c.a/500,h=isNaN(c.b)?r:r-c.b/200;return r=1*C_(r),l=Pb*C_(l),h=Mb*C_(h),new Mi(Im(3.2404542*l-1.5371385*r-.4985314*h),Im(-.969266*l+1.8760108*r+.041556*h),Im(.0556434*l-.2040259*r+1.0572252*h),c.alpha)}function Ob(c,r,l){const h=r-c;return c+l*(h>180||h<-180?h-360*Math.round(h/360):h)}const Gf={forward:rd,reverse:E_,interpolate:function(c,r,l){return{l:vr(c.l,r.l,l),a:vr(c.a,r.a,l),b:vr(c.b,r.b,l),alpha:vr(c.alpha,r.alpha,l)}}},id={forward:function(c){const{l:r,a:l,b:h}=rd(c),p=Math.atan2(h,l)*fT;return{h:p<0?p+360:p,c:Math.sqrt(l*l+h*h),l:r,alpha:c.a}},reverse:function(c){const r=c.h*Ab,l=c.c;return E_({l:c.l,a:Math.cos(r)*l,b:Math.sin(r)*l,alpha:c.alpha})},interpolate:function(c,r,l){return{h:Ob(c.h,r.h,l),c:vr(c.c,r.c,l),l:vr(c.l,r.l,l),alpha:vr(c.alpha,r.alpha,l)}}};var Mm=Object.freeze({__proto__:null,hcl:id,lab:Gf});class Ws{constructor(r,l,h,p,v){this.type=r,this.operator=l,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[_,w]of v)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(r,l,h,p){let v=0;if(r.name==="exponential")v=T_(l,r.base,h,p);else if(r.name==="linear")v=T_(l,1,h,p);else if(r.name==="cubic-bezier"){const _=r.controlPoints;v=new Hr(_[0],_[1],_[2],_[3]).solve(T_(l,1,h,p))}return v}static parse(r,l){let[h,p,v,..._]=r;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const M=p[1];if(typeof M!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const M=p.slice(1);if(M.length!==4||M.some(L=>typeof L!="number"||L<0||L>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length-1>3&&(r.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(v=l.parse(v,2,Yn),!v)return null;const w=[];let T=null;h==="interpolate-hcl"||h==="interpolate-lab"?T=Cs:l.expectedType&&l.expectedType.kind!=="value"&&(T=l.expectedType);for(let M=0;M<_.length;M+=2){const L=_[M],z=_[M+1],F=M+3,G=M+4;if(typeof L!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(w.length&&w[w.length-1][0]>=L)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const W=l.parse(z,G,T);if(!W)return null;T=T||W.type,w.push([L,W])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Ws(T,h,p,v,w):l.error(`Type ${ta(T)} is not interpolatable.`)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=l[0])return h[0].evaluate(r);const v=l.length;if(p>=l[v-1])return h[v-1].evaluate(r);const _=Em(l,p),w=Ws.interpolationFactor(this.interpolation,p,l[_],l[_+1]),T=h[_].evaluate(r),M=h[_+1].evaluate(r);return this.operator==="interpolate"?bc[this.type.kind.toLowerCase()](T,M,w):this.operator==="interpolate-hcl"?id.reverse(id.interpolate(id.forward(T),id.forward(M),w)):Gf.reverse(Gf.interpolate(Gf.forward(T),Gf.forward(M),w))}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,r,this.input.serialize()];for(let h=0;h<this.labels.length;h++)l.push(this.labels[h],this.outputs[h].serialize());return l}}function T_(c,r,l,h){const p=h-l,v=c-l;return p===0?0:r===1?v/p:(Math.pow(r,v)-1)/(Math.pow(r,p)-1)}class Wf{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expectected at least one argument.");let h=null;const p=l.expectedType;p&&p.kind!=="value"&&(h=p);const v=[];for(const w of r.slice(1)){const T=l.parse(w,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!T)return null;h=h||T.type,v.push(T)}const _=p&&v.some(w=>Lf(p,w.type));return new Wf(_?Ai:h,v)}evaluate(r){let l,h=null,p=0;for(const v of this.args){if(p++,h=v.evaluate(r),h&&h instanceof gs&&!h.available&&(l||(l=h),h=null,p===this.args.length))return l;if(h!==null)break}return h}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(l=>{r.push(l.serialize())}),r}}class qf{constructor(r,l){this.type=l.type,this.bindings=[].concat(r),this.result=l}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const l of this.bindings)r(l[1]);r(this.result)}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const h=[];for(let v=1;v<r.length-1;v+=2){const _=r[v];if(typeof _!="string")return l.error(`Expected string, but found ${typeof _} instead.`,v);if(/[^a-zA-Z0-9_]/.test(_))return l.error("Variable names must contain only alphanumeric characters or '_'.",v);const w=l.parse(r[v+1],v+1);if(!w)return null;h.push([_,w])}const p=l.parse(r[r.length-1],r.length-1,l.expectedType,h);return p?new qf(h,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[l,h]of this.bindings)r.push(l,h.serialize());return r.push(this.result.serialize()),r}}class I_{constructor(r,l,h){this.type=r,this.index=l,this.input=h}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Yn),p=l.parse(r[2],2,Pa(l.expectedType||Ai));return h&&p?new I_(p.type.itemType,h,p):null}evaluate(r){const l=this.index.evaluate(r),h=this.input.evaluate(r);if(l<0)throw new Lo("Array index out of bounds: negative index");if(l>=h.length)throw new Lo("Array index out of bounds: index exceeds array size");if(l!==Math.floor(l))throw new Lo("Array index must be an integer. Use at-interpolated for fractional indices");return h[l]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class P_{constructor(r,l,h){this.type=r,this.index=l,this.input=h}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Yn),p=l.parse(r[2],2,Pa(l.expectedType||Ai));return h&&p?new P_(p.type.itemType,h,p):null}evaluate(r){const l=this.index.evaluate(r),h=this.input.evaluate(r);if(l<0)throw new Lo(`Array index out of bounds: ${l} < 0.`);if(l>h.length-1)throw new Lo(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l===Math.floor(l))return h[l];const p=Math.floor(l),v=Math.ceil(l),_=h[p],w=h[v];if(typeof _!="number"||typeof w!="number")throw new Lo(`Cannot interpolate between non-number values at index ${l}.`);const T=l-p;return _*(1-T)+w*T}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class M_{constructor(r,l){this.type=Ii,this.needle=r,this.haystack=l}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ai),p=l.parse(r[2],2,Ai);return h&&p?c_(h.type,[Ii,gi,Yn,Vd,Ai])?new M_(h,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ta(h.type)} instead`):null}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(h==null)return!1;if(!zf(l,["boolean","string","number","null"]))throw new Lo(`Expected first argument to be of type boolean, string, number or null, but found ${ta(fa(l))} instead.`);if(!zf(h,["string","array"]))throw new Lo(`Expected second argument to be of type array or string, but found ${ta(fa(h))} instead.`);return h.indexOf(l)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Kf{constructor(r,l,h){this.type=Yn,this.needle=r,this.haystack=l,this.fromIndex=h}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ai),p=l.parse(r[2],2,Ai);if(!h||!p)return null;if(!c_(h.type,[Ii,gi,Yn,Vd,Ai]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ta(h.type)} instead`);if(r.length===4){const v=l.parse(r[3],3,Yn);return v?new Kf(h,p,v):null}return new Kf(h,p)}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!zf(l,["boolean","string","number","null"]))throw new Lo(`Expected first argument to be of type boolean, string, number or null, but found ${ta(fa(l))} instead.`);if(!zf(h,["string","array"]))throw new Lo(`Expected second argument to be of type array or string, but found ${ta(fa(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(r);return h.indexOf(l,p)}return h.indexOf(l)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Rm{constructor(r,l,h,p,v,_){this.inputType=r,this.type=l,this.input=h,this.cases=p,this.outputs=v,this.otherwise=_}static parse(r,l){if(r.length<5)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return l.error("Expected an even number of arguments.");let h,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const v={},_=[];for(let M=2;M<r.length-1;M+=2){let L=r[M];const z=r[M+1];Array.isArray(L)||(L=[L]);const F=l.concat(M);if(L.length===0)return F.error("Expected at least one branch label.");for(const W of L){if(typeof W!="number"&&typeof W!="string")return F.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return F.error("Numeric branch labels must be integer values.");if(h){if(F.checkSubtype(h,fa(W)))return null}else h=fa(W);if(v[String(W)]!==void 0)return F.error("Branch labels must be unique.");v[String(W)]=_.length}const G=l.parse(z,M,p);if(!G)return null;p=p||G.type,_.push(G)}const w=l.parse(r[1],1,Ai);if(!w)return null;const T=l.parse(r[r.length-1],r.length-1,p);return T?w.type.kind!=="value"&&l.concat(1).checkSubtype(h,w.type)?null:new Rm(h,p,w,v,_,T):null}evaluate(r){const l=this.input.evaluate(r);return(um(fa(l),this.inputType)&&this.outputs[this.cases[l]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),h=[],p={};for(const _ of l){const w=p[this.cases[_]];w===void 0?(p[this.cases[_]]=h.length,h.push([this.cases[_],[_]])):h[w][1].push(_)}const v=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,w]of h)r.push(w.length===1?v(w[0]):w.map(v)),r.push(this.outputs[_].serialize());return r.push(this.otherwise.serialize()),r}}class nh{constructor(r,l,h){this.type=r,this.branches=l,this.otherwise=h}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);const p=[];for(let _=1;_<r.length-1;_+=2){const w=l.parse(r[_],_,Ii);if(!w)return null;const T=l.parse(r[_+1],_+1,h);if(!T)return null;p.push([w,T]),h=h||T.type}const v=l.parse(r[r.length-1],r.length-1,h);return v?new nh(h,p,v):null}evaluate(r){for(const[l,h]of this.branches)if(l.evaluate(r))return h.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[l,h]of this.branches)r(l),r(h);r(this.otherwise)}outputDefined(){return this.branches.every(([r,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(l=>{r.push(l.serialize())}),r}}class Am{constructor(r,l,h,p){this.type=r,this.input=l,this.beginIndex=h,this.endIndex=p}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ai),p=l.parse(r[2],2,Yn);if(!h||!p)return null;if(!c_(h.type,[Pa(Ai),gi,Ai]))return l.error(`Expected first argument to be of type array or string, but found ${ta(h.type)} instead`);if(r.length===4){const v=l.parse(r[3],3,Yn);return v?new Am(h.type,h,p,v):null}return new Am(h.type,h,p)}evaluate(r){const l=this.input.evaluate(r),h=this.beginIndex.evaluate(r);if(!zf(l,["string","array"]))throw new Lo(`Expected first argument to be of type array or string, but found ${ta(fa(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(r);return l.slice(h,p)}return l.slice(h)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class Om{constructor(r,l){this.type=Pa(gi),this.str=r,this.delimiter=l}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,gi),p=l.parse(r[2],2,gi);return h&&p?new Om(h,p):void 0}evaluate(r){const l=this.str.evaluate(r),h=this.delimiter.evaluate(r);return l.split(h)}eachChild(r){r(this.str),r(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Db(c,r){return c==="=="||c==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Lb(c,r,l,h){return h.compare(r,l)===0}function rh(c,r,l){const h=c!=="=="&&c!=="!=";return class S6{constructor(v,_,w){this.type=Ii,this.lhs=v,this.rhs=_,this.collator=w,this.hasUntypedArgument=v.type.kind==="value"||_.type.kind==="value"}static parse(v,_){if(v.length!==3&&v.length!==4)return _.error("Expected two or three arguments.");const w=v[0];let T=_.parse(v[1],1,Ai);if(!T)return null;if(!Db(w,T.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${ta(T.type)}'.`);let M=_.parse(v[2],2,Ai);if(!M)return null;if(!Db(w,M.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${ta(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${ta(T.type)}' and '${ta(M.type)}'.`);h&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new Hn(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new Hn(T.type,[M])));let L=null;if(v.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(L=_.parse(v[3],3,Of),!L)return null}return new S6(T,M,L)}evaluate(v){const _=this.lhs.evaluate(v),w=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const T=fa(_),M=fa(w);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new Lo(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const T=fa(_),M=fa(w);if(T.kind!=="string"||M.kind!=="string")return r(v,_,w)}return this.collator?l(v,_,w,this.collator.evaluate(v)):r(v,_,w)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[c];return this.eachChild(_=>{v.push(_.serialize())}),v}}}const zb=rh("==",function(c,r,l){return r===l},Lb),kb=rh("!=",function(c,r,l){return r!==l},function(c,r,l,h){return!Lb(0,r,l,h)}),pT=rh("<",function(c,r,l){return r<l},function(c,r,l,h){return h.compare(r,l)<0}),mT=rh(">",function(c,r,l){return r>l},function(c,r,l,h){return h.compare(r,l)>0}),gT=rh("<=",function(c,r,l){return r<=l},function(c,r,l,h){return h.compare(r,l)<=0}),Dm=rh(">=",function(c,r,l){return r>=l},function(c,r,l,h){return h.compare(r,l)>=0});class R_{constructor(r,l,h,p,v,_){this.type=gi,this.number=r,this.locale=l,this.currency=h,this.unit=p,this.minFractionDigits=v,this.maxFractionDigits=_}static parse(r,l){if(r.length!==3)return l.error("Expected two arguments.");const h=l.parse(r[1],1,Yn);if(!h)return null;const p=r[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=l.parseObjectValue(p.locale,2,"locale",gi),!v))return null;let _=null;if(p.currency&&(_=l.parseObjectValue(p.currency,2,"currency",gi),!_))return null;let w=null;if(p.unit&&(w=l.parseObjectValue(p.unit,2,"unit",gi),!w))return null;let T=null;if(p["min-fraction-digits"]&&(T=l.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",Yn),!T))return null;let M=null;return p["max-fraction-digits"]&&(M=l.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",Yn),!M)?null:new R_(h,v,_,w,T,M)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class A_{constructor(r){this.type=Yn,this.input=r}static parse(r,l){if(r.length!==2)return l.error(`Expected 1 argument, but found ${r.length-1} instead.`);const h=l.parse(r[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${ta(h.type)} instead.`):new A_(h):null}evaluate(r){const l=this.input.evaluate(r);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Lo(`Expected value to be of type string or array, but found ${ta(fa(l))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(l=>{r.push(l.serialize())}),r}}function Fb(c){return function(){c=1831565813+(c|=0)|0;let r=Math.imul(c^c>>>15,1|c);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const ih={"==":zb,"!=":kb,">":mT,"<":pT,">=":Dm,"<=":gT,array:Hn,at:I_,"at-interpolated":P_,boolean:Hn,case:nh,coalesce:Wf,collator:Wd,format:Qu,image:Tr,in:M_,"index-of":Kf,interpolate:Ws,"interpolate-hcl":Ws,"interpolate-lab":Ws,length:A_,let:qf,literal:Sc,match:Rm,number:Hn,"number-format":R_,object:Hn,slice:Am,step:Hf,string:Hn,"to-boolean":Ql,"to-color":Ql,"to-number":Ql,"to-string":Ql,var:Sm,within:td,distance:nd,config:eh,split:Om};function O_(c,[r,l,h,p]){r=r.evaluate(c),l=l.evaluate(c),h=h.evaluate(c);const v=p?p.evaluate(c):1,_=dm(r,l,h,v);if(_)throw new Lo(_);return new Mi(r/255,l/255,h/255,v)}function Nb(c,[r,l,h,p]){r=r.evaluate(c),l=l.evaluate(c),h=h.evaluate(c);const v=p?p.evaluate(c):1,_=function(M,L,z,F){return typeof M=="number"&&M>=0&&M<=360?typeof L=="number"&&L>=0&&L<=100&&typeof z=="number"&&z>=0&&z<=100?F===void 0||typeof F=="number"&&F>=0&&F<=1?null:`Invalid hsla value [${[M,L,z,F].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof F=="number"?[M,L,z,F]:[M,L,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof F=="number"?[M,L,z,F]:[M,L,z]).join(", ")}]: 'h' must be between 0 and 360.`}(r,l,h,v);if(_)throw new Lo(_);const w=`hsla(${r}, ${l}%, ${h}%, ${v})`,T=Mi.parse(w);if(!T)throw new Lo(`Failed to parse HSLA color: ${w}`);return T}function Bb(c,r){return c in r}function Lm(c,r){const l=r[c];return l===void 0?null:l}function Ec(c){return{type:c}}function Xf(c){if(c instanceof eh)return new Set([c.key]);let r=new Set;return c.eachChild(l=>{r=new Set([...r,...Xf(l)])}),r}function zm(c){if(c instanceof Qa&&c.name==="is-active-floor")return!0;let r=!1;return c.eachChild(l=>{!r&&zm(l)&&(r=!0)}),r}function od(c){return{result:"success",value:c}}function lu(c){return{result:"error",value:c}}function D_(c,r){return!!c&&!!c.parameters&&c.parameters.indexOf(r)>-1}function km(c){return c["property-type"]==="data-driven"}function L_(c){return D_(c.expression,"measure-light")}function z_(c){return D_(c.expression,"zoom")}function Fm(c){return!!c.expression&&c.expression.interpolated}function Nm(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function k_(c){return c}function Bm(c,r){const l=r.type==="color",h=c.stops&&typeof c.stops[0][0]=="object",p=h||!(h||c.property!==void 0),v=c.type||(Fm(r)?"exponential":"interval");if(l&&((c=Object.assign({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],Mi.parse(M[1])])),c.default=Mi.parse(c.default?c.default:r.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Mm[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let _,w,T;if(v==="exponential")_=$b;else if(v==="interval")_=cu;else if(v==="categorical"){_=vT,w=Object.create(null);for(const M of c.stops)w[M[0]]=M[1];T=typeof c.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);_=_T}if(h){const M={},L=[];for(let G=0;G<c.stops.length;G++){const W=c.stops[G],J=W[0].zoom;M[J]===void 0&&(M[J]={zoom:J,type:c.type,property:c.property,default:c.default,stops:[]},L.push(J)),M[J].stops.push([W[0].value,W[1]])}const z=[];for(const G of L)z.push([M[G].zoom,Bm(M[G],r)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Ws.interpolationFactor.bind(void 0,F),zoomStops:z.map(G=>G[0]),evaluate:({zoom:G},W)=>$b({stops:z,base:c.base},r,G).evaluate(G,W)}}if(p){const M=v==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Ws.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map(L=>L[0]),evaluate:({zoom:L})=>_(c,r,L,w,T)}}return{kind:"source",evaluate(M,L){const z=L&&L.properties?L.properties[c.property]:void 0;return z===void 0?oh(c.default,r.default):_(c,r,z,w,T)}}}function oh(c,r,l){return c!==void 0?c:r!==void 0?r:l!==void 0?l:void 0}function vT(c,r,l,h,p){return oh(typeof l===p?h[l]:void 0,c.default,r.default)}function cu(c,r,l){if(!Ff(l))return oh(c.default,r.default);const h=c.stops.length;if(h===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[h-1][0])return c.stops[h-1][1];const p=Em(c.stops.map(v=>v[0]),l);return c.stops[p][1]}function $b(c,r,l){const h=c.base!==void 0?c.base:1;if(!Ff(l))return oh(c.default,r.default);const p=c.stops.length;if(p===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[p-1][0])return c.stops[p-1][1];const v=Em(c.stops.map(L=>L[0]),l),_=function(L,z,F,G){const W=G-F,J=L-F;return W===0?0:z===1?J/W:(Math.pow(z,J)-1)/(Math.pow(z,W)-1)}(l,h,c.stops[v][0],c.stops[v+1][0]),w=c.stops[v][1],T=c.stops[v+1][1];let M=bc[r.type]||k_;if(c.colorSpace&&c.colorSpace!=="rgb"){const L=Mm[c.colorSpace];M=(z,F)=>L.reverse(L.interpolate(L.forward(z),L.forward(F),_))}return typeof w.evaluate=="function"?{evaluate(...L){const z=w.evaluate.apply(void 0,L),F=T.evaluate.apply(void 0,L);if(z!==void 0&&F!==void 0)return M(z,F,_)}}:M(w,T,_)}function _T(c,r,l){return r.type==="color"?l=Mi.parse(l):r.type==="formatted"?l=xa.fromString(l.toString()):r.type==="resolvedImage"?l=gs.build(l.toString()):Gd(l)===r.type||r.type==="enum"&&r.values[l]||(l=void 0),oh(l,c.default,r.default)}Qa.register(ih,{error:[{kind:"error"},[gi],(c,[r])=>{throw new Lo(r.evaluate(c))}],typeof:[gi,[Ai],(c,[r])=>ta(fa(r.evaluate(c)))],"to-rgba":[Pa(Yn,4),[Cs],(c,[r])=>r.evaluate(c).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Pa(Yn,4),[Cs],(c,[r])=>r.evaluate(c).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Cs,[Yn,Yn,Yn],O_],rgba:[Cs,[Yn,Yn,Yn,Yn],O_],hsl:[Cs,[Yn,Yn,Yn],Nb],hsla:[Cs,[Yn,Yn,Yn,Yn],Nb],has:{type:Ii,overloads:[[[gi],(c,[r])=>Bb(r.evaluate(c),c.properties())],[[gi,Ud],(c,[r,l])=>Bb(r.evaluate(c),l.evaluate(c))]]},get:{type:Ai,overloads:[[[gi],(c,[r])=>Lm(r.evaluate(c),c.properties())],[[gi,Ud],(c,[r,l])=>Lm(r.evaluate(c),l.evaluate(c))]]},"feature-state":[Ai,[gi],(c,[r])=>Lm(r.evaluate(c),c.featureState||{})],properties:[Ud,[],c=>c.properties()],"geometry-type":[gi,[],c=>c.geometryType()],worldview:[gi,[],c=>c.globals.worldview||""],"is-active-floor":[Ii,Ec(gi),(c,r)=>{if(!(c.globals.activeFloors&&c.globals.activeFloors.size>0))return!1;const l=c.globals.activeFloors;return r.some(h=>{const p=h.evaluate(c);return l.has(p)})}],id:[Ai,[],c=>c.id()],zoom:[Yn,[],c=>c.globals.zoom],pitch:[Yn,[],c=>c.globals.pitch||0],"distance-from-center":[Yn,[],c=>c.distanceFromCenter()],"measure-light":[Yn,[gi],(c,[r])=>c.measureLight(r.evaluate(c))],"heatmap-density":[Yn,[],c=>c.globals.heatmapDensity||0],"line-progress":[Yn,[],c=>c.globals.lineProgress||0],"raster-value":[Yn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Yn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Yn,[],c=>c.globals.skyRadialProgress||0],accumulated:[Ai,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Yn,Ec(Yn),(c,r)=>{let l=0;for(const h of r)l+=h.evaluate(c);return l}],"*":[Yn,Ec(Yn),(c,r)=>{let l=1;for(const h of r)l*=h.evaluate(c);return l}],"-":{type:Yn,overloads:[[[Yn,Yn],(c,[r,l])=>r.evaluate(c)-l.evaluate(c)],[[Yn],(c,[r])=>-r.evaluate(c)]]},"/":[Yn,[Yn,Yn],(c,[r,l])=>r.evaluate(c)/l.evaluate(c)],"%":[Yn,[Yn,Yn],(c,[r,l])=>r.evaluate(c)%l.evaluate(c)],ln2:[Yn,[],()=>Math.LN2],pi:[Yn,[],()=>Math.PI],e:[Yn,[],()=>Math.E],"^":[Yn,[Yn,Yn],(c,[r,l])=>Math.pow(r.evaluate(c),l.evaluate(c))],sqrt:[Yn,[Yn],(c,[r])=>Math.sqrt(r.evaluate(c))],log10:[Yn,[Yn],(c,[r])=>Math.log(r.evaluate(c))/Math.LN10],ln:[Yn,[Yn],(c,[r])=>Math.log(r.evaluate(c))],log2:[Yn,[Yn],(c,[r])=>Math.log2(r.evaluate(c))],sin:[Yn,[Yn],(c,[r])=>Math.sin(r.evaluate(c))],cos:[Yn,[Yn],(c,[r])=>Math.cos(r.evaluate(c))],tan:[Yn,[Yn],(c,[r])=>Math.tan(r.evaluate(c))],asin:[Yn,[Yn],(c,[r])=>Math.asin(r.evaluate(c))],acos:[Yn,[Yn],(c,[r])=>Math.acos(r.evaluate(c))],atan:[Yn,[Yn],(c,[r])=>Math.atan(r.evaluate(c))],min:[Yn,Ec(Yn),(c,r)=>Math.min(...r.map(l=>l.evaluate(c)))],max:[Yn,Ec(Yn),(c,r)=>Math.max(...r.map(l=>l.evaluate(c)))],abs:[Yn,[Yn],(c,[r])=>Math.abs(r.evaluate(c))],round:[Yn,[Yn],(c,[r])=>{const l=r.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[Yn,[Yn],(c,[r])=>Math.floor(r.evaluate(c))],ceil:[Yn,[Yn],(c,[r])=>Math.ceil(r.evaluate(c))],"filter-==":[Ii,[gi,Ai],(c,[r,l])=>c.properties()[r.value]===l.value],"filter-id-==":[Ii,[Ai],(c,[r])=>c.id()===r.value],"filter-type-==":[Ii,[gi],(c,[r])=>c.geometryType()===r.value],"filter-<":[Ii,[gi,Ai],(c,[r,l])=>{const h=c.properties()[r.value],p=l.value;return typeof h==typeof p&&h<p}],"filter-id-<":[Ii,[Ai],(c,[r])=>{const l=c.id(),h=r.value;return typeof l==typeof h&&l<h}],"filter->":[Ii,[gi,Ai],(c,[r,l])=>{const h=c.properties()[r.value],p=l.value;return typeof h==typeof p&&h>p}],"filter-id->":[Ii,[Ai],(c,[r])=>{const l=c.id(),h=r.value;return typeof l==typeof h&&l>h}],"filter-<=":[Ii,[gi,Ai],(c,[r,l])=>{const h=c.properties()[r.value],p=l.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[Ii,[Ai],(c,[r])=>{const l=c.id(),h=r.value;return typeof l==typeof h&&l<=h}],"filter->=":[Ii,[gi,Ai],(c,[r,l])=>{const h=c.properties()[r.value],p=l.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[Ii,[Ai],(c,[r])=>{const l=c.id(),h=r.value;return typeof l==typeof h&&l>=h}],"filter-has":[Ii,[Ai],(c,[r])=>r.value in c.properties()],"filter-has-id":[Ii,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Ii,[Pa(gi)],(c,[r])=>r.value.indexOf(c.geometryType())>=0],"filter-id-in":[Ii,[Pa(Ai)],(c,[r])=>r.value.indexOf(c.id())>=0],"filter-in-small":[Ii,[gi,Pa(Ai)],(c,[r,l])=>l.value.indexOf(c.properties()[r.value])>=0],"filter-in-large":[Ii,[gi,Pa(Ai)],(c,[r,l])=>function(h,p,v,_){for(;v<=_;){const w=v+_>>1;if(p[w]===h)return!0;p[w]>h?_=w-1:v=w+1}return!1}(c.properties()[r.value],l.value,0,l.value.length-1)],all:{type:Ii,overloads:[[[Ii,Ii],(c,[r,l])=>r.evaluate(c)&&l.evaluate(c)],[Ec(Ii),(c,r)=>{for(const l of r)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Ii,overloads:[[[Ii,Ii],(c,[r,l])=>r.evaluate(c)||l.evaluate(c)],[Ec(Ii),(c,r)=>{for(const l of r)if(l.evaluate(c))return!0;return!1}]]},"!":[Ii,[Ii],(c,[r])=>!r.evaluate(c)],"is-supported-script":[Ii,[gi],(c,[r])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(r.evaluate(c))}],upcase:[gi,[gi],(c,[r])=>r.evaluate(c).toUpperCase()],downcase:[gi,[gi],(c,[r])=>r.evaluate(c).toLowerCase()],concat:[gi,Ec(Ai),(c,r)=>r.map(l=>Jl(l.evaluate(c))).join("")],"resolved-locale":[gi,[Of],(c,[r])=>r.evaluate(c).resolvedLocale()],random:[Yn,[Yn,Yn,Ai],(c,r)=>{const[l,h,p]=r.map(_=>_.evaluate(c));if(l>h||l===h)return l;let v;if(typeof p=="string")v=function(_){let w=0;if(_.length===0)return w;for(let T=0;T<_.length;T++)w=(w<<5)-w+_.charCodeAt(T),w|=0;return w}(p);else{if(typeof p!="number")throw new Lo(`Invalid seed input: ${p}`);v=p}return l+Fb(v)()*(h-l)}]});class $m{constructor(r,l,h,p,v){this.expression=r,this._warningHistory={},this._scope=h,this._options=p,this._iconImageUseTheme=v,this._evaluator=new Ma(h,p,v),this._defaultValue=l?function(_){return _.type==="color"&&(Nm(_.default)||Array.isArray(_.default))?new Mi(0,0,0,0):_.type==="color"?Mi.parse(_.default)||null:_.default===void 0?null:_.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Xf(r),this.isIndoorDependent=zm(r)}evaluateWithoutErrorHandling(r,l,h,p,v,_,w,T){return this._evaluator.globals=r,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(r,l,h,p,v,_,w,T,M){this._evaluator||(this._evaluator=new Ma(this._scope,this._options,this._iconImageUseTheme)),this._evaluator.globals=r,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null,this._evaluator.iconImageUseTheme=M||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new Lo(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${L.message}`)),this._defaultValue}}}function jm(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in ih}function tc(c,r,l,h,p){const v=new Cm(ih,[],r?function(w){const T={color:Cs,string:gi,number:Yn,enum:gi,boolean:Ii,formatted:Ju,resolvedImage:Df};return w.type==="array"?Pa(T[w.value]||Ai,w.length):T[w.type]}(r):void 0,void 0,void 0,l,h,p),_=v.parse(c,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?od(new $m(_,r,l,h,p)):lu(v.errors)}class Zf{constructor(r,l,h,p){this.kind=r,this._styleExpression=l,this.isLightConstant=h,this.isLineProgressConstant=p,this.isStateDependent=r!=="constant"&&!Uf(l.expression),this.configDependencies=Xf(l.expression),this.isIndoorDependent=zm(l.expression)}evaluateWithoutErrorHandling(r,l,h,p,v,_){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,p,v,_)}evaluate(r,l,h,p,v,_,w){return this._styleExpression.evaluate(r,l,h,p,v,_,void 0,void 0,w)}}class uu{constructor(r,l,h,p,v,_){this.kind=r,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=r!=="camera"&&!Uf(l.expression),this.isIndoorDependent=zm(l.expression),this.isLightConstant=v,this.isLineProgressConstant=_,this.configDependencies=Xf(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,l,h,p,v,_){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,p,v,_)}evaluate(r,l,h,p,v,_){return this._styleExpression.evaluate(r,l,h,p,v,_)}interpolationFactor(r,l,h){return this.interpolationType?Ws.interpolationFactor(this.interpolationType,r,l,h):0}}function F_(c,r,l,h,p){if((c=tc(c,r,l,h,p)).result==="error")return c;const v=c.value.expression,_=Jd(v);if(!_&&!km(r))return lu([new fl("","data expressions not supported")]);const w=Qd(v,["zoom","pitch","distance-from-center"]);if(!w&&!z_(r))return lu([new fl("","zoom expressions not supported")]);const T=Qd(v,["measure-light"]);if(!T&&!L_(r))return lu([new fl("","measure-light expression not supported")]);const M=Qd(v,["line-progress"]);if(!M&&!function(F){return D_(F.expression,"line-progress")}(r))return lu([new fl("","line-progress expression not supported")]);const L=r.expression&&r.expression.relaxZoomRestriction,z=Um(v);return z||w||L?z instanceof fl?lu([z]):z instanceof Ws&&!Fm(r)?lu([new fl("",'"interpolate" expressions cannot be used with this property')]):od(z?new uu(_&&M?"camera":"composite",c.value,z.labels,z instanceof Ws?z.interpolation:void 0,T,M):new Zf(_&&M?"constant":"source",c.value,T,M)):lu([new fl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Vm{constructor(r,l){this._parameters=r,this._specification=l,Object.assign(this,Bm(this._parameters,this._specification))}static deserialize(r){return new Vm(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Um(c){let r=null;if(c instanceof qf)r=Um(c.result);else if(c instanceof Wf){for(const l of c.args)if(r=Um(l),r)break}else(c instanceof Hf||c instanceof Ws)&&c.input instanceof Qa&&c.input.name==="zoom"&&(r=c);return r instanceof fl||c.eachChild(l=>{const h=Um(l);h instanceof fl?r=h:r&&h&&r!==h&&(r=new fl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}var Yf,Hm,jb=function(){if(Hm)return Yf;Hm=1,Yf=r;var c=3;function r(l,h,p){var v=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var _=new Int32Array(this.arrayBuffer);l=_[0],this.d=(h=_[1])+2*(p=_[2]);for(var w=0;w<this.d*this.d;w++){var T=_[c+w],M=_[c+w+1];v.push(T===M?null:_.subarray(T,M))}var L=_[c+v.length+1];this.keys=_.subarray(_[c+v.length],L),this.bboxes=_.subarray(L),this.insert=this._insertReadonly}else{this.d=h+2*p;for(var z=0;z<this.d*this.d;z++)v.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=p,this.scale=h/l,this.uid=0;var F=p/h*l;this.min=-F,this.max=l+F}return r.prototype.insert=function(l,h,p,v,_){this._forEachCell(h,p,v,_,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(_)},r.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},r.prototype._insertCell=function(l,h,p,v,_,w){this.cells[_].push(w)},r.prototype.query=function(l,h,p,v,_){var w=this.min,T=this.max;if(l<=w&&h<=w&&T<=p&&T<=v&&!_)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(l,h,p,v,this._queryCell,M,{},_),M},r.prototype._queryCell=function(l,h,p,v,_,w,T,M){var L=this.cells[_];if(L!==null)for(var z=this.keys,F=this.bboxes,G=0;G<L.length;G++){var W=L[G];if(T[W]===void 0){var J=4*W;(M?M(F[J+0],F[J+1],F[J+2],F[J+3]):l<=F[J+2]&&h<=F[J+3]&&p>=F[J+0]&&v>=F[J+1])?(T[W]=!0,w.push(z[W])):T[W]=!1}}},r.prototype._forEachCell=function(l,h,p,v,_,w,T,M){for(var L=this._convertToCellCoord(l),z=this._convertToCellCoord(h),F=this._convertToCellCoord(p),G=this._convertToCellCoord(v),W=L;W<=F;W++)for(var J=z;J<=G;J++){var oe=this.d*J+W;if((!M||M(this._convertFromCellCoord(W),this._convertFromCellCoord(J),this._convertFromCellCoord(W+1),this._convertFromCellCoord(J+1)))&&_.call(this,l,h,p,v,oe,w,T,M))return}},r.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},r.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},r.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,h=c+this.cells.length+1+1,p=0,v=0;v<this.cells.length;v++)p+=this.cells[v].length;var _=new Int32Array(h+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var w=h,T=0;T<l.length;T++){var M=l[T];_[c+T]=w,_.set(M,w),w+=M.length}return _[c+l.length]=w,_.set(this.keys,w),_[c+l.length+1]=w+=this.keys.length,_.set(this.bboxes,w),w+=this.bboxes.length,_.buffer},Yf}(),ad=Rr(jb);const ah={};function Dn(c,r,l={}){Object.defineProperty(c,"_classRegistryKey",{value:r,writable:!1}),ah[r]={klass:c,omit:l.omit||[]}}Dn(Object,"Object"),ad.serialize=function(c,r){const l=c.toArrayBuffer();return r&&r.add(l),{buffer:l}},ad.deserialize=function(c){return new ad(c.buffer)},Object.defineProperty(ad,"name",{value:"Grid"}),Dn(ad,"Grid"),delete ut.prototype.constructor,typeof DOMMatrix<"u"&&Dn(DOMMatrix,"DOMMatrix"),Dn(Mi,"Color"),Dn(Error,"Error"),Dn(xa,"Formatted"),Dn(kf,"FormattedSection"),Dn(ti,"AJAXError"),Dn(gs,"ResolvedImage"),Dn(Vm,"StylePropertyFunction"),Dn($m,"StyleExpression",{omit:["_evaluator"]}),Dn(la,"ImageId"),Dn(wc,"ImageVariant"),Dn(uu,"ZoomDependentExpression"),Dn(Zf,"ZoomConstantExpression"),Dn(Qa,"CompoundExpression",{omit:["_evaluate"]});for(const c in ih)ah[ih[c]._classRegistryKey]||Dn(ih[c],`Expression${c}`);function N_(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Tc(c){return self.ImageBitmap&&c instanceof ImageBitmap}function du(c,r){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(N_(c)||Tc(c))return r&&r.add(c),c;if(ArrayBuffer.isView(c))return r&&r.add(c.buffer),c;if(c instanceof ImageData)return r&&r.add(c.data.buffer),c;if(Array.isArray(c)){const l=[];for(const h of c)l.push(du(h,r));return l}if(c instanceof Map){const l={$name:"Map",entries:[]};for(const[h,p]of c.entries())l.entries.push(du(h),du(p,r));return l}if(c instanceof Set){const l={$name:"Set"};let h=0;for(const p of c.values())l[++h]=du(p);return l}if(c instanceof DOMMatrix){const l={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of h)l[p]=c[p];return l}if(typeof c=="bigint")return{$name:"BigInt",value:c.toString()};if(typeof c=="object"){const l=c.constructor,h=l._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const p=l.serialize?l.serialize(c,r):{};if(!l.serialize){for(const v in c)c.hasOwnProperty(v)&&(ah[h].omit.indexOf(v)>=0||(p[v]=du(c[v],r)));c instanceof Error&&(p.message=c.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof c)}function hu(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||N_(c)||Tc(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(hu);if(typeof c=="object"){const r=c.$name||"Object";if(r==="Map"){const p=c.entries||[],v=new Map;for(let _=0;_<p.length;_+=2)v.set(hu(p[_]),hu(p[_+1]));return v}if(r==="Set"){const p=new Set;for(const v of Object.keys(c))v!=="$name"&&p.add(hu(c[v]));return p}if(r==="DOMMatrix"){let p;return p=c.is2D?[c.a,c.b,c.c,c.d,c.e,c.f]:[c.m11,c.m12,c.m13,c.m14,c.m21,c.m22,c.m23,c.m24,c.m31,c.m32,c.m33,c.m34,c.m41,c.m42,c.m43,c.m44],new DOMMatrix(p)}if(r==="BigInt")return BigInt(c.value);const{klass:l}=ah[r];if(!l)throw new Error(`Can't deserialize unregistered class "${r}".`);if(l.deserialize)return l.deserialize(c);const h=Object.create(l.prototype);for(const p of Object.keys(c))p!=="$name"&&(h[p]=hu(c[p]));return h}throw new Error("can't deserialize object of type "+typeof c)}const lr={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function B_(c){for(const r of c)if(Wm(r.charCodeAt(0)))return!0;return!1}function Vb(c){for(const r of c)if(!Gm(r.charCodeAt(0)))return!1;return!0}function Gm(c){return!(lr.Arabic(c)||lr["Arabic Supplement"](c)||lr["Arabic Extended-A"](c)||lr["Arabic Presentation Forms-A"](c)||lr["Arabic Presentation Forms-B"](c))}function Wm(c){return!(c!==746&&c!==747&&(c<4352||!(lr["Bopomofo Extended"](c)||lr.Bopomofo(c)||lr["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||lr["CJK Compatibility Ideographs"](c)||lr["CJK Compatibility"](c)||lr["CJK Radicals Supplement"](c)||lr["CJK Strokes"](c)||!(!lr["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||lr["CJK Unified Ideographs Extension A"](c)||lr["CJK Unified Ideographs"](c)||lr["Enclosed CJK Letters and Months"](c)||lr["Hangul Compatibility Jamo"](c)||lr["Hangul Jamo Extended-A"](c)||lr["Hangul Jamo Extended-B"](c)||lr["Hangul Jamo"](c)||lr["Hangul Syllables"](c)||lr.Hiragana(c)||lr["Ideographic Description Characters"](c)||lr.Kanbun(c)||lr["Kangxi Radicals"](c)||lr["Katakana Phonetic Extensions"](c)||lr.Katakana(c)&&c!==12540||!(!lr["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!lr["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||lr["Unified Canadian Aboriginal Syllabics"](c)||lr["Unified Canadian Aboriginal Syllabics Extended"](c)||lr["Vertical Forms"](c)||lr["Yijing Hexagram Symbols"](c)||lr["Yi Syllables"](c)||lr["Yi Radicals"](c))))}function $_(c){return!(Wm(c)||function(r){return!!(lr["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||lr["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||lr["Letterlike Symbols"](r)||lr["Number Forms"](r)||lr["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||lr["Control Pictures"](r)&&r!==9251||lr["Optical Character Recognition"](r)||lr["Enclosed Alphanumerics"](r)||lr["Geometric Shapes"](r)||lr["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||lr["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||lr["CJK Symbols and Punctuation"](r)||lr.Katakana(r)||lr["Private Use Area"](r)||lr["CJK Compatibility Forms"](r)||lr["Small Form Variants"](r)||lr["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(c))}function j_(c){return lr.Arabic(c)||lr["Arabic Supplement"](c)||lr["Arabic Extended-A"](c)||lr["Arabic Presentation Forms-A"](c)||lr["Arabic Presentation Forms-B"](c)}function Ub(c){return c>=1424&&c<=2303||lr["Arabic Presentation Forms-A"](c)||lr["Arabic Presentation Forms-B"](c)}function yT(c,r){return!(!r&&Ub(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||lr.Khmer(c))}function xT(c){for(const r of c)if(Ub(r.charCodeAt(0)))return!0;return!1}const Es={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let V_=null,ss=Es.unavailable,fu=null;const Hb=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(ss=Es.error),V_&&V_(c)};function U_(){H_.fire(new Hs("pluginStateChange",{pluginStatus:ss,pluginURL:fu}))}const H_=new xc,G_=function(){return ss},W_=function(){if(ss!==Es.deferred||!fu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ss=Es.loading,U_(),fu&&bo({url:fu},c=>{c?Hb(c):(ss=Es.loaded,U_())})},Ts={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ss===Es.loaded||Ts.applyArabicShaping!=null,isLoading:()=>ss===Es.loading,setState(c){ss=c.pluginStatus,fu=c.pluginURL},isParsing:()=>ss===Es.parsing,isParsed:()=>ss===Es.parsed,getPluginURL:()=>fu};class Wi{constructor(r,l){this.zoom=r,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness,this.worldview=l.worldview,this.activeFloors=l.activeFloors):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return function(l,h){for(const p of l)if(!yT(p.charCodeAt(0),h))return!1;return!0}(r,Ts.isLoaded())}}class Jf{constructor(r,l,h,p,v){this.property=r,this.value=l,this.expression=function(_,w,T,M,L){if(Nm(_))return new Vm(_,w);if(jm(_)||Array.isArray(_)&&_.length>0){const z=F_(_,w,T,M,L);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));return z.value}{let z=_;return typeof _=="string"&&w.type==="color"&&(z=Mi.parse(_)),{kind:"constant",configDependencies:new Set,isIndoorDependent:!1,evaluate:()=>z}}}(l===void 0?r.specification.default:l,r.specification,h,p,v)}isIndoorDependent(){return this.expression.isIndoorDependent}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,l,h,p){return this.property.possiblyEvaluate(this,r,l,h,p)}}class sh{constructor(r,l,h,p){this.property=r,this.value=new Jf(r,void 0,l,h,p)}transitioned(r,l){return new Wb(this.property,this.value,l,Object.assign({},r.transition,this.transition),r.now)}untransitioned(){return new Wb(this.property,this.value,null,{},0)}}class Gb{constructor(r,l,h,p){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=l,this._options=h,this._iconImageUseTheme=p,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(r){return $t(this._values[r].value.value)}setValue(r,l){this._values.hasOwnProperty(r)||(this._values[r]=new sh(this._values[r].property,this._scope,this._options,this._iconImageUseTheme)),this._values[r].value=new Jf(this._values[r].property,l===null?void 0:$t(l),this._scope,this._options,this._iconImageUseTheme),this._values[r].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].value.expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[r].value.isIndoorDependent())}setTransitionOrValue(r,l){l&&(this._options=l);const h=this._properties.properties;if(r)for(const p in r){const v=r[p];if(p.endsWith("-transition")){const _=p.slice(0,-11);h[_]&&this.setTransition(_,v)}else h.hasOwnProperty(p)&&this.setValue(p,v)}}getTransition(r){return $t(this._values[r].transition)}setTransition(r,l){this._values.hasOwnProperty(r)||(this._values[r]=new sh(this._values[r].property)),this._values[r].transition=$t(l)||void 0}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h);const p=this.getTransition(l);p!==void 0&&(r[`${l}-transition`]=p)}return r}transitioned(r,l){const h=new Ic(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(r,l._values[p]);return h}untransitioned(){const r=new Ic(this._properties);for(const l of Object.keys(this._values))r._values[l]=this._values[l].untransitioned();return r}isIndoorDependent(){return this._isIndoorDependent}}class Wb{constructor(r,l,h,p,v){const _=p.delay||0,w=p.duration||0;v=v||0,this.property=r,this.value=l,this.begin=v+_,this.end=this.begin+w,r.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(r,l,h){const p=r.now||0,v=this.value.possiblyEvaluate(r,l,h),_=this.prior;if(_){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return _.possiblyEvaluate(r,l,h);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(r,l,h),v,gr(w))}}return v}}class Ic{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,l,h){const p=new sd(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(r,l,h);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class q_{constructor(r,l,h,p){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=l,this._options=h,this._iconImageUseTheme=p,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(r){return $t(this._values[r].value)}setValue(r,l){this._values[r]=new Jf(this._values[r].property,l===null?void 0:$t(l),this._scope,this._options,this._iconImageUseTheme),this._values[r].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[r].isIndoorDependent())}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h)}return r}possiblyEvaluate(r,l,h,p){const v=new sd(this._properties);for(const _ of Object.keys(this._values))v._values[_]=this._values[_].possiblyEvaluate(r,l,h,p);return v}isIndoorDependent(){return this._isIndoorDependent}}class _l{constructor(r,l,h,p){this.property=r,this.value=l,this.parameters=h,this.iconImageUseTheme=p}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,l,h,p){return this.property.evaluate(this.value,this.parameters,r,l,h,p,this.iconImageUseTheme)}}class sd{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class on{constructor(r){this.specification=r}possiblyEvaluate(r,l){return r.expression.evaluate(l)}interpolate(r,l,h){const p=bc[this.specification.type];return p?p(r,l,h):r}}class bn{constructor(r,l){this.specification=r,this.overrides=l}possiblyEvaluate(r,l,h,p,v){return r.expression.kind==="constant"||r.expression.kind==="camera"?new _l(this,{kind:"constant",value:r.expression.evaluate(l,null,{},h,p,void 0,v)},l):new _l(this,r.expression,l,v)}interpolate(r,l,h){if(r.value.kind!=="constant"||l.value.kind!=="constant")return r;if(r.value.value===void 0||l.value.value===void 0)return new _l(this,{kind:"constant",value:void 0},r.parameters);const p=bc[this.specification.type];return p?new _l(this,{kind:"constant",value:p(r.value.value,l.value.value,h)},r.parameters):r}evaluate(r,l,h,p,v,_,w){return r.kind==="constant"?r.value:r.evaluate(l,h,p,v,_,void 0,w)}}class lh{constructor(r){this.specification=r}possiblyEvaluate(r,l,h,p){return!!r.expression.evaluate(l,null,{},h,p)}interpolate(){return!1}}class wo{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new Wi(0,{});for(const h in r){const p=r[h];p.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new Jf(p,void 0),_=this.defaultTransitionablePropertyValues[h]=new sh(p);this.defaultTransitioningPropertyValues[h]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate(l)}}}Dn(bn,"DataDrivenProperty"),Dn(on,"DataConstantProperty"),Dn(lh,"ColorRampProperty");var lt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor_source":{"sourceId":{"type":"string"},"sourceLayers":{"type":"array","value":"string"}},"indoor":{"*":{"type":"indoor_source"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function K_(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function ch(c){if(Array.isArray(c))return c.map(ch);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const r={};for(const l in c)r[l]=ch(c[l]);return r}return K_(c)}function uh(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const r of c.slice(1))if(!uh(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function qm(c,r="",l=null,h="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};uh(c)||(c=qs(c));const p=c;let v=!0;try{v=function(L){if(!hh(L))return L;let z=ch(L);return dh(z),z=Km(z),z}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let _=null,w=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){w=lt[`filter_${h}`];const L=tc(v,w,r,l);if(L.result==="error")throw new Error(L.value.map(z=>`${z.key}: ${z.message}`).join(", "));_=(z,F,G)=>L.value.evaluate(z,F,{},G)}let T=null,M=null;if(v!==p){const L=tc(p,w,r,l);if(L.result==="error")throw new Error(L.value.map(z=>`${z.key}: ${z.message}`).join(", "));T=(z,F,G,W,J)=>L.value.evaluate(z,F,{},G,void 0,void 0,W,J),M=!Jd(L.value.expression)}return{filter:_,dynamicFilter:T||void 0,needGeometry:Kb(v),needFeature:!!M}}function Km(c){if(!Array.isArray(c))return c;const r=function(l){if(bT.has(l[0])){for(let h=1;h<l.length;h++)if(hh(l[h]))return!0}return l}(c);return r===!0?r:r.map(l=>Km(l))}function dh(c){let r=!1;const l=[];if(c[0]==="case"){for(let h=1;h<c.length-1;h+=2)r=r||hh(c[h]),l.push(c[h+1]);l.push(c[c.length-1])}else if(c[0]==="match"){r=r||hh(c[1]);for(let h=2;h<c.length-1;h+=2)l.push(c[h+1]);l.push(c[c.length-1])}else if(c[0]==="step"){r=r||hh(c[1]);for(let h=1;h<c.length-1;h+=2)l.push(c[h+1])}r&&(c.length=0,c.push("any",...l));for(let h=1;h<c.length;h++)dh(c[h])}function hh(c){if(!Array.isArray(c))return!1;if((r=c[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let l=1;l<c.length;l++)if(hh(c[l]))return!0;return!1}const bT=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function qb(c,r){return c<r?-1:c>r?1:0}function Kb(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let r=1;r<c.length;r++)if(Kb(c[r]))return!0;return!1}function qs(c){if(!c)return!0;const r=c[0];return c.length<=1?r!=="any":r==="=="?X_(c[1],c[2],"=="):r==="!="?Xm(X_(c[1],c[2],"==")):r==="<"||r===">"||r==="<="||r===">="?X_(c[1],c[2],r):r==="any"?(l=c.slice(1),["any"].concat(l.map(qs))):r==="all"?["all"].concat(c.slice(1).map(qs)):r==="none"?["all"].concat(c.slice(1).map(qs).map(Xm)):r==="in"?Z_(c[1],c.slice(2)):r==="!in"?Xm(Z_(c[1],c.slice(2))):r==="has"?Xb(c[1]):r!=="!has"||Xm(Xb(c[1]));var l}function X_(c,r,l){switch(c){case"$type":return[`filter-type-${l}`,r];case"$id":return[`filter-id-${l}`,r];default:return[`filter-${l}`,c,r]}}function Z_(c,r){if(r.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(l=>typeof l!=typeof r[0])?["filter-in-large",c,["literal",r.sort(qb)]]:["filter-in-small",c,["literal",r]]}}function Xb(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Xm(c){return["!",c]}const Qf="";function ld(c,r){return r?`${c}${Qf}${r}`:c}let Zb;const Yb=()=>Zb||(Zb=new wo({"icon-size":new bn(lt.layout_symbol["icon-size"]),"icon-image":new bn(lt.layout_symbol["icon-image"]),"icon-rotate":new bn(lt.layout_symbol["icon-rotate"]),"icon-offset":new bn(lt.layout_symbol["icon-offset"])}));class wT{constructor(r,l,h,p,v,_){this.cachedIconPrimary=null;const w=tc(r,lt.appearance.condition);if(w.result==="success"&&(this.condition=w.value),this.name=l,h){this.properties=new sd(Yb()),this.unevaluatedLayout=new q_(Yb(),p,v,_);for(const T in h)this.unevaluatedLayout.setValue(T,h[T])}}hasCachedIconPrimary(){return this.cachedIconPrimary!==null}setCachedIconPrimary(r){this.cachedIconPrimary=r}getCachedIconPrimary(){return this.cachedIconPrimary}isActive(r){return!(this.condition||!r.isHidden||this.name!=="hidden")||this.condition.evaluate(r.globals,r.feature,r.featureState,r.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(r){return this.properties.get(r)}getUnevaluatedProperties(){return this.unevaluatedLayout}recalculate(r,l,h){this.unevaluatedLayout&&(this.properties=this.unevaluatedLayout.possiblyEvaluate(r,void 0,l,h))}serialize(){const r={};return r.condition=this.condition.expression.serialize(),this.name&&(r.name=this.name),this.unevaluatedLayout&&(r.properties=this.unevaluatedLayout.serialize()),r}}const Jb="-transition",ST=new Set(["fill","line","background","hillshade","raster"]);class es extends xc{constructor(r,l,h,p,v,_){if(super(),this.id=r.id,this.fqid=ld(this.id,h),this.type=r.type,this.scope=h,this.lut=p,this.options=v,this.iconImageUseTheme=_,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.expressionDependencies={isIndoorDependent:!1,configDependencies:new Set},r.type!=="custom"){if(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type&&r.type!=="background"&&r.type!=="sky"&&r.type!=="slot"){this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter;const w=tc(this.filter,lt[`filter_${r.type}`]);w.result!=="error"&&(this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...w.value.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||w.value.isIndoorDependent)}if(r.slot&&(this.slot=r.slot),r.appearances&&this.setAppearances(r.appearances),l.layout&&(this._unevaluatedLayout=new q_(l.layout,this.scope,v,this.iconImageUseTheme),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._unevaluatedLayout.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._unevaluatedLayout.isIndoorDependent()),l.paint){this._transitionablePaint=new Gb(l.paint,this.scope,v);for(const w in r.paint)this.setPaintProperty(w,r.paint[w]);for(const w in r.layout)this.setLayoutProperty(w,r.layout[w]);this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._transitionablePaint.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._transitionablePaint.isIndoorDependent(),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sd(l.paint)}}}onAdd(r){}onRemove(r){}isDraped(r){return!this.is3D(!0)&&ST.has(this.type)}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,l){if(this.type==="custom"&&r==="visibility")return void(this.visibility=l);const h=this._unevaluatedLayout;h._properties.properties[r]&&(h.setValue(r,l),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...h.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||h.isIndoorDependent(),r==="visibility"&&this.possiblyEvaluateVisibility())}setAppearances(r){this.appearances=[],r.forEach(l=>{this.appearances.push(new wT(l.condition,l.name,l.properties,this.scope,this.options,this.iconImageUseTheme))})}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(r){return r.endsWith(Jb)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}isPaintProperty(r){return!!this._transitionablePaint._properties.properties[r]}setPaintProperty(r,l){const h=this._transitionablePaint,p=h._properties.properties;if(r.endsWith(Jb)){const z=r.slice(0,-11);return p[z]&&h.setTransition(z,l||void 0),!1}if(!p[r])return!1;const v=h._values[r],_=v.value.isDataDriven(),w=v.value;h.setValue(r,l),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...h.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||h.isIndoorDependent(),this._handleSpecialPaintPropertyUpdate(r);const T=h._values[r].value,M=T.isDataDriven(),L=r.endsWith("pattern")||r==="line-dasharray";return M||_||L||this._handleOverridablePaintPropertyUpdate(r,w,T)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,l,h){return null}_handleOverridablePaintPropertyUpdate(r,l,h){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)}serialize(){const r={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(r.appearances=this.appearances.map(l=>l.serialize())),it(r,(l,h)=>!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length))}is3D(r){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const r in this.paint._values){const l=this.paint.get(r);if(l instanceof _l&&km(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}for(const r of this.appearances)if(!Uf(r.condition.expression))return!0;return!1}compileFilter(r){this._filterCompiled||(this._featureFilter=qm(this.filter,this.scope,r),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&(r.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRenderedFeatures(r,l,h){return{}}queryRadius(r){}queryIntersectsFeature(r,l,h,p,v,_,w,T,M){}}const CT={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ep{constructor(r,l){this._structArray=r,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xi{constructor(){this.capacity=-1,this.resize(0)}static serialize(r,l){return r._trim(),l&&l.add(r.arrayBuffer),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const l=Object.create(this.prototype);return l.arrayBuffer=r.arrayBuffer,l.length=r.length,l.capacity=r.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Zr(c,r=1){let l=0,h=0;return{members:c.map(p=>{const v=CT[p.type].BYTES_PER_ELEMENT,_=l=Y_(l,Math.max(r,v)),w=p.components||1;return h=Math.max(h,v),l+=v*w,{name:p.name,type:p.type,components:w,offset:_}}),size:Y_(l,Math.max(h,r)),alignment:r}}function Y_(c,r){return Math.ceil(c/r)*r}class vs extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const p=2*r;return this.int16[p+0]=l,this.int16[p+1]=h,r}}vs.prototype.bytesPerElement=4,Dn(vs,"StructArrayLayout2i4");class cd extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,l,h)}emplace(r,l,h,p){const v=3*r;return this.int16[v+0]=l,this.int16[v+1]=h,this.int16[v+2]=p,r}}cd.prototype.bytesPerElement=6,Dn(cd,"StructArrayLayout3i6");class fh extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,l,h,p)}emplace(r,l,h,p,v){const _=4*r;return this.int16[_+0]=l,this.int16[_+1]=h,this.int16[_+2]=p,this.int16[_+3]=v,r}}fh.prototype.bytesPerElement=8,Dn(fh,"StructArrayLayout4i8");class Pc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.float32[1*r+0]=l,r}}Pc.prototype.bytesPerElement=4,Dn(Pc,"StructArrayLayout1f4");class J_ extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,l,h)}emplace(r,l,h,p){const v=4*r,_=2*r;return this.int16[v+0]=l,this.int16[v+1]=h,this.float32[_+1]=p,r}}J_.prototype.bytesPerElement=8,Dn(J_,"StructArrayLayout2i1f8");class Q_ extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,l,h)}emplace(r,l,h,p){const v=4*r;return this.int16[v+0]=l,this.int16[v+1]=h,this.int16[v+2]=p,r}}Q_.prototype.bytesPerElement=8,Dn(Q_,"StructArrayLayout3i8");class Zm extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v){const _=this.length;return this.resize(_+1),this.emplace(_,r,l,h,p,v)}emplace(r,l,h,p,v,_){const w=5*r;return this.int16[w+0]=l,this.int16[w+1]=h,this.int16[w+2]=p,this.int16[w+3]=v,this.int16[w+4]=_,r}}Zm.prototype.bytesPerElement=10,Dn(Zm,"StructArrayLayout5i10");class Ym extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,r,l,h,p,v,_,w)}emplace(r,l,h,p,v,_,w,T){const M=6*r,L=12*r,z=3*r;return this.int16[M+0]=l,this.int16[M+1]=h,this.uint8[L+4]=p,this.uint8[L+5]=v,this.uint8[L+6]=_,this.uint8[L+7]=w,this.float32[z+2]=T,r}}Ym.prototype.bytesPerElement=12,Dn(Ym,"StructArrayLayout2i4ub1f12");class Ks extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,l,h)}emplace(r,l,h,p){const v=3*r;return this.float32[v+0]=l,this.float32[v+1]=h,this.float32[v+2]=p,r}}Ks.prototype.bytesPerElement=12,Dn(Ks,"StructArrayLayout3f12");class pu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v){const _=this.length;return this.resize(_+1),this.emplace(_,r,l,h,p,v)}emplace(r,l,h,p,v,_){const w=6*r,T=3*r;return this.uint16[w+0]=l,this.uint16[w+1]=h,this.uint16[w+2]=p,this.uint16[w+3]=v,this.float32[T+2]=_,r}}pu.prototype.bytesPerElement=12,Dn(pu,"StructArrayLayout4ui1f12");class ud extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,l,h,p)}emplace(r,l,h,p,v){const _=4*r;return this.uint16[_+0]=l,this.uint16[_+1]=h,this.uint16[_+2]=p,this.uint16[_+3]=v,r}}ud.prototype.bytesPerElement=8,Dn(ud,"StructArrayLayout4ui8");class Jm extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,l,h,p,v,_)}emplace(r,l,h,p,v,_,w){const T=6*r;return this.int16[T+0]=l,this.int16[T+1]=h,this.int16[T+2]=p,this.int16[T+3]=v,this.int16[T+4]=_,this.int16[T+5]=w,r}}Jm.prototype.bytesPerElement=12,Dn(Jm,"StructArrayLayout6i12");class Qm extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z,F){const G=this.length;return this.resize(G+1),this.emplace(G,r,l,h,p,v,_,w,T,M,L,z,F)}emplace(r,l,h,p,v,_,w,T,M,L,z,F,G){const W=12*r;return this.int16[W+0]=l,this.int16[W+1]=h,this.int16[W+2]=p,this.int16[W+3]=v,this.uint16[W+4]=_,this.uint16[W+5]=w,this.uint16[W+6]=T,this.uint16[W+7]=M,this.int16[W+8]=L,this.int16[W+9]=z,this.int16[W+10]=F,this.int16[W+11]=G,r}}Qm.prototype.bytesPerElement=24,Dn(Qm,"StructArrayLayout4i4ui4i24");class ph extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,l,h,p,v,_)}emplace(r,l,h,p,v,_,w){const T=10*r,M=5*r;return this.int16[T+0]=l,this.int16[T+1]=h,this.int16[T+2]=p,this.float32[M+2]=v,this.float32[M+3]=_,this.float32[M+4]=w,r}}ph.prototype.bytesPerElement=20,Dn(ph,"StructArrayLayout3i3f20");class mu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,l,h,p)}emplace(r,l,h,p,v){const _=4*r;return this.float32[_+0]=l,this.float32[_+1]=h,this.float32[_+2]=p,this.float32[_+3]=v,r}}mu.prototype.bytesPerElement=16,Dn(mu,"StructArrayLayout4f16");class ey extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint32[1*r+0]=l,r}}ey.prototype.bytesPerElement=4,Dn(ey,"StructArrayLayout1ul4");class yl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const p=2*r;return this.uint16[p+0]=l,this.uint16[p+1]=h,r}}yl.prototype.bytesPerElement=4,Dn(yl,"StructArrayLayout2ui4");class ty extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z,F,G){const W=this.length;return this.resize(W+1),this.emplace(W,r,l,h,p,v,_,w,T,M,L,z,F,G)}emplace(r,l,h,p,v,_,w,T,M,L,z,F,G,W){const J=20*r,oe=10*r;return this.int16[J+0]=l,this.int16[J+1]=h,this.int16[J+2]=p,this.int16[J+3]=v,this.int16[J+4]=_,this.float32[oe+3]=w,this.float32[oe+4]=T,this.float32[oe+5]=M,this.float32[oe+6]=L,this.int16[J+14]=z,this.uint32[oe+8]=F,this.uint16[J+18]=G,this.uint16[J+19]=W,r}}ty.prototype.bytesPerElement=40,Dn(ty,"StructArrayLayout5i4f1i1ul2ui40");class eg extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,r,l,h,p,v,_,w)}emplace(r,l,h,p,v,_,w,T){const M=8*r;return this.int16[M+0]=l,this.int16[M+1]=h,this.int16[M+2]=p,this.int16[M+4]=v,this.int16[M+5]=_,this.int16[M+6]=w,this.int16[M+7]=T,r}}eg.prototype.bytesPerElement=16,Dn(eg,"StructArrayLayout3i2i2i16");class mh extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v){const _=this.length;return this.resize(_+1),this.emplace(_,r,l,h,p,v)}emplace(r,l,h,p,v,_){const w=4*r,T=8*r;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=p,this.int16[T+6]=v,this.int16[T+7]=_,r}}mh.prototype.bytesPerElement=16,Dn(mh,"StructArrayLayout2f1f2i16");class gh extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,l,h,p,v,_)}emplace(r,l,h,p,v,_,w){const T=20*r,M=5*r;return this.uint8[T+0]=l,this.uint8[T+1]=h,this.float32[M+1]=p,this.float32[M+2]=v,this.float32[M+3]=_,this.float32[M+4]=w,r}}gh.prototype.bytesPerElement=20,Dn(gh,"StructArrayLayout2ub4f20");class to extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,l,h)}emplace(r,l,h,p){const v=3*r;return this.uint16[v+0]=l,this.uint16[v+1]=h,this.uint16[v+2]=p,r}}to.prototype.bytesPerElement=6,Dn(to,"StructArrayLayout3ui6");class vh extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne)}emplace(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne,Ae){const He=30*r,Ze=15*r,et=60*r;return this.int16[He+0]=l,this.int16[He+1]=h,this.int16[He+2]=p,this.float32[Ze+2]=v,this.float32[Ze+3]=_,this.uint16[He+8]=w,this.uint16[He+9]=T,this.uint32[Ze+5]=M,this.uint32[Ze+6]=L,this.uint32[Ze+7]=z,this.uint16[He+16]=F,this.uint16[He+17]=G,this.uint16[He+18]=W,this.float32[Ze+10]=J,this.float32[Ze+11]=oe,this.uint8[et+48]=le,this.uint8[et+49]=he,this.uint8[et+50]=me,this.uint32[Ze+13]=be,this.int16[He+28]=Ne,this.uint8[et+58]=Ae,r}}vh.prototype.bytesPerElement=60,Dn(vh,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ny extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne,Ae,He,Ze,et,Tt,ct,At,Bt,qt,cn,en,Vt){const Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne,Ae,He,Ze,et,Tt,ct,At,Bt,qt,cn,en,Vt)}emplace(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne,Ae,He,Ze,et,Tt,ct,At,Bt,qt,cn,en,Vt,Yt){const wt=20*r,_t=40*r,Xt=80*r;return this.float32[wt+0]=l,this.float32[wt+1]=h,this.int16[_t+4]=p,this.int16[_t+5]=v,this.int16[_t+6]=_,this.int16[_t+7]=w,this.int16[_t+8]=T,this.int16[_t+9]=M,this.int16[_t+10]=L,this.int16[_t+11]=z,this.int16[_t+12]=F,this.uint16[_t+13]=G,this.uint16[_t+14]=W,this.uint16[_t+15]=J,this.uint16[_t+16]=oe,this.uint16[_t+17]=le,this.uint16[_t+18]=he,this.uint16[_t+19]=me,this.uint16[_t+20]=be,this.uint16[_t+21]=Ne,this.uint16[_t+22]=Ae,this.uint16[_t+23]=He,this.uint16[_t+24]=Ze,this.uint16[_t+25]=et,this.uint16[_t+26]=Tt,this.uint16[_t+27]=ct,this.uint32[wt+14]=At,this.float32[wt+15]=Bt,this.float32[wt+16]=qt,this.float32[wt+17]=cn,this.float32[wt+18]=en,this.uint8[Xt+76]=Vt,this.uint16[_t+39]=Yt,r}}ny.prototype.bytesPerElement=80,Dn(ny,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class ry extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,l,h,p,v,_)}emplace(r,l,h,p,v,_,w){const T=6*r;return this.float32[T+0]=l,this.float32[T+1]=h,this.float32[T+2]=p,this.float32[T+3]=v,this.float32[T+4]=_,this.float32[T+5]=w,r}}ry.prototype.bytesPerElement=24,Dn(ry,"StructArrayLayout6f24");class dd extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v){const _=this.length;return this.resize(_+1),this.emplace(_,r,l,h,p,v)}emplace(r,l,h,p,v,_){const w=5*r;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=p,this.float32[w+3]=v,this.float32[w+4]=_,r}}dd.prototype.bytesPerElement=20,Dn(dd,"StructArrayLayout5f20");class iy extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,r,l,h,p,v,_,w)}emplace(r,l,h,p,v,_,w,T){const M=7*r;return this.float32[M+0]=l,this.float32[M+1]=h,this.float32[M+2]=p,this.float32[M+3]=v,this.float32[M+4]=_,this.float32[M+5]=w,this.float32[M+6]=T,r}}iy.prototype.bytesPerElement=28,Dn(iy,"StructArrayLayout7f28");class tp extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z){const F=this.length;return this.resize(F+1),this.emplace(F,r,l,h,p,v,_,w,T,M,L,z)}emplace(r,l,h,p,v,_,w,T,M,L,z,F){const G=11*r;return this.float32[G+0]=l,this.float32[G+1]=h,this.float32[G+2]=p,this.float32[G+3]=v,this.float32[G+4]=_,this.float32[G+5]=w,this.float32[G+6]=T,this.float32[G+7]=M,this.float32[G+8]=L,this.float32[G+9]=z,this.float32[G+10]=F,r}}tp.prototype.bytesPerElement=44,Dn(tp,"StructArrayLayout11f44");class oy extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M){const L=this.length;return this.resize(L+1),this.emplace(L,r,l,h,p,v,_,w,T,M)}emplace(r,l,h,p,v,_,w,T,M,L){const z=9*r;return this.float32[z+0]=l,this.float32[z+1]=h,this.float32[z+2]=p,this.float32[z+3]=v,this.float32[z+4]=_,this.float32[z+5]=w,this.float32[z+6]=T,this.float32[z+7]=M,this.float32[z+8]=L,r}}oy.prototype.bytesPerElement=36,Dn(oy,"StructArrayLayout9f36");class gu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const p=2*r;return this.float32[p+0]=l,this.float32[p+1]=h,r}}gu.prototype.bytesPerElement=8,Dn(gu,"StructArrayLayout2f8");class ay extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,r,l,h,p)}emplace(r,l,h,p,v){const _=6*r;return this.uint32[3*r+0]=l,this.uint16[_+2]=h,this.uint16[_+3]=p,this.uint16[_+4]=v,r}}ay.prototype.bytesPerElement=12,Dn(ay,"StructArrayLayout1ul3ui12");class tg extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint16[1*r+0]=l,r}}tg.prototype.bytesPerElement=2,Dn(tg,"StructArrayLayout1ui2");class ng extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe){const le=this.length;return this.resize(le+1),this.emplace(le,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe)}emplace(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le){const he=16*r;return this.float32[he+0]=l,this.float32[he+1]=h,this.float32[he+2]=p,this.float32[he+3]=v,this.float32[he+4]=_,this.float32[he+5]=w,this.float32[he+6]=T,this.float32[he+7]=M,this.float32[he+8]=L,this.float32[he+9]=z,this.float32[he+10]=F,this.float32[he+11]=G,this.float32[he+12]=W,this.float32[he+13]=J,this.float32[he+14]=oe,this.float32[he+15]=le,r}}ng.prototype.bytesPerElement=64,Dn(ng,"StructArrayLayout16f64");class _h extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,p,v,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,r,l,h,p,v,_,w)}emplace(r,l,h,p,v,_,w,T){const M=10*r,L=5*r;return this.uint16[M+0]=l,this.uint16[M+1]=h,this.uint16[M+2]=p,this.uint16[M+3]=v,this.float32[L+2]=_,this.float32[L+3]=w,this.float32[L+4]=T,r}}_h.prototype.bytesPerElement=20,Dn(_h,"StructArrayLayout4ui3f20");class sy extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.int16[1*r+0]=l,r}}sy.prototype.bytesPerElement=2,Dn(sy,"StructArrayLayout1i2");class rg extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint8[1*r+0]=l,r}}rg.prototype.bytesPerElement=1,Dn(rg,"StructArrayLayout1ub1");class ly extends ep{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ly.prototype.size=40;class Qb extends ty{get(r){return new ly(this,r)}}Dn(Qb,"CollisionBoxArray");class ig extends ep{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}ig.prototype.size=60;class np extends vh{get(r){return new ig(this,r)}}Dn(np,"PlacedSymbolArray");class cy extends ep{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}cy.prototype.size=80;class e1 extends ny{get(r){return new cy(this,r)}}Dn(e1,"SymbolInstanceArray");class uy extends Pc{getoffsetX(r){return this.float32[1*r+0]}}Dn(uy,"GlyphOffsetArray");class t1 extends vs{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}Dn(t1,"SymbolLineVertexArray");class og extends ep{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}og.prototype.size=12;class n1 extends ay{get(r){return new og(this,r)}}Dn(n1,"FeatureIndexArray");class r1 extends yl{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}Dn(r1,"FillExtrusionCentroidArray");class i1 extends ep{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}i1.prototype.size=6;class o1 extends cd{get(r){return new i1(this,r)}}Dn(o1,"FillExtrusionWallArray");const a1=Zr([{name:"a_pos",components:2,type:"Int16"}],4),ET=Zr([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),TT=Zr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class po{constructor(r=[]){this.segments=r}_prepareSegment(r,l,h,p){let v=this.segments[this.segments.length-1];return r>po.MAX_VERTEX_ARRAY_LENGTH&&jt(`Max vertices per segment is ${po.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!v||v.vertexLength+r>po.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:l,primitiveOffset:h,vertexLength:0,primitiveLength:0},p!==void 0&&(v.sortKey=p),this.segments.push(v)),v}prepareSegment(r,l,h,p){return this._prepareSegment(r,l.length,h.length,p)}get(){return this.segments}destroy(){for(const r of this.segments)for(const l in r.vaos)r.vaos[l].destroy()}static simpleSegment(r,l,h,p){return new po([{vertexOffset:r,primitiveOffset:l,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}function s1(c,r){return 256*(c=ie(Math.floor(c),0,255))+ie(Math.floor(r),0,255)}po.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dn(po,"SegmentVector");const IT=Zr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),PT=Zr([{name:"a_pattern_b",components:4,type:"Uint16"}]),MT=Zr([{name:"a_dash",components:4,type:"Uint16"}]);class rp{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,l,h,p){this.ids.push(ip(r)),this.positions.push(l,h,p)}eachPosition(r,l){const h=ip(r);let p=0,v=this.ids.length-1;for(;p<v;){const _=p+v>>1;this.ids[_]>=h?v=_:p=_+1}for(;this.ids[p]===h;)l(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(r,l){const h=new Float64Array(r.ids),p=new Uint32Array(r.positions);return dy(h,p,0,h.length-1),l&&(l.add(h.buffer),l.add(p.buffer)),{ids:h,positions:p}}static deserialize(r){const l=new rp;let h;l.ids=r.ids,l.positions=r.positions;for(const p of l.ids)p!==h&&l.uniqueIds.push(p),h=p;return l.indexed=!0,l}}function ip(c){const r=+c;return Number.isSafeInteger(r)?r:Pf(String(c))}function dy(c,r,l,h){for(;l<h;){const p=c[l+h>>1];let v=l-1,_=h+1;for(;;){do v++;while(c[v]<p);do _--;while(c[_]>p);if(v>=_)break;ag(c,v,_),ag(r,3*v,3*_),ag(r,3*v+1,3*_+1),ag(r,3*v+2,3*_+2)}_-l<h-_?(dy(c,r,l,_),l=_+1):(dy(c,r,_+1,h),h=_)}}function ag(c,r,l){const h=c[r];c[r]=c[l],c[l]=h}Dn(rp,"FeaturePositionMap");class xl{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,l),this.initialized=!0),!!this.location}set(r,l,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class sg extends xl{constructor(r){super(r),this.current=0}set(r,l,h){this.fetchUniformLocation(r,l)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Bo extends xl{constructor(r){super(r),this.current=0}set(r,l,h){this.fetchUniformLocation(r,l)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class nc extends xl{constructor(r){super(r),this.current=[0,0]}set(r,l,h){this.fetchUniformLocation(r,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class yh extends xl{constructor(r){super(r),this.current=[0,0,0]}set(r,l,h){this.fetchUniformLocation(r,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class op extends xl{constructor(r){super(r),this.current=[0,0,0,0]}set(r,l,h){this.fetchUniformLocation(r,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class hy extends xl{constructor(r){super(r),this.current=Mi.transparent.toPremultipliedRenderColor(null)}set(r,l,h){this.fetchUniformLocation(r,l)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const l1=new Float32Array(16);class ap extends xl{constructor(r){super(r),this.current=l1}set(r,l,h){if(this.fetchUniformLocation(r,l)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let p=1;p<16;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const RT=new Float32Array(9),c1=new Float32Array(4);class fy extends xl{constructor(r){super(r),this.current=c1}set(r,l,h){if(this.fetchUniformLocation(r,l)){for(let p=0;p<4;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function py(c){return[s1(255*c.r,255*c.g),s1(255*c.b,255*c.a)]}function lg(c,r,l,h,p,v,_,w){return!!c&&(c.kind==="composite"||c.kind==="source"?c.evaluate(new Wi(0,{brightness:v,worldview:w}),r,l,p,h,_)==="none":c.value==="none")}class cg{constructor(r,l,h,p){this.value=r,this.uniformNames=l.map(v=>`u_${v}`),this.type=h,this.context=p}setUniform(r,l,h,p,v){const _=p.constantOr(this.value);l.set(r,v,_ instanceof Mi?_.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(r,l){return this.type==="color"?new hy(r):new Bo(r)}}class sp{constructor(r,l){this.uniformNames=l.map(h=>`u_${h}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(r,l){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(r,l,h,p,v){let _=null;v!=="u_pattern"&&v!=="u_dash"||(_=this.pattern),v==="u_pattern_b"&&(_=this.patternTransition),v==="u_pixel_ratio"&&(_=this.pixelRatio),_&&l.set(r,v,_)}getBinding(r,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new op(r):new Bo(r)}}class Mc{constructor(r,l,h,p){this.expression=r,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(v=>({name:`a_${v}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(r,l,h,p,v,_,w,T){const M=this.paintVertexArray.length,L=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Wi(0,{brightness:_,worldview:T}),l,{},v,p,w):this.expression.kind==="constant"&&this.expression.value,z=lg(this.lutExpression,l,{},p,v,_,w,T);this.paintVertexArray.resize(r),this._setPaintValue(M,r,L,z?null:this.context.lut)}updatePaintArray(r,l,h,p,v,_,w,T){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:w,worldview:T},h,p,void 0,v):this.expression.kind==="constant"&&this.expression.value,L=lg(this.lutExpression,h,p,v,void 0,w,void 0,T);this._setPaintValue(r,l,M,L?null:this.context.lut)}_setPaintValue(r,l,h,p){if(this.type==="color"){const v=py(h.toPremultipliedRenderColor(p));for(let _=r;_<l;_++)this.paintVertexArray.emplace(_,v[0],v[1])}else{for(let v=r;v<l;v++)this.paintVertexArray.emplace(v,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Dl{constructor(r,l,h,p,v,_){this.expression=r,this.uniformNames=l.map(w=>`u_${w}_t`),this.type=h,this.useIntegerZoom=p,this.context=v,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(r,l,h,p,v,_,w,T){const M=this.expression.evaluate(new Wi(this.context.zoom,{brightness:_,worldview:T}),l,{},v,p,w),L=this.expression.evaluate(new Wi(this.context.zoom+1,{brightness:_,worldview:T}),l,{},v,p,w),z=lg(this.lutExpression,l,{},p,v,_,w,T),F=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(F,r,M,L,z?null:this.context.lut)}updatePaintArray(r,l,h,p,v,_,w,T){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:w,worldview:T},h,p,void 0,v),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:w,worldview:T},h,p,void 0,v),z=lg(this.lutExpression,h,p,v,void 0,w,void 0,T);this._setPaintValue(r,l,M,L,z?null:this.context.lut)}_setPaintValue(r,l,h,p,v){if(this.type==="color"){const _=py(h.toPremultipliedRenderColor(v)),w=py(h.toPremultipliedRenderColor(v));for(let T=r;T<l;T++)this.paintVertexArray.emplace(T,_[0],_[1],w[0],w[1])}else{for(let _=r;_<l;_++)this.paintVertexArray.emplace(_,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,l,h,p,v){const _=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,w=ie(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);l.set(r,v,w)}getBinding(r,l){return new Bo(r)}}class Ua{constructor(r,l,h,p,v){this.expression=r,this.layerId=v,this.paintVertexAttributes=(h==="array"?MT:IT).members;for(let _=0;_<l.length;++_);this.paintVertexArray=new p,this.paintTransitionVertexArray=new ud}populatePaintArray(r,l,h,p){const v=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(v,r,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(r,l,h,p,v,_,w){this._setPaintValues(r,l,h.patterns&&h.patterns[this.layerId],_)}_setPaintValues(r,l,h,p){if(!p||!h)return;const v=p[h[0]],_=p[h[1]];if(v){if(v){const{tl:w,br:T,pixelRatio:M}=v;for(let L=r;L<l;L++)this.paintVertexArray.emplace(L,w[0],w[1],T[0],T[1],M)}if(_){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:w,br:T}=_;for(let M=r;M<l;M++)this.paintTransitionVertexArray.emplace(M,w[0],w[1],T[0],T[1])}}}upload(r){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=r.createVertexBuffer(this.paintTransitionVertexArray,PT.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Rc{constructor(r,l,h=()=>!0){this.binders={},this._buffers=[],this.context=l;const p=[];for(const v in r.paint._values){const _=r.paint.get(v);if(v.endsWith("-use-theme")||!h(v)||!(_ instanceof _l&&km(_.property.specification)))continue;const w=OT(v,r.type),T=_.value,M=_.property.specification.type,L=!!_.property.useIntegerZoom,z=v==="line-dasharray"||v.endsWith("pattern"),F=r.paint.get(`${v}-use-theme`),G=v==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant"||F&&F.value.kind!=="constant";if(T.kind!=="constant"||G)if(T.kind==="source"||G||z){const W=my(v,M,"source");this.binders[v]=z?new Ua(T,w,M,W,r.id):new Mc(T,w,M,W),p.push(`/a_${v}`)}else{const W=my(v,M,"composite");this.binders[v]=new Dl(T,w,M,L,l,W),p.push(`/z_${v}`)}else this.binders[v]=z?new sp(T.value,w):new cg(T.value,w,M,l),p.push(`/u_${v}`);F&&(this.binders[v].lutExpression=F.value)}this.cacheKey=p.sort().join("")}getMaxValue(r){const l=this.binders[r];return l instanceof Mc||l instanceof Dl?l.maxValue:0}populatePaintArrays(r,l,h,p,v,_,w,T){for(const M in this.binders){const L=this.binders[M];L.context=this.context,(L instanceof Mc||L instanceof Dl||L instanceof Ua)&&L.populatePaintArray(r,l,h,p,v,_,w,T)}}setConstantPatternPositions(r,l){for(const h in this.binders){const p=this.binders[h];p instanceof sp&&p.setConstantPatternPositions(r,l)}}getPatternTransitionVertexBuffer(r){const l=this.binders[r];return l instanceof Ua?l.paintTransitionVertexBuffer:null}updatePaintArrays(r,l,h,p,v,_,w,T,M,L){let z=!1;const F=Object.keys(r),G=F.length!==0&&!T,W=G?F:l.uniqueIds;this.context.lut=v.lut;for(const J in this.binders){const oe=this.binders[J];if(oe.context=this.context,(oe instanceof Mc||oe instanceof Dl||oe instanceof Ua)&&oe.expression&&oe.expression.kind&&oe.expression.kind!=="constant"&&(oe.expression.isStateDependent===!0||oe.expression.isLightConstant===!1)){const le=v.paint.get(J);oe.expression=le.value;for(const he of W){const me=r[he.toString()];l.eachPosition(he,(be,Ne,Ae)=>{const He=p.feature(be);oe.updatePaintArray(Ne,Ae,He,me,_,w,M,L)})}if(!G)for(const he of h.uniqueIds){const me=r[he.toString()];h.eachPosition(he,(be,Ne,Ae)=>{const He=p.feature(be);oe.updatePaintArray(Ne,Ae,He,me,_,w,M,L)})}z=!0}}return z}defines(){const r=[];for(const l in this.binders){const h=this.binders[l];(h instanceof cg||h instanceof sp)&&r.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const l=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof cg||p instanceof sp||p instanceof Dl)for(const v of p.uniformNames)l.push({name:v,property:h,binding:p.getBinding(r,v)})}return l}setUniforms(r,l,h,p,v){for(const{name:_,property:w,binding:T}of h)this.binders[w].setUniform(r,T,v,p.get(w),_)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const l=this.binders[r];(l instanceof Mc||l instanceof Dl||l instanceof Ua)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof Ua&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(r){for(const l in this.binders){const h=this.binders[l];(h instanceof Mc||h instanceof Dl||h instanceof Ua)&&h.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const l=this.binders[r];(l instanceof Mc||l instanceof Dl||l instanceof Ua)&&l.destroy()}}}class Ll{constructor(r,l,h=()=>!0){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new Rc(p,l,h);this.needsUpload=!1,this._featureMap=new rp,this._featureMapWithoutIds=new rp,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,l,h,p,v,_,w,T,M){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(r,l,p,v,_,w,T,M);l.id!==void 0?this._featureMap.add(l.id,h,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,l,h,p,v,_,w,T){for(const M of h)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,l,M,p,v,_,w||0,T)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const AT={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function OT(c,r){return AT[c]||[c.replace(`${r}-`,"").replace(/-/g,"_")]}const DT={"line-pattern":{source:pu,composite:pu},"fill-pattern":{source:pu,composite:pu},"fill-extrusion-pattern":{source:pu,composite:pu},"line-dasharray":{source:ud,composite:ud}},LT={color:{source:gu,composite:mu},number:{source:Pc,composite:gu}};function my(c,r,l){const h=DT[c];return h&&h[l]||LT[r][l]}Dn(cg,"ConstantBinder"),Dn(sp,"PatternConstantBinder"),Dn(Mc,"SourceExpressionBinder"),Dn(Ua,"PatternCompositeBinder"),Dn(Dl,"CompositeExpressionBinder"),Dn(Rc,"ProgramConfiguration",{omit:["_buffers"]}),Dn(Ll,"ProgramConfigurationSet");const _s=fn/Math.PI/2,m=5,a=6,u=16383,g=64,x=[g,32,16],S=-_s,E=_s;function R(c,r,l,h=_s){return l=Gt(l),[c*Math.sin(l)*h,-r*h,c*Math.cos(l)*h]}function O(c,r,l){return R(Math.cos(Gt(c)),Math.sin(Gt(c)),r,l)}const $=63710088e-1,U=2*Math.PI*$;class q{constructor(r,l){if(isNaN(r)||isNaN(l))throw new Error(`Invalid LngLat object: (${r}, ${l})`);if(this.lng=+r,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new q(Re(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const l=Math.PI/180,h=this.lat*l,p=r.lat*l,v=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((r.lng-this.lng)*l);return $*Math.acos(Math.min(v,1))}toBounds(r=0){const l=360*r/40075017,h=l/Math.cos(Math.PI/180*this.lat);return new H({lng:this.lng-h,lat:this.lat-l},{lng:this.lng+h,lat:this.lat+l})}toEcef(r){return O(this.lat,this.lng,_s+r*_s/$)}static convert(r){if(r instanceof q)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new q(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new q(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class H{constructor(r,l){r&&(l?this.setSouthWest(r).setNorthEast(l):Array.isArray(r)&&r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof q?new q(r.lng,r.lat):q.convert(r),this}setSouthWest(r){return this._sw=r instanceof q?new q(r.lng,r.lat):q.convert(r),this}extend(r){const l=this._sw,h=this._ne;let p,v;if(r instanceof q)p=r,v=r;else{if(!(r instanceof H))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(H.convert(r)):this.extend(q.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(q.convert(r)):this;if(p=r._sw,v=r._ne,!p||!v)return this}return l||h?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),h.lng=Math.max(v.lng,h.lng),h.lat=Math.max(v.lat,h.lat)):(this._sw=new q(p.lng,p.lat),this._ne=new q(v.lng,v.lat)),this}getCenter(){return new q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new q(this.getWest(),this.getNorth())}getSouthEast(){return new q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:l,lat:h}=q.convert(r);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(r){if(r)return r instanceof H?r:new H(r)}}const X=0,Q=25.5;function ae(c){return U*Math.cos(c*Math.PI/180)}function ue(c){return(180+c)/360}function ce(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function pe(c,r){return c/ae(r)}function Ce(c){return 360*c-180}function ve(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Fe(c,r){return c*ae(ve(r))}const Ie=85.051129;function $e(c){return Math.cos(Gt(ie(c,-Ie,Ie)))}function Le(c,r){const l=ie(r,X,Q),h=Math.pow(2,l);return $e(c)*U/(512*h)}function Me(c){return 1/Math.cos(c*Math.PI/180)}function Ve(c,r=0){const l=Math.exp(Math.PI*(1-(c.y+r/fn)/(1<<c.z)*2));return 80150034*l/(l*l+1)/fn/(1<<c.z)}class st{constructor(r,l,h=0){this.x=+r,this.y=+l,this.z=+h}static fromLngLat(r,l=0){const h=q.convert(r);return new st(ue(h.lng),ce(h.lat),pe(l,h.lat))}toLngLat(){return new q(Ce(this.x),ve(this.y))}toAltitude(){return Fe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/U*Me(ve(this.y))}}function nt(c,r,l,h,p,v,_,w,T){const M=(r+h)/2,L=(l+p)/2,z=new ut(M,L);w(z),function(F,G,W,J,oe,le){const he=W-oe,me=J-le;return Math.abs((J-G)*he-(W-F)*me)/Math.hypot(he,me)}(z.x,z.y,v.x,v.y,_.x,_.y)>=T?(nt(c,r,l,M,L,v,z,w,T),nt(c,M,L,h,p,z,_,w,T)):c.push(_)}function Et(c,r,l){let h=c[0],p=h.x,v=h.y;r(h);const _=[h];for(let w=1;w<c.length;w++){const T=c[w],{x:M,y:L}=T;r(T),nt(_,p,v,M,L,h,T,r,l),p=M,v=L,h=T}return _}function mt(c,r,l,h){if(h(r,l)){const p=r.add(l)._mult(.5);mt(c,r,p,h),mt(c,p,l,h)}else c.push(l)}function Lt(c,r){let l=c[0];const h=[l];for(let p=1;p<c.length;p++){const v=c[p];mt(h,l,v,r),l=v}return h}const ln=Math.pow(2,14)-1,ht=-ln-1;function Qe(c,r){const l=Math.round(c.x*r),h=Math.round(c.y*r);return c.x=ie(l,ht,ln),c.y=ie(h,ht,ln),(l<c.x||l>c.x+1||h<c.y||h>c.y+1)&&jt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function kt(c,r,l){const h=c.loadGeometry(),p=c.extent,v=fn/p;if(r&&l&&l.projection.isReprojectedInTileSpace){const _=1<<r.z,{scale:w,x:T,y:M,projection:L}=l,z=F=>{const G=Ce((r.x+F.x/p)/_),W=ve((r.y+F.y/p)/_),J=L.project(G,W);F.x=(J.x*w-T)*p,F.y=(J.y*w-M)*p};for(let F=0;F<h.length;F++)if(c.type!==1)h[F]=Et(h[F],z,1);else{const G=[];for(const W of h[F])W.x<0||W.x>=p||W.y<0||W.y>=p||(z(W),G.push(W));h[F]=G}}for(const _ of h)for(const w of _)Qe(w,v);return h}function gt(c,r){return{type:c.type,id:c.id,properties:c.properties,geometry:r?kt(c):[]}}class Kt{constructor(r,l,h,p,v){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=p,this._values=v,r.readFields(pn,this,l)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const l=r.readVarint()+r.pos,h=[];let p,v=1,_=0,w=0,T=0;for(;r.pos<l;){if(_<=0){const M=r.readVarint();v=7&M,_=M>>3}if(_--,v===1||v===2)w+=r.readSVarint(),T+=r.readSVarint(),v===1&&(p&&h.push(p),p=[]),p&&p.push(new ut(w,T));else{if(v!==7)throw new Error(`unknown command ${v}`);p&&p.push(p[0].clone())}}return p&&h.push(p),h}bbox(){const r=this._pbf;r.pos=this._geometry;const l=r.readVarint()+r.pos;let h=1,p=0,v=0,_=0,w=1/0,T=-1/0,M=1/0,L=-1/0;for(;r.pos<l;){if(p<=0){const z=r.readVarint();h=7&z,p=z>>3}if(p--,h===1||h===2)v+=r.readSVarint(),_+=r.readSVarint(),v<w&&(w=v),v>T&&(T=v),_<M&&(M=_),_>L&&(L=_);else if(h!==7)throw new Error(`unknown command ${h}`)}return[w,M,T,L]}toGeoJSON(r,l,h){const p=this.extent*Math.pow(2,h),v=this.extent*r,_=this.extent*l,w=this.loadGeometry();function T(F){return[360*(F.x+v)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(F.y+_)/p)*Math.PI))-90]}function M(F){return F.map(T)}let L;if(this.type===1){const F=[];for(const W of w)F.push(W[0]);const G=M(F);L=F.length===1?{type:"Point",coordinates:G[0]}:{type:"MultiPoint",coordinates:G}}else if(this.type===2){const F=w.map(M);L=F.length===1?{type:"LineString",coordinates:F[0]}:{type:"MultiLineString",coordinates:F}}else{if(this.type!==3)throw new Error("unknown feature type");{const F=function(W){const J=W.length;if(J<=1)return[W];const oe=[];let le,he;for(let me=0;me<J;me++){const be=Nn(W[me]);be!==0&&(he===void 0&&(he=be<0),he===be<0?(le&&oe.push(le),le=[W[me]]):le&&le.push(W[me]))}return le&&oe.push(le),oe}(w),G=[];for(const W of F)G.push(W.map(M));L=G.length===1?{type:"Polygon",coordinates:G[0]}:{type:"MultiPolygon",coordinates:G}}}const z={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(z.id=this.id),z}}function pn(c,r,l){c===1?r.id=l.readVarint():c===2?function(h,p){const v=h.readVarint()+h.pos;for(;h.pos<v;){const _=p._keys[h.readVarint()],w=p._values[h.readVarint()];p.properties[_]=w}}(l,r):c===3?r.type=l.readVarint():c===4&&(r._geometry=l.pos)}function Nn(c){let r=0;for(let l,h,p=0,v=c.length,_=v-1;p<v;_=p++)l=c[p],h=c[_],r+=(h.x-l.x)*(l.y+h.y);return r}Kt.types=["Unknown","Point","LineString","Polygon"];class an{constructor(r,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(dn,this,l),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const l=this._pbf.readVarint()+this._pbf.pos;return new Kt(this._pbf,l,this.extent,this._keys,this._values)}}function dn(c,r,l){c===15?r.version=l.readVarint():c===1?r.name=l.readString():c===5?r.extent=l.readVarint():c===2?r._features.push(l.pos):c===3?r._keys.push(l.readString()):c===4&&r._values.push(function(h){let p=null;const v=h.readVarint()+h.pos;for(;h.pos<v;){const _=h.readVarint()>>3;p=_===1?h.readString():_===2?h.readFloat():_===3?h.readDouble():_===4?h.readVarint64():_===5?h.readVarint():_===6?h.readSVarint():_===7?h.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p}(l))}class jn{constructor(r,l){this.layers=r.readFields(Mn,{},l)}}function Mn(c,r,l){if(c===3){const h=new an(l,l.readVarint()+l.pos);h.length&&(r[h.name]=h)}}const wn="3d_elevation_id",Rn="level";class cr{constructor(){this._valid=!1}reset(r){return this.feature=r,this._valid=!0,this._geometry=r.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(r,l){return this._valid&&r(l(this._geometry)),this}require(r,l,h){return this.get(r,!0,l,h)}optional(r,l,h){return this.get(r,!1,l,h)}success(){return this._valid}get(r,l,h,p){const v=this.feature.properties.hasOwnProperty(r)?+this.feature.properties[r]:void 0;return this._valid&&v!==void 0&&!Number.isNaN(v)?h(p?p(v):v):l&&(this._valid=!1),this}}class Yr{constructor(r,l){this.featureFunc=r,this.vertexFunc=l}parseFeature(r,l,h){return this.featureFunc(r,l,h)}parseVertex(r,l,h){return this.vertexFunc(r,l,h)}}const ui=new Yr((c,r,l)=>c.reset(r).require(wn,h=>{l.id=h}).optional("fixed_height_relative",h=>{l.constantHeight=h},br.decodeRelativeHeight).geometry(h=>{l.bounds=h},Bf).success(),(c,r,l)=>c.reset(r).require(wn,h=>{l.id=h}).require("elevation_idx",h=>{l.idx=h}).require("extent",h=>{l.extent=h}).require("height_relative",h=>{l.height=h},br.decodeRelativeHeight).geometry(h=>{l.position=h},br.getPoint).success()),zi=new Yr((c,r,l)=>c.reset(r).require(wn,h=>{l.id=h}).optional("fixed_height",h=>{l.constantHeight=h},br.decodeMetricHeight).geometry(h=>{l.bounds=h},Bf).success(),(c,r,l)=>c.reset(r).require(wn,h=>{l.id=h}).require("elevation_idx",h=>{l.idx=h}).require("extent",h=>{l.extent=h}).require("height",h=>{l.height=h},br.decodeMetricHeight).geometry(h=>{l.position=h},br.getPoint).success());class br{static getPoint(r){return qn(r[0][0].x,r[0][0].y)}static decodeRelativeHeight(r){return 1e-4*r*5}static decodeMetricHeight(r){return 1e-4*r}static getVersionSchema(r){return r?r==="1.0.1"?zi:void 0:ui}static parse(r){const l=[],h=[],p=r.length,v=new cr;for(let _=0;_<p;_++){const w=r.feature(_),T=w.properties.version,M=br.getVersionSchema(T);if(M===void 0){jt(`Unknown elevation feature version number ${T||"(unknown)"}`);continue}const L=w.properties.type;if(!L)continue;const z=Kt.types[w.type];if(z==="Point"&&L==="curve_point"){const F={};M.parseVertex(v,w,F)&&l.push(F)}else if(z==="Polygon"&&L==="curve_meta"){const F={};M.parseFeature(v,w,F)&&h.push(F)}}return{vertices:l,features:h}}}class ai{constructor(r,l){this.pos=r,this.dir=l}intersectsPlane(r,l,h){const p=mr(l,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((r[0]-this.pos[0])*l[0]+(r[1]-this.pos[1])*l[1])/p;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,!0}}class kr{constructor(r,l){this.pos=r,this.dir=l}intersectsPlane(r,l,h){const p=Nt(l,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((r[0]-this.pos[0])*l[0]+(r[1]-this.pos[1])*l[1]+(r[2]-this.pos[2])*l[2])/p;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,h[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(r,l,h){if(function(G,W){var J=G[0],oe=G[1],le=G[2],he=W[0],me=W[1],be=W[2];return Math.abs(J-he)<=y*Math.max(1,Math.abs(J),Math.abs(he))&&Math.abs(oe-me)<=y*Math.max(1,Math.abs(oe),Math.abs(me))&&Math.abs(le-be)<=y*Math.max(1,Math.abs(le),Math.abs(be))}(this.pos,r)||l===0)return h[0]=h[1]=h[2]=0,!1;const[p,v,_]=this.dir,w=this.pos[0]-r[0],T=this.pos[1]-r[1],M=this.pos[2]-r[2],L=p*p+v*v+_*_,z=2*(w*p+T*v+M*_),F=z*z-4*L*(w*w+T*T+M*M-l*l);if(F<0){const G=Math.max(-z/2,0),W=w+p*G,J=T+v*G,oe=M+_*G,le=Math.hypot(W,J,oe);return h[0]=W*l/le,h[1]=J*l/le,h[2]=oe*l/le,!1}{const G=(-z-Math.sqrt(F))/(2*L);if(G<0){const W=Math.hypot(w,T,M);return h[0]=w*l/W,h[1]=T*l/W,h[2]=M*l/W,!1}return h[0]=w+p*G,h[1]=T+v*G,h[2]=M+_*G,!0}}}class Oi{constructor(r,l,h,p,v){this.TL=r,this.TR=l,this.BR=h,this.BL=p,this.horizon=v}static fromInvProjectionMatrix(r,l,h){const p=[-1,1,1],v=[1,1,1],_=[1,-1,1],w=[-1,-1,1],T=yt(p,p,r),M=yt(v,v,r),L=yt(_,_,r),z=yt(w,w,r);return new Oi(T,M,L,z,l/h)}}function di(c,r,l){let h=1/0,p=-1/0;const v=[];for(const _ of c){Zt(v,_,r);const w=Nt(v,l);h=Math.min(h,w),p=Math.max(p,w)}return[h,p]}function Vi(c,r){let l=!0;for(let h=0;h<c.planes.length;h++){const p=c.planes[h];let v=0;for(let _=0;_<r.length;_++)v+=+(Nt(p,r[_])+p[3]>=0);if(v===0)return 0;v!==r.length&&(l=!1)}return l?2:1}function vi(c,r){for(const l of c.projections){const h=di(r,c.points[0],l.axis);if(l.projection[1]<h[0]||l.projection[0]>h[1])return 0}return 1}function Fr(c,r){let l=0;const h=[0,0,0,0];for(let _=0;_<c.length;_++)h[0]=c[_][0],h[1]=c[_][1],h[2]=c[_][2],h[3]=1,(p=h)[0]*(v=r)[0]+p[1]*v[1]+p[2]*v[2]+p[3]*v[3]>=0&&l++;var p,v;return l}class Ei{constructor(r,l){this.points=r||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=Ur.fromPoints(this.points),this.projections=[],this.frustumEdges=[Zt([],this.points[2],this.points[3]),Zt([],this.points[0],this.points[3]),Zt([],this.points[4],this.points[0]),Zt([],this.points[5],this.points[1]),Zt([],this.points[6],this.points[2]),Zt([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const p=[0,-h[2],h[1]],v=[h[2],0,-h[0]];this.projections.push({axis:p,projection:di(this.points,this.points[0],p)}),this.projections.push({axis:v,projection:di(this.points,this.points[0],v)})}}static fromInvProjectionMatrix(r,l,h,p){const v=Math.pow(2,h),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const L=Ut([],M,r),z=1/L[3]/l*v;return(F=L)[0]=(G=L)[0]*(W=[z,z,p?1/L[3]:z,z])[0],F[1]=G[1]*W[1],F[2]=G[2]*W[2],F[3]=G[3]*W[3],F;var F,G,W}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const L=ft([],Rt([],Zt([],_[M[0]],_[M[1]]),Zt([],_[M[2]],_[M[1]]))),z=-Nt(L,_[M[1]]);return L.concat(z)}),T=[];for(let M=0;M<_.length;M++)T.push([_[M][0],_[M][1],_[M][2]]);return new Ei(T,w)}intersectsPrecise(r,l,h){for(let p=0;p<l.length;p++)if(!Fr(r,l[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!Fr(r,this.planes[p]))return 0;for(const p of h)for(const v of this.frustumEdges){const _=Rt([],p,v),w=Se(_);if(w===0)continue;qe(_,_,1/w);const T=di(this.points,this.points[0],_),M=di(r,this.points[0],_);if(T[0]>M[1]||M[0]>T[1])return 0}return 1}containsPoint(r){for(const l of this.planes){const h=l[3];if(Nt([l[0],l[1],l[2]],r)+h<0)return!1}return!0}}class Ur{static fromPoints(r){const l=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const p of r)Be(l,l,p),Xe(h,h,p);return new Ur(l,h)}static fromTileIdAndHeight(r,l,h){const p=1<<r.canonical.z,v=r.canonical.x,_=r.canonical.y;return new Ur([v/p,_/p,l],[(v+1)/p,(_+1)/p,h])}static applyTransform(r,l){const h=r.getCorners();for(let p=0;p<h.length;++p)yt(h[p],h[p],l);return Ur.fromPoints(h)}static applyTransformFast(r,l){const h=[l[12],l[13],l[14]],p=[...h];for(let v=0;v<3;v++)for(let _=0;_<3;_++){const w=l[4*_+v],T=w*r.min[_],M=w*r.max[_];h[v]+=Math.min(T,M),p[v]+=Math.max(T,M)}return new Ur(h,p)}static projectAabbCorners(r,l){const h=r.getCorners();for(let p=0;p<h.length;++p)yt(h[p],h[p],l);return h}constructor(r,l){this.min=r,this.max=l,this.center=qe([],ze([],this.min,this.max),.5)}quadrant(r){const l=[r%2==0,r<2],h=we(this.min),p=we(this.max);for(let v=0;v<l.length;v++)h[v]=l[v]?this.min[v]:this.center[v],p[v]=l[v]?this.center[v]:this.max[v];return p[2]=this.max[2],new Ur(h,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,l=this.max;return[[r[0],r[1],r[2]],[l[0],r[1],r[2]],[l[0],l[1],r[2]],[r[0],l[1],r[2]],[r[0],r[1],l[2]],[l[0],r[1],l[2]],[l[0],l[1],l[2]],[r[0],l[1],l[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?Vi(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?Vi(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,l){return l||this.intersects(r)?vi(r,this.getCorners()):0}intersectsPreciseFlat(r,l){return l||this.intersectsFlat(r)?vi(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let l=0;l<3;++l)if(this.min[l]>r.max[l]||r.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],r.min[l]),this.max[l]=Math.max(this.max[l],r.max[l])}encapsulatePoint(r){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],r[l]),this.max[l]=Math.max(this.max[l],r[l])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}Dn(Ur,"Aabb");class Ki{constructor(r,l){this.feature=r,this.metersToTile=l,this.index=0}get(){const r=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,h=l[1],p=-l[0],v=(r.extent+1)*this.metersToTile;return[new ut(Math.trunc(r.position[0]+h*v),Math.trunc(r.position[1]+p*v)),new ut(Math.trunc(r.position[0]-h*v),Math.trunc(r.position[1]-p*v))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Pi{constructor(r,l,h,p,v,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Ln(),Ln(),Ln(),Ln(),Ln(),Ln(),Ln()],this.id=r,this.heightRange={min:h,max:h},this.safeArea=l,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=v,this.edges=this.edges.filter(w=>{return w.a<this.vertices.length&&w.b<this.vertices.length&&!((T=this.vertices[w.a].position)[0]===(M=this.vertices[w.b].position)[0]&&T[1]===M[1]);var T,M}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const w of this.vertices)this.vertexProps.push({dir:qn(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,w.height),this.heightRange.max=Math.max(this.heightRange.max,w.height);for(const w of this.edges){const T=this.vertices[w.a].position,M=this.vertices[w.b].position,L=Jn(Ln(),M,T),z=_r(L),F=Ir(Ln(),L,1/z);this.edgeProps.push({vec:L,dir:F,len:z});const G=this.vertexProps[w.a].dir,W=this.vertexProps[w.b].dir;tr(G,G,F),tr(W,W,F)}for(const w of this.vertexProps)w.dir[0]===0&&w.dir[1]===0||$r(w.dir,w.dir);this.tessellate(_)}}pointElevation(r){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(r);if(l==null)return 0;const[h,p]=l;return vr(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,p)}computeSlopeNormal(r,l){const h=this.getClosestEdge(r);if(!h)return xe(0,0,1);const p=h[0],v=this.edges[p],_=this.edgeProps[p].vec,w=xe(_[0],_[1],(this.vertices[v.b].height-this.vertices[v.a].height)*l),T=xe(w[1],-w[0],0);Rt(T,T,w);const M=Se(T);return M>0?qe(T,T,1/M):Te(T,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(r){if(this.edges.length===0)return;let l=0,h=Number.POSITIVE_INFINITY,p=0;const[v,_,w,T,M,L,z]=this._tmpVec2;er(z,r.x,r.y);const F=new ai(z,null);for(let G=0;G<this.edges.length;G++){const W=this.edges[G],J=this.edgeProps[G].dir;F.dir=J;const oe=this.vertices[W.a].position,le=this.vertices[W.b].position,he=F.intersectsPlane(oe,this.vertexProps[W.a].dir,v),me=F.intersectsPlane(le,this.vertexProps[W.b].dir,_);if(!he||!me)continue;Jn(w,_,v),Jn(T,z,v);const be=mr(w,w),Ne=be>0?mr(T,w)/be:0,Ae=ie(Ne,0,1),He=Math.abs((Ne-Ae)*this.edgeProps[G].len);Jn(M,z,oe),er(L,J[1],-J[0]);const Ze=He+Math.abs(mr(M,L));Ze<h&&(l=G,h=Ze,p=Ae)}return[l,p]}tessellate(r){const l=ge(),h=ge(),p=ge(),v=ge();for(let _=this.edges.length-1;_>=0;--_){const w=this.edges[_].a,T=this.edges[_].b,{position:M,height:L,extent:z}=this.vertices[w],{position:F,height:G,extent:W}=this.vertices[T],J=this.vertexProps[w].dir,oe=this.vertexProps[T].dir;if(Te(l,M[0]/r,M[1]/r,L),Te(h,F[0]/r,F[1]/r,G),Te(p,J[1],-J[0],0),qe(p,p,z),Te(v,oe[1],-oe[0],0),qe(v,v,W),this.distSqLines(xe(l[0]+.5*p[0],l[1]+.5*p[1],l[2]+.5*p[2]),xe(h[0]-.5*v[0],h[1]-.5*v[1],h[2]-.5*v[2]),xe(l[0]-.5*p[0],l[1]-.5*p[1],l[2]-.5*p[2]),xe(h[0]+.5*v[0],h[1]+.5*v[1],h[2]+.5*v[2]))<=.0025000000000000005)continue;const le=this.vertices.length,he=tr(Ln(),M,F);this.vertices.push({position:Ir(he,he,.5),height:.5*(L+G),extent:.5*(z+W)});const me=tr(Ln(),J,oe);this.vertexProps.push({dir:$r(me,me)}),this.edges.splice(_,1),this.edgeProps.splice(_,1),this.edges.push({a:w,b:le}),this.edges.push({a:le,b:T});const be=Jn(Ln(),this.vertices[le].position,M),Ne=_r(be),Ae={vec:be,dir:Ir(Ln(),be,1/Ne),len:Ne};this.edgeProps.push(Ae),this.edgeProps.push(Ae)}}distSqLines(r,l,h,p){const v=Ue(ge(),l,r),_=Ue(ge(),p,h),w=Ue(ge(),r,h),T=Nt(v,v),M=Nt(v,_),L=Nt(v,w),z=Nt(_,_),F=Nt(_,w),G=T*z-M*M;if(G===0)return tt(pt(v,h,p,Nt(w,_)/Nt(_,_)),r);const W=(T*F-M*L)/G;return tt(pt(v,r,l,(M*F-L*z)/G),pt(_,h,p,W))}}class Sr{static parseFrom(r,l){const h=br.parse(r);if(!h)return[];let{vertices:p,features:v}=h;const _=1/Ve(l);v.sort((L,z)=>L.id-z.id),p.sort((L,z)=>L.id-z.id||L.idx-z.idx),p=p.filter((L,z,F)=>z===F.findIndex(G=>G.id===L.id&&G.idx===L.idx));const w=new Array;let T=0;const M=p.length;for(const L of v){if(L.constantHeight){w.push(new Pi(L.id,L.bounds,L.constantHeight));continue}for(;T!==M&&p[T].id<L.id;)T++;if(T===M||p[T].id!==L.id)continue;const z=new Array,F=new Array,G=T;for(;T!==M&&p[T].id===L.id;){const W=p[T];if(z.push({position:W.position,height:W.height,extent:W.extent}),T!==G&&p[T-1].idx===W.idx-1){const J=T-G;F.push({a:J-1,b:J})}T++}w.push(new Pi(L.id,L.bounds,void 0,z,F,_))}return w}static getElevationFeature(r,l){if(!l)return;const h=+r.properties[wn];return Number.isNaN(h)?void 0:l.find(p=>p.id===h)}}class fi{constructor(r,l){this.zScale=1,this.xOffset=0,this.yOffset=0,r.equals(l)||(this.zScale=Math.pow(2,l.z-r.z),this.xOffset=(r.x*this.zScale-l.x)*fn,this.yOffset=(r.y*this.zScale-l.y)*fn)}constantElevation(r,l){if(r.constantHeight!=null)return this.computeBiasedHeight(r.constantHeight,l)}pointElevation(r,l,h){const p=this.constantElevation(l,h);return p??(r.x=r.x*this.zScale+this.xOffset,r.y=r.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(r),h))}computeBiasedHeight(r,l){return l<=0?r:r+l*_e(0,l,r>=0?r:Math.abs(.5*r))}}Dn(Pi,"ElevationFeature");class ao{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new vs,this.indexArray=new to,this.segments=new po,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Pc),this.worldview=r.worldview,this.hasAppearances=null}updateFootprints(r,l){}updateAppearances(r,l,h,p){}populate(r,l,h,p){const v=this.layers[0],_=[];let w=null;v.type==="circle"&&(w=v.layout.get("circle-sort-key"));for(const{feature:M,id:L,index:z,sourceLayerIndex:F}of r){const G=this.layers[0]._featureFilter.needGeometry,W=gt(M,G);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),W,h))continue;const J=w?w.evaluate(W,{},h):void 0,oe={id:L,properties:M.properties,type:M.type,sourceLayerIndex:F,index:z,geometry:G?W.geometry:kt(M,h,p),patterns:{},sortKey:J};_.push(oe)}w&&_.sort((M,L)=>M.sortKey-L.sortKey);let T=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Jm,T=p.projection);for(const M of _){const{geometry:L,index:z,sourceLayerIndex:F}=M,G=r[z].feature;this.addFeature(M,L,z,l.availableImages,h,T,l.brightness,l.elevationFeatures),l.featureIndex.insert(G,L,z,F,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(r,l,h,p,v,_,w){this.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,a1.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,TT.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,ET.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(r,l,h,p,v,_,w,T){let M;this.elevationMode!=="none"&&(M=Sr.getElevationFeature(r,T));for(const L of l)for(const z of L){const F=z.x,G=z.y;if(F<0||F>=fn||G<0||G>=fn)continue;if(_){const oe=_.projectTilePoint(F,G,v),le=_.upVector(v,F,G);this.addGlobeExtVertex(oe,le),this.addGlobeExtVertex(oe,le),this.addGlobeExtVertex(oe,le),this.addGlobeExtVertex(oe,le)}const W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),J=W.vertexLength;if(this.addCircleVertex(F,G,-1,-1),this.addCircleVertex(F,G,1,-1),this.addCircleVertex(F,G,1,1),this.addCircleVertex(F,G,-1,1),this.elevationMode!=="none"){const oe=M?M.pointElevation(new ut(F,G)):0;this.hasElevation=this.hasElevation||oe!==0;for(let le=0;le<4;le++)this.elevatedLayoutVertexArray.emplaceBack(oe)}this.indexArray.emplaceBack(J,J+1,J+2),this.indexArray.emplaceBack(J,J+2,J+3),W.vertexLength+=4,W.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,{},p,v,w,void 0,this.worldview)}addCircleVertex(r,l,h,p){this.layoutVertexArray.emplaceBack(2*r+(h+1)/2,2*l+(p+1)/2)}addGlobeExtVertex(r,l){this.globeExtVertexArray.emplaceBack(r.x,r.y,r.z,l[0]*16384,l[1]*16384,l[2]*16384)}}function Ro(c,r){for(let l=0;l<c.length;l++)if(ba(r,c[l]))return!0;for(let l=0;l<r.length;l++)if(ba(c,r[l]))return!0;return!!ls(c,r)}function mo(c,r,l){return!!ba(c,r)||!!Fa(r,c,l)}function So(c,r){if(c.length===1)return bl(r,c[0]);for(let l=0;l<r.length;l++){const h=r[l];for(let p=0;p<h.length;p++)if(ba(c,h[p]))return!0}for(let l=0;l<c.length;l++)if(bl(r,c[l]))return!0;for(let l=0;l<r.length;l++)if(ls(c,r[l]))return!0;return!1}function ys(c,r,l){if(c.length>1){if(ls(c,r))return!0;for(let h=0;h<r.length;h++)if(Fa(r[h],c,l))return!0}for(let h=0;h<c.length;h++)if(Fa(c[h],r,l))return!0;return!1}function ls(c,r){if(c.length===0||r.length===0)return!1;for(let l=0;l<c.length-1;l++){const h=c[l],p=c[l+1];for(let v=0;v<r.length-1;v++)if(ka(h,p,r[v],r[v+1]))return!0}return!1}function ka(c,r,l,h){return rn(c,l,h)!==rn(r,l,h)&&rn(c,r,l)!==rn(c,r,h)}function Ha(c,r,l){return(c.x-l.x)*(r.y-l.y)-(c.y-l.y)*(r.x-l.x)}function Xs(c,r,l,h){const p=Ha(c,r,h),v=Ha(c,r,l);if(Math.sign(p)===Math.sign(v))return;const _=Ha(l,h,c),w=_+v-p;return Math.sign(_)!==Math.sign(w)?[_/(_-w),v/(v-p)]:void 0}function Fa(c,r,l){const h=l*l;if(r.length===1)return c.distSqr(r[0])<h;for(let p=1;p<r.length;p++)if(Zs(c,r[p-1],r[p])<h)return!0;return!1}function Zs(c,r,l){const h=r.distSqr(l);if(h===0)return c.distSqr(r);const p=((c.x-r.x)*(l.x-r.x)+(c.y-r.y)*(l.y-r.y))/h;return c.distSqr(p<0?r:p>1?l:l.sub(r)._mult(p)._add(r))}function bl(c,r){let l,h,p,v=!1;for(let _=0;_<c.length;_++){l=c[_];for(let w=0,T=l.length-1;w<l.length;T=w++)h=l[w],p=l[T],h.y>r.y!=p.y>r.y&&r.x<(p.x-h.x)*(r.y-h.y)/(p.y-h.y)+h.x&&(v=!v)}return v}function ba(c,r){let l=!1;for(let h=0,p=c.length-1;h<c.length;p=h++){const v=c[h],_=c[p];v.y>r.y!=_.y>r.y&&r.x<(_.x-v.x)*(r.y-v.y)/(_.y-v.y)+v.x&&(l=!l)}return l}function go(c,r,l,h,p){for(const _ of c)if(r<=_.x&&l<=_.y&&h>=_.x&&p>=_.y)return!0;const v=[new ut(r,l),new ut(r,p),new ut(h,p),new ut(h,l)];if(c.length>2){for(const _ of v)if(ba(c,_))return!0}for(let _=0;_<c.length-1;_++)if(Ao(c[_],c[_+1],v))return!0;return!1}function Ao(c,r,l){const h=l[0],p=l[2];if(c.x<h.x&&r.x<h.x||c.x>p.x&&r.x>p.x||c.y<h.y&&r.y<h.y||c.y>p.y&&r.y>p.y)return!1;const v=rn(c,r,l[0]);return v!==rn(c,r,l[1])||v!==rn(c,r,l[2])||v!==rn(c,r,l[3])}function $i(c,r,l,h,p,v){let _=r.y-c.y,w=c.x-r.x;if(v=v||0){const T=_*_+w*w;if(T===0)return!0;const M=Math.sqrt(T);_/=M,w/=M}return!((l.x-c.x)*_+(l.y-c.y)*w-v<0||(h.x-c.x)*_+(h.y-c.y)*w-v<0||(p.x-c.x)*_+(p.y-c.y)*w-v<0)}function zo(c,r,l,h,p,v,_){return!($i(c,r,h,p,v,_)||$i(r,l,h,p,v,_)||$i(l,c,h,p,v,_)||$i(h,p,c,r,l,_)||$i(p,v,c,r,l,_)||$i(v,h,c,r,l,_))}function wa(c,r,l){const h=r.paint.get(c).value;return h.kind==="constant"?h.value:l.programConfigurations.get(r.id).getMaxValue(c)}function vo(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ys(c,r,l,h,p){if(!r[0]&&!r[1])return c;const v=ut.convert(r)._mult(p);l==="viewport"&&v._rotate(-h);const _=[];for(let w=0;w<c.length;w++)_.push(c[w].sub(v));return _}function xh(c,r,l,h){const p=ut.convert(c)._mult(h);return r==="viewport"&&p._rotate(-l),p}let Ac,bh;function wh(c,r,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[c*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}Dn(ao,"CircleBucket",{omit:["layers"]});class Js{constructor(r,l,h){this.z=r,this.x=l,this.y=h,this.key=Qs(0,r,r,l,h)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}isChildOf(r){const l=this.z-r.z;return r.z===0||r.z<this.z&&r.x===this.x>>l&&r.y===this.y>>l}url(r,l){const h=function(v,_,w){var T=wh(256*v,256*(_=Math.pow(2,w)-_-1),w),M=wh(256*(v+1),256*(_+1),w);return T[0]+","+T[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),p=function(v,_,w){let T,M="";for(let L=v;L>0;L--)T=1<<L-1,M+=(_&T?1:0)+(w&T?2:0);return M}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rc{constructor(r,l){this.wrap=r,this.canonical=l,this.key=Qs(r,l.z,l.z,l.x,l.y)}}class pa{constructor(r,l,h,p,v){this.overscaledZ=r,this.wrap=l,this.canonical=new Js(h,+p,+v),this.key=l===0&&r===h?this.canonical.key:Qs(l,r,h,p,v)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const l=this.canonical.z-r;return r>this.canonical.z?new pa(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pa(r,this.wrap,r,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(r,l=!0){if(this.overscaledZ===r&&l)return this.key;if(r>this.canonical.z)return Qs(this.wrap*+l,r,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-r;return Qs(this.wrap*+l,r,r,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const l=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>l&&r.canonical.y===this.canonical.y>>l}children(r){if(this.overscaledZ>=r)return[new pa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new pa(l,this.wrap,l,h,p),new pa(l,this.wrap,l,h+1,p),new pa(l,this.wrap,l,h,p+1),new pa(l,this.wrap,l,h+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new pa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new pa(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rc(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Qs(c,r,l,h,p){const v=1<<Math.min(l,22);let _=v*(p%v)+h%v;return c&&l<22&&(_+=v*v*((c<0?-2*c-1:2*c)%(1<<2*(22-l)))),16*(32*_+l)+(r-l)}const hd=[c=>{let r=c.canonical.x-1,l=c.wrap;return r<0&&(r=(1<<c.canonical.z)-1,l--),new pa(c.overscaledZ,l,c.canonical.z,r,c.canonical.y)},c=>{let r=c.canonical.x+1,l=c.wrap;return r===1<<c.canonical.z&&(r=0,l++),new pa(c.overscaledZ,l,c.canonical.z,r,c.canonical.y)},c=>new pa(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new pa(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];Dn(Js,"CanonicalTileID"),Dn(pa,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const u1=Zr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ug}=u1,SW=Zr([{name:"a_pos_3",components:3,type:"Int16"}]);var HD=Zr([{name:"a_pos",type:"Int16",components:2}]);function d1(c){return c*_s/$}const CW=[new Ur([S,S,S],[E,E,E]),new Ur([S,S,S],[0,0,E]),new Ur([0,S,S],[E,0,E]),new Ur([S,0,S],[0,E,E]),new Ur([0,0,S],[E,E,E])];function GD(c,r,l,h=!0){const p=qe([],c._camera.position,c.worldSize),v=[r,l,1,1];Ut(v,v,c.pixelMatrixInverse),hn(v,v,1/v[3]);const _=ft([],Zt([],v,p)),w=c.globeMatrix,T=[w[12],w[13],w[14]],M=Zt([],T,p),L=Se(M),z=ft([],M),F=c.worldSize/(2*Math.PI),G=Nt(z,_),W=Math.asin(F/L);if(W<Math.acos(G)){if(!h)return null;const Tt=[],ct=[];qe(Tt,_,L/G),ft(ct,Zt(ct,Tt,M)),ft(_,ze(_,M,qe(_,ct,Math.tan(W)*L)))}const J=[];new kr(p,_).closestPointOnSphere(T,F,J);const oe=ft([],qr(w,0)),le=ft([],qr(w,1)),he=ft([],qr(w,2)),me=Nt(oe,J),be=Nt(le,J),Ne=Nt(he,J),Ae=mn(Math.asin(-be/F));let He=mn(Math.atan2(me,Ne));He=c.center.lng+function(Tt,ct){const At=(ct-Tt+180)%360-180;return At<-180?At+360:At}(c.center.lng,He);const Ze=ue(He),et=ie(ce(Ae),0,1);return new st(Ze,et)}class EW{constructor(r,l,h){this.a=Zt([],r,h),this.b=Zt([],l,h),this.center=h;const p=ft([],this.a),v=ft([],this.b);this.angle=Math.acos(Nt(p,v))}}function zT(c,r){if(c.angle===0)return null;let l;return l=c.a[r]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[r]/c.a[r]/Math.sin(c.angle)-1/Math.tan(c.angle)),l<0||l>1?null:function(h,p,v,_){const w=Math.sin(v);return h*(Math.sin((1-_)*v)/w)+p*(Math.sin(_*v)/w)}(c.a[r],c.b[r],c.angle,ie(l,0,1))+c.center[r]}function vu(c){if(c.z<=1)return CW[c.z+2*c.y+c.x];const r=kT(h1(c));return Ur.fromPoints(r)}function fd(c,r,l){return qe(c,c,1-l),at(c,c,r,l)}function WD(c,r,l){for(const h of c)yt(h,h,r),qe(h,h,l)}function qD(c,r,l,h){const p=r/c.worldSize,v=c.globeMatrix;if(l.z<=1){const et=vu(l).getCorners();return WD(et,v,p),Ur.fromPoints(et)}const _=h1(l,h),w=kT(_,_s+d1(c._tileCoverLift));WD(w,v,p);const T=Number.MAX_VALUE,M=[-T,-T,-T],L=[T,T,T];if(_.contains(c.center)){for(const ct of w)Be(L,L,ct),Xe(M,M,ct);M[2]=0;const et=c.point,Tt=[et.x*p,et.y*p,0];return Be(L,L,Tt),Xe(M,M,Tt),new Ur(L,M)}if(c._tileCoverLift>0){for(const et of w)Be(L,L,et),Xe(M,M,et);return new Ur(L,M)}const z=[v[12]*p,v[13]*p,v[14]*p],F=_.getCenter(),G=ie(c.center.lat,-Ie,Ie),W=ie(F.lat,-Ie,Ie),J=ue(c.center.lng),oe=ce(G);let le=J-ue(F.lng);const he=oe-ce(W);le>.5?le-=1:le<-.5&&(le+=1);let me=0;Math.abs(le)>Math.abs(he)?me=le>=0?1:3:(me=he>=0?0:2,at(z,z,[v[4]*p,v[5]*p,v[6]*p],-Math.sin(Gt(he>=0?_.getSouth():_.getNorth()))*_s));const be=w[me],Ne=w[(me+1)%4],Ae=new EW(be,Ne,z),He=[zT(Ae,0)||be[0],zT(Ae,1)||be[1],zT(Ae,2)||be[2]],Ze=Sh(c.zoom);if(Ze>0){const et=function({x:ct,y:At,z:Bt},qt,cn,en,Vt){const Yt=1/(1<<Bt);let wt=ct*Yt,_t=wt+Yt,Xt=At*Yt,sn=Xt+Yt,Ht=0;const An=(wt+_t)/2-en;return An>.5?Ht=-1:An<-.5&&(Ht=1),wt=((wt+Ht)*qt-(en*=qt))*cn+en,_t=((_t+Ht)*qt-en)*cn+en,Xt=(Xt*qt-(Vt*=qt))*cn+Vt,sn=(sn*qt-Vt)*cn+Vt,[[wt,sn,0],[_t,sn,0],[_t,Xt,0],[wt,Xt,0]]}(l,r,c._pixelsPerMercatorPixel,J,oe);for(let ct=0;ct<w.length;ct++)fd(w[ct],et[ct],Ze);const Tt=ze([],et[me],et[(me+1)%4]);qe(Tt,Tt,.5),fd(He,Tt,Ze)}for(const et of w)Be(L,L,et),Xe(M,M,et);return L[2]=Math.min(be[2],Ne[2]),Be(L,L,He),Xe(M,M,He),new Ur(L,M)}function h1({x:c,y:r,z:l},h=!1){const p=1/(1<<l),v=new q(Ce(c*p),r===(1<<l)-1&&h?-90:ve((r+1)*p)),_=new q(Ce((c+1)*p),r===0&&h?90:ve(r*p));return new H(v,_)}function kT(c,r=_s){const l=Gt(c.getNorth()),h=Gt(c.getSouth()),p=Math.cos(l),v=Math.cos(h),_=Math.sin(l),w=Math.sin(h),T=c.getWest(),M=c.getEast();return[R(v,w,T,r),R(v,w,M,r),R(p,_,M,r),R(p,_,T,r)]}function gy(c,r,l,h){const p=1<<l.z,v=(c/fn+l.x)/p;return O(ve((r/fn+l.y)/p),Ce(v),h)}function f1({min:c,max:r}){return u/Math.max(r[0]-c[0],r[1]-c[1],r[2]-c[2])}const KD=new Float64Array(16);function p1(c){const r=f1(c),l=se(KD,[r,r,r]);return K(l,l,Pt([],c.min))}function FT(c){const r=(h=c.min,(l=KD)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=h[0],l[13]=h[1],l[14]=h[2],l[15]=1,l);var l,h;const p=1/f1(c);return Y(r,r,[p,p,p])}function NT(c){const r=fn/(2*Math.PI);return c/(2*Math.PI)/r}function XD(c,r){return fn/(512*Math.pow(2,c))*f1(vu(r))}function ZD(c,r,l,h,p){const v=NT(l),_=[c,r,-l/(2*Math.PI)],w=N(new Float64Array(16));return K(w,w,_),Y(w,w,[v,v,v]),Z(w,w,Gt(-p)),te(w,w,Gt(-h)),w}function Sh(c){return _e(m,a,c)}function YD(c,r){const l=O(r.lat,r.lng),h=function(W){const J=O(W._center.lat,W._center.lng);let oe=Rt([],xe(0,1,0),J);const le=ee([],-W.angle,J);oe=yt(oe,oe,le),ee(le,-W._pitch,oe);const he=ft([],J);return qe(he,he,d1(W.cameraToCenterDistance/W.pixelsPerMeter)),yt(he,he,le),ze([],J,he)}(c);return _=(p=Ue([],h,l))[0],w=p[1],T=p[2],M=(v=l)[0],L=v[1],z=v[2],G=(F=Math.sqrt((_*_+w*w+T*T)*(M*M+L*L+z*z)))&&Nt(p,v)/F,Math.acos(Math.min(Math.max(G,-1),1));var p,v,_,w,T,M,L,z,F,G}function BT(c,r){return YD(c,r)>Math.PI/2*1.01}const JD=Gt(85),TW=Math.cos(JD),IW=Math.sin(JD),PW=k(),QD=c=>{const r=[];return c.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r};function eL(c,r,l,h,p,v,_,w,T){if(v&&c.queryGeometry.isAboveHorizon)return!1;v&&(T*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,L=l.projection.upVectorScale(M,l.center.lat,l.worldSize).metersToTile;for(const z of r)for(const F of z){const G=F.add(w),W=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(G.x,G.y,!0):0,J=l.projection.projectTilePoint(G.x,G.y,M);if(W>0){const me=l.projection.upVector(M,G.x,G.y);J.x+=me[0]*L*W,J.y+=me[1]*L*W,J.z+=me[2]*L*W}const oe=v?G:MW(J.x,J.y,J.z,h),le=v?c.tilespaceRays.map(me=>AW(me,W)):c.queryGeometry.screenGeometry,he=Ut([],[J.x,J.y,J.z,1],h);if(!_&&v?T*=he[3]/l.cameraToCenterDistance:_&&!v&&(T*=l.cameraToCenterDistance/he[3]),v){const me=ve((F.y/fn+M.y)/(1<<M.z));T/=l.projection.pixelsPerMeter(me,1)/pe(1,me)}if(mo(le,oe,T))return!0}return!1}function MW(c,r,l,h){const p=Ut([],[c,r,l,1],h);return new ut(p[0]/p[3],p[1]/p[3])}const tL=xe(0,0,0),RW=xe(0,0,1);function AW(c,r){const l=ge();return tL[2]=r,c.intersectsPlane(tL,RW,l),new ut(l[0],l[1])}class nL extends ao{}let rL,iL,oL,aL;function sL(c,{width:r,height:l},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*l*h)throw new RangeError("mismatched image size")}else p=new Uint8Array(r*l*h);return c.width=r,c.height=l,c.data=p,c}function lL(c,r,l){const{width:h,height:p}=r;h===c.width&&p===c.height||($T(c,r,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,h),height:Math.min(c.height,p)},l,null),c.width=h,c.height=p,c.data=r.data)}function $T(c,r,l,h,p,v,_,w){if(p.width===0||p.height===0)return r;if(p.width>c.width||p.height>c.height||l.x>c.width-p.width||l.y>c.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||h.x>r.width-p.width||h.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const T=c.data,M=r.data,L=v===4&&w;for(let z=0;z<p.height;z++){const F=((l.y+z)*c.width+l.x)*v,G=((h.y+z)*r.width+h.x)*v;if(L)for(let W=0;W<p.width;W++){const J=F+W*v+3,oe=G+W*v;M[oe+0]=255,M[oe+1]=255,M[oe+2]=255,M[oe+3]=T[J]}else if(_)for(let W=0;W<p.width;W++){const J=F+W*v,oe=G+W*v,le=new Mi(T[J+0]/255,T[J+1]/255,T[J+2]/255,T[J+3]).toNonPremultipliedRenderColor(_).toArray();M[oe+0]=le[0],M[oe+1]=le[1],M[oe+2]=le[2],M[oe+3]=le[3]}else for(let W=0;W<p.width*v;W++)M[G+W]=T[F+W]}return r}Dn(nL,"HeatmapBucket",{omit:["layers"]});class Ch{constructor(r,l){sL(this,r,1,l)}resize(r){lL(this,new Ch(r),1)}clone(){return new Ch({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,p,v){$T(r,l,h,p,v,1,null)}}class Ga{constructor(r,l){sL(this,r,4,l)}resize(r){lL(this,new Ga(r),4)}replace(r,l){l?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,p,v,_,w){$T(r,l,h,p,v,4,_,w)}}class cL{constructor(r,l){this.width=r.width,this.height=r.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function vy(c){const r={},l=c.resolution||256,h=c.clips?c.clips.length:1,p=c.image||new Ga({width:l,height:h}),v=(_,w,T)=>{r[c.evaluationKey]=T;const M=c.expression.evaluate(r),L=M?M.toNonPremultipliedRenderColor(null):null;L&&(p.data[_+w+0]=Math.floor(255*L.r),p.data[_+w+1]=Math.floor(255*L.g),p.data[_+w+2]=Math.floor(255*L.b),p.data[_+w+3]=Math.floor(255*L.a))};if(c.clips)for(let _=0,w=0;_<h;++_,w+=4*l)for(let T=0,M=0;T<l;T++,M+=4){const L=T/(l-1),{start:z,end:F}=c.clips[_];v(w,M,z*(1-L)+F*L)}else for(let _=0,w=0;_<l;_++,w+=4)v(0,w,_/(l-1));return p}Dn(Ch,"AlphaImage"),Dn(Ga,"RGBAImage");const OW=Zr([{name:"a_pos",components:2,type:"Int16"}],4),DW=Zr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),LW=Zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),zW=Zr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function dg(c,r,l=2){const h=r&&r.length,p=h?r[0]*l:c.length;let v=uL(c,0,p,l,!0);const _=[];if(!v||v.next===v.prev)return _;let w,T,M;if(h&&(v=function(L,z,F,G){const W=[];for(let J=0,oe=z.length;J<oe;J++){const le=uL(L,z[J]*G,J<oe-1?z[J+1]*G:L.length,G,!1);le===le.next&&(le.steiner=!0),W.push(UW(le))}W.sort($W);for(let J=0;J<W.length;J++)F=jW(W[J],F);return F}(c,r,v,l)),c.length>80*l){w=c[0],T=c[1];let L=w,z=T;for(let F=l;F<p;F+=l){const G=c[F],W=c[F+1];G<w&&(w=G),W<T&&(T=W),G>L&&(L=G),W>z&&(z=W)}M=Math.max(L-w,z-T),M=M!==0?32767/M:0}return _y(v,_,l,w,T,M,0),_}function uL(c,r,l,h,p){let v;if(p===function(_,w,T,M){let L=0;for(let z=w,F=T-M;z<T;z+=M)L+=(_[F]-_[z])*(_[z+1]+_[F+1]),F=z;return L}(c,r,l,h)>0)for(let _=r;_<l;_+=h)v=pL(_/h|0,c[_],c[_+1],v);else for(let _=l-h;_>=r;_-=h)v=pL(_/h|0,c[_],c[_+1],v);return v&&hg(v,v.next)&&(by(v),v=v.next),v}function lp(c,r){if(!c)return c;r||(r=c);let l,h=c;do if(l=!1,h.steiner||!hg(h,h.next)&&Sa(h.prev,h,h.next)!==0)h=h.next;else{if(by(h),h=r=h.prev,h===h.next)break;l=!0}while(l||h!==r);return r}function _y(c,r,l,h,p,v,_){if(!c)return;!_&&v&&function(T,M,L,z){let F=T;do F.z===0&&(F.z=jT(F.x,F.y,M,L,z)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==T);F.prevZ.nextZ=null,F.prevZ=null,function(G){let W,J=1;do{let oe,le=G;G=null;let he=null;for(W=0;le;){W++;let me=le,be=0;for(let Ae=0;Ae<J&&(be++,me=me.nextZ,me);Ae++);let Ne=J;for(;be>0||Ne>0&&me;)be!==0&&(Ne===0||!me||le.z<=me.z)?(oe=le,le=le.nextZ,be--):(oe=me,me=me.nextZ,Ne--),he?he.nextZ=oe:G=oe,oe.prevZ=he,he=oe;le=me}he.nextZ=null,J*=2}while(W>1)}(F)}(c,h,p,v);let w=c;for(;c.prev!==c.next;){const T=c.prev,M=c.next;if(v?FW(c,h,p,v):kW(c))r.push(T.i,c.i,M.i),by(c),c=M.next,w=M.next;else if((c=M)===w){_?_===1?_y(c=NW(lp(c),r),r,l,h,p,v,2):_===2&&BW(c,r,l,h,p,v):_y(lp(c),r,l,h,p,v,1);break}}}function kW(c){const r=c.prev,l=c,h=c.next;if(Sa(r,l,h)>=0)return!1;const p=r.x,v=l.x,_=h.x,w=r.y,T=l.y,M=h.y,L=Math.min(p,v,_),z=Math.min(w,T,M),F=Math.max(p,v,_),G=Math.max(w,T,M);let W=h.next;for(;W!==r;){if(W.x>=L&&W.x<=F&&W.y>=z&&W.y<=G&&yy(p,w,v,T,_,M,W.x,W.y)&&Sa(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function FW(c,r,l,h){const p=c.prev,v=c,_=c.next;if(Sa(p,v,_)>=0)return!1;const w=p.x,T=v.x,M=_.x,L=p.y,z=v.y,F=_.y,G=Math.min(w,T,M),W=Math.min(L,z,F),J=Math.max(w,T,M),oe=Math.max(L,z,F),le=jT(G,W,r,l,h),he=jT(J,oe,r,l,h);let me=c.prevZ,be=c.nextZ;for(;me&&me.z>=le&&be&&be.z<=he;){if(me.x>=G&&me.x<=J&&me.y>=W&&me.y<=oe&&me!==p&&me!==_&&yy(w,L,T,z,M,F,me.x,me.y)&&Sa(me.prev,me,me.next)>=0||(me=me.prevZ,be.x>=G&&be.x<=J&&be.y>=W&&be.y<=oe&&be!==p&&be!==_&&yy(w,L,T,z,M,F,be.x,be.y)&&Sa(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;me&&me.z>=le;){if(me.x>=G&&me.x<=J&&me.y>=W&&me.y<=oe&&me!==p&&me!==_&&yy(w,L,T,z,M,F,me.x,me.y)&&Sa(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;be&&be.z<=he;){if(be.x>=G&&be.x<=J&&be.y>=W&&be.y<=oe&&be!==p&&be!==_&&yy(w,L,T,z,M,F,be.x,be.y)&&Sa(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function NW(c,r){let l=c;do{const h=l.prev,p=l.next.next;!hg(h,p)&&hL(h,l,l.next,p)&&xy(h,p)&&xy(p,h)&&(r.push(h.i,l.i,p.i),by(l),by(l.next),l=c=p),l=l.next}while(l!==c);return lp(l)}function BW(c,r,l,h,p,v){let _=c;do{let w=_.next.next;for(;w!==_.prev;){if(_.i!==w.i&&HW(_,w)){let T=fL(_,w);return _=lp(_,_.next),T=lp(T,T.next),_y(_,r,l,h,p,v,0),void _y(T,r,l,h,p,v,0)}w=w.next}_=_.next}while(_!==c)}function $W(c,r){let l=c.x-r.x;return l===0&&(l=c.y-r.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(r.next.y-r.y)/(r.next.x-r.x)),l}function jW(c,r){const l=function(p,v){let _=v;const w=p.x,T=p.y;let M,L=-1/0;if(hg(p,_))return _;do{if(hg(p,_.next))return _.next;if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const J=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(J<=w&&J>L&&(L=J,M=_.x<_.next.x?_:_.next,J===w))return M}_=_.next}while(_!==v);if(!M)return null;const z=M,F=M.x,G=M.y;let W=1/0;_=M;do{if(w>=_.x&&_.x>=F&&w!==_.x&&dL(T<G?w:L,T,F,G,T<G?L:w,T,_.x,_.y)){const J=Math.abs(T-_.y)/(w-_.x);xy(_,p)&&(J<W||J===W&&(_.x>M.x||_.x===M.x&&VW(M,_)))&&(M=_,W=J)}_=_.next}while(_!==z);return M}(c,r);if(!l)return r;const h=fL(l,c);return lp(h,h.next),lp(l,l.next)}function VW(c,r){return Sa(c.prev,c,r.prev)<0&&Sa(r.next,c,c.next)<0}function jT(c,r,l,h,p){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*p|0)|c<<8))|c<<4))|c<<2))|c<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-h)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function UW(c){let r=c,l=c;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==c);return l}function dL(c,r,l,h,p,v,_,w){return(p-_)*(r-w)>=(c-_)*(v-w)&&(c-_)*(h-w)>=(l-_)*(r-w)&&(l-_)*(v-w)>=(p-_)*(h-w)}function yy(c,r,l,h,p,v,_,w){return!(c===_&&r===w)&&dL(c,r,l,h,p,v,_,w)}function HW(c,r){return c.next.i!==r.i&&c.prev.i!==r.i&&!function(l,h){let p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==h.i&&p.next.i!==h.i&&hL(p,p.next,l,h))return!0;p=p.next}while(p!==l);return!1}(c,r)&&(xy(c,r)&&xy(r,c)&&function(l,h){let p=l,v=!1;const _=(l.x+h.x)/2,w=(l.y+h.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&_<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==l);return v}(c,r)&&(Sa(c.prev,c,r.prev)||Sa(c,r.prev,r))||hg(c,r)&&Sa(c.prev,c,c.next)>0&&Sa(r.prev,r,r.next)>0)}function Sa(c,r,l){return(r.y-c.y)*(l.x-r.x)-(r.x-c.x)*(l.y-r.y)}function hg(c,r){return c.x===r.x&&c.y===r.y}function hL(c,r,l,h){const p=g1(Sa(c,r,l)),v=g1(Sa(c,r,h)),_=g1(Sa(l,h,c)),w=g1(Sa(l,h,r));return p!==v&&_!==w||!(p!==0||!m1(c,l,r))||!(v!==0||!m1(c,h,r))||!(_!==0||!m1(l,c,h))||!(w!==0||!m1(l,r,h))}function m1(c,r,l){return r.x<=Math.max(c.x,l.x)&&r.x>=Math.min(c.x,l.x)&&r.y<=Math.max(c.y,l.y)&&r.y>=Math.min(c.y,l.y)}function g1(c){return c>0?1:c<0?-1:0}function xy(c,r){return Sa(c.prev,c,c.next)<0?Sa(c,r,c.next)>=0&&Sa(c,c.prev,r)>=0:Sa(c,r,c.prev)<0||Sa(c,c.next,r)<0}function fL(c,r){const l=VT(c.i,c.x,c.y),h=VT(r.i,r.x,r.y),p=c.next,v=r.prev;return c.next=r,r.prev=c,l.next=p,p.prev=l,h.next=l,l.prev=h,v.next=h,h.prev=v,h}function pL(c,r,l,h){const p=VT(c,r,l);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function by(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function VT(c,r,l){return{i:c,x:r,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function wy(c,r){const l=c.length;if(l<=1)return[c];const h=[];let p,v;for(let _=0;_<l;_++){const w=yn(c[_]);w!==0&&(c[_].area=Math.abs(w),v===void 0&&(v=w<0),v===w<0?(p&&h.push(p),p=[c[_]]):p.push(c[_]))}if(p&&h.push(p),r>1)for(let _=0;_<h.length;_++)h[_].length<=r||(Cc(h[_],r,1,h[_].length-1,GW),h[_]=h[_].slice(0,r));return h}function GW(c,r){return r.area-c.area}function mL(c,r,l=1){if(!c)return null;const h=typeof c=="string"?gs.from(c).getPrimary():c.getPrimary(),p=typeof c=="string"?null:c.getSecondary();for(const v of[h,p]){if(!v)continue;const _=v.id.toString();r.has(_)||r.set(_,[]),v.scaleSelf(l),r.get(_).push(v)}return{primary:h.toString(),secondary:p?p.toString():null}}function UT(c,r,l,h){const p=h.patternDependencies;let v=!1;for(const _ of r){const w=_.paint.get(`${c}-pattern`);w.isConstant()||(v=!0),mL(w.constantOr(null),p,l)&&(v=!0)}return v}function HT(c,r,l,h,p,v){const _=v.patternDependencies;for(const w of r){const T=w.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let M=T.evaluate({zoom:h},l,{},v.availableImages);M=M&&M.name?M.name:M;const L=mL(M,_,p);if(!L)continue;const{primary:z,secondary:F}=L;z&&(l.patterns[w.id]=[z,F].filter(Boolean))}}return l}class gL{constructor(){this.polygons=new Map}add(r,...l){const h=this.polygons.get(r);h?h.push(...l):this.polygons.set(r,l)}merge(r){for(const[l,h]of r.polygons)this.add(l,...h)}}class pd{constructor(){this.portals=[]}static isOnBorder(r,l){return r<=0&&l<=0||r>=fn&&l>=fn}static evaluate(r){if(r.length===0)return new pd;let l=[];for(const T of r)l.push(...T.portals);if(l.length===0)return new pd;for(const T of l){const M=T.va,L=T.vb;(pd.isOnBorder(M.x,L.x)||pd.isOnBorder(M.y,L.y))&&(T.type="border")}const h=l.filter(T=>T.type!=="unevaluated"),p=l.filter(T=>T.type==="unevaluated");if(p.length===0)return new pd;p.sort((T,M)=>T.hash===M.hash?T.isTunnel===M.isTunnel?0:T.isTunnel?-1:1:T.hash<M.hash?1:-1),l=h.concat(p);let v=h.length,_=v,w=v;do if(_++,_===l.length||l[v].hash!==l[_].hash){if(_-v==2){w<v&&(l[w]=l[v],l[v]=null);const T=l[w],M=l[_-1];T.type=T.isTunnel!==M.isTunnel?"tunnel":"polygon",T.connection={a:T.connection.a,b:M.connection.a},w++}v=_}while(v!==l.length);return l.splice(w),l.sort((T,M)=>T.hash<M.hash?1:-1),{portals:l}}}Dn(pd,"ElevationPortalGraph"),Dn(gL,"ElevationPolygons");class WW{constructor(r,l,h){this.outPositions=r,this.outNormals=l,this.outIndices=h,this.vertexLookup=new Map}addVertex(r,l,h){let p=r[2];h!=null&&(p*=h);const v=`${r[0]},${r[1]},${r[2]},${l[0]},${l[1]},${l[2]}`,_=this.vertexLookup.get(v);if(_!=null)return _;const w=this.outPositions.length;this.vertexLookup.set(v,w);const T=Math.trunc(16384*l[0]),M=Math.trunc(16384*l[1]),L=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(r[0],r[1],p),this.outNormals.emplaceBack(T,M,L),w}addTriangle(r,l,h){this.outIndices.emplaceBack(r,l,h)}addTriangles(r,l,h){if(r.length===0)return;const p=h.length===1,v=ge(),_=ge();for(let w=0;w<r.length;w+=3){const T=l[r[w+0]],M=l[r[w+1]],L=l[r[w+2]],z=p?h[0]:h[r[w+1]],F=p?h[0]:h[r[w+2]];Te(v,T.x,T.y,p?h[0]:h[r[w+0]]);const G=this.addVertex(v,_);Te(v,M.x,M.y,z);const W=this.addVertex(v,_);Te(v,L.x,L.y,F);const J=this.addVertex(v,_);this.outIndices.emplaceBack(G,W,J)}}addQuad(r,l,h,p,v,_){const w=this.addVertex(r,v,_),T=this.addVertex(l,v,_),M=this.addVertex(h,v,_),L=this.addVertex(p,v,_);this.addTriangle(w,T,M),this.addTriangle(M,L,w)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class el{constructor(r,l,h,p){this.unevaluatedPortals=new pd,this.portalPolygons=new gL,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new J_,this.vertexNormals=new Q_,this.indexArray=new to,this.tileToMeters=Ve(r),this.bridgeProgramConfigurations=new Ll(l,{zoom:h,lut:p},v=>v!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new Ll(l,{zoom:h,lut:p},v=>v!=="fill-bridge-guard-rail-color")}addVertices(r,l){const h=this.unevalVertices.length;for(let p=0;p<r.length;p++)this.unevalVertices.push(r[p]),this.unevalHeights.push(l[p]);return h}addTriangles(r,l,h){const p=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const v of r)p.push(v+l)}addRenderableRing(r,l,h,p,v,_){const w=[new ut(v.min.x,v.min.y),new ut(v.max.x,v.min.y),new ut(v.max.x,v.max.y),new ut(v.min.x,v.max.y)];for(let T=0;T<h-1;T++){const M=l+T,L=M+1,z=this.unevalVertices[M],F=this.unevalVertices[L];if(!(z.x>=v.min.x&&z.x<=v.max.x&&z.y>=v.min.y&&z.y<=v.max.y||F.x>=v.min.x&&F.x<=v.max.x&&F.y>=v.min.y&&F.y<=v.max.y||Ao(z,F,w))||this.isOnBorder(z.x,F.x)||this.isOnBorder(z.y,F.y))continue;const G=el.computeEdgeHash(this.unevalVertices[M],this.unevalVertices[L]);let W,J=this.vertexHashLookup.get(el.computePosHash(z));J!=null?W=J.next:(J=this.vertexHashLookup.get(el.computePosHash(F)),W=J!=null?J.prev:G),this.unevalEdges.push({polygonIdx:r,a:M,b:L,hash:G,portalHash:W,isTunnel:p,type:"unevaluated",featureInfo:_})}}addPortalCandidates(r,l,h,p,v){if(l.length===0)return;this.portalPolygons.add(r,{geometry:l,zLevel:v});const _=l[0];this.vertexHashLookup.clear();let w=el.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let T=0;T<_.length-1;T++){const M=_[T+0],L=_[T+1],z=qn(L.x-M.x,L.y-M.y),F=_r(z);if(F===0)continue;let G="unevaluated";const W=p.pointElevation(M),J=p.pointElevation(L);Math.abs(W)<.01&&Math.abs(J)<.01?G="entrance":(this.isOnBorder(M.x,L.x)||this.isOnBorder(M.y,L.y))&&(G="border");const oe=el.computeEdgeHash(M,L);this.unevaluatedPortals.portals.push({connection:{a:r,b:void 0},va:M,vb:L,vab:z,length:F,hash:oe,isTunnel:h,type:G});const le=el.computePosHash(M);this.vertexHashLookup.set(le,{prev:w,next:oe}),w=oe}}construct(r){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=F=>{F.primitiveLength=this.indexArray.length-F.primitiveOffset},p=new WW(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(r.portals,this.unevalEdges);const v=l(),_=l(),w=l(),T=(F,G)=>{F.sort((J,oe)=>J.type===G&&oe.type!==G?-1:J.type!==G&&oe.type===G?1:0);const W=F.findIndex(J=>J.type!==G);return W>=0?W:F.length};let M=0;this.unevalEdges.length>0&&(M=T(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},this.tileToMeters)),h(w);const L=l(),z=l();if(this.unevalEdges.length>0){const F=this.unevalEdges.splice(M),G=T(F,"tunnel")+M;this.unevalEdges.push(...F),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},{min:M,max:G})}h(L),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(z),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(_),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(v),this.maskSegments=po.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=po.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableBridgeSegments=po.simpleSegment(0,w.primitiveOffset,0,w.primitiveLength),this.renderableTunnelSegments=po.simpleSegment(0,L.primitiveOffset,0,L.primitiveLength),this.shadowCasterSegments=po.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength)}update(r,l,h,p,v,_,w,T){this.bridgeProgramConfigurations.updatePaintArrays(r,l,v,h,p,_,w,T),this.tunnelProgramConfigurations.updatePaintArrays(r,l,v,h,p,_,w,T)}upload(r){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=r.createVertexBuffer(this.vertexPositions,LW.members),this.vertexBufferNormal=r.createVertexBuffer(this.vertexNormals,zW.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(r),this.tunnelProgramConfigurations.upload(r))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(r,l,h,p,v){const _=(w,T)=>{for(let M=0;M<T.length-1;M++){const L=T[M].featureIndex,z=T[M+1].vertexStart,F=r.feature(L);w.populatePaintArrays(z,F,L,{},h,l,p,void 0,v)}};_(this.bridgeProgramConfigurations,this.bridgeFeatureSections),_(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(r,l,h,p,v){const _=new Map;for(let w=p;w<v;w++){const T=h[w],M=T.a,L=T.b,z=el.computePosHash(r[M]),F=el.computePosHash(r[L]);let G=_.get(z);G||(G={},_.set(z,G));let W=_.get(F);W||(W={},_.set(F,W)),l[M]<=0&&l[L]<=0||(G.to=L,W.from=M)}return _}isTerminalVertex(r,l){const h=el.computePosHash(this.unevalVertices[r]),p=l.get(h);return!p||!p.from||!p.to}constructBridgeStructures(r,l,h,p,v,_){r.clearVertexLookup();const w=this.computeVertexConnections(l,h,p,v.min,v.max),T=1/_,M=.5*T,L=(cn,en)=>Te(cn,l[en].x,l[en].y,h[en]*T),z=ge(),F=ge(),G=ge(),W=ge(),J=ge(),oe=(cn,en)=>{const Vt=w.get(el.computePosHash(l[en])),Yt=Vt.from,wt=Vt.to;if(!Yt||!wt)return;L(z,Yt),L(F,en),L(G,wt),Ct(W),tn(z,F)||(Zt(J,F,z),ft(W,J)),tn(G,F)||(Zt(J,G,F),ze(W,W,ft(J,J)));const _t=Cn(W);return _t>0?qe(cn,W,1/_t):void 0};let le=Number.POSITIVE_INFINITY;this.sortSubarray(p,v.min,v.max,(cn,en)=>cn.featureInfo.featureIndex-en.featureInfo.featureIndex);const he=ge(),me=ge(),be=ge(),Ne=ge(),Ae=ge(),He=ge(),Ze=ge(),et=ge(),Tt=ge(),ct=[ge(),ge(),ge(),ge()],At=[ge(),ge(),ge(),ge()],Bt=[{coord:new ut(0,0),height:0},{coord:new ut(0,0),height:0}],qt=(cn,en)=>cn>en;for(let cn=v.min;cn<v.max;cn++){const en=p[cn];if(!en.featureInfo.guardRailEnabled||!this.prepareEdgePoints(Bt,l,h,en,qt))continue;const[Vt,Yt]=Bt;if(Te(he,Vt.coord.x,Vt.coord.y,T*Vt.height),Te(me,Yt.coord.x,Yt.coord.y,T*Yt.height),tn(he,me))continue;Zt(be,me,he),ft(be,be);const wt=oe(et,en.a)||be,_t=oe(Tt,en.b)||be;Te(Ne,wt[1],-wt[0],0),ft(Ne,Ne),Te(Ae,_t[1],-_t[0],0),ft(Ae,Ae),Rt(et,Ne,wt),ft(He,et),Rt(et,Ae,_t),ft(Ze,et),ze(ct[0],he,qe(et,Zt(et,Ne,He),M)),ze(ct[1],he,qe(et,ze(et,Ne,He),M)),ze(ct[2],he,qe(et,He,M)),ct[3]=he,ze(At[0],me,qe(et,Zt(et,Ae,Ze),M)),ze(At[1],me,qe(et,ze(et,Ae,Ze),M)),ze(At[2],me,qe(et,Ze,M)),At[3]=me,le=this.addFeatureSection(en.featureInfo.featureIndex,le,this.bridgeFeatureSections,r);const Xt=r.addVertex(ct[0],Ne,_),sn=r.addVertex(ct[1],Ne,_),Ht=r.addVertex(At[0],Ae,_),An=r.addVertex(At[1],Ae,_);r.addTriangle(Xt,sn,Ht),r.addTriangle(sn,An,Ht);const Bn=r.addVertex(ct[1],He,_),Sn=r.addVertex(ct[2],He,_),vn=r.addVertex(At[1],Ze,_),Cr=r.addVertex(At[2],Ze,_);r.addTriangle(Bn,Sn,vn),r.addTriangle(Sn,Cr,vn),Pt(Ne,Ne),Pt(Ae,Ae);const xn=r.addVertex(ct[2],Ne,_),or=r.addVertex(ct[3],Ne,_),Pr=r.addVertex(At[2],Ae,_),Gr=r.addVertex(At[3],Ae,_);r.addTriangle(xn,or,Pr),r.addTriangle(or,Gr,Pr);const pi=this.isTerminalVertex(en.a,w),Or=this.isTerminalVertex(en.b,w);Vt.height<.01&&pi&&r.addQuad(ct[3],ct[2],ct[1],ct[0],Pt(wt,wt),_),Yt.height<.01&&Or&&r.addQuad(At[0],At[1],At[2],At[3],_t,_)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}constructTunnelStructures(r,l,h,p,v,_){r.clearVertexLookup();let w=Number.POSITIVE_INFINITY;const T=(le,he)=>le.featureInfo.featureIndex-he.featureInfo.featureIndex;this.sortSubarray(p,v.min,v.max,T),this.sortSubarray(p,_.min,_.max,T);const M=le=>ft(le,le),L=[{coord:new ut(0,0),height:0},{coord:new ut(0,0),height:0}],z=(le,he)=>le<he,F=ge(),G=ge(),W=ge(),J=ge(),oe=ge();for(let le=v.min;le<v.max;le++){if(!this.prepareEdgePoints(L,l,h,p[le],z))continue;const[he,me]=L,be=M(Te(oe,-(me.coord.y-he.coord.y),me.coord.x-he.coord.x,0));w=this.addFeatureSection(p[le].featureInfo.featureIndex,w,this.tunnelFeatureSections,r),r.addQuad(Te(F,he.coord.x,he.coord.y,he.height),Te(G,me.coord.x,me.coord.y,me.height),Te(W,me.coord.x,me.coord.y,p[le].isTunnel?-.1:0),Te(J,he.coord.x,he.coord.y,p[le].isTunnel?-.1:0),be)}for(let le=_.min;le<_.max;le++){const he=p[le];he.isTunnel&&([he.a,he.b]=[he.b,he.a]);const me=l[he.a],be=l[he.b],Ne=M(Te(oe,-(be.y-me.y),be.x-me.x,0));w=this.addFeatureSection(he.featureInfo.featureIndex,w,this.tunnelFeatureSections,r),r.addQuad(Te(F,be.x,be.y,0),Te(G,me.x,me.y,0),Te(W,me.x,me.y,h[he.a]+4),Te(J,be.x,be.y,h[he.b]+4),Ne),r.addQuad(Te(F,me.x,me.y,0),Te(G,be.x,be.y,0),Te(W,be.x,be.y,h[he.b]+4),Te(J,me.x,me.y,h[he.a]+4),Ne)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}setElevatedPoint(r,l,h,p){r.coord.x=l,r.coord.y=h,r.height=p}prepareEdgePoints(r,l,h,p,v){let _=l[p.a].x,w=l[p.a].y,T=l[p.b].x,M=l[p.b].y,L=h[p.a],z=h[p.b];const F=v(L,0),G=v(z,0);if(F&&G)return this.setElevatedPoint(r[0],_,w,L),this.setElevatedPoint(r[1],T,M,z),!0;if(!F&&!G)return!1;if(F){if(!G){const W=z/(z-L);T=vr(T,_,W),M=vr(M,w,W),z=vr(z,L,W)}}else{const W=L/(L-z);_=vr(_,T,W),w=vr(w,M,W),L=vr(L,z,W)}return this.setElevatedPoint(r[0],_,w,L),this.setElevatedPoint(r[1],T,M,z),!0}prepareEdges(r,l){if(l.length===0)return;l.sort((w,T)=>w.hash===T.hash?T.polygonIdx-w.polygonIdx:T.hash>w.hash?1:-1);let h=0,p=0,v=0,_=l[h].polygonIdx;do p++,(p===l.length||l[h].hash!==l[p].hash)&&((p-h==1||l[p-1].polygonIdx!==_)&&(v<h&&(l[v]=l[h],l[h]=null),l[v].type="none",v++),h=p,h!==l.length&&(_=l[h].polygonIdx));while(h!==l.length);if(l.splice(v),l.length!==0&&r.length!==0){l.sort((M,L)=>M.portalHash<L.portalHash?1:-1);let w=0,T=0;for(;w!==l.length&&T!==r.length;){const M=l[w],L=r[T];M.portalHash>L.hash?w++:L.hash>M.portalHash?T++:(M.type=L.type,w++)}}}isOnBorder(r,l){return r<=0&&l<=0||r>=fn&&l>=fn}addFeatureSection(r,l,h,p){return r!==l&&(l=r,h.push({featureIndex:r,vertexStart:p.getVertexCount()}),p.clearVertexLookup()),l}sortSubarray(r,l,h,p){const v=r.slice(l,h);v.sort(p),r.splice(l,v.length,...v)}static computeEdgeHash(r,l){return(r.y===l.y&&r.x>l.x||r.y>l.y)&&([r,l]=[l,r]),BigInt(el.computePosHash(r))<<32n|BigInt(el.computePosHash(l))}static computePosHash(r){return((65535&r.x)<<16|65535&r.y)>>>0}}var vL,_L={exports:{}},yL=(vL||(vL=1,function(c,r){(function(l){function h(Oe,Pe){return Oe>Pe?1:Oe<Pe?-1:0}var p=function(Oe,Pe){Oe===void 0&&(Oe=h),Pe===void 0&&(Pe=!1),this._compare=Oe,this._root=null,this._size=0,this._noDuplicates=!!Pe},v={size:{configurable:!0}};function _(Oe,Pe,Ot,gn,Dt){var _n=Dt-gn;if(_n>0){var Wn=gn+Math.floor(_n/2),Gn={key:Pe[Wn],data:Ot[Wn],parent:Oe};return Gn.left=_(Gn,Pe,Ot,gn,Wn),Gn.right=_(Gn,Pe,Ot,Wn+1,Dt),Gn}return null}function w(Oe,Pe,Ot,gn,Dt){if(!(Ot>=gn)){for(var _n=Oe[Ot+gn>>1],Wn=Ot-1,Gn=gn+1;;){do Wn++;while(Dt(Oe[Wn],_n)<0);do Gn--;while(Dt(Oe[Gn],_n)>0);if(Wn>=Gn)break;var Lr=Oe[Wn];Oe[Wn]=Oe[Gn],Oe[Gn]=Lr,Lr=Pe[Wn],Pe[Wn]=Pe[Gn],Pe[Gn]=Lr}w(Oe,Pe,Ot,Gn,Dt),w(Oe,Pe,Gn+1,gn,Dt)}}p.prototype.rotateLeft=function(Oe){var Pe=Oe.right;Pe&&(Oe.right=Pe.left,Pe.left&&(Pe.left.parent=Oe),Pe.parent=Oe.parent),Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Pe:Oe.parent.right=Pe:this._root=Pe,Pe&&(Pe.left=Oe),Oe.parent=Pe},p.prototype.rotateRight=function(Oe){var Pe=Oe.left;Pe&&(Oe.left=Pe.right,Pe.right&&(Pe.right.parent=Oe),Pe.parent=Oe.parent),Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Pe:Oe.parent.right=Pe:this._root=Pe,Pe&&(Pe.right=Oe),Oe.parent=Pe},p.prototype._splay=function(Oe){for(;Oe.parent;){var Pe=Oe.parent;Pe.parent?Pe.left===Oe&&Pe.parent.left===Pe?(this.rotateRight(Pe.parent),this.rotateRight(Pe)):Pe.right===Oe&&Pe.parent.right===Pe?(this.rotateLeft(Pe.parent),this.rotateLeft(Pe)):Pe.left===Oe&&Pe.parent.right===Pe?(this.rotateRight(Pe),this.rotateLeft(Pe)):(this.rotateLeft(Pe),this.rotateRight(Pe)):Pe.left===Oe?this.rotateRight(Pe):this.rotateLeft(Pe)}},p.prototype.splay=function(Oe){for(var Pe,Ot,gn,Dt,_n;Oe.parent;)(Ot=(Pe=Oe.parent).parent)&&Ot.parent?((gn=Ot.parent).left===Ot?gn.left=Oe:gn.right=Oe,Oe.parent=gn):(Oe.parent=null,this._root=Oe),Dt=Oe.left,_n=Oe.right,Oe===Pe.left?(Ot&&(Ot.left===Pe?(Pe.right?(Ot.left=Pe.right,Ot.left.parent=Ot):Ot.left=null,Pe.right=Ot,Ot.parent=Pe):(Dt?(Ot.right=Dt,Dt.parent=Ot):Ot.right=null,Oe.left=Ot,Ot.parent=Oe)),_n?(Pe.left=_n,_n.parent=Pe):Pe.left=null,Oe.right=Pe,Pe.parent=Oe):(Ot&&(Ot.right===Pe?(Pe.left?(Ot.right=Pe.left,Ot.right.parent=Ot):Ot.right=null,Pe.left=Ot,Ot.parent=Pe):(_n?(Ot.left=_n,_n.parent=Ot):Ot.left=null,Oe.right=Ot,Ot.parent=Oe)),Dt?(Pe.right=Dt,Dt.parent=Pe):Pe.right=null,Oe.left=Pe,Pe.parent=Oe)},p.prototype.replace=function(Oe,Pe){Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Pe:Oe.parent.right=Pe:this._root=Pe,Pe&&(Pe.parent=Oe.parent)},p.prototype.minNode=function(Oe){if(Oe===void 0&&(Oe=this._root),Oe)for(;Oe.left;)Oe=Oe.left;return Oe},p.prototype.maxNode=function(Oe){if(Oe===void 0&&(Oe=this._root),Oe)for(;Oe.right;)Oe=Oe.right;return Oe},p.prototype.insert=function(Oe,Pe){var Ot=this._root,gn=null,Dt=this._compare;if(this._noDuplicates)for(;Ot;){if(gn=Ot,Dt(Ot.key,Oe)===0)return;Ot=Dt(Ot.key,Oe)<0?Ot.right:Ot.left}else for(;Ot;)gn=Ot,Ot=Dt(Ot.key,Oe)<0?Ot.right:Ot.left;return Ot={key:Oe,data:Pe,left:null,right:null,parent:gn},gn?Dt(gn.key,Ot.key)<0?gn.right=Ot:gn.left=Ot:this._root=Ot,this.splay(Ot),this._size++,Ot},p.prototype.find=function(Oe){for(var Pe=this._root,Ot=this._compare;Pe;){var gn=Ot(Pe.key,Oe);if(gn<0)Pe=Pe.right;else{if(!(gn>0))return Pe;Pe=Pe.left}}return null},p.prototype.contains=function(Oe){for(var Pe=this._root,Ot=this._compare;Pe;){var gn=Ot(Oe,Pe.key);if(gn===0)return!0;Pe=gn<0?Pe.left:Pe.right}return!1},p.prototype.remove=function(Oe){var Pe=this.find(Oe);if(!Pe)return!1;if(this.splay(Pe),Pe.left)if(Pe.right){var Ot=this.minNode(Pe.right);Ot.parent!==Pe&&(this.replace(Ot,Ot.right),Ot.right=Pe.right,Ot.right.parent=Ot),this.replace(Pe,Ot),Ot.left=Pe.left,Ot.left.parent=Ot}else this.replace(Pe,Pe.left);else this.replace(Pe,Pe.right);return this._size--,!0},p.prototype.removeNode=function(Oe){if(!Oe)return!1;if(this.splay(Oe),Oe.left)if(Oe.right){var Pe=this.minNode(Oe.right);Pe.parent!==Oe&&(this.replace(Pe,Pe.right),Pe.right=Oe.right,Pe.right.parent=Pe),this.replace(Oe,Pe),Pe.left=Oe.left,Pe.left.parent=Pe}else this.replace(Oe,Oe.left);else this.replace(Oe,Oe.right);return this._size--,!0},p.prototype.erase=function(Oe){var Pe=this.find(Oe);if(Pe){this.splay(Pe);var Ot=Pe.left,gn=Pe.right,Dt=null;Ot&&(Ot.parent=null,Dt=this.maxNode(Ot),this.splay(Dt),this._root=Dt),gn&&(Ot?Dt.right=gn:this._root=gn,gn.parent=Dt),this._size--}},p.prototype.pop=function(){var Oe=this._root,Pe=null;if(Oe){for(;Oe.left;)Oe=Oe.left;Pe={key:Oe.key,data:Oe.data},this.remove(Oe.key)}return Pe},p.prototype.next=function(Oe){var Pe=Oe;if(Pe)if(Pe.right)for(Pe=Pe.right;Pe&&Pe.left;)Pe=Pe.left;else for(Pe=Oe.parent;Pe&&Pe.right===Oe;)Oe=Pe,Pe=Pe.parent;return Pe},p.prototype.prev=function(Oe){var Pe=Oe;if(Pe)if(Pe.left)for(Pe=Pe.left;Pe&&Pe.right;)Pe=Pe.right;else for(Pe=Oe.parent;Pe&&Pe.left===Oe;)Oe=Pe,Pe=Pe.parent;return Pe},p.prototype.forEach=function(Oe){for(var Pe=this._root,Ot=[],gn=!1,Dt=0;!gn;)Pe?(Ot.push(Pe),Pe=Pe.left):Ot.length>0?(Oe(Pe=Ot.pop(),Dt++),Pe=Pe.right):gn=!0;return this},p.prototype.range=function(Oe,Pe,Ot,gn){for(var Dt=[],_n=this._compare,Wn=this._root;Dt.length!==0||Wn;)if(Wn)Dt.push(Wn),Wn=Wn.left;else{if(_n((Wn=Dt.pop()).key,Pe)>0)break;if(_n(Wn.key,Oe)>=0&&Ot.call(gn,Wn))return this;Wn=Wn.right}return this},p.prototype.keys=function(){for(var Oe=this._root,Pe=[],Ot=[],gn=!1;!gn;)Oe?(Pe.push(Oe),Oe=Oe.left):Pe.length>0?(Oe=Pe.pop(),Ot.push(Oe.key),Oe=Oe.right):gn=!0;return Ot},p.prototype.values=function(){for(var Oe=this._root,Pe=[],Ot=[],gn=!1;!gn;)Oe?(Pe.push(Oe),Oe=Oe.left):Pe.length>0?(Oe=Pe.pop(),Ot.push(Oe.data),Oe=Oe.right):gn=!0;return Ot},p.prototype.at=function(Oe){for(var Pe=this._root,Ot=[],gn=!1,Dt=0;!gn;)if(Pe)Ot.push(Pe),Pe=Pe.left;else if(Ot.length>0){if(Pe=Ot.pop(),Dt===Oe)return Pe;Dt++,Pe=Pe.right}else gn=!0;return null},p.prototype.load=function(Oe,Pe,Ot){if(Oe===void 0&&(Oe=[]),Pe===void 0&&(Pe=[]),Ot===void 0&&(Ot=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var gn=Oe.length;return Ot&&w(Oe,Pe,0,gn-1,this._compare),this._root=_(null,Oe,Pe,0,gn),this._size=gn,this},p.prototype.min=function(){var Oe=this.minNode(this._root);return Oe?Oe.key:null},p.prototype.max=function(){var Oe=this.maxNode(this._root);return Oe?Oe.key:null},p.prototype.isEmpty=function(){return this._root===null},v.size.get=function(){return this._size},p.createTree=function(Oe,Pe,Ot,gn,Dt){return new p(Ot,Dt).load(Oe,Pe,gn)},Object.defineProperties(p.prototype,v);var T=0,M=1,L=2,z=3,F=0,G=1,W=2,J=3;function oe(Oe,Pe,Ot){Pe===null?(Oe.inOut=!1,Oe.otherInOut=!0):(Oe.isSubject===Pe.isSubject?(Oe.inOut=!Pe.inOut,Oe.otherInOut=Pe.otherInOut):(Oe.inOut=!Pe.otherInOut,Oe.otherInOut=Pe.isVertical()?!Pe.inOut:Pe.inOut),Pe&&(Oe.prevInResult=!le(Pe,Ot)||Pe.isVertical()?Pe.prevInResult:Pe));var gn=le(Oe,Ot);Oe.resultTransition=gn?function(Dt,_n){var Wn,Gn=!Dt.inOut,Lr=!Dt.otherInOut;switch(_n){case F:Wn=Gn&&Lr;break;case G:Wn=Gn||Lr;break;case J:Wn=Gn^Lr;break;case W:Wn=Dt.isSubject?Gn&&!Lr:Lr&&!Gn}return Wn?1:-1}(Oe,Ot):0}function le(Oe,Pe){switch(Oe.type){case T:switch(Pe){case F:return!Oe.otherInOut;case G:return Oe.otherInOut;case W:return Oe.isSubject&&Oe.otherInOut||!Oe.isSubject&&!Oe.otherInOut;case J:return!0}break;case L:return Pe===F||Pe===G;case z:return Pe===W;case M:return!1}return!1}var he=function(Oe,Pe,Ot,gn,Dt){this.left=Pe,this.point=Oe,this.otherEvent=Ot,this.isSubject=gn,this.type=Dt||T,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},me={inResult:{configurable:!0}};function be(Oe,Pe){return Oe[0]===Pe[0]&&Oe[1]===Pe[1]}he.prototype.isBelow=function(Oe){var Pe=this.point,Ot=this.otherEvent.point;return this.left?(Pe[0]-Oe[0])*(Ot[1]-Oe[1])-(Ot[0]-Oe[0])*(Pe[1]-Oe[1])>0:(Ot[0]-Oe[0])*(Pe[1]-Oe[1])-(Pe[0]-Oe[0])*(Ot[1]-Oe[1])>0},he.prototype.isAbove=function(Oe){return!this.isBelow(Oe)},he.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},me.inResult.get=function(){return this.resultTransition!==0},he.prototype.clone=function(){var Oe=new he(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Oe.contourId=this.contourId,Oe.resultTransition=this.resultTransition,Oe.prevInResult=this.prevInResult,Oe.isExteriorRing=this.isExteriorRing,Oe.inOut=this.inOut,Oe.otherInOut=this.otherInOut,Oe},Object.defineProperties(he.prototype,me);var Ne=11102230246251565e-32,Ae=134217729,He=(3+8*Ne)*Ne;function Ze(Oe,Pe,Ot,gn,Dt){var _n,Wn,Gn,Lr,dr=Pe[0],Vn=gn[0],_i=0,Fi=0;Vn>dr==Vn>-dr?(_n=dr,dr=Pe[++_i]):(_n=Vn,Vn=gn[++Fi]);var pr=0;if(_i<Oe&&Fi<Ot)for(Vn>dr==Vn>-dr?(Gn=_n-((Wn=dr+_n)-dr),dr=Pe[++_i]):(Gn=_n-((Wn=Vn+_n)-Vn),Vn=gn[++Fi]),_n=Wn,Gn!==0&&(Dt[pr++]=Gn);_i<Oe&&Fi<Ot;)Vn>dr==Vn>-dr?(Gn=_n-((Wn=_n+dr)-(Lr=Wn-_n))+(dr-Lr),dr=Pe[++_i]):(Gn=_n-((Wn=_n+Vn)-(Lr=Wn-_n))+(Vn-Lr),Vn=gn[++Fi]),_n=Wn,Gn!==0&&(Dt[pr++]=Gn);for(;_i<Oe;)Gn=_n-((Wn=_n+dr)-(Lr=Wn-_n))+(dr-Lr),dr=Pe[++_i],_n=Wn,Gn!==0&&(Dt[pr++]=Gn);for(;Fi<Ot;)Gn=_n-((Wn=_n+Vn)-(Lr=Wn-_n))+(Vn-Lr),Vn=gn[++Fi],_n=Wn,Gn!==0&&(Dt[pr++]=Gn);return _n===0&&pr!==0||(Dt[pr++]=_n),pr}function et(Oe){return new Float64Array(Oe)}var Tt=33306690738754716e-32,ct=22204460492503146e-32,At=11093356479670487e-47,Bt=et(4),qt=et(8),cn=et(12),en=et(16),Vt=et(4);function Yt(Oe,Pe,Ot){var gn=function(Dt,_n,Wn,Gn,Lr,dr){var Vn=(_n-dr)*(Wn-Lr),_i=(Dt-Lr)*(Gn-dr),Fi=Vn-_i;if(Vn===0||_i===0||Vn>0!=_i>0)return Fi;var pr=Math.abs(Vn+_i);return Math.abs(Fi)>=Tt*pr?Fi:-function(hi,Ni,Ri,_o,Zi,Hi,Di){var Si,zr,Ci,Gi,hr,mi,Yi,To,ko,na,Ji,Xo,Is,Zo,nl,Wa,kl,Ps,rl=hi-Zi,qa=Ri-Zi,il=Ni-Hi,Fl=_o-Hi;Bt[0]=(nl=(To=rl-(Yi=(mi=Ae*rl)-(mi-rl)))*(na=Fl-(ko=(mi=Ae*Fl)-(mi-Fl)))-((Zo=rl*Fl)-Yi*ko-To*ko-Yi*na))-((Ji=nl-(kl=(To=il-(Yi=(mi=Ae*il)-(mi-il)))*(na=qa-(ko=(mi=Ae*qa)-(mi-qa)))-((Wa=il*qa)-Yi*ko-To*ko-Yi*na)))+(hr=nl-Ji))+(hr-kl),Bt[1]=(Is=Zo-((Xo=Zo+Ji)-(hr=Xo-Zo))+(Ji-hr))-((Ji=Is-Wa)+(hr=Is-Ji))+(hr-Wa),Bt[2]=Xo-((Ps=Xo+Ji)-(hr=Ps-Xo))+(Ji-hr),Bt[3]=Ps;var Oa=function(Rh,bu){for(var ow=bu[0],Ag=1;Ag<4;Ag++)ow+=bu[Ag];return ow}(0,Bt),cs=ct*Di;if(Oa>=cs||-Oa>=cs||(Si=hi-(rl+(hr=hi-rl))+(hr-Zi),Ci=Ri-(qa+(hr=Ri-qa))+(hr-Zi),zr=Ni-(il+(hr=Ni-il))+(hr-Hi),Gi=_o-(Fl+(hr=_o-Fl))+(hr-Hi),Si===0&&zr===0&&Ci===0&&Gi===0)||(cs=At*Di+He*Math.abs(Oa),(Oa+=rl*Gi+Fl*Si-(il*Ci+qa*zr))>=cs||-Oa>=cs))return Oa;Vt[0]=(nl=(To=Si-(Yi=(mi=Ae*Si)-(mi-Si)))*(na=Fl-(ko=(mi=Ae*Fl)-(mi-Fl)))-((Zo=Si*Fl)-Yi*ko-To*ko-Yi*na))-((Ji=nl-(kl=(To=zr-(Yi=(mi=Ae*zr)-(mi-zr)))*(na=qa-(ko=(mi=Ae*qa)-(mi-qa)))-((Wa=zr*qa)-Yi*ko-To*ko-Yi*na)))+(hr=nl-Ji))+(hr-kl),Vt[1]=(Is=Zo-((Xo=Zo+Ji)-(hr=Xo-Zo))+(Ji-hr))-((Ji=Is-Wa)+(hr=Is-Ji))+(hr-Wa),Vt[2]=Xo-((Ps=Xo+Ji)-(hr=Ps-Xo))+(Ji-hr),Vt[3]=Ps;var xu=Ze(4,Bt,4,Vt,qt);Vt[0]=(nl=(To=rl-(Yi=(mi=Ae*rl)-(mi-rl)))*(na=Gi-(ko=(mi=Ae*Gi)-(mi-Gi)))-((Zo=rl*Gi)-Yi*ko-To*ko-Yi*na))-((Ji=nl-(kl=(To=il-(Yi=(mi=Ae*il)-(mi-il)))*(na=Ci-(ko=(mi=Ae*Ci)-(mi-Ci)))-((Wa=il*Ci)-Yi*ko-To*ko-Yi*na)))+(hr=nl-Ji))+(hr-kl),Vt[1]=(Is=Zo-((Xo=Zo+Ji)-(hr=Xo-Zo))+(Ji-hr))-((Ji=Is-Wa)+(hr=Is-Ji))+(hr-Wa),Vt[2]=Xo-((Ps=Xo+Ji)-(hr=Ps-Xo))+(Ji-hr),Vt[3]=Ps;var Mh=Ze(xu,qt,4,Vt,cn);Vt[0]=(nl=(To=Si-(Yi=(mi=Ae*Si)-(mi-Si)))*(na=Gi-(ko=(mi=Ae*Gi)-(mi-Gi)))-((Zo=Si*Gi)-Yi*ko-To*ko-Yi*na))-((Ji=nl-(kl=(To=zr-(Yi=(mi=Ae*zr)-(mi-zr)))*(na=Ci-(ko=(mi=Ae*Ci)-(mi-Ci)))-((Wa=zr*Ci)-Yi*ko-To*ko-Yi*na)))+(hr=nl-Ji))+(hr-kl),Vt[1]=(Is=Zo-((Xo=Zo+Ji)-(hr=Xo-Zo))+(Ji-hr))-((Ji=Is-Wa)+(hr=Is-Ji))+(hr-Wa),Vt[2]=Xo-((Ps=Xo+Ji)-(hr=Ps-Xo))+(Ji-hr),Vt[3]=Ps;var Rg=Ze(Mh,cn,4,Vt,en);return en[Rg-1]}(Dt,_n,Wn,Gn,Lr,dr,pr)}(Oe[0],Oe[1],Pe[0],Pe[1],Ot[0],Ot[1]);return gn>0?-1:gn<0?1:0}function wt(Oe,Pe){var Ot=Oe.point,gn=Pe.point;return Ot[0]>gn[0]?1:Ot[0]<gn[0]?-1:Ot[1]!==gn[1]?Ot[1]>gn[1]?1:-1:function(Dt,_n,Wn,Gn){return Dt.left!==_n.left?Dt.left?1:-1:Yt(Wn,Dt.otherEvent.point,_n.otherEvent.point)!==0?Dt.isBelow(_n.otherEvent.point)?-1:1:!Dt.isSubject&&_n.isSubject?1:-1}(Oe,Pe,Ot)}function _t(Oe,Pe,Ot){var gn=new he(Pe,!1,Oe,Oe.isSubject),Dt=new he(Pe,!0,Oe.otherEvent,Oe.isSubject);return be(Oe.point,Oe.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Oe),gn.contourId=Dt.contourId=Oe.contourId,wt(Dt,Oe.otherEvent)>0&&(Oe.otherEvent.left=!0,Dt.left=!1),Oe.otherEvent.otherEvent=Dt,Oe.otherEvent=gn,Ot.push(Dt),Ot.push(gn),Ot}function Xt(Oe,Pe){return Oe[0]*Pe[1]-Oe[1]*Pe[0]}function sn(Oe,Pe){return Oe[0]*Pe[0]+Oe[1]*Pe[1]}function Ht(Oe,Pe,Ot){var gn=function(Lr,dr,Vn,_i,Fi){var pr=[dr[0]-Lr[0],dr[1]-Lr[1]],hi=[_i[0]-Vn[0],_i[1]-Vn[1]];function Ni(mi,Yi,To){return[mi[0]+Yi*To[0],mi[1]+Yi*To[1]]}var Ri=[Vn[0]-Lr[0],Vn[1]-Lr[1]],_o=Xt(pr,hi),Zi=_o*_o,Hi=sn(pr,pr);if(Zi>0){var Di=Xt(Ri,hi)/_o;if(Di<0||Di>1)return null;var Si=Xt(Ri,pr)/_o;return Si<0||Si>1?null:Di===0||Di===1?[Ni(Lr,Di,pr)]:Si===0||Si===1?[Ni(Vn,Si,hi)]:[Ni(Lr,Di,pr)]}if((Zi=(_o=Xt(Ri,pr))*_o)>0)return null;var zr=sn(pr,Ri)/Hi,Ci=zr+sn(pr,hi)/Hi,Gi=Math.min(zr,Ci),hr=Math.max(zr,Ci);return Gi<=1&&hr>=0?Gi===1?[Ni(Lr,Gi>0?Gi:0,pr)]:hr===0?[Ni(Lr,hr<1?hr:1,pr)]:[Ni(Lr,Gi>0?Gi:0,pr),Ni(Lr,hr<1?hr:1,pr)]:null}(Oe.point,Oe.otherEvent.point,Pe.point,Pe.otherEvent.point),Dt=gn?gn.length:0;if(Dt===0||Dt===1&&(be(Oe.point,Pe.point)||be(Oe.otherEvent.point,Pe.otherEvent.point))||Dt===2&&Oe.isSubject===Pe.isSubject)return 0;if(Dt===1)return be(Oe.point,gn[0])||be(Oe.otherEvent.point,gn[0])||_t(Oe,gn[0],Ot),be(Pe.point,gn[0])||be(Pe.otherEvent.point,gn[0])||_t(Pe,gn[0],Ot),1;var _n=[],Wn=!1,Gn=!1;return be(Oe.point,Pe.point)?Wn=!0:wt(Oe,Pe)===1?_n.push(Pe,Oe):_n.push(Oe,Pe),be(Oe.otherEvent.point,Pe.otherEvent.point)?Gn=!0:wt(Oe.otherEvent,Pe.otherEvent)===1?_n.push(Pe.otherEvent,Oe.otherEvent):_n.push(Oe.otherEvent,Pe.otherEvent),Wn&&Gn||Wn?(Pe.type=M,Oe.type=Pe.inOut===Oe.inOut?L:z,Wn&&!Gn&&_t(_n[1].otherEvent,_n[0].point,Ot),2):Gn?(_t(_n[0],_n[1].point,Ot),3):_n[0]!==_n[3].otherEvent?(_t(_n[0],_n[1].point,Ot),_t(_n[1],_n[2].point,Ot),3):(_t(_n[0],_n[1].point,Ot),_t(_n[3].otherEvent,_n[2].point,Ot),3)}function An(Oe,Pe){if(Oe===Pe)return 0;if(Yt(Oe.point,Oe.otherEvent.point,Pe.point)!==0||Yt(Oe.point,Oe.otherEvent.point,Pe.otherEvent.point)!==0)return be(Oe.point,Pe.point)?Oe.isBelow(Pe.otherEvent.point)?-1:1:Oe.point[0]===Pe.point[0]?Oe.point[1]<Pe.point[1]?-1:1:wt(Oe,Pe)===1?Pe.isAbove(Oe.point)?-1:1:Oe.isBelow(Pe.point)?-1:1;if(Oe.isSubject!==Pe.isSubject)return Oe.isSubject?-1:1;var Ot=Oe.point,gn=Pe.point;return Ot[0]===gn[0]&&Ot[1]===gn[1]?(Ot=Oe.otherEvent.point)[0]===(gn=Pe.otherEvent.point)[0]&&Ot[1]===gn[1]?0:Oe.contourId>Pe.contourId?1:-1:wt(Oe,Pe)===1?1:-1}var Bn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Sn(Oe,Pe,Ot,gn){var Dt,_n=Oe+1,Wn=Pe[Oe].point,Gn=Pe.length;for(_n<Gn&&(Dt=Pe[_n].point);_n<Gn&&Dt[0]===Wn[0]&&Dt[1]===Wn[1];){if(!Ot[_n])return _n;++_n<Gn&&(Dt=Pe[_n].point)}for(_n=Oe-1;Ot[_n]&&_n>gn;)_n--;return _n}Bn.prototype.isExterior=function(){return this.holeOf==null};var vn=xn,Cr=xn;function xn(Oe,Pe){if(!(this instanceof xn))return new xn(Oe,Pe);if(this.data=Oe||[],this.length=this.data.length,this.compare=Pe||or,this.length>0)for(var Ot=(this.length>>1)-1;Ot>=0;Ot--)this._down(Ot)}function or(Oe,Pe){return Oe<Pe?-1:Oe>Pe?1:0}xn.prototype={push:function(Oe){this.data.push(Oe),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Oe=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Oe}},peek:function(){return this.data[0]},_up:function(Oe){for(var Pe=this.data,Ot=this.compare,gn=Pe[Oe];Oe>0;){var Dt=Oe-1>>1,_n=Pe[Dt];if(Ot(gn,_n)>=0)break;Pe[Oe]=_n,Oe=Dt}Pe[Oe]=gn},_down:function(Oe){for(var Pe=this.data,Ot=this.compare,gn=this.length>>1,Dt=Pe[Oe];Oe<gn;){var _n=1+(Oe<<1),Wn=_n+1,Gn=Pe[_n];if(Wn<this.length&&Ot(Pe[Wn],Gn)<0&&(_n=Wn,Gn=Pe[Wn]),Ot(Gn,Dt)>=0)break;Pe[Oe]=Gn,Oe=_n}Pe[Oe]=Dt}},vn.default=Cr;var Pr=Math.max,Gr=Math.min,pi=0;function Or(Oe,Pe,Ot,gn,Dt,_n){var Wn,Gn,Lr,dr,Vn,_i;for(Wn=0,Gn=Oe.length-1;Wn<Gn;Wn++)if(dr=Oe[Wn+1],Vn=new he(Lr=Oe[Wn],!1,void 0,Pe),_i=new he(dr,!1,Vn,Pe),Vn.otherEvent=_i,Lr[0]!==dr[0]||Lr[1]!==dr[1]){Vn.contourId=_i.contourId=Ot,_n||(Vn.isExteriorRing=!1,_i.isExteriorRing=!1),wt(Vn,_i)>0?_i.left=!0:Vn.left=!0;var Fi=Lr[0],pr=Lr[1];Dt[0]=Gr(Dt[0],Fi),Dt[1]=Gr(Dt[1],pr),Dt[2]=Pr(Dt[2],Fi),Dt[3]=Pr(Dt[3],pr),gn.push(Vn),gn.push(_i)}}var bi=[];function wi(Oe,Pe,Ot){typeof Oe[0][0][0]=="number"&&(Oe=[Oe]),typeof Pe[0][0][0]=="number"&&(Pe=[Pe]);var gn=function(pr,hi,Ni){var Ri=null;return pr.length*hi.length==0&&(Ni===F?Ri=bi:Ni===W?Ri=pr:Ni!==G&&Ni!==J||(Ri=pr.length===0?hi:pr)),Ri}(Oe,Pe,Ot);if(gn)return gn===bi?null:gn;var Dt=[1/0,1/0,-1/0,-1/0],_n=[1/0,1/0,-1/0,-1/0],Wn=function(pr,hi,Ni,Ri,_o){var Zi,Hi,Di,Si,zr,Ci,Gi=new vn(null,wt);for(Di=0,Si=pr.length;Di<Si;Di++)for(zr=0,Ci=(Zi=pr[Di]).length;zr<Ci;zr++)(Hi=zr===0)&&pi++,Or(Zi[zr],!0,pi,Gi,Ni,Hi);for(Di=0,Si=hi.length;Di<Si;Di++)for(zr=0,Ci=(Zi=hi[Di]).length;zr<Ci;zr++)Hi=zr===0,_o===W&&(Hi=!1),Hi&&pi++,Or(Zi[zr],!1,pi,Gi,Ri,Hi);return Gi}(Oe,Pe,Dt,_n,Ot);if(gn=function(pr,hi,Ni,Ri,_o){var Zi=null;return(Ni[0]>Ri[2]||Ri[0]>Ni[2]||Ni[1]>Ri[3]||Ri[1]>Ni[3])&&(_o===F?Zi=bi:_o===W?Zi=pr:_o!==G&&_o!==J||(Zi=pr.concat(hi))),Zi}(Oe,Pe,Dt,_n,Ot))return gn===bi?null:gn;for(var Gn=function(pr){var hi,Ni,Ri=function(Di){var Si,zr,Ci,Gi,hr=[];for(zr=0,Ci=Di.length;zr<Ci;zr++)((Si=Di[zr]).left&&Si.inResult||!Si.left&&Si.otherEvent.inResult)&&hr.push(Si);for(var mi=!1;!mi;)for(mi=!0,zr=0,Ci=hr.length;zr<Ci;zr++)zr+1<Ci&&wt(hr[zr],hr[zr+1])===1&&(Gi=hr[zr],hr[zr]=hr[zr+1],hr[zr+1]=Gi,mi=!1);for(zr=0,Ci=hr.length;zr<Ci;zr++)(Si=hr[zr]).otherPos=zr;for(zr=0,Ci=hr.length;zr<Ci;zr++)(Si=hr[zr]).left||(Gi=Si.otherPos,Si.otherPos=Si.otherEvent.otherPos,Si.otherEvent.otherPos=Gi);return hr}(pr),_o={},Zi=[],Hi=function(){if(!_o[hi]){var Di=Zi.length,Si=function(hr,mi,Yi){var To=new Bn;if(hr.prevInResult!=null){var ko=hr.prevInResult,na=ko.outputContourId;if(ko.resultTransition>0){var Ji=mi[na];if(Ji.holeOf!=null){var Xo=Ji.holeOf;mi[Xo].holeIds.push(Yi),To.holeOf=Xo,To.depth=mi[na].depth}else mi[na].holeIds.push(Yi),To.holeOf=na,To.depth=mi[na].depth+1}else To.holeOf=null,To.depth=mi[na].depth}else To.holeOf=null,To.depth=0;return To}(Ri[hi],Zi,Di),zr=function(hr){_o[hr]=!0,hr<Ri.length&&Ri[hr]&&(Ri[hr].outputContourId=Di)},Ci=hi,Gi=hi;for(Si.points.push(Ri[hi].point);zr(Ci),zr(Ci=Ri[Ci].otherPos),Si.points.push(Ri[Ci].point),!((Ci=Sn(Ci,Ri,_o,Gi))==Gi||Ci>=Ri.length)&&Ri[Ci];);Zi.push(Si)}};for(hi=0,Ni=Ri.length;hi<Ni;hi++)Hi();return Zi}(function(pr,hi,Ni,Ri,_o,Zi){for(var Hi,Di,Si,zr=new p(An),Ci=[],Gi=Math.min(Ri[2],_o[2]);pr.length!==0;){var hr=pr.pop();if(Ci.push(hr),Zi===F&&hr.point[0]>Gi||Zi===W&&hr.point[0]>Ri[2])break;if(hr.left){Di=Hi=zr.insert(hr),Hi=Hi!==(Si=zr.minNode())?zr.prev(Hi):null,Di=zr.next(Di);var mi=Hi?Hi.key:null;if(oe(hr,mi,Zi),Di&&Ht(hr,Di.key,pr)===2&&(oe(hr,mi,Zi),oe(Di.key,hr,Zi)),Hi&&Ht(Hi.key,hr,pr)===2){var Yi=Hi;oe(mi,(Yi=Yi!==Si?zr.prev(Yi):null)?Yi.key:null,Zi),oe(hr,mi,Zi)}}else Di=Hi=zr.find(hr=hr.otherEvent),Hi&&Di&&(Hi=Hi!==Si?zr.prev(Hi):null,Di=zr.next(Di),zr.remove(hr),Di&&Hi&&Ht(Hi.key,Di.key,pr))}return Ci}(Wn,0,0,Dt,_n,Ot)),Lr=[],dr=0;dr<Gn.length;dr++){var Vn=Gn[dr];if(Vn.isExterior()){for(var _i=[Vn.points],Fi=0;Fi<Vn.holeIds.length;Fi++)_i.push(Gn[Vn.holeIds[Fi]].points);Lr.push(_i)}}return Lr}var so={UNION:G,DIFFERENCE:W,INTERSECTION:F,XOR:J};l.diff=function(Oe,Pe){return wi(Oe,Pe,W)},l.intersection=function(Oe,Pe){return wi(Oe,Pe,F)},l.operations=so,l.union=function(Oe,Pe){return wi(Oe,Pe,G)},l.xor=function(Oe,Pe){return wi(Oe,Pe,J)},Object.defineProperty(l,"__esModule",{value:!0})})(r)}(0,_L.exports)),_L.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function v1(c,r,l,h){const p=[],v=h===0?(_,w,T,M,L,z)=>{_.push(new ut(z,T+(z-w)/(M-w)*(L-T)))}:(_,w,T,M,L,z)=>{_.push(new ut(w+(z-T)/(L-T)*(M-w),z))};for(const _ of c){const w=[];for(const T of _){if(T.length<=2)continue;const M=[];for(let F=0;F<T.length-1;F++){const G=T[F].x,W=T[F].y,J=T[F+1].x,oe=T[F+1].y,le=h===0?G:W,he=h===0?J:oe;le<r?he>r&&v(M,G,W,J,oe,r):le>l?he<l&&v(M,G,W,J,oe,l):M.push(T[F]),he<r&&le>=r&&v(M,G,W,J,oe,r),he>l&&le<=l&&v(M,G,W,J,oe,l)}let L=T[T.length-1];const z=h===0?L.x:L.y;z>=r&&z<=l&&M.push(L),M.length&&(L=M[M.length-1],M[0].x===L.x&&M[0].y===L.y||M.push(M[0]),w.push(M))}w.length&&p.push(w)}return p}function qW(c,r){const l=GT(c),h=GT([r]),p=yL.intersection(l,h);return p==null?[]:xL(p)}function KW(c,r){let h=GT(c,65536);const p=[];for(;r.valid();r.next()){const[v,_]=r.get(),w=v.x*65536,T=v.y*65536,M=_.x*65536,L=_.y*65536,z=M-w,F=L-T,G=Math.hypot(z,F);if(G===0)continue;const W=Math.trunc(F/G*3),J=-Math.trunc(z/G*3);p.push([[[w,T],[M,L],[M+W,L+J],[w+W,T+J],[w,T]]])}return p.length>0&&(h=yL.diff(h,p)),xL(h,1/65536)}function GT(c,r=1){return[c.map(l=>l.map(h=>[h.x*r,h.y*r]))]}function xL(c,r=1){return c.map(l=>l.map((h,p)=>{const v=h.map(_=>new ut(_[0]*r,_[1]*r).round());return p>0&&v.reverse(),v}))}class WT{constructor(r,l){this.layoutVertexArray=new vs,this.indexArray=new to,this.lineIndexArray=new yl,this.triangleSegments=new po,this.lineSegments=new po,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new Pc)}update(r,l,h,p,v,_,w,T){this.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,OW.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.lineIndexBuffer=r.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,DW.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(r,l,h,p,v,_,w){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,h,p,v,_,void 0,w)}}class qT{constructor(r){this.zoom=r.zoom,this.pixelRatio=r.pixelRatio,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=r.lut,this.bufferData=new WT(r,!1),this.elevationBufferData=new WT(r,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=r.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=r.sourceLayerIndex,this.worldview=r.worldview,this.hasAppearances=null}updateFootprints(r,l){}updateAppearances(r,l,h,p){}populate(r,l,h,p){this.hasPattern=UT("fill",this.layers,this.pixelRatio,l);const v=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:w,id:T,index:M,sourceLayerIndex:L}of r){const z=this.layers[0]._featureFilter.needGeometry,F=gt(w,z);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),F,h))continue;const G=v?v.evaluate(F,{},h,l.availableImages):void 0,W={id:T,properties:w.properties,type:w.type,sourceLayerIndex:L,index:M,geometry:z?F.geometry:kt(w,h,p),patterns:{},sortKey:G};_.push(W)}v&&_.sort((w,T)=>w.sortKey-T.sortKey);for(const w of _){const{geometry:T,index:M,sourceLayerIndex:L}=w;if(this.hasPattern){const z=HT("fill",this.layers,w,this.zoom,this.pixelRatio,l);this.patternFeatures.push(z)}else this.addFeature(w,T,M,h,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(r[M].feature,T,M,L,this.index)}}update(r,l,h,p,v,_,w){this.bufferData.update(r,l,h,p,v,_,w,this.worldview),this.elevationBufferData.update(r,l,h,p,v,_,w,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(r,l,h,p,v,_,w,this.worldview)}addFeatures(r,l,h,p,v,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,l,h,p,_,r.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(r){this.bufferData.upload(r),this.elevationBufferData.upload(r),this.elevatedStructures&&this.elevatedStructures.upload(r)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(r,l,h,p,v,_=[],w,T){const M=wy(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(r,M,p,h,T):this.addGeometry(M,this.bufferData),this.bufferData.populatePaintArrays(r,h,v,_,p,w,this.worldview),this.elevationBufferData.populatePaintArrays(r,h,v,_,p,w,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(r,l,h,p,v){this.elevatedStructures&&(this.elevatedStructures.construct(r),this.elevatedStructures.populatePaintArrays(l,h,p,v,this.worldview))}addElevatedRoadFeature(r,l,h,p,v){const _=new Array,w=Sr.getElevationFeature(r,v);if(!w)return void this.addGeometry(l,this.bufferData);{const M=this.clipPolygonsToTile(l,1);M.length>0&&_.push({polygons:M,elevationFeature:w,elevationTileID:h})}const T={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(r,{},h),featureIndex:p};for(const M of _)if(M.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new el(M.elevationTileID,this.layers,this.zoom,this.lut));const z=M.elevationFeature.isTunnel();let F=0;r.properties.hasOwnProperty(Rn)&&(F=+r.properties[Rn]);for(const G of M.polygons)this.elevatedStructures.addPortalCandidates(M.elevationFeature.id,G,z,M.elevationFeature,F)}M.elevationFeature.constantHeight==null&&(M.polygons=this.prepareElevatedPolygons(M.polygons,M.elevationFeature,M.elevationTileID));const L=new fi(h,M.elevationTileID);this.addElevatedGeometry(M.polygons,L,M.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p,T)}}addElevatedGeometry(r,l,h,p,v,_){const w={elevation:h,elevationSampler:l,bias:p,index:v,featureInfo:_},[T,M]=this.addGeometry(r,this.elevationBufferData,w);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:M}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,M))}addGeometry(r,l,h){let p=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,_=null;h&&(_=h.elevationSampler.constantElevation(h.elevation,h.bias),_!=null&&(p=_,v=_));const w=(T,M,L)=>{if(h!=null)if(M.push(T),_!=null)l.elevatedLayoutVertexArray.emplaceBack(_),L.push(_);else{const z=h.elevationSampler.pointElevation(T,h.elevation,h.bias);l.elevatedLayoutVertexArray.emplaceBack(z),L.push(z),p=Math.min(p,z),v=Math.max(v,z)}};for(const T of r){let M=0;for(const me of T)M+=me.length;const L=l.triangleSegments.prepareSegment(M,l.layoutVertexArray,l.indexArray),z=L.vertexLength,F=[],G=[],W=[],J=[],oe=[],le=l.layoutVertexArray.length;for(const me of T){if(me.length===0)continue;me!==T[0]&&G.push(F.length/2);const be=l.lineSegments.prepareSegment(me.length,l.layoutVertexArray,l.lineIndexArray),Ne=be.vertexLength;h&&oe.push(l.layoutVertexArray.length-le),w(me[0],W,J),l.layoutVertexArray.emplaceBack(me[0].x,me[0].y),l.lineIndexArray.emplaceBack(Ne+me.length-1,Ne),F.push(me[0].x),F.push(me[0].y);for(let Ae=1;Ae<me.length;Ae++)w(me[Ae],W,J),l.layoutVertexArray.emplaceBack(me[Ae].x,me[Ae].y),l.lineIndexArray.emplaceBack(Ne+Ae-1,Ne+Ae),F.push(me[Ae].x),F.push(me[Ae].y);be.vertexLength+=me.length,be.primitiveLength+=me.length}const he=dg(F,G);for(let me=0;me<he.length;me+=3)l.indexArray.emplaceBack(z+he[me],z+he[me+1],z+he[me+2]);if(he.length>0&&h&&this.elevationMode==="hd-road-base"){const me=h.elevation.isTunnel(),be=h.elevation.safeArea,Ne=this.elevatedStructures.addVertices(W,J);this.elevatedStructures.addTriangles(he,Ne,me);const Ae=oe.length;if(Ae>0){for(let He=0;He<Ae-1;He++)this.elevatedStructures.addRenderableRing(h.index,oe[He]+Ne,oe[He+1]-oe[He],me,be,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,oe[Ae-1]+Ne,W.length-oe[Ae-1],me,be,h.featureInfo)}}L.vertexLength+=M,L.primitiveLength+=he.length/3}return[p,v]}prepareElevatedPolygons(r,l,h){const p=1/Ve(h),v=[];for(const _ of r){const w=KW(_,new Ki(l,p));v.push(...w)}return v}clipPolygonsToTile(r,l){const h=-l,p=-l,v=fn+l,_=fn+l;let w=0;const T=[],M=[];for(;w<r.length;w++){const F=r[w],G=Bf(F);(G.min.x>=h&&G.max.x<=v&&G.min.y>=p&&G.max.y<=_?T:M).push(F)}if(T.length===r.length)return r;const L=[new ut(h,p),new ut(v,p),new ut(v,_),new ut(h,_),new ut(h,p)],z=T;for(const F of M)z.push(...qW(F,L));return z}}let bL,wL,SL,CL;Dn(qT,"FillBucket",{omit:["layers","patternFeatures"]}),Dn(WT,"FillBufferData"),Dn(el,"ElevatedStructures");class _1{constructor(r,l,h,p){if(this.triangleCount=l.length/3,this.min=new ut(0,0),this.max=new ut(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||r.length===0)return;const[v,_]=[r[0].clone(),r[0].clone()];for(let z=1;z<r.length;++z){const F=r[z];v.x=Math.min(v.x,F.x),v.y=Math.min(v.y,F.y),_.x=Math.max(_.x,F.x),_.y=Math.max(_.y,F.y)}if(p){const z=Math.ceil(Math.max(_.x-v.x,_.y-v.y)/p);h=Math.max(h,z)}if(h===0)return;this.min=v,this.max=_;const w=this.max.sub(this.min);w.x=Math.max(w.x,1),w.y=Math.max(w.y,1);const T=Math.max(w.x,w.y)/h;this.cellsX=Math.max(1,Math.ceil(w.x/T)),this.cellsY=Math.max(1,Math.ceil(w.y/T)),this.xScale=1/T,this.yScale=1/T;const M=[];for(let z=0;z<this.triangleCount;z++){const F=r[l[3*z+0]].sub(this.min),G=r[l[3*z+1]].sub(this.min),W=r[l[3*z+2]].sub(this.min),J=_u(Math.floor(Math.min(F.x,G.x,W.x)),this.xScale,this.cellsX),oe=_u(Math.floor(Math.max(F.x,G.x,W.x)),this.xScale,this.cellsX),le=_u(Math.floor(Math.min(F.y,G.y,W.y)),this.yScale,this.cellsY),he=_u(Math.floor(Math.max(F.y,G.y,W.y)),this.yScale,this.cellsY),me=new ut(0,0),be=new ut(0,0),Ne=new ut(0,0),Ae=new ut(0,0);for(let He=le;He<=he;++He){me.y=be.y=He*T,Ne.y=Ae.y=(He+1)*T;for(let Ze=J;Ze<=oe;++Ze)me.x=Ne.x=Ze*T,be.x=Ae.x=(Ze+1)*T,(zo(F,G,W,me,be,Ae)||zo(F,G,W,me,Ae,Ne))&&M.push({cellIdx:He*this.cellsX+Ze,triIdx:z})}}if(M.length===0)return;M.sort((z,F)=>z.cellIdx-F.cellIdx||z.triIdx-F.triIdx);let L=0;for(;L<M.length;){const z=M[L].cellIdx,F={start:this.payload.length,len:0};for(;L<M.length&&M[L].cellIdx===z;)++F.len,this.payload.push(M[L++].triIdx);this.cells[z]=F}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(r,l){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>r.x||r.y>this.max.y||this.min.y>r.y)return;const h=_u(r.x-this.min.x,this.xScale,this.cellsX),p=_u(r.y-this.min.y,this.yScale,this.cellsY),v=this.cells[p*this.cellsX+h];if(v){this._lazyInitLookup();for(let _=0;_<v.len;_++){const w=this.payload[v.start+_],T=Math.floor(w/8),M=1<<w%8;if(!(this.lookup[T]&M)&&(this.lookup[T]|=M,l.push(w),l.length===this.triangleCount))return}}}query(r,l,h){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>l.x||r.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const p=_u(r.x-this.min.x,this.xScale,this.cellsX),v=_u(l.x-this.min.x,this.xScale,this.cellsX),_=_u(r.y-this.min.y,this.yScale,this.cellsY),w=_u(l.y-this.min.y,this.yScale,this.cellsY);for(let T=_;T<=w;T++)for(let M=p;M<=v;M++){const L=this.cells[T*this.cellsX+M];if(L)for(let z=0;z<L.len;z++){const F=this.payload[L.start+z],G=Math.floor(F/8),W=1<<F%8;if(!(this.lookup[G]&W)&&(this.lookup[G]|=W,h.push(F),h.length===this.triangleCount))return}}}}function _u(c,r,l){return Math.max(0,Math.min(l-1,Math.floor(c*r)))}Dn(_1,"TriangleGridIndex");class EL{constructor(r){this.zoom=r.zoom,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[],this.worldview=r.worldview,this.hasAppearances=null}updateFootprints(r,l){for(const h of this.footprints)l.push({footprint:h,id:r})}updateAppearances(r,l,h,p){}populate(r,l,h,p){const v=[];for(const{feature:_,id:w,index:T,sourceLayerIndex:M}of r){const L=this.layers[0]._featureFilter.needGeometry,z=gt(_,L);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),z,h))continue;const F={id:w,properties:_.properties,type:_.type,sourceLayerIndex:M,index:T,geometry:L?z.geometry:kt(_,h,p),patterns:{}};v.push(F)}for(const _ of v){const{geometry:w,index:T,sourceLayerIndex:M}=_;this.addFeature(_,w,T,h,{},l.availableImages,l.brightness),l.featureIndex.insert(r[T].feature,w,T,M,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(r){}update(r,l,h,p,v,_,w){}destroy(){}addFeature(r,l,h,p,v,_=[],w){for(const T of wy(l,2)){const M=[],L=[],z=[],F=new ut(1/0,1/0),G=new ut(-1/0,-1/0);for(const oe of T)if(oe.length!==0){oe!==T[0]&&z.push(L.length/2);for(let le=0;le<oe.length;le++)L.push(oe[le].x),L.push(oe[le].y),M.push(oe[le]),F.x=Math.min(F.x,oe[le].x),F.y=Math.min(F.y,oe[le].y),G.x=Math.max(G.x,oe[le].x),G.y=Math.max(G.y,oe[le].y)}const W=dg(L,z),J=new _1(M,W,8,256);this.footprints.push({vertices:M,indices:W,grid:J,min:F,max:G})}}}Dn(EL,"ClipBucket",{omit:["layers"]});const XW=Zr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ZW=Zr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),YW=Zr([{name:"a_flood_light_ground_radius",components:1,type:"Float32"}]),JW=Zr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),QW=Zr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),e7=Zr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),t7=Zr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:n7}=XW,Sy=Number.MAX_SAFE_INTEGER,TL=Sy-1;function IL(c,r,l,h){return c.order<r||c.order===Sy||!(c.clipMask&l)||function(p,v){return v.length!==0&&v.find(_=>_===p)===void 0}(h,c.clipScope)}function y1(c,r){return c.x-r.x||c.y-r.y}function PL(c,r){return y1(c.min,r.min)===0&&y1(c.max,r.max)===0}function KT(c,r){return!(c.min.x>r.max.x||c.max.x<r.min.x||c.min.y>r.max.y||c.max.y<r.min.y)}function x1(c,r){if(c.length!==r.length)return!1;for(let l=0;l<c.length;l++)if(c[l].sourceId!==r[l].sourceId||!PL(c[l],r[l])||c[l].order!==r[l].order||c[l].clipMask!==r[l].clipMask||!ur(c[l].clipScope,r[l].clipScope))return!1;return!0}function ML(c,r,l){const h=1/fn,p=1/(1<<l.canonical.z),v=(r.x*h+l.canonical.x)*p+l.wrap,_=(r.y*h+l.canonical.y)*p;return{min:new ut((c.x*h+l.canonical.x)*p+l.wrap,(c.y*h+l.canonical.y)*p),max:new ut(v,_)}}function r7(c,r,l){const h=1<<l.canonical.z,p=((r.x-l.wrap)*h-l.canonical.x)*fn,v=(r.y*h-l.canonical.y)*fn;return{min:new ut(((c.x-l.wrap)*h-l.canonical.x)*fn,(c.y*h-l.canonical.y)*fn),max:new ut(p,v)}}function XT(c,r,l,h,p,v,_){const w=c.indices,T=c.vertices,M=[];for(let L=h;L<h+p;L+=3){const z=r[l[L+0]+v],F=r[l[L+1]+v],G=r[l[L+2]+v],W=Math.min(z.x,F.x,G.x),J=Math.max(z.x,F.x,G.x),oe=Math.min(z.y,F.y,G.y),le=Math.max(z.y,F.y,G.y);M.length=0,c.grid.query(new ut(W,oe),new ut(J,le),M);for(let he=0;he<M.length;he++){const me=M[he];if(zo(T[w[3*me+0]],T[w[3*me+1]],T[w[3*me+2]],z,F,G,_))return!0}}return!1}function RL(c,r,l,h){if(!c||!l)return!1;let p=c.vertices;if(!r.canonical.equals(h.canonical)||r.wrap!==h.wrap){if(l.vertices.length<c.vertices.length)return RL(l,h,c,r);const v=r.canonical,_=h.canonical,w=Math.pow(2,_.z-v.z);p=c.vertices.map(T=>new ut((T.x+v.x*fn)*w-_.x*fn,(T.y+v.y*fn)*w-_.y*fn))}return XT(l,p,c.indices,0,c.indices.length,0,0)}function AL(c,r,l,h){const p=Math.pow(2,h.z-l.z);return new ut((c+l.x*fn)*p-h.x*fn,(r+l.y*fn)*p-h.y*fn)}function ZT(c,r){const l=[];r.grid.queryPoint(c,l);const h=r.indices,p=r.vertices;for(let v=0;v<l.length;v++){const _=l[v];if(ba([p[h[3*_+0]],p[h[3*_+1]],p[h[3*_+2]]],c))return!0}return!1}const YT=[new ut(0,0),new ut(fn,0),new ut(fn,fn),new ut(0,fn)];function OL(c,r){const l=[];let h=[];if(!r||c.length<2)return[c];if(c.length===2)return Ao(c[0],c[1],YT)?[c]:[];for(let p=0;p<c.length+2;p++){const v=c[p%c.length],_=c[(p+1)%c.length],w=Ao(p===0?c[c.length-1]:c[(p-1)%c.length],v,YT),T=Ao(v,_,YT),M=w||T;M&&h.push(v),M&&T||h.length>0&&(h.length>1&&l.push(h),h=[])}return h.length>1&&l.push(h),l}const JT=Kt.types,i7=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],o7=["fill-extrusion-flood-light-ground-radius"],a7=Math.pow(2,13),s7=Math.pow(2,15)-1,DL=new ut(0,1),Eh=2147483648,LL=7,zL=450;function Cy(c,r,l,h,p,v,_,w){c.emplaceBack((r<<1)+_,(l<<1)+v,(Math.floor(h*a7)<<1)+p,Math.round(w))}function Ey(c,r,l){c.emplaceBack(r.x*fn,r.y*fn,l?1:0)}function b1(c,r,l,h,p,v){c.emplaceBack(r.x,r.y,(l.x<<1)+h,(l.y<<1)+p,v)}function Ty(c,r,l){c.emplaceBack(r.x,r.y,r.z,l[0]*16384,l[1]*16384,l[2]*16384)}class kL{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class FL{constructor(){this.centroidXY=new ut(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new ut(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new ut(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new ut(this.max.x-this.min.x,this.max.y-this.min.y)}}class NL{constructor(){this.acc=new ut(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,l){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=l.x,r.min.y=r.max.y=l.y)}appendEdge(r,l,h){this.accCount++,this.acc._add(l);let p=!!this.borders;l.x<r.min.x?(r.min.x=l.x,p=!0):l.x>r.max.x&&(r.max.x=l.x,p=!0),l.y<r.min.y?(r.min.y=l.y,p=!0):l.y>r.max.y&&(r.max.y=l.y,p=!0),((l.x===0||l.x===fn)&&l.x===h.x)!=((l.y===0||l.y===fn)&&l.y===h.y)&&this.processBorderOverlap(l,h),p&&this.checkBorderIntersection(l,h)}checkBorderIntersection(r,l){l.x<0!=r.x<0&&this.addBorderIntersection(0,vr(l.y,r.y,(0-l.x)/(r.x-l.x))),l.x>fn!=r.x>fn&&this.addBorderIntersection(1,vr(l.y,r.y,(fn-l.x)/(r.x-l.x))),l.y<0!=r.y<0&&this.addBorderIntersection(2,vr(l.x,r.x,(0-l.y)/(r.y-l.y))),l.y>fn!=r.y>fn&&this.addBorderIntersection(3,vr(l.x,r.x,(fn-l.y)/(r.y-l.y)))}addBorderIntersection(r,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[r];l<h[0]&&(h[0]=l),l>h[1]&&(h[1]=l)}processBorderOverlap(r,l){if(r.x===l.x){if(r.y===l.y)return;const h=r.x===0?0:1;this.addBorderIntersection(h,l.y),this.addBorderIntersection(h,r.y)}else{const h=r.y===0?2:3;this.addBorderIntersection(h,l.x),this.addBorderIntersection(h,r.x)}}centroid(){return this.accCount===0?new ut(0,0):new ut(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((r,l)=>r+ +(l[0]!==Number.MAX_VALUE),0):0}}function BL(c,r){const l=c.add(r)._unit(),h=ie(c.x*l.x+c.y*l.y,-1,1);var p,v,_;return p=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(p)))/4*s7*((v=c).x*(_=r).y-v.y*_.x<0?-1:1)}const l7=[c=>c.x<0,c=>c.x>fn,c=>c.y<0,c=>c.y>fn];function c7(c,r,l,h){const p=[4];if(h===0)return p;l._mult(h);const v=c.sub(l),_=r.sub(l),w=[c,r,v,_];for(let T=0;T<4;T++)for(const M of w)if(l7[T](M)){p.push(T);break}return p}class QT{constructor(r){this.groundRadiusArray=null,this.groundRadiusBuffer=null,this.vertexArray=new Zm,this.indexArray=new to,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut},l=>o7.includes(l)),this._segments=new po,this.hiddenByLandmarkVertexArray=new rg,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new po}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(r,l,h,p=!1){const v=r.length;if(v>2){let _=Math.max(0,this._segments.get().length-1);const w=this._segments._prepareSegment(4*v,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let T;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const M=r[0],L=r[1];T=BL(M.sub(r[v-1])._perp()._unit(),L.sub(M)._perp()._unit())}for(let M=0;M<v;M++){const L=M===v-1?0:M+1,z=r[M],F=r[L],G=r[L===v-1?0:L+1],W=F.sub(z)._perp()._unit(),J=BL(W,G.sub(F)._perp()._unit()),oe=T,le=J;if(e2(z,F,l)||p&&VL(z,l)&&VL(F,l)){T=J;continue}const he=w.vertexLength;b1(this.vertexArray,z,F,1,1,oe),b1(this.vertexArray,z,F,1,0,oe),b1(this.vertexArray,z,F,0,1,le),b1(this.vertexArray,z,F,0,0,le),w.vertexLength+=4;const me=c7(z,F,W,h);for(const be of me)this._segmentToGroundQuads[_].push({id:he,region:be}),this._segmentToRegionTriCounts[_][be]+=2,w.primitiveLength+=2;T=J}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),l=r.length;for(let h=0;h<l;h++)this._segmentToGroundQuads[h].sort((p,v)=>p.region-v.region);for(let h=0;h<l;h++){const p=this._segmentToGroundQuads[h],v=r[h],_=this._segmentToRegionTriCounts[h];_.reduce((T,M)=>T+M,0);let w=0;for(let T=0;T<=4;T++){const M=_[T];if(M!==0){let L=this.regionSegments[T];L||(L=this.regionSegments[T]=new po);const z={vertexOffset:v.vertexOffset,primitiveOffset:v.primitiveOffset+w,vertexLength:v.vertexLength,primitiveLength:M};L.get().push(z)}w+=M}for(let T=0;T<p.length;T++){const M=p[T].id;this.indexArray.emplaceBack(M,M+1,M+3),this.indexArray.emplaceBack(M,M+3,M+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,l,h,p,v,_,w){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,l,h,p,v,_,void 0,w)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,ZW.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.groundRadiusArray!=null&&(this.groundRadiusBuffer=r.createVertexBuffer(this.groundRadiusArray,YW.members)))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,l,h,p,v,_,w,T){this.hasData()&&this.programConfigurations.updatePaintArrays(r,l,h,p,v,_,w,T)}updateHiddenByLandmark(r){this.updateHiddenByLandmarkRange(r.groundVertexArrayOffset,r.groundVertexCount,!!(r.flags&Eh))}updateHiddenByLandmarkRange(r,l,h){if(!this.hasData())return;const p=l+r;if(l!==0){for(let v=r;v<p;++v)this.hiddenByLandmarkVertexArray.emplace(v,h?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,e7.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this.groundRadiusBuffer&&this.groundRadiusBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const l=this.regionSegments[r];l&&l.destroy()}}}}class w1{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.pixelRatio=r.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new to,this.footprintVertices=new vs,this.footprintSegments=[],this.layoutVertexArray=new fh,this.centroidVertexArray=new r1,this.wallVertexArray=new o1,this.indexArray=new to,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut},l=>i7.includes(l)),this.segments=new po,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new QT(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=r.worldview,this.hasAppearances=null}updateFootprints(r,l){}updateAppearances(r,l,h,p){}populate(r,l,h,p){this.features=[],this.hasPattern=UT("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Ve(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:v,id:_,index:w,sourceLayerIndex:T}of r){const M=this.layers[0]._featureFilter.needGeometry,L=gt(v,M);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),L,h))continue;const z={id:_,sourceLayerIndex:T,index:w,geometry:M?L.geometry:kt(v,h,p),properties:v.properties,type:v.type,patterns:{}},F=this.layoutVertexArray.length,G=JT[z.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:v.id,feature:HT("fill-extrusion",this.layers,z,this.zoom,this.pixelRatio,l)});else if(this.wallMode)for(const W of z.geometry)for(const J of OL(W,G))this.addFeature(v.id,z,[J],w,h,{},l.availableImages,p,l.brightness);else this.addFeature(v.id,z,z.geometry,w,h,{},l.availableImages,p,l.brightness);l.featureIndex.insert(v,z.geometry,w,T,this.index,F)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,l,h,p,v,_){for(const{featureId:w,feature:T}of this.features){const M=JT[T.type]==="Polygon",{geometry:L}=T;if(this.wallMode)for(const z of L)for(const F of OL(z,M))this.addFeature(w,T,[F],T.index,l,h,p,v,_);else this.addFeature(w,T,L,T.index,l,h,p,v,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(r,l,h,p,v,_,w){this.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,this.worldview),this.groundEffect.update(r,l,v,h,p,_,w,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,n7),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.wallVertexBuffer=r.createVertexBuffer(this.wallVertexArray,QW.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,t7.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,JW.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,l,h,p,v,_,w,T,M){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(l,{})/this.tileToMeter,z=[new ut(0,0),new ut(fn,fn)],F=T.projection,G=F.name==="globe",W=this.wallMode||JT[l.type]==="Polygon",J=new NL;J.centroidDataIndex=this.centroidData.length;const oe=new FL;oe.buildingId=r,l.properties&&l.properties.hasOwnProperty("building_id")&&(oe.buildingId=l.properties.building_id);const le=this.layers[0].paint.get("fill-extrusion-base").evaluate(l,{},v)<=0,he=this.layers[0].paint.get("fill-extrusion-height").evaluate(l,{},v);let me;if(oe.height=he,oe.vertexArrayOffset=this.layoutVertexArray.length,oe.groundVertexArrayOffset=this.groundEffect.vertexArray.length,G&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Jm),this.wallMode){if(G)return void jt("Non zero fill-extrusion-line-width is not yet supported on globe.");if(h.length!==1)return;me=function(ct){const At=ct[0].x===ct[ct.length-1].x&&ct[0].y===ct[ct.length-1].y;(function(Sn){let vn=0;const Cr=Sn.length;for(let xn=0;xn<Cr;xn++)vn+=(Sn[(xn+1)%Cr].x-Sn[xn].x)*(Sn[(xn+1)%Cr].y+Sn[xn].y);return vn>=0})(ct)||(ct=ct.reverse());const qt={geometry:[],joinNormals:[],indices:[]},cn=[],en=[],Vt=[];let Yt=ct.length;for(;Yt>=2&&ct[Yt-1].equals(ct[Yt-2]);)Yt--;if(Yt<(At?3:2))return qt;let wt,_t,Xt,sn,Ht,An=0;for(;An<Yt-1&&ct[An].equals(ct[An+1]);)An++;At&&(wt=ct[Yt-2],Ht=ct[An].sub(wt)._unit()._perp());for(let Sn=An;Sn<Yt;Sn++){if(Xt=Sn===Yt-1?At?ct[An+1]:void 0:ct[Sn+1],Xt&&ct[Sn].equals(Xt))continue;Ht&&(sn=Ht),wt&&(_t=wt),wt=ct[Sn],Ht=Xt?Xt.sub(wt)._unit()._perp():sn,sn=sn||Ht;let vn=sn.add(Ht);vn.x===0&&vn.y===0||vn._unit();const Cr=vn.x*Ht.x+vn.y*Ht.y,xn=Cr!==0?1/Cr:1/0,or=sn.x*Ht.y-sn.y*Ht.x>0;let Pr="miter";const Gr=2;Pr==="miter"&&xn>Gr&&(Pr="bevel"),Pr==="bevel"&&(xn>100&&(Pr="flipbevel"),xn<Gr&&(Pr="miter"));const pi=(Or,bi,wi,so)=>{const Oe=new ut(Or.x,Or.y),Pe=new ut(Or.x,Or.y);Oe.x+=bi.x*so,Oe.y+=bi.y*so,Pe.x-=bi.x*Math.max(wi,1),Pe.y-=bi.y*Math.max(wi,1),Vt.push(bi),cn.push(Oe),en.push(Pe)};if(Pr==="miter")vn._mult(xn),pi(wt,vn,0,0);else if(Pr==="flipbevel")vn=Ht.mult(-1),pi(wt,vn,0,0),pi(wt,vn.mult(-1),0,0);else{const Or=-Math.sqrt(xn*xn-1),bi=or?Or:0,wi=or?0:Or;_t&&pi(wt,sn,bi,wi),Xt&&pi(wt,Ht,bi,wi)}}qt.geometry=[...cn,...en.reverse(),cn[0]],qt.joinNormals=[...Vt,...Vt.reverse(),Vt[Vt.length-1]];const Bn=qt.geometry.length-1;for(let Sn=0;Sn<Bn/2;Sn++)if(Sn+1<Bn/2){let vn=Sn,Cr=Sn+1,xn=Bn-1-Sn,or=Bn-2-Sn;vn=vn===0?Bn-1:vn-1,Cr=Cr===0?Bn-1:Cr-1,xn=xn===0?Bn-1:xn-1,or=or===0?Bn-1:or-1,qt.indices.push(xn),qt.indices.push(Cr),qt.indices.push(vn),qt.indices.push(xn),qt.indices.push(or),qt.indices.push(Cr)}return qt}(h[0]),h=[me.geometry]}const be=(ct,At)=>ct<(At.length-1)/2||ct===At.length-1,Ne=this.wallMode?[h]:wy(h,500);for(let ct=Ne.length-1;ct>=0;ct--){const At=Ne[ct];(At.length===0||(Ae=At[0]).every(Bt=>Bt.x<=0)||Ae.every(Bt=>Bt.x>=fn)||Ae.every(Bt=>Bt.y<=0)||Ae.every(Bt=>Bt.y>=fn))&&Ne.splice(ct,1)}var Ae;let He;if(G)He=WL(Ne,z,v);else{He=[];for(const ct of Ne)He.push({polygon:ct,bounds:z})}const Ze=W?this.edgeRadius:0,et=Ze>0&&this.zoom<17,Tt=(ct,At)=>{if(ct.length===0)return!1;const Bt=ct[ct.length-1];return At.x===Bt.x&&At.y===Bt.y};for(const{polygon:ct,bounds:At}of He){let Bt=0,qt=0;for(const Yt of ct)W&&!Yt[0].equals(Yt[Yt.length-1])&&Yt.push(Yt[0]),qt+=W?Yt.length-1:Yt.length;const cn=this.segments.prepareSegment((W?5:4)*qt,this.layoutVertexArray,this.indexArray);oe.footprintSegIdx<0&&(oe.footprintSegIdx=this.footprintSegments.length),oe.polygonSegIdx<0&&(oe.polygonSegIdx=this.polygonSegments.length);const en={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Vt=new kL;if(Vt.vertexOffset=this.footprintVertices.length,Vt.indexOffset=3*this.footprintIndices.length,Vt.ringIndices=[],W){const Yt=[],wt=[];Bt=cn.vertexLength;for(let Xt=0;Xt<ct.length;Xt++){const sn=ct[Xt];sn.length&&Xt!==0&&wt.push(Yt.length/2);const Ht=[];let An,Bn;An=sn[1].sub(sn[0])._perp()._unit(),Vt.ringIndices.push(sn.length-1);for(let Sn=1;Sn<sn.length;Sn++){const vn=sn[Sn],Cr=sn[Sn===sn.length-1?1:Sn+1],xn=vn.clone();if(Ze){Bn=Cr.sub(vn)._perp()._unit();const or=An.add(Bn)._unit(),Pr=Ze*Math.min(4,1/(An.x*or.x+An.y*or.y));xn.x+=Pr*or.x,xn.y+=Pr*or.y,xn.x=Math.round(xn.x),xn.y=Math.round(xn.y),An=Bn}if(!le||Ze!==0&&!et||Tt(Ht,xn)||Ht.push(xn),Cy(this.layoutVertexArray,xn.x,xn.y,0,0,1,1,0),this.wallMode){const or=be(Sn,sn);Ey(this.wallVertexArray,me.joinNormals[Sn],!or)}cn.vertexLength++,this.footprintVertices.emplaceBack(vn.x,vn.y),Yt.push(vn.x,vn.y),G&&Ty(this.layoutVertexExtArray,F.projectTilePoint(xn.x,xn.y,v),F.upVector(v,xn.x,xn.y))}le&&(Ze===0||et)&&(Ht.length!==0&&Tt(Ht,Ht[0])&&Ht.pop(),this.groundEffect.addData(Ht,At,L))}const _t=this.wallMode?me.indices:dg(Yt,wt);for(let Xt=0;Xt<_t.length;Xt+=3)this.footprintIndices.emplaceBack(Vt.vertexOffset+_t[Xt+0],Vt.vertexOffset+_t[Xt+1],Vt.vertexOffset+_t[Xt+2]),this.indexArray.emplaceBack(Bt+_t[Xt],Bt+_t[Xt+2],Bt+_t[Xt+1]),cn.primitiveLength++;Vt.indexCount+=_t.length,Vt.vertexCount+=this.footprintVertices.length-Vt.vertexOffset}for(let Yt=0;Yt<ct.length;Yt++){const wt=ct[Yt];J.startRing(oe,wt[0]);let _t=wt.length>4&&UL(wt[wt.length-2],wt[0],wt[1]),Xt=Ze?u7(wt[wt.length-2],wt[0],wt[1],Ze):0;const sn=[];let Ht,An,Bn;An=wt[1].sub(wt[0])._perp()._unit();let Sn=!0;for(let vn=1,Cr=0;vn<wt.length;vn++){let xn=wt[vn-1],or=wt[vn];const Pr=wt[vn===wt.length-1?1:vn+1];if(J.appendEdge(oe,or,xn),e2(or,xn,At)){Ze&&(An=Pr.sub(or)._perp()._unit(),Sn=!Sn);continue}const Gr=or.sub(xn)._perp(),pi=Gr.x/(Math.abs(Gr.x)+Math.abs(Gr.y)),Or=Gr.y>0?1:0,bi=xn.dist(or);if(Cr+bi>32768&&(Cr=0),Ze){Bn=Pr.sub(or)._perp()._unit();let Pe=jL(xn,or,Pr,$L(An,Bn),Ze);isNaN(Pe)&&(Pe=0);const Ot=or.sub(xn)._unit();xn=xn.add(Ot.mult(Xt))._round(),or=or.add(Ot.mult(-Pe))._round(),Xt=Pe,An=Bn,le&&this.zoom>=17&&(Tt(sn,xn)||sn.push(xn),Tt(sn,or)||sn.push(or))}const wi=cn.vertexLength,so=wt.length>4&&UL(xn,or,Pr);let Oe=HL(Cr,_t,Sn);if(Cy(this.layoutVertexArray,xn.x,xn.y,pi,Or,0,0,Oe),Cy(this.layoutVertexArray,xn.x,xn.y,pi,Or,0,1,Oe),this.wallMode){const Pe=be(vn-1,wt),Ot=me.joinNormals[vn-1];Ey(this.wallVertexArray,Ot,Pe),Ey(this.wallVertexArray,Ot,Pe)}if(Cr+=bi,Oe=HL(Cr,so,!Sn),_t=so,Cy(this.layoutVertexArray,or.x,or.y,pi,Or,0,0,Oe),Cy(this.layoutVertexArray,or.x,or.y,pi,Or,0,1,Oe),this.wallMode){const Pe=be(vn,wt),Ot=me.joinNormals[vn];Ey(this.wallVertexArray,Ot,Pe),Ey(this.wallVertexArray,Ot,Pe)}if(cn.vertexLength+=4,this.indexArray.emplaceBack(wi+0,wi+1,wi+2),this.indexArray.emplaceBack(wi+1,wi+3,wi+2),cn.primitiveLength+=2,Ze){const Pe=Bt+(vn===1?wt.length-2:vn-2),Ot=vn===1?Bt:Pe+1;if(this.indexArray.emplaceBack(wi+1,Pe,wi+3),this.indexArray.emplaceBack(Pe,Ot,wi+3),cn.primitiveLength+=2,Ht===void 0&&(Ht=wi),!e2(Pr,wt[vn],At)){const gn=vn===wt.length-1?Ht:cn.vertexLength;this.indexArray.emplaceBack(wi+2,wi+3,gn),this.indexArray.emplaceBack(wi+3,gn+1,gn),this.indexArray.emplaceBack(wi+3,Ot,gn+1),cn.primitiveLength+=3}Sn=!Sn}if(G){const Pe=this.layoutVertexExtArray,Ot=F.projectTilePoint(xn.x,xn.y,v),gn=F.projectTilePoint(or.x,or.y,v),Dt=F.upVector(v,xn.x,xn.y),_n=F.upVector(v,or.x,or.y);Ty(Pe,Ot,Dt),Ty(Pe,Ot,Dt),Ty(Pe,gn,_n),Ty(Pe,gn,_n)}}W&&(Bt+=wt.length-1),le&&Ze&&this.zoom>=17&&(sn.length!==0&&Tt(sn,sn[0])&&sn.pop(),this.groundEffect.addData(sn,At,L,Ze>0))}this.footprintSegments.push(Vt),en.triangleCount=this.indexArray.length-en.triangleArrayOffset,this.polygonSegments.push(en),++oe.footprintSegLen,++oe.polygonSegLen}if(oe.vertexCount=this.layoutVertexArray.length-oe.vertexArrayOffset,oe.groundVertexCount=this.groundEffect.vertexArray.length-oe.groundVertexArrayOffset,oe.vertexCount!==0){if(oe.centroidXY=J.borders?DL:this.encodeCentroid(J,oe),this.centroidData.push(oe),J.borders){this.featuresOnBorder.push(J);const ct=this.featuresOnBorder.length-1;for(let At=0;At<J.borders.length;At++)J.borders[At][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[At].push(ct)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,_,w,v,M,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(l,p,_,w,v,M,this.worldview),this.maxHeight=Math.max(this.maxHeight,he)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort((l,h)=>this.featuresOnBorder[l].borders[r][0]-this.featuresOnBorder[h].borders[r][0])}splitToSubtiles(){const r=[];for(let w=0;w<this.centroidData.length;w++){const T=this.centroidData[w],M=+(T.min.y+T.max.y>fn),L=2*M+(+(T.min.x+T.max.x>fn)^M);for(let z=0;z<T.polygonSegLen;z++){const F=T.polygonSegIdx+z;r.push({centroidIdx:w,subtile:L,polygonSegmentIdx:F,triangleSegmentIdx:this.polygonSegments[F].triangleSegIdx})}}const l=new to;r.sort((w,T)=>w.triangleSegmentIdx===T.triangleSegmentIdx?w.subtile-T.subtile:w.triangleSegmentIdx-T.triangleSegmentIdx);let h=0,p=0,v=0;for(const w of r){if(w.triangleSegmentIdx!==h)break;v++}const _=r.length;for(;p!==r.length;){h=r[p].triangleSegmentIdx;let w=0,T=p,M=p;for(let L=T;L<v&&r[L].subtile===w;L++)M++;for(;T!==v;){const L=r[T];w=L.subtile;const z=this.centroidData[L.centroidIdx].min.clone(),F=this.centroidData[L.centroidIdx].max.clone(),G={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let W=T;W<M;W++){const J=r[W],oe=this.polygonSegments[J.polygonSegmentIdx],le=this.centroidData[J.centroidIdx].min,he=this.centroidData[J.centroidIdx].max,me=this.indexArray.uint16;for(let be=oe.triangleArrayOffset;be<oe.triangleArrayOffset+oe.triangleCount;be++)l.emplaceBack(me[3*be],me[3*be+1],me[3*be+2]);G.primitiveLength+=oe.triangleCount,z.x=Math.min(z.x,le.x),z.y=Math.min(z.y,le.y),F.x=Math.max(F.x,he.x),F.y=Math.max(F.y,he.y)}G.primitiveLength>0&&this.triangleSubSegments.push({segment:G,min:z,max:F}),T=M;for(let W=T;W<v&&r[W].subtile===r[T].subtile;W++)M++}p=v;for(let L=p;L<_&&r[L].triangleSegmentIdx===r[p].triangleSegmentIdx;L++)v++}l._trim(),this.indexArray=l}getVisibleSegments(r,l,h){const p=new po;if(this.wallMode){for(const J of this.triangleSubSegments)p.segments.push(J.segment);return p}let v=0,_=0;const w=1<<r.canonical.z;if(l){const J=l.getMinMaxForTile(r);J&&(v=J.min,_=J.max)}_+=this.maxHeight;const T=r.toUnwrapped();let M;const L=[T.canonical.x/w+T.wrap,T.canonical.y/w],z=[(T.canonical.x+1)/w+T.wrap,(T.canonical.y+1)/w],F=(J,oe,le)=>[J[0]*(1-le[0])+oe[0]*le[0],J[1]*(1-le[1])+oe[1]*le[1]],G=[],W=[];for(const J of this.triangleSubSegments){G[0]=J.min.x/fn,G[1]=J.min.y/fn,W[0]=J.max.x/fn,W[1]=J.max.y/fn;const oe=F(L,z,G),le=F(L,z,W);if(new Ur([oe[0],oe[1],v],[le[0],le[1],_]).intersectsPrecise(h)===0){M&&(p.segments.push(M),M=void 0);continue}const he=J.segment;M&&M.vertexOffset!==he.vertexOffset&&(p.segments.push(M),M=void 0),M?(M.vertexLength+=he.vertexLength,M.primitiveLength+=he.primitiveLength):M={vertexOffset:he.vertexOffset,primitiveLength:he.primitiveLength,vertexLength:he.vertexLength,primitiveOffset:he.primitiveOffset,sortKey:void 0,vaos:{}}}return M&&p.segments.push(M),p}encodeCentroid(r,l){const h=r.centroid(),p=l.span(),v=Math.min(7,Math.round(p.x*this.tileToMeter/10)),_=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new ut(ie(h.x,1,fn-1)<<3|v,ie(h.y,1,fn-1)<<3|_)}encodeBorderCentroid(r){if(!r.borders)return new ut(0,0);const l=r.borders,h=Number.MAX_VALUE;if(l[0][0]!==h||l[1][0]!==h){const p=l[0][0]!==h?0:1;return new ut(6|(l[0][0]!==h?0:65528),(l[p][0]+l[p][1])/2<<3|6)}{const p=l[2][0]!==h?2:3;return new ut((l[p][0]+l[p][1])/2<<3|6,6|(l[2][0]!==h?0:65528))}}showCentroid(r){const l=this.centroidData[r.centroidDataIndex];l.flags&=2147483647,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const l=r.vertexArrayOffset,h=r.vertexCount+r.vertexArrayOffset,p=r.flags&Eh?DL:r.centroidXY,v=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==p.y||v!==p.x){for(let _=l;_<h;++_)this.centroidVertexArray.emplace(_,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,l,h){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(r.toUnwrapped());if(x1(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const v=[];for(const _ of this.activeReplacements){if(_.order<h)continue;const w=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-r.canonical.z));if(_.footprint.buildingId){const T=_.footprint.buildingId;for(const M of this.centroidData)M.buildingId===T&&(M.flags|=Eh)}else for(const T of this.centroidData)if(!(T.flags&Eh||_.min.x>T.max.x||T.min.x>_.max.x||_.min.y>T.max.y||T.min.y>_.max.y))for(let M=0;M<T.footprintSegLen;M++){const L=this.footprintSegments[T.footprintSegIdx+M];if(v.length=0,d7(this.footprintVertices,L.vertexOffset,L.vertexCount,_.footprintTileId.canonical,r.canonical,v),XT(_.footprint,v,this.footprintIndices.uint16,L.indexOffset,L.indexCount,-L.vertexOffset,-w)){T.flags|=Eh;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,l,h){let p=!1;for(let v=0;v<h.footprintSegLen;v++){const _=this.footprintSegments[h.footprintSegIdx+v];let w=0;for(const T of _.ringIndices){for(let M=w,L=T+w-1;M<T+w;L=M++){const z=this.footprintVertices.int16[2*(M+_.vertexOffset)+0],F=this.footprintVertices.int16[2*(M+_.vertexOffset)+1],G=this.footprintVertices.int16[2*(L+_.vertexOffset)+1];F>l!=G>l&&r<(this.footprintVertices.int16[2*(L+_.vertexOffset)+0]-z)*(l-F)/(G-F)+z&&(p=!p)}w=T}}return p}getHeightAtTileCoord(r,l){let h=Number.NEGATIVE_INFINITY,p=!0;const v=4*(r+fn)*fn+(l+fn);if(this.partLookup.hasOwnProperty(v)){const _=this.partLookup[v];return _?{height:_.height,hidden:!!(_.flags&Eh)}:void 0}for(const _ of this.centroidData)r>_.max.x||_.min.x>r||l>_.max.y||_.min.y>l||_.height<=h||this.footprintContainsPoint(r,l,_)&&(h=_.height,this.partLookup[v]=_,p=!!(_.flags&Eh));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:p};this.partLookup[v]=void 0}}function $L(c,r){const l=c.add(r)._unit();return c.x*l.x+c.y*l.y}function u7(c,r,l,h){const p=r.sub(c)._perp()._unit(),v=l.sub(r)._perp()._unit();return jL(c,r,l,$L(p,v),h)}function jL(c,r,l,h,p){const v=Math.sqrt(1-h*h);return Math.min(c.dist(r)/3,r.dist(l)/3,p*v/h)}function e2(c,r,l){return c.x<l[0].x&&r.x<l[0].x||c.x>l[1].x&&r.x>l[1].x||c.y<l[0].y&&r.y<l[0].y||c.y>l[1].y&&r.y>l[1].y}function VL(c,r){return c.x<r[0].x||c.x>r[1].x||c.y<r[0].y||c.y>r[1].y}function UL(c,r,l){if(c.x<0||c.x>=fn||r.x<0||r.x>=fn||l.x<0||l.x>=fn)return!1;const h=l.sub(r),p=h.perp(),v=c.sub(r);return(h.x*v.x+h.y*v.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(v.x*v.x+v.y*v.y))>-.866&&p.x*v.x+p.y*v.y<0}function HL(c,r,l){const h=r?2|c:-3&c;return l?1|h:-2&h}function GL(){const c=Math.PI/32,r=Math.tan(c),l=$;return l*Math.sqrt(1+2*r*r)-l}function WL(c,r,l){const h=1<<l.z,p=Ce(l.x/h),v=Ce((l.x+1)/h),_=ve(l.y/h),w=ve((l.y+1)/h);return function(T,M,L,z,F=0,G){const W=[];if(!T.length||!L||!z)return W;const J=(Ae,He)=>{for(const Ze of Ae)W.push({polygon:Ze,bounds:He})},oe=Math.ceil(Math.log2(L)),le=Math.ceil(Math.log2(z)),he=oe-le,me=[];for(let Ae=0;Ae<Math.abs(he);Ae++)me.push(he>0?0:1);for(let Ae=0;Ae<Math.min(oe,le);Ae++)me.push(0),me.push(1);let be=T;if(be=v1(be,M[0].y-F,M[1].y+F,1),be=v1(be,M[0].x-F,M[1].x+F,0),!be.length)return W;const Ne=[];for(me.length?Ne.push({polygons:be,bounds:M,depth:0}):J(be,M);Ne.length;){const Ae=Ne.pop(),He=Ae.depth,Ze=me[He],et=Ae.bounds[0],Tt=Ae.bounds[1],ct=Ze===0?et.x:et.y,At=Ze===0?Tt.x:Tt.y,Bt=G?G(Ze,ct,At):.5*(ct+At),qt=v1(Ae.polygons,ct-F,Bt+F,Ze),cn=v1(Ae.polygons,Bt-F,At+F,Ze);if(qt.length){const en=[et,new ut(Ze===0?Bt:Tt.x,Ze===1?Bt:Tt.y)];me.length>He+1?Ne.push({polygons:qt,bounds:en,depth:He+1}):J(qt,en)}if(cn.length){const en=[new ut(Ze===0?Bt:et.x,Ze===1?Bt:et.y),Tt];me.length>He+1?Ne.push({polygons:cn,bounds:en,depth:He+1}):J(cn,en)}}return W}(c,r,Math.ceil((v-p)/11.25),Math.ceil((_-w)/11.25),1,(T,M,L)=>{if(T===0)return .5*(M+L);{const z=ve((l.y+M/fn)/h);return(ce(.5*(ve((l.y+L/fn)/h)+z))*h-l.y)*fn}})}function d7(c,r,l,h,p,v){const _=Math.pow(2,h.z-p.z);for(let w=0;w<l;w++){let T=c.int16[2*(w+r)+0],M=c.int16[2*(w+r)+1];T=(T+p.x*fn)*_-h.x*fn,M=(M+p.y*fn)*_-h.y*fn,v.push(new ut(T,M))}}let qL,KL;Dn(w1,"FillExtrusionBucket",{omit:["layers","features"]}),Dn(FL,"PartData"),Dn(kL,"FootprintSegment"),Dn(NL,"BorderCentroidData"),Dn(QT,"GroundEffect");class cp extends ut{constructor(r,l,h){super(r,l),this.z=h}}class XL extends cp{constructor(r,l,h,p){super(r,l,h),this.w=p}}function ZL(c,r,l,h){const p=l==="x"?"y":"x",v=(h-c[l])/(r[l]-c[l]);c[p]=Math.round(c[p]+(r[p]-c[p])*v),c[l]=h,c.hasOwnProperty("z")&&(c.z=vr(c.z,r.z,v)),c.hasOwnProperty("w")&&(c.w=vr(c.w,r.w,v))}function YL(c,r,l,h){const p=l,v=h;for(const _ of["x","y"]){let w=c,T=r;w[_]>=T[_]&&(w=r,T=c),w[_]<p&&T[_]>p&&ZL(w,T,_,p),w[_]<v&&T[_]>v&&ZL(T,w,_,v)}}function S1(c,r,l,h,p,v){const _=[];for(let w=0;w<c.length;w++){const T=c[w];let M;const L=_.length;let z=0;for(let F=0;F<T.length-1;F++){let G=T[F],W=T[F+1],J=0;const oe=z;let le,he;v&&(J=Math.hypot(W.x-G.x,W.y-G.y),z+=J,le=G,he=W),G.x<r&&W.x<r||(G.x<r?G=new ut(r,G.y+(r-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x<r&&(W=new ut(r,G.y+(r-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y<l&&W.y<l||(G.y<l?G=new ut(G.x+(l-G.y)/(W.y-G.y)*(W.x-G.x),l)._round():W.y<l&&(W=new ut(G.x+(l-G.y)/(W.y-G.y)*(W.x-G.x),l)._round()),G.x>=h&&W.x>=h||(G.x>=h?G=new ut(h,G.y+(h-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x>=h&&(W=new ut(h,G.y+(h-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y>=p&&W.y>=p||(G.y>=p?G=new ut(G.x+(p-G.y)/(W.y-G.y)*(W.x-G.x),p)._round():W.y>=p&&(W=new ut(G.x+(p-G.y)/(W.y-G.y)*(W.x-G.x),p)._round()),M&&G.equals(M[M.length-1])||(M=[G],_.push(M),v&&v.push({progress:{min:oe+JL(le,he,G)*J,max:1},parentIndex:w,prevPoint:le,nextPoint:he})),M.push(W),v&&(v[v.length-1].progress.max=oe+JL(le,he,W)*J,v[v.length-1].nextPoint=he)))))}if(v&&z>0)for(let F=L;F<_.length;F++)v[F].progress.min/=z,v[F].progress.max/=z}return _}function h7(c,r,l,h,p){if(c.length<2)return void h.push(c);const v=[];for(;r.valid();){const[M,L]=r.get();for(let z=0;z<c.length-1;z++){const F=c[z],G=c[z+1],W=Xs(F,G,M,L);if(W){const[J]=W,oe=new ut(vr(F.x,G.x,J),vr(F.y,G.y,J));v.push({t:z+J,distance:0,point:oe})}}r.next()}if(v.length===0)return void h.push(c);v.sort((M,L)=>M.t-L.t);let _=0,w=0,T=[];for(h.push(T);_!==c.length;){if(w===v.length){for(;_!==c.length;)T.length!==0&&T[T.length-1].equals(c[_])||T.push(c[_]),_++;break}v[w].t<=_?(T.length!==0&&T[T.length-1].equals(v[w].point)||T.push(v[w].point),Math.trunc(v[w].t),w++):(T.length!==0&&T[T.length-1].equals(c[_])||T.push(c[_]),_++)}}function JL(c,r,l){return c.x!==r.x?(l.x-c.x)/(r.x-c.x):c.y!==r.y?(l.y-c.y)/(r.y-c.y):0}function Iy(c,r){return c.x*r.x+c.y*r.y}function QL(c,r){if(c.length===1){let l=0;const h=r[l++];let p;for(;!p||h.equals(p);)if(p=r[l++],!p)return 1/0;for(;l<r.length;l++){const v=r[l],_=c[0],w=p.sub(h),T=v.sub(h),M=_.sub(h),L=Iy(w,w),z=Iy(w,T),F=Iy(T,T),G=Iy(M,w),W=Iy(M,T),J=L*F-z*z,oe=(F*G-z*W)/J,le=(L*W-z*G)/J,he=h.z*(1-oe-le)+p.z*oe+v.z*le;if(isFinite(he))return he}return 1/0}{let l=1/0;for(const h of r)l=Math.min(l,h.z);return l}}function ez(c,r,l){let h=1/0;So(l,r)&&(h=QL(l,r[0]));for(let p=0;p<r.length;p++){const v=r[p],_=c[p];for(let w=0;w<v.length-1;w++){const T=v[w],M=[T,v[w+1],_[w+1],_[w],T];Ro(l,M)&&(h=Math.min(h,QL(l,M)))}}return h!==1/0&&h}function tz(c,r,l,h,p,v,_,w,T,M,L){return c.projection.name==="globe"?function(z,F,G,W,J,oe,le,he,me,be,Ne){const Ae=[],He=[],Ze=z.projection.upVectorScale(Ne,z.center.lat,z.worldSize).metersToTile,et=[0,0,0,1],Tt=[0,0,0,1],ct=(Bt,qt,cn,en)=>{Bt[0]=qt,Bt[1]=cn,Bt[2]=en,Bt[3]=1},At=GL();G>0&&(G+=At),W+=At;for(const Bt of F){const qt=[],cn=[];for(const en of Bt){const Vt=en.x+J.x,Yt=en.y+J.y,wt=z.projection.projectTilePoint(Vt,Yt,Ne),_t=z.projection.upVector(Ne,en.x,en.y);let Xt=G,sn=W;if(le){const Ht=nz(Vt,Yt,G,W,le,he,me,be);Xt+=Ht.base,sn+=Ht.top}G!==0?ct(et,wt.x+_t[0]*Ze*Xt,wt.y+_t[1]*Ze*Xt,wt.z+_t[2]*Ze*Xt):ct(et,wt.x,wt.y,wt.z),ct(Tt,wt.x+_t[0]*Ze*sn,wt.y+_t[1]*Ze*sn,wt.z+_t[2]*Ze*sn),yt(et,et,oe),yt(Tt,Tt,oe),qt.push(new cp(et[0],et[1],et[2])),cn.push(new cp(Tt[0],Tt[1],Tt[2]))}Ae.push(qt),He.push(cn)}return[Ae,He]}(c,r,l,h,p,v,_,w,T,M,L):_?function(z,F,G,W,J,oe,le,he,me){const be=[],Ne=[],Ae=[0,0,0,1];for(const He of z){const Ze=[],et=[];for(const Tt of He){const ct=Tt.x+W.x,At=Tt.y+W.y,Bt=nz(ct,At,F,G,oe,le,he,me);Ae[0]=ct,Ae[1]=At,Ae[2]=Bt.base,Ae[3]=1,Ut(Ae,Ae,J),Ae[3]=Math.max(Ae[3],1e-5);const qt=new cp(Ae[0]/Ae[3],Ae[1]/Ae[3],Ae[2]/Ae[3]);Ae[0]=ct,Ae[1]=At,Ae[2]=Bt.top,Ae[3]=1,Ut(Ae,Ae,J),Ae[3]=Math.max(Ae[3],1e-5);const cn=new cp(Ae[0]/Ae[3],Ae[1]/Ae[3],Ae[2]/Ae[3]);Ze.push(qt),et.push(cn)}be.push(Ze),Ne.push(et)}return[be,Ne]}(r,l,h,p,v,_,w,T,M):function(z,F,G,W,J){const oe=[],le=[],he=J[8]*F,me=J[9]*F,be=J[10]*F,Ne=J[11]*F,Ae=J[8]*G,He=J[9]*G,Ze=J[10]*G,et=J[11]*G;for(const Tt of z){const ct=[],At=[];for(const Bt of Tt){const qt=Bt.x+W.x,cn=Bt.y+W.y,en=J[0]*qt+J[4]*cn+J[12],Vt=J[1]*qt+J[5]*cn+J[13],Yt=J[2]*qt+J[6]*cn+J[14],wt=J[3]*qt+J[7]*cn+J[15],_t=en+he,Xt=Vt+me,sn=Yt+be,Ht=Math.max(wt+Ne,1e-5),An=en+Ae,Bn=Vt+He,Sn=Yt+Ze,vn=Math.max(wt+et,1e-5);ct.push(new cp(_t/Ht,Xt/Ht,sn/Ht)),At.push(new cp(An/vn,Bn/vn,Sn/vn))}oe.push(ct),le.push(At)}return[oe,le]}(r,l,h,p,v)}function nz(c,r,l,h,p,v,_,w){const T=_*p.getElevationAt(c,r,!0,!0),M=v[0]!==0,L=M?v[1]===0?_*(v[0]/LL-zL):_*function(z,F,G){const W=Math.floor(F[0]/8),J=Math.floor(F[1]/8),oe=10*(F[0]-8*W),le=10*(F[1]-8*J),he=z.getElevationAt(W,J,!0,!0),me=z.getMeterToDEM(G),be=Math.floor(.5*(oe*me-1)),Ne=Math.floor(.5*(le*me-1)),Ae=z.tileCoordToPixel(W,J),He=2*be+1,Ze=2*Ne+1,et=function(cn,en,Vt,Yt,wt){return[cn.getElevationAtPixel(en,Vt,!0),cn.getElevationAtPixel(en+wt,Vt,!0),cn.getElevationAtPixel(en,Vt+wt,!0),cn.getElevationAtPixel(en+Yt,Vt+wt,!0)]}(z,Ae.x-be,Ae.y-Ne,He,Ze),Tt=Math.abs(et[0]-et[1]),ct=Math.abs(et[2]-et[3]),At=Math.abs(et[0]-et[2])+Math.abs(et[1]-et[3]),Bt=Math.min(.25,.5*me*(Tt+ct)/He),qt=Math.min(.25,.5*me*At/Ze);return he+Math.max(Bt*oe,qt*le)}(p,v,w):T;return{base:T+(l===0?-1:l),top:M?Math.max(L+h,T+l+2):T+h}}class f7{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class p7{constructor(){this.tasks={},this.taskQueue=[],rt(["process"],this),this.invoker=new f7(this.process),this.nextId=0}add(r,l){const h=this.nextId++,p=function({type:v,isSymbolTile:_,zoom:w}){return w=w||0,v==="message"?0:v!=="maybePrepare"||_?v!=="parseTile"||_?v==="parseTile"&&_?300-w:v==="maybePrepare"&&_?400-w:500:200-w:100-w}(l);if(p===0){try{r()}finally{}return null}return this.tasks[h]={fn:r,metadata:l,priority:p,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const l=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let r=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const v=this.tasks[this.taskQueue[p]];v.priority<l&&(l=v.priority,r=p)}if(r===null)return null;const h=this.taskQueue[r];return this.taskQueue.splice(r,1),h}remove(){this.invoker.remove()}}class rz{constructor(r,l,h){this.target=r,this.parent=l,this.mapId=h,this.callbacks={},this.cancelCallbacks={},rt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new p7}send(r,l,h,p,v=!1,_){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=_,this.callbacks[w]=h);const T=new Set;return this.target.postMessage({id:w,type:r,hasCallback:!!h,targetMapId:p,mustQueue:v,sourceMapId:this.mapId,data:du(l,T)},T),{cancel:()=>{h&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(r){const l=r.data;if(!l)return;const h=l.id;if(h&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const p=this.cancelCallbacks[h];delete this.cancelCallbacks[h],p&&p.cancel()}else if(l.mustQueue||En(self)){const p=this.callbacks[h],v=this.scheduler.add(()=>this.processTask(h,l),p&&p.metadata||{type:"message"});v&&(this.cancelCallbacks[h]=v)}else this.processTask(h,l)}processTask(r,l){if(delete this.cancelCallbacks[r],l.type==="<response>"){const h=this.callbacks[r];delete this.callbacks[r],h&&(l.error?h(hu(l.error)):h(null,hu(l.data)))}else{const h=new Set,p=l.hasCallback?(_,w)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:_?du(_):null,data:du(w,h)},h)}:()=>{},v=hu(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,v,p);else if(this.parent.getWorkerSource){const _=l.type.split("."),{source:w,scope:T}=v;this.parent.getWorkerSource(l.sourceMapId,_[0],w,T)[_[1]](v,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Py={workerUrl:"",workerClass:null,workerParams:void 0};const t2="mapboxgl_preloaded_worker_pool";class up{constructor(){this.active={}}acquire(r,l=up.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(Py.workerClass!=null?new Py.workerClass:new self.Worker(Py.workerUrl,Py.workerParams));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[t2]}numActive(){return Object.keys(this.active).length}}up.workerCount=2;class fg{constructor(r,l,h="Worker",p=up.workerCount){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=ot();const v=this.workerPool.acquire(this.id,p);for(let _=0;_<v.length;_++){const w=new fg.Actor(v[_],l,this.id);w.name=`${h} ${_}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,l,h){De(this.actors,(p,v)=>{p.send(r,l,v)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}let My,n2;function C1(){return My||(My=new up),My}fg.Actor=rz;class m7{constructor(r){this.module=r}createIntArray(r){const l=new Int32Array(r),h=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heap32.set(l,h/l.BYTES_PER_ELEMENT),h}createFloatArray(r){const l=new Float32Array(r),h=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heapF32.set(l,h/l.BYTES_PER_ELEMENT),h}createStringBuffer(r){const l=this.module.malloc(r.length+1);for(let h=0;h<r.length;++h)this.module.heapU8[l+h]=r.charCodeAt(h);return this.module.heapU8[l+r.length]=0,l}readStringBuffer(r){let l="";for(;this.module.heapU8[r]!==0;)l+=String.fromCharCode(this.module.heapU8[r]),++r;return l}setStyle(r){const l=r.entranceColorRgb,h=r.facadeGlazingColorRgb,p=r.roofColorRgb,v=r.wallColorRgb,_=r.normalScale;this.module.setStyle(l[0],l[1],l[2],h[0],h[1],h[2],p[0],p[1],p[2],v[0],v[1],v[2],_[0],_[1],_[2],r.tileToMeters)}setAOOptions(r,l){this.module.setAOOptions(r?1:0,l)}setMetricOptions(r,l){this.module.setMetricOptions(r?1:0,l)}setStructuralOptions(r){this.module.setStructuralOptions(r?1:0)}setFacadeOptions(r,l){this.module.setFacadeOptions(r,l?1:0)}setFauxFacadeOptions(r,l,h){this.module.setFauxFacadeOptions(r?1:0,l?1:0,h)}setFacadeClassifierOptions(r){this.module.setFacadeClassifierOptions(r)}generateMesh(r,l){for(const w of r){const T=this.createStringBuffer(w.roofType),M=[0],L=[];for(const G of w.coordinates)if(Array.isArray(G)){for(const W of G)L.push(W.x),L.push(W.y);M.push(L.length)}const z=this.createIntArray(M),F=this.createFloatArray(L);this.module.addFeature(w.id,w.sourceId,w.minHeight,w.height,T,w.roofType.length,F,z,M.length-1),this.module.free(T),this.module.free(z),this.module.free(F)}for(const w of l){let T;T=w.entrances?JSON.parse(w.entrances):[];const M=this.createFloatArray(T),L=[];for(const F of w.coordinates)L.push(F.x),L.push(F.y);const z=this.createFloatArray(L);this.module.addFacade(w.sourceId,w.crossPerc,w.distanceToRoad,M,T.length,z,L.length),this.module.free(M),this.module.free(z)}if(!this.module.generateMesh()){const w=this.module.getLastError();return this.readStringBuffer(w)}const h=this.module.getMeshCount(),p=new Array(h);for(let w=0;w<h;w++){const T=this.module.getPositionsPtr(w),M=this.module.getPositionsLength(w),L=new Float32Array(this.module.heapF32.buffer,T,M),z=this.module.getNormalsPtr(w),F=this.module.getNormalsLength(w),G=new Float32Array(this.module.heapF32.buffer,z,F),W=this.module.getColorsPtr(w),J=this.module.getColorsLength(w),oe=new Uint8Array(this.module.heapU8.buffer,W,J),le=this.module.getAOPtr(w),he=this.module.getAOLength(w),me=new Float32Array(this.module.heapF32.buffer,le,he),be=this.module.getUVPtr(w),Ne=this.module.getUVLength(w),Ae=new Float32Array(this.module.heapF32.buffer,be,Ne),He=this.module.getFauxFacadePtr(w),Ze=this.module.getFauxFacadeLength(w),et=new Uint8Array(this.module.heapU8.buffer,He,Ze),Tt=this.module.getIndicesPtr(w),ct=this.module.getIndicesLength(w),At=new Int32Array(this.module.heap32.buffer,Tt,ct),Bt=this.module.getBuildingPart(w),qt=this.readStringBuffer(Bt);p[w]={positions:L,normals:G,colors:oe,ao:me,uv:Ae,isFauxFacade:et,indices:At,buildingPart:qt}}const v=this.module.getRingCount(),_=[];for(let w=0;w<v;w++){const T=this.module.getRingPtr(w),M=this.module.getRingLength(w),L=new Float32Array(this.module.heapF32.buffer,T,M);_.push(L)}return{meshes:p,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:_}}}let Ry,r2,Oc,pg,i2,mg=null,gg=null,iz=null,E1=null;function oz(){return En(self)&&self.worker.dracoUrl?self.worker.dracoUrl:r2||li.DRACO_URL}function az(){if(En(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(pg)return pg;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return pg=WebAssembly.validate(c)?li.MESHOPT_SIMD_URL:li.MESHOPT_URL,pg}function g7(){return E1}const T1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},v7={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Ay={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function sz(c,r,l){const h=l.json.bufferViews.length,p=l.buffers.length;r.bufferView=h,l.json.bufferViews[h]={buffer:p,byteLength:c.byteLength},l.buffers[p]=c}const o2="KHR_draco_mesh_compression";function _7(c,r){const l=c.extensions&&c.extensions[o2];if(!l)return;const h=new Oc.Decoder,p=dz(r,l.bufferView),v=new Oc.Mesh;if(!h.DecodeArrayToMesh(p,p.byteLength,v))throw new Error("Failed to decode Draco mesh");const _=r.json.accessors[c.indices],w=T1[_.componentType],T=_.count*w.BYTES_PER_ELEMENT,M=Oc._malloc(T);w===Uint16Array?h.GetTrianglesUInt16Array(v,T,M):h.GetTrianglesUInt32Array(v,T,M),sz(Oc.memory.buffer.slice(M,M+T),_,r),Oc._free(M);for(const L of Object.keys(l.attributes)){const z=h.GetAttributeByUniqueId(v,l.attributes[L]),F=r.json.accessors[c.attributes[L]],G=v7[F.componentType],W=F.count*Ay[F.type]*T1[F.componentType].BYTES_PER_ELEMENT,J=Oc._malloc(W);h.GetAttributeDataArrayForAllPoints(v,z,Oc[G],W,J),sz(Oc.memory.buffer.slice(J,J+W),F,r),Oc._free(J)}h.destroy(),v.destroy(),delete c.extensions[o2]}const I1="EXT_meshopt_compression";function y7(c,r){if(!c.extensions||!c.extensions[I1])return;const l=c.extensions[I1],h=new Uint8Array(r.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),p=new Uint8Array(l.count*l.byteStride);i2.decodeGltfBuffer(p,l.count,l.byteStride,h,l.mode,l.filter),c.buffer=r.buffers.length,c.byteOffset=0,r.buffers[c.buffer]=p.buffer,delete c.extensions[I1]}const lz=1179937895,cz=new TextDecoder("utf8");function uz(c,r){return new URL(c,r).href}function x7(c,r,l,h){return fetch(uz(c.uri,h)).then(p=>p.arrayBuffer()).then(p=>{r.buffers[l]=p})}function dz(c,r){const l=c.json.bufferViews[r];return new Uint8Array(c.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function b7(c,r,l,h){if(c.uri){const p=uz(c.uri,h);return fetch(p).then(v=>v.blob()).then(v=>createImageBitmap(v)).then(v=>{r.images[l]=v})}if(c.bufferView!==void 0){const p=dz(r,c.bufferView),v=new Blob([p],{type:c.mimeType});return createImageBitmap(v).then(_=>{r.images[l]=_})}}function hz(c,r=0,l){const h={json:null,images:[],buffers:[]};if(new Uint32Array(c,r,1)[0]===lz){const L=new Uint32Array(c,r);let z=2;const F=(L[z++]>>2)-3,G=L[z++]>>2;if(z++,h.json=JSON.parse(cz.decode(L.subarray(z,z+G))),z+=G,z<F){const W=L[z++];z++;const J=r+(z<<2);h.buffers[0]=c.slice(J,J+W)}}else h.json=JSON.parse(cz.decode(new Uint8Array(c,r)));const{buffers:p,images:v,meshes:_,extensionsUsed:w,bufferViews:T}=h.json;let M=Promise.resolve();if(p){const L=[];for(let z=0;z<p.length;z++){const F=p[z];F.uri?L.push(x7(F,h,z,l)):h.buffers[z]||(h.buffers[z]=null)}M=Promise.all(L)}return M.then(()=>{const L=[],z=w&&w.includes(o2),F=w&&w.includes(I1);if(z&&L.push(function(){if(!Oc)return Ry??(Ry=function(G){let W,J=null;function oe(){W=new Uint8Array(J.buffer)}function le(){throw new Error("Unexpected Draco error.")}const he={a:{a:le,d:function(me,be,Ne){return W.copyWithin(me,be,be+Ne)},c:function(me){const be=W.length,Ne=Math.max(me>>>0,Math.ceil(1.2*be)),Ae=Math.ceil((Ne-be)/65536);try{return J.grow(Ae),oe(),!0}catch{return!1}},b:le}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(G,he):G.then(me=>me.arrayBuffer()).then(me=>WebAssembly.instantiate(me,he))).then(me=>{const{Rb:be,Qb:Ne,P:Ae,T:He,X:Ze,Ja:et,La:Tt,Qa:ct,Va:At,Wa:Bt,eb:qt,jb:cn,f:en,e:Vt,yb:Yt,zb:wt,Ab:_t,Bb:Xt,Db:sn,Gb:Ht}=me.instance.exports;J=Vt;const An=(()=>{let Bn=0,Sn=0,vn=0,Cr=0;return xn=>{vn&&(be(Cr),be(Bn),Sn+=vn,vn=Bn=0),Bn||(Sn+=128,Bn=Ne(Sn));const or=xn.length+7&-8;let Pr=Bn;or>=Sn&&(vn=or,Pr=Cr=Ne(or));for(let Gr=0;Gr<xn.length;Gr++)W[Pr+Gr]=xn[Gr];return Pr}})();return oe(),en(),{memory:Vt,_free:be,_malloc:Ne,Mesh:class{constructor(){this.ptr=Ae()}destroy(){He(this.ptr)}},Decoder:class{constructor(){this.ptr=et()}destroy(){cn(this.ptr)}DecodeArrayToMesh(Bn,Sn,vn){const Cr=An(Bn),xn=Tt(this.ptr,Cr,Sn,vn.ptr);return!!Ze(xn)}GetAttributeByUniqueId(Bn,Sn){return{ptr:ct(this.ptr,Bn.ptr,Sn)}}GetTrianglesUInt16Array(Bn,Sn,vn){At(this.ptr,Bn.ptr,Sn,vn)}GetTrianglesUInt32Array(Bn,Sn,vn){Bt(this.ptr,Bn.ptr,Sn,vn)}GetAttributeDataArrayForAllPoints(Bn,Sn,vn,Cr,xn){qt(this.ptr,Bn.ptr,Sn.ptr,vn,Cr,xn)}},DT_INT8:Yt(),DT_UINT8:wt(),DT_INT16:_t(),DT_UINT16:Xt(),DT_UINT32:sn(),DT_FLOAT32:Ht()}})}(fetch(oz())),Ry.then(G=>{Oc=G,Ry=void 0}))}()),F&&L.push(function(){if(i2)return;const G=function(W){let J;const oe=WebAssembly.instantiateStreaming(W,{}).then(me=>{J=me.instance,J.exports.__wasm_call_ctors()}),le={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},he={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:oe,supported:!0,decodeGltfBuffer(me,be,Ne,Ae,He,Ze){(function(et,Tt,ct,At,Bt,qt,cn){const en=et.exports.sbrk,Vt=At+3&-4,Yt=en(Vt*Bt),wt=en(qt.length),_t=new Uint8Array(et.exports.memory.buffer);_t.set(qt,wt);const Xt=Tt(Yt,At,Bt,wt,qt.length);if(Xt===0&&cn&&cn(Yt,Vt,Bt),ct.set(_t.subarray(Yt,Yt+At*Bt)),en(Yt-en(0)),Xt!==0)throw new Error(`Malformed buffer data: ${Xt}`)})(J,J.exports[he[He]],me,be,Ne,Ae,J.exports[le[Ze]])}}}(fetch(az()));return G.ready.then(()=>{i2=G})}()),v)for(let G=0;G<v.length;G++)L.push(b7(v[G],h,G,l));return(L.length?Promise.all(L):Promise.resolve()).then(()=>{if(z&&_)for(const{primitives:G}of _)for(const W of G)_7(W,h);if(F&&_&&T)for(const G of T)y7(G,h);return h})})}function fz(c){return fetch(c).then(r=>r.arrayBuffer()).then(r=>hz(r,0,c))}function a2(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function s2(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class l2{constructor(r,l,h,p){this.context=r,this.format=h,this.useMipmap=p&&p.useMipmap,this.texture=r.gl.createTexture(),this.update(l,{premultiply:p&&p.premultiply})}update(r,l){const h=r&&r instanceof HTMLVideoElement&&r.width===0?r.videoWidth:r.width,p=r&&r instanceof HTMLVideoElement&&r.height===0?r.videoHeight:r.height,{context:v}=this,{gl:_}=v,{x:w,y:T}=l&&l.position?l.position:{x:0,y:0},M=w+h,L=T+p;!this.size||this.size[0]===M&&this.size[1]===L||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!l||l.premultiply!==!1));const z=r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap;if(!this.size&&M>0&&L>0){const F=this.useMipmap?Math.floor(Math.log2(Math.max(M,L)))+1:1;_.texStorage2D(_.TEXTURE_2D,F,this.format,M,L),this.size=[M,L]}this.size&&(z?_.texSubImage2D(_.TEXTURE_2D,0,w,T,a2(this.format),s2(this.format),r):"data"in r&&r.data&&_.texSubImage2D(_.TEXTURE_2D,0,w,T,h,p,a2(this.format),s2(this.format),r.data)),this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(r,l,h=!1){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),r!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,r),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap&&!h?r===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),l!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,l),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(r,l,h,p,v){const{context:_}=this,{gl:w}=_;w.bindTexture(w.TEXTURE_2D,this.texture),l!==this.magFilter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,l),this.magFilter=l),r!==this.minFilter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,this.useMipmap?r===w.NEAREST?w.NEAREST_MIPMAP_NEAREST:w.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),h!==this.wrapS&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,h),this.wrapS=h),p!==this.wrapT&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,p),this.wrapT=p),v!==this.compareMode&&(v?(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_COMPARE_MODE,w.COMPARE_REF_TO_TEXTURE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_COMPARE_FUNC,v)):w.texParameteri(w.TEXTURE_2D,w.TEXTURE_COMPARE_MODE,w.NONE),this.compareMode=v)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Oy{constructor(r,l){this.context=r,this.texture=l}bind(r,l){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,r),this.minFilter=r),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}}const w7=Zr([{name:"a_pos_3f",components:3,type:"Float32"}]),S7=Zr([{name:"a_color_3f",components:3,type:"Float32"}]),C7=Zr([{name:"a_color_4f",components:4,type:"Float32"}]),E7=Zr([{name:"a_uv_2f",components:2,type:"Float32"}]),T7=Zr([{name:"a_normal_3f",components:3,type:"Float32"}]),I7=Zr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),P7=Zr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function pz(c,r){const l=P1(c.projection,c.zoom,c.width,c.height),h=function(v,_,w,T,M){const L=new q(w.lng-180*Th,w.lat),z=new q(w.lng+180*Th,w.lat),F=v.project(L.lng,L.lat),G=v.project(z.lng,z.lat),W=-Math.atan2(G.y-F.y,G.x-F.x),J=st.fromLngLat(w);J.y=ie(J.y,-1+Th,1-Th);const oe=J.toLngLat(),le=v.project(oe.lng,oe.lat),he=st.fromLngLat(oe);he.x+=Th;const me=he.toLngLat(),be=v.project(me.lng,me.lat),Ne=gz(be.x-le.x,be.y-le.y,W),Ae=st.fromLngLat(oe);Ae.y+=Th;const He=Ae.toLngLat(),Ze=v.project(He.lng,He.lat),et=gz(Ze.x-le.x,Ze.y-le.y,W),Tt=Math.abs(Ne.x)/Math.abs(et.y),ct=N([]);ne(ct,ct,-W*(1-(M?0:T)));const At=N([]);return Y(At,At,[1,1-(1-Tt)*T,1]),At[4]=-et.x/et.y*T,ne(At,At,W),V(At,ct,At),At}(c.projection,0,c.center,l,r),p=mz(c);return Y(h,h,[p,p,1]),h}function mz(c){const r=c.projection,l=P1(c.projection,c.zoom,c.width,c.height),h=c2(r,c.center),p=c2(r,q.convert(r.center));return Math.pow(2,h*l+(1-l)*p)}function P1(c,r,l,h,p=1/0){const v=c.range;if(!v)return 0;const _=Math.min(p,Math.max(l,h)),w=Math.log2(_/1024);return _e(v[0]+w,v[1]+w,r)}const Th=1/4e4;function c2(c,r){const l=ie(r.lat,-Ie,Ie),h=new q(r.lng-180*Th,l),p=new q(r.lng+180*Th,l),v=c.project(h.lng,l),_=c.project(p.lng,l),w=st.fromLngLat(h),T=st.fromLngLat(p),M=_.x-v.x,L=_.y-v.y,z=T.x-w.x,F=T.y-w.y,G=Math.sqrt((z*z+F*F)/(M*M+L*L));return Math.log2(G)}function gz(c,r,l){const h=Math.cos(l),p=Math.sin(l);return{x:c*h-r*p,y:c*p+r*h}}function vz(c,r,l){N(c),ne(c,c,Gt(r[2])),Z(c,c,Gt(r[0])),te(c,c,Gt(r[1])),Y(c,c,l),V(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function M1(c,r,l,h,p,v,_,w){const T=[l[0]-r[0],l[1]-r[1],0],M=[h[0]-r[0],h[1]-r[1],0];if(Se(T)<1e-12||Se(M)<1e-12)return On(c);const L=Rt([],T,M);ft(L,L),Ue(M,h,r),T[2]=(v-p)*w,M[2]=(_-p)*w;const z=T;return Rt(z,T,M),ft(z,z),$n(c,L,z)}function R1(c,r,l=!1){const h=Sh(r.zoom),p=function(v,_,w){const T=_.worldSize,M=[v[12],v[13],v[14]],L=ve(M[1]/T),z=Ce(M[0]/T),F=N([]),G=pe(1,L)*T,W=pe(1,0)*T*Le(L,_.zoom),J=1/NT(T);let oe=W*J;if(w){const be=P1(_.projection,_.zoom,_.width,_.height,1024);oe=J*_.projection.pixelSpaceConversion(_.center.lat,T,be)}const le=O(L,z);ze(le,le,qe([],ft([],le),G*oe*M[2]));const he=function(be){const Ne=[be[0],be[1],be[2]];let Ae=[0,1,0];const He=Rt([],Ae,Ne);return Rt(Ae,Ne,He),vt(Ae)===0&&(Ae=[0,1,0],Rt(He,Ne,Ae)),ft(He,He),ft(Ae,Ae),ft(Ne,Ne),[He[0],He[1],He[2],0,Ae[0],Ae[1],Ae[2],0,Ne[0],Ne[1],Ne[2],0,be[0],be[1],be[2],1]}(le);Y(F,F,[oe,oe,oe*G]),K(F,F,[-M[0],-M[1],-M[2]]);const me=V([],_.globeMatrix,he);return V(me,me,F),V(me,me,v),me}(c,r,l);if(h>0){const v=function(_,w){const T=w.worldSize,M=pe(1,0)*T*Le(w.center.lat,w.zoom)/NT(T),L=pe(1,w.center.lat)*T,z=N([]);te(z,z,Gt(w.center.lng)),Z(z,z,Gt(w.center.lat)),K(z,z,[0,0,_s]),Y(z,z,[M,M,M*L]);const F=w.point;return K(z,z,[-F.x,-F.y,0]),V(z,z,_),V(z,w.globeMatrix,z)}(c,r);return function(_,w,T){const M=(W,J,oe)=>{const le=Se(W),he=Se(J),me=fd(W,J,oe);return qe(me,me,1/Se(me)*vr(le,he,oe))},L=M([_[0],_[1],_[2]],[w[0],w[1],w[2]],T),z=M([_[4],_[5],_[6]],[w[4],w[5],w[6]],T),F=M([_[8],_[9],_[10]],[w[8],w[9],w[10]],T),G=fd([_[12],_[13],_[14]],[w[12],w[13],w[14]],T);return[L[0],L[1],L[2],0,z[0],z[1],z[2],0,F[0],F[1],F[2],0,G[0],G[1],G[2],1]}(p,v,h)}return p}function u2(c,r,l,h){const p=Ur.projectAabbCorners(h,l);let v=Number.MAX_VALUE;for(let w=0;w<p.length;++w){const T=p[w];T[0]=(.5*T[0]+.5)*r.width,T[1]=(.5-.5*T[1])*r.height,T[2]<v&&(v=T[2])}const _=function(w){const T=[];let M=0;for(let G=1;G<w.length;G++)(w[G][0]<w[M][0]||w[G][0]===w[M][0]&&w[G][1]<w[M][1])&&(M=G);let L,z=M;const F=new Uint8Array(w.length);do{if(F[z])break;T.push(new ut(w[z][0],w[z][1])),F[z]=1,L=(z+1)%w.length;for(let G=0;G<w.length;G++){if(w[G][0]===w[L][0]&&w[G][1]===w[L][1]||w[G][0]===w[z][0]&&w[G][1]===w[z][1])continue;const W=[w[G][0]-w[z][0],w[G][1]-w[z][1]],J=[w[L][0]-w[z][0],w[L][1]-w[z][1]],oe=W[0]*J[1]-W[1]*J[0];(oe>0||oe===0&&W[0]*J[0]+W[1]*J[1]>=0&&W[0]*W[0]+W[1]*W[1]>J[0]*J[0]+J[1]*J[1])&&(L=G)}z=L}while(z!==M);return T.length>0&&T.push(T[0]),T}(p);if(Ro(c,_))return v}const dp=64,vg={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function A1(c,r,l,h,p,v,_,w,T,M=!1){const L=l.zoom,z=l.project(h),F=Le(h.lat,L),G=1/F;N(c),K(c,c,[z.x+_[0]*G,z.y+_[1]*G,_[2]]);let W=1,J=1;const oe=l.worldSize;if(M){if(l.projection.name==="mercator"){let be=0;l.elevation&&(be=l.elevation.getAtPointOrZero(new st(z.x/oe,z.y/oe),0));const Ne=Ut([],[z.x,z.y,be,1],l.projMatrix)[3]/l.cameraToCenterDistance;W=Ne,J=Ne*Le(l.center.lat,L)}else if(l.projection.name==="globe"){const be=R1(c,l),Ne=[0,0,0,1];Ut(Ne,Ne,V([],l.projMatrix,be));const Ae=Ne[3]/l.cameraToCenterDistance,He=Sh(L),Ze=l.projection.pixelsPerMeter(h.lat,oe)*Le(h.lat,L),et=l.projection.pixelsPerMeter(l.center.lat,oe)*Le(l.center.lat,L);W=Ae/vr(Ze,$e(l.center.lat),He),J=Ae*F/Ze,W*=et,J*=et}}else W=G;Y(c,c,[W,W,J]);const le=[...c],he=r.orientation,me=[];if(vz(me,[he[0]+(p?p[0]:0),he[1]+(p?p[1]:0),he[2]+(p?p[2]:0)],v),V(c,le,me),w&&l.elevation){let be=0;const Ne=[];if(T&&l.elevation){be=function(He,Ze,et,Tt,ct){const At=Ze.elevation;if(!At)return 0;const Bt=Ur.projectAabbCorners(et,Tt),qt=pe(1,ct.lat)*Ze.worldSize,cn=function(Sn,vn){const Cr=[0,0,1],xn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const or of xn){const Pr=Sn[or.corners[0]],Gr=Sn[or.corners[1]],pi=Sn[or.corners[2]],Or=[Gr[0]-Pr[0],Gr[1]-Pr[1],vn*(Gr[2]-Pr[2])],bi=Rt(Or,Or,[pi[0]-Pr[0],pi[1]-Pr[1],vn*(pi[2]-Pr[2])]);ft(bi,bi),or.dotProductWithUp=Nt(bi,Cr)}return xn.sort((or,Pr)=>or.dotProductWithUp-Pr.dotProductWithUp),xn[0].corners}(Bt,qt),en=Bt[cn[0]],Vt=Bt[cn[1]],Yt=Bt[cn[2]],wt=Bt[cn[3]],_t=At.getAtPointOrZero(new st(en[0]/Ze.worldSize,en[1]/Ze.worldSize),0),Xt=At.getAtPointOrZero(new st(Vt[0]/Ze.worldSize,Vt[1]/Ze.worldSize),0),sn=At.getAtPointOrZero(new st(Yt[0]/Ze.worldSize,Yt[1]/Ze.worldSize),0),Ht=At.getAtPointOrZero(new st(wt[0]/Ze.worldSize,wt[1]/Ze.worldSize),0),An=(_t+Ht)/2,Bn=(Xt+sn)/2;return An>Bn?Xt<sn?M1(He,Vt,wt,en,Xt,Ht,_t,qt):M1(He,Yt,en,wt,sn,_t,Ht,qt):_t<Ht?M1(He,en,Vt,Yt,_t,Xt,sn,qt):M1(He,wt,Yt,Vt,Ht,sn,Xt,qt),Math.max(An,Bn)}(Ne,l,r.aabb,c,h);const Ae=V([],fe([],Ne),me);V(c,le,Ae)}else be=l.elevation.getAtPointOrZero(new st(z.x/oe,z.y/oe),0);be!==0&&(c[14]+=be)}}class _z{constructor(r,l,h,p,v){this.materialOverrides=new Map,this.nodeOverrides=new Map,this.materialOverrideNames=[],this.nodeOverrideNames=[],this.featureProperties={},this.id=r,this.uri=l,this.position=h!=null?new q(h[0],h[1]):new q(0,0),this.orientation=p??[0,0,0],this.nodes=v,this.uploaded=!1,this.aabb=new Ur([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(r,l){V(r.globalMatrix,l,r.localMatrix);const h=this.nodeOverrides.get(r.name);if(h!==void 0){const _=[];v=h.orientation,N(p=_),te(p,p,Gt(v[1])),ne(p,p,Gt(v[2])),Z(p,p,Gt(v[0])),V(r.globalMatrix,r.globalMatrix,_)}var p,v;if(r.meshes)for(const _ of r.meshes){const w=Ur.applyTransformFast(_.aabb,r.globalMatrix);this.aabb.encapsulate(w)}if(r.children)for(const _ of r.children)this._applyTransformations(_,r.globalMatrix)}computeBoundsAndApplyParent(){const r=N([]);this.aabb=new Ur([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const l of this.nodes)this._applyTransformations(l,r)}computeModelMatrix(r,l,h,p,v,_,w=!1){A1(this.matrix,this,r.transform,this.position,l,h,p,v,_,w)}upload(r){if(!this.uploaded){for(const l of this.nodes)d2(l,r);for(const l of this.nodes)O1(l);this.uploaded=!0}}destroy(){for(const r of this.nodes)h2(r)}}function Dy(c,r,l=!1){c.uploaded||(c.gfxTexture=new l2(r,c.image,l?r.gl.R8:r.gl.RGBA8,{useMipmap:c.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function M7(c,r,l){c.indexBuffer=r.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=r.createVertexBuffer(c.vertexArray,w7.members,!1,!0),c.normalArray&&(c.normalBuffer=r.createVertexBuffer(c.normalArray,T7.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=r.createVertexBuffer(c.texcoordArray,E7.members,!1,!0)),c.colorArray&&(c.colorBuffer=r.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?S7:C7).members,!1,!0)),c.featureArray&&(c.pbrBuffer=r.createVertexBuffer(c.featureArray,P7.members,!0)),c.segments=po.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const h=c.material;h.pbrMetallicRoughness.baseColorTexture&&Dy(h.pbrMetallicRoughness.baseColorTexture,r),h.pbrMetallicRoughness.metallicRoughnessTexture&&Dy(h.pbrMetallicRoughness.metallicRoughnessTexture,r),h.normalTexture&&Dy(h.normalTexture,r),h.occlusionTexture&&Dy(h.occlusionTexture,r,l),h.emissionTexture&&Dy(h.emissionTexture,r)}function d2(c,r,l){if(c.meshes)for(const h of c.meshes)M7(h,r,l);if(c.children)for(const h of c.children)d2(h,r,l)}function O1(c){if(c.meshes)for(const r of c.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(c.children)for(const r of c.children)O1(r)}function h2(c){if(c.meshes)for(const l of c.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((r=l.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(c.children)for(const l of c.children)h2(l)}function hp(c,r){const l=c.json.bufferViews[r.bufferView],h=T1[r.componentType];return new h(c.buffers[l.buffer],(r.byteOffset||0)+(l.byteOffset||0),r.count*(l.byteStride&&l.byteStride!==Ay[r.type]*h.BYTES_PER_ELEMENT?l.byteStride/h.BYTES_PER_ELEMENT:Ay[r.type]))}function f2(c,r,l,h){const p=T1[r.componentType],v=function(L){switch(L){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),_=c.json.bufferViews[r.bufferView],w=_.byteStride?_.byteStride/p.BYTES_PER_ELEMENT:Ay[r.type],T=l.float32,M=T.length/l.capacity;for(let L=0,z=0;L<r.count*w;L+=w,z+=M)for(let F=0;F<M;F++)T[z+F]=h[L+F]*v;l._trim()}function R7(c,r,l){const h=c.indices,p=c.attributes,v={};v.indexArray=new to;const _=r.json.accessors[h],w=_.count/3;v.indexArray.reserve(w);const T=hp(r,_);for(let F=0;F<w;F++)v.indexArray.emplaceBack(T[3*F],T[3*F+1],T[3*F+2]);v.indexArray._trim(),v.vertexArray=new Ks;const M=r.json.accessors[p.POSITION];v.vertexArray.reserve(M.count);const L=hp(r,M);for(let F=0;F<M.count;F++)v.vertexArray.emplaceBack(L[3*F],L[3*F+1],L[3*F+2]);if(v.vertexArray._trim(),v.aabb=new Ur(M.min,M.max),v.centroid=function(F,G){const W=[0,0,0],J=F.length;if(J>0){for(let oe=0;oe<J;oe++){const le=3*F[oe];W[0]+=G[le],W[1]+=G[le+1],W[2]+=G[le+2]}W[0]/=J,W[1]/=J,W[2]/=J}return W}(T,L),p.COLOR_0!==void 0){const F=r.json.accessors[p.COLOR_0],G=Ay[F.type],W=hp(r,F);v.colorArray=G===3?new Ks:new mu,v.colorArray.resize(F.count),f2(r,F,v.colorArray,W)}if(p.NORMAL!==void 0){v.normalArray=new Ks;const F=r.json.accessors[p.NORMAL];v.normalArray.resize(F.count);const G=hp(r,F);f2(r,F,v.normalArray,G)}if(p.TEXCOORD_0!==void 0&&l.length>0){v.texcoordArray=new gu;const F=r.json.accessors[p.TEXCOORD_0];v.texcoordArray.resize(F.count);const G=hp(r,F);f2(r,F,v.texcoordArray,G)}if(p._FEATURE_ID_RGBA4444!==void 0){const F=r.json.accessors[p._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(v.featureData=hp(r,F))}p._FEATURE_RGBA4444!==void 0&&(v.featureData=new Uint32Array(hp(r,r.json.accessors[p._FEATURE_RGBA4444]).buffer));const z=c.material;return v.material=function(F,G){const{emissiveFactor:W=[0,0,0],alphaMode:J="OPAQUE",alphaCutoff:oe=.5,normalTexture:le,occlusionTexture:he,emissiveTexture:me,doubleSided:be,name:Ne}=F,{baseColorFactor:Ae=[1,1,1,1],metallicFactor:He=1,roughnessFactor:Ze=1,baseColorTexture:et,metallicRoughnessTexture:Tt}=F.pbrMetallicRoughness||{},ct=he?G[he.index]:void 0;if(he&&he.extensions&&he.extensions.KHR_texture_transform&&ct){const At=he.extensions.KHR_texture_transform;ct.offsetScale=[At.offset[0],At.offset[1],At.scale[0],At.scale[1]]}return{name:Ne,pbrMetallicRoughness:{baseColorFactor:new Mi(...Ae),metallicFactor:He,roughnessFactor:Ze,baseColorTexture:et?G[et.index]:void 0,metallicRoughnessTexture:Tt?G[Tt.index]:void 0},doubleSided:be,emissiveFactor:new Mi(...W),alphaMode:J,alphaCutoff:oe,normalTexture:le?G[le.index]:void 0,occlusionTexture:ct,emissionTexture:me?G[me.index]:void 0,defined:F.defined===void 0}}(z!==void 0?r.json.materials[z]:{defined:!1},l),v}function yz(c,r,l){const{matrix:h,rotation:p,translation:v,scale:_,mesh:w,extras:T,children:M,name:L}=c,z={};if(z.name=L,z.localMatrix=h||function(F,G,W,J){var oe=G[0],le=G[1],he=G[2],me=G[3],be=oe+oe,Ne=le+le,Ae=he+he,He=oe*be,Ze=oe*Ne,et=oe*Ae,Tt=le*Ne,ct=le*Ae,At=he*Ae,Bt=me*be,qt=me*Ne,cn=me*Ae,en=J[0],Vt=J[1],Yt=J[2];return F[0]=(1-(Tt+At))*en,F[1]=(Ze+cn)*en,F[2]=(et-qt)*en,F[3]=0,F[4]=(Ze-cn)*Vt,F[5]=(1-(He+At))*Vt,F[6]=(ct+Bt)*Vt,F[7]=0,F[8]=(et+qt)*Yt,F[9]=(ct-Bt)*Yt,F[10]=(1-(He+Tt))*Yt,F[11]=0,F[12]=W[0],F[13]=W[1],F[14]=W[2],F[15]=1,F}([],p||[0,0,0,1],v||[0,0,0],_||[1,1,1]),z.globalMatrix=B(z.localMatrix),w!==void 0){z.meshes=l[w];const F=z.anchor=[0,0];for(const G of z.meshes){const{min:W,max:J}=G.aabb;F[0]+=W[0]+J[0],F[1]+=W[1]+J[1]}F[0]=Math.floor(F[0]/z.meshes.length/2),F[1]=Math.floor(F[1]/z.meshes.length/2)}if(T&&(T.id&&(z.id=T.id),T.lights&&(z.lights=function(F){if(!F.length)return[];const G=function(he){const me=atob(he),be=new Uint8Array(me.length);for(let Ne=0;Ne<me.length;Ne++)be[Ne]=me.codePointAt(Ne);return be}(F),W=[],J=G.length/24,oe=new Uint16Array(G.buffer),le=new Float32Array(G.buffer);for(let he=0;he<J;he++){const me=oe[2*he*6]/30,be=oe[2*he*6+1]/30,Ne=oe[2*he*6+10]/100,Ae=le[6*he+1],He=le[6*he+2],Ze=le[6*he+3],et=le[6*he+4],Tt=Ze-Ae,ct=et-He,At=Math.hypot(Tt,ct);W.push({pos:[Ae+.5*Tt,He+.5*ct,be],normal:[ct/At,-Tt/At,0],width:At,height:me,depth:Ne,points:[Ae,He,Ze,et]})}return W}(T.lights)),T.MAPBOX_geometry_bloom&&(z.isGeometryBloom=T.MAPBOX_geometry_bloom)),M){const F=[];for(const G of M)F.push(yz(r.json.nodes[G],r,l));z.children=F}return z}function A7(c){if(c.vertices.length===0||c.indices.length===0)return null;const r=new _1(c.vertices,c.indices,8,256),[l,h]=[r.min.clone(),r.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:r,min:l,max:h}}function O7(c){if(!c.extras||!c.extras.ground)return null;const r=c.extras.ground;if(!r||!Array.isArray(r)||r.length===0)return null;const l=r[0];if(!l||!Array.isArray(l)||l.length===0)return null;const h=[];for(const _ of l){if(!Array.isArray(_)||_.length!==2)continue;const w=_[0],T=_[1];typeof w=="number"&&typeof T=="number"&&h.push(new ut(w,T))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let p=0;for(let _=0;_<h.length;_++){const w=h[_],T=h[(_+1)%h.length],M=h[(_+2)%h.length];p+=(w.x-T.x)*(M.y-T.y)-(M.x-T.x)*(w.y-T.y)}p>0&&h.reverse();const v=dg(h.flatMap(_=>[_.x,_.y]),[]);return v.length===0?null:{vertices:h,indices:v}}function D7(c,r){const l=[],h=[];let p=0;const v=[];for(const _ of c){p=l.length;const w=_.vertexArray.float32,T=_.indexArray.uint16;for(let M=0;M<_.vertexArray.length;M++)v[0]=w[3*M+0],v[1]=w[3*M+1],v[2]=w[3*M+2],yt(v,v,r),l.push(new ut(v[0],v[1]));for(let M=0;M<3*_.indexArray.length;M++)h.push(T[M]+p)}if(h.length%3!=0)return null;for(let _=0;_<h.length;_+=3){const w=l[h[_+0]],T=l[h[_+1]],M=l[h[_+2]];(w.x-T.x)*(M.y-T.y)-(M.x-T.x)*(w.y-T.y)>0&&([h[_+1],h[_+2]]=[h[_+2],h[_+1]])}return{vertices:l,indices:h}}function p2(c){const r=function(T,M){const L=[],z=WebGL2RenderingContext;if(T.json.textures)for(const F of T.json.textures){const G={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};F.sampler!==void 0&&Object.assign(G,T.json.samplers[F.sampler]),L.push({image:M[F.source],sampler:G,uploaded:!1})}return L}(c,c.images),l=function(T,M){const L=[];for(const z of T.json.meshes){const F=[];for(const G of z.primitives)F.push(R7(G,T,M));L.push(F)}return L}(c,r),{scenes:h,scene:p,nodes:v}=c.json,_=h?h[p||0].nodes:[...v.keys()],w=[];for(const T of _)w.push(yz(v[T],c,l));return function(T,M,L){const z={},F=new Set;for(let G=0;G<T.length;G++){const W=L[M[G]];if(!W.extras)continue;const J=W.extras["mapbox:footprint:version"],oe=W.extras["mapbox:footprint:id"];(J||oe)&&F.add(G),J==="1.0.0"&&oe&&(z[oe]=G)}for(let G=0;G<T.length;G++){if(F.has(G))continue;const W=T[G],J=L[M[G]];if(!J.extras)continue;let oe=null;W.id in z&&(oe=D7(T[z[W.id]].meshes,W.localMatrix)),oe||(oe=O7(J)),oe&&(W.footprint=A7(oe))}if(F.size>0){const G=Array.from(F.values()).sort((W,J)=>W-J);for(let W=G.length-1;W>=0;W--)T.splice(G[W],1)}}(w,_,c.json.nodes),w}function L7(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const r=c.vertexArray.float32,l=c.aabb.min[0]-1,h=c.aabb.min[1]-1,p=dp/(c.aabb.max[0]-l+2),v=dp/(c.aabb.max[1]-h+2);for(let _=0;_<r.length;_+=3){const w=r[_+2],T=(r[_+0]-l)*p|0,M=(r[_+1]-h)*v|0;w>c.heightmap[M*dp+T]&&(c.heightmap[M*dp+T]=w)}}function xz(c,r,l,h,p){l.reserve(l.length+4*c.length),h.reserve(h.length+10*c.length),p.reserve(p.length+10*c.length);let v=h.length;for(const _ of c){const w=Math.min(10,Math.max(4,1.3*_.height))*r,T=[-_.normal[1],_.normal[0],0],M=Math.min(.29,.1*_.width/_.depth),L=_.width-2*_.depth*r*(M+.01),z=at([],_.pos,T,L/2),F=at([],_.pos,T,-L/2),G=[z[0],z[1],z[2]+_.height],W=[F[0],F[1],F[2]+_.height],J=at([],_.normal,T,M);qe(J,J,w);const oe=at([],_.normal,T,-M);qe(oe,oe,w),ze(J,z,J),ze(oe,F,oe),z[2]+=.1,F[2]+=.1,h.emplaceBack(J[0],J[1],J[2]),h.emplaceBack(oe[0],oe[1],oe[2]),h.emplaceBack(z[0],z[1],z[2]),h.emplaceBack(F[0],F[1],F[2]),h.emplaceBack(G[0],G[1],G[2]),h.emplaceBack(W[0],W[1],W[2]),h.emplaceBack(z[0],z[1],z[2]),h.emplaceBack(F[0],F[1],F[2]),h.emplaceBack(J[0],J[1],J[2]),h.emplaceBack(oe[0],oe[1],oe[2]);const le=L/w/2;p.emplaceBack(-le-M,-1,le,.8),p.emplaceBack(le+M,-1,le,.8),p.emplaceBack(-le,0,le,1.3),p.emplaceBack(le,0,le,1.3),p.emplaceBack(le+M,-.8,le,.7),p.emplaceBack(le+M,-.8,le,.7),p.emplaceBack(0,0,le,1.3),p.emplaceBack(0,0,le,1.3),p.emplaceBack(le+M,-1.2,le,.8),p.emplaceBack(le+M,-1.2,le,.8),l.emplaceBack(6+v,4+v,8+v),l.emplaceBack(7+v,9+v,5+v),l.emplaceBack(0+v,1+v,2+v),l.emplaceBack(1+v,3+v,2+v),v+=10}}function z7(c,r){const l={};l.indexArray=new to,l.vertexArray=new Ks,l.colorArray=new mu,xz(c,r,l.indexArray,l.vertexArray,l.colorArray);const h={defined:!0};h.emissiveFactor=Mi.black;const p={};return p.baseColorFactor=Mi.white,h.pbrMetallicRoughness=p,l.material=h,l.aabb=new Ur([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}const bz=Zr([{name:"a_pos_3f",components:3,type:"Float32"}]),k7=Zr([{name:"a_normal_3",components:3,type:"Int16"}]),F7=Zr([{name:"a_centroid_3",components:3,type:"Int16"}]),wz=Zr([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),N7=Zr([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),B7=Zr([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),$7=Zr([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),j7=Zr([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),V7=Zr([{name:"a_flood_light_wall_radius_1i16",components:1,type:"Uint16"}]),Sz=Kt.types,D1=32767;function U7(c,r){const l=fn+r;for(const h of c)for(const p of h)if(p.x<-r||p.x>l||p.y<-r||p.y>l)return!1;return!0}class Cz{constructor(){this.layoutVertexArray=new Ks,this.layoutAttenuationArray=new mu,this.layoutColorArray=new yl,this.indexArray=new to,this.indexArrayForConflation=new to,this.segmentsBucket=new po}}class m2{constructor(){this.layoutVertexArray=new Ks,this.layoutNormalArray=new cd,this.layoutCentroidArray=new cd,this.layoutColorArray=new yl,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutFloodLightDataArray=new tg,this.layoutAOArray=new Pc,this.indexArray=new to,this.indexArrayForConflation=new to,this.segmentsBucket=new po,this.entranceBloom=new Cz}}class Ez{constructor(r){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new m2,this.buildingWithFacade=new m2,this.indexArrayForConflationUploaded=!1,this.featureFootprintLookup=new Map,this.footprintLookup={},this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.hasPattern=!1,this.worldview=r.worldview,this.lut=r.lut,this.buildingWithFacade.layoutFacadePaintArray=new yl,this.buildingWithFacade.layoutFacadeDataArray=new ud,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new yl,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=r.projection,this.groundEffect=new QT(r),this.groundEffect.groundRadiusArray=new Pc,this.hasAppearances=null}updateFootprints(r,l){for(const h of this.footprints)l.push({footprint:h,id:r})}updateAppearances(r,l,h,p){}prepare(){return function(){if(E1!=null||iz!=null)return null;if(gg!=null)return gg;const r=fetch(li.BUILDING_GEN_URL);return gg=function(l){let h,p,v,_;function w(){h=new Uint8Array(_.buffer),p=new Int32Array(_.buffer),v=new Float32Array(_.buffer)}function T(){throw new Error("Unexpected BuildingGen error.")}const M=()=>{},L={a:{a:T,f:function(z){const F=h.length,G=Math.max(z>>>0,Math.ceil(1.2*F)),W=Math.ceil((G-F)/65536);try{return _.grow(W),w(),!0}catch{return!1}},g:T,b:M,c:M,d:M,e:M}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(l,L):l.then(z=>z.arrayBuffer()).then(z=>WebAssembly.instantiate(z,L))).then(z=>{const F=z.instance.exports;return(0,F.g)(),_=F.f,w(),new m7({setStyle:F.h,setAOOptions:F.i,setMetricOptions:F.j,setStructuralOptions:F.k,setFacadeOptions:F.l,setFauxFacadeOptions:F.m,setFacadeClassifierOptions:F.n,addFeature:F.o,addFacade:F.p,generateMesh:F.q,getLastError:F.r,getOuterRingLength:F.s,getMeshCount:F.t,getPositionsPtr:F.u,getPositionsLength:F.v,getNormalsPtr:F.w,getNormalsLength:F.x,getColorsPtr:F.y,getColorsLength:F.z,getAOPtr:F.A,getAOLength:F.B,getUVPtr:F.C,getUVLength:F.D,getFauxFacadePtr:F.E,getFauxFacadeLength:F.F,getIndicesPtr:F.G,getIndicesLength:F.H,getBuildingPart:F.I,getRingCount:F.J,getRingPtr:F.K,getRingLength:F.L,free:F.M,malloc:F.N,heapU8:h,heap32:p,heapF32:v})})}(r).then(l=>(gg=null,E1=l,E1)).catch(l=>{jt("Could not load building-gen"),gg=null,iz=l}),gg}()}populate(r,l,h,p){const v=g7();if(!v)return;const _=Ve(h);this.tileToMeter=_,this.brightness=l.brightness,v.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,_],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:_,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),v.setAOOptions(!1,.3),v.setMetricOptions(!1,16),v.setStructuralOptions(!0),v.setFacadeClassifierOptions(3);const w=new Map,T=new Map;for(const{feature:M}of r){if(Sz[M.type]!=="LineString"){w.set(M.id,M.properties.source_id);continue}const L=this.layers[0]._featureFilter.needGeometry,z=gt(M,L);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom),z,h))continue;const F=L?z.geometry:kt(M,h,p),G=[];for(const le of F)for(const he of le)G.push({x:he.x,y:he.y});const W={coordinates:G,crossPerc:M.properties.cross_perc,distanceToRoad:M.properties.distance_to_road,entrances:M.properties.entrances,sourceId:0},J=M.properties.source_id;let oe=T.get(J);oe||(oe=[],T.set(J,oe)),oe.push(W)}this.maxHeight=0;for(const{feature:M,id:L,index:z,sourceLayerIndex:F}of r){if(Sz[M.type]==="LineString")continue;const G=this.layers[0]._featureFilter.needGeometry,W=gt(M,G);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom),W,h))continue;const J=G?W.geometry:kt(M,h,p),oe=wy(J,500);if(!U7(J,163))continue;const le=this.layers[0],he=le.layout.get("building-roof-shape").evaluate(M,{},h);if(he==="flat")continue;const me=le.layout.get("building-base").evaluate(M,{},h),be=le.layout.get("building-height").evaluate(M,{},h),Ne=le.layout.get("building-flood-light-ground-radius").evaluate(M,{},h),Ae=le.paint.get("building-ambient-occlusion-intensity"),He=Ne/this.tileToMeter;let Ze=le.layout.get("building-flood-light-wall-radius").evaluate(M,{},h);Ze=ie(Ze,0,2048);const et=Ze/2048*D1,Tt=w.get(L);let ct;ct=T.has(Tt)?T.get(Tt):[];const At=ct.length!==0&&le.layout.get("building-facade").evaluate(M,{},h);v.setFacadeOptions(4,!0),v.setFauxFacadeOptions(At,!1,1);let Bt=0,qt=0,cn=0,en=0,Vt=0,Yt=0;if(At){let Dt=Math.round(le.layout.get("building-facade-floors").evaluate(M,{},h));if(me===0){Dt=Math.max(1,Dt-(ct.length>0?1:0));let Wn=4;if(be>100){const Gn=[10,13,15];Wn=Gn[M.id?M.id%Gn.length:0],v.setFacadeOptions(Wn,!0)}Vt=1.6803*Wn/_}else Vt=me/_;Yt=be/_,Vt=Math.min(Vt,Yt),cn=le.layout.get("building-facade-unit-width").evaluate(M,{},h)/_,en=(Yt-Vt)/Dt,v.setFauxFacadeOptions(!0,!0,cn);const _n=le.layout.get("building-facade-window").evaluate(M,{},h);Bt=_n[0],qt=_n[1]}const wt=[],_t=new ut(1/0,1/0),Xt=new ut(-1/0,-1/0),sn=new ut(0,0);let Ht=0;for(const Dt of oe)if(Dt.length>0){const _n=[];for(const Wn of Dt){const Gn=[];for(let Lr=Wn.length-1;Lr>=0;Lr--){const dr=Wn[Lr];Gn.push({x:dr.x,y:dr.y}),_t.x=Math.min(_t.x,dr.x),_t.y=Math.min(_t.y,dr.y),Xt.x=Math.max(Xt.x,dr.x),Xt.y=Math.max(Xt.y,dr.y),sn.x+=dr.x,sn.y+=dr.y,Ht++}_n.push(Gn)}wt.push({id:M.id?M.id:0,height:be,minHeight:me,sourceId:0,roofType:he,coordinates:_n})}sn.x/=Ht||1,sn.y/=Ht||1;const An=v.generateMesh(wt,ct);if(typeof An=="string"){jt(`Unable to generate building ${M.id}: ${An}`);continue}if(An.meshes.length===0||An.modifiedPolygonRings.length===0)continue;let Bn=0;for(const Dt of An.meshes)Bn+=Dt.positions.length/3;const Sn=At?this.buildingWithFacade:this.buildingWithoutFacade,vn=Sn.segmentsBucket.prepareSegment(Bn,Sn.layoutVertexArray,Sn.indexArray),Cr=[];let xn=null,or=0,Pr=-1;const Gr=Sn.layoutVertexArray.length,pi=Sn.indexArray.length;let Or=0;for(const Dt of An.meshes){const _n=Sn.layoutVertexArray.length;if(Dt.buildingPart==="entrance"){const Vn=new Array;for(let hi=0;hi<Dt.positions.length;hi+=12){const Ni=Dt.positions[hi+0],Ri=Dt.positions[hi+1],_o=Dt.positions[hi+3],Zi=Dt.positions[hi+4],Hi=Dt.positions[hi+2],Di=Dt.positions[hi+8]-Hi,Si=1,zr=_o-Ni,Ci=Zi-Ri,Gi=Math.hypot(zr,Ci);Vn.push({pos:[Ni+.5*zr,Ri+.5*Ci,Hi],normal:[Ci/Gi,-zr/Gi,0],width:Gi,height:Di,depth:Si,points:[Ni,Ri,_o,Zi]})}const _i=Sn.entranceBloom.segmentsBucket.prepareSegment(10*Vn.length,Sn.entranceBloom.layoutVertexArray,Sn.entranceBloom.indexArray),Fi=Sn.entranceBloom.layoutVertexArray.length;or=Sn.entranceBloom.indexArray.length,xz(Vn,.5/this.tileToMeter,Sn.entranceBloom.indexArray,Sn.entranceBloom.layoutVertexArray,Sn.entranceBloom.layoutAttenuationArray);const pr=Sn.entranceBloom.layoutVertexArray.length-Fi;Pr=Sn.entranceBloom.indexArray.length-or;for(let hi=0;hi<pr;hi++)Sn.entranceBloom.layoutColorArray.emplaceBack(65535,65535);_i.vertexLength+=pr,_i.primitiveLength+=Pr,xn={part:Dt.buildingPart,vertexOffset:Fi,vertexLength:pr}}for(let Vn=0;Vn<Dt.positions.length;Vn+=3)Or=Math.max(Or,Dt.positions[Vn+2]),Sn.layoutVertexArray.emplaceBack(Dt.positions[Vn],Dt.positions[Vn+1],Dt.positions[Vn+2]);const Wn=Math.floor(sn.x),Gn=Math.floor(sn.y),Lr=Math.floor(Or);for(let Vn=0;Vn<Dt.positions.length;Vn+=3)Sn.layoutCentroidArray.emplaceBack(Wn,Gn,Lr),Sn.layoutFloodLightDataArray.emplaceBack(Dt.buildingPart==="wall"?et:0);for(let Vn=0;Vn<Dt.normals.length;Vn+=3)Sn.layoutNormalArray.emplaceBack(Dt.normals[Vn+0]*D1,Dt.normals[Vn+1]*D1,Dt.normals[Vn+2]*D1);for(let Vn=0;Vn<Dt.ao.length;Vn++)Sn.layoutAOArray.emplaceBack(Dt.ao[Vn]);for(let Vn=0;Vn<Dt.colors.length;Vn+=3){const _i=1+(Dt.ao[Vn/3]-1)*Ae;Sn.layoutColorArray.emplaceBack(Dt.colors[Vn]*_i<<8|Dt.colors[Vn+1]*_i,Dt.colors[Vn+2]*_i<<8)}if(At){for(let Vn=0;Vn<Dt.positions.length;Vn+=3)Sn.layoutFacadePaintArray.emplaceBack(65535,255);for(let Vn=0;Vn<Dt.isFauxFacade.length;Vn++)if(Dt.isFauxFacade[Vn]){const _i=1|Math.min(65535,Math.floor(Dt.uv[2*Vn]*An.outerRingLength)),Fi=Math.floor(255*Bt)<<8|Math.floor(255*qt),pr=Math.floor(65535*Math.min(1,cn/fn)),hi=Math.floor(65535*Math.min(1,en/fn));Sn.layoutFacadeDataArray.emplaceBack(_i,Fi,pr,hi);const Ni=Math.floor(65535*Math.min(1,Vt/fn)),Ri=Math.floor(65535*Math.min(1,Yt/fn));Sn.layoutFacadeVerticalRangeArray.emplaceBack(Ni,Ri)}else Sn.layoutFacadeDataArray.emplaceBack(0,0,0,0),Sn.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const dr=vn.vertexLength;for(let Vn=0;Vn<Dt.indices.length;Vn+=3)Sn.indexArray.emplaceBack(dr+Dt.indices[Vn],dr+Dt.indices[Vn+1],dr+Dt.indices[Vn+2]);vn.vertexLength+=Dt.positions.length/3,vn.primitiveLength+=Dt.indices.length/3,(Dt.buildingPart==="roof"||Dt.buildingPart==="wall"||Dt.buildingPart==="facade_glazing"||Dt.buildingPart==="entrance")&&Cr.push({part:Dt.buildingPart,vertexOffset:_n,vertexLength:Dt.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,Or),this.buildingFeatures.push({promoteId:L,feature:W,hasFauxFacade:At,segment:vn,parts:Cr,buildingBloom:xn});const bi=Sn.indexArray.length-pi,wi=[],so=[],Oe=new ut(1/0,1/0),Pe=new ut(-1/0,-1/0),Ot=this.groundEffect.vertexArray.length;for(const Dt of An.modifiedPolygonRings){const _n=[],Wn=new ut(1/0,1/0),Gn=new ut(-1/0,-1/0);for(let Lr=0;Lr<Dt.length;Lr+=2){const dr=Dt.length-Lr-2;Wn.x=Math.min(Wn.x,Dt[dr]),Wn.y=Math.min(Wn.y,Dt[dr+1]),Gn.x=Math.max(Gn.x,Dt[dr]),Gn.y=Math.max(Gn.y,Dt[dr+1]);const Vn=new ut(Dt[dr],Dt[dr+1]);_n.push(Vn),wi.push(Vn.x,Vn.y),so.push(Vn.clone())}Oe.x=Math.min(Oe.x,Wn.x),Oe.y=Math.min(Oe.y,Wn.y),Pe.x=Math.max(Pe.x,Gn.x),Pe.y=Math.max(Pe.y,Gn.y),this.groundEffect.addData(_n,[Wn,Gn],He)}const gn=this.groundEffect.vertexArray.length-Ot;for(let Dt=0;Dt<gn;Dt++)this.groundEffect.groundRadiusArray.emplaceBack(Ne);(_t.x<0||Xt.x>fn||_t.y<0||Xt.y>fn)&&this.featuresOnBorder.push({featureId:M.id,footprintIndex:this.footprints.length});{const Dt=dg(wi,null,2),_n=new _1(so,Dt,8,256);let Wn=M.id;M.properties&&M.properties.hasOwnProperty("building_id")&&(Wn=M.properties.building_id);const Gn={vertices:so,indices:Dt,grid:_n,min:Oe,max:Pe,buildingId:Wn,hiddenFlags:0,indicesOffset:pi,indicesLength:bi,bloomIndicesOffset:or,bloomIndicesLength:Pr,groundEffectVertexOffset:Ot,groundEffectVertexLength:gn,hasFauxFacade:At,segment:vn,height:Or};M.id!==void 0&&this.featureFootprintLookup.set(M.id,this.footprints.length),this.footprints.push(Gn)}this.programConfigurations.populatePaintArrays(Sn.layoutVertexArray.length,M,z,{},l.availableImages,h,l.brightness),this.groundEffect.addPaintPropertiesData(M,z,{},l.availableImages,h,l.brightness),l.featureIndex.insert(M,J,z,F,this.index,Gr)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(r,l,h,p,v,_,w){this.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w),this.groundEffect.update(r,l,v,h,p,_,w),this.evaluate(this.layers[0],r),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){const l=h=>{h.layoutVertexBuffer=r.createVertexBuffer(h.layoutVertexArray,bz.members),h.layoutNormalBuffer=r.createVertexBuffer(h.layoutNormalArray,k7.members),h.layoutCentroidBuffer=r.createVertexBuffer(h.layoutCentroidArray,F7.members),h.layoutFloodLightDataBuffer=r.createVertexBuffer(h.layoutFloodLightDataArray,V7.members),h.layoutFacadeDataArray&&h.layoutFacadeDataArray.length&&(h.layoutFacadeDataBuffer=r.createVertexBuffer(h.layoutFacadeDataArray,B7.members)),h.layoutFacadeVerticalRangeArray&&h.layoutFacadeVerticalRangeArray.length&&(h.layoutFacadeVerticalRangeBuffer=r.createVertexBuffer(h.layoutFacadeVerticalRangeArray,$7.members)),h.entranceBloom.layoutVertexArray.length&&(h.entranceBloom.layoutVertexBuffer=r.createVertexBuffer(h.entranceBloom.layoutVertexArray,bz.members),h.entranceBloom.layoutAttenuationBuffer=r.createVertexBuffer(h.entranceBloom.layoutAttenuationArray,j7.members)),this.uploadUpdatedColorBuffer(r),this.uploadUpdatedIndexBuffer(r)};this.uploaded||(l(this.buildingWithoutFacade),l(this.buildingWithFacade),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){const r=l=>{l.layoutVertexBuffer&&(l.layoutVertexBuffer.destroy(),l.layoutNormalBuffer.destroy(),l.layoutColorBuffer.destroy(),l.segmentsBucket.destroy(),l.indexBuffer&&l.indexBuffer.destroy(),l.entranceBloom.layoutVertexBuffer&&(l.entranceBloom.layoutVertexBuffer.destroy(),l.entranceBloom.layoutColorBuffer.destroy(),l.entranceBloom.layoutAttenuationBuffer.destroy(),l.entranceBloom.indexBuffer.destroy(),l.entranceBloom.segmentsBucket.destroy()))};r(this.buildingWithoutFacade),r(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(r,l,h=!0){let p=!1;const v=h?l:0,_=0|(h?-1:~l);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const w of r){const T=this.footprints[w],M=T.hiddenFlags&_|v;T.hiddenFlags!==M&&(T.hiddenFlags=M,p=!0,this.groundEffect.updateHiddenByLandmarkRange(T.groundEffectVertexOffset,T.groundEffectVertexLength,T.hiddenFlags!==0))}return p&&(this.indexArrayForConflationUploaded=!1),p}uploadUpdatedIndexBuffer(r){if(this.groundEffect.uploadHiddenByLandmark(r),this.indexArrayForConflationUploaded)return;const l=p=>{p.indexArray.length!==0&&(p.indexArrayForConflation.resize(p.indexArray.length),p.indexArrayForConflation.uint16.set(p.indexArray.uint16),p.entranceBloom.indexArrayForConflation.resize(p.entranceBloom.indexArray.length),p.entranceBloom.indexArrayForConflation.uint16.set(p.entranceBloom.indexArray.uint16))};l(this.buildingWithoutFacade),l(this.buildingWithFacade);for(const p of this.footprints){const v=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,_=p.indicesOffset+p.indicesLength;if(p.hiddenFlags!==0){for(let T=p.indicesOffset;T<_;T++)v.indexArrayForConflation.uint16[3*T+0]=0,v.indexArrayForConflation.uint16[3*T+1]=0,v.indexArrayForConflation.uint16[3*T+2]=0;const w=p.bloomIndicesOffset+p.bloomIndicesLength;for(let T=p.bloomIndicesOffset;T<w;T++)v.entranceBloom.indexArrayForConflation.uint16[3*T+0]=0,v.entranceBloom.indexArrayForConflation.uint16[3*T+1]=0,v.entranceBloom.indexArrayForConflation.uint16[3*T+2]=0}}const h=p=>{p.indexArray.length!==0&&(p.indexBuffer?p.indexBuffer.updateData(p.indexArrayForConflation):p.indexBuffer=r.createIndexBuffer(p.indexArrayForConflation,!0),p.entranceBloom.indexBuffer?p.entranceBloom.indexBuffer.updateData(p.entranceBloom.indexArrayForConflation):p.entranceBloom.indexBuffer=r.createIndexBuffer(p.entranceBloom.indexArrayForConflation,!0))};h(this.buildingWithoutFacade),h(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(r){const l=h=>{h.layoutColorBuffer?h.layoutColorBuffer.updateData(h.layoutColorArray):h.layoutColorBuffer=r.createVertexBuffer(h.layoutColorArray,wz.members,!0),h.layoutFacadePaintArray&&(h.layoutFacadePaintBuffer?h.layoutFacadePaintBuffer.updateData(h.layoutFacadePaintArray):h.layoutFacadePaintBuffer=r.createVertexBuffer(h.layoutFacadePaintArray,N7.members,!0)),h.entranceBloom.layoutColorBuffer?h.entranceBloom.layoutColorBuffer.updateData(h.entranceBloom.layoutColorArray):h.entranceBloom.layoutColorBuffer=r.createVertexBuffer(h.entranceBloom.layoutColorArray,wz.members,!0)};l(this.buildingWithoutFacade),l(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(r,l){const h=r.paint.get("building-ambient-occlusion-intensity");for(const p of this.buildingFeatures){const v=l[p.promoteId],_=p.feature;_.properties["building-part"]="roof";const w=r.paint.get("building-color").evaluate(_,v,this.canonical).toPremultipliedRenderColor(this.lut),T=r.paint.get("building-emissive-strength").evaluate(_,v,this.canonical);_.properties["building-part"]="wall";const M=r.paint.get("building-color").evaluate(_,v,this.canonical).toPremultipliedRenderColor(this.lut),L=r.paint.get("building-emissive-strength").evaluate(_,v,this.canonical);_.properties["building-part"]="window";const z=r.paint.get("building-color").evaluate(_,v,this.canonical).toPremultipliedRenderColor(this.lut),F=r.paint.get("building-emissive-strength").evaluate(_,v,this.canonical);_.properties["building-part"]="door";const G=r.paint.get("building-color").evaluate(_,v,this.canonical).toPremultipliedRenderColor(this.lut),W=r.paint.get("building-emissive-strength").evaluate(_,v,this.canonical),J=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const le of p.parts){let he,me=w;le.part==="roof"?(me=w,he=T):le.part==="wall"?(me=M,he=L):le.part==="facade_glazing"?(me=z,he=F):le.part==="entrance"&&(me=G,he=W),he=ie(he,0,1);for(let be=0;be<le.vertexLength;be++){const Ne=le.vertexOffset+be,Ae=1+(J.layoutAOArray.float32[Ne]-1)*h;J.layoutColorArray.emplace(Ne,me.r*Ae*255<<8|me.g*Ae*255,me.b*Ae*255<<8|255*he),p.hasFauxFacade&&J.layoutFacadePaintArray.emplace(Ne,255*z.r<<8|255*z.g,255*z.b<<8|255*F)}}const oe=p.buildingBloom;if(oe)for(let le=0;le<oe.vertexLength;le++)J.entranceBloom.layoutColorArray.emplace(oe.vertexOffset+le,255*G.r<<8|255*G.g,255*G.b<<8|51*W)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(r,l,h){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(r.toUnwrapped());if(x1(this.activeReplacements,p))return;this.activeReplacements=p;for(const _ of this.footprints)_.hiddenFlags&=-2;const v=[];for(const _ of this.activeReplacements){if(_.order<=TL)continue;const w=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-r.canonical.z));for(const T of this.footprints)T.min.x>_.max.x||T.max.x<_.min.x||T.min.y>_.max.y||T.max.y<_.min.y||(v.length=0,H7(T.vertices,0,T.vertices.length,_.footprintTileId.canonical,r.canonical,v),XT(_.footprint,v,T.indices,0,T.indices.length,0,-w)&&(T.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const _ of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(_.groundEffectVertexOffset,_.groundEffectVertexLength,_.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getFootprint(r){if(r.id!==void 0){const l=this.featureFootprintLookup.get(r.id);return this.footprints[l]}return null}getHeightAtTileCoord(r,l){let h=Number.NEGATIVE_INFINITY,p=!0;const v=4*(r+fn)*fn+(l+fn);if(this.footprintLookup.hasOwnProperty(v)){const w=this.footprintLookup[v];return w?{height:w.height,hidden:w.hiddenFlags!==0}:void 0}const _=new ut(r,l);for(const w of this.footprints)r>w.max.x||w.min.x>r||l>w.max.y||w.min.y>l||w.height<=h||ZT(_,w)&&(h=w.height,this.footprintLookup[v]=w,p=w.hiddenFlags!==0);if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:p};this.footprintLookup[v]=void 0}}function H7(c,r,l,h,p,v){const _=Math.pow(2,h.z-p.z);for(let w=0;w<l;w++){let T=c[w+r].x,M=c[w+r].y;T=(T+p.x*fn)*_-h.x*fn,M=(M+p.y*fn)*_-h.y*fn,v.push(new ut(T,M))}}let Tz,Iz;Dn(Ez,"BuildingBucket",{omit:["layers"]}),Dn(m2,"BuildingGeometry"),Dn(Cz,"BuildingBloomGeometry");const G7=Zr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),W7=Zr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:q7}=G7,K7=Zr([{name:"a_packed",components:3,type:"Float32"}]),{members:X7}=K7,Z7=Zr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Y7}=Z7;class Pz{constructor(r,l){this.width=r,this.height=l,this.nextRow=0,this.image=new Ch({width:r,height:l}),this.positions={},this.uploaded=!1}getDash(r,l){const h=this.getKey(r,l);return this.positions[h]}trim(){const r=this.width,l=this.height=Ye(this.nextRow);this.image.resize({width:r,height:l})}getKey(r,l){return r.join(",")+l}getDashRanges(r,l,h){const p=[];let v=r.length%2==1?-r[r.length-1]*h:0,_=r[0]*h,w=!0;p.push({left:v,right:_,isDash:w,zeroLength:r[0]===0});let T=r[0];for(let M=1;M<r.length;M++){w=!w;const L=r[M];v=T*h,T+=L,_=T*h,p.push({left:v,right:_,isDash:w,zeroLength:L===0})}return p}addRoundDash(r,l,h){const p=l/2;for(let v=-h;v<=h;v++){const _=this.width*(this.nextRow+h+v);let w=0,T=r[w];for(let M=0;M<this.width;M++){M/T.right>1&&(T=r[++w]);const L=Math.abs(M-T.left),z=Math.abs(M-T.right),F=Math.min(L,z);let G;const W=v/h*(p+1);if(T.isDash){const J=p-Math.abs(W);G=Math.sqrt(F*F+J*J)}else G=p-Math.sqrt(F*F+W*W);this.image.data[_+M]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(r,l){for(let T=r.length-1;T>=0;--T){const M=r[T],L=r[T+1];M.zeroLength?r.splice(T,1):L&&L.isDash===M.isDash&&(L.left=M.left,r.splice(T,1))}const h=r[0],p=r[r.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const v=this.width*this.nextRow;let _=0,w=r[_];for(let T=0;T<this.width;T++){T/w.right>1&&(w=r[++_]);const M=Math.abs(T-w.left),L=Math.abs(T-w.right),z=Math.min(M,L);this.image.data[v+T]=Math.max(0,Math.min(255,(w.isDash?z:-z)+l+128))}}addDash(r,l){const h=this.getKey(r,l);if(this.positions[h])return this.positions[h];const p=l==="round",v=p?7:0,_=2*v+1;if(this.nextRow+_>this.height)return jt("LineAtlas out of space"),null;r.length===0&&r.push(1);let w=0;for(let L=0;L<r.length;L++)r[L]<0&&(jt("Negative value is found in line dasharray, replacing values with 0"),r[L]=0),w+=r[L];if(w!==0){const L=this.width/w,z=this.getDashRanges(r,this.width,L);p?this.addRoundDash(z,L,v):this.addRegularDash(z,l==="square"?.5*L:0)}const T=this.nextRow+v;this.nextRow+=_;const M={tl:[T,v],br:[w,0]};return this.positions[h]=M,M}}Dn(Pz,"LineAtlas");const J7=Kt.types,Q7=Math.cos(Math.PI/180*37.5),e9=Math.cos(Math.PI/180*5);class g2{constructor(r){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=r.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=r.overscaling,this.pixelRatio=r.pixelRatio,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Ym,this.layoutVertexArray2=new Ks,this.patternVertexArray=new Ks,this.indexArray=new to,this.programConfigurations=new Ll(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new po,this.maxLineLength=0,this.zOffsetVertexArray=new Ks,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=r.tessellationStep?r.tessellationStep:fn/64,this.worldview=r.worldview,this.hasAppearances=null}updateFootprints(r,l){}updateAppearances(r,l,h,p){}populate(r,l,h,p){this.hasPattern=UT("line",this.layers,this.pixelRatio,l);const v=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Ve(h);const _=this.layers[0].layout.get("line-elevation-reference");if(_==="hd-road-markup")this.elevationType="road";else{const F=this.layers[0].layout.get("line-z-offset"),G=F.isConstant()&&!F.constantOr(0);this.elevationType=_!=="sea"&&_!=="ground"&&G?"none":"offset",this.elevationType==="offset"&&_==="none"&&jt(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const w=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&w!==void 0;const T=[];for(const{feature:F,id:G,index:W,sourceLayerIndex:J}of r){const oe=this.layers[0]._featureFilter.needGeometry,le=gt(F,oe);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),le,h))continue;const he=v?v.evaluate(le,{},h):void 0,me={id:G,properties:F.properties,type:F.type,sourceLayerIndex:J,index:W,geometry:oe?le.geometry:kt(F,h,p),patterns:{},sortKey:he};T.push(me)}v&&T.sort((F,G)=>F.sortKey-G.sortKey);const{lineAtlas:M,featureIndex:L}=l,z=this.addConstantDashes(M);for(const F of T){const{geometry:G,index:W,sourceLayerIndex:J}=F;if(z&&this.addFeatureDashes(F,M),this.hasPattern){const oe=HT("line",this.layers,F,this.zoom,this.pixelRatio,l);this.patternFeatures.push(oe)}else this.addFeature(F,G,W,h,M.positions,l.availableImages,l.brightness,l.elevationFeatures);L.insert(r[W].feature,G,W,J,this.index)}}addConstantDashes(r){let l=!1;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(p.kind!=="constant"||v.kind!=="constant")l=!0;else{const _=v.value,w=p.value;if(!w)continue;r.addDash(w,_)}}return l}addFeatureDashes(r,l){const h=this.zoom;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,_=p.layout.get("line-cap").value;if(v.kind==="constant"&&_.kind==="constant")continue;let w,T;if(v.kind==="constant"){if(w=v.value,!w)continue}else w=v.evaluate({zoom:h},r);T=_.kind==="constant"?_.value:_.evaluate({zoom:h},r),l.addDash(w,T),r.patterns[p.id]=[l.getKey(w,T)]}}update(r,l,h,p,v,_,w,T){this.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,T)}addFeatures(r,l,h,p,v,_){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,l,h,p,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,X7)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=r.createVertexBuffer(this.patternVertexArray,Y7)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,W7.members,!0)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,q7),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r,l){let h,p;if(l&&l>0?(h=`mapbox_clip_start_${l}`,p=`mapbox_clip_end_${l}`):(h="mapbox_clip_start",p="mapbox_clip_end"),r.properties&&r.properties.hasOwnProperty(h)&&r.properties.hasOwnProperty(p))return{start:+r.properties[h],end:+r.properties[p]}}addFeature(r,l,h,p,v,_,w,T){const M=this.layers[0].layout,L=M.get("line-join").evaluate(r,{}),z=M.get("line-cap").evaluate(r,{}),F=M.get("line-miter-limit"),G=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(r),this.lineFeature=r;const W=!(!r.properties||!r.properties.hasOwnProperty("mapbox_line_metrics"))&&r.properties.mapbox_line_metrics;this.zOffsetValue=M.get("line-z-offset").value;const J=this.layers[0].paint.get("line-width").value;if(J.kind!=="constant"&&J.isLineProgressConstant===!1&&(this.variableWidthValue=J),this.elevationType==="road"){const oe=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(r,l,p,T,L,z,F,G)){const[le,he]=this.clipRuntimeLinesToTile(l,1);for(let me=0;me<le.length;me++){const be=le[me],Ne=he[me],Ae={progress:{min:Ne.progress.min,max:Ne.progress.max},nextDir:this.computeSegNextDir(Ne,be),prevDir:this.computeSegPrevDir(Ne,be)};this.addLine(be,r,p,L,z,F,G,Ae,W&&Ne.parentIndex>0?Ne.parentIndex:null)}this.fillNonElevatedRoadSegment(oe)}}else for(let oe=0;oe<l.length;oe++)this.addLine(l[oe],r,p,L,z,F,G,void 0,W&&oe>0?oe:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,v,_,p,w,void 0,this.worldview)}computeSegNextDir(r,l){return r.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(r,l){return l[1].sub(r.prevPoint).unit()}clipLinesToTile(r,l){return S1(r,-l,-l,fn+l,fn+l)}clipRuntimeLinesToTile(r,l){const h=[];return[S1(r,-l,-l,fn+l,fn+l,h),h]}addElevatedRoadFeature(r,l,h,p,v,_,w,T){const M=[],L=Sr.getElevationFeature(r,p);if(L){const z=this.clipLinesToTile(l,1),F=this.prepareElevatedLines(z,L,h);for(const G of F)M.push({geometry:G,elevation:L,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(M.length===0)return!1;for(const z of M){const F=this.layoutVertexArray.length;this.addLine(z.geometry,r,h,v,_,w,T);const G=new fi(h,z.elevationTileID);if(z.elevation)for(let W=F;W<this.layoutVertexArray.length;W++){const J=new ut(this.layoutVertexArray.int16[6*W]>>1,this.layoutVertexArray.int16[6*W+1]>>1),oe=G.pointElevation(J,z.elevation,.05);this.updateHeightRange(oe),this.zOffsetVertexArray.emplaceBack(oe,0,0)}else this.fillNonElevatedRoadSegment(F)}return!0}prepareElevatedLines(r,l,h){if(l.constantHeight!=null)return r;const p=[],v=1/Ve(h);for(const _ of r)h7(_,new Ki(l,v),0,p);return p}fillNonElevatedRoadSegment(r){for(let l=r;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(r){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,r),this.heightRange.max=Math.max(this.heightRange.max,r)):this.heightRange={min:r,max:r}}addLine(r,l,h,p,v,_,w,T,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=M?this.lineFeatureClips(l,M):this.lineClips;const L=p==="none";this.patternJoinNone=this.hasPattern&&L,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const z=T&&T.progress.min>0,F=T&&T.progress.max<1;if(this.lineClips){let et={min:this.lineClips.start,max:this.lineClips.end},Tt=1;if(T){const Bt=this.lineClips.end-this.lineClips.start;et=function(qt,cn,en){return{min:Qr(qt.min,cn,en),max:Qr(qt.max,cn,en)}}(T.progress,{min:0,max:1},et),Bt>0&&(Tt=(et.max-et.min)/Bt)}const ct=+l.properties.mapbox_clip_feature_len,At=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(ct)||Number.isNaN(At)){for(let qt=0;qt<r.length-1;qt++)this.totalDistance+=r[qt].dist(r[qt+1]);const Bt=this.totalDistance/(et.max-et.min);this.totalFeatureLength=Number.isFinite(Bt)?Bt:0,this.lineClips.start=et.min,this.lineClips.end=et.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=ct,this.distance=At*Tt,this.lineClips.start=et.min,this.lineClips.end=et.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const G=J7[l.type]==="Polygon";let W=r.length;for(;W>=2&&r[W-1].equals(r[W-2]);)W--;let J=0;for(;J<W-1&&r[J].equals(r[J+1]);)J++;if(W<(G?3:2))return;p==="bevel"&&(_=1.05);const oe=this.segments.prepareSegment(10*W,this.layoutVertexArray,this.indexArray);let le,he,me,be,Ne,Ae,He,Ze;T&&T.prevDir&&(Ae=T.prevDir.perp()),T&&T.nextDir&&(He=T.nextDir.perp()),this.e1=this.e2=-1,G&&(le=r[W-2],Ne=r[J].sub(le)._unit()._perp());for(let et=J;et<W;et++){if(me=et===W-1?G?r[J+1]:void 0:r[et+1],me&&r[et].equals(me))continue;Ne&&(be=Ne),le&&(he=le),le=r[et],Ze=this.evaluateLineProgressFeatures(he?he.dist(le):0),Ne=me?me.sub(le)._unit()._perp():be,be=be||Ne;const Tt=he&&me;let ct=Tt?p:G||L?"butt":v;const At=be.x*Ne.x+be.y*Ne.y;if(L){const _t=function(Xt){if(Xt.patternJoinNone){const sn=Xt.segmentPoints.length/2,Ht=Xt.lineSoFar-Xt.segmentStart;for(let An=0;An<sn;++An){const Bn=Xt.segmentPoints[2*An+1],Sn=Math.round(Xt.segmentPoints[2*An])+.5+.25*Bn;Xt.patternVertexArray.emplaceBack(Sn,Ht,Xt.segmentStart),Xt.patternVertexArray.emplaceBack(Sn,Ht,Xt.segmentStart)}Xt.segmentPoints.length=0}Xt.e1=Xt.e2=-1};if(Tt&&At<e9){this.updateDistance(he,le),this.addCurrentVertex(le,be,1,1,oe,Ze),_t(this),this.addCurrentVertex(le,Ne,-1,-1,oe,Ze);continue}if(he){if(!me){this.updateDistance(he,le),this.addCurrentVertex(le,be,1,1,oe,Ze),_t(this);continue}ct="miter"}}let Bt=be.add(Ne);Bt.x===0&&Bt.y===0||Bt._unit();const qt=Bt.x*Ne.x+Bt.y*Ne.y,cn=qt!==0?1/qt:1/0,en=2*Math.sqrt(2-2*qt),Vt=qt<Q7&&he&&me,Yt=be.x*Ne.y-be.y*Ne.x>0,wt=this.overscaling<=16?15*fn/(512*this.overscaling):0;if(Tt&&ct==="round"){if(cn<w)ct="miter";else if(cn<=2){const _t=v2(le,-10,fn+10);ct=this.elevationType==="offset"&&(_t||this.hasCrossSlope)?"miter":"fakeround"}}if(ct==="miter"&&cn>_&&(ct="bevel"),ct==="bevel"&&(cn>2&&(ct="flipbevel"),cn<_&&(ct="miter")),he&&!(ct==="miter"&&Vt)&&this.updateDistance(he,le),ct==="miter")if(Vt){const _t=le.dist(he);if(_t>2*wt){const sn=le.sub(le.sub(he)._mult(wt/_t)._round());this.updateDistance(he,sn),this.addCurrentVertex(sn,be,0,0,oe,Ze),he=sn}this.updateDistance(he,le),Bt._mult(cn),this.addCurrentVertex(le,Bt,0,0,oe,Ze);const Xt=le.dist(me);if(Xt>2*wt){const sn=le.add(me.sub(le)._mult(wt/Xt)._round());this.updateDistance(le,sn),this.addCurrentVertex(sn,Ne,0,0,oe,Ze),le=sn}}else Bt._mult(cn),this.addCurrentVertex(le,Bt,0,0,oe,Ze);else if(ct==="flipbevel"){if(cn>100)Bt=Ne.mult(-1);else{const _t=cn*be.add(Ne).mag()/be.sub(Ne).mag();Bt._perp()._mult(_t*(Yt?-1:1))}this.addCurrentVertex(le,Bt,0,0,oe,Ze),this.addCurrentVertex(le,Bt.mult(-1),0,0,oe,Ze)}else if(ct==="bevel"||ct==="fakeround"){Ze!=null&&he&&this.addCurrentVertex(le,He||be,-1,-1,oe,Ze);const _t=le.dist(he)<=2*wt&&ct!=="bevel",Xt=Bt.mult(Yt?1:-1);Xt._mult(cn);const sn=Ne.mult(Yt?-1:1),Ht=be.mult(Yt?-1:1),An=this.evaluateLineProgressFeatures(this.distance);if(Ze==null&&(this.addHalfVertex(le,Xt.x,Xt.y,!1,!Yt,0,oe,An),_t||this.addHalfVertex(le,Xt.x+2*Ht.x,Xt.y+2*Ht.y,!1,Yt,0,oe,An)),ct==="fakeround"){const Bn=Math.round(180*en/Math.PI/20);this.addHalfVertex(le,Ht.x,Ht.y,!1,Yt,0,oe,An);for(let Sn=0;Sn<Bn;Sn++){let vn=Sn/Bn;if(vn!==.5){const xn=vn-.5;vn+=vn*xn*(vn-1)*((1.0904+At*(At*(3.55645-1.43519*At)-3.2452))*xn*xn+(.848013+At*(.215638*At-1.06021)))}const Cr=sn.sub(Ht)._mult(vn)._add(Ht)._unit();this.addHalfVertex(le,Cr.x,Cr.y,!1,Yt,0,oe,An)}this.addHalfVertex(le,sn.x,sn.y,!1,Yt,0,oe,An)}_t||Ze!=null||this.addHalfVertex(le,Xt.x+2*sn.x,Xt.y+2*sn.y,!1,Yt,0,oe,An),Ze!=null&&me&&this.addCurrentVertex(le,Ae||Ne,1,1,oe,Ze)}else if(ct==="butt")this.addCurrentVertex(le,Bt,0,0,oe,Ze);else if(ct==="square"){if(!he){const _t=z?0:-1;this.addCurrentVertex(le,Bt,_t,_t,oe,Ze)}if(this.addCurrentVertex(le,Bt,0,0,oe,Ze),he){const _t=F?0:1;this.addCurrentVertex(le,Bt,_t,_t,oe,Ze)}}else if(ct==="round"){if(he){const _t=!Tt&&He?He:be;this.addCurrentVertex(le,_t,0,0,oe,Ze),!Tt&&F||this.addCurrentVertex(le,_t,1,1,oe,Ze,!0)}if(me){const _t=!Tt&&Ae?Ae:Ne;!Tt&&z||this.addCurrentVertex(le,_t,-1,-1,oe,Ze,!0),this.addCurrentVertex(le,_t,0,0,oe,Ze)}}}}addVerticesTo(r,l,h,p,v,_,w,T,M,L){const z=(l.w-r.w)/this.tessellationStep|0;let F=0;const G=this.scaledDistance;if(z>1){this.lineSoFar=r.w;const J=(l.x-r.x)/z,oe=(l.y-r.y)/z,le=(l.z-r.z)/z,he=(l.w-r.w)/z;for(let me=1;me<z;++me){r.x+=J,r.y+=oe,r.z+=le,this.lineSoFar+=he,F+=he;const be=this.evaluateLineProgressFeatures(this.prevDistance+F);this.scaledDistance=(this.prevDistance+F)/this.totalDistance,this.addHalfVertex(r,h,p,L,!1,w,M,be),this.addHalfVertex(r,v,_,L,!0,-T,M,be)}}this.lineSoFar=l.w,this.scaledDistance=G;const W=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,h,p,L,!1,w,M,W),this.addHalfVertex(l,v,_,L,!0,-T,M,W)}evaluateLineProgressFeatures(r){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+r)/this.totalFeatureLength):jt(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(r,l,h,p,v,_,w=!1){const T=l.x+l.y*h,M=l.y-l.x*h,L=l.y*p-l.x,z=-l.y-l.x*p;if(_!=null){const F=this.elevationType==="offset",G=-10,W=fn+10,J=_.zOffset,oe=new XL(r.x,r.y,J,this.lineSoFar),le=!!F&&v2(r,G,W),he=this.lineSoFar,me=this.distance;if(this.currentVertex)if(le){const be=this.currentVertexIsOutside,Ne=this.currentVertex,Ae=new XL(r.x,r.y,J,this.lineSoFar);if(YL(Ne,Ae,G,W),!v2(Ae,G,W)){if(be){this.e1=this.e2=-1,this.distance-=Ne.dist(oe),this.lineSoFar=Ne.w;const He=this.evaluateLineProgressFeatures(Ne.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ne,T,M,w,!1,h,v,He),this.addHalfVertex(Ne,L,z,w,!0,-p,v,He),this.prevDistance=this.distance}this.distance=this.prevDistance+Ne.dist(Ae),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ne,Ae,T,M,L,z,h,p,v,w),this.distance=me,this.scaledDistance=this.distance/this.totalDistance}}else{const be=this.currentVertex;if(this.currentVertexIsOutside){YL(be,oe,G,W),this.e1=this.e2=-1,this.distance-=be.dist(oe),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=be.w;const Ne=this.evaluateLineProgressFeatures(be.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(be,T,M,w,!1,h,v,Ne),this.addHalfVertex(be,L,z,w,!0,-p,v,Ne),this.prevDistance=this.distance,this.distance=me,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(be,oe,T,M,L,z,h,p,v,w)}else le||(this.addHalfVertex(r,T,M,w,!1,h,v,_),this.addHalfVertex(r,L,z,w,!0,-p,v,_));this.currentVertex=oe,this.currentVertexIsOutside=le,this.lineSoFar=he}else this.addHalfVertex(r,T,M,w,!1,h,v,_),this.addHalfVertex(r,L,z,w,!0,-p,v,_)}addHalfVertex({x:r,y:l},h,p,v,_,w,T,M){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,w)),this.layoutVertexArray.emplaceBack((r<<1)+(v?1:0),(l<<1)+(_?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const z=vr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,z)}const L=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),T.primitiveLength++),_?this.e2=L:this.e1=L,M!=null&&this.zOffsetVertexArray.emplaceBack(M.zOffset,M.variableWidth,M.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(r,l){this.prevDistance=this.distance,this.distance+=r.dist(l),this.updateScaledDistance()}}function v2(c,r,l){return c.x<r||c.x>l||c.y<r||c.y>l}let Mz,Rz;function Az(c,r,l){return r*(fn/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}Dn(g2,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Oz=(c,r,l)=>(1-l)*c+l*r;function Dz(c,r){return 1/Az(c,1,r.tileZoom)}function Lz(c,r,l,h){return c.translatePosMatrix(h||r.tileID.projMatrix,r,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const zz=c=>{const r=[];kz(c)&&r.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const l=c.paint.get("line-trim-offset");l[0]===0&&l[1]===0||r.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&r.push("RENDER_LINE_BORDER");const h=c.layout.get("line-join").constantOr("miter")==="none",p=!!c.paint.get("line-pattern").constantOr(1);return h&&p&&r.push("LINE_JOIN_NONE"),r};function kz(c){const r=c.paint.get("line-dasharray").value;return r.kind!=="constant"||r.value}let _2;const Fz=()=>_2||(_2={layout:Mz||(Mz=new wo({"line-cap":new bn(lt.layout_line["line-cap"]),"line-join":new bn(lt.layout_line["line-join"]),"line-miter-limit":new on(lt.layout_line["line-miter-limit"]),"line-round-limit":new on(lt.layout_line["line-round-limit"]),"line-sort-key":new bn(lt.layout_line["line-sort-key"]),"line-z-offset":new bn(lt.layout_line["line-z-offset"]),"line-elevation-reference":new on(lt.layout_line["line-elevation-reference"]),"line-cross-slope":new on(lt.layout_line["line-cross-slope"]),visibility:new on(lt.layout_line.visibility),"line-width-unit":new on(lt.layout_line["line-width-unit"])})),paint:Rz||(Rz=new wo({"line-opacity":new bn(lt.paint_line["line-opacity"]),"line-color":new bn(lt.paint_line["line-color"]),"line-translate":new on(lt.paint_line["line-translate"]),"line-translate-anchor":new on(lt.paint_line["line-translate-anchor"]),"line-width":new bn(lt.paint_line["line-width"]),"line-gap-width":new bn(lt.paint_line["line-gap-width"]),"line-offset":new bn(lt.paint_line["line-offset"]),"line-blur":new bn(lt.paint_line["line-blur"]),"line-dasharray":new bn(lt.paint_line["line-dasharray"]),"line-pattern":new bn(lt.paint_line["line-pattern"]),"line-pattern-cross-fade":new on(lt.paint_line["line-pattern-cross-fade"]),"line-gradient":new lh(lt.paint_line["line-gradient"]),"line-trim-offset":new on(lt.paint_line["line-trim-offset"]),"line-trim-fade-range":new on(lt.paint_line["line-trim-fade-range"]),"line-trim-color":new on(lt.paint_line["line-trim-color"]),"line-emissive-strength":new on(lt.paint_line["line-emissive-strength"]),"line-border-width":new bn(lt.paint_line["line-border-width"]),"line-border-color":new bn(lt.paint_line["line-border-color"]),"line-occlusion-opacity":new on(lt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},_2);class t9 extends bn{possiblyEvaluate(r,l){return l=new Wi(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition,worldview:l.worldview}),super.possiblyEvaluate(r,l)}evaluate(r,l,h,p){return l=Object.assign({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(r,l,h,p)}}let Ly;function Nz(c,r){return r>0?r+2*c:c}const n9=Zr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),r9=Zr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),i9=Zr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Zr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const o9=Zr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),a9=Zr([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),s9=Zr([{name:"a_texb",components:2,type:"Uint16"}]),l9=Zr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),c9=Zr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Zr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Bz=Zr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),u9=Zr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Zr([{name:"triangle",components:3,type:"Uint16"}]),Zr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Zr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Zr([{type:"Float32",name:"offsetX"}]),Zr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Aa=24;function d9(c,r,l){return c.sections.forEach(h=>{h.text=function(p,v,_){const w=v.layout.get("text-transform").evaluate(_,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),Ts.applyArabicShaping&&(p=Ts.applyArabicShaping(p)),p}(h.text,r,l)}),c}const zy={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function h9(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function f9(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}const y2=4294967296,$z=1/y2,jz=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let L1=class{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,r,l=this.length){for(;this.pos<l;){const h=this.readVarint(),p=h>>3,v=this.pos;this.type=7&h,c(p,r,this),this.pos===v&&this.skip(h)}return r}readMessage(c,r){return this.readFields(c,r,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*y2;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*y2;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const r=this.buf;let l,h;return h=r[this.pos++],l=127&h,h<128?l:(h=r[this.pos++],l|=(127&h)<<7,h<128?l:(h=r[this.pos++],l|=(127&h)<<14,h<128?l:(h=r[this.pos++],l|=(127&h)<<21,h<128?l:(h=r[this.pos],l|=(15&h)<<28,function(p,v,_){const w=_.buf;let T,M;if(M=w[_.pos++],T=(112&M)>>4,M<128||(M=w[_.pos++],T|=(127&M)<<3,M<128)||(M=w[_.pos++],T|=(127&M)<<10,M<128)||(M=w[_.pos++],T|=(127&M)<<17,M<128)||(M=w[_.pos++],T|=(127&M)<<24,M<128)||(M=w[_.pos++],T|=(1&M)<<31,M<128))return _g(p,T,v);throw new Error("Expected varint not more than 10 bytes")}(l,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,r=this.pos;return this.pos=c,c-r>=12&&jz?jz.decode(this.buf.subarray(r,c)):function(l,h,p){let v="",_=h;for(;_<p;){const w=l[_];let T,M,L,z=null,F=w>239?4:w>223?3:w>191?2:1;if(_+F>p)break;F===1?w<128&&(z=w):F===2?(T=l[_+1],(192&T)==128&&(z=(31&w)<<6|63&T,z<=127&&(z=null))):F===3?(T=l[_+1],M=l[_+2],(192&T)==128&&(192&M)==128&&(z=(15&w)<<12|(63&T)<<6|63&M,(z<=2047||z>=55296&&z<=57343)&&(z=null))):F===4&&(T=l[_+1],M=l[_+2],L=l[_+3],(192&T)==128&&(192&M)==128&&(192&L)==128&&(z=(15&w)<<18|(63&T)<<12|(63&M)<<6|63&L,(z<=65535||z>=1114112)&&(z=null))),z===null?(z=65533,F=1):z>65535&&(z-=65536,v+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),v+=String.fromCharCode(z),_+=F}return v}(this.buf,r,c)}readBytes(){const c=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,c);return this.pos=c,r}readPackedVarint(c=[],r){const l=this.readPackedEnd();for(;this.pos<l;)c.push(this.readVarint(r));return c}readPackedSVarint(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const r=this.readPackedEnd();for(;this.pos<r;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const r=7&c;if(r===0)for(;this.buf[this.pos++]>127;);else if(r===2)this.pos=this.readVarint()+this.pos;else if(r===5)this.pos+=4;else{if(r!==1)throw new Error(`Unimplemented type: ${r}`);this.pos+=8}}writeTag(c,r){this.writeVarint(c<<3|r)}realloc(c){let r=this.length||16;for(;r<this.pos+c;)r*=2;if(r!==this.length){const l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=r}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*$z),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*$z),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?function(r,l){let h,p;if(r>=0?(h=r%4294967296|0,p=r/4294967296|0):(h=~(-r%4294967296),p=~(-r/4294967296),4294967295^h?h=h+1|0:(h=0,p=p+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(v,_,w){w.buf[w.pos++]=127&v|128,v>>>=7,w.buf[w.pos++]=127&v|128,v>>>=7,w.buf[w.pos++]=127&v|128,v>>>=7,w.buf[w.pos++]=127&v|128,w.buf[w.pos]=127&(v>>>=7)}(h,0,l),function(v,_){const w=(7&v)<<4;_.buf[_.pos++]|=w|((v>>>=3)?128:0),v&&(_.buf[_.pos++]=127&v|((v>>>=7)?128:0),v&&(_.buf[_.pos++]=127&v|((v>>>=7)?128:0),v&&(_.buf[_.pos++]=127&v|((v>>>=7)?128:0),v&&(_.buf[_.pos++]=127&v|((v>>>=7)?128:0),v&&(_.buf[_.pos++]=127&v)))))}(p,l)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const r=this.pos;this.pos=function(h,p,v){for(let _,w,T=0;T<p.length;T++){if(_=p.charCodeAt(T),_>55295&&_<57344){if(!w){_>56319||T+1===p.length?(h[v++]=239,h[v++]=191,h[v++]=189):w=_;continue}if(_<56320){h[v++]=239,h[v++]=191,h[v++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(h[v++]=239,h[v++]=191,h[v++]=189,w=null);_<128?h[v++]=_:(_<2048?h[v++]=_>>6|192:(_<65536?h[v++]=_>>12|224:(h[v++]=_>>18|240,h[v++]=_>>12&63|128),h[v++]=_>>6&63|128),h[v++]=63&_|128)}return v}(this.buf,c,this.pos);const l=this.pos-r;l>=128&&Vz(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const r=c.length;this.writeVarint(r),this.realloc(r);for(let l=0;l<r;l++)this.buf[this.pos++]=c[l]}writeRawMessage(c,r){this.pos++;const l=this.pos;c(r,this);const h=this.pos-l;h>=128&&Vz(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h}writeMessage(c,r,l){this.writeTag(c,2),this.writeRawMessage(r,l)}writePackedVarint(c,r){r.length&&this.writeMessage(c,p9,r)}writePackedSVarint(c,r){r.length&&this.writeMessage(c,m9,r)}writePackedBoolean(c,r){r.length&&this.writeMessage(c,_9,r)}writePackedFloat(c,r){r.length&&this.writeMessage(c,g9,r)}writePackedDouble(c,r){r.length&&this.writeMessage(c,v9,r)}writePackedFixed32(c,r){r.length&&this.writeMessage(c,y9,r)}writePackedSFixed32(c,r){r.length&&this.writeMessage(c,x9,r)}writePackedFixed64(c,r){r.length&&this.writeMessage(c,b9,r)}writePackedSFixed64(c,r){r.length&&this.writeMessage(c,w9,r)}writeBytesField(c,r){this.writeTag(c,2),this.writeBytes(r)}writeFixed32Field(c,r){this.writeTag(c,5),this.writeFixed32(r)}writeSFixed32Field(c,r){this.writeTag(c,5),this.writeSFixed32(r)}writeFixed64Field(c,r){this.writeTag(c,1),this.writeFixed64(r)}writeSFixed64Field(c,r){this.writeTag(c,1),this.writeSFixed64(r)}writeVarintField(c,r){this.writeTag(c,0),this.writeVarint(r)}writeSVarintField(c,r){this.writeTag(c,0),this.writeSVarint(r)}writeStringField(c,r){this.writeTag(c,2),this.writeString(r)}writeFloatField(c,r){this.writeTag(c,5),this.writeFloat(r)}writeDoubleField(c,r){this.writeTag(c,1),this.writeDouble(r)}writeBooleanField(c,r){this.writeVarintField(c,+r)}};function _g(c,r,l){return l?4294967296*r+(c>>>0):4294967296*(r>>>0)+(c>>>0)}function Vz(c,r,l){const h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));l.realloc(h);for(let p=l.pos-1;p>=c;p--)l.buf[p+h]=l.buf[p]}function p9(c,r){for(let l=0;l<c.length;l++)r.writeVarint(c[l])}function m9(c,r){for(let l=0;l<c.length;l++)r.writeSVarint(c[l])}function g9(c,r){for(let l=0;l<c.length;l++)r.writeFloat(c[l])}function v9(c,r){for(let l=0;l<c.length;l++)r.writeDouble(c[l])}function _9(c,r){for(let l=0;l<c.length;l++)r.writeBoolean(c[l])}function y9(c,r){for(let l=0;l<c.length;l++)r.writeFixed32(c[l])}function x9(c,r){for(let l=0;l<c.length;l++)r.writeSFixed32(c[l])}function b9(c,r){for(let l=0;l<c.length;l++)r.writeFixed64(c[l])}function w9(c,r){for(let l=0;l<c.length;l++)r.writeSFixed64(c[l])}const x2=3;function S9(c,r,l){r.glyphs=[],c===1&&l.readMessage(C9,r)}function C9(c,r,l){if(c===3){const{id:h,bitmap:p,width:v,height:_,left:w,top:T,advance:M}=l.readMessage(E9,{});r.glyphs.push({id:h,bitmap:new Ch({width:v+2*x2,height:_+2*x2},p),metrics:{width:v,height:_,left:w,top:T,advance:M}})}else c===4?r.ascender=l.readSVarint():c===5&&(r.descender=l.readSVarint())}function E9(c,r,l){c===1?r.id=l.readVarint():c===2?r.bitmap=l.readBytes():c===3?r.width=l.readVarint():c===4?r.height=l.readVarint():c===5?r.left=l.readSVarint():c===6?r.top=l.readSVarint():c===7&&(r.advance=l.readVarint())}const Uz=x2,tl={horizontal:1,vertical:2,horizontalOnly:3};class ky{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(r,l){const h=new ky;return h.scale=r||1,h.fontStack=l,h}static forImage(r){const l=new ky;return l.image=r,l}}class yg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,l,h){const p=new yg;for(let v=0;v<r.sections.length;v++){const _=r.sections[v];_.image?p.addImageSection(_,h):p.addTextSection(_,l)}return p}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=function(l,h){let p="";for(let v=0;v<l.length;v++){const _=l.charCodeAt(v+1)||null,w=l.charCodeAt(v-1)||null;p+=!h&&(_&&$_(_)&&!zy[l[v+1]]||w&&$_(w)&&!zy[l[v-1]])||!zy[l[v]]?l[v]:zy[l[v]]}return p}(this.text,r)}trim(){let r=0;for(let h=0;h<this.text.length&&z1[this.text.charCodeAt(h)];h++)r++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=r&&z1[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(r,l),this.sectionIndex=this.sectionIndex.slice(r,l)}substring(r,l){const h=new yg;return h.text=this.text.substring(r,l),h.sectionIndex=this.sectionIndex.slice(r,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,l)=>Math.max(r,this.sections[l].scale),0)}addTextSection(r,l){this.text+=r.text,this.sections.push(ky.forText(r.scale,r.fontStack||l));const h=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(h)}addImageSection(r,l){const h=r.image?r.image.getPrimary():null;if(!h)return void jt("Can't add FormattedSection with an empty image.");h.scaleSelf(l);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(ky.forImage(h)),this.sectionIndex.push(this.sections.length-1)):jt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function b2(c,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J=1){const oe=yg.fromFeature(c,p,J);z===tl.vertical&&oe.verticalizePunctuation(F);let le=[];const he=function(He,Ze,et,Tt,ct,At){if(!He)return[];const Bt=[],qt=function(Yt,wt,_t,Xt,sn,Ht){let An=0;for(let Bn=0;Bn<Yt.length();Bn++){const Sn=Yt.getSection(Bn);An+=Hz(Yt.getCodePoint(Bn),Sn,Xt,sn,wt,Ht)}return An/Math.max(1,Math.ceil(An/_t))}(He,Ze,et,Tt,ct,At),cn=He.text.indexOf("")>=0;let en=0;for(let Yt=0;Yt<He.length();Yt++){const wt=He.getSection(Yt),_t=He.getCodePoint(Yt);if(z1[_t]||(en+=Hz(_t,wt,Tt,ct,Ze,At)),Yt<He.length()-1){const Xt=!((Vt=_t)<11904||!(lr["Bopomofo Extended"](Vt)||lr.Bopomofo(Vt)||lr["CJK Compatibility Forms"](Vt)||lr["CJK Compatibility Ideographs"](Vt)||lr["CJK Compatibility"](Vt)||lr["CJK Radicals Supplement"](Vt)||lr["CJK Strokes"](Vt)||lr["CJK Symbols and Punctuation"](Vt)||lr["CJK Unified Ideographs Extension A"](Vt)||lr["CJK Unified Ideographs"](Vt)||lr["Enclosed CJK Letters and Months"](Vt)||lr["Halfwidth and Fullwidth Forms"](Vt)||lr.Hiragana(Vt)||lr["Ideographic Description Characters"](Vt)||lr["Kangxi Radicals"](Vt)||lr["Katakana Phonetic Extensions"](Vt)||lr.Katakana(Vt)||lr["Vertical Forms"](Vt)||lr["Yi Radicals"](Vt)||lr["Yi Syllables"](Vt)));(T9[_t]||Xt||wt.image)&&Bt.push(Wz(Yt+1,en,qt,Bt,I9(_t,He.getCodePoint(Yt+1),Xt&&cn),!1))}}var Vt;return qz(Wz(He.length(),en,qt,Bt,0,!0))}(oe,M,v,r,h,G),{processBidirectionalText:me,processStyledBidirectionalText:be}=Ts;if(me&&oe.sections.length===1){const He=me(oe.toString(),he);for(const Ze of He){const et=new yg;et.text=Ze,et.sections=oe.sections;for(let Tt=0;Tt<Ze.length;Tt++)et.sectionIndex.push(0);le.push(et)}}else if(be){const He=be(oe.text,oe.sectionIndex,he);for(const Ze of He){const et=new yg;et.text=Ze[0],et.sectionIndex=Ze[1],et.sections=oe.sections,le.push(et)}}else le=function(He,Ze){const et=[],Tt=He.text;let ct=0;for(const At of Ze)et.push(He.substring(ct,At)),ct=At;return ct<Tt.length&&et.push(He.substring(ct,Tt.length)),et}(oe,he);const Ne=[],Ae={positionedLines:Ne,text:oe.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(He,Ze,et,Tt,ct,At,Bt,qt,cn,en,Vt,Yt){let wt=0,_t=0,Xt=0;const sn=qt==="right"?1:qt==="left"?0:.5;let Ht=!1;for(const xn of ct){const or=xn.getSections();for(const Pr of or){if(Pr.image)continue;const Gr=Ze[Pr.fontStack];if(Gr&&(Ht=Gr.ascender!==void 0&&Gr.descender!==void 0,!Ht))break}if(!Ht)break}let An=0;for(const xn of ct){xn.trim();const or=xn.getMaxScale(),Pr=(or-1)*Aa,Gr={positionedGlyphs:[],lineOffset:0};He.positionedLines[An]=Gr;const pi=Gr.positionedGlyphs;let Or=0;if(!xn.length()){_t+=At,++An;continue}let bi=0,wi=0;for(let Oe=0;Oe<xn.length();Oe++){const Pe=xn.getSection(Oe),Ot=xn.getSectionIndex(Oe),gn=xn.getCodePoint(Oe);let Dt=Pe.scale,_n=null,Wn=null,Gn=null,Lr=Aa,dr=0,Vn=cn;Vn===tl.vertical&&((Bn=gn)===12312||Bn===12313||Bn===12316||Bn===12540||Bn===12448)&&(Vn=tl.horizontal);const _i=!(Vn===tl.horizontal||!Vt&&!Wm(gn)||Vt&&(z1[gn]||j_(gn)));if(Pe.image){const Fi=Tt.get(Pe.image.toString());if(!Fi)continue;Gn=Pe.image,He.iconsInText=He.iconsInText||!0,Wn=Fi.paddedRect;const pr=Fi.displaySize;Dt=Dt*Aa/Yt,_n={width:pr[0],height:pr[1],left:0,top:-Uz,advance:_i?pr[1]:pr[0],localGlyph:!1},dr=Ht?-_n.height*Dt:or*Aa-17-pr[1]*Dt,Lr=_n.advance;const hi=(_i?pr[0]:pr[1])*Dt-Aa*or;hi>0&&hi>Or&&(Or=hi)}else{const Fi=et[Pe.fontStack];if(!Fi)continue;Fi[gn]&&(Wn=Fi[gn]);const pr=Ze[Pe.fontStack];if(!pr)continue;const hi=pr.glyphs[gn];if(!hi)continue;if(_n=hi.metrics,Lr=gn!==8203?Aa:0,Ht){const Ni=pr.ascender!==void 0?Math.abs(pr.ascender):0,Ri=pr.descender!==void 0?Math.abs(pr.descender):0,_o=(Ni+Ri)*Dt;bi<_o&&(bi=_o,wi=(Ni-Ri)/2*Dt),dr=-Ni*Dt}else dr=(or-Dt)*Aa-17}_i?(He.verticalizable=!0,pi.push({glyph:gn,image:Gn,x:wt,y:_t+dr,vertical:_i,scale:Dt,localGlyph:_n.localGlyph,fontStack:Pe.fontStack,sectionIndex:Ot,metrics:_n,rect:Wn}),wt+=Lr*Dt+en):(pi.push({glyph:gn,image:Gn,x:wt,y:_t+dr,vertical:_i,scale:Dt,localGlyph:_n.localGlyph,fontStack:Pe.fontStack,sectionIndex:Ot,metrics:_n,rect:Wn}),wt+=_n.advance*Dt+en)}pi.length!==0&&(Xt=Math.max(wt-en,Xt),Ht?Kz(pi,sn,Or,wi,At*or/2):Kz(pi,sn,Or,0,At/2)),wt=0;const so=At*or+Or;Gr.lineOffset=Math.max(Or,Pr),_t+=so,++An}var Bn;const Sn=_t,{horizontalAlign:vn,verticalAlign:Cr}=w2(Bt);(function(xn,or,Pr,Gr,pi,Or){const bi=(or-Pr)*pi,wi=-Or*Gr;for(const so of xn)for(const Oe of so.positionedGlyphs)Oe.x+=bi,Oe.y+=wi})(He.positionedLines,sn,vn,Cr,Xt,Sn),He.top+=-Cr*Sn,He.bottom=He.top+Sn,He.left+=-vn*Xt,He.right=He.left+Xt,He.hasBaseline=Ht}(Ae,r,l,h,le,_,w,T,z,M,F,W),!function(He){for(const Ze of He)if(Ze.positionedGlyphs.length!==0)return!1;return!0}(Ne))return Ae}const z1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},T9={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Hz(c,r,l,h,p,v){if(r.image){const _=h.get(r.image.toString());return _?_.displaySize[0]*r.scale*Aa/v+p:0}{const _=l[r.fontStack],w=_&&_.glyphs[c];return w?w.metrics.advance*r.scale+p:0}}function Gz(c,r,l,h){const p=Math.pow(c-r,2);return h?c<r?p/2:2*p:p+Math.abs(l)*l}function I9(c,r,l){let h=0;return c===10&&(h-=1e4),l&&(h+=150),c!==40&&c!==65288||(h+=50),r!==41&&r!==65289||(h+=50),h}function Wz(c,r,l,h,p,v){let _=null,w=Gz(r,l,p,v);for(const T of h){const M=Gz(r-T.x,l,p,v)+T.badness;M<=w&&(_=T,w=M)}return{index:c,x:r,priorBreak:_,badness:w}}function qz(c){return c?qz(c.priorBreak).concat(c.index):[]}function w2(c){let r=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:r,verticalAlign:l}}function Kz(c,r,l,h,p){if(!(r||l||h||p))return;const v=c.length-1,_=c[v],w=(_.x+_.metrics.advance*_.scale)*r;for(let T=0;T<=v;T++)c[T].x-=w,c[T].y+=l+h+p}function Xz(c){return c.imagePrimary!==void 0&&c.top!==void 0&&c.bottom!==void 0&&c.left!==void 0&&c.right!==void 0}function k1(c,r,l,h){const{horizontalAlign:p,verticalAlign:v}=w2(h),_=l[0]-c.displaySize[0]*p,w=l[1]-c.displaySize[1]*v;return{imagePrimary:c,imageSecondary:r,top:w,bottom:w+c.displaySize[1],left:_,right:_+c.displaySize[0]}}function S2(c,r,l,h,p,v){const _=c.imagePrimary;let w;if(_.content){const oe=_.content,le=_.pixelRatio||1;w=[oe[0]/le,oe[1]/le,_.displaySize[0]-oe[2]/le,_.displaySize[1]-oe[3]/le]}const T=r.left*v,M=r.right*v;let L,z,F,G;l==="width"||l==="both"?(G=p[0]+T-h[3],z=p[0]+M+h[1]):(G=p[0]+(T+M-_.displaySize[0])/2,z=G+_.displaySize[0]);const W=r.top*v,J=r.bottom*v;return l==="height"||l==="both"?(L=p[1]+W-h[0],F=p[1]+J+h[2]):(L=p[1]+(W+J-_.displaySize[1])/2,F=L+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:L,right:z,bottom:F,left:G,collisionPadding:w}}function Zz(c){return!c.imagePrimary.stretchX}function Yz(c){return!c.imagePrimary.stretchY}function Jz(c){return{width:c.right-c.left,height:c.bottom-c.top}}const Dc=128;function xg(c,r,l){const{expression:h}=r;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Wi(c+1,{worldview:l}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=h;let _=0;for(;_<p.length&&p[_]<=c;)_++;_=Math.max(0,_-1);let w=_;for(;w<p.length&&p[w]<c+1;)w++;w=Math.min(p.length-1,w);const T=p[_],M=p[w];return h.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:M,interpolationType:v}:{kind:"camera",minZoom:T,maxZoom:M,minSize:h.evaluate(new Wi(T,{worldview:l})),maxSize:h.evaluate(new Wi(M,{worldview:l})),interpolationType:v}}}function C2(c,{uSize:r,uSizeT:l},{lowerSize:h,upperSize:p}){return c.kind==="source"?h/Dc:c.kind==="composite"?vr(h/Dc,p/Dc,l):r}function bg(c,r,l=1){let h=0,p=0;if(c.kind==="constant")p=c.layoutSize*l;else if(c.kind!=="source"){const{interpolationType:v,minZoom:_,maxZoom:w}=c,T=v?ie(Ws.interpolationFactor(v,r,_,w),0,1):0;c.kind==="camera"?p=vr(c.minSize,c.maxSize,T)*l:h=T*l}return{uSizeT:h,uSize:p}}class md extends ut{constructor(r,l,h,p,v){super(r,l),this.angle=p,this.z=h,v!==void 0&&(this.segment=v)}clone(){return new md(this.x,this.y,this.z,this.angle,this.segment)}}function Qz(c,r,l,h,p){if(r.segment===void 0)return!0;let v=r,_=r.segment+1,w=0;for(;w>-l/2;){if(_--,_<0)return!1;w-=c[_].dist(v),v=c[_]}w+=c[_].dist(c[_+1]),_++;const T=[];let M=0;for(;w<l/2;){const L=c[_],z=c[_+1];if(!z)return!1;let F=c[_-1].angleTo(L)-L.angleTo(z);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:F}),M+=F;w-T[0].distance>h;)M-=T.shift().angleDelta;if(M>p)return!1;_++,w+=L.dist(z)}return!0}function ek(c){let r=0;for(let l=0;l<c.length-1;l++)r+=c[l].dist(c[l+1]);return r}function tk(c,r,l){return c?.6*r*l:0}function nk(c,r){return Math.max(c?c.right-c.left:0,r?r.right-r.left:0)}function P9(c,r,l,h,p,v){const _=tk(l,p,v),w=nk(l,h)*v;let T=0;const M=ek(c)/2;for(let L=0;L<c.length-1;L++){const z=c[L],F=c[L+1],G=z.dist(F);if(T+G>M){const W=(M-T)/G,J=vr(z.x,F.x,W),oe=vr(z.y,F.y,W),le=new md(J,oe,0,F.angleTo(z),L);return!_||Qz(c,le,w,_,r)?le:void 0}T+=G}}function M9(c,r,l,h,p,v,_,w,T){const M=tk(h,v,_),L=nk(h,p),z=L*_,F=c[0].x===0||c[0].x===T||c[0].y===0||c[0].y===T;return r-z<r/4&&(r=z+r/4),rk(c,F?r/2*w%r:(L/2+2*v)*_*w%r,r,M,l,z,F,!1,T)}function rk(c,r,l,h,p,v,_,w,T){const M=v/2,L=ek(c);let z=0,F=r-l,G=[];for(let W=0;W<c.length-1;W++){const J=c[W],oe=c[W+1],le=J.dist(oe),he=oe.angleTo(J);for(;F+l<z+le;){F+=l;const me=(F-z)/le,be=vr(J.x,oe.x,me),Ne=vr(J.y,oe.y,me);if(be>=0&&be<T&&Ne>=0&&Ne<T&&F-M>=0&&F+M<=L){const Ae=new md(be,Ne,0,he,W);h&&!Qz(c,Ae,v,h,p)||G.push(Ae)}}z+=le}return w||G.length||_||(G=rk(c,z/2,l,h,p,v,_,!0,T)),G}function ik(c){let r=0,l=0;for(const _ of c)r+=_.w*_.h,l=Math.max(l,_.w);c.sort((_,w)=>w.h-_.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),l),h:1/0}];let p=0,v=0;for(const _ of c)for(let w=h.length-1;w>=0;w--){const T=h[w];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,v=Math.max(v,_.y+_.h),p=Math.max(p,_.x+_.w),_.w===T.w&&_.h===T.h){const M=h.pop();M&&w<h.length&&(h[w]=M)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(h.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:p,h:v,fill:r/(p*v)||0}}Dn(md,"Anchor");const fp=1;class Fy{static getImagePositionScale(r,l,h){if(l&&r&&r.options&&r.options.transform){const p=r.options.transform;return{x:p.a,y:p.d}}return{x:h,y:h}}constructor(r,l,h,p){this.paddedRect=r;const{pixelRatio:v,version:_,stretchX:w,stretchY:T,content:M,sdf:L,usvg:z}=l;this.pixelRatio=v,this.stretchX=w,this.stretchY=T,this.content=M,this.version=_,this.padding=h,this.sdf=L,this.usvg=z,this.scale=Fy.getImagePositionScale(p,z,v)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function E2(c,r,l){const h=wc.parse(c),p=function(v,_,w=[1,1]){return{x:0,y:0,w:(v.data?v.data.width:v.width*w[0])+2*_,h:(v.data?v.data.height:v.height*w[1])+2*_}}(r,l,[h.options.transform.a,h.options.transform.d]);return{bin:p,imagePosition:new Fy(p,r,l,h),imageVariant:h}}class ok{constructor(r,l,h){const p=new Map,v=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(r,p,fp,_),this.addImages(l,v,2,_);const{w,h:T}=ik(_),M=new Ga({width:w||1,height:T||1});for(const[L,z]of r.entries()){const F=p.get(L).paddedRect;Ga.copy(z.data,M,{x:0,y:0},{x:F.x+fp,y:F.y+fp},z.data,null,z.sdf)}for(const[L,z]of l.entries()){const F=v.get(L),G=F.paddedRect;let W=F.padding;const J=G.x+W,oe=G.y+W,le=z.data.width,he=z.data.height;W=W>1?W-1:W,Ga.copy(z.data,M,{x:0,y:0},{x:J,y:oe},z.data,h),Ga.copy(z.data,M,{x:0,y:he-W},{x:J,y:oe-W},{width:le,height:W},h),Ga.copy(z.data,M,{x:0,y:0},{x:J,y:oe+he},{width:le,height:W},h),Ga.copy(z.data,M,{x:le-W,y:0},{x:J-W,y:oe},{width:W,height:he},h),Ga.copy(z.data,M,{x:0,y:0},{x:J+le,y:oe},{width:W,height:he},h),Ga.copy(z.data,M,{x:le-W,y:he-W},{x:J-W,y:oe-W},{width:W,height:W},h),Ga.copy(z.data,M,{x:0,y:he-W},{x:J+le,y:oe-W},{width:W,height:W},h),Ga.copy(z.data,M,{x:0,y:0},{x:J+le,y:oe+he},{width:W,height:W},h),Ga.copy(z.data,M,{x:le-W,y:0},{x:J-W,y:oe+he},{width:W,height:W},h)}this.lut=h,this.image=M,this.iconPositions=p,this.patternPositions=v}addImages(r,l,h,p){for(const[v,_]of r.entries()){const{bin:w,imagePosition:T,imageVariant:M}=E2(v,_,h);l.set(v,T),p.push(w),_.hasRenderCallback&&this.haveRenderCallbacks.push(M.id)}}patchUpdatedImages(r,l,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>r.hasImage(p,h)),r.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const p of r.getUpdatedImages(h)){for(const v of this.iconPositions.keys()){const _=wc.parse(v);if(la.isEqual(_.id,p)){const w=r.getImage(p,h);this.patchUpdatedImage(this.iconPositions.get(v),w,l,null)}}for(const v of this.patternPositions.keys()){const _=wc.parse(v);if(la.isEqual(_.id,p)){const w=r.getImage(p,h);this.patchUpdatedImage(this.patternPositions.get(v),w,l,this.lut)}}}}patchUpdatedImage(r,l,h,p=null){if(!r||!l||r.version===l.version)return;r.version=l.version;const[v,_]=r.tl,w=r.sdf;if(this.lut||w){const T={width:l.data.width,height:l.data.height},M=new Ga(T);Ga.copy(l.data,M,{x:0,y:0},{x:0,y:0},T,p,w),h.update(M,{position:{x:v,y:_}})}else h.update(l.data,{position:{x:v,y:_}})}}Dn(Fy,"ImagePosition"),Dn(ok,"ImageAtlas");const Ny=1e20;function ak(c,r,l,h,p,v,_,w,T){for(let M=r;M<r+h;M++)sk(c,l*v+M,v,p,_,w,T);for(let M=l;M<l+p;M++)sk(c,M*v+r,1,h,_,w,T)}function sk(c,r,l,h,p,v,_){v[0]=0,_[0]=-Ny,_[1]=Ny,p[0]=c[r];for(let w=1,T=0,M=0;w<h;w++){p[w]=c[r+w*l];const L=w*w;do{const z=v[T];M=(p[w]-p[z]+L-z*z)/(w-z)/2}while(M<=_[T]&&--T>-1);T++,v[T]=w,_[T]=M,_[T+1]=Ny}for(let w=0,T=0;w<h;w++){for(;_[T+1]<w;)T++;const M=v[T],L=w-M;c[r+w*l]=p[M]+L*L}}const Lc=2,T2={none:0,ideographs:1,all:2};class wg{constructor(r,l,h){this.requestManager=r,this.localGlyphMode=l,this.localFontFamily=h,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,l){const h=[],p=this.url||li.GLYPHS_URL;for(const v in r)for(const _ of r[v])h.push({stack:v,id:_});De(h,({stack:v,id:_},w)=>{let T=this.entries[v];T||(T=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=T.glyphs[_];if(M!==void 0)return void w(null,{stack:v,id:_,glyph:M});if(M=this._tinySDF(T,v,_),M)return T.glyphs[_]=M,void w(null,{stack:v,id:_,glyph:M});const L=Math.floor(_/256);if(256*L>65535)return jt("glyphs > 65535 not supported"),void w(null,{stack:v,id:_,glyph:M});if(T.ranges[L])return void w(null,{stack:v,id:_,glyph:M});let z=T.requests[L];z||(z=T.requests[L]=[],wg.loadGlyphRange(v,L,p,this.requestManager,(F,G)=>{if(G){T.ascender=G.ascender,T.descender=G.descender;for(const W in G.glyphs)this._doesCharSupportLocalGlyph(+W)||(T.glyphs[+W]=G.glyphs[+W]);T.ranges[L]=!0}for(const W of z)W(F,G);delete T.requests[L]})),z.push((F,G)=>{F?w(F):G&&w(null,{stack:v,id:_,glyph:G.glyphs[_]||null})})},(v,_)=>{if(v)l(v);else if(_){const w={};for(const{stack:T,id:M,glyph:L}of _)w[T]===void 0&&(w[T]={}),w[T].glyphs===void 0&&(w[T].glyphs={}),w[T].glyphs[M]=L&&{id:L.id,bitmap:L.bitmap.clone(),metrics:L.metrics},w[T].ascender=this.entries[T].ascender,w[T].descender=this.entries[T].descender;l(null,w)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==T2.none&&(this.localGlyphMode===T2.all?!!this.localFontFamily:!!this.localFontFamily&&(lr["CJK Unified Ideographs"](r)||lr["Hangul Syllables"](r)||lr.Hiragana(r)||lr.Katakana(r)||lr["CJK Symbols and Punctuation"](r)||lr["CJK Unified Ideographs Extension A"](r)||lr["CJK Unified Ideographs Extension B"](r)||lr.Osage(r)))}_tinySDF(r,l,h){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let v=r.tinySDF;if(!v){let J="400";/bold/i.test(l)?J="900":/medium/i.test(l)?J="500":/light/i.test(l)&&(J="200"),v=r.tinySDF=new wg.TinySDF({fontFamily:p,fontWeight:J,fontSize:24*Lc,buffer:3*Lc,radius:8*Lc}),v.fontWeight=J}if(this.localGlyphs[v.fontWeight][h])return this.localGlyphs[v.fontWeight][h];const _=String.fromCodePoint(h),{data:w,width:T,height:M,glyphWidth:L,glyphHeight:z,glyphLeft:F,glyphTop:G,glyphAdvance:W}=v.draw(_);return this.localGlyphs[v.fontWeight][h]={id:h,bitmap:new Ch({width:T,height:M},w),metrics:{width:L/Lc,height:z/Lc,left:F/Lc,top:G/Lc-27,advance:W/Lc,localGlyph:!0}}}}wg.loadGlyphRange=function(c,r,l,h,p){const v=256*r,_=v+255,w=h.transformRequest(h.normalizeGlyphsURL(l).replace("{fontstack}",c).replace("{range}",`${v}-${_}`),Dr.Glyphs);bo(w,(T,M)=>{if(T)p(T);else if(M){const L={},z=function(F){return new L1(F).readFields(S9,{})}(M);for(const F of z.glyphs)L[F.id]=F;p(null,{glyphs:L,ascender:z.ascender,descender:z.descender})}})},wg.TinySDF=class{constructor({fontSize:c=24,buffer:r=3,radius:l=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:v="normal",fontStyle:_="normal",lang:w=null}={}){this.buffer=r,this.cutoff=h,this.radius=l,this.lang=w;const T=this.size=c+4*r,M=this._createCanvas(T),L=this.ctx=M.getContext("2d",{willReadFrequently:!0});L.font=`${_} ${v} ${c}px ${p}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const r=document.createElement("canvas");return r.width=r.height=c,r}draw(c){const{width:r,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:v}=this.ctx.measureText(c),_=Math.ceil(l),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-p))),T=Math.min(this.size-this.buffer,_+Math.ceil(h)),M=w+2*this.buffer,L=T+2*this.buffer,z=Math.max(M*L,0),F=new Uint8ClampedArray(z),G={data:F,width:M,height:L,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:r};if(w===0||T===0)return G;const{ctx:W,buffer:J,gridInner:oe,gridOuter:le}=this;this.lang&&(W.lang=this.lang),W.clearRect(J,J,w,T),W.fillText(c,J,J+_);const he=W.getImageData(J,J,w,T);le.fill(Ny,0,z),oe.fill(0,0,z);for(let me=0;me<T;me++)for(let be=0;be<w;be++){const Ne=he.data[4*(me*w+be)+3]/255;if(Ne===0)continue;const Ae=(me+J)*M+be+J;if(Ne===1)le[Ae]=0,oe[Ae]=Ny;else{const He=.5-Ne;le[Ae]=He>0?He*He:0,oe[Ae]=He<0?He*He:0}}ak(le,0,0,M,L,M,this.f,this.v,this.z),ak(oe,J,J,w,T,M,this.f,this.v,this.z);for(let me=0;me<z;me++){const be=Math.sqrt(le[me])-Math.sqrt(oe[me]);F[me]=Math.round(255-255*(be/this.radius+this.cutoff))}return G}};const yu=fp;function lk(c,r){return c+r[1]-r[0]}function I2(c,r,l,h,p=1){const v=[],_=c.imagePrimary,w=_.pixelRatio,T=_.paddedRect.w-2*yu,M=_.paddedRect.h-2*yu,L=(c.right-c.left)*p,z=(c.bottom-c.top)*p,F=_.stretchX||[[0,T]],G=_.stretchY||[[0,M]],W=F.reduce(lk,0),J=G.reduce(lk,0),oe=T-W,le=M-J;let he=0,me=W,be=0,Ne=J,Ae=0,He=oe,Ze=0,et=le;if(_.content&&h){const ct=_.content;he=F1(F,0,ct[0]),be=F1(G,0,ct[1]),me=F1(F,ct[0],ct[2]),Ne=F1(G,ct[1],ct[3]),Ae=ct[0]-he,Ze=ct[1]-be,He=ct[2]-ct[0]-me,et=ct[3]-ct[1]-Ne}const Tt=(ct,At,Bt,qt)=>{const cn=N1(ct.stretch-he,me,L,c.left*p),en=B1(ct.fixed-Ae,He,ct.stretch,W),Vt=N1(At.stretch-be,Ne,z,c.top*p),Yt=B1(At.fixed-Ze,et,At.stretch,J),wt=N1(Bt.stretch-he,me,L,c.left*p),_t=B1(Bt.fixed-Ae,He,Bt.stretch,W),Xt=N1(qt.stretch-be,Ne,z,c.top*p),sn=B1(qt.fixed-Ze,et,qt.stretch,J),Ht=new ut(cn,Vt),An=new ut(wt,Vt),Bn=new ut(wt,Xt),Sn=new ut(cn,Xt),vn=new ut(en/w,Yt/w),Cr=new ut(_t/w,sn/w),xn=r*Math.PI/180;if(xn){const bi=Math.sin(xn),wi=Math.cos(xn),so=[wi,-bi,bi,wi];Ht._matMult(so),An._matMult(so),Sn._matMult(so),Bn._matMult(so)}const or=ct.stretch+ct.fixed,Pr=Bt.stretch+Bt.fixed,Gr=At.stretch+At.fixed,pi=qt.stretch+qt.fixed,Or=c.imageSecondary;return{tl:Ht,tr:An,bl:Sn,br:Bn,texPrimary:{x:_.paddedRect.x+yu+or,y:_.paddedRect.y+yu+Gr,w:Pr-or,h:pi-Gr},texSecondary:Or?{x:Or.paddedRect.x+yu+or,y:Or.paddedRect.y+yu+Gr,w:Pr-or,h:pi-Gr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vn,pixelOffsetBR:Cr,minFontScaleX:He/w/L,minFontScaleY:et/w/z,isSDF:l}};if(h&&(_.stretchX||_.stretchY)){const ct=ck(F,oe,W),At=ck(G,le,J);for(let Bt=0;Bt<ct.length-1;Bt++){const qt=ct[Bt],cn=ct[Bt+1];for(let en=0;en<At.length-1;en++)v.push(Tt(qt,At[en],cn,At[en+1]))}}else v.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:M+1}));return v}function R9(c,r){const l=c.stretchY||[[0,c.paddedRect.h-2*yu]];return r&&(c.stretchX||c.stretchY)?uk(c.stretchX||[[0,c.paddedRect.w-2*yu]])*uk(l):1}function F1(c,r,l){let h=0;for(const p of c)h+=Math.max(r,Math.min(l,p[1]))-Math.max(r,Math.min(l,p[0]));return h}function ck(c,r,l){const h=[{fixed:-yu,stretch:0}];for(const[p,v]of c){const _=h[h.length-1];h.push({fixed:p-_.stretch,stretch:_.stretch}),h.push({fixed:p-_.stretch,stretch:_.stretch+(v-p)})}return h.push({fixed:r+yu,stretch:l}),h}function uk(c){return 2*c.length+1}function N1(c,r,l,h){return c/r*l+h}function B1(c,r,l,h){return c-r*l/h}function A9(c,r,l,h){const p=r+c.positionedLines[h].lineOffset;return h===0?l+p/2:l+(p+(r+c.positionedLines[h-1].lineOffset))/2}function O9(c,r=1,l=!1){let h=1/0,p=1/0,v=-1/0,_=-1/0;const w=c[0];for(let G=0;G<w.length;G++){const W=w[G];(!G||W.x<h)&&(h=W.x),(!G||W.y<p)&&(p=W.y),(!G||W.x>v)&&(v=W.x),(!G||W.y>_)&&(_=W.y)}const T=Math.min(v-h,_-p);let M=T/2;const L=new _m([],D9);if(T===0)return new ut(h,p);for(let G=h;G<v;G+=T)for(let W=p;W<_;W+=T)L.push(new Sg(G+M,W+M,M,c));let z=function(G){let W=0,J=0,oe=0;const le=G[0];for(let he=0,me=le.length,be=me-1;he<me;be=he++){const Ne=le[he],Ae=le[be],He=Ne.x*Ae.y-Ae.x*Ne.y;J+=(Ne.x+Ae.x)*He,oe+=(Ne.y+Ae.y)*He,W+=3*He}return new Sg(J/W,oe/W,0,G)}(c),F=L.length;for(;L.length;){const G=L.pop();(G.d>z.d||!z.d)&&(z=G,l&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,F)),G.max-z.d<=r||(M=G.h/2,L.push(new Sg(G.p.x-M,G.p.y-M,M,c)),L.push(new Sg(G.p.x+M,G.p.y-M,M,c)),L.push(new Sg(G.p.x-M,G.p.y+M,M,c)),L.push(new Sg(G.p.x+M,G.p.y+M,M,c)),F+=4)}return l&&(console.log(`num probes: ${F}`),console.log(`best distance: ${z.d}`)),z.p}function D9(c,r){return r.max-c.max}class Sg{constructor(r,l,h,p){this.p=new ut(r,l),this.h=h,this.d=function(v,_){let w=!1,T=1/0;for(let M=0;M<_.length;M++){const L=_[M];for(let z=0,F=L.length,G=F-1;z<F;G=z++){const W=L[z],J=L[G];W.y>v.y!=J.y>v.y&&v.x<(J.x-W.x)*(v.y-W.y)/(J.y-W.y)+W.x&&(w=!w),T=Math.min(T,Zs(v,W,J))}}return(w?1:-1)*Math.sqrt(T)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const L9=Object.keys,P2=Number.POSITIVE_INFINITY,z9=Math.sqrt(2);function $1(c,r,l,h){const p=c.collisionPadding||[0,0,0,0],v={top:c.top-p[1],bottom:c.bottom+p[3],left:c.left-p[0],right:c.right+p[2],scaled:!1};return h!==void 0&&function(_,w){_.top*=w,_.bottom*=w,_.left*=w,_.right*=w,_.scaled=!0}(v,h),l&&function(_,w){if(!w)return;const T=Gt(w),M=new ut(_.left,_.top),L=new ut(_.right,_.top),z=new ut(_.left,_.bottom),F=new ut(_.right,_.bottom);M._rotateAround(T,new ut(0,0)),L._rotateAround(T,new ut(0,0)),z._rotateAround(T,new ut(0,0)),F._rotateAround(T,new ut(0,0)),_.left=Math.min(M.x,L.x,z.x,F.x),_.right=Math.max(M.x,L.x,z.x,F.x),_.top=Math.min(M.y,L.y,z.y,F.y),_.bottom=Math.max(M.y,L.y,z.y,F.y)}(v,l),r?{top:Math.min(r.top,v.top),bottom:Math.max(r.bottom,v.bottom),left:Math.min(r.left,v.left),right:Math.max(r.right,v.right),scaled:r.scaled||v.scaled}:v}function dk(c,[r,l]){let h=0,p=0;if(l===P2){r<0&&(r=0);const v=r/z9;switch(c){case"top-right":case"top-left":p=v-7;break;case"bottom-right":case"bottom-left":p=7-v;break;case"bottom":p=7-r;break;case"top":p=r-7}switch(c){case"top-right":case"bottom-right":h=-v;break;case"top-left":case"bottom-left":h=v;break;case"left":h=r;break;case"right":h=-r}}else{switch(r=Math.abs(r),l=Math.abs(l),c){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(c){case"top-right":case"bottom-right":case"right":h=-r;break;case"top-left":case"bottom-left":case"left":h=r}}return[h,p]}function k9(c,r,l,h,p,v,_,w,T,M,L){const z=c.layers[0],F=z.appearances;if(F.length===0)return{iconBBox:null,iconVerticalBBox:null};let G=null,W=null;const J=h.get("icon-rotate").evaluate(p,{},v);r&&(G=$1(r,G,J,_),l)&&(W=$1(l,W,J+90,_));const[oe,le]=h.get("icon-size-scale-range"),he=ie(1,oe,le);for(const me of F){const be=me.getUnevaluatedProperties(),Ne=be._values["icon-image"].value!==void 0,Ae=be._values["icon-size"].value!==void 0,He=be._values["icon-offset"].value!==void 0,Ze=be._values["icon-rotate"].value!==void 0;if(Ne||Ae||He||Ze){const et=He?z.getAppearanceValueAndResolveTokens(me,"icon-offset",p,v,[]):null,Tt=et&&Array.isArray(et)?et:w,ct=Ze?z.getAppearanceValueAndResolveTokens(me,"icon-rotate",p,v,[]):null,At=typeof ct=="number"?ct:J,Bt=Ae?z.getAppearanceValueAndResolveTokens(me,"icon-size",p,v,[]):null,qt=typeof Bt=="number"?Bt*T.iconScaleFactor:_;let cn=null,en=null,Vt=null;if(Ne){const Yt=z.getAppearanceValueAndResolveTokens(me,"icon-image",p,v,[]);if(Yt){const wt=c.getResolvedImageFromTokens(Yt),_t=be._values["icon-size"],Xt=By(wt,xg(c.zoom,_t,c.worldview),_t,v,c.zoom,p,c.pixelRatio,he,c.worldview);Vt=M.get(Xt.iconPrimary.toString())}}else r&&(Vt=r.imagePrimary);Vt&&(cn=k1(Vt,null,Tt,L),c.allowVerticalPlacement&&(en=k1(Vt,null,Tt,L))),cn&&(G=$1(cn,G,At,qt)),en&&(W=$1(en,W,At+90,qt))}}return{iconBBox:G,iconVerticalBBox:W}}function j1(c,r,l,h,p,v,_,w,T){if(!r||!r.usvg)return;const M=Jz(h),L=Jz(p),z=v!=="both"&&v!=="width"||!Zz(h)?1:L.width/M.width,F=v!=="both"&&v!=="height"||!Yz(h)?1:L.height/M.height;l.scaleSelf(z,F);const G=l.toString();_.set(G,l),w.set(G,r);const{imagePosition:W}=E2(G,r,fp);T.set(G,W)}function hk(c,r,l,h,p,v,_,w,T){if(!c)return;const M=function(L,z,F,G,W,J){if(L.kind==="camera")return L.maxSize;if(L.kind==="composite"){const oe=z.possiblyEvaluate(new Wi(L.maxZoom,{worldview:J}),F).evaluate(W,{},F),le=z.possiblyEvaluate(new Wi(L.minZoom,{worldview:J}),F).evaluate(W,{},F);return Math.max(oe,le)}return z.possiblyEvaluate(new Wi(G,{worldview:J})).evaluate(W,{},F)}(r,l,h,p,v,T);return c.scaleSelf(M*w*_)}function By(c,r,l,h,p,v,_,w,T){return{iconPrimary:hk(c.getPrimary(),r,l,h,p,v,_,w,T),iconSecondary:hk(c.getSecondary(),r,l,h,p,v,_,w,T)}}function F9(c,r,l){if(!r)return;const h=l.get(c.toString()),p=l.get(r.toString());h&&p&&(h.paddedRect.w===p.paddedRect.w&&h.paddedRect.h===p.paddedRect.h||jt(`Mismatch in icon variant sizes: ${c.toString()} and ${r.toString()}`),h.usvg!==p.usvg&&jt(`Mismatch in icon variant image types: ${c.id} and ${r.id}`))}function fk(c,r,l,h){if(!c)return;const p=r.get(l.toString());if(c.imagePrimary=p,h){const v=r.get(h.toString());c.imageSecondary=v}}function N9(c,r){for(const l in c.horizontal)pk(c.horizontal[l],r);pk(c.vertical,r)}function pk(c,r){if(c){for(const l of c.positionedLines)for(const h of l.positionedGlyphs)if(h.image!==null){const p=h.image.toString();h.rect=r.get(p).paddedRect}}}function M2(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function B9(c,r,l,h,p,v,_,w,T){const M=R2(v.horizontal)||v.vertical,L=l.get("icon-text-fit-padding").evaluate(h,{},p);let z,F=r;return r&&T!=="none"&&(c.allowVerticalPlacement&&v.vertical&&(z=S2(r,v.vertical,T,L,w,_)),M&&(F=S2(r,M,T,L,w,_))),{defaultShapedIcon:F,verticallyShapedIcon:z}}function $9(c,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he,me,be,Ne){let Ae=_.textMaxSize.evaluate(r,{},F);Ae===void 0?Ae=w*_.textScaleFactor:Ae*=_.textScaleFactor;const He=c.layers[0].layout,Ze=Aa,et=w*_.textScaleFactor/Ze,Tt=R2(l.horizontal)||l.vertical;if(oe!=="none"&&c.appearanceFeatureData&&r.index<c.appearanceFeatureData.length){const Ht=c.appearanceFeatureData[r.index];Ht&&(Ht.textShaping=Tt,Ht.iconTextFitPadding=He.get("icon-text-fit-padding").evaluate(r,{},F),Ht.fontScale=et)}const ct=G.name==="globe",At=c.tilePixelRatio*Ae/Ze,Bt=(wt=c.overscaling,c.zoom>18&&wt>2&&(wt>>=1),Math.max(fn/(512*wt),1)*He.get("symbol-spacing")),qt=He.get("text-padding")*c.tilePixelRatio,cn=He.get("icon-padding")*c.tilePixelRatio,en=Gt(He.get("text-max-angle")),Vt=He.get("icon-rotation-alignment")==="map"&&me!=="point",Yt=Bt/2;var wt;c.hasAnyIconTextFit===!1&&oe!=="none"&&(c.hasAnyIconTextFit=!0);const _t=r.properties?+r.properties[wn]:null,Xt=_t&&c.elevationFeatureIdToIndex?c.elevationFeatureIdToIndex.get(_t):65535,sn=(Ht,An,Bn)=>{if(An.x<0||An.x>=fn||An.y<0||An.y>=fn)return;let Sn=null;if(ct){const{x:vn,y:Cr,z:xn}=G.projectTilePoint(An.x,An.y,Bn);Sn={anchor:new md(vn,Cr,xn,0,void 0),up:G.upVector(Bn,An.x,An.y)}}(function(vn,Cr,xn,or,Pr,Gr,pi,Or,bi,wi,so,Oe,Pe,Ot,gn,Dt,_n,Wn,Gn,Lr,dr,Vn,_i,Fi,pr,hi,Ni,Ri,_o,Zi,Hi){const Di=vn.addToLineVertexArray(Cr,or);let Si,zr,Ci,Gi,hr,mi,Yi,To=0,ko=0,na=0,Ji=0,Xo=-1,Is=-1;const Zo={};let nl=Pf("");const Wa=xn?xn.anchor:Cr,kl=Ri!=="none";let Ps=0,rl=0;if(bi._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Oa=bi.layout.get("text-offset").evaluate(dr,{},pr);Ps=Oa[0]*Aa,rl=Oa[1]*Aa}else Ps=bi.layout.get("text-radial-offset").evaluate(dr,{},pr)*Aa,rl=P2;if(vn.allowVerticalPlacement&&Pr.vertical){const Oa=Pr.vertical;if(gn)mi=A2(Oa),Or&&(Yi=A2(Or));else{const cs=bi.layout.get("text-rotate").evaluate(dr,{},pr)+90;Ci=V1(wi,Wa,Cr,so,Oe,Pe,Oa,Ot,cs,Dt),Or&&(Gi=V1(wi,Wa,Cr,so,Oe,Pe,Or,Wn,cs,null,Hi))}}if(Gr){const Oa=vn.iconSizeData,cs=bi.layout.get("icon-rotate").evaluate(dr,{},pr),xu=I2(Gr,cs,_i,kl,Vn.iconScaleFactor),Mh=Or?I2(Or,cs,_i,kl,Vn.iconScaleFactor):void 0;zr=V1(wi,Wa,Cr,so,Oe,Pe,Gr,Wn,cs,null,Zi);const Rg=function(bu,ow,Ag,Qq,DF,LF,eK,tK){const zF=bu.layers[0],kF=zF.appearances;let Og=ow.length;if(Ag&&(Og=Math.max(Og,Ag.length)),kF.length===0)return Og;const[nK,rK]=Qq.get("icon-size-scale-range"),iK=ie(1,nK,rK);for(const FF of kF){const NF=FF.getUnevaluatedProperties();if(NF._values["icon-image"].value!==void 0){const BF=zF.getAppearanceValueAndResolveTokens(FF,"icon-image",DF,LF,[]);if(BF){const $F=bu.getResolvedImageFromTokens(BF);if($F){const jF=NF._values["icon-size"],oK=By($F,xg(bu.zoom,jF,bu.worldview),jF,LF,bu.zoom,DF,bu.pixelRatio,iK,bu.worldview),aK=eK.get(oK.iconPrimary.toString());Og=Math.max(Og,R9(aK,tK))}}}}return Og}(vn,xu,Mh,bi.layout,dr,pr,vn.iconAtlasPositions,kl);To=4*Rg;let Rh=null;Oa.kind==="source"?(Rh=[Dc*bi.layout.get("icon-size").evaluate(dr,{},pr)*Vn.iconScaleFactor],Rh[0]>gd&&jt(`${vn.layerIds[0]}: Value for "icon-size" is >= ${$y}. Reduce your "icon-size".`)):Oa.kind==="composite"&&(Rh=[Dc*Vn.compositeIconSizes[0].evaluate(dr,{},pr)*Vn.iconScaleFactor,Dc*Vn.compositeIconSizes[1].evaluate(dr,{},pr)*Vn.iconScaleFactor],(Rh[0]>gd||Rh[1]>gd)&&jt(`${vn.layerIds[0]}: Value for "icon-size" is >= ${$y}. Reduce your "icon-size".`)),vn.addSymbols(vn.icon,xu,Rh,Lr,Gn,dr,void 0,xn,Cr,Di.lineStartIndex,Di.lineLength,-1,Fi,pr,hi,Ni,vn.symbolInstances.length,Rg),Xo=vn.icon.placedSymbolArray.length-1,Mh&&(ko=4*Rg,vn.addSymbols(vn.icon,Mh,Rh,Lr,Gn,dr,tl.vertical,xn,Cr,Di.lineStartIndex,Di.lineLength,-1,Fi,pr,hi,Ni,vn.symbolInstances.length,Rg),Is=vn.icon.placedSymbolArray.length-1)}for(const Oa in Pr.horizontal){const cs=Oa,xu=Pr.horizontal[cs];Si||(nl=Pf(xu.text),gn?hr=A2(xu):Si=V1(wi,Wa,Cr,so,Oe,Pe,xu,Ot,bi.layout.get("text-rotate").evaluate(dr,{},pr),Dt));const Mh=xu.positionedLines.length===1;if(na+=mk(vn,xn,Cr,xu,pi,bi,gn,dr,Dt,Di,Pr.vertical?tl.horizontal:tl.horizontalOnly,Mh?L9(Pr.horizontal):[cs],Zo,Xo,Vn,Fi,pr,vn.symbolInstances.length,hi),Mh)break}Pr.vertical&&(Ji+=mk(vn,xn,Cr,Pr.vertical,pi,bi,gn,dr,Dt,Di,tl.vertical,["vertical"],Zo,Is,Vn,Fi,pr,vn.symbolInstances.length,hi));let qa=-1;const il=(Oa,cs)=>Oa?Math.max(Oa,cs):cs;qa=il(hr,qa),qa=il(mi,qa),qa=il(Yi,qa);const Fl=qa>-1?1:0;vn.glyphOffsetArray.length>=65535&&jt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),dr.sortKey!==void 0&&vn.addToSortKeyRanges(vn.symbolInstances.length,dr.sortKey),vn.symbolInstances.emplaceBack(Cr.x,Cr.y,Wa.x,Wa.y,Wa.z,Zo.right>=0?Zo.right:-1,Zo.center>=0?Zo.center:-1,Zo.left>=0?Zo.left:-1,Zo.vertical>=0?Zo.vertical:-1,Xo,Is,nl,Si!==void 0?Si:vn.collisionBoxArray.length,Si!==void 0?Si+1:vn.collisionBoxArray.length,Ci!==void 0?Ci:vn.collisionBoxArray.length,Ci!==void 0?Ci+1:vn.collisionBoxArray.length,zr!==void 0?zr:vn.collisionBoxArray.length,zr!==void 0?zr+1:vn.collisionBoxArray.length,Gi||vn.collisionBoxArray.length,Gi?Gi+1:vn.collisionBoxArray.length,so,na,Ji,To,ko,Fl,0,Ps,rl,qa,0,kl?1:0,_o)})(c,An,Sn,Ht,l,h,v,p,c.layers[0],c.collisionBoxArray,r.index,r.sourceLayerIndex,c.index,qt,he,M,0,cn,Vt,le,r,_,L,z,F,W,J,oe,Xt,be,Ne)};if(me==="line")for(const Ht of S1(r.geometry,0,0,fn,fn)){const An=M9(Ht,Bt,en,l.vertical||Tt,h,Ze,At,c.overscaling,fn);for(const Bn of An)Tt&&j9(c,Tt.text,Yt,Bn)||sn(Ht,Bn,F)}else if(me==="line-center"){for(const Ht of r.geometry)if(Ht.length>1){const An=P9(Ht,en,l.vertical||Tt,h,Ze,At);An&&sn(Ht,An,F)}}else if(r.type==="Polygon")for(const Ht of wy(r.geometry,0)){const An=O9(Ht,16);sn(Ht[0],new md(An.x,An.y,0,0,void 0),F)}else if(r.type==="LineString")for(const Ht of r.geometry)sn(Ht,new md(Ht[0].x,Ht[0].y,0,0,void 0),F);else if(r.type==="Point")for(const Ht of r.geometry)for(const An of Ht)sn([An],new md(An.x,An.y,0,0,void 0),F)}const $y=255,gd=$y*Dc;function mk(c,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he){const me=function(Ae,He,Ze,et,Tt,ct,At,Bt){const qt=[];if(He.positionedLines.length===0)return qt;const cn=et.layout.get("text-rotate").evaluate(ct,{})*Math.PI/180,en=function(Xt){const sn=Xt[0],Ht=Xt[1],An=sn*Ht;return An>0?[sn,-Ht]:An<0?[-sn,Ht]:sn===0?[Ht,sn]:[Ht,-sn]}(Ze);let Vt=Math.abs(He.top-He.bottom);for(const Xt of He.positionedLines)Vt-=Xt.lineOffset;const Yt=He.positionedLines.length,wt=Vt/Yt;let _t=He.top-Ze[1];for(let Xt=0;Xt<Yt;++Xt){const sn=He.positionedLines[Xt];_t=A9(He,wt,_t,Xt);for(const Ht of sn.positionedGlyphs){if(!Ht.rect)continue;const An=Ht.rect||{};let Bn=Uz+1,Sn=!0,vn=1,Cr=0;if(Ht.image){const Gn=At.get(Ht.image.toString());if(!Gn)continue;if(Gn.sdf){jt("SDF images are not supported in formatted text and will be ignored.");continue}Sn=!1,vn=Gn.pixelRatio,Bn=fp/vn}const xn=(Tt||Bt)&&Ht.vertical,or=Ht.metrics.advance*Ht.scale/2,Pr=Ht.metrics,Gr=Ht.rect;if(Gr===null)continue;Bt&&He.verticalizable&&(Cr=Ht.image?or-Ht.metrics.width*Ht.scale/2:0);const pi=Tt?[Ht.x+or,Ht.y]:[0,0];let Or=[0,0],bi=[0,0],wi=!1;Tt||(xn?(bi=[Ht.x+or+en[0],Ht.y+en[1]-Cr],wi=!0):Or=[Ht.x+or+Ze[0],Ht.y+Ze[1]-Cr]);const so=Gr.w*Ht.scale/(vn*(Ht.localGlyph?Lc:1)),Oe=Gr.h*Ht.scale/(vn*(Ht.localGlyph?Lc:1));let Pe,Ot,gn,Dt;if(xn){const Gn=Ht.y-_t,Lr=new ut(-or,or-Gn),dr=-Math.PI/2,Vn=new ut(...bi);Pe=new ut(-or+Or[0],Or[1]),Pe._rotateAround(dr,Lr)._add(Vn),Pe.x+=-Gn+or,Pe.y-=(Pr.left-Bn)*Ht.scale;const _i=Ht.image?Pr.advance*Ht.scale:Aa*Ht.scale,Fi=String.fromCodePoint(Ht.glyph);h9(Fi)?Pe.x+=(1-Bn)*Ht.scale:f9(Fi)?Pe.x+=_i-Pr.height*Ht.scale+(-Bn-1)*Ht.scale:Pe.x+=Ht.image||Pr.width+2*Bn===Gr.w&&Pr.height+2*Bn===Gr.h?(_i-Oe)/2:(_i-(Pr.height+2*Bn)*Ht.scale)/2,Ot=new ut(Pe.x,Pe.y-so),gn=new ut(Pe.x+Oe,Pe.y),Dt=new ut(Pe.x+Oe,Pe.y-so)}else{const Gn=(Pr.left-Bn)*Ht.scale-or+Or[0],Lr=(-Pr.top-Bn)*Ht.scale+Or[1],dr=Gn+so,Vn=Lr+Oe;Pe=new ut(Gn,Lr),Ot=new ut(dr,Lr),gn=new ut(Gn,Vn),Dt=new ut(dr,Vn)}if(cn){let Gn;Gn=Tt?new ut(0,0):wi?new ut(en[0],en[1]):new ut(Ze[0],Ze[1]),Pe._rotateAround(cn,Gn),Ot._rotateAround(cn,Gn),gn._rotateAround(cn,Gn),Dt._rotateAround(cn,Gn)}const _n=new ut(0,0),Wn=new ut(0,0);qt.push({tl:Pe,tr:Ot,bl:gn,br:Dt,texPrimary:An,texSecondary:void 0,writingMode:He.writingMode,glyphOffset:pi,sectionIndex:Ht.sectionIndex,isSDF:Sn,pixelOffsetTL:_n,pixelOffsetBR:Wn,minFontScaleX:0,minFontScaleY:0})}}return qt}(0,h,T,v,_,w,p,c.allowVerticalPlacement),be=c.textSizeData;let Ne=null;be.kind==="source"?(Ne=[Dc*v.layout.get("text-size").evaluate(w,{},oe)*W.textScaleFactor],Ne[0]>gd&&jt(`${c.layerIds[0]}: Value for "text-size" is >= ${$y}. Reduce your "text-size".`)):be.kind==="composite"&&(Ne=[Dc*W.compositeTextSizes[0].evaluate(w,{},oe)*W.textScaleFactor,Dc*W.compositeTextSizes[1].evaluate(w,{},oe)*W.textScaleFactor],(Ne[0]>gd||Ne[1]>gd)&&jt(`${c.layerIds[0]}: Value for "text-size" is >= ${$y}. Reduce your "text-size".`)),c.addSymbols(c.text,me,Ne,T,_,w,L,r,l,M.lineStartIndex,M.lineLength,G,J,oe,he,!1,le,me.length);for(const Ae of z)F[Ae]=c.text.placedSymbolArray.length-1;return 4*me.length}function R2(c){for(const r in c)return c[r];return null}function V1(c,r,l,h,p,v,_,w,T,M,L){let z,F,G,W;if(z=L?L.top:_.top,F=L?L.bottom:_.bottom,G=L?L.left:_.left,W=L?L.right:_.right,Xz(_)&&_.collisionPadding){const J=_.collisionPadding;G-=J[0],z-=J[1],W+=J[2],F+=J[3]}if(T){const J=new ut(G,z),oe=new ut(W,z),le=new ut(G,F),he=new ut(W,F),me=Gt(T);let be=new ut(0,0);M&&(be=new ut(M[0],M[1])),J._rotateAround(me,be),oe._rotateAround(me,be),le._rotateAround(me,be),he._rotateAround(me,be),G=Math.min(J.x,oe.x,le.x,he.x),W=Math.max(J.x,oe.x,le.x,he.x),z=Math.min(J.y,oe.y,le.y,he.y),F=Math.max(J.y,oe.y,le.y,he.y)}return c.emplaceBack(r.x,r.y,r.z,l.x,l.y,G,z,W,F,w,h,p,v),c.length-1}function A2(c){Xz(c)&&c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const r=c.bottom-c.top;return r>0?Math.max(10,r):null}function j9(c,r,l,h){const p=c.compareText;if(r in p){const v=p[r];for(let _=v.length-1;_>=0;_--)if(h.dist(v[_])<l)return!0}else p[r]=[];return p[r].push(h),!1}function gk(c,r){const l=c.fovAboveCenter,h=c.elevation?c.elevation.getMinElevationBelowMSL()*r:0,p=(c._camera.position[2]*c.worldSize-h)/Math.cos(c._pitch),v=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-c._pitch-l,.01));let _=Math.sin(c._pitch)*v+p;const w=p*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let T=Math.max(c.zoom-17,0);c.isOrthographic&&(T/=10),_*=1+T}return Math.min(1.01*_,w)}function jy(c,r){if(!r.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:r};const l=Math.pow(2,-c.z),h=c.x*l,p=(c.x+1)*l,v=c.y*l,_=(c.y+1)*l,w=Ce(h),T=Ce(p),M=ve(v),L=ve(_),z=r.project(w,M),F=r.project(T,M),G=r.project(T,L),W=r.project(w,L);let J=Math.min(z.x,F.x,G.x,W.x),oe=Math.min(z.y,F.y,G.y,W.y),le=Math.max(z.x,F.x,G.x,W.x),he=Math.max(z.y,F.y,G.y,W.y);const me=l/16;function be(Ae,He,Ze,et,Tt,ct){const At=(Ze+Tt)/2,Bt=(et+ct)/2,qt=r.project(Ce(At),ve(Bt)),cn=Math.max(0,J-qt.x,oe-qt.y,qt.x-le,qt.y-he);J=Math.min(J,qt.x),le=Math.max(le,qt.x),oe=Math.min(oe,qt.y),he=Math.max(he,qt.y),cn>me&&(be(Ae,qt,Ze,et,At,Bt),be(qt,He,At,Bt,Tt,ct))}be(z,F,h,v,p,v),be(F,G,p,v,p,_),be(G,W,p,_,h,_),be(W,z,h,_,h,v),J-=me,oe-=me,le+=me,he+=me;const Ne=1/Math.max(le-J,he-oe);return{scale:Ne,x:J*Ne,y:oe*Ne,x2:le*Ne,y2:he*Ne,projection:r}}function vk(c,{x:r,y:l},h=0){return new ut(((r-h)*c.scale-c.x)*fn,(l*c.scale-c.y)*fn)}const V9=N(new Float32Array(16));class Ih{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,l){return{x:0,y:0,z:0}}unproject(r,l){return new q(0,0)}projectTilePoint(r,l,h){return{x:r,y:l,z:0}}locationPoint(r,l,h,p=!0){return r._coordinatePoint(r.locationCoordinate(l,h),p)}pixelsPerMeter(r,l){return pe(1,r)*l}pixelSpaceConversion(r,l,h){return 1}farthestPixelDistance(r){return gk(r,r.pixelsPerMeter)}pointCoordinate(r,l,h,p){const v=r.horizonLineFromTop(!1),_=new ut(l,Math.max(v,h));return r.rayIntersectionCoordinate(r.pointRayIntersection(_,p))}pointCoordinate3D(r,l,h){const p=new ut(l,h);if(r.elevation)return r.elevation.pointCoordinate(p);{const v=this.pointCoordinate(r,p.x,p.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(r,l){if(r.elevation&&r.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(r,l.x,l.y);const h=r.horizonLineFromTop();return l.y<h}createInversionMatrix(r,l){return V9}createTileMatrix(r,l,h){let p,v,_;const w=h.canonical,T=N(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=jy(w,this);p=1,v=M.x+h.wrap*M.scale,_=M.y,Y(T,T,[p/M.scale,p/M.scale,r.pixelsPerMeter/l])}else p=l/r.zoomScale(w.z),v=(w.x+Math.pow(2,w.z)*h.wrap)*p,_=w.y*p;return K(T,T,[v,_,0]),Y(T,T,[p/fn,p/fn,1]),T}upVector(r,l,h){return[0,0,1]}upVectorScale(r,l,h){return{metersToTile:1}}}class U9 extends Ih{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[l,h]=this.parallels=r.parallels||[29.5,45.5],p=Math.sin(Gt(l));this.n=(p+Math.sin(Gt(h)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(r,l){const{n:h,c:p,r0:v}=this,_=Gt(r-this.center[0]),w=Gt(l),T=Math.sqrt(p-2*h*Math.sin(w))/h;return{x:T*Math.sin(_*h),y:T*Math.cos(_*h)-v,z:0}}unproject(r,l){const{n:h,c:p,r0:v}=this,_=v+l;let w=Math.atan2(r,Math.abs(_))*Math.sign(_);_*h<0&&(w-=Math.PI*Math.sign(r)*Math.sign(_));const T=Gt(this.center[0])*h;w=Re(w,-Math.PI-T,Math.PI-T);const M=ie(mn(w/h)+this.center[0],-180,180),L=Math.asin(ie((p-(r*r+_*_)*h*h)/(2*h),-1,1)),z=ie(mn(L),-Ie,Ie);return new q(M,z)}}const Vy=1.340264,Uy=-.081106,Hy=893e-6,Gy=.003796,U1=Math.sqrt(3)/2;class H9 extends Ih{project(r,l){l=l/180*Math.PI,r=r/180*Math.PI;const h=Math.asin(U1*Math.sin(l)),p=h*h,v=p*p*p;return{x:.5*(r*Math.cos(h)/(U1*(Vy+3*Uy*p+v*(7*Hy+9*Gy*p)))/Math.PI+.5),y:1-.5*(h*(Vy+Uy*p+v*(Hy+Gy*p))/Math.PI+1),z:0}}unproject(r,l){r=(2*r-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,p=h*h,v=p*p*p;for(let L,z,F,G=0;G<12&&(z=h*(Vy+Uy*p+v*(Hy+Gy*p))-l,F=Vy+3*Uy*p+v*(7*Hy+9*Gy*p),L=z/F,h=ie(h-L,-Math.PI/3,Math.PI/3),p=h*h,v=p*p*p,!(Math.abs(L)<1e-12));++G);const _=U1*r*(Vy+3*Uy*p+v*(7*Hy+9*Gy*p))/Math.cos(h),w=Math.asin(Math.sin(h)/U1),T=ie(180*_/Math.PI,-180,180),M=ie(180*w/Math.PI,-Ie,Ie);return new q(T,M)}}class G9 extends Ih{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,l){return{x:.5+r/360,y:.5-l/360,z:0}}unproject(r,l){const h=360*(r-.5),p=ie(360*(.5-l),-Ie,Ie);return new q(h,p)}}const Cg=Math.PI/2;function H1(c){return Math.tan((Cg+c)/2)}class W9 extends Ih{constructor(r){super(r),this.center=r.center||[0,30];const[l,h]=this.parallels=r.parallels||[30,30];let p=Gt(l),v=Gt(h);this.southernCenter=p+v<0,this.southernCenter&&(p=-p,v=-v);const _=Math.cos(p),w=H1(p);this.n=p===v?Math.sin(p):Math.log(_/Math.cos(v))/Math.log(H1(v)/w),this.f=_*Math.pow(H1(p),this.n)/this.n}project(r,l){l=Gt(l),this.southernCenter&&(l=-l),r=Gt(r-this.center[0]);const h=1e-6,{n:p,f:v}=this;v>0?l<-Cg+h&&(l=-Cg+h):l>Cg-h&&(l=Cg-h);const _=v/Math.pow(H1(l),p);let w=_*Math.sin(p*r),T=v-_*Math.cos(p*r);return w=.5*(w/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:w,y:this.southernCenter?T:1-T,z:0}}unproject(r,l){r=(2*r-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:h,f:p}=this,v=p-l,_=Math.sign(v),w=Math.sign(h)*Math.sqrt(r*r+v*v);let T=Math.atan2(r,Math.abs(v))*_;v*h<0&&(T-=Math.PI*Math.sign(r)*_);const M=ie(mn(T/h)+this.center[0],-180,180),L=ie(mn(2*Math.atan(Math.pow(p/w,1/h))-Cg),-Ie,Ie);return new q(M,this.southernCenter?-L:L)}}class _k extends Ih{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,l){return{x:ue(r),y:ce(l),z:0}}unproject(r,l){const h=Ce(r),p=ve(l);return new q(h,p)}}const yk=Gt(Ie);class q9 extends Ih{project(r,l){const h=(l=Gt(l))*l,p=h*h;return{x:.5*((r=Gt(r))*(.8707-.131979*h+p*(p*(.003971*h-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+h*(.015085+p*(.028874*h-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(r,l){r=(2*r-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,p=25,v=0,_=h*h;do{_=h*h;const M=_*_;v=(h*(1.007226+_*(.015085+M*(.028874*_-.044475-.005916*M)))-l)/(1.007226+_*(.045255+M*(.259866*_-.311325-.005916*11*M))),h=ie(h-v,-yk,yk)}while(Math.abs(v)>1e-6&&--p>0);_=h*h;const w=ie(mn(r/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),T=mn(h);return new q(w,T)}}const xk=Gt(Ie);class K9 extends Ih{project(r,l){l=Gt(l),r=Gt(r);const h=Math.cos(l),p=2/Math.PI,v=Math.acos(h*Math.cos(r/2)),_=Math.sin(v)/v,w=.5*(r*p+2*h*Math.sin(r/2)/_)||0,T=.5*(l+Math.sin(l)/_)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(r,l){let h=r=(2*r-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,v=25;const _=1e-6;let w=0,T=0;do{const M=Math.cos(p),L=Math.sin(p),z=2*L*M,F=L*L,G=M*M,W=Math.cos(h/2),J=Math.sin(h/2),oe=2*W*J,le=J*J,he=1-G*W*W,me=he?1/he:0,be=he?Math.acos(M*W)*Math.sqrt(1/he):0,Ne=.5*(2*be*M*J+2*h/Math.PI)-r,Ae=.5*(be*L+p)-l,He=.5*me*(G*le+be*M*W*F)+1/Math.PI,Ze=me*(oe*z/4-be*L*J),et=.125*me*(z*J-be*L*G*oe),Tt=.5*me*(F*W+be*le*M)+.5,ct=Ze*et-Tt*He;w=(Ae*Ze-Ne*Tt)/ct,T=(Ne*et-Ae*He)/ct,h=ie(h-w,-Math.PI,Math.PI),p=ie(p-T,-xk,xk)}while((Math.abs(w)>_||Math.abs(T)>_)&&--v>0);return new q(mn(h),mn(p))}}class bk extends Ih{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Gt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,l){const{scale:h,cosPhi:p}=this;return{x:Gt(r)*p*h+.5,y:-Math.sin(Gt(l))/p*h+.5,z:0}}unproject(r,l){const{scale:h,cosPhi:p}=this,v=-(l-.5)/h,_=ie(mn((r-.5)/h)/p,-180,180),w=Math.asin(ie(v*p,-1,1)),T=ie(mn(w),-Ie,Ie);return new q(_,T)}}class X9 extends _k{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,l,h){const p=gy(r,l,h);return yt(p,p,p1(vu(h))),{x:p[0],y:p[1],z:p[2]}}locationPoint(r,l,h){const p=O(l.lat,l.lng),v=ft([],p),_=h?r._centerAltitude+h:r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(l),r._centerAltitude):r._centerAltitude;at(p,p,v,pe(1,0)*fn*_);const w=N(new Float64Array(16));return V(w,r.pixelMatrix,r.globeMatrix),yt(p,p,w),new ut(p[0],p[1])}pixelsPerMeter(r,l){return pe(1,0)*l}pixelSpaceConversion(r,l,h){const p=pe(1,r)*l,v=vr(pe(1,45)*l,p,h);return this.pixelsPerMeter(r,l)/v}createTileMatrix(r,l,h){const p=FT(vu(h.canonical));return V(new Float64Array(16),r.globeMatrix,p)}createInversionMatrix(r,l){const{center:h}=r,p=p1(vu(l));return te(p,p,Gt(h.lng)),Z(p,p,Gt(h.lat)),Y(p,p,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(r,l,h,p){return GD(r,l,h,!0)||new st(0,0)}pointCoordinate3D(r,l,h){const p=this.pointCoordinate(r,l,h,0);return[p.x,p.y,p.z]}isPointAboveHorizon(r,l){return!GD(r,l.x,l.y,!1)}farthestPixelDistance(r){const l=function(p,v){const _=p.cameraToCenterDistance,w=p._centerAltitude*v,T=p._camera,M=p._camera.forward(),L=ze([],qe([],M,-_),[0,0,w]),z=p.worldSize/(2*Math.PI),F=[0,0,-z],G=p.width/p.height,W=Math.tan(p.fovAboveCenter),J=qe([],T.up(),W),oe=qe([],T.right(),W*G),le=ft([],ze([],ze([],M,J),oe)),he=[];let me;if(new kr(L,le).closestPointOnSphere(F,z,he)){const be=ze([],he,F),Ne=Zt([],be,L);me=Math.cos(p.fovAboveCenter)*Se(Ne)}else{const be=Zt([],L,F),Ne=Zt([],F,L);ft(Ne,Ne);const Ae=Se(be)-z;me=Math.sqrt(Ae*(Ae+2*z));const He=Math.acos(me/(z+Ae))-Math.acos(Nt(M,Ne));me*=Math.cos(He)}return 1.01*me}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),h=Sh(r.zoom);if(h>0){const p=gk(r,pe(1,r.center.lat)*r.worldSize),v=r.worldSize/(2*Math.PI),_=Math.max(r.width,r.height)/r.worldSize*Math.PI;return vr(l,p+v*(1-Math.cos(_)),Math.pow(h,10))}return l}upVector(r,l,h){return gy(l,h,r,1)}upVectorScale(r){return{metersToTile:d1(f1(vu(r)))}}}function wk(c){const r=c.parallels,l=!!r&&Math.abs(r[0]+r[1])<.01;switch(c.name){case"mercator":return new _k(c);case"equirectangular":return new G9(c);case"naturalEarth":return new q9(c);case"equalEarth":return new H9(c);case"winkelTripel":return new K9(c);case"albers":return l?new bk(c):new U9(c);case"lambertConformalConic":return l?new bk(c):new W9(c);case"globe":return new X9(c)}throw new Error(`Invalid projection name: ${c.name}`)}const Z9=Kt.types,Y9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wy(c,r,l,h,p,v,_,w,T,M,L,z,F){const G=w?Math.min(gd,Math.round(w[0])):0,W=w?Math.min(gd,Math.round(w[1])):0;c.emplaceBack(r,l,Math.round(32*h),Math.round(32*p),v,_,(G<<1)+(T?1:0),0+(W<<1),16*M,16*L,256*z,256*F)}function qy(c,r,l){c.emplaceBack(r,l)}function Ky(c,r,l,h,p,v,_){c.emplaceBack(r,l,h,p,v,_)}const G1=(c,r,l,h)=>{for(let p=0;p<r;p++)c.emplaceBack(l[0],l[1],l[2],h[0],h[1],h[2])};function Eg(c,r,l,h,p){c.emplaceBack(r,l,h,p),c.emplaceBack(r,l,h,p),c.emplaceBack(r,l,h,p),c.emplaceBack(r,l,h,p)}function J9(c){for(const r of c.sections)if(xT(r.text))return!0;return!1}class O2{constructor(r){this.layoutVertexArray=new Qm,this.indexArray=new to,this.programConfigurations=r,this.segments=new po,this.dynamicLayoutVertexArray=new mu,this.opacityVertexArray=new ey,this.placedSymbolArray=new np,this.iconTransitioningVertexArray=new yl,this.globeExtVertexArray=new ph,this.zOffsetVertexArray=new Pc,this.orientationVertexArray=new ry,this.symbolInstanceIndices=[]}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}getIconVertexData(r,l){const h=[],p=this.layoutVertexArray.uint16;for(let v=0;v<l;++v){const _=12*(r+v);h.push(...p.slice(_,_+12))}return h}updateIconVertexData(r,l,h,p,v,_,w,T,M,L,z,F,G){const W=this.layoutVertexArray.uint16,J=12*r;W[J]=l,W[J+1]=h,W[J+2]=p,W[J+3]=v,W[J+4]=_,W[J+5]=w,W[J+6]=T,W[J+7]=M,W[J+8]=L,W[J+9]=z,W[J+10]=F,W[J+11]=G}upload(r,l,h,p,v,_){this.isEmpty()||(h&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,n9.members,!!_),this.indexBuffer=r.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,i9.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,Y9,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,s9.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,r9.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||v)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,o9.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=r.createVertexBuffer(this.orientationVertexArray,a9.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Dn(O2,"SymbolBuffers");class D2{constructor(r,l,h){this.layoutVertexArray=new r,this.layoutAttributes=l,this.indexArray=new h,this.segments=new po,this.collisionVertexArray=new gh,this.collisionVertexArrayExt=new mu}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,l9.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,c9.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Dn(D2,"CollisionBuffers");class W1{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=N([]),this.placementViewportMatrix=N([]);const l=this.layers[0]._unevaluatedLayout._values;this.worldview=r.worldview,this.textSizeData=xg(this.zoom,l["text-size"],this.worldview),this.iconSizeData=xg(this.zoom,l["icon-size"],this.worldview);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.lut=r.lut,this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(_=>tl[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1,this.hasAppearances=null,this.lastActiveApperance=null}hasAnyAppearanceProperty(r){const l=this.layers[0].getAppearances();return!(!l||l.length===0)&&l.some(h=>h.getProperty(r)!=null)}createArrays(){this.text=new O2(new Ll(this.layers,{zoom:this.zoom,lut:this.lut},r=>r.startsWith("text")||r.startsWith("symbol"))),this.icon=new O2(new Ll(this.layers,{zoom:this.zoom,lut:this.lut},r=>r.startsWith("icon")||r.startsWith("symbol"))),this.glyphOffsetArray=new uy,this.lineVertexArray=new t1,this.symbolInstances=new e1}calculateGlyphDependencies(r,l,h,p,v){for(const _ of r){const w=_.codePointAt(0);if(w===void 0)break;if(l[w]=!0,p&&v&&w<=65535){const T=zy[_];T&&(l[T.charCodeAt(0)]=!0)}}}calculateEffectiveAppearanceIconSize(r,l,h,p,v,_){let w=1;const T=r.getUnevaluatedProperties()._values["icon-size"],M=xg(this.zoom,T,this.worldview),L=bg(M,l);if(M.kind!=="constant"&&M.kind!=="camera"||(w=L.uSize),M.kind==="composite"){const{minZoom:z,maxZoom:F}=M,G=T.possiblyEvaluate(new Wi(z,{worldview:this.worldview}),p),W=T.possiblyEvaluate(new Wi(F,{worldview:this.worldview}),p),J=G.evaluate(h,{},p,v);w=J+(W.evaluate(h,{},p,v)-J)*L.uSizeT}return M.kind==="source"&&(w=T.possiblyEvaluate(new Wi(this.zoom,{worldview:this.worldview}),p).evaluate(h,{},p,v)),w*_}updateFootprints(r,l){}updateReplacement(r,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(r.toUnwrapped(),!0);return!x1(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}getResolvedImageFromTokens(r){return typeof r=="string"?gs.build(r):r}populate(r,l,h,p){const v=this.layers[0],_=v.layout,w=this.projection.name==="globe",T=_.get("text-font"),M=_.get("text-field"),L=_.get("icon-image"),[z,F]=_.get("icon-size-scale-range"),G=ie(l.scaleFactor||1,z,F),W=(M.value.kind!=="constant"||M.value.value instanceof xa&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),J=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,oe=this.hasAnyAppearanceProperty("icon-image"),le=_.get("symbol-sort-key");if(this.features=[],this.appearanceFeatureData=[],!W&&!J&&!oe)return;const he=l.iconDependencies,me=l.glyphDependencies,be=l.availableImages,Ne=new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),Ae=He=>{const Ze=He.id.toString();he.has(Ze)?he.get(Ze).push(He):he.set(Ze,[He])};for(const He of r){const{feature:Ze,id:et,index:Tt,sourceLayerIndex:ct}=He,At=v._featureFilter.needGeometry,Bt=gt(Ze,At);if(!v._featureFilter.filter(Ne,Bt,h))continue;if(At||(Bt.geometry=kt(Ze,h,p)),w&&Ze.type!==1&&h.z<=5){const Xt=Bt.geometry,sn=.98078528056,Ht=(An,Bn)=>Nt(gy(An.x,An.y,h,1),gy(Bn.x,Bn.y,h,1))<sn;for(let An=0;An<Xt.length;An++)Xt[An]=Lt(Xt[An],Ht)}let qt,cn;if(W){const Xt=v.getValueAndResolveTokens("text-field",Bt,h,be),sn=xa.factory(Xt);J9(sn)&&(this.hasRTLText=!0),(!this.hasRTLText||G_()==="unavailable"||this.hasRTLText&&Ts.isParsed())&&(qt=d9(sn,v,Bt))}if(J){const Xt=v.getValueAndResolveTokens("icon-image",Bt,h,be);cn=this.getResolvedImageFromTokens(Xt)}const en=this.layers[0];let Vt=!1;if(!cn&&oe){const Xt=en.getAppearances();for(const sn of Xt)if(sn.getProperty("icon-image")){const Ht=en.getAppearanceValueAndResolveTokens(sn,"icon-image",Bt,h,be);if(Ht){cn=this.getResolvedImageFromTokens(Ht),Vt=!0;break}}}if(!qt&&!cn)continue;const Yt=this.sortFeaturesByKey?le.evaluate(Bt,{},h):void 0,wt={id:et,text:qt,icon:cn,index:Tt,sourceLayerIndex:ct,geometry:Bt.geometry,properties:Ze.properties,type:Z9[Ze.type],sortKey:Yt};if(this.features.push(wt),this.appearanceFeatureData.push({id:et,properties:Ze.properties,usesAppearanceIconAsPlaceholder:Vt,isUsingAppearanceVertexData:!1,layoutBasedVertexData:[],activeAppearance:null}),cn){const Xt=en._unevaluatedLayout._values,{iconPrimary:sn,iconSecondary:Ht}=By(cn,this.iconSizeData,Xt["icon-size"],h,this.zoom,wt,this.pixelRatio,G,this.worldview);Ae(sn),Ht&&(this.hasAnySecondaryIcon=!0,Ae(Ht))}const _t=en.getAppearances();if(_t.length!==0&&_t.forEach(Xt=>{if(!Xt.getProperty("icon-image"))return;const sn=this.getCombinedIconPrimary(Xt,en,Bt,h,be,wt,G);sn&&Ae(sn)}),qt){const Xt=T.evaluate(Bt,{},h).join(","),sn=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(tl.vertical)>=0;for(const Ht of qt.sections)if(Ht.image){const An=Ht.image.getPrimary().scaleSelf(this.pixelRatio),Bn=An.id.toString(),Sn=he.get(Bn)||[];Sn.push(An),he.set(Bn,Sn)}else{const An=B_(qt.toString()),Bn=Ht.fontStack||Xt,Sn=me[Bn]=me[Bn]||{};this.calculateGlyphDependencies(Ht.text,Sn,sn,this.allowVerticalPlacement,An)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(He){const Ze={},et={},Tt=[];let ct=0;function At(en){Tt.push(He[en]),ct++}function Bt(en,Vt,Yt){const wt=et[en];return delete et[en],et[Vt]=wt,Tt[wt].geometry[0].pop(),Tt[wt].geometry[0]=Tt[wt].geometry[0].concat(Yt[0]),wt}function qt(en,Vt,Yt){const wt=Ze[Vt];return delete Ze[Vt],Ze[en]=wt,Tt[wt].geometry[0].shift(),Tt[wt].geometry[0]=Yt[0].concat(Tt[wt].geometry[0]),wt}function cn(en,Vt,Yt){const wt=Yt?Vt[0][Vt[0].length-1]:Vt[0][0];return`${en}:${wt.x}:${wt.y}`}for(let en=0;en<He.length;en++){const Vt=He[en],Yt=Vt.geometry,wt=Vt.text?Vt.text.toString():null;if(!wt){At(en);continue}const _t=cn(wt,Yt),Xt=cn(wt,Yt,!0);if(_t in et&&Xt in Ze&&et[_t]!==Ze[Xt]){const sn=qt(_t,Xt,Yt),Ht=Bt(_t,Xt,Tt[sn].geometry);delete Ze[_t],delete et[Xt],et[cn(wt,Tt[Ht].geometry,!0)]=Ht,Tt[sn].geometry=null}else _t in et?Bt(_t,Xt,Yt):Xt in Ze?qt(_t,Xt,Yt):(At(en),Ze[_t]=ct-1,et[Xt]=ct-1)}return Tt.filter(en=>en.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const He of l.elevationFeatures)this.elevationFeatureIdToIndex.set(He.id,this.elevationFeatures.length),this.elevationFeatures.push(He)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((He,Ze)=>He.sortKey-Ze.sortKey)}getCombinedIconPrimary(r,l,h,p,v,_,w){let T,M;const L=r.getUnevaluatedProperties();if(L._values["icon-image"].value!==void 0){const z=l.getAppearanceValueAndResolveTokens(r,"icon-image",h,p,v);T=this.getResolvedImageFromTokens(z)}else{const z=l.getValueAndResolveTokens("icon-image",h,p,v);T=this.getResolvedImageFromTokens(z)}if(T){const z=L._values["icon-size"]||l._unevaluatedLayout._values["icon-size"];M=By(T,xg(this.zoom,z,this.worldview),z,p,this.zoom,_,this.pixelRatio,w,this.worldview).iconPrimary}return M}updateAppearanceBasedIconTextures(r,l,h,p){if(!this.appearanceFeatureData||!this.icon.layoutVertexArray||this.icon.layoutVertexArray.length===0)return!1;const v=this.layers[0];let _=!1,w=0;const T=v.layout,[M,L]=T.get("icon-size-scale-range"),z=ie(1,M,L);for(let F=0;F<this.symbolInstances.length;F++){const G=this.symbolInstances.get(F),W=this.appearanceFeatureData[G.featureIndex];if(W&&G.placedIconSymbolIndex>=0){const J=W.id,oe=l&&J!==void 0?l[String(J)]:void 0,le={type:"Point",id:W.id,properties:W.properties,geometry:[]},he=this.layers[0].appearances&&this.layers[0].appearances.find(me=>me.isActive({globals:p,feature:le,canonical:r,featureState:oe}));if(W.activeAppearance===he)continue;if(he){W.activeAppearance=he;const me={sortKey:void 0,text:void 0,icon:null,index:G.featureIndex,sourceLayerIndex:G.featureIndex,geometry:[],properties:W.properties,type:"Point",id:W.id};if(!he.hasCachedIconPrimary()){const He=this.getCombinedIconPrimary(he,v,le,r,h,me,z);he.setCachedIconPrimary(He)}const be=he.getCachedIconPrimary();if(!be)continue;const Ne=be.toString(),Ae=this.iconAtlasPositions&&this.iconAtlasPositions.get(Ne);if(Ae){const He=v.getAppearanceValueAndResolveTokens(he,"icon-offset",le,r,h),Ze=He&&Array.isArray(He)?He:[0,0];let et=k1(Ae,void 0,Ze,v.layout.get("icon-anchor").evaluate(le,{},r));const Tt=v.getAppearanceValueAndResolveTokens(he,"icon-rotate",le,r,h),ct=typeof Tt=="number"?Tt:0,At=Ae.sdf,Bt=v.layout.get("icon-text-fit").constantOr("none");Bt!=="none"&&W.textShaping&&W.iconTextFitPadding&&W.fontScale&&(et=S2(et,W.textShaping,Bt,W.iconTextFitPadding,Ze,W.fontScale));const qt=this.calculateEffectiveAppearanceIconSize(he,p.zoom,le,r,h,z),cn=0,en=1+(Math.min(gd,Math.round(qt*Dc))<<1),Vt=I2(et,ct,At,Bt!=="none",z);W.isUsingAppearanceVertexData||(W.isUsingAppearanceVertexData=!0,W.layoutBasedVertexData=this.icon.getIconVertexData(w,G.numIconVertices));for(let wt=0;wt<Vt.length;++wt){const _t=Vt[wt],Xt=W.layoutBasedVertexData[0]||G.tileAnchorX,sn=W.layoutBasedVertexData[1]||G.tileAnchorY,Ht=16*_t.pixelOffsetTL.x,An=16*_t.pixelOffsetTL.y,Bn=16*_t.pixelOffsetBR.x,Sn=16*_t.pixelOffsetBR.y,vn=16*_t.minFontScaleX,Cr=16*_t.minFontScaleY;this.icon.updateIconVertexData(w,Xt,sn,Math.round(32*_t.tl.x),Math.round(32*_t.tl.y),_t.texPrimary.x,_t.texPrimary.y,cn,en,Ht,An,vn,Cr),this.icon.updateIconVertexData(w+1,Xt,sn,Math.round(32*_t.tr.x),Math.round(32*_t.tr.y),_t.texPrimary.x+_t.texPrimary.w,_t.texPrimary.y,cn,en,Bn,An,vn,Cr),this.icon.updateIconVertexData(w+2,Xt,sn,Math.round(32*_t.bl.x),Math.round(32*_t.bl.y),_t.texPrimary.x,_t.texPrimary.y+_t.texPrimary.h,cn,en,Ht,Sn,vn,Cr),this.icon.updateIconVertexData(w+3,Xt,sn,Math.round(32*_t.br.x),Math.round(32*_t.br.y),_t.texPrimary.x+_t.texPrimary.w,_t.texPrimary.y+_t.texPrimary.h,cn,en,Bn,Sn,vn,Cr),w+=4}const Yt=G.numIconVertices-4*Vt.length;for(let wt=0;wt<Yt;++wt)this.icon.updateIconVertexData(w+wt,0,0,0,0,0,0,0,0,0,0,0,0);_=!0}else w+=G.numIconVertices}else if(W.usesAppearanceIconAsPlaceholder)this.layers[0].appearances&&this.layers[0].appearances.length>0&&(this.icon.updateIconVertexData(w,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(w+1,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(w+2,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(w+3,0,0,0,0,0,0,0,0,0,0,0,0),_=!0),w+=G.numIconVertices,W.activeAppearance=null;else if(W.isUsingAppearanceVertexData){const be=W.layoutBasedVertexData.length/12;for(let Ne=0;Ne<be;++Ne){const Ae=Ne*12;this.icon.updateIconVertexData(w+Ne,W.layoutBasedVertexData[Ae+0],W.layoutBasedVertexData[Ae+1],W.layoutBasedVertexData[Ae+2],W.layoutBasedVertexData[Ae+3],W.layoutBasedVertexData[Ae+4],W.layoutBasedVertexData[Ae+5],W.layoutBasedVertexData[Ae+6],W.layoutBasedVertexData[Ae+7],W.layoutBasedVertexData[Ae+8],W.layoutBasedVertexData[Ae+9],W.layoutBasedVertexData[Ae+10],W.layoutBasedVertexData[Ae+11])}w+=be,W.isUsingAppearanceVertexData=!1,W.activeAppearance=null,_=!0}else w+=G.numIconVertices,W.activeAppearance=null}}return _}update(r,l,h,p,v,_,w){this.text.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,this.worldview),this.icon.programConfigurations.updatePaintArrays(r,l,v,h,p,_,w,this.worldview)}updateRoadElevation(r){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let l=!1;const h=Ve(r),p=1/h;let v=!1,_=!1;for(let w=0;w<this.symbolInstances.length;w++){const T=this.symbolInstances.get(w),M=xe(1,0,0),L=xe(0,1,0),{numHorizontalGlyphVertices:z,numVerticalGlyphVertices:F,numIconVertices:G,numVerticalIconVertices:W}=T,J=z>0||F>0,oe=G>0,le=this.elevationFeatures[T.elevationFeatureIndex];if(le){const he=new ut(T.tileAnchorX,T.tileAnchorY),me=.075+le.pointElevation(he);T.zOffset!==me&&(l=!0,T.zOffset=me),me!==0&&(this.hasAnyZOffset=!0);const be=le.computeSlopeNormal(he,p),Ne=$n(Tn(),xe(0,0,1),be);bt(M,M,Ne),bt(L,L,Ne),M[2]*=h,L[2]*=h,M[0]===1&&M[1]===0&&M[2]===0&&L[0]===0&&L[1]===1&&L[2]===0||(v=v||J,_=_||oe)}if(J&&(G1(this.text.orientationVertexArray,z,M,L),G1(this.text.orientationVertexArray,F,M,L)),oe){const{placedIconSymbolIndex:he,verticalPlacedIconSymbolIndex:me}=T;he>=0&&G1(this.icon.orientationVertexArray,G,M,L),me>=0&&G1(this.icon.orientationVertexArray,W,M,L)}}v||(this.text.orientationVertexArray=void 0),_||(this.icon.orientationVertexArray=void 0),l&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const r=(v,_,w)=>{h+=_,h>v.length&&v.resize(h);for(let T=-_;T<0;T++)v.emplace(T+h,w)},l=(v,_,w)=>{p+=_,p>v.length&&v.resize(p);for(let T=-_;T<0;T++)v.emplace(T+p,w)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,p=0;for(let v=0;v<this.symbolInstances.length;v++){const _=this.symbolInstances.get(v),{numHorizontalGlyphVertices:w,numVerticalGlyphVertices:T,numIconVertices:M}=_,L=_.zOffset,z=M>0;if((w>0||T>0)&&(r(this.text.zOffsetVertexArray,w,L),r(this.text.zOffsetVertexArray,T,L)),z){const{placedIconSymbolIndex:F,verticalPlacedIconSymbolIndex:G}=_;F>=0&&l(this.icon.zOffsetVertexArray,M,L),G>=0&&l(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,L)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r,l,h,p,v){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,!1),this.hasAppearances===null&&(this.hasAppearances=this.layers.some(_=>_.appearances&&_.appearances.length>0)),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,this.hasAppearances),this.uploaded=!0}updateAppearances(r,l,h,p){return!!(r&&l&&h)&&!(!this.icon.layoutVertexArray||this.icon.layoutVertexArray.length===0)&&!!this.icon.layoutVertexArray.arrayBuffer&&void(this.updateAppearanceBasedIconTextures(r,l,h,p)&&this.icon.layoutVertexBuffer&&this.icon.layoutVertexArray.arrayBuffer!==null&&this.icon.layoutVertexArray.length===this.icon.layoutVertexBuffer.length&&this.icon.layoutVertexBuffer.updateData(this.icon.layoutVertexArray))}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=wk(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,l){const h=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:p,y:v}of l)this.lineVertexArray.emplaceBack(p,v);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(r,l,h,p,v,_,w,T,M,L,z,F,G,W,J,oe,le,he){const me=r.indexArray,be=r.layoutVertexArray,Ne=r.globeExtVertexArray,Ae=r.segments.prepareSegment(4*he,be,me,this.canOverlap?_.sortKey:void 0),He=this.glyphOffsetArray.length,Ze=Ae.vertexLength,et=this.allowVerticalPlacement&&w===tl.vertical?Math.PI/2:0,Tt=_.text&&_.text.sections;for(let Bt=0;Bt<l.length;Bt++){const{tl:qt,tr:cn,bl:en,br:Vt,texPrimary:Yt,texSecondary:wt,pixelOffsetTL:_t,pixelOffsetBR:Xt,minFontScaleX:sn,minFontScaleY:Ht,glyphOffset:An,isSDF:Bn,sectionIndex:Sn}=l[Bt],vn=Ae.vertexLength,Cr=An[1];if(Wy(be,M.x,M.y,qt.x,Cr+qt.y,Yt.x,Yt.y,h,Bn,_t.x,_t.y,sn,Ht),Wy(be,M.x,M.y,cn.x,Cr+cn.y,Yt.x+Yt.w,Yt.y,h,Bn,Xt.x,_t.y,sn,Ht),Wy(be,M.x,M.y,en.x,Cr+en.y,Yt.x,Yt.y+Yt.h,h,Bn,_t.x,Xt.y,sn,Ht),Wy(be,M.x,M.y,Vt.x,Cr+Vt.y,Yt.x+Yt.w,Yt.y+Yt.h,h,Bn,Xt.x,Xt.y,sn,Ht),T){const{x:xn,y:or,z:Pr}=T.anchor,[Gr,pi,Or]=T.up;Ky(Ne,xn,or,Pr,Gr,pi,Or),Ky(Ne,xn,or,Pr,Gr,pi,Or),Ky(Ne,xn,or,Pr,Gr,pi,Or),Ky(Ne,xn,or,Pr,Gr,pi,Or),Eg(r.dynamicLayoutVertexArray,xn,or,Pr,et)}else Eg(r.dynamicLayoutVertexArray,M.x,M.y,M.z,et);if(oe){const xn=wt||Yt;qy(r.iconTransitioningVertexArray,xn.x,xn.y),qy(r.iconTransitioningVertexArray,xn.x+xn.w,xn.y),qy(r.iconTransitioningVertexArray,xn.x,xn.y+xn.h),qy(r.iconTransitioningVertexArray,xn.x+xn.w,xn.y+xn.h)}me.emplaceBack(vn,vn+1,vn+2),me.emplaceBack(vn+1,vn+2,vn+3),Ae.vertexLength+=4,Ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(An[0]),Bt!==l.length-1&&Sn===l[Bt+1].sectionIndex||r.programConfigurations.populatePaintArrays(be.length,_,_.index,{},G,W,J,Tt&&Tt[Sn],this.worldview)}const ct=he-l.length;ct!==0&&this._addNullVertices(ct,be,h,T,Ne,r,oe,Ae,me);const At=T?T.anchor:M;r.placedSymbolArray.emplaceBack(At.x,At.y,At.z,M.x,M.y,He,this.glyphOffsetArray.length-He,Ze,L,z,M.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],w,0,0,0,F,0),r.symbolInstanceIndices.push(le)}_addNullVertices(r,l,h,p,v,_,w,T,M){for(let L=0;L<r;L++){for(let F=0;F<4;F++)Wy(l,0,0,0,0,0,0,h,!1,0,0,0,0),p&&Ky(v,0,0,0,0,0,0),Eg(_.dynamicLayoutVertexArray,0,0,0,0),w&&qy(_.iconTransitioningVertexArray,0,0);const z=T.vertexLength;M.emplaceBack(z,z+1,z+2),M.emplaceBack(z+1,z+2,z+3),T.vertexLength+=4,T.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(0)}}_commitLayoutVertex(r,l,h,p,v,_,w){r.emplaceBack(l,h,p,v,_,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(r,l,h,p,v,_,w){const T=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),M=T.vertexLength,L=w.tileAnchorX,z=w.tileAnchorY;for(let G=0;G<4;G++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,l,r.padding,w.zOffset),this._commitLayoutVertex(h.layoutVertexArray,p,v,_,L,z,new ut(r.x1,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,v,_,L,z,new ut(r.x2,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,v,_,L,z,new ut(r.x2,r.y2)),this._commitLayoutVertex(h.layoutVertexArray,p,v,_,L,z,new ut(r.x1,r.y2)),T.vertexLength+=4;const F=h.indexArray;F.emplaceBack(M,M+1),F.emplaceBack(M+1,M+2),F.emplaceBack(M+2,M+3),F.emplaceBack(M+3,M),T.primitiveLength+=4}_addTextDebugCollisionBoxes(r,l,h,p,v,_){for(let w=p;w<v;w++){const T=h.get(w),M=this.getSymbolInstanceTextSize(r,_,l,w);this._addCollisionDebugVertices(T,M,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(r,l,h,p,v,_){for(let w=p;w<v;w++){const T=h.get(w),M=this.getSymbolInstanceIconSize(r,l,_.placedIconSymbolIndex);this._addCollisionDebugVertices(T,M,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}generateCollisionDebugBuffers(r,l,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new D2(eg,Bz.members,yl),this.iconCollisionBox=new D2(eg,Bz.members,yl);const p=bg(this.iconSizeData,r),v=bg(this.textSizeData,r,h);for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(v,r,l,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(v,r,l,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,r,l,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,r,l,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(r,l,h,p){const v=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),_=C2(this.textSizeData,r,v)/Aa;return this.tilePixelRatio*_}getSymbolInstanceIconSize(r,l,h){const p=this.icon.placedSymbolArray.get(h),v=C2(this.iconSizeData,r,p);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(r,l,h,p){r.emplaceBack(l,-h,-h,p),r.emplaceBack(l,h,-h,p),r.emplaceBack(l,h,h,p),r.emplaceBack(l,-h,h,p)}_updateTextDebugCollisionBoxes(r,l,h,p,v,_,w){for(let T=p;T<v;T++){const M=h.get(T),L=this.getSymbolInstanceTextSize(r,_,l,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,M.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(r,l,h,p,v,_,w){for(let T=p;T<v;T++){const M=h.get(T),L=this.getSymbolInstanceIconSize(r,l,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,M.padding,_.zOffset)}}updateCollisionDebugBuffers(r,l,h,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const v=bg(this.iconSizeData,r,p),_=bg(this.textSizeData,r,h);for(let w=0;w<this.symbolInstances.length;w++){const T=this.symbolInstances.get(w);this._updateTextDebugCollisionBoxes(_,r,l,T.textBoxStartIndex,T.textBoxEndIndex,T,h),this._updateTextDebugCollisionBoxes(_,r,l,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,h),this._updateIconDebugCollisionBoxes(v,r,l,T.iconBoxStartIndex,T.iconBoxEndIndex,T,p),this._updateIconDebugCollisionBoxes(v,r,l,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,l,h,p,v,_,w,T,M){const L={};if(l<h){const{x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be,featureIndex:Ne}=r.get(l);L.textBox={x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be},L.textFeatureIndex=Ne}if(p<v){const{x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be,featureIndex:Ne}=r.get(p);L.verticalTextBox={x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be},L.verticalTextFeatureIndex=Ne}if(_<w){const{x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be,featureIndex:Ne}=r.get(_);L.iconBox={x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be},L.iconFeatureIndex=Ne}if(T<M){const{x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be,featureIndex:Ne}=r.get(T);L.verticalIconBox={x1:z,y1:F,x2:G,y2:W,padding:J,projectedAnchorX:oe,projectedAnchorY:le,projectedAnchorZ:he,tileAnchorX:me,tileAnchorY:be},L.verticalIconFeatureIndex=Ne}return L}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,l){const h=r.placedSymbolArray.get(l),p=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<p;v+=4)r.indexArray.emplaceBack(v,v+1,v+2),r.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(r),h=Math.cos(r),p=[],v=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const T=this.symbolInstances.get(w);p.push(0|Math.round(l*T.tileAnchorX+h*T.tileAnchorY)),v.push(T.featureIndex)}return _.sort((w,T)=>p[w]-p[T]||v[T]-v[w]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((r,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(r).zOffset)}addToSortKeyRanges(r,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:M}=h;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),_>=0&&_!==v&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}getElevationFeatureForText(r){const l=this.symbolInstances.get(this.text.symbolInstanceIndices[r]).elevationFeatureIndex;let h;return this.elevationFeatures&&l<this.elevationFeatures.length&&(h=this.elevationFeatures[l]),h}}function Sk(c,r){return r.replace(/{([^{}]+)}/g,(l,h)=>h in c?String(c[h]):"")}let Ck,Ek,L2;Dn(W1,"SymbolBucket",{omit:["layers","collisionBoxArray","compareText","features"]}),W1.addDynamicAttributes=Eg;class Tk{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Vd,this.defaultValue=r}evaluate(r){if(r.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(r.formattedSection))return l.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Dn(Tk,"FormatSectionOverride",{omit:["defaultValue"]});const z2=()=>L2||(L2={layout:Ck||(Ck=new wo({"symbol-placement":new on(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new on(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new on(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bn(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new on(lt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new on(lt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new on(lt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new on(lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new on(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new on(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new on(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new bn(lt.layout_symbol["icon-size"]),"icon-size-scale-range":new on(lt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new bn(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bn(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new bn(lt.layout_symbol["icon-image"]),"icon-image-use-theme":new on({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new bn(lt.layout_symbol["icon-rotate"]),"icon-padding":new on(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new on(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new bn(lt.layout_symbol["icon-offset"]),"icon-anchor":new bn(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new on(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new on(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new on(lt.layout_symbol["text-rotation-alignment"]),"text-field":new bn(lt.layout_symbol["text-field"]),"text-font":new bn(lt.layout_symbol["text-font"]),"text-size":new bn(lt.layout_symbol["text-size"]),"text-size-scale-range":new on(lt.layout_symbol["text-size-scale-range"]),"text-max-width":new bn(lt.layout_symbol["text-max-width"]),"text-line-height":new bn(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new bn(lt.layout_symbol["text-letter-spacing"]),"text-justify":new bn(lt.layout_symbol["text-justify"]),"text-radial-offset":new bn(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new on(lt.layout_symbol["text-variable-anchor"]),"text-anchor":new bn(lt.layout_symbol["text-anchor"]),"text-max-angle":new on(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new on(lt.layout_symbol["text-writing-mode"]),"text-rotate":new bn(lt.layout_symbol["text-rotate"]),"text-padding":new on(lt.layout_symbol["text-padding"]),"text-keep-upright":new on(lt.layout_symbol["text-keep-upright"]),"text-transform":new bn(lt.layout_symbol["text-transform"]),"text-offset":new bn(lt.layout_symbol["text-offset"]),"text-allow-overlap":new on(lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new on(lt.layout_symbol["text-ignore-placement"]),"text-optional":new on(lt.layout_symbol["text-optional"]),visibility:new on(lt.layout_symbol.visibility)})),paint:Ek||(Ek=new wo({"icon-opacity":new bn(lt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new bn(lt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new bn(lt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new bn(lt.paint_symbol["text-emissive-strength"]),"icon-color":new bn(lt.paint_symbol["icon-color"]),"icon-halo-color":new bn(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new bn(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bn(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new on(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new on(lt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new on(lt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new bn(lt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new bn(lt.paint_symbol["text-occlusion-opacity"]),"text-color":new bn(lt.paint_symbol["text-color"],{runtimeType:Cs,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new bn(lt.paint_symbol["text-halo-color"]),"text-halo-width":new bn(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new bn(lt.paint_symbol["text-halo-blur"]),"text-translate":new on(lt.paint_symbol["text-translate"]),"text-translate-anchor":new on(lt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new on(lt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new on(lt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new on(lt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new on(lt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new bn(lt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},L2);class q1 extends es{constructor(r,l,h,p){super(r,z2(),l,h,p,r.layout?r.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=N([]),this.hasOcclusionOpacityProperties=r.paint!==void 0&&("icon-occlusion-opacity"in r.paint||"text-occlusion-opacity"in r.paint)}_handleSpecialPaintPropertyUpdate(r){r!=="icon-occlusion-opacity"&&r!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(r,l){super.recalculate(r,l),this.appearances&&this.appearances.forEach(p=>{p.recalculate(r,l,this.iconImageUseTheme)}),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const v of h)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(r,l,h,p){return this._saturation===r&&this._contrast===l&&this._brightnessMin===h&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(v,_,w,T){v=ni(v),_=Jr(_);const M=k(),L=v/3,z=1-2*L,F=[z,L,L,0,L,z,L,0,L,L,z,0,0,0,0,1],G=.5-.5*_,W=T-w;return V(M,[W,0,0,0,0,W,0,0,0,0,W,0,w,w,w,1],[_,0,0,0,0,_,0,0,0,0,_,0,G,G,G,1]),V(M,M,F),M}(r,l,h,p),this._saturation=r,this._contrast=l,this._brightnessMin=h,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(r,l,h,p){const v=this.layout.get(r).evaluate(l,{},h,p),_=this._unevaluatedLayout._values[r];return _.isDataDriven()||jm(_.value)||!v?v:Sk(l.properties,v)}getAppearanceValueAndResolveTokens(r,l,h,p,v){const _=r.getProperty(l);if(!_)return;const w=_.evaluate(h,{},p,v),T=r.getUnevaluatedProperties()._values[l];return T.isDataDriven()||jm(T.value)||!w||typeof w!="string"?w:Sk(h.properties,w)}createBucket(r){return new W1(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of z2().paint.overridableProperties){if(!q1.hasPaintOverride(this.layout,r))continue;const l=this.paint.get(r),h=new Tk(l),p=new $m(h,l.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let v=null;v=l.value.kind==="constant"||l.value.kind==="source"?new Zf("source",p):new uu("composite",p,l.value.zoomStops,l.value.interpolationType),this.paint._values[r]=new _l(l.property,v,l.parameters)}}_handleOverridablePaintPropertyUpdate(r,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&q1.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,l){const h=r.get("text-field"),p=z2().paint.properties[l];let v=!1;const _=w=>{for(const T of w)if(p.overrides&&p.overrides.hasOverride(T))return void(v=!0)};if(h.value.kind==="constant"&&h.value.value instanceof xa)_(h.value.value.sections);else if(h.value.kind==="source"){const w=M=>{v||(M instanceof Sc&&fa(M.value)===Ju?_(M.value.sections):M instanceof Qu?_(M.sections):M.eachChild(w))},T=h.value;T._styleExpression&&w(T._styleExpression.expression)}return v}getProgramIds(){return["symbol"]}getDefaultProgramParams(r,l,h){return{config:new Rc(this,{zoom:l,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let Ik,Pk,Mk,Rk;var k2=Zr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function K1(c,r,l,h,p,v,_,w){const T=[c,r,1,l,h,1,p,v,1],M=[_,w,1],L=A([],T),[z,F,G]=xt(M,M,L);return D(T,T,[z,0,0,0,F,0,0,0,G])}function Ak(c,r,l,h,p,v,_,w){const T=function(M,L,z,F,G,W,J,oe){const le=K1(0,0,1,0,1,1,0,1),he=K1(M,L,z,F,G,W,J,oe);return D(he,he,A([],le))}(c,r,l,h,p,v,_,w);return[T[2]/T[8]/fn,T[5]/T[8]/fn]}function X1(c){return[c[0],Math.min(Math.max(c[1],-Ie),Ie)]}class Ok extends xc{constructor(r,l,h,p){super(),this.id=r,this.dispatcher=h,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=l,this._dirty=!1}load(r,l){if(this._loaded=l||!1,this.fire(new Hs("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=i_(this.map._requestManager.transformRequest(this.url,Dr.Image),(h,p)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new Mf(h)):p&&(this.image=p instanceof HTMLImageElement?ho.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Oy(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Hs("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(r){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Oy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=r[0][1],h=r[0][1];for(const v of r)v[1]>h&&(h=v[1]),v[1]<l&&(l=v[1]);const p=(h+l)/2;if(p>Ie?this.onNorthPole=!0:p<-Ie&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const v=r.map(st.fromLngLat);this.tileID=function(_){let w=1/0,T=1/0,M=-1/0,L=-1/0;for(const J of _)w=Math.min(w,J.x),T=Math.min(T,J.y),M=Math.max(M,J.x),L=Math.max(L,J.y);const z=Math.max(M-w,L-T),F=Math.max(0,Math.floor(-Math.log2(z))),G=Math.pow(2,F);let W=Math.floor((w+M)/2*G);return W>1&&(W-=1),new Js(F,W,Math.floor((T+L)/2*G))}(v),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Hs("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Oy||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const le in this.tiles){const he=this.tiles[le];he.state!=="loaded"&&(he.state="loaded",he.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=jy(new Js(0,0,0),this.map.transform.projection),h=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(le){const he=le[1].x-le[0].x,me=le[1].y-le[0].y,be=le[2].x-le[1].x,Ne=le[2].y-le[1].y,Ae=le[3].x-le[2].x,He=le[3].y-le[2].y,Ze=le[0].x-le[3].x,et=le[0].y-le[3].y,Tt=he*Ne-be*me,ct=be*He-Ae*Ne,At=Ae*et-Ze*He,Bt=Ze*me-he*et;return Tt>0&&ct>0&&At>0&&Bt>0||Tt<0&&ct<0&&At<0&&Bt<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=jy(this.tileID,this.map.transform.projection),[v,_,w,T]=this.coordinates.map(le=>{const he=p.projection.project(le[0],le[1]);return vk(p,he)._round()});this.perspectiveTransform=Ak(v.x,v.y,_.x,_.y,w.x,w.y,T.x,T.y);const M=this._boundsArray=new fh;M.emplaceBack(v.x,v.y,0,0),M.emplaceBack(_.x,_.y,fn,0),M.emplaceBack(T.x,T.y,0,fn),M.emplaceBack(w.x,w.y,fn,fn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(M,k2.members),this.boundsSegments=po.simpleSegment(0,0,4,2);const L=[],z=[X1((F=this.coordinates)[0]),X1(F[1]),X1(F[2]),X1(F[3])];var F;const[G,W,J,oe]=function(le){let he=le[0][0],me=he,be=le[0][1],Ne=be;for(let Ae=1;Ae<le.length;Ae++)le[Ae][0]<he?he=le[Ae][0]:le[Ae][0]>me&&(me=le[Ae][0]),le[Ae][1]<be?be=le[Ae][1]:le[Ae][1]>Ne&&(Ne=le[Ae][1]);return[he,be,me-he,Ne-be]}(z);{const le=new fh,[he,me,be,Ne]=function(Vt){let Yt=Vt[0].x,wt=Yt,_t=Vt[0].y,Xt=_t;for(let sn=1;sn<Vt.length;sn++)Vt[sn].x<Yt?Yt=Vt[sn].x:Vt[sn].x>wt&&(wt=Vt[sn].x),Vt[sn].y<_t?_t=Vt[sn].y:Vt[sn].y>Xt&&(Xt=Vt[sn].y);return[Yt,_t,wt-Yt,Xt-_t]}(h),Ae=Vt=>[(Vt.x-he)/be,(Vt.y-me)/Ne],[He,Ze,et,Tt]=h.map(Ae),ct=function(Vt,Yt,wt,_t,Xt,sn,Ht,An){const Bn=K1(0,0,1,0,1,1,0,1);return D(Bn,Bn,A([],K1(Vt,Yt,wt,_t,Xt,sn,Ht,An)))}(He[0],He[1],Ze[0],Ze[1],et[0],et[1],Tt[0],Tt[1]);this.elevatedGlobePerspectiveTransform=Ak(He[0],He[1],Ze[0],Ze[1],et[0],et[1],Tt[0],Tt[1]);const At=(Vt,Yt)=>{L.push(Vt.lng);const wt=Math.round((Vt.lng-G)/J*fn),_t=Math.round((Vt.lat-W)/oe*fn),Xt=Ae(Yt),sn=xt([],[Xt[0],Xt[1],1],ct),Ht=Math.round(sn[0]/sn[2]*fn),An=Math.round(sn[1]/sn[2]*fn);le.emplaceBack(wt,_t,Ht,An)},Bt=h[3].x-h[0].x,qt=h[3].y-h[0].y,cn=h[2].x-h[1].x,en=h[2].y-h[1].y;for(let Vt=0;Vt<65;Vt++){const Yt=Vt/64,wt=[h[0].x+Yt*Bt,h[0].y+Yt*qt],_t=[h[1].x+Yt*cn,h[1].y+Yt*en],Xt=_t[0]-wt[0],sn=_t[1]-wt[1];for(let Ht=0;Ht<65;Ht++){const An=Ht/64,Bn={x:wt[0]+Xt*An,y:wt[1]+sn*An};At(l.projection.unproject(Bn.x,Bn.y),Bn)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(le,k2.members)}{this.maxLongitudeTriangleSize=0;let le=[],he=new to;const me=(be,Ne,Ae)=>{he.emplaceBack(be,Ne,Ae);const He=L[be],Ze=L[Ne],et=L[Ae],Tt=Math.min(Math.min(He,Ze),et),ct=Math.max(Math.max(He,Ze),et)-Tt;ct>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ct),le.push(Tt+ct/2)};for(let be=0;be<64;be++)for(let Ne=0;Ne<64;Ne++){const Ae=65*be+Ne,He=Ae+1,Ze=Ae+65,et=Ze+1;me(Ae,Ze,He),me(He,Ze,et)}[le,he]=function(be,Ne){const Ae=Array.from({length:be.length},(et,Tt)=>Tt);Ae.sort((et,Tt)=>be[et]-be[Tt]);const He=[],Ze=new to;for(let et=0;et<Ae.length;et++){const Tt=Ae[et];He.push(be[Tt]);const ct=3*Tt,At=ct+1;Ze.emplaceBack(Ne.uint16[ct],Ne.uint16[At],Ne.uint16[At+1])}return[He,Ze]}(le,he),this.elevatedGlobeTrianglesCenterLongitudes=le,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(he)}this.elevatedGlobeSegments=po.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,J/fn,0,oe/fn,0,0,W,G,0])}prepare(){const r=Object.keys(this.tiles).length!==0;if(this.tileID&&!r)return;const l=this.map.painter.context,h=l.gl;!this._dirty||this.texture instanceof Oy||(this.texture?this.texture.update(this.image):(this.texture=new l2(l,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(l)}loadTile(r,l){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},l(null)):(r.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let p=(v=r+180)+360*Math.round((h[0]-v)/360);var v;const _=new po,w=(z,F)=>{_.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:l.segments[0].vertexLength,primitiveLength:F,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-p)<=T){const z=yr(h,0,h.length,p+T);return z===h.length||w(z,Ar(h,z+1,h.length,p+360-T)-z),_}p<h[0]&&(p+=360);const M=Ar(h,0,h.length,p-T);if(M===h.length)return w(0,h.length),_;w(0,M-0);const L=yr(h,M+1,h.length,p+T);return L!==h.length&&w(L,h.length-L),_}}const Q9=(Math.pow(256,2)-1)/16907520;class Dk extends es{constructor(r,l,h,p){super(r,{layout:Mk||(Mk=new wo({visibility:new on(lt.layout_raster.visibility)})),paint:Rk||(Rk=new wo({"raster-opacity":new on(lt.paint_raster["raster-opacity"]),"raster-color":new lh(lt.paint_raster["raster-color"]),"raster-color-mix":new on(lt.paint_raster["raster-color-mix"]),"raster-color-range":new on(lt.paint_raster["raster-color-range"]),"raster-hue-rotate":new on(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new on(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new on(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new on(lt.paint_raster["raster-saturation"]),"raster-contrast":new on(lt.paint_raster["raster-contrast"]),"raster-resampling":new on(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new on(lt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new on(lt.paint_raster["raster-emissive-strength"]),"raster-array-band":new on(lt.paint_raster["raster-array-band"]),"raster-elevation":new on(lt.paint_raster["raster-elevation"]),"raster-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},l,h,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(r){return!(r&&r._source instanceof Ok&&(r._source.onNorthPole||r._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[h,p]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(p)||h===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=vy({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,p])}}let Lk,zk,kk,Fk,Nk;class Bk extends es{constructor(r,l,h,p){super(r,{layout:Lk||(Lk=new wo({visibility:new on(lt["layout_raster-particle"].visibility)})),paint:zk||(zk=new wo({"raster-particle-array-band":new on(lt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new on(lt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new lh(lt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new on(lt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new on(lt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new on(lt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new on(lt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new on(lt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},l,h,p),this._updateColorRamp(),this.lastInvalidatedAt=ho.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(r){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){r!=="raster-particle-color"&&r!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),r==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=vy({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ho.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class eq extends es{constructor(r,l){super(r,{},l,null),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(r){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(r){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}function F2(c,r,l){const h=[0,0,1],p=On([]);return Un(p,p,l?-Gt(c)+Math.PI:Gt(c)),Kn(p,p,-Gt(r)),bt(h,h,p),ft(h,h)}const $k={None:0,Model:1,Symbol:2,FillExtrusion:4};class Z1{constructor(r,l,h,p){this.message=(r?`${r}: `:"")+h,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function N2(c,r){const l=c.indexOf("://")===-1;try{return new URL(c,l&&r?"http://example.com":void 0),!0}catch{return!1}}class jk{constructor(r,l){this.feature=r,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Vk{constructor(){this.maxScale=1,this.maxXYTranslationDistance=0,this.instancedDataArray=new ng,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}colorForInstance(r){const l=16*r,h=this.instancedDataArray.float32;let p=Math.floor(h[l+2]);const v=1.05*(h[l+2]-p);return p/=100,[h[l]%1*1.05,h[l+1]%1*1.05,v,p]}tileCoordinatesForInstance(r){const l=16*r,h=this.instancedDataArray.float32;let p=h[l+0];return p=p>fn?p-fn:p,new ut(Math.trunc(p),Math.trunc(h[l+1]))}translationForInstance(r){const l=16*r,h=this.instancedDataArray.float32;return[h[l+4],h[l+5],h[l+6]]}rotationScaleForInstance(r){const l=16*r,h=this.instancedDataArray.float32;return[h[l+7],h[l+8],h[l+9],h[l+10],h[l+11],h[l+12],h[l+13],h[l+14],h[l+15]]}transformForInstance(r){const l=16*r,h=this.instancedDataArray.float32;return[h[l+7],h[l+8],h[l+9],h[l+4],h[l+10],h[l+11],h[l+12],h[l+5],h[l+13],h[l+14],h[l+15],h[l+6],0,0,0,1]}}class B2{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaledZ=this.canonical.z+Math.log2(r.overscaling),this.layers=r.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=r.projection,this.index=r.index,this.worldview=r.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=r.styleDefinedModelURLs,this.hasAppearances=null}updateFootprints(r,l){}updateAppearances(r,l,h,p){}populate(r,l,h,p){this.tileToMeter=Ve(h);const v=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:w,index:T,sourceLayerIndex:M}of r){const L=w??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),z=gt(_,v);if(!this.layers[0]._featureFilter.filter(new Wi(this.zoom,{worldview:this.worldview,activeFloors:l.activeFloors}),z,h))continue;const F={id:L,sourceLayerIndex:M,index:T,geometry:v?z.geometry:kt(_,h,p),properties:_.properties,type:_.type,patterns:{}},G=this.addFeature(F,F.geometry,z);G&&l.featureIndex.insert(_,F.geometry,T,M,this.index,this.instancesPerModel[G].instancedDataArray.length,fn/32)}this.lookup=null}evaluateQueryRenderedFeaturePadding(){const r=this.layers[0].modelManager,l=this.layers[0].scope;let h=0;for(const p of this.modelUris){const v=r.getModel(p,l);if(!v)continue;const _=this.instancesPerModel[p];if(_){const w=.5*Ke(v.aabb.max,v.aabb.min)*_.maxScale+_.maxXYTranslationDistance,T=Math.min(fn,Math.max(w/this.tileToMeter,fn/32));h=Math.max(T,h)}}return h}update(r,l,h,p){for(const v in this.instancesPerModel){const _=this.instancesPerModel[v];for(const w in r)_.idToFeaturesIndex.hasOwnProperty(w)&&(this.evaluate(_.features[_.idToFeaturesIndex[w]],r[w],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];for(const p of h.features){const v=this.layers[0],_=p.feature,w=this.canonical,T=v.paint.get("model-rotation").evaluate(_,{},w),M=v.paint.get("model-scale").evaluate(_,{},w),L=v.paint.get("model-translation").evaluate(_,{},w);tn(p.rotation,T)&&tn(p.scale,M)&&tn(p.translation,L)||(this.evaluate(p,p.featureStates,h,!0),r=!0)}}return r}updateReplacement(r,l,h,p){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const v=l.getReplacementRegionsForTile(r.toUnwrapped(),!0);if(x1(this.activeReplacements,v))return!1;this.activeReplacements=v;let _=!1;for(const w in this.instancesPerModel){const T=this.instancesPerModel[w],M=T.instancedDataArray;for(const L of T.features){const z=L.instancedDataOffset,F=L.instancedDataCount;for(let G=0;G<F;G++){const W=16*(G+z);let J=M.float32[W+0];const oe=J>fn;J=oe?J-fn:J;const le=Math.floor(J),he=Math.floor(M.float32[W+1]);let me=!1;for(const be of this.activeReplacements)if(!IL(be,h,$k.Model,p)&&!(be.min.x>le||le>be.max.x||be.min.y>he||he>be.max.y)&&(me=ZT(AL(le,he,r.canonical,be.footprintTileId.canonical),be.footprint),me))break;M.float32[W]=me?J+fn:J,_=_||me!==oe}}}return _}isEmpty(){for(const r in this.instancesPerModel)if(this.instancesPerModel[r].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=r.createVertexBuffer(h.instancedDataArray,I7.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const r=this.layers[0].modelManager;if(r&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)r.removeModel(l,"",!0)}addFeature(r,l,h){const p=this.layers[0],v=p.layout.get("model-id").evaluate(h,{},this.canonical);if(!v)return jt(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),v;(N2(v,!1)||this.styleDefinedModelURLs[v]!==void 0)&&(this.modelUris.includes(v)||this.modelUris.push(v)),this.instancesPerModel[v]||(this.instancesPerModel[v]=new Vk);const _=this.instancesPerModel[v],w=_.instancedDataArray,T=new jk(h,w.length);for(const M of l)for(const L of M){if(L.x<0||L.x>=fn||L.y<0||L.y>=fn)continue;if(this.lookupDim!==0){const F=(this.lookupDim-1)/fn,G=this.lookupDim*(L.y*F|0)+L.x*F|0;if(this.lookup){if(this.lookup[G]!==0)continue;this.lookup[G]=1}}this.instanceCount++;const z=w.length;w.resize(z+1),_.instancesEvaluatedElevation.push(0),w.float32[16*z]=L.x,w.float32[16*z+1]=L.y}return T.instancedDataCount=_.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(r.id&&(_.idToFeaturesIndex[r.id]=_.features.length),_.features.push(T),this.evaluate(T,{},_,!1)),v}getModelUris(){return this.modelUris}evaluate(r,l,h,p){const v=this.layers[0],_=r.feature,w=this.canonical,T=r.rotation=v.paint.get("model-rotation").evaluate(_,l,w),M=r.scale=v.paint.get("model-scale").evaluate(_,l,w),L=r.translation=v.paint.get("model-translation").evaluate(_,l,w),z=Object.assign({},v.paint.get("model-color").evaluate(_,l,w));z.a=v.paint.get("model-color-mix-intensity").evaluate(_,l,w);const F=[];this.maxVerticalOffset<L[2]&&(this.maxVerticalOffset=L[2]);const G=L[0]*L[0]+L[1]*L[1],W=G>0?Math.sqrt(G):0;h.maxScale=Math.max(Math.max(h.maxScale,M[0]),Math.max(M[1],M[2])),h.maxXYTranslationDistance=Math.max(h.maxXYTranslationDistance,W),this.maxScale=Math.max(Math.max(this.maxScale,M[0]),Math.max(M[1],M[2])),vz(F,T,M);const J=Math.round(100*z.a)+z.b/1.05;for(let oe=0;oe<r.instancedDataCount;++oe){const le=r.instancedDataOffset+oe,he=16*le,me=h.instancedDataArray.float32;let be=0;p&&(be=me[he+6]-h.instancesEvaluatedElevation[le]);const Ne=0|me[he+1];me[he]=(0|me[he])+z.r/1.05,me[he+1]=Ne+z.g/1.05,me[he+2]=J,me[he+3]=1/(w.z>10?this.tileToMeter:Ve(w,Ne)),me[he+4]=L[0],me[he+5]=L[1],me[he+6]=L[2]+be,me[he+7]=F[0],me[he+8]=F[1],me[he+9]=F[2],me[he+10]=F[4],me[he+11]=F[5],me[he+12]=F[6],me[he+13]=F[8],me[he+14]=F[9],me[he+15]=F[10],h.instancesEvaluatedElevation[le]=L[2]}}}let Uk,Hk;Dn(B2,"ModelBucket",{omit:["layers"]}),Dn(Vk,"PerModelAttributes"),Dn(jk,"ModelFeature");class Tg{constructor(r,l,h){this._demTile=r,this._dem=this._demTile.dem,this._scale=l,this._offset=h}static create(r,l,h){const p=h||r.findDEMTileFor(l);if(!p||!p.dem)return;const v=p.dem,_=p.tileID,w=1<<l.canonical.z-_.canonical.z;return new Tg(p,v.dim/fn/w,[(l.canonical.x/w-_.canonical.x)*v.dim,(l.canonical.y/w-_.canonical.y)*v.dim])}tileCoordToPixel(r,l){const h=l*this._scale+this._offset[1];return new ut(Math.floor(r*this._scale+this._offset[0]),Math.floor(h))}getElevationAt(r,l,h,p){const v=r*this._scale+this._offset[0],_=l*this._scale+this._offset[1],w=Math.floor(v),T=Math.floor(_),M=this._dem;return p=!!p,h?vr(vr(M.get(w,T,p),M.get(w,T+1,p),_-T),vr(M.get(w+1,T,p),M.get(w+1,T+1,p),_-T),v-w):M.get(w,T,p)}getElevationAtPixel(r,l,h){return this._dem.get(r,l,!!h)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*pe(1,r)*this._dem.stride}}const $2=new Float32Array(262144),pp=new Uint8Array(262144);function Gk(c){let r=0;if(c.meshes)for(const l of c.meshes)r=Math.max(r,l.aabb.max[2]);if(c.children)for(const l of c.children)r=Math.max(r,Gk(l));return r}function Wk(c,r,l){if(c.meshes)for(const h of c.meshes){if(h.aabb.min[0]===1/0)continue;const p=Ur.applyTransform(h.aabb,c.globalMatrix);l.insert(r,p.min[0],p.min[1],p.max[0],p.max[1])}if(c.children)for(const h of c.children)Wk(h,r,l)}const qk=["","wall","door","roof","window","lamp","logo"];class Kk{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:r.id,geometry:[],properties:{height:Gk(r)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Ur([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const l=new Ur([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==r&&(h.transformedAabb=Ur.applyTransformFast(h.aabb,this.node.globalMatrix),l.encapsulate(h.transformedAabb)),r++;this.aabb=l}return this.aabb}}class Y1{constructor(r,l,h,p,v,_,w,T){this.id=h,this.layers=r,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=vg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=vg.HasMapboxMeshFeatures),v&&(this.modelTraits|=vg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.worldview=T,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const M of l)this.nodesInfo.push(new Kk(M)),Wk(M,w.featureIndexArray.length,w.grid),w.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,w.bucketLayerIDs.length-1,0);this.states={},this.hasAppearances=null}updateFootprints(r,l){for(const h of this.getNodesInfo()){const p=h.node;p.footprint&&l.push({footprint:p.footprint,id:r})}}updateAppearances(r,l,h,p){}update(r){const l=Object.keys(r).length!==0;if(l&&!this.stateDependentLayers.length)return;const h=l?this.stateDependentLayers:this.layers;if(!ur(r,this.states))for(const p of h)this.evaluate(p,r);this.states=structuredClone(r)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const h of l){const p=h.node;this.uploaded?this.updatePbrBuffer(p):d2(p,r,!0)}for(const h of l)O1(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let l=!1;if(!r.meshes)return l;for(const h of r.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),l=!0);return l}needsReEvaluation(r,l,h){const p=r.transform.projectionOptions,v=r.style.getBrightness(),_=this.brightness!==v;if(!this.uploaded||this.dirty||p.name!==this.projection.name||Xy(h.paint.get("model-color").value,_)||Xy(h.paint.get("model-color-mix-intensity").value,_)||Xy(h.paint.get("model-roughness").value,_)||Xy(h.paint.get("model-emissive-strength").value,_)||Xy(h.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=p,this.brightness=v;const w=this.getNodesInfo();for(const T of w)T.state=null;return!0}return!1}evaluateTransform(r,l){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const h=this.getNodesInfo(),p=this.id.canonical;for(const v of h){const _=v.feature;v.evaluatedTranslation=l.paint.get("model-translation").evaluate(_,{},p),v.evaluatedScale=l.paint.get("model-scale").evaluate(_,{},p)}}evaluate(r,l){const h=this.getNodesInfo();for(const p of h){if(!p.node.meshes)continue;const v=p.feature,_=l&&l[v.id];if(ur(_,p.state))continue;p.state=structuredClone(_);const w=p.node.meshes&&p.node.meshes[0].featureData,T=p.evaluatedColor[2],M=p.evaluatedRMEA[2],L=this.id.canonical;if(p.hasTranslucentParts=!1,w){for(let z=0;z<qk.length;z++){const F=qk[z];F.length&&(v.properties.part=F);const G=r.paint.get("model-color").evaluate(v,_,L).toPremultipliedRenderColor(null),W=r.paint.get("model-color-mix-intensity").evaluate(v,_,L);p.evaluatedColor[z]=[G.r,G.g,G.b,W],p.evaluatedRMEA[z][0]=r.paint.get("model-roughness").evaluate(v,_,L),p.evaluatedRMEA[z][2]=r.paint.get("model-emissive-strength").evaluate(v,_,L),p.evaluatedRMEA[z][3]=G.a,p.emissionHeightBasedParams[z]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(v,_,L),!p.hasTranslucentParts&&G.a<1&&(p.hasTranslucentParts=!0)}delete v.properties.part,nq(p,T!==p.evaluatedColor[2]||M!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(v,_,L);p.evaluatedTranslation=r.paint.get("model-translation").evaluate(v,_,L),p.evaluatedScale=r.paint.get("model-scale").evaluate(v,_,L),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,l,h,p){const v=r.findDEMTileFor(h);if(v&&(v.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(v.dem&&v.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=v.tileID.overscaledZ;const _=Tg.create(r,h,v);if(!_)return;this.modelTraits&vg.HasMapboxMeshFeatures&&this.updateDEM(r,_,h,p);for(const w of this.getNodesInfo()){const T=w.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const M=T.footprint.vertices;let L=_.getElevationAt(M[0].x,M[0].y,!0,!0);for(let z=1;z<M.length;z++)L=Math.min(L,_.getElevationAt(M[z].x,M[z].y,!0,!0));T.elevation=L}}this.terrainTile=v.tileID.canonical,this.terrainExaggeration=l}}updateDEM(r,l,h,p){let v=l._dem._modifiedForSources[p];if(v===void 0&&(l._dem._modifiedForSources[p]=[],v=l._dem._modifiedForSources[p]),v.includes(h.canonical))return;const _=l._dem.dim;v.push(h.canonical);let w=!1;for(const T of this.getNodesInfo()){const M=T.node;if(!M.footprint||!M.footprint.grid)continue;const L=M.footprint.grid,z=l.tileCoordToPixel(L.min.x,L.min.y),F=l.tileCoordToPixel(L.max.x,L.max.y),G=Math.min(Math.min(_-F.y,z.x),Math.min(z.y,_-F.x));if(G<0)continue;const W=ie(G,2,5);let J=Math.max(0,z.x-W),oe=Math.max(0,z.y-W),le=Math.min(F.x+W,_-1),he=Math.min(F.y+W,_-1);for(let Ae=oe;Ae<=he;++Ae)for(let He=J;He<=le;++He)pp[Ae*_+He]=255;let me=0,be=0;for(let Ae=0;Ae<L.cellsY;++Ae)for(let He=0;He<L.cellsX;++He){if(!L.cells[Ae*L.cellsX+He])continue;const Ze=l.tileCoordToPixel(L.min.x+He/L.xScale,L.min.y+Ae/L.yScale),et=l.tileCoordToPixel(L.min.x+(He+1)/L.xScale,L.min.y+(Ae+1)/L.yScale);for(let Tt=Ze.y;Tt<=Math.min(et.y+1,_-1);++Tt)for(let ct=Ze.x;ct<=Math.min(et.x+1,_-1);++ct)pp[Tt*_+ct]===255&&(pp[Tt*_+ct]=0,me+=l.getElevationAtPixel(ct,Tt),be++)}const Ne=me/be;J=Math.max(1,z.x-W),oe=Math.max(1,z.y-W),le=Math.min(F.x+W,_-2),he=Math.min(F.y+W,_-2),w=!0;for(let Ae=oe;Ae<=he;++Ae)for(let He=J;He<=le;++He)pp[Ae*_+He]===0&&($2[Ae*_+He]=l._dem.set(He,Ae,Ne));for(let Ae=1;Ae<W;++Ae){J=Math.max(1,z.x-Ae),oe=Math.max(1,z.y-Ae),le=Math.min(F.x+Ae,_-2),he=Math.min(F.y+Ae,_-2);for(let He=oe;He<=he;++He)for(let Ze=J;Ze<=le;++Ze){const et=He*_+Ze;if(pp[et]===255){let Tt=0,ct=0,At=-1,Bt=-1;for(let qt=-1;qt<=1;++qt)for(let cn=-1;cn<=1;++cn){const en=(He+qt)*_+Ze+cn;if(pp[en]>=Ae)continue;const Vt=$2[en],Yt=Math.abs(Vt);Yt>ct&&(Tt=Vt,ct=Yt,At=cn,Bt=qt)}if(ct>.1){const qt=1-(Ae+.5*Math.abs(At*Bt))/W;let cn=l._dem.get(Ze,He)+Tt*qt;const en=l._dem.get(Ze+At,He+Bt),Vt=l._dem.get(Ze-At,He-Bt,!0);(cn-en)*(cn-Vt)>0&&(cn=(en+Vt)/2),$2[et]=l._dem.set(Ze,He,cn),pp[et]=Ae}}}}}w&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=ho.now())}setFilter(r){this.filter=r?qm(r):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(r=>this.filter.filter(new Wi(this.id.overscaledZ,{worldview:this.worldview}),r.feature,this.id.canonical)):this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const l of r)O1(l.node),h2(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(r.toUnwrapped());for(const p of this.getNodesInfo()){const v=p.node.footprint;p.hiddenByReplacement=!!v&&!h.find(_=>_.footprint===v)}}getHeightAtTileCoord(r,l){const h=[],p=[0,0,0],v=N([]);for(const _ of this.getNodesInfo()){const w=_.node.meshes[0],T=w.transformedAabb;if(r<T.min[0]||l<T.min[1]||r>T.max[0]||l>T.max[1])continue;if(_.node.hidden===!0)return{height:1/0,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};j(v,_.node.globalMatrix),p[0]=r,p[1]=l,yt(p,p,v);const M=(p[0]-w.aabb.min[0])/(w.aabb.max[0]-w.aabb.min[0])*dp|0,L=Math.min(63,(p[1]-w.aabb.min[1])/(w.aabb.max[1]-w.aabb.min[1])*dp|0)*dp+Math.min(63,M),z=w.heightmap[L];if(!(z<0&&_.node.footprint))return _.hiddenByReplacement?void 0:{height:z,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};if(_.node.footprint.grid.query(new ut(r,l),new ut(r,l),h),h.length>0)return{height:void 0,maxHeight:_.feature.properties.height,hidden:_.hiddenByReplacement,verticalScale:_.evaluatedScale[2]}}}}function Xy(c,r){return c instanceof Zf&&!c.isLightConstant&&r}function tq(c,r,l,h,p,v,_,w){let T=(61440&r|(61440&r)>>4)>>8,M=(3840&r|(3840&r)>>4)>>4,L=240&r|(240&r)>>4;l[3]>0&&(T=vr(T,255*l[0],l[3]),M=vr(M,255*l[1],l[3]),L=vr(L,255*l[2],l[3]));const z=T<<8|M,F=L<<8|Math.floor(255*h[3]),G=function(Ae){const He=ie(Ae,0,2);return Math.min(Math.round(.5*He*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],W=ie(p[0],0,1),J=ie(p[1],0,1),oe=ie(p[2],0,1),le=ie(p[3],0,1);let he,me,be,Ne;if(W!==J&&_!==v&&J!==W){const Ae=_-v;me=1/(Ae*(J-W)),be=-(v+Ae*W)/(Ae*(J-W));const He=ie(p[4],-1,1);Ne=Math.pow(10,He),he=255*oe<<8|255*le}else he=65535,me=0,be=1,Ne=1;if(c.emplaceBack(z,F,G,he,me,be,Ne),w){const Ae=w.length;w.clear();for(let He=0;He<Ae;He++)w.emplaceBack(z,F,G,he,me,be,Ne)}}function nq(c,r,l){const h=c.node;let p=0;const v=l&vg.HasMeshoptCompression;for(const _ of h.meshes){if(h.lights&&h.lightMeshIndex===p||!_.featureData)continue;_.featureArray=new _h,_.featureArray.reserve(_.featureData.length);let w=r;for(const T of _.featureData){const M=v?65535&T:T>>16&65535,L=v?T>>16&65535:65535&T,z=(15&L)<8?15&L:0,F=c.evaluatedRMEA[z],G=c.evaluatedColor[z],W=c.emissionHeightBasedParams[z];let J;if(w&&z===2&&h.lights&&(J=new _h,J.resize(10*h.lights.length)),tq(_.featureArray,M,G,F,W,_.aabb.min[2],_.aabb.max[2],J),J&&w){w=!1;const oe=h.meshes[h.lightMeshIndex];oe.featureArray=J,oe.featureArray._trim()}}_.featureArray._trim(),p++}}Dn(Y1,"Tiled3dModelBucket",{omit:["layers"]}),Dn(Kk,"Tiled3dModelFeature");const rq=["id","tile","layer","source","sourceLayer","state"];class mp{constructor(r,l,h,p,v){this.type="Feature",this._vectorTileFeature=r,this._z=l,this._x=h,this._y=p,this.properties=r?r.properties:{},this.id=v}clone(){const r=new mp(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(r.state=Object.assign({},this.state)),this.layer&&(r.layer=Object.assign({},this.layer)),this.source&&(r.source=this.source),this.sourceLayer&&(r.sourceLayer=this.sourceLayer),r}get geometry(){return this._geometry===void 0&&this._vectorTileFeature&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of rq)this[l]!==void 0&&(r[l]=this[l]);return r}}class gp extends xc{constructor(r,l,h,p){super(),this.id=r,this.type="model",this.models=[],this._loaded=!1,this._options=l,this._modelsInfo=new Map}load(){const r=[];for(const l in this._options.models){const h=this._options.models[l],p=this._modelsInfo.get(l);if(p){const v=p.model;v.position=h.position!=null?new q(h.position[0],h.position[1]):new q(0,0),v.orientation=h.orientation!=null?h.orientation:[0,0,0],p.modelSpec=h,gp.applyModelSpecification(v,h),v.computeBoundsAndApplyParent(),this.models.push(v)}else{const v=fz(this.map._requestManager.transformRequest(h.uri,Dr.Model).url).then(_=>{if(!_)return;const w=p2(_),T=new _z(l,h.uri,h.position,h.orientation,w);gp.applyModelSpecification(T,h),T.computeBoundsAndApplyParent(),this.models.push(T),this._modelsInfo.set(l,{modelSpec:h,model:T})}).catch(_=>{this.fire(new Mf(new Error(`Could not load model ${l} from ${h.uri}: ${_.message}`)))});r.push(v)}}Promise.allSettled(r).then(()=>{this._loaded=!0,this.fire(new Hs("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(l=>{this._loaded=!0,this.fire(new Mf(new Error(`Could not load models: ${l.message}`)))})}static applyModelSpecification(r,l){l.nodeOverrides&&gp.convertNodeOverrides(r,l.nodeOverrides),l.materialOverrides&&gp.convertMaterialOverrides(r,l.materialOverrides),l.nodeOverrideNames&&(r.nodeOverrideNames=[...l.nodeOverrideNames]),l.materialOverrideNames&&(r.materialOverrideNames=[...l.materialOverrideNames]),l.featureProperties&&(r.featureProperties=l.featureProperties)}static convertNodeOverrides(r,l){if(Array.isArray(l)&&l.every(h=>typeof h=="string")){r.nodeOverrideNames=[];for(const h of l)r.nodeOverrideNames.push(h)}else Object.entries(l).forEach(([h,p])=>{const v={orientation:[0,0,0]};if(p.hasOwnProperty("orientation")){const _=p.orientation;_&&(v.orientation=_)}r.nodeOverrides.set(h,v)})}static convertMaterialOverrides(r,l){if(Array.isArray(l)&&l.every(h=>typeof h=="string")){r.materialOverrideNames=[];for(const h of l)r.materialOverrideNames.push(h)}else Object.entries(l).forEach(([h,p])=>{const v={color:new Mi(1,1,1),colorMix:0,emissionStrength:0,opacity:1},_=p["model-color"];_!==void 0&&(v.color.r=_[0],v.color.g=_[1],v.color.b=_[2]);const w=p["model-color-mix-intensity"];w!==void 0&&(v.colorMix=w);const T=p["model-emissive-strength"];T!==void 0&&(v.emissionStrength=T);const M=p["model-opacity"];M!==void 0&&(v.opacity=M),r.materialOverrides.set(h,v)})}onAdd(r){this.map=r,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(r,l){}serialize(){return this._options}setProperty(r,l){return!1}reload(){const r=ld(this.id,this.scope);this.map.style.clearSource(r),this.models=[],this._modelsInfo.clear(),this._loaded=!1,this.load()}setModels(r){this.models=[];const l=new Map;for(const h in r){const p=r[h];if(this._modelsInfo.has(h)){const v=this._modelsInfo.get(h);v&&v.modelSpec.uri===p.uri&&l.set(h,v)}}this._modelsInfo=l,this._options.models=r,this._loaded=!1,this.load()}}function j2(c,r,l,h){const p=1<<c.z;r.lat=ve((h/fn+c.y)/p),r.lng=Ce((l/fn+c.x)/p)}function iq(c,r,l,h){const p=c.getNodesInfo()[r];if(!p||p.hiddenByReplacement||!p.node.meshes)return;let v=Number.MAX_VALUE;const _=p.node,w=l.tile,T=h.calculatePosMatrix(w.tileID.toUnwrapped(),h.worldSize),M=p.evaluatedScale;let L=0;h.elevation&&_.elevation&&(L=_.elevation*h.elevation.exaggeration()),K(T,T,[(_.anchor?_.anchor[0]:0)*(M[0]-1),(_.anchor?_.anchor[1]:0)*(M[1]-1),L]),Y(T,T,M);const z=l.queryGeometry,F=z.isPointQuery()?z.screenBounds:z.screenGeometry,G=function(J){const oe=V([],T,J.globalMatrix);V(oe,h.expandedFarZProjMatrix,oe);for(let le=0;le<J.meshes.length;++le){const he=J.meshes[le];if(le===J.lightMeshIndex)continue;const me=u2(F,h,oe,he.aabb);me!=null&&(v=Math.min(me,v))}if(J.children)for(const le of J.children)G(le)};if(G(_),v===Number.MAX_VALUE)return;const W=new q(0,0);return j2(w.tileID.canonical,W,p.node.anchor[0],p.node.anchor[1]),{intersectionZ:v,position:W,feature:p.feature}}const oq={circle:class extends es{constructor(c,r,l,h){super(c,{layout:Ac||(Ac=new wo({"circle-sort-key":new bn(lt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new on(lt.layout_circle["circle-elevation-reference"]),visibility:new on(lt.layout_circle.visibility)})),paint:bh||(bh=new wo({"circle-radius":new bn(lt.paint_circle["circle-radius"]),"circle-color":new bn(lt.paint_circle["circle-color"]),"circle-blur":new bn(lt.paint_circle["circle-blur"]),"circle-opacity":new bn(lt.paint_circle["circle-opacity"]),"circle-translate":new on(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new on(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new on(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new on(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bn(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bn(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bn(lt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new on(lt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h)}createBucket(c){return new ao(c)}queryRadius(c){const r=c;return wa("circle-radius",this,r)+wa("circle-stroke-width",this,r)+vo(this.paint.get("circle-translate"))}queryIntersectsFeature(c,r,l,h,p,v,_,w){const T=xh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(r,l)+this.paint.get("circle-stroke-width").evaluate(r,l);return eL(c,h,v,_,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,M)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,r,l){const h=QD(this);return{config:new Rc(this,{zoom:r,lut:l}),defines:h,overrideFog:!1}}is3D(c){return!c&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends es{createBucket(c){return new nL(c)}constructor(c,r,l,h){super(c,{layout:rL||(rL=new wo({visibility:new on(lt.layout_heatmap.visibility)})),paint:iL||(iL=new wo({"heatmap-radius":new bn(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bn(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new on(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lh(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new on(lt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(c){return wa("heatmap-radius",this,c)}queryIntersectsFeature(c,r,l,h,p,v,_,w){const T=this.paint.get("heatmap-radius").evaluate(r,l);return eL(c,h,v,_,w,!0,!0,new ut(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,r,l){return c==="heatmap"?{config:new Rc(this,{zoom:r,lut:l}),overrideFog:!1}:{}}},hillshade:class extends es{constructor(c,r,l,h){super(c,{layout:oL||(oL=new wo({visibility:new on(lt.layout_hillshade.visibility)})),paint:aL||(aL=new wo({"hillshade-illumination-direction":new on(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new on(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new on(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new on(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new on(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new on(lt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new on(lt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,r,l){return{overrideFog:!1}}},fill:class extends es{constructor(c,r,l,h){super(c,{layout:bL||(bL=new wo({"fill-sort-key":new bn(lt.layout_fill["fill-sort-key"]),visibility:new on(lt.layout_fill.visibility),"fill-elevation-reference":new on(lt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new bn(lt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:wL||(wL=new wo({"fill-antialias":new on(lt.paint_fill["fill-antialias"]),"fill-opacity":new bn(lt.paint_fill["fill-opacity"]),"fill-color":new bn(lt.paint_fill["fill-color"]),"fill-outline-color":new bn(lt.paint_fill["fill-outline-color"]),"fill-translate":new on(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new on(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new bn(lt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new on(lt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new on(lt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new bn(lt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new bn(lt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new bn(lt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h)}getProgramIds(){const c=this.paint.get("fill-pattern"),r=c&&c.constantOr(1),l=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(c,r,l){return{config:new Rc(this,{zoom:r,lut:l}),overrideFog:!1}}recalculate(c,r){super.recalculate(c,r);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new qT(c)}queryRadius(){return vo(this.paint.get("fill-translate"))}queryIntersectsFeature(c,r,l,h,p,v){return!c.queryGeometry.isAboveHorizon&&So(Ys(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(c){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const r=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return c!=null?r&&!c:r}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends es{constructor(c,r,l,h){super(c,{layout:qL||(qL=new wo({visibility:new on(lt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new on(lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:KL||(KL=new wo({"fill-extrusion-opacity":new on(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bn(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new on(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new on(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bn(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new on(lt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new bn(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bn(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new on(lt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new on(lt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new on(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new on(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new on(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new on(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new on(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new on(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new on(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new on(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new bn(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new bn(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new on(lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new on(lt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new on(lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new on(lt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new bn(lt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new bn(lt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new on(lt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new w1(c)}queryRadius(){return vo(this.paint.get("fill-extrusion-translate"))}is3D(c){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,r,l,h,p,v,_,w,T){const M=xh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(r,l),z=this.paint.get("fill-extrusion-base").evaluate(r,l),F=[0,0],G=w&&v.elevation,W=v.elevation?v.elevation.exaggeration():1,J=c.tile.getBucket(this);if(G&&J instanceof w1){const be=J.centroidVertexArray,Ne=T+1;Ne<be.length&&(F[0]=be.geta_centroid_pos0(Ne),F[1]=be.geta_centroid_pos1(Ne))}if(F[0]===0&&F[1]===1)return!1;v.projection.name==="globe"&&(h=WL([h],[new ut(0,0),new ut(fn,fn)],c.tileID.canonical).map(be=>be.polygon).flat());const oe=G?w:null,[le,he]=tz(v,h,z,L,M,_,oe,F,W,v.center.lat,c.tileID.canonical),me=c.queryGeometry;return ez(le,he,me.isPointQuery()?me.screenBounds:me.screenGeometry)}},building:class extends es{constructor(c,r,l,h){super(c,{layout:Tz||(Tz=new wo({visibility:new on(lt.layout_building.visibility),"building-facade":new bn(lt.layout_building["building-facade"]),"building-facade-floors":new bn(lt.layout_building["building-facade-floors"]),"building-facade-unit-width":new bn(lt.layout_building["building-facade-unit-width"]),"building-facade-window":new bn(lt.layout_building["building-facade-window"]),"building-roof-shape":new bn(lt.layout_building["building-roof-shape"]),"building-height":new bn(lt.layout_building["building-height"]),"building-base":new bn(lt.layout_building["building-base"]),"building-flood-light-wall-radius":new bn(lt.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new bn(lt.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new bn(lt.layout_building["building-flip-roof-orientation"])})),paint:Iz||(Iz=new wo({"building-opacity":new on(lt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new on(lt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new on(lt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new on(lt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new on(lt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new on(lt.paint_building["building-vertical-scale"]),"building-cast-shadows":new on(lt.paint_building["building-cast-shadows"]),"building-color":new bn(lt.paint_building["building-color"]),"building-emissive-strength":new bn(lt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new on(lt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new on(lt.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new on(lt.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new on(lt.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new on(lt.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Ez(c)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(c){return!0}queryRadius(c){return 0}queryIntersectsFeature(c,r,l,h,p,v,_,w,T){let M=this.layout.get("building-height").evaluate(r,l);const L=this.layout.get("building-base").evaluate(r,l),z=c.tile.getBucket(this).getFootprint(r);if(z){if(z.hiddenFlags!==0)return!1;M=z.height}const[F,G]=tz(v,h,L,M,new ut(0,0),_,null,[0,0],1,v.center.lat,c.tileID.canonical),W=c.queryGeometry;return ez(F,G,W.isPointQuery()?W.screenBounds:W.screenGeometry)}},line:class extends es{constructor(c,r,l,h){const p=Fz();super(c,p,r,l,h),p.layout&&(this.layout=new sd(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Hf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,r){super.recalculate(c,r),this.paint._values["line-floorwidth"]=(()=>{if(Ly)return Ly;const l=Fz();return Ly=new t9(l.paint.properties["line-width"].specification),Ly.useIntegerZoom=!0,Ly})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new g2(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,r,l){const h=zz(this);return{config:new Rc(this,{zoom:r,lut:l}),defines:h,overrideFog:!1}}queryRadius(c){const r=c,l=Nz(wa("line-width",this,r),wa("line-gap-width",this,r)),h=wa("line-offset",this,r);return l/2+Math.abs(h)+vo(this.paint.get("line-translate"))}queryIntersectsFeature(c,r,l,h,p,v){if(c.queryGeometry.isAboveHorizon)return!1;const _=Ys(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),w=c.pixelToTileUnitsFactor/2*Nz(this.paint.get("line-width").evaluate(r,l),this.paint.get("line-gap-width").evaluate(r,l)),T=this.paint.get("line-offset").evaluate(r,l);return T&&(h=function(M,L){const z=[],F=new ut(0,0);for(let G=0;G<M.length;G++){const W=M[G],J=[];for(let oe=0;oe<W.length;oe++){const le=W[oe],he=W[oe+1],me=oe===0?F:le.sub(W[oe-1])._unit()._perp(),be=oe===W.length-1?F:he.sub(le)._unit()._perp(),Ne=me._add(be)._unit();Ne._mult(1/(Ne.x*be.x+Ne.y*be.y)),J.push(Ne._mult(L)._add(le))}z.push(J)}return z}(h,T*c.pixelToTileUnitsFactor)),function(M,L,z){for(let F=0;F<L.length;F++){const G=L[F];if(M.length>=3){for(let W=0;W<G.length;W++)if(ba(M,G[W]))return!0}if(ys(M,G,z))return!0}return!1}(_,h,w)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(c){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:q1,background:class extends es{constructor(c,r,l,h){super(c,{layout:Ik||(Ik=new wo({visibility:new on(lt.layout_background.visibility)})),paint:Pk||(Pk=new wo({"background-pitch-alignment":new on(lt.paint_background["background-pitch-alignment"]),"background-color":new on(lt.paint_background["background-color"]),"background-pattern":new on(lt.paint_background["background-pattern"]),"background-opacity":new on(lt.paint_background["background-opacity"]),"background-emissive-strength":new on(lt.paint_background["background-emissive-strength"]),"background-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,r,l){return{overrideFog:!1}}is3D(c){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:Dk,"raster-particle":Bk,sky:class extends es{constructor(c,r,l,h){super(c,{layout:kk||(kk=new wo({visibility:new on(lt.layout_sky.visibility)})),paint:Fk||(Fk=new wo({"sky-type":new on(lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new on(lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new on(lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new on(lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new on(lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new lh(lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new on(lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new on(lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new on(lt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=vy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(c,r){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),p=!h,v=c.style.light,_=v.properties.get("position");return p&&v.properties.get("anchor")==="viewport"&&jt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?F2(_.azimuthal,90-_.polar,r):F2(h[0],90-h[1],r)}const l=this.paint.get("sky-gradient-center");return F2(l[0],90-l[1],r)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends es{constructor(c,r,l,h){super(c,{paint:Nk||(Nk=new wo({}))},r,null)}},model:class extends es{constructor(c,r,l,h){super(c,{layout:Uk||(Uk=new wo({visibility:new on(lt.layout_model.visibility),"model-id":new bn(lt.layout_model["model-id"])})),paint:Hk||(Hk=new wo({"model-opacity":new bn(lt.paint_model["model-opacity"]),"model-rotation":new bn(lt.paint_model["model-rotation"]),"model-scale":new bn(lt.paint_model["model-scale"]),"model-translation":new bn(lt.paint_model["model-translation"]),"model-color":new bn(lt.paint_model["model-color"]),"model-color-mix-intensity":new bn(lt.paint_model["model-color-mix-intensity"]),"model-type":new on(lt.paint_model["model-type"]),"model-cast-shadows":new on(lt.paint_model["model-cast-shadows"]),"model-receive-shadows":new on(lt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new on(lt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new bn(lt.paint_model["model-emissive-strength"]),"model-roughness":new bn(lt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new bn(lt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new on(lt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new on(lt.paint_model["model-front-cutoff"]),"model-elevation-reference":new on(lt.paint_model["model-elevation-reference"]),"model-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},r,l,h),this.layer=c,this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new B2(c)}getProgramIds(){return["model"]}is3D(c){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof Y1?fn-1:0}queryRenderedFeatures(c,r,l){const h=r.getSource();if(!(h&&h instanceof gp))return{};const p=h,v={};v[this.id]=[];const _=v[this.id];let w=0;for(const T of p.models){const M=r.getFeatureState(this.sourceLayer,T.id),L={type:"Unknown",id:T.id,properties:T.featureProperties},z=this.paint.get("model-rotation").evaluate(L,M),F=this.paint.get("model-scale").evaluate(L,M),G=this.paint.get("model-translation").evaluate(L,M),W=this.paint.get("model-elevation-reference");let J=[];A1(J,T,l,T.position,z,F,G,W==="ground",W==="ground",!1),l.projection.name==="globe"&&(J=R1(J,l));const oe=V([],l.projMatrix,J),le=u2(c.isPointQuery()?c.screenBounds:c.screenGeometry,l,oe,T.aabb);if(le!=null){const he=new mp(void 0,0,0,0,T.id);he.layer=this.layer,he.properties=structuredClone(T.featureProperties),he.properties.layer=this.id,he.properties.uri=T.uri,he.properties.orientation=T.orientation,he.sourceLayer=this.sourceLayer,he.geometry={type:"Point",coordinates:[T.position.lng,T.position.lat]},he.state=M,he.source=this.source,_.push({featureIndex:w,feature:he,intersectionZ:le})}++w}return v}queryIntersectsFeature(c,r,l,h,p,v){if(!this.modelManager)return!1;const _=this.modelManager,w=c.tile.getBucket(this);if(!(w&&w instanceof B2))return!1;for(const T in w.instancesPerModel){const M=w.instancesPerModel[T],L=r.id!==void 0?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(M.idToFeaturesIndex.hasOwnProperty(L)){const z=M.features[M.idToFeaturesIndex[L]],F=_.getModel(T,this.scope);if(!F)return!1;let G=[];const W=new q(0,0),J=w.canonical;let oe=Number.MAX_VALUE;for(let le=0;le<z.instancedDataCount;++le){const he=16*(z.instancedDataOffset+le),me=M.instancedDataArray.float32,be=[me[he+4],me[he+5],me[he+6]];j2(J,W,Math.floor(me[he]),Math.floor(me[he+1])),A1(G,F,v,W,z.rotation,z.scale,be,!1,!1,!1),v.projection.name==="globe"&&(G=R1(G,v));const Ne=V([],v.projMatrix,G),Ae=c.queryGeometry,He=u2(Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry,v,Ne,F.aabb);He!=null&&(oe=Math.min(He,oe))}return oe!==Number.MAX_VALUE&&oe}}return!1}_handleOverridablePaintPropertyUpdate(c,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const r=this._transitionablePaint._values[c];return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof uu}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends es{constructor(c,r,l,h){super(c,{layout:SL||(SL=new wo({"clip-layer-types":new on(lt.layout_clip["clip-layer-types"]),"clip-layer-scope":new on(lt.layout_clip["clip-layer-scope"])})),paint:CL||(CL=new wo({}))},r,l,h)}recalculate(c,r){super.recalculate(c,r)}createBucket(c){return new EL(c)}is3D(c){return!0}}},V2=new Mi(0,0,0),U2={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},H2={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},J1={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},aq={PAINT_ORDER_FILL_AND_STROKE:1},Zy={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},Xk={MASK_TYPE_LUMINANCE:1};function sq(c,r,l){c===1&&r.icons.push(function(h,p){return function(v){if(v.usvg_tree.height||(v.usvg_tree.height=v.usvg_tree.width),!v.metadata)return v;const{metadata:_}=v;if(_.content_area){const{content_area:w}=_;w.left==null&&(w.left=0),w.top==null&&(w.top=w.left),w.width==null&&(w.width=v.usvg_tree.width),w.height==null&&(w.height=w.width)}if(_.text_placeholder){const{text_placeholder:w}=_;w.top==null&&(w.top=w.left),w.height==null&&(w.height=w.width)}return _.stretch_x&&_.stretch_x.length&&Zk(_,"x"),_.stretch_y&&_.stretch_y.length&&Zk(_,"y"),v}(h.readFields(lq,{name:void 0},p))}(l,l.readVarint()+l.pos))}function Zk(c,r){const l=[],h=c[`stretch_${r}`];let p=null;for(let v=0;v<h.length;v++)p===null?p=l.length===0?h[0]:l[l.length-1][1]+h[v]:(l.push([p,p+h[v]]),p=null);c[`stretch_${r}_areas`]=l}function lq(c,r,l){c===1?r.name=l.readString():c===2?r.metadata=function(h,p){return h.readFields(cq,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(l,l.readVarint()+l.pos):c===3&&(r.usvg_tree=function(h,p){return h.readFields(hq,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(l,l.readVarint()+l.pos),r.data="usvg_tree")}function cq(c,r,l){c===1?r.stretch_x=l.readPackedVarint():c===2?r.stretch_y=l.readPackedVarint():c===3?r.content_area=Yk(l,l.readVarint()+l.pos):c===4?r.variables.push(function(h,p){return h.readFields(dq,{name:void 0},p)}(l,l.readVarint()+l.pos)):c===5&&(r.text_placeholder=Yk(l,l.readVarint()+l.pos))}function Yk(c,r){return c.readFields(uq,{},r)}function uq(c,r,l){c===1?r.left=l.readVarint():c===2?r.width=l.readVarint():c===3?r.top=l.readVarint():c===4&&(r.height=l.readVarint())}function dq(c,r,l){c===1?r.name=l.readString():c===2&&(r.rgb_color=tw(l.readVarint()),r.value="rgb_color")}function hq(c,r,l){c===1?r.width=r.height=l.readVarint():c===2?r.height=l.readVarint():c===3?r.children.push(Q1(l,l.readVarint()+l.pos)):c===4?r.linear_gradients.push(function(h,p){return h.readFields(yq,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(l,l.readVarint()+l.pos)):c===5?r.radial_gradients.push(function(h,p){return h.readFields(bq,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(l,l.readVarint()+l.pos)):c===7?r.clip_paths.push(function(h,p){return h.readFields(wq,{children:[]},p)}(l,l.readVarint()+l.pos)):c===8&&r.masks.push(function(h,p){const v=h.readFields(Sq,{left:0,width:20,mask_type:Xk.MASK_TYPE_LUMINANCE,children:[]},p);return v.height==null&&(v.height=v.width),v.top==null&&(v.top=v.left),v}(l,l.readVarint()+l.pos))}function Q1(c,r){return c.readFields(fq,{},r)}function fq(c,r,l){c===1?(r.group=function(h,p){return h.readFields(pq,{opacity:255,children:[]},p)}(l,l.readVarint()+l.pos),r.node="group"):c===2&&(r.path=function(h,p){return h.readFields(gq,{paint_order:1,commands:[],step:1,diffs:[],rule:U2.PATH_RULE_NON_ZERO},p)}(l,l.readVarint()+l.pos),r.node="path")}function pq(c,r,l){c===1?r.transform=ew(l,l.readVarint()+l.pos):c===2?r.opacity=l.readVarint():c===5?r.clip_path_idx=l.readVarint():c===6?r.mask_idx=l.readVarint():c===7&&r.children.push(Q1(l,l.readVarint()+l.pos))}function ew(c,r){return c.readFields(mq,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},r)}function mq(c,r,l){c===1?r.sx=l.readFloat():c===2?r.ky=l.readFloat():c===3?r.kx=l.readFloat():c===4?r.sy=l.readFloat():c===5?r.tx=l.readFloat():c===6&&(r.ty=l.readFloat())}function gq(c,r,l){c===1?r.fill=function(h,p){return h.readFields(vq,{rgb_color:V2,paint:"rgb_color",opacity:255},p)}(l,l.readVarint()+l.pos):c===2?r.stroke=function(h,p){return h.readFields(_q,{rgb_color:V2,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(l,l.readVarint()+l.pos):c===3?r.paint_order=l.readVarint():c===5?l.readPackedVarint(r.commands):c===6?r.step=l.readFloat():c===7?l.readPackedSVarint(r.diffs):c===8&&(r.rule=l.readVarint())}function vq(c,r,l){c===1?(r.rgb_color=tw(l.readVarint()),r.paint="rgb_color"):c===2?(r.linear_gradient_idx=l.readVarint(),r.paint="linear_gradient_idx"):c===3?(r.radial_gradient_idx=l.readVarint(),r.paint="radial_gradient_idx"):c===5&&(r.opacity=l.readVarint())}function tw(c){return new Mi((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function _q(c,r,l){c===1?(r.rgb_color=tw(l.readVarint()),r.paint="rgb_color"):c===2?(r.linear_gradient_idx=l.readVarint(),r.paint="linear_gradient_idx"):c===3?(r.radial_gradient_idx=l.readVarint(),r.paint="radial_gradient_idx"):c===5?l.readPackedFloat(r.dasharray):c===6?r.dashoffset=l.readFloat():c===7?r.miterlimit=l.readFloat():c===8?r.opacity=l.readVarint():c===9?r.width=l.readFloat():c===10?r.linecap=l.readVarint():c===11&&(r.linejoin=l.readVarint())}function yq(c,r,l){c===1?r.transform=ew(l,l.readVarint()+l.pos):c===2?r.spread_method=l.readVarint():c===3?r.stops.push(Jk(l,l.readVarint()+l.pos)):c===4?r.x1=l.readFloat():c===5?r.y1=l.readFloat():c===6?r.x2=l.readFloat():c===7&&(r.y2=l.readFloat())}function Jk(c,r){return c.readFields(xq,{offset:0,opacity:255,rgb_color:V2},r)}function xq(c,r,l){c===1?r.offset=l.readFloat():c===2?r.opacity=l.readVarint():c===3&&(r.rgb_color=tw(l.readVarint()))}function bq(c,r,l){c===1?r.transform=ew(l,l.readVarint()+l.pos):c===2?r.spread_method=l.readVarint():c===3?r.stops.push(Jk(l,l.readVarint()+l.pos)):c===4?r.cx=l.readFloat():c===5?r.cy=l.readFloat():c===6?r.r=l.readFloat():c===7?r.fx=l.readFloat():c===8?r.fy=l.readFloat():c===9&&(r.fr=l.readFloat())}function wq(c,r,l){c===1?r.transform=ew(l,l.readVarint()+l.pos):c===2?r.clip_path_idx=l.readVarint():c===3&&r.children.push(Q1(l,l.readVarint()+l.pos))}function Sq(c,r,l){c===1?r.left=r.top=l.readFloat():c===2?r.width=r.height=l.readFloat():c===3?r.top=l.readFloat():c===4?r.height=l.readFloat():c===5?r.mask_type=l.readVarint():c===6?r.mask_idx=l.readVarint():c===7&&r.children.push(Q1(l,l.readVarint()+l.pos))}class Cq{static calculate(r={},l=[]){const h=new Map,p=new Map;if(Object.keys(r).length===0)return h;l.forEach(v=>{p.set(v.name,v.rgb_color||new Mi(0,0,0))});for(const[v,_]of Object.entries(r))p.has(v)?h.set(p.get(v).toString(),_):console.warn(`Ignoring unknown image variable "${v}"`);return h}}function Ig(c,r=255,l){const h=r/255,p=c.toString(),v=l.has(p)?l.get(p).clone():c.clone();return v.a*=h,v.toString()}function Yy(c,r){if(!ki()){const l=document.createElement("canvas");return l.width=c,l.height=r,l}return new OffscreenCanvas(c,r)}function Eq(c,r){const l=Cq.calculate(r.params,c.metadata?c.metadata.variables:[]),h=c.usvg_tree,p=h.width,v=h.height,_=r.transform?r.transform:new DOMMatrix,w=Math.max(1,Math.round(p*_.a)),T=Math.max(1,Math.round(v*_.d)),M=new DOMMatrix([w/p,0,0,T/v,0,0]),L=Yy(w,T).getContext("2d");return G2(L,M,h,h,l),L.getImageData(0,0,w,T)}function G2(c,r,l,h,p){for(const v of h.children)Qk(c,r,l,v,p)}function Qk(c,r,l,h,p){h.group?(c.save(),function(v,_,w,T,M){const L=T.mask_idx!=null?w.masks[T.mask_idx]:null,z=T.clip_path_idx!=null?w.clip_paths[T.clip_path_idx]:null;if(T.transform&&(_=Pg(T.transform).preMultiplySelf(_)),!function(W,J,oe){return W.opacity!==255||J||oe}(T,z!=null,L!=null))return void G2(v,_,w,T,M);const F=Yy(v.canvas.width,v.canvas.height),G=F.getContext("2d");G2(G,_,w,T,M),z&&aF(G,_,w,z),L&&sF(G,_,w,L,M),v.globalAlpha=T.opacity/255,v.drawImage(F,0,0)}(c,r,l,h.group,p),c.restore()):h.path&&(c.save(),function(v,_,w,T,M){v.setTransform(_),T.paint_order===aq.PAINT_ORDER_FILL_AND_STROKE?(eF(v,w,T,M),nF(v,w,T,M)):(nF(v,w,T,M),eF(v,w,T,M))}(c,r,l,h.path,p),c.restore())}function eF(c,r,l,h){const p=l.fill;if(!p)return;const v=p.opacity/255;switch(c.save(),c.beginPath(),lF(l,c),p.paint){case"rgb_color":c.fillStyle=Ig(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":{const _=r.linear_gradients[p.linear_gradient_idx];_.transform&&c.setTransform(Pg(_.transform).preMultiplySelf(c.getTransform())),c.fillStyle=rF(c,_,v,h);break}case"radial_gradient_idx":{const _=r.radial_gradients[p.radial_gradient_idx];_.transform&&c.setTransform(Pg(_.transform).preMultiplySelf(c.getTransform())),c.fillStyle=iF(c,_,v,h)}}c.fill(tF(l)),c.restore()}function tF(c){return c.rule===U2.PATH_RULE_NON_ZERO?"nonzero":c.rule===U2.PATH_RULE_EVEN_ODD?"evenodd":void 0}function nF(c,r,l,h){const p=l.stroke;if(!p)return;const v=cF(l);c.lineWidth=p.width,c.miterLimit=p.miterlimit,c.setLineDash(p.dasharray),c.lineDashOffset=p.dashoffset;const _=p.opacity/255;switch(p.paint){case"rgb_color":c.strokeStyle=Ig(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":c.strokeStyle=rF(c,r.linear_gradients[p.linear_gradient_idx],_,h,!0);break;case"radial_gradient_idx":c.strokeStyle=iF(c,r.radial_gradients[p.radial_gradient_idx],_,h,!0)}switch(p.linejoin){case J1.LINE_JOIN_MITER_CLIP:case J1.LINE_JOIN_MITER:c.lineJoin="miter";break;case J1.LINE_JOIN_ROUND:c.lineJoin="round";break;case J1.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(p.linecap){case H2.LINE_CAP_BUTT:c.lineCap="butt";break;case H2.LINE_CAP_ROUND:c.lineCap="round";break;case H2.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(v)}function rF(c,r,l,h,p=!1){if(r.stops.length===1){const F=r.stops[0];return Ig(F.rgb_color,F.opacity*l,h)}const{x1:v,y1:_,x2:w,y2:T}=r;let M=new DOMPoint(v,_),L=new DOMPoint(w,T);if(p){const F=Pg(r.transform);M=F.transformPoint(M),L=F.transformPoint(L)}const z=c.createLinearGradient(M.x,M.y,L.x,L.y);for(const F of r.stops)z.addColorStop(F.offset,Ig(F.rgb_color,F.opacity*l,h));return z}function iF(c,r,l,h,p=!1){if(r.stops.length===1){const le=r.stops[0];return Ig(le.rgb_color,le.opacity*l,h)}const v=Pg(r.transform),{fx:_,fy:w,fr:T,cx:M,cy:L,r:z}=r;let F=new DOMPoint(_,w),G=new DOMPoint(M,L),W=T,J=z;if(p){F=v.transformPoint(F),G=v.transformPoint(G);const le=(v.a+v.d)/2;W=T*le,J=r.r*le}const oe=c.createRadialGradient(F.x,F.y,W,G.x,G.y,J);for(const le of r.stops)oe.addColorStop(le.offset,Ig(le.rgb_color,le.opacity*l,h));return oe}function oF(c,r,l,h){const p=h.transform?Pg(h.transform).preMultiplySelf(r):r,v=Yy(c.canvas.width,c.canvas.height),_=v.getContext("2d");for(const T of h.children)if(T.group)oF(_,p,l,T.group);else if(T.path){const M=T.path,L=new Path2D;L.addPath(cF(M),p),_.fill(L,tF(M))}const w=h.clip_path_idx!=null?l.clip_paths[h.clip_path_idx]:null;w&&aF(_,p,l,w),c.globalCompositeOperation="source-over",c.drawImage(v,0,0)}function aF(c,r,l,h){const p=Yy(c.canvas.width,c.canvas.height);oF(p.getContext("2d"),r,l,h),c.globalCompositeOperation="destination-in",c.drawImage(p,0,0)}function sF(c,r,l,h,p){if(h.children.length===0)return;const v=h.mask_idx!=null?l.masks[h.mask_idx]:null;v&&sF(c,r,l,v,p);const _=c.canvas.width,w=c.canvas.height,T=Yy(_,w),M=T.getContext("2d"),L=h.width,z=h.height,F=h.left,G=h.top,W=new Path2D,J=new Path2D;J.rect(F,G,L,z),W.addPath(J,r),M.clip(W);for(const he of h.children)Qk(M,r,l,he,p);const oe=M.getImageData(0,0,_,w),le=oe.data;if(h.mask_type===Xk.MASK_TYPE_LUMINANCE)for(let he=0;he<le.length;he+=4)le[he+3]=le[he+3]/255*(.2126*le[he]+.7152*le[he+1]+.0722*le[he+2]);M.putImageData(oe,0,0),c.globalCompositeOperation="destination-in",c.drawImage(T,0,0)}function Pg(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function lF(c,r){const l=c.step;let h=c.diffs[0]*l,p=c.diffs[1]*l;r.moveTo(h,p);for(let v=0,_=2;v<c.commands.length;v++)switch(c.commands[v]){case Zy.PATH_COMMAND_MOVE:h+=c.diffs[_++]*l,p+=c.diffs[_++]*l,r.moveTo(h,p);break;case Zy.PATH_COMMAND_LINE:h+=c.diffs[_++]*l,p+=c.diffs[_++]*l,r.lineTo(h,p);break;case Zy.PATH_COMMAND_QUAD:{const w=h+c.diffs[_++]*l,T=p+c.diffs[_++]*l;h=w+c.diffs[_++]*l,p=T+c.diffs[_++]*l,r.quadraticCurveTo(w,T,h,p);break}case Zy.PATH_COMMAND_CUBIC:{const w=h+c.diffs[_++]*l,T=p+c.diffs[_++]*l,M=w+c.diffs[_++]*l,L=T+c.diffs[_++]*l;h=M+c.diffs[_++]*l,p=L+c.diffs[_++]*l,r.bezierCurveTo(w,T,M,L,h,p);break}case Zy.PATH_COMMAND_CLOSE:r.closePath()}return r}function cF(c){return lF(c,new Path2D)}class nw{constructor(r){this.capacity=r,this.cache=new Map}get(r){if(!this.cache.has(r))return;const l=this.cache.get(r);return this.cache.delete(r),this.cache.set(r,l),l}put(r,l){this.cache.has(r)?this.cache.delete(r):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(r,l)}delete(r){this.cache.delete(r)}}Dn(nw,"LRUCache");class W2{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(r){return new Ga(r,r.data)}getFromCache(r,l,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new nw(150)),this.cacheMap.get(h).get(ld(r.toString(),l))}setInCache(r,l,h,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new nw(150));const v=this.cacheDependenciesMap.get(p),_=ld(r.id.toString(),h);v.get(_)||v.set(_,new Set);const w=this.cacheMap.get(p),T=r.toString();v.get(_).add(T),w.put(ld(r.toString(),h),l)}removeImagesFromCacheByIds(r,l,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const p=this.cacheMap.get(h),v=this.cacheDependenciesMap.get(h);for(const _ of r){const w=ld(_.toString(),l);if(v.has(w)){for(const T of v.get(w))p.delete(T);v.delete(w)}}}rasterize(r,l,h,p,v=Eq){const _=this.getFromCache(r,h,p);if(_)return _.clone();const w=v(l.icon,r.options),T=W2._getImage(w);return this.setInCache(r,T,h,p),T.clone()}}class uF{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,l){const h=this.toIdx(r,l);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(r,l){return this.leaves[this.toIdx(r,l)]}toIdx(r,l){return l*this.size+r}}function dF(c,r,l,h){let p=0,v=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(h[_])<1e-15){if(l[_]<c[_]||l[_]>r[_])return null}else{const w=1/h[_];let T=(c[_]-l[_])*w,M=(r[_]-l[_])*w;if(T>M){const L=T;T=M,M=L}if(T>p&&(p=T),M<v&&(v=M),p>v)return null}return p}function hF(c,r,l,h,p,v,_,w,T,M,L){const z=h-c,F=p-r,G=v-l,W=_-c,J=w-r,oe=T-l,le=L[1]*oe-L[2]*J,he=L[2]*W-L[0]*oe,me=L[0]*J-L[1]*W,be=z*le+F*he+G*me;if(Math.abs(be)<1e-15)return null;const Ne=1/be,Ae=M[0]-c,He=M[1]-r,Ze=M[2]-l,et=(Ae*le+He*he+Ze*me)*Ne;if(et<0||et>1)return null;const Tt=He*G-Ze*F,ct=Ze*z-Ae*G,At=Ae*F-He*z,Bt=(L[0]*Tt+L[1]*ct+L[2]*At)*Ne;return Bt<0||et+Bt>1?null:(W*Tt+J*ct+oe*At)*Ne}function fF(c,r,l){return(c-r)/(l-r)}function pF(c,r,l,h,p,v,_,w,T){const M=1<<l,L=v-h,z=_-p,F=(c+1)/M*L+h,G=(r+0)/M*z+p,W=(r+1)/M*z+p;w[0]=(c+0)/M*L+h,w[1]=G,T[0]=F,T[1]=W}class mF{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(v){const _=Math.ceil(Math.log2(v.dim/8)),w=[];let T=Math.ceil(Math.pow(2,_));const M=1/T,L=(G,W,J,oe,le)=>{const he=oe?1:0,me=(G+1)*J-he,be=W*J,Ne=(W+1)*J-he;le[0]=G*J,le[1]=be,le[2]=me,le[3]=Ne};let z=new uF(T);const F=[];for(let G=0;G<T*T;G++){L(G%T,Math.floor(G/T),M,!1,F);const W=Ph(F[0],F[1],v),J=Ph(F[2],F[1],v),oe=Ph(F[2],F[3],v),le=Ph(F[0],F[3],v);z.minimums.push(Math.min(W,J,oe,le)),z.maximums.push(Math.max(W,J,oe,le)),z.leaves.push(1)}for(w.push(z),T/=2;T>=1;T/=2){const G=w[w.length-1];z=new uF(T);for(let W=0;W<T*T;W++){L(W%T,Math.floor(W/T),2,!0,F);const J=G.getElevation(F[0],F[1]),oe=G.getElevation(F[2],F[1]),le=G.getElevation(F[2],F[3]),he=G.getElevation(F[0],F[3]),me=G.isLeaf(F[0],F[1]),be=G.isLeaf(F[2],F[1]),Ne=G.isLeaf(F[2],F[3]),Ae=G.isLeaf(F[0],F[3]),He=Math.min(J.min,oe.min,le.min,he.min),Ze=Math.max(J.max,oe.max,le.max,he.max),et=me&&be&&Ne&&Ae;z.maximums.push(Ze),z.minimums.push(He),z.leaves.push(Ze-He<=5&&et?1:0)}w.push(z)}return w}(this.dem),h=l.length-1,p=l[h];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,h,0)}raycastRoot(r,l,h,p,v,_,w=1){return dF([r,l,-100],[h,p,this.maximums[0]*w],v,_)}raycast(r,l,h,p,v,_,w=1){if(!this.nodeCount)return null;const T=this.raycastRoot(r,l,h,p,v,_,w);if(T==null)return null;const M=[],L=[],z=[],F=[],G=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;G.length>0;){const{idx:W,t:J,nodex:oe,nodey:le,depth:he}=G.pop();if(this.leaves[W]){pF(oe,le,he,r,l,h,p,z,F);const be=1<<he,Ne=(oe+0)/be,Ae=(oe+1)/be,He=(le+0)/be,Ze=(le+1)/be,et=Ph(Ne,He,this.dem)*w,Tt=Ph(Ae,He,this.dem)*w,ct=Ph(Ae,Ze,this.dem)*w,At=Ph(Ne,Ze,this.dem)*w,Bt=hF(z[0],z[1],et,F[0],z[1],Tt,F[0],F[1],ct,v,_),qt=hF(F[0],F[1],ct,z[0],F[1],At,z[0],z[1],et,v,_),cn=Math.min(Bt!==null?Bt:Number.MAX_VALUE,qt!==null?qt:Number.MAX_VALUE);if(cn!==Number.MAX_VALUE)return cn;{const en=at([],v,_,J);if(gF(et,Tt,At,ct,fF(en[0],z[0],F[0]),fF(en[1],z[1],F[1]))>=en[2])return J}continue}let me=0;for(let be=0;be<this._siblingOffset.length;be++){pF((oe<<1)+this._siblingOffset[be][0],(le<<1)+this._siblingOffset[be][1],he+1,r,l,h,p,z,F),z[2]=-100,F[2]=this.maximums[this.childOffsets[W]+be]*w;const Ne=dF(z,F,v,_);if(Ne!=null){const Ae=Ne;M[be]=Ae;let He=!1;for(let Ze=0;Ze<me&&!He;Ze++)Ae>=M[L[Ze]]&&(L.splice(Ze,0,be),He=!0);He||(L[me]=be),me++}}for(let be=0;be<me;be++){const Ne=L[be];G.push({idx:this.childOffsets[W]+Ne,t:M[Ne],nodex:(oe<<1)+this._siblingOffset[Ne][0],nodey:(le<<1)+this._siblingOffset[Ne][1],depth:he+1})}}return null}_addNode(r,l,h){return this.minimums.push(r),this.maximums.push(l),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(r,l,h,p,v){if(r[p].isLeaf(l,h)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const _=p-1,w=r[_];let T=0,M=0;for(let L=0;L<this._siblingOffset.length;L++){const z=2*l+this._siblingOffset[L][0],F=2*h+this._siblingOffset[L][1],G=w.getElevation(z,F),W=w.isLeaf(z,F),J=this._addNode(G.min,G.max,W);W&&(T|=1<<L),M||(M=J)}for(let L=0;L<this._siblingOffset.length;L++)T&1<<L||this._construct(r,2*l+this._siblingOffset[L][0],2*h+this._siblingOffset[L][1],_,M+L)}}function gF(c,r,l,h,p,v){return vr(vr(c,l,v),vr(r,h,v),p)}function Ph(c,r,l){const h=l.dim,p=ie(c*h-.5,0,h-1),v=ie(r*h-.5,0,h-1),_=Math.floor(p),w=Math.floor(v),T=Math.min(_+1,h-1),M=Math.min(w+1,h-1);return gF(l.get(_,w),l.get(T,w),l.get(_,M),l.get(T,M),p-_,v-w)}const Tq={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Iq(c,r,l){return(256*c*256+256*r+l)/10-1e4}function Pq(c,r,l){return 256*c+r+l/256-32768}class rw{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,l,h,p=!1){if(this.uid=r,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void jt(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const v=this.dim=l.height-2,_=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let T=0;T<v;T++)_[this._idx(-1,T)]=_[this._idx(0,T)],_[this._idx(v,T)]=_[this._idx(v-1,T)],_[this._idx(T,-1)]=_[this._idx(T,0)],_[this._idx(T,v)]=_[this._idx(T,v-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(v,-1)]=_[this._idx(v-1,0)],_[this._idx(-1,v)]=_[this._idx(0,v-1)],_[this._idx(v,v)]=_[this._idx(v-1,v-1)]}const w=h==="terrarium"?Pq:Iq;for(let T=0;T<_.length;++T){const M=4*T;this.floatView[T]=w(this.pixels[M],this.pixels[M+1],this.pixels[M+2])}this._timestamp=ho.now()}_buildQuadTree(){this._tree=new mF(this)}get(r,l,h=!1){h&&(r=ie(r,-1,this.dim),l=ie(l,-1,this.dim));const p=this._idx(r,l);return this.floatView[p]}set(r,l,h){const p=this._idx(r,l),v=this.floatView[p];return this.floatView[p]=h,h-v}static getUnpackVector(r){return Tq[r]}_idx(r,l){if(r<-1||r>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(r+1)}static pack(r,l){const h=[0,0,0,0],p=rw.getUnpackVector(l);let v=Math.floor((r+p[3])/p[2]);return h[2]=v%256,v=Math.floor(v/256),h[1]=v%256,v=Math.floor(v/256),h[0]=v,h}getPixels(){return new cL({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,l,h){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,v=l*this.dim+this.dim,_=h*this.dim,w=h*this.dim+this.dim;switch(l){case-1:p=v-1;break;case 1:v=p+1}switch(h){case-1:_=w-1;break;case 1:w=_+1}const T=-l*this.dim,M=-h*this.dim;for(let L=_;L<w;L++)for(let z=p;z<v;z++){const F=4*this._idx(z,L),G=4*this._idx(z+T,L+M);this.pixels[F+0]=r.pixels[G+0],this.pixels[F+1]=r.pixels[G+1],this.pixels[F+2]=r.pixels[G+2],this.pixels[F+3]=r.pixels[G+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Mq(c,r,l){c===1?r.headerLength=l.readFixed32():c===2?r.x=l.readVarint():c===3?r.y=l.readVarint():c===4?r.z=l.readVarint():c===5&&r.layers.push(function(h,p){return h.readFields(Lq,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(l,l.readVarint()+l.pos))}function Rq(c,r,l){c===1?(r.delta_filter=function(h,p){return h.readFields(Aq,{blockSize:0},p)}(l,l.readVarint()+l.pos),r.filter="delta_filter"):c===2?(l.readVarint(),r.filter="zigzag_filter"):c===3?(l.readVarint(),r.filter="bitshuffle_filter"):c===4&&(l.readVarint(),r.filter="byteshuffle_filter")}function Aq(c,r,l){c===1&&(r.blockSize=l.readVarint())}function Oq(c,r,l){c===1?(l.readVarint(),r.codec="gzip_data"):c===2?(l.readVarint(),r.codec="jpeg_image"):c===3?(l.readVarint(),r.codec="webp_image"):c===4&&(l.readVarint(),r.codec="png_image")}function Dq(c,r,l){let h=0,p=0;c===1?r.firstByte=l.readFixed64():c===2?r.lastByte=l.readFixed64():c===3?r.filters.push(function(v,_){return v.readFields(Rq,{},_)}(l,l.readVarint()+l.pos)):c===4?r.codec=function(v,_){return v.readFields(Oq,{},_)}(l,l.readVarint()+l.pos):c===5?p=l.readFloat():c===6?h=l.readFloat():c===7?r.bands.push(l.readString()):c===8?r.offset=l.readDouble():c===9&&(r.scale=l.readDouble()),r.offset===0&&(r.offset=p),r.scale===0&&(r.scale=h)}function Lq(c,r,l){c===1?r.version=l.readVarint():c===2?r.name=l.readString():c===3?r.units=l.readString():c===4?r.tileSize=l.readVarint():c===5?r.buffer=l.readVarint():c===6?r.pixelFormat=l.readVarint():c===7&&r.dataIndex.push(function(h,p){return h.readFields(Dq,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(l,l.readVarint()+l.pos))}function zq(c,r,l){if(c===2)(function(h,p,v){h.readFields(kq,v,p)})(l,l.readVarint()+l.pos,r);else if(c===3)throw new Error("Not implemented")}function kq(c,r,l){if(c===1){let h=0;const p=l.readVarint()+l.pos;for(;l.pos<p;)r[h++]=l.readVarint()}}function Fq(c,r){if(r.length!==4)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let l=r[3];for(let h=2;h>=1;h--){const p=h===1?1:0,v=h===2?1:0;for(let _=0;_<r[0];_++){const w=r[1]*_;for(let T=p;T<r[1];T++){const M=r[2]*(T+w);for(let L=v;L<r[2];L++){const z=r[3]*(L+M);for(let F=0;F<r[3];F++){const G=z+F;c[G]+=c[G-l]}}}}l*=r[h]}return c}function Nq(c){for(let r=0,l=c.length;r<l;r++)c[r]=c[r]>>>1^-(1&c[r]);return c}function Bq(c,r){switch(r){case"uint32":return c;case"uint16":for(let l=0;l<c.length;l+=2){const h=c[l],p=c[l+1];c[l]=(240&h)>>4|(61440&h)>>8|(240&p)<<4|61440&p,c[l+1]=15&h|(3840&h)>>4|(15&p)<<8|(3840&p)<<4}return c;case"uint8":for(let l=0;l<c.length;l+=4){const h=c[l],p=c[l+1],v=c[l+2],_=c[l+3];c[l+0]=(192&h)>>6|(192&p)>>4|(192&v)>>2|192&_,c[l+1]=(48&h)>>4|(48&p)>>2|48&v|(48&_)<<2,c[l+2]=(12&h)>>2|12&p|(12&v)<<2|(12&_)<<4,c[l+3]=3&h|(3&p)<<2|(3&v)<<4|(3&_)<<6}return c;default:throw new Error(`Invalid pixel format, "${r}"`)}}Dn(rw,"DEMData"),Dn(mF,"DemMinMaxQuadTree",{omit:["dem"]});var zl=Uint8Array,Jy=Uint16Array,$q=Int32Array,vF=new zl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_F=new zl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jq=new zl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yF=function(c,r){for(var l=new Jy(31),h=0;h<31;++h)l[h]=r+=1<<c[h-1];var p=new $q(l[30]);for(h=1;h<30;++h)for(var v=l[h];v<l[h+1];++v)p[v]=v-l[h]<<5|h;return{b:l,r:p}},xF=yF(vF,2),bF=xF.b,Vq=xF.r;bF[28]=258,Vq[258]=28;for(var Uq=yF(_F,0).b,wF=new Jy(32768),ca=0;ca<32768;++ca){var Mg=(43690&ca)>>1|(21845&ca)<<1;wF[ca]=((65280&(Mg=(61680&(Mg=(52428&Mg)>>2|(13107&Mg)<<2))>>4|(3855&Mg)<<4))>>8|(255&Mg)<<8)>>1}var Qy=function(c,r,l){for(var h=c.length,p=0,v=new Jy(r);p<h;++p)c[p]&&++v[c[p]-1];var _,w=new Jy(r);for(p=1;p<r;++p)w[p]=w[p-1]+v[p-1]<<1;_=new Jy(1<<r);var T=15-r;for(p=0;p<h;++p)if(c[p])for(var M=p<<4|c[p],L=r-c[p],z=w[c[p]-1]++<<L,F=z|(1<<L)-1;z<=F;++z)_[wF[z]>>T]=M;return _},e0=new zl(288);for(ca=0;ca<144;++ca)e0[ca]=8;for(ca=144;ca<256;++ca)e0[ca]=9;for(ca=256;ca<280;++ca)e0[ca]=7;for(ca=280;ca<288;++ca)e0[ca]=8;var SF=new zl(32);for(ca=0;ca<32;++ca)SF[ca]=5;var Hq=Qy(e0,9),Gq=Qy(SF,5),q2=function(c){for(var r=c[0],l=1;l<c.length;++l)c[l]>r&&(r=c[l]);return r},zc=function(c,r,l){var h=r/8|0;return(c[h]|c[h+1]<<8)>>(7&r)&l},K2=function(c,r){var l=r/8|0;return(c[l]|c[l+1]<<8|c[l+2]<<16)>>(7&r)},Wq=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],kc=function(c,r,l){var h=new Error(r||Wq[c]);if(h.code=c,Error.captureStackTrace&&Error.captureStackTrace(h,kc),!l)throw h;return h},qq=new zl(0),Kq=typeof TextDecoder<"u"&&new TextDecoder;try{Kq.decode(qq,{stream:!0})}catch{}const Xq={gzip_data:"gzip"};class ic extends Error{constructor(r){super(r),this.name="MRTError"}}const Zq={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},CF={uint32:1,uint16:2,uint8:4},Yq={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let X2;class iw{constructor(r=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){const l=this.layers[r];if(!l)throw new ic(`Layer '${r}' not found`);return l}getHeaderLength(r){const l=new Uint8Array(r),h=new DataView(r);if(l[0]!==13)throw new ic("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(r){const l=new Uint8Array(r),h=this.getHeaderLength(r);if(l.length<h)throw new ic(`Expected header with length >= ${h} but got buffer of length ${l.length}`);const p=new X2(l.subarray(0,h)).readFields(Mq,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new ic(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const v of p.layers)this.layers[v.name]=new EF(v,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const l=[],h=this.getLayer(r.layerName);for(let p of r.blockIndices){const v=h.dataIndex[p],_=v.firstByte-r.firstByte,w=v.lastByte-r.firstByte;if(h._blocksInProgress.has(p))continue;const T={layerName:h.name,firstByte:_,lastByte:w,pixelFormat:h.pixelFormat,blockIndex:p,blockShape:[v.bands.length].concat(h.bandShape),buffer:h.buffer,codec:v.codec.codec,filters:v.filters.map(M=>M.filter)};h._blocksInProgress.add(p),l.push(T)}return new TF(l,()=>{l.forEach(p=>h._blocksInProgress.delete(p.blockIndex))},(p,v)=>{if(l.forEach(_=>h._blocksInProgress.delete(_.blockIndex)),p)throw p;v.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class EF{constructor({version:r,name:l,units:h,tileSize:p,pixelFormat:v,buffer:_,dataIndex:w},T){if(this.version=r,this.version!==1)throw new ic(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=l,this.units=h,this.tileSize=p,this.buffer=_,this.pixelFormat=Zq[v],this.dataIndex=w,this.bandShape=[p+2*_,p+2*_,CF[this.pixelFormat]],this._decodedBlocks=new nw(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return CF[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:r})=>r).flat()}processDecodedData(r){const l=r.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,r.data)}getBlockForBand(r){let l=0;switch(typeof r){case"string":for(const[h,p]of this.dataIndex.entries()){for(const[v,_]of p.bands.entries())if(_===r)return{bandIndex:l+v,blockIndex:h,blockBandIndex:v};l+=p.bands.length}break;case"number":for(const[h,p]of this.dataIndex.entries()){if(r>=l&&r<l+p.bands.length)return{bandIndex:r,blockIndex:h,blockBandIndex:r-l};l+=p.bands.length}break;default:throw new ic(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(r){let l=1/0,h=-1/0;const p=[],v=new Set;for(const _ of r){const{blockIndex:w}=this.getBlockForBand(_);if(w<0)throw new ic(`Invalid band: ${JSON.stringify(_)}`);const T=this.dataIndex[w];p.includes(w)||p.push(w),v.add(w),l=Math.min(l,T.firstByte),h=Math.max(h,T.lastByte)}if(v.size>this.cacheSize)throw new ic(`Number of blocks to decode (${v.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:h,blockIndices:p}}hasBand(r){const{blockIndex:l}=this.getBlockForBand(r);return l>=0}hasDataForBand(r){const{blockIndex:l}=this.getBlockForBand(r);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(r){const{blockIndex:l,blockBandIndex:h}=this.getBlockForBand(r);if(l<0)throw new ic(`Band not found: ${JSON.stringify(r)}`);const p=this._decodedBlocks.get(l.toString());if(!p)throw new ic(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const v=this.dataIndex[l],_=this.bandShape.reduce((M,L)=>M*L,1),w=h*_,T=p.subarray(w,w+_);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:v.offset,scale:v.scale}}}iw.setPbf=function(c){X2=c};class TF{constructor(r,l,h){this.tasks=r,this._onCancel=l,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,l){this._finalized||(this._onComplete(r,l),this._finalized=!0)}}iw.performDecoding=function(c,r){const l=new Uint8Array(c);return Promise.all(r.tasks.map(h=>{const{layerName:p,firstByte:v,lastByte:_,pixelFormat:w,blockShape:T,blockIndex:M,filters:L,codec:z}=h,F=l.subarray(v,_+1),G=new Uint32Array(T[0]*T[1]*T[2]);let W;if(z!=="gzip_data")throw new ic(`Unhandled codec: ${z}`);return W=function(J,oe){if(!globalThis.DecompressionStream&&oe==="gzip_data")return Promise.resolve(((be=function(He){He[0]==31&&He[1]==139&&He[2]==8||kc(6,"invalid gzip data");var Ze=He[3],et=10;4&Ze&&(et+=2+(He[10]|He[11]<<8));for(var Tt=(Ze>>3&1)+(Ze>>4&1);Tt>0;Tt-=!He[et++]);return et+(2&Ze)}(me=J))+8>me.length&&kc(6,"invalid gzip data"),function(He,Ze,et,Tt){var ct=He.length;if(!ct||Ze.f&&!Ze.l)return et||new zl(0);var At=!et,Bt=At||Ze.i!=2,qt=Ze.i;At&&(et=new zl(3*ct));var cn,en,Vt=function(_o){var Zi=et.length;if(_o>Zi){var Hi=new zl(Math.max(2*Zi,_o));Hi.set(et),et=Hi}},Yt=Ze.f||0,wt=Ze.p||0,_t=Ze.b||0,Xt=Ze.l,sn=Ze.d,Ht=Ze.m,An=Ze.n,Bn=8*ct;do{if(!Xt){Yt=zc(He,wt,1);var Sn=zc(He,wt+1,3);if(wt+=3,!Sn){var vn=He[(Oe=4+((wt+7)/8|0))-4]|He[Oe-3]<<8,Cr=Oe+vn;if(Cr>ct){qt&&kc(0);break}Bt&&Vt(_t+vn),et.set(He.subarray(Oe,Cr),_t),Ze.b=_t+=vn,Ze.p=wt=8*Cr,Ze.f=Yt;continue}if(Sn==1)Xt=Hq,sn=Gq,Ht=9,An=5;else if(Sn==2){var xn=zc(He,wt,31)+257,or=zc(He,wt+10,15)+4,Pr=xn+zc(He,wt+5,31)+1;wt+=14;for(var Gr=new zl(Pr),pi=new zl(19),Or=0;Or<or;++Or)pi[jq[Or]]=zc(He,wt+3*Or,7);wt+=3*or;var bi=q2(pi),wi=(1<<bi)-1,so=Qy(pi,bi);for(Or=0;Or<Pr;){var Oe,Pe=so[zc(He,wt,wi)];if(wt+=15&Pe,(Oe=Pe>>4)<16)Gr[Or++]=Oe;else{var Ot=0,gn=0;for(Oe==16?(gn=3+zc(He,wt,3),wt+=2,Ot=Gr[Or-1]):Oe==17?(gn=3+zc(He,wt,7),wt+=3):Oe==18&&(gn=11+zc(He,wt,127),wt+=7);gn--;)Gr[Or++]=Ot}}var Dt=Gr.subarray(0,xn),_n=Gr.subarray(xn);Ht=q2(Dt),An=q2(_n),Xt=Qy(Dt,Ht),sn=Qy(_n,An)}else kc(1);if(wt>Bn){qt&&kc(0);break}}Bt&&Vt(_t+131072);for(var Wn=(1<<Ht)-1,Gn=(1<<An)-1,Lr=wt;;Lr=wt){var dr=(Ot=Xt[K2(He,wt)&Wn])>>4;if((wt+=15&Ot)>Bn){qt&&kc(0);break}if(Ot||kc(2),dr<256)et[_t++]=dr;else{if(dr==256){Lr=wt,Xt=null;break}var Vn=dr-254;dr>264&&(Vn=zc(He,wt,(1<<(pr=vF[Or=dr-257]))-1)+bF[Or],wt+=pr);var _i=sn[K2(He,wt)&Gn],Fi=_i>>4;if(_i||kc(3),wt+=15&_i,_n=Uq[Fi],Fi>3){var pr=_F[Fi];_n+=K2(He,wt)&(1<<pr)-1,wt+=pr}if(wt>Bn){qt&&kc(0);break}Bt&&Vt(_t+131072);var hi=_t+Vn;if(_t<_n){var Ni=0-_n,Ri=Math.min(_n,hi);for(Ni+_t<0&&kc(3);_t<Ri;++_t)et[_t]=(void 0)[Ni+_t]}for(;_t<hi;++_t)et[_t]=et[_t-_n]}}Ze.l=Xt,Ze.p=Lr,Ze.b=_t,Ze.f=Yt,Xt&&(Yt=1,Ze.m=Ht,Ze.d=sn,Ze.n=An)}while(!Yt);return _t!=et.length&&At?(cn=et,((en=_t)==null||en>cn.length)&&(en=cn.length),new zl(cn.subarray(0,en))):et.subarray(0,_t)}(me.subarray(be,-8),{i:2},new zl(((le=me)[(he=le.length)-4]|le[he-3]<<8|le[he-2]<<16|le[he-1]<<24)>>>0))));var le,he,me,be;const Ne=Xq[oe];if(!Ne)throw new Error(`Unhandled codec: ${oe}`);const Ae=new globalThis.DecompressionStream(Ne);return new Response(new Blob([J]).stream().pipeThrough(Ae)).arrayBuffer().then(He=>new Uint8Array(He))}(F,z).then(J=>(function(oe,le){oe.readFields(zq,le)}(new X2(J),G),new Yq[w](G.buffer))),W.then(J=>{for(let oe=L.length-1;oe>=0;oe--)switch(L[oe]){case"delta_filter":Fq(J,T);break;case"zigzag_filter":Nq(J);break;case"bitshuffle_filter":Bq(J,w);break;default:throw new ic(`Unhandled filter "${L[oe]}"`)}return{layerName:p,blockIndex:M,data:J}}).catch(J=>{throw J})}))},Dn(TF,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Dn(iw,"MapboxRasterTile"),Dn(EF,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class IF{constructor(r){this._stringToNumber={},this._numberToString=[];for(let l=0;l<r.length;l++){const h=r[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}class PF{constructor(r,l){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new ad(fn,16,0),this.featureIndexArray=new n1,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(r,l,h,p,v,_=0,w=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,v,_);const M=this.grid;for(let L=0;L<l.length;L++){const z=l[L],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<z.length;G++){const W=z[G];F[0]=Math.min(F[0],W.x),F[1]=Math.min(F[1],W.y),F[2]=Math.max(F[2],W.x),F[3]=Math.max(F[3],W.y)}w!==0&&(F[0]-=w,F[1]-=w,F[2]+=w,F[3]+=w),F[0]<fn&&F[1]<fn&&F[2]>=0&&F[3]>=0&&M.insert(T,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new jn(new L1(this.rawTileData)).layers,this.sourceLayerCoder=new IF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,l){const{tilespaceGeometry:h,transform:p,tileTransform:v,pixelPosMatrix:_,availableImages:w,worldview:T}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const M=l.queryRadius?l.queryRadius:0,L=h.bufferedTilespaceBounds,z=this.grid.query(L.min.x,L.min.y,L.max.x,L.max.y,(J,oe,le,he)=>go(h.bufferedTilespaceGeometry,J-M,oe-M,le+M,he+M));z.sort(Jq);let F=null;p.elevation&&z.length>0&&(F=Tg.create(p.elevation,this.tileID));const G={};let W;for(let J=0;J<z.length;J++){const oe=z[J];if(oe===W)continue;W=oe;const le=this.featureIndexArray.get(oe);let he=null;this.is3DTile?this.loadMatchingModelFeature(G,le,r,h,p,T):this.loadMatchingFeature(G,le,r,w,T,(me,be,Ne,Ae=0)=>(he||(he=kt(me,this.tileID.canonical,v)),be.queryIntersectsFeature(h,me,Ne,he,this.z,p,_,F,Ae)))}return G}loadMatchingFeature(r,l,h,p,v,_){const{featureIndex:w,bucketIndex:T,sourceLayerIndex:M,layoutVertexArrayOffset:L}=l,z=this.bucketLayerIDs[T],F=h.layers,G=Object.keys(F);if(G.length&&!Qt(G,z))return;const W=h.sourceCache,J=this.sourceLayerCoder.decode(M),oe=this.vtLayers[J].feature(w),le=this.getId(oe,J);for(let he=0;he<z.length;he++){const me=z[he];if(!F[me])continue;const{styleLayer:be,targets:Ne}=F[me];let Ae={};le!==void 0&&(Ae=W.getFeatureState(be.sourceLayer,le));const He=!_||_(oe,be,Ae,L);if(!He)continue;const Ze=new mp(oe,this.z,this.x,this.y,le);Ze.tile=this.tileID.canonical,Ze.state=Ae;let et=this.serializedLayersCache.get(me);et||(et=be.serialize(),et.id=me,this.serializedLayersCache.set(me,et)),Ze.source=et.source,Ze.sourceLayer=et["source-layer"],Ze.layer=Object.assign({},et),Ze.layer.paint=MF(et.paint,be.paint,oe,Ae,p),Ze.layer.layout=MF(et.layout,be.layout,oe,Ae,p);let Tt=!1;for(const ct of Ne){this.updateFeatureProperties(Ze,ct);const{filter:At}=ct;if(At){if(oe.properties=Ze.properties,At.needGeometry){const Bt=gt(oe,!0);if(!At.filter(new Wi(this.tileID.overscaledZ,{worldview:v}),Bt,this.tileID.canonical))continue}else if(!At.filter(new Wi(this.tileID.overscaledZ,{worldview:v}),oe))continue}Tt=!0,ct.targetId&&this.addFeatureVariant(Ze,ct)}Tt&&this.appendToResult(r,me,w,Ze,He)}}loadMatchingModelFeature(r,l,h,p,v,_){const{featureIndex:w,bucketIndex:T}=l,M=this.bucketLayerIDs[T],L=h.layers,z=Object.keys(L);if(!z.length||Qt(z,M))for(let F=0;F<M.length;F++){const G=M[F],{styleLayer:W,targets:J}=L[G];if(W.type!=="model")continue;const oe=p.tile,le=oe.getBucket(W);if(!(le&&le instanceof Y1))continue;const he=iq(le,w,p,v);if(!he)continue;const{z:me,x:be,y:Ne}=oe.tileID.canonical,{feature:Ae,intersectionZ:He,position:Ze}=he;let et={};Ae.id!==void 0&&(et=h.sourceCache.getFeatureState(W.sourceLayer,Ae.id));const Tt=new mp({},me,be,Ne,Ae.id);Tt.tile=this.tileID.canonical,Tt.state=et,Tt.properties=Ae.properties,Tt.geometry={type:"Point",coordinates:[Ze.lng,Ze.lat]};let ct=this.serializedLayersCache.get(G);ct||(ct=W.serialize(),ct.id=G,this.serializedLayersCache.set(G,ct)),Tt.source=ct.source,Tt.sourceLayer=ct["source-layer"],Tt.layer=Object.assign({},ct);let At=!1;for(const Bt of J){this.updateFeatureProperties(Tt,Bt);const{filter:qt}=Bt;if(qt){if(Ae.properties=Tt.properties,qt.needGeometry){if(!qt.filter(new Wi(this.tileID.overscaledZ,{worldview:_}),Ae,this.tileID.canonical))continue}else if(!qt.filter(new Wi(this.tileID.overscaledZ,{worldview:_}),Ae))continue}At=!0,Bt.targetId&&this.addFeatureVariant(Tt,Bt)}At&&this.appendToResult(r,G,w,Tt,He)}}updateFeatureProperties(r,l,h){if(l.properties){const p={};for(const v in l.properties){const _=l.properties[v].evaluate({zoom:this.z},r._vectorTileFeature,r.state,r.tile,h);_!=null&&(p[v]=_)}r.properties=p}}addFeatureVariant(r,l,h){const p={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(p.properties=r.properties),r.variants=r.variants||{},r.variants[l.targetId]=r.variants[l.targetId]||[],r.variants[l.targetId].push(p)}appendToResult(r,l,h,p,v){let _=r[l];_===void 0&&(_=r[l]=[]),_.push({featureIndex:h,feature:p,intersectionZ:v})}lookupSymbolFeatures(r,l,h,p,v,_){const w={};this.loadVTLayers();for(const T of r)this.loadMatchingFeature(w,{bucketIndex:l,sourceLayerIndex:h,featureIndex:T,layoutVertexArrayOffset:0},p,v,_);return w}loadFeature(r){const{featureIndex:l,sourceLayerIndex:h}=r;this.loadVTLayers();const p=this.sourceLayerCoder.decode(h),v=this.vtFeatures[p];if(v[l])return v[l];const _=this.vtLayers[p].feature(l);return v[l]=_,_}hasLayer(r){for(const l of this.bucketLayerIDs)for(const h of l)if(r===h)return!0;return!1}getId(r,l){let h=r.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const v=tc(p);if(v.result!=="success"){const _=v.value.map(w=>`${w.key}: ${w.message}`).join(", ");return void jt(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=v.value}h=this.promoteIdExpression.evaluate({zoom:0},r)}else h=r.properties[p];typeof h=="boolean"&&(h=Number(h))}return h}}function MF(c,r,l,h,p){return zt(c,(v,_)=>{const w=r instanceof sd?r.get(_):null;return w&&w.evaluate?w.evaluate(l,h,void 0,p):w})}function Jq(c,r){return r-c}Dn(PF,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const RF=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Z2{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,h]=new Uint8Array(r,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=h>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=RF[15&h];if(!v)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(r,2,1),[w]=new Uint32Array(r,4,1);return new Z2(w,_,v,r)}constructor(r,l=64,h=Float64Array,p){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=h,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const v=RF.indexOf(this.ArrayType),_=2*r*this.ArrayType.BYTES_PER_ELEMENT,w=r*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${h}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+_+w+T),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=r)}add(r,l){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=r,this.coords[this._pos++]=l,h}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Y2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,l,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:_,nodeSize:w}=this,T=[0,v.length-1,0],M=[];for(;T.length;){const L=T.pop()||0,z=T.pop()||0,F=T.pop()||0;if(z-F<=w){for(let oe=F;oe<=z;oe++){const le=_[2*oe],he=_[2*oe+1];le>=r&&le<=h&&he>=l&&he<=p&&M.push(v[oe])}continue}const G=F+z>>1,W=_[2*G],J=_[2*G+1];W>=r&&W<=h&&J>=l&&J<=p&&M.push(v[G]),(L===0?r<=W:l<=J)&&(T.push(F),T.push(G-1),T.push(1-L)),(L===0?h>=W:p>=J)&&(T.push(G+1),T.push(z),T.push(1-L))}return M}within(r,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:_}=this,w=[0,p.length-1,0],T=[],M=h*h;for(;w.length;){const L=w.pop()||0,z=w.pop()||0,F=w.pop()||0;if(z-F<=_){for(let oe=F;oe<=z;oe++)OF(v[2*oe],v[2*oe+1],r,l)<=M&&T.push(p[oe]);continue}const G=F+z>>1,W=v[2*G],J=v[2*G+1];OF(W,J,r,l)<=M&&T.push(p[G]),(L===0?r-h<=W:l-h<=J)&&(w.push(F),w.push(G-1),w.push(1-L)),(L===0?r+h>=W:l+h>=J)&&(w.push(G+1),w.push(z),w.push(1-L))}return T}}function Y2(c,r,l,h,p,v){if(p-h<=l)return;const _=h+p>>1;AF(c,r,_,h,p,v),Y2(c,r,l,h,_-1,1-v),Y2(c,r,l,_+1,p,1-v)}function AF(c,r,l,h,p,v){for(;p>h;){if(p-h>600){const M=p-h+1,L=l-h+1,z=Math.log(M),F=.5*Math.exp(2*z/3),G=.5*Math.sqrt(z*F*(M-F)/M)*(L-M/2<0?-1:1);AF(c,r,l,Math.max(h,Math.floor(l-L*F/M+G)),Math.min(p,Math.floor(l+(M-L)*F/M+G)),v)}const _=r[2*l+v];let w=h,T=p;for(t0(c,r,h,l),r[2*p+v]>_&&t0(c,r,h,p);w<T;){for(t0(c,r,w,T),w++,T--;r[2*w+v]<_;)w++;for(;r[2*T+v]>_;)T--}r[2*h+v]===_?t0(c,r,h,T):(T++,t0(c,r,T,p)),T<=l&&(h=T+1),l<=T&&(p=T-1)}}function t0(c,r,l,h){J2(c,l,h),J2(r,2*l,2*h),J2(r,2*l+1,2*h+1)}function J2(c,r,l){const h=c[r];c[r]=c[l],c[l]=h}function OF(c,r,l,h){const p=c-l,v=r-h;return p*p+v*v}o.$=fm,o.A=wc,o.B=ld,o.C=2,o.D=fg,o.E=xc,o.F=Fy,o.G=ik,o.H=hm,o.I=la,o.J=K_,o.K=Gd,o.L=Ff,o.M=Fm,o.N=km,o.O=z_,o.P=ut,o.Q=jm,o.R=Dr,o.S=ch,o.T=l2,o.U=tc,o.V=Z1,o.W=F_,o.X=Qd,o.Y=Jd,o.Z=Uf,o._=Qa,o.a=function(c){return li.API_CDN_URL_REGEX.test(c)},o.a$=fh,o.a0=xr,o.a1=s_,o.a2=uh,o.a3=class extends Z1{},o.a4=Nm,o.a5=L_,o.a6=lt,o.a7=function(c){const r=c.value;return r?xr(r)?N2(r,!0)?[]:[new Z1(c.key,r,`invalid url "${r}"`)]:[new Z1(c.key,r,`string expected, "${Gd(r)}" found`)]:[]},o.a8=Gb,o.a9=wo,o.aA=ie,o.aB=V,o.aC=Ut,o.aD=_s,o.aE=ba,o.aF=ue,o.aG=Et,o.aH=function(c,r){const l={};for(let h=0;h<r.length;h++){const p=r[h];p in c&&(l[p]=c[p])}return l},o.aI=H,o.aJ=ce,o.aK=class{constructor(c){this.entries={},this.scheduler=c}request(c,r,l,h){const p=this.entries[c]=this.entries[c]||{callbacks:[]};if(p.result){const[v,_]=p.result;return this.scheduler?this.scheduler.add(()=>{h(v,_)},r):h(v,_),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=l((v,_)=>{p.result=[v,_];for(const w of p.callbacks)this.scheduler?this.scheduler.add(()=>{w(v,_)},r):w(v,_);setTimeout(()=>delete this.entries[c],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(v=>v!==h),p.callbacks.length||(p.cancel(),delete this.entries[c]))}}},o.aL=function(c,r,l){const h=JSON.stringify(c.request);return c.data&&(this.deduped.entries[h]={result:[null,c.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},p=>{const v=bo(c.request,(_,w,T)=>{_?p(_):w&&p(null,{vectorTile:l?void 0:new jn(new L1(w)),rawData:w,responseHeaders:new Map(T.entries())})});return()=>{v.cancel(),p()}},r)},o.aM=function(c){return c?{cacheControl:c.get("Cache-Control"),expires:c.get("Expires")}:{cacheControl:void 0,expires:void 0}},o.aN=function(c){Go++,Go>Oo&&(c.getActor().send("enforceCacheSizeLimit",ea),Go=0)},o.aO=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log2(c)))},o.aP=pa,o.aQ=Dk,o.aR=Bk,o.aS=q,o.aT=Ok,o.aU=function(c,r){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){r(null,l)};for(let h=0;h<c.length;h++){const p=document.createElement("source");ci(c[h])||(l.crossOrigin="Anonymous"),p.src=c[h],l.appendChild(p)}return{cancel:()=>{}}},o.aV=Oy,o.aW=gp,o.aX=rt,o.aY=jy,o.aZ=Ce,o.a_=ve,o.aa=on,o.ab=class{constructor(c){this.specification=c}possiblyEvaluate(c,r){return rr(c.expression.evaluate(r))}interpolate(c,r,l){return{x:vr(c.x,r.x,l),y:vr(c.y,r.y,l),z:vr(c.z,r.z,l),azimuthal:vr(c.azimuthal,r.azimuthal,l),polar:vr(c.polar,r.polar,l)}}},o.ac=Wi,o.ad=uu,o.ae=st,o.af=yt,o.ag=Se,o.ah=_e,o.ai=sd,o.aj=Sh,o.ak=vr,o.al=fn,o.am=Af,o.an=Gt,o.ao=Mi,o.ap=class{constructor(c){this.specification=c}possiblyEvaluate(c,r){return function([l,h]){const p=rr([1,l,h]);return{x:p.x,y:p.y,z:p.z}}(c.expression.evaluate(r))}interpolate(c,r,l){return{x:vr(c.x,r.x,l),y:vr(c.y,r.y,l),z:vr(c.z,r.z,l)}}},o.aq=function(c,r,l=0,h=!0){const p=new ut(l,l),v=c.sub(p),_=r.add(p),w=[v,new ut(_.x,v.y),_,new ut(v.x,_.y)];return h&&w.push(v.clone()),w},o.ar=function(c,r){const l=[];for(let h=0;h<c.length;h++){const p=Re(h-1,-1,c.length-1),v=Re(h+1,-1,c.length-1),_=c[h],w=c[v],T=c[p].sub(_).unit(),M=w.sub(_).unit(),L=M.angleWithSep(T.x,T.y),z=T.add(M).unit().mult(-1*r/Math.sin(L/2));l.push(_.add(z))}return l},o.as=vk,o.at=go,o.au=function(c,r,l=0){return xe(((r.x-l)*c.scale-c.x)*fn,(r.y*c.scale-c.y)*fn,Fe(r.z,r.y))},o.av=Zt,o.aw=ft,o.ax=kr,o.ay=Az,o.az=function(c){let r=1/0,l=1/0,h=-1/0,p=-1/0;for(const v of c)r=Math.min(r,v.x),l=Math.min(l,v.y),h=Math.max(h,v.x),p=Math.max(p,v.y);return{min:new ut(r,l),max:new ut(h,p)}},o.b=function(c){return li.API_FONTS_REGEX.test(c)},o.b$=ZT,o.b0=to,o.b1=ot,o.b2=Qb,o.b3=W1,o.b4=function(){Ts.isLoading()||Ts.isLoaded()||G_()!=="deferred"||W_()},o.b5=qm,o.b6=gt,o.b7=mp,o.b8=Zn,o.b9=g2,o.bA=ne,o.bB=k,o.bC=function(c,r){const{x:l,y:h}=c.point,p=ZD(l,h,c.worldSize/c._pixelsPerMercatorPixel,0,0);return V(p,p,FT(vu(r)))},o.bD=C,o.bE=Ct,o.bF=Ke,o.bG=at,o.bH=Rt,o.bI=Nt,o.bJ=bg,o.bK=tl,o.bL=C2,o.bM=function(c,r,l,h,p){const v=5*r+2;c.float32[v+0]=l,c.float32[v+1]=h,c.float32[v+2]=p},o.bN=Eg,o.bO=qn,o.bP=Ir,o.bQ=tr,o.bR=Kr,o.bS=Re,o.bT=function(c,r,l,h){var p=new b(4);return p[0]=c,p[1]=r,p[2]=l,p[3]=h,p},o.bU=class{isDataAvailableAtPoint(c){const r=this._source();if(this.isUsingMockSource()||!r||c.y<0||c.y>1)return!1;const l=r.getSource().maxzoom,h=1<<l,p=Math.floor(c.x),v=Math.floor((c.x-p)*h),_=Math.floor(c.y*h),w=this.findDEMTileFor(new pa(l,p,l,v,_));return!(!w||!w.dem)}getAtPointOrZero(c,r=0){return this.getAtPoint(c,r)||0}getAtPoint(c,r,l=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const h=this._source();if(!h||c.y<0||c.y>1)return r;const p=h.getSource().maxzoom,v=1<<p,_=Math.floor(c.x),w=c.x-_,T=new pa(p,_,p,Math.floor(w*v),Math.floor(c.y*v)),M=this.findDEMTileFor(T);if(!M||!M.dem)return r;const L=M.dem,z=1<<M.tileID.canonical.z,F=(w*z-M.tileID.canonical.x)*L.dim,G=(c.y*z-M.tileID.canonical.y)*L.dim,W=Math.floor(F),J=Math.floor(G);return(l?this.exaggeration():1)*vr(vr(L.get(W,J),L.get(W,J+1),G-J),vr(L.get(W+1,J),L.get(W+1,J+1),G-J),F-W)}static getAtTileOffset(c,r,l,h){const p=1<<c.canonical.z;return h?h.pointElevation(r):l?l.getAtPointOrZero(new st(c.wrap+(c.canonical.x+r.x/fn)/p,(c.canonical.y+r.y/fn)/p)):0}static getAtTileOffsetFunc(c,r,l,h){return(p,v,_)=>{const w=this.getAtTileOffset(c,p,v,_),T=h.upVector(c.canonical,p.x,p.y);return qe(T,T,w*h.upVectorScale(c.canonical,r,l).metersToTile),T}}getForTilePoints(c,r,l,h){if(this.isUsingMockSource())return!1;const p=Tg.create(this,c,h);return!!p&&(r.forEach(v=>{v[2]=this.exaggeration()*p.getElevationAt(v[0],v[1],l)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(c);if(!r||!r.dem)return null;const l=r.dem.tree,h=r.tileID,p=1<<c.canonical.z-h.canonical.z;let v=c.canonical.x/p-h.canonical.x,_=c.canonical.y/p-h.canonical.y,w=0;for(let T=0;T<c.canonical.z-h.canonical.z&&!l.leaves[w];T++){v*=2,_*=2;const M=2*Math.floor(_)+Math.floor(v);w=l.childOffsets[w]+M,v%=1,_%=1}return{min:this.exaggeration()*l.minimums[w],max:this.exaggeration()*l.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,r,l){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let r=!1,l=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const p of c){const v=this.getMinMaxForTile(p.tileID);v&&(l=Math.min(l,v.min),h=Math.max(h,v.max),r=!0)}return r?{min:l,max:h}:null}},o.bV=S1,o.bW=Ro,o.bX=Aa,o.bY=IL,o.bZ=$k,o.b_=AL,o.ba=qT,o.bb=kt,o.bc=vs,o.bd=tg,o.be=HD,o.bf=po,o.bg=dg,o.bh=k2,o.bi=function(c,r){const l=Sh(r.zoom);if(l===0)return vu(c);const h=h1(c),p=kT(h),v=ue(h.getWest())*r.worldSize,_=ue(h.getEast())*r.worldSize,w=ce(h.getNorth())*r.worldSize,T=ce(h.getSouth())*r.worldSize,M=[v,w,0],L=[_,w,0],z=[v,T,0],F=[_,T,0],G=j([],r.globeMatrix);return yt(M,M,G),yt(L,L,G),yt(z,z,G),yt(F,F,G),p[0]=fd(p[0],z,l),p[1]=fd(p[1],F,l),p[2]=fd(p[2],L,l),p[3]=fd(p[3],M,l),Ur.fromPoints(p)},o.bj=p1,o.bk=j,o.bl=gy,o.bm=fd,o.bn=cd,o.bo=SW,o.bp=se,o.bq=K,o.br=iw,o.bs=L1,o.bt=bo,o.bu=function(c,r){const l=[];for(const h in c)h in r||l.push(h);return l},o.bv=De,o.bw=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bx=ur,o.by=B,o.bz=N,o.c=oo,o.c$=function(c){return c*c*c*c*c},o.c0=w2,o.c1=dk,o.c2=M2,o.c3=Z2,o.c4=qe,o.c5=Cn,o.c6=On,o.c7=function(c,r,l){l*=.5;var h=r[0],p=r[1],v=r[2],_=r[3],w=Math.sin(l),T=Math.cos(l);return c[0]=h*T+p*w,c[1]=p*T-h*w,c[2]=v*T+_*w,c[3]=_*T-v*w,c},o.c8=Kn,o.c9=qr,o.cA=Ei,o.cB=mz,o.cC=Js,o.cD=qD,o.cE=function(c,r,l,h,p,v,_,w,T){if(T.name==="globe")return qD(c,r,new Js(l,h,p),!1);const M=jy({z:l,x:h,y:p},T);return new Ur([(v+M.x/M.scale)*r,r*(M.y/M.scale),_],[(v+M.x2/M.scale)*r,r*(M.y2/M.scale),w])},o.cF=function(c,r,l){return c[0]=Math.min(r[0],l[0]),c[1]=Math.min(r[1],l[1]),c[2]=Math.min(r[2],l[2]),c[3]=Math.min(r[3],l[3]),c},o.cG=function(c,r,l){return c[0]=Math.max(r[0],l[0]),c[1]=Math.max(r[1],l[1]),c[2]=Math.max(r[2],l[2]),c[3]=Math.max(r[3],l[3]),c},o.cH=function(c){const r=Math.round((c+45+360)%360/90)%4;return Xn[r]},o.cI=Ie,o.cJ=hn,o.cK=a,o.cL=function(c){const r=N(new Float64Array(16));V(r,c.pixelMatrix,c.globeMatrix);const l=[0,S,0],h=[0,E,0];return yt(l,l,r),yt(h,h,r),[l[0]>0&&l[0]<=c.width&&l[1]>0&&l[1]<=c.height&&!BT(c,new q(c.center.lat,90)),h[0]>0&&h[0]<=c.width&&h[1]>0&&h[1]<=c.height&&!BT(c,new q(c.center.lat,-90))]},o.cM=function(c,r){const{scale:l}=c.tileTransform,h=l*fn/(c.tileSize*Math.pow(2,r.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return function(p,v,_){var w=v[1],T=v[2],M=v[3],L=_[0],z=_[1];return p[0]=v[0]*L,p[1]=w*L,p[2]=T*z,p[3]=M*z,p}(new Float32Array(4),r.inverseAdjustmentMatrix,[h,h])},o.cN=P1,o.cO=ye,o.cP=pz,o.cQ=function(c){const r=pz(c,!0);return C([],[r[0],r[1],r[4],r[5]])},o.cR=Y,o.cS=Oi,o.cT=Z,o.cU=function(c){const{x:r,y:l}=c.point,{lng:h,lat:p}=c._center;return ZD(r,l,c.worldSize,h,p)},o.cV=We,o.cW=mn,o.cX=Qs,o.cY=Ao,o.cZ=m,o.c_=function(c,r,l){let h=0;for(let p=0;p<2;++p)c[p]>0&&(h+=(c[p]-0)*(c[p]-0)),r[p]<0&&(h+=(0-r[p])*(0-r[p]));return h},o.ca=function(c,r){return c[0]=-r[0],c[1]=-r[1],c[2]=-r[2],c[3]=r[3],c},o.cb=fe,o.cc=function(c,r,l,h,p){var v=1/Math.tan(r/2);if(c[0]=v/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=v,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,p!=null&&p!==1/0){var _=1/(h-p);c[10]=(p+h)*_,c[14]=2*p*h*_}else c[10]=-1,c[14]=-2*h;return c},o.cd=function(c,r,l,h,p,v,_){var w=1/(r-l),T=1/(h-p),M=1/(v-_);return c[0]=-2*w,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*T,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(r+l)*w,c[13]=(p+h)*T,c[14]=(_+v)*M,c[15]=1,c},o.ce=pe,o.cf=function(c,r,l){c[4*r+0]=l[0],c[4*r+1]=l[1],c[4*r+2]=l[2],c[4*r+3]=l[3]},o.cg=sg,o.ch=yh,o.ci=Bo,o.cj=nc,o.ck=ap,o.cl=wk,o.cm=function(){var c=new b(4);return b!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},o.cn=function(c,r,l){var h=r[0],p=r[1],v=r[2],_=r[3],w=Math.sin(l),T=Math.cos(l);return c[0]=h*T+v*w,c[1]=p*T+_*w,c[2]=h*-w+v*T,c[3]=p*-w+_*T,c},o.co=function(c,r){return c[0]===r[0]&&c[1]===r[1]&&c[2]===r[2]&&c[3]===r[3]},o.cp=tn,o.cq=function(c){var r=c[0],l=c[1],h=c[2],p=c[3];return Math.sqrt(r*r+l*l+h*h+p*p)},o.cr=nn,o.cs=bt,o.ct=rc,o.cu=3,o.cv=2,o.cw=7,o.cx=6,o.cy=pt,o.cz=ge,o.d=function(c){return li.API_TILEJSON_REGEX.test(c)},o.d$=QD,o.d0=ae,o.d1=45,o.d2=op,o.d3=function(c,r,l){const h=Math.sqrt(c*c+r*r+l*l),p=h>0?Math.acos(l/h)*Fn:0;let v=c!==0||r!==0?Math.atan2(-r,-c)*Fn+90:0;return v<0&&(v+=360),[h,v,p]},o.d4=xe,o.d5=rr,o.d6=Ve,o.d7=ze,o.d8=Ur,o.d9=Ue,o.dA=hy,o.dB=class extends xl{constructor(c){super(c),this.current=RT}set(c,r,l){if(this.fetchUniformLocation(c,r)){for(let h=0;h<9;h++)if(l[h]!==this.current[h]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},o.dC=gr,o.dD=function(c,r,l){const h=Sh(l.zoom),p=c.style.map._antialias,v=c.terrain&&c.terrain.exaggeration()>0;return h===0&&!p&&!v},o.dE=function(c){const r=c.pixelsPerMeter,l=r/pe(1,c.center.lat),h=N(new Float64Array(16));return K(h,h,[c.point.x,c.point.y,0]),Y(h,h,[l,l,r]),Float32Array.from(h)},o.dF=h1,o.dG=function(c){const r=Ie-5;c=ie(c,-r,r)/r*90;const l=Math.pow(Math.abs(Math.sin(Gt(c))),3);return Math.round(l*(x.length-1))},o.dH=function(c,r,l,h){const p=r.getNorth(),v=r.getSouth(),_=r.getWest(),w=r.getEast(),T=1<<c.z,M=w-_,L=p-v,z=M/g,F=-L/x[l],G=[0,z,0,F,0,0,p,_,0];if(c.z>0){const W=180/h;D(G,G,[W/M+1,0,0,0,W/L+1,0,-.5*W/z,.5*W/F,1])}return G[2]=T,G[5]=c.x,G[8]=c.y,G},o.dI=vu,o.dJ=function(c,r,l){const h=N(new Float64Array(16)),p=(r/(1<<c)-.5)*Math.PI*2;return te(h,l.globeMatrix,p),Float32Array.from(h)},o.dK=cL,o.dL=d1,o.dM=function(c,r){return[Math.pow(c[0],2.2)*r,Math.pow(c[1],2.2)*r,Math.pow(c[2],2.2)*r]},o.dN=P,o.dO=function(c,r){var l=Math.sin(r),h=Math.cos(r);return c[0]=h,c[1]=l,c[2]=0,c[3]=-l,c[4]=h,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},o.dP=xt,o.dQ=XD,o.dR=Jr,o.dS=ni,o.dT=256,o.dU=function(c,r){const l=[0,0,0];return yt(l,l,p1(vu(r.canonical))),yt(l,l,c),l},o.dV=c=>({u_matrix:new ap(c),u_texsize:new nc(c),u_pixels_to_tile_units:new fy(c),u_device_pixel_ratio:new Bo(c),u_width_scale:new Bo(c),u_floor_width_scale:new Bo(c),u_image:new sg(c),u_units_to_pixels:new nc(c),u_tile_units_to_pixels:new Bo(c),u_alpha_discard_threshold:new Bo(c),u_trim_offset:new nc(c),u_trim_fade_range:new nc(c),u_trim_color:new op(c),u_emissive_strength:new Bo(c),u_zbias_factor:new Bo(c),u_tile_to_meter:new Bo(c),u_ground_shadow_factor:new yh(c),u_pattern_transition:new Bo(c)}),o.dW=c=>({u_matrix:new ap(c),u_pixels_to_tile_units:new fy(c),u_device_pixel_ratio:new Bo(c),u_width_scale:new Bo(c),u_floor_width_scale:new Bo(c),u_units_to_pixels:new nc(c),u_dash_image:new sg(c),u_gradient_image:new sg(c),u_image_height:new Bo(c),u_texsize:new nc(c),u_tile_units_to_pixels:new Bo(c),u_alpha_discard_threshold:new Bo(c),u_trim_offset:new nc(c),u_trim_fade_range:new nc(c),u_trim_color:new op(c),u_emissive_strength:new Bo(c),u_zbias_factor:new Bo(c),u_tile_to_meter:new Bo(c),u_ground_shadow_factor:new yh(c)}),o.dX=c=>({u_camera_to_center_distance:new Bo(c),u_extrude_scale:new fy(c),u_device_pixel_ratio:new Bo(c),u_matrix:new ap(c),u_inv_rot_matrix:new ap(c),u_merc_center:new nc(c),u_tile_id:new yh(c),u_zoom_transition:new Bo(c),u_up_dir:new yh(c),u_emissive_strength:new Bo(c)}),o.dY=mh,o.dZ=u9,o.d_=class{constructor(c,r,l,h){this.context=c,this.format=h,this.size=l,this.texture=c.gl.createTexture();const[p,v,_]=this.size,{gl:w}=c;w.bindTexture(w.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in r&&r.data&&w.texImage3D(w.TEXTURE_3D,0,this.format,p,v,_,0,a2(this.format),s2(this.format),r.data)}bind(c,r){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_3D,this.texture),c!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,c),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,c),this.minFilter=c),r!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,r),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,r),this.wrapS=r)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.da=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.db=fz,o.dc=p2,o.dd=_z,o.de=N2,o.df=function(c,r){return c.readFields(sq,{icons:[]},r)},o.dg=C1,o.dh=wg,o.di=T2,o.dj=Do,o.dk=Hb,o.dl=Qo,o.dm=Pf,o.dn=$t,o.dp=function(c){const r=c.indexOf(Qf);return r>=0?c.slice(0,r):c},o.dq=function(c){return c.indexOf(Qf)>=0},o.dr=function(c){const r=c.lastIndexOf(Qf);return r>=0?c.slice(r+1):""},o.ds=function(c){const r=[],l=c.id;return l===void 0&&r.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&r.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&r.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),r},o.dt=function(c,r,l,h){return c.type==="custom"?new eq(c,r):new oq[c.type](c,r,l,h)},o.du=it,o.dv=function(c){const r=c.indexOf(Qf);return r>=0?c.slice(r+1):""},o.dw=class extends mp{constructor(c,r){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=r.target,this.namespace=r.namespace,r.properties&&(this.properties=r.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},o.dx=H_,o.dy=No,o.dz=function(c){return c({pluginStatus:ss,pluginURL:fu}),H_.on("pluginStateChange",c),c},o.e=li,o.e$=function([c,r,l]){const h=Math.hypot(c,r,l),p=Math.atan2(c,l),v=.5*Math.PI-Math.acos(-r/h);return new q(mn(p),mn(v))},o.e0=(c,r,l,h,p,v)=>{const _=c.transform,w=_.projection.name==="globe";let T;if(v.paint.get("circle-pitch-alignment")==="map")if(w){const L=XD(_.zoom,r.canonical)*_._pixelsPerMercatorPixel;T=Float32Array.from([L,0,0,L])}else T=_.calculatePixelsToTileUnitsMatrix(l);else T=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const M={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(_.projection),u_matrix:c.translatePosMatrix(r.projMatrix,l,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ho.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:PW,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:v.paint.get("circle-emissive-strength")};if(w){M.u_inv_rot_matrix=h,M.u_merc_center=p,M.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],M.u_zoom_transition=Sh(_.zoom);const L=p[0]*fn,z=p[1]*fn;M.u_up_dir=_.projection.upVector(new Js(0,0,0),L,z)}return M},o.e1=zz,o.e2=gs,o.e3=(c,r,l,h,p,v,_,w,T,M)=>{const L=c.transform,z=L.pitch<15?Oz(.07,.7,ie((14-L.zoom)/5,0,1)):.07,F=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Lz(c,r,l,h),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:p,u_width_scale:v,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:Dz(r,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:w,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(F?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:Ve(r.tileID.canonical,0),u_ground_shadow_factor:T,u_pattern_transition:M}},o.e4=(c,r,l,h,p,v,_,w,T,M)=>{const L=c.transform,z=L.calculatePixelsToTileUnitsMatrix(r),F=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",G=L.pitch<15?Oz(.07,.7,ie((14-L.zoom)/5,0,1)):.07;return{u_matrix:Lz(c,r,l,h),u_pixels_to_tile_units:z,u_device_pixel_ratio:v,u_width_scale:_,u_floor_width_scale:w,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:kz(l)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Dz(r,c.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(F?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:G,u_tile_to_meter:Ve(r.tileID.canonical,0),u_ground_shadow_factor:M}},o.e5=Ye,o.e6=vy,o.e7=Fe,o.e8=hd,o.e9=w1,o.eA=j2,o.eB=A1,o.eC=R1,o.eD=[1,1,1],o.eE=Tg,o.eF=Mt,o.eG=function(c,r,l,h){var p=r[0],v=r[1],_=r[2],w=r[3];return c[0]=p+h*(l[0]-p),c[1]=v+h*(l[1]-v),c[2]=_+h*(l[2]-_),c[3]=w+h*(l[3]-w),c},o.eH=vg,o.eI=yl,o.eJ=gu,o.eK=function(c,r,l,h,p,v,_,w,T,M,L,z,F,G,W,J){var oe=new b(16);return oe[0]=c,oe[1]=r,oe[2]=l,oe[3]=h,oe[4]=p,oe[5]=v,oe[6]=_,oe[7]=w,oe[8]=T,oe[9]=M,oe[10]=L,oe[11]=z,oe[12]=F,oe[13]=G,oe[14]=W,oe[15]=J,oe},o.eL=$,o.eM=oy,o.eN=tp,o.eO=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new ut(1/0,1/0),max:new ut(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,r=!1){const l=ML(new ut(0,0),new ut(fn,fn),c),h=[];if(r&&!KT(l,this._globalClipBounds))return h;for(const p of this._activeRegions){if(p.hiddenByOverlap||!KT(l,p))continue;const v=r7(p.min,p.max,c);h.push({min:v.min,max:v.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return h}setSources(c){this._setSources(c.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const l=[];for(const h of r.cache.getVisibleCoordinates()){const p=r.cache.getTile(h).buckets[r.layer];p&&p.updateFootprints(h.toUnwrapped(),l)}return l},getOrder:()=>r.order,getClipMask:()=>r.clipMask,getClipScope:()=>r.clipScope})))}_addSource(c){const r=c.getFootprints();if(r.length===0)return;const l=c.getOrder(),h=c.getClipMask(),p=c.getClipScope();for(const v of r){if(!v.footprint)continue;const _=ML(v.footprint.min,v.footprint.max,v.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:v.id,footprint:v.footprint,order:l,clipMask:h,clipScope:p})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((r,l)=>r.priority-l.priority||y1(r.min,l.min)||y1(r.max,l.max)||r.order-l.order||r.clipMask-l.clipMask||function(h,p){const v=(_,w)=>_+w;return h.length-p.length||h.reduce(v,"").localeCompare(p.reduce(v,""))}(r.clipScope,l.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let r=0;for(;!c&&r!==this._activeRegions.length;){const l=this._activeRegions[r],h=this._prevRegions[r];c=l.priority!==h.priority||!PL(l,h)||l.order!==h.order||l.clipMask!==h.clipMask||!ur(l.clipScope,h.clipScope),this._activeRegions[r].hiddenByOverlap=h.hiddenByOverlap,++r}}if(c){++this._updateTime;for(const l of this._activeRegions)l.order!==Sy&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const r=l=>{const h=this._activeRegions;if(l>=h.length)return l;const p=h[l].priority;for(;l<h.length&&h[l].priority===p;)++l;return l};if(this._sourceIds.length>1){let l=0,h=r(l);for(;l!==h;){let p=l;const v=l;for(;p!==h;){const _=this._activeRegions[p];_.hiddenByOverlap=!1;for(let w=0;w<v;w++){const T=this._activeRegions[w];if(!T.hiddenByOverlap&&_.order===Sy&&KT(_,T)&&(_.hiddenByOverlap=RL(_.footprint,_.tileId,T.footprint,T.tileId),_.hiddenByOverlap))break}++p}l=h,h=r(l)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=c.length-1;r>=0;r--)this._addSource(c[r]);this._computeReplacement()}},o.eP=Sy,o.eQ=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,r){const l=new vs,h=new to,p=[],v=c+1+2,_=r[0]+1,w=r[0]+1+(1+r.length),T=(M,L,z)=>{let F=M===v-1?M-2:M===0?M:M-1;return F+=z?24575:0,[F,L]};for(let M=0;M<v;++M)l.emplaceBack(...T(M,0,!0));for(let M=0;M<_;++M)for(let L=0;L<v;++L)l.emplaceBack(...T(L,M,(L===0||L===v-1)&&!0));for(let M=0;M<r.length;++M){const L=r[M];for(let z=0;z<v;++z)l.emplaceBack(...T(z,L,!0))}for(let M=0;M<r.length;++M){const L=h.length,z=r[M]+1+2,F=new to;for(let J=0;J<z-1;J++){const oe=J===z-2,le=oe?v*(w-r.length+M-J):v;for(let he=0;he<v-1;he++){const me=J*v+he;J===0||oe||he===0||he===v-2?(F.emplaceBack(me+1,me,me+le),F.emplaceBack(me+le,me+le+1,me+1)):(h.emplaceBack(me+1,me,me+le),h.emplaceBack(me+le,me+le+1,me+1))}}const G=po.simpleSegment(0,L,l.length,h.length-L);for(let J=0;J<F.uint16.length;J+=3)h.emplaceBack(F.uint16[J],F.uint16[J+1],F.uint16[J+2]);const W=po.simpleSegment(0,L,l.length,h.length-L);p.push({withoutSkirts:G,withSkirts:W})}return{vertices:l,indices:h,segments:p}}_createGrid(c){const r=this._fillGridMeshWithLods(g,x);this._gridSegments=r.segments,this._gridBuffer=c.createVertexBuffer(r.vertices,HD.members),this._gridIndexBuffer=c.createIndexBuffer(r.indices,!0)}_createPoles(c){const r=new to;for(let _=0;_<=g;_++)r.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=c.createIndexBuffer(r,!0);const l=new dd,h=new dd,p=new dd,v=new dd;this._poleSegments=[];for(let _=0,w=0;_<m;_++){const T=360/(1<<_);l.emplaceBack(0,-_s,0,.5,0),h.emplaceBack(0,-_s,0,.5,1),p.emplaceBack(0,-_s,0,.5,.5),v.emplaceBack(0,-_s,0,.5,.5);for(let M=0;M<=g;M++){let L=M/g,z=0;const F=vr(0,T,L),[G,W,J]=R(TW,IW,F,_s);l.emplaceBack(G,W,J,L,z),h.emplaceBack(G,W,J,L,1-z);const oe=Gt(F);L=.5+.5*Math.sin(oe),z=.5+.5*Math.cos(oe),p.emplaceBack(G,W,J,L,z),v.emplaceBack(G,W,J,L,1-z)}this._poleSegments.push(po.simpleSegment(w,0,66,64)),w+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(l,ug,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(h,ug,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(p,ug,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(v,ug,!1)}getGridBuffers(c,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.eR=TL,o.eS=je,o.eT=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.eU=re,o.eV=Me,o.eW=function(c,r,l){return c[0]=r[0]/l[0],c[1]=r[1]/l[1],c[2]=r[2]/l[2],c},o.eX=In,o.eY=O,o.eZ=vt,o.e_=Te,o.ea=GL,o.eb=Eh,o.ec=zL,o.ed=LL,o.ee=Le,o.ef=function(c,r){if(c===r){var l=r[1],h=r[2],p=r[3],v=r[6],_=r[7],w=r[11];c[1]=r[4],c[2]=r[8],c[3]=r[12],c[4]=l,c[6]=r[9],c[7]=r[13],c[8]=h,c[9]=v,c[11]=r[14],c[12]=p,c[13]=_,c[14]=w}else c[0]=r[0],c[1]=r[4],c[2]=r[8],c[3]=r[12],c[4]=r[1],c[5]=r[5],c[6]=r[9],c[7]=r[13],c[8]=r[2],c[9]=r[6],c[10]=r[10],c[11]=r[14],c[12]=r[3],c[13]=r[7],c[14]=r[11],c[15]=r[15];return c},o.eg=Q9,o.eh=Zr,o.ei=sy,o.ej=256,o.ek=FT,o.el=Ks,o.em=te,o.en=function(c,r){return c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[4],c[4]=r[5],c[5]=r[6],c[6]=r[8],c[7]=r[9],c[8]=r[10],c},o.eo=dd,o.ep=iy,o.eq=Fb,o.er=function(c,r,l,h,p){return ie((c-r)/(l-r)*(p-h)+h,h,p)},o.es=Un,o.et=function(c,r){var l=r[0],h=r[1],p=r[2],v=r[3],_=r[4],w=r[5],T=r[6],M=r[7],L=r[8],z=L*_-w*M,F=-L*v+w*T,G=M*v-_*T,W=l*z+h*F+p*G;return W?(c[0]=z*(W=1/W),c[1]=(-L*h+p*M)*W,c[2]=(w*h-p*_)*W,c[3]=F*W,c[4]=(L*l-p*T)*W,c[5]=(-w*l+p*v)*W,c[6]=G*W,c[7]=(-M*l+h*T)*W,c[8]=(_*l-h*v)*W,c):null},o.eu=2,o.ev=Pt,o.ew=Tn,o.ex=de,o.ey=function(c,r){var l=new b(3);de(l,r);var h=1/l[0],p=1/l[1],v=1/l[2],_=r[0]*h,w=r[1]*p,T=r[2]*v,M=r[4]*h,L=r[5]*p,z=r[6]*v,F=r[8]*h,G=r[9]*p,W=r[10]*v,J=_+L+W,oe=0;return J>0?(oe=2*Math.sqrt(J+1),c[3]=.25*oe,c[0]=(z-G)/oe,c[1]=(F-T)/oe,c[2]=(w-M)/oe):_>L&&_>W?(oe=2*Math.sqrt(1+_-L-W),c[3]=(z-G)/oe,c[0]=.25*oe,c[1]=(w+M)/oe,c[2]=(F+T)/oe):L>W?(oe=2*Math.sqrt(1+L-_-W),c[3]=(F-T)/oe,c[0]=(w+M)/oe,c[1]=.25*oe,c[2]=(z+G)/oe):(oe=2*Math.sqrt(1+W-_-L),c[3]=(w-M)/oe,c[0]=(F+T)/oe,c[1]=(z+G)/oe,c[2]=.25*oe),c},o.ez=function(c,r){var l=2*Math.acos(r[3]),h=Math.sin(l/2);return h>y?(c[0]=r[0]/h,c[1]=r[1]/h,c[2]=r[2]/h):(c[0]=1,c[1]=0,c[2]=0),l},o.f=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(r,l)=>String.fromCharCode(+("0x"+l))))},o.f0=Jt,o.f1=c2,o.f2=function(c){const r=c.navigator?c.navigator.userAgent:null;return!!function(l){if(ar==null){const h=l.navigator?l.navigator.userAgent:null;ar=!!l.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return ar}(c)&&!(!r||!(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},o.f3=function(c,r){ea=c,Oo=r},o.f4=BT,o.f5=YD,o.f6=function(c){const r=[0,0,0],l=N(new Float64Array(16));return V(l,c.pixelMatrix,c.globeMatrix),yt(r,r,l),new ut(r[0],r[1])},o.f7=function(){const c=My;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(t2),My=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.f8=function(){C1().acquire(t2)},o.f9=G_,o.fA=Kt,o.fB=function(c){let r=0;if(new Uint32Array(c,0,1)[0]!==lz){const l=new Uint32Array(c,0,7),[,,h,p,v,_]=l;r=l.byteLength+p+v+_+v,(h!==c.byteLength||r>=c.byteLength)&&jt("Invalid b3dm header information.")}return hz(c,r)},o.fC=function(c,r){const l=p2(c);for(const h of l){for(const p of h.meshes)L7(p);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(z7(h.lights,r)))}return l},o.fD=Y1,o.fE=En,o.fF=rz,o.fG=Ts,o.fH=Es,o.fI=function(c){Eo(),Xr!=null&&Xr.then(r=>{r.keys().then(l=>{for(let h=0;h<l.length-c;h++)r.delete(l[h]).catch(p=>jt(p.message))}).catch(l=>jt(l.message))}).catch(r=>jt(r.message))},o.fa=function(c,r,l=!1){if(ss===Es.deferred||ss===Es.loading||ss===Es.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");fu=ho.resolveURL(c),ss=Es.deferred,V_=r,U_(),l||W_()},o.fb=function(c){pg=ho.resolveURL(c),mg||(mg=new fg(C1(),new xc)),mg.broadcast("setMeshoptUrl",pg)},o.fc=az,o.fd=function(c){r2=ho.resolveURL(c),mg||(mg=new fg(C1(),new xc)),mg.broadcast("setDracoUrl",r2)},o.fe=oz,o.ff=Py,o.fg=function(c){const r=qo();if(!r)return;const l=r.delete(Ho);c&&l.then(()=>c()).catch(c)},o.fh=up,o.fi=Dn,o.fj=Ch,o.fk=Lc,o.fl=IF,o.fm=PF,o.fn=Pz,o.fo=wn,o.fp="hd_road_elevation",o.fq=Sr,o.fr=zt,o.fs=pd,o.ft=E2,o.fu=fp,o.fv=function(c,r,l,h,p,v,_,w=1,T,M,L){c.createArrays(),c.tilePixelRatio=fn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const z=c.layers[0].layout,F=c.layers[0]._unevaluatedLayout._values,G={};G.scaleFactor=w,G.textSizeScaleRange=z.get("text-size-scale-range"),G.iconSizeScaleRange=z.get("icon-size-scale-range");const[W,J]=G.textSizeScaleRange,[oe,le]=G.iconSizeScaleRange;G.textScaleFactor=ie(G.scaleFactor,W,J),G.iconScaleFactor=ie(G.scaleFactor,oe,le);const he=F["text-size"],me=F["icon-size"];if(c.textSizeData.kind==="composite"){const{minZoom:et,maxZoom:Tt}=c.textSizeData;G.compositeTextSizes=[he.possiblyEvaluate(new Wi(et,{worldview:L}),v),he.possiblyEvaluate(new Wi(Tt,{worldview:L}),v)]}if(c.iconSizeData.kind==="composite"){const{minZoom:et,maxZoom:Tt}=c.iconSizeData;G.compositeIconSizes=[me.possiblyEvaluate(new Wi(et,{worldview:L}),v),me.possiblyEvaluate(new Wi(Tt,{worldview:L}),v)]}G.layoutTextSize=he.possiblyEvaluate(new Wi(_+1,{worldview:L}),v),G.layoutIconSize=me.possiblyEvaluate(new Wi(_+1,{worldview:L}),v),G.textMaxSize=he.possiblyEvaluate(new Wi(18,{worldview:L}),v);const be=z.get("symbol-placement"),Ne=z.get("text-rotation-alignment")==="map"&&be!=="point",Ae=z.get("text-size");let He=!1;const Ze=[];for(const et of c.features){const Tt=z.get("text-font").evaluate(et,{},v).join(","),ct=Ae.evaluate(et,{},v)*G.textScaleFactor,At=G.layoutTextSize.evaluate(et,{},v)*G.textScaleFactor,Bt=G.layoutIconSize.evaluate(et,{},v)*G.iconScaleFactor,qt={horizontal:{},vertical:void 0},cn=et.text;let en,Vt=[0,0];if(cn){const Gr=cn.toString(),pi=z.get("text-letter-spacing").evaluate(et,{},v)*Aa,Or=z.get("text-line-height").evaluate(et,{},v)*Aa,bi=Vb(Gr)?pi:0,wi=z.get("text-anchor").evaluate(et,{},v),so=z.get("text-variable-anchor");if(!so){const Dt=z.get("text-radial-offset").evaluate(et,{},v);if(Dt)Vt=dk(wi,[Dt*Aa,P2]);else{const _n=z.get("text-offset").evaluate(et,{},v);Vt=[_n[0]*Aa,_n[1]*Aa]}}let Oe=Ne?"center":z.get("text-justify").evaluate(et,{},v);const Pe=be==="point",Ot=Pe?z.get("text-max-width").evaluate(et,{},v)*Aa:1/0,gn=Dt=>{c.allowVerticalPlacement&&B_(Gr)&&(qt.vertical=b2(cn,r,l,p,Tt,Ot,Or,wi,Dt,bi,Vt,tl.vertical,!0,At,ct,T))};if(!Ne&&so){const Dt=Oe==="auto"?so.map(Wn=>M2(Wn)):[Oe];let _n=!1;for(let Wn=0;Wn<Dt.length;Wn++){const Gn=Dt[Wn];if(!qt.horizontal[Gn])if(_n)qt.horizontal[Gn]=qt.horizontal[0];else{const Lr=b2(cn,r,l,p,Tt,Ot,Or,"center",Gn,bi,Vt,tl.horizontal,!1,At,ct,T);Lr&&(qt.horizontal[Gn]=Lr,_n=Lr.positionedLines.length===1)}}gn("left")}else{if(Oe==="auto"&&(Oe=M2(wi)),Pe||z.get("text-writing-mode").indexOf("horizontal")>=0||!B_(Gr)){const Dt=b2(cn,r,l,p,Tt,Ot,Or,wi,Oe,bi,Vt,tl.horizontal,!1,At,ct,T);Dt&&(qt.horizontal[Oe]=Dt)}gn(Pe?"left":Oe)}}let Yt,wt,_t,Xt,sn,Ht,An=!1;const Bn=z.get("icon-text-fit").evaluate(et,{},v);if(et.icon&&et.icon.hasPrimary()){const Gr=By(et.icon,c.iconSizeData,F["icon-size"],v,c.zoom,et,T,G.iconScaleFactor,L);Yt=Gr.iconPrimary,_t=Gr.iconSecondary;const pi=Yt.toString();if(wt=h.get(pi),wt&&(sn=z.get("icon-offset").evaluate(et,{},v),Ht=z.get("icon-anchor").evaluate(et,{},v),en=k1(p.get(pi),_t?p.get(_t.toString()):void 0,sn,Ht),An=wt.sdf,c.sdfIcons===void 0?c.sdfIcons=wt.sdf:c.sdfIcons!==wt.sdf&&jt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(wt.pixelRatio!==c.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0)),_t){const Or=_t.toString();Xt=h.get(Or)}}He=He||!(!et.icon||!et.icon.hasSecondary());const Sn=R2(qt.horizontal)||qt.vertical;c.iconsInText||(c.iconsInText=!!Sn&&Sn.iconsInText);const vn=At*G.textScaleFactor/Aa,{defaultShapedIcon:Cr,verticallyShapedIcon:xn}=B9(c,en,z,et,v,qt,vn,sn,Bn);Bn!=="none"&&en&&(Zz(en)||Yz(en))&&(j1(0,wt,Yt,en,Cr,Bn,M,h,p),j1(0,Xt,_t,en,Cr,Bn,M,h,p),xn&&(j1(0,wt,Yt,en,xn,Bn,M,h,p),j1(0,Xt,_t,en,xn,Bn,M,h,p))),en=Cr;const{iconBBox:or,iconVerticalBBox:Pr}=k9(c,en,xn,z,et,v,Bt,sn,G,p,Ht);Ze.push({feature:et,shapedTextOrientations:qt,shapedText:Sn,shapedIcon:en,iconPrimary:Yt,iconSecondary:_t,iconOffset:sn,iconAnchor:Ht,verticallyShapedIcon:xn,layoutTextSize:At,layoutIconSize:Bt,textOffset:Vt,isSDFIcon:An,iconTextFit:Bn,iconCollisionBounds:or,iconVerticalCollisionBounds:Pr})}return{featureData:Ze,sizes:G,hasAnySecondaryIcon:He,textAlongLine:Ne,symbolPlacement:be}},o.fw=ok,o.fx=function(c,r,l,h,p,v,_,w,T,M){c.iconAtlasPositions=M.iconPositions;const{featureData:L,hasAnySecondaryIcon:z,sizes:F,textAlongLine:G,symbolPlacement:W}=r;for(const J of L){const{shapedIcon:oe,verticallyShapedIcon:le,feature:he,shapedTextOrientations:me,shapedText:be,layoutTextSize:Ne,textOffset:Ae,isSDFIcon:He,iconPrimary:Ze,iconSecondary:et,iconTextFit:Tt,iconOffset:ct,iconCollisionBounds:At,iconVerticalCollisionBounds:Bt}=J;fk(oe,M.iconPositions,Ze,et),fk(le,M.iconPositions,Ze,et),N9(me,M.iconPositions),F9(Ze,et,M.iconPositions),(be||oe)&&$9(c,he,me,oe,le,T,F,Ne,0,Ae,He,h,p,_,w,z,Tt,ct,G,W,At,Bt)}l&&c.generateCollisionDebugBuffers(v,c.collisionBoxArray,F.textScaleFactor)},o.fy=jn,o.fz=rw,o.g=function(c,r){return No(Object.assign(c,{method:"GET"}),r)},o.h=function(c){return c.indexOf("mapbox:")===0},o.i=function(c){return li.API_STYLE_REGEX.test(c)&&!oo(c)},o.j=Ui,o.k=Ia,o.l=function(c){return decodeURIComponent(atob(c).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.m=function(c,r){return No(Object.assign(c,{type:"json"}),r)},o.n=i_,o.o=ho,o.p=function(c,r){return No(Object.assign(c,{method:"POST"}),r)},o.q=Ga,o.r=ki,o.s=function(c){try{const r=self[c];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=function(){return n2||(n2=new up),n2},o.u=function(){return function c(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=jt,o.x=W2,o.y=Mf,o.z=Hs}),d(["./shared"],function(o){function y(je){const re=je?je.url.toString():void 0;return re?performance.getEntriesByName(re):[]}function b(je){if(typeof je=="number"||typeof je=="boolean"||typeof je=="string"||je==null)return JSON.stringify(je);if(Array.isArray(je)){let ie="[";for(const _e of je)ie+=`${b(_e)},`;return`${ie}]`}let re="{";for(const ie of Object.keys(je).sort())re+=`${ie}:${b(je[ie])},`;return`${re}}`}function C(je){let re="";for(const ie of o.bw)re+=`/${b(je[ie])}`;return re}class P{constructor(re){this.keyCache={},this._layers={},this._layerConfigs={},re&&this.replace(re)}replace(re,ie){this._layerConfigs={},this._layers={},this.update(re,[],ie)}update(re,ie,_e){this._options=_e;for(const De of re)this._layerConfigs[De.id]=De,(this._layers[De.id]=o.dt(De,this.scope,null,this._options)).compileFilter(_e),this.keyCache[De.id]&&delete this.keyCache[De.id];for(const De of ie)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const Re=function(De,Ge){const ot={};for(let rt=0;rt<De.length;rt++){const zt=De[rt];let it=Ge&&Ge[zt.id];it||(zt.type==="symbol"?it=zt.id:(it=C(zt),zt.type==="line"&&zt.paint&&function Qt(Ft){return typeof Ft=="string"&&Ft==="line-progress"||(Array.isArray(Ft)?Ft.some(Qt):!(!Ft||typeof Ft!="object")&&Object.values(Ft).some(Qt))}(zt.paint["line-width"])&&(it+=`/${b(zt.paint["line-width"])}`))),Ge&&(Ge[zt.id]=it);let $t=ot[it];$t||($t=ot[it]=[]),$t.push(zt)}const Ye=[];for(const rt in ot)Ye.push(ot[rt]);return Ye}(Object.values(this._layerConfigs),this.keyCache);for(const De of Re){const Ge=De.map($t=>this._layers[$t.id]),ot=Ge[0];if(ot.visibility==="none")continue;const Ye=ot.source||"";let rt=this.familiesBySource[Ye];rt||(rt=this.familiesBySource[Ye]={});const zt=ot.sourceLayer||"_geojsonTileLayer";let it=rt[zt];it||(it=rt[zt]=[]),it.push(Ge)}}}const A=1*o.fk;class D{constructor(re){const ie={},_e=[];for(const ot in re){const Ye=re[ot],rt=ie[ot]={};for(const zt in Ye.glyphs){const it=Ye.glyphs[+zt];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const $t=it.metrics.localGlyph?A:1,Qt={x:0,y:0,w:it.bitmap.width+2*$t,h:it.bitmap.height+2*$t};_e.push(Qt),rt[zt]=Qt}}const{w:Re,h:De}=o.G(_e),Ge=new o.fj({width:Re||1,height:De||1});for(const ot in re){const Ye=re[ot];for(const rt in Ye.glyphs){const zt=Ye.glyphs[+rt];if(!zt||zt.bitmap.width===0||zt.bitmap.height===0)continue;const it=ie[ot][rt],$t=zt.metrics.localGlyph?A:1;o.fj.copy(zt.bitmap,Ge,{x:0,y:0},{x:it.x+$t,y:it.y+$t},zt.bitmap)}}this.image=Ge,this.positions=ie}}function k(je,re,ie){je[re]?ie&&(je[re].center=ie):je[re]={floorIds:new Set,center:ie||[0,0],floors:{}}}function B(je,re,ie,_e){for(const Re of re)k(je,Re),je[Re].floors[ie]=_e,je[Re].floorIds.add(ie)}function N(je){return{id:je.properties.id.toString(),center:je.properties.center.toString().split(";").map(Number)}}function j(je){return{id:je.properties.id.toString(),isDefault:!!je.properties.is_default&&je.properties.is_default,connections:je.properties.connected_floor_ids?new Set(je.properties.connected_floor_ids.toString().split(";")):new Set,conflicts:je.properties.conflicted_floor_ids?new Set(je.properties.conflicted_floor_ids.toString().split(";")):new Set,buildings:je.properties.building_ids?new Set(je.properties.building_ids.toString().split(";")):new Set,name:je.properties.name.toString(),zIndex:je.properties.z_index}}function V(je,re){return re.every(ie=>je.properties&&je.properties[ie]!=null)}function K(je){return V(je,["type","id","name"])&&je.properties.type==="building"}function Y(je){return V(je,["type","id","name","z_index"])&&je.properties.type==="floor"}o.fi(D,"GlyphAtlas");class Z{constructor(re){this.tileID=new o.aP(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.tileZoom=re.tileZoom,this.uid=re.uid,this.zoom=re.zoom,this.lut=re.lut,this.canonical=re.tileID.canonical,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.scope=re.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.request&&re.request.collectResourceTiming,this.promoteId=re.promoteId,this.isSymbolTile=re.isSymbolTile,this.tileTransform=o.aY(re.tileID.canonical,re.projection),this.projection=re.projection,this.worldview=re.worldview,this.localizableLayerIds=re.localizableLayerIds,this.brightness=re.brightness,this.extraShadowCaster=!!re.extraShadowCaster,this.tessellationStep=re.tessellationStep,this.scaleFactor=re.scaleFactor,this.worldview=re.worldview,this.indoor=re.indoor}parse(re,ie,_e,Re,De,Ge){this.status="parsing",this.data=re,this.collisionBoxArray=new o.b2;const ot=new o.fl(Object.keys(re.layers).sort()),Ye=new o.fm(this.tileID,this.promoteId);Ye.bucketLayerIDs=[];const rt={},zt=new o.fn(256,256),it={featureIndex:Ye,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:zt,availableImages:_e,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0,activeFloors:void 0};if(this.indoor){const jt=this.indoor.indoorState.activeFloorsVisible,rn=function(yn,rr,En){const Zn=function(Ar,yr){if(!Ar)return o.w("No source layers defined in indoor specification"),yr;if(Ar.size===0)return yr;const Jr=Ar.difference(yr);for(const ni of Jr)o.w(`Missing source layer required in indoor specification: ${ni}`);return yr.intersection(yr)}(rr.sourceLayers,new Set(Object.keys(yn.layers))),ar=rr.indoorState,qr=function(Ar,yr,Jr,ni){const Qr=new Set,li=new Set,Ui=new Set,oo=new Map,Ti={},wr=nr=>{const xi=oo.get(nr)||new Set;for(const oi of Qr)if((oo.get(oi)||new Set).has(nr)||xi.has(oi))return!0;return!1};for(const nr of yr){const xi=Ar.layers[nr];if(xi)for(let oi=0;oi<xi.length;oi++){const Li=xi.feature(oi);if(K(Li)){const{id:ki,center:ho}=N(Li);k(Ti,ki,ho),Qr.add(ki)}else if(Y(Li)){const{id:ki,isDefault:ho,connections:Uo,conflicts:Qo,buildings:Ho,name:ea,zIndex:Oo}=j(Li);B(Ti,Ho,ki,{name:ea,zIndex:Oo}),oo.set(ki,Qo),(ki===ni||Uo.has(ni))&&Qr.add(ki),li.add(ki),ho&&Ui.add(ki)}}else o.w(`indoor source layer not found: ${nr}`)}if(Jr)for(const nr of Jr)li.has(nr)&&(wr(nr)||Qr.add(nr));for(const nr of Ui)Qr.has(nr)||wr(nr)||Qr.add(nr);return{buildings:Ti,activeFloors:Qr}}(yn,Zn,ar.lastActiveFloors,ar.selectedFloorId);return En.send("setIndoorData",qr),qr}(re,this.indoor,De);it.activeFloors=jt?rn.activeFloors:void 0}const $t=[],Qt=ie.familiesBySource[this.source];for(const jt in Qt){const rn=re.layers[jt];if(!rn)continue;let yn=!1,rr=!1,En=!1;for(const Ar of Qt[jt])Ar[0].type==="symbol"?yn=!0:rr=!0,Ar[0].is3D()&&Ar[0].type!=="model"&&(En=!0);if(this.extraShadowCaster&&!En||this.isSymbolTile===!0&&!yn||this.isSymbolTile===!1&&!rr)continue;rn.version===1&&o.w(`Vector tile source "${this.source}" layer "${jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Zn=ot.encode(jt),ar=[];let qr=!1;for(let Ar=0,yr=0;Ar<rn.length;Ar++){const Jr=rn.feature(Ar),ni=Ye.getId(Jr,jt);if(this.localizableLayerIds&&this.localizableLayerIds.has(jt)){const Qr=Jr.properties?Jr.properties.worldview:null;if(this.worldview&&typeof Qr=="string")if(Qr==="all")Jr.properties.$localized=!0;else{if(!Qr.split(",").includes(this.worldview))continue;Jr.properties.$localized=!0,Jr.properties.worldview=this.worldview}}!qr&&Jr.properties&&Jr.properties.hasOwnProperty(o.fo)&&(qr=!0),ar.push({feature:Jr,id:ni,index:yr,sourceLayerIndex:Zn}),yr++}qr&&!it.elevationFeatures&&re.layers.hasOwnProperty(o.fp)&&(it.elevationFeatures=o.fq.parseFrom(re.layers[o.fp],this.canonical));for(const Ar of Qt[jt]){const yr=Ar[0];if(this.extraShadowCaster&&(!yr.is3D()||yr.type==="model")||this.isSymbolTile!==void 0&&yr.type==="symbol"!==this.isSymbolTile||yr.minzoom&&this.zoom<Math.floor(yr.minzoom)||yr.maxzoom&&this.zoom>=yr.maxzoom||yr.visibility==="none")continue;te(Ar,this.zoom,it.brightness,_e,this.worldview);const Jr=rt[yr.id]=yr.createBucket({index:Ye.bucketLayerIDs.length,layers:Ar,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Zn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Re,worldview:this.worldview});Ye.bucketLayerIDs.push(Ar.map(Qr=>o.B(Qr.id,Qr.scope)));let ni=Jr.prepare?Jr.prepare():null;ni!=null?(ni=ni.then(()=>Jr.populate(ar,it,this.tileID.canonical,this.tileTransform)),$t.push(ni)):Jr.populate(ar,it,this.tileID.canonical,this.tileTransform)}}const Ft=()=>{let jt,rn,yn,rr,En,Zn;zt.trim();const ar={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},qr=()=>{if(jt)return this.status="done",Ge(jt);if(this.extraShadowCaster)this.status="done",Ge(null,{buckets:Object.values(rt).filter(yr=>!yr.isEmpty()),featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:it.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(rn&&yn&&rr){const yr=new D(rn),Jr=new Map;for(const[li,Ui]of yn.entries()){const{imagePosition:oo}=o.ft(li,Ui,o.fu);Jr.set(li,oo)}const ni={};for(const li in rt){const Ui=rt[li];Ui instanceof o.b3&&(te(Ui.layers,this.zoom,it.brightness,_e,this.worldview),ni[li]=o.fv(Ui,rn,yr.positions,yn,Jr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,En,this.worldview))}const Qr={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(De,yn,En,()=>{Qr.iconsPending=!1,Ar(ni,yr,Qr)}),this.rasterizeIfNeeded(De,rr,Zn,()=>{Qr.patternsPending=!1,Ar(ni,yr,Qr)})}},Ar=(yr,Jr,ni,Qr)=>{if(ni.iconsPending||ni.patternsPending)return;const li=new o.fw(yn,rr,this.lut);for(const Ui in rt){const oo=rt[Ui];if(Ui in yr)o.fx(oo,yr[Ui],this.showCollisionBoxes,_e,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,yn,li);else if(oo.hasPattern&&(oo instanceof o.b9||oo instanceof o.ba||oo instanceof o.e9)){te(oo.layers,this.zoom,it.brightness,_e,this.worldview);const Ti=Object.fromEntries(li.patternPositions);oo.addFeatures(it,this.tileID.canonical,Ti,_e,this.tileTransform,this.brightness)}}this.status="done",Ge(null,{buckets:Object.values(rt).filter(Ui=>!Ui.isEmpty()),featureIndex:Ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jr.image,lineAtlas:zt,imageAtlas:li,brightness:it.brightness})};if(!this.extraShadowCaster){const yr=o.fr(it.glyphDependencies,Qr=>Object.keys(Qr).map(Number));Object.keys(yr).length?De.send("getGlyphs",{uid:this.uid,stacks:yr},(Qr,li)=>{jt||(jt=Qr,rn=li,qr())},void 0,!1,ar):rn={};const Jr=Array.from(it.iconDependencies.keys()).map(Qr=>o.I.parse(Qr));Jr.length?De.send("getImages",{images:Jr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Qr,li)=>{jt||(jt=Qr,yn=new Map,En=this.updateImageMapAndGetImageTaskQueue(yn,li,it.iconDependencies),qr())},void 0,!1,ar):(yn=new Map,En=new Map);const ni=Array.from(it.patternDependencies.keys()).map(Qr=>o.I.parse(Qr));ni.length?De.send("getImages",{images:ni,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Qr,li)=>{jt||(jt=Qr,rr=new Map,Zn=this.updateImageMapAndGetImageTaskQueue(rr,li,it.patternDependencies),qr())},void 0,!1,ar):(rr=new Map,Zn=new Map)}if(it.elevationFeatures&&it.elevationFeatures.length>0){const yr=[];for(const ni of Object.values(rt))if(ni instanceof o.ba){const Qr=ni.getUnevaluatedPortalGraph();Qr&&yr.push(Qr)}const Jr=o.fs.evaluate(yr);for(const ni of Object.values(rt))if(ni instanceof o.ba){const Qr=re.layers[ot.decode(ni.sourceLayerIndex)];ni.setEvaluatedPortalGraph(Jr,Qr,this.tileID.canonical,it.availableImages,it.brightness)}}qr()};$t.length>0?Promise.allSettled($t).then(Ft).catch(Ge):Ft()}updateParameters(re){this.scaleFactor=re.scaleFactor,this.showCollisionBoxes=re.showCollisionBoxes,this.projection=re.projection,this.brightness=re.brightness,this.tileTransform=o.aY(re.tileID.canonical,re.projection),this.extraShadowCaster=re.extraShadowCaster,this.lut=re.lut,this.worldview=re.worldview,this.indoor=re.indoor}rasterizeIfNeeded(re,ie,_e,Re){Array.from(ie.values()).some(De=>De.usvg)?this.rasterize(re,ie,_e,Re):Re()}updateImageMapAndGetImageTaskQueue(re,ie,_e){const Re=new Map;for(const De of ie.keys()){const Ge=_e.get(De)||[];for(const ot of Ge){const Ye=ot.toString(),rt=ie.get(ot.id.toString());rt.usvg?Re.has(Ye)||(Re.set(Ye,ot),re.set(Ye,Object.assign({},rt))):re.set(Ye,rt)}}return Re}rasterize(re,ie,_e,Re){this.rasterizeTask=re.send("rasterizeImages",{scope:this.scope,tasks:_e},(De,Ge)=>{if(!De)for(const[ot,Ye]of Ge.entries()){const rt=Object.assign(ie.get(ot),{data:Ye});ie.set(ot,rt)}Re()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function te(je,re,ie,_e,Re){const De=new o.ac(re,{brightness:ie,worldview:Re});for(const Ge of je)Ge.recalculate(De,_e)}class ne extends o.E{constructor(re,ie,_e,Re,De,Ge,ot){super(),this.actor=re,this.layerIndex=ie,this.availableImages=_e,this.availableModels=Re,this.loadVectorData=Ge||o.aL,this.loading={},this.loaded={},this.deduped=new o.aK(re.scheduler),this.isSpriteLoaded=De,this.scheduler=re.scheduler,this.brightness=ot}loadTile(re,ie){const _e=re.uid,Re=re&&re.request,De=Re&&Re.collectResourceTiming,Ge=this.loading[_e]=new Z(re);Ge.abort=this.loadVectorData(re,(ot,Ye)=>{const rt=!this.loading[_e];if(delete this.loading[_e],Ge.cancelRasterize(),rt||ot||!Ye)return Ge.status="done",rt||(this.loaded[_e]=Ge),ie(ot);const zt=Ye.rawData,it={},$t=o.aM(Ye.responseHeaders);$t&&$t.expires&&(it.expires=$t.expires),$t&&$t.cacheControl&&(it.cacheControl=$t.cacheControl),Ge.vectorTile=Ye.vectorTile||new o.fy(new o.bs(zt));const Qt=()=>{Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(Ft,jt)=>{if(Ft||!jt)return ie(Ft);const rn={};if(De){const yn=y(Re);yn.length>0&&(rn.resourceTiming=JSON.parse(JSON.stringify(yn)))}ie(null,Object.assign({rawTileData:zt.slice(0),responseHeaders:Ye.responseHeaders},jt,it,rn))})};this.isSpriteLoaded?Qt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Qt,{type:"parseTile",isSymbolTile:re.isSymbolTile,zoom:re.tileZoom}):Qt()}),this.loaded=this.loaded||{},this.loaded[_e]=Ge})}reloadTile(re,ie){const _e=this.loaded,Re=re.uid;if(_e&&_e[Re]){const De=_e[Re];De.updateParameters(re);const Ge=(ot,Ye)=>{const rt=De.reloadCallback;rt&&(delete De.reloadCallback,De.parse(De.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,rt)),ie(ot,Ye)};De.status==="parsing"?De.reloadCallback=Ge:De.status==="done"&&(De.vectorTile?De.parse(De.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ge):Ge())}else ie(null,void 0)}abortTile(re,ie){const _e=re.uid,Re=this.loading[_e];Re&&(Re.abort&&Re.abort(),delete this.loading[_e]),ie()}removeTile(re,ie){const _e=this.loaded,Re=re.uid;_e&&_e[Re]&&delete _e[Re],ie()}}class se{loadTile(re,ie){const{uid:_e,encoding:Re,rawImageData:De,padding:Ge}=re,ot=ImageBitmap&&De instanceof ImageBitmap?this.getImageData(De,Ge):De;ie(null,new o.fz(_e,ot,Re,Ge<1))}reloadTile(re,ie){ie(null,null)}abortTile(re,ie){ie()}removeTile(re,ie){ie()}getImageData(re,ie){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);const _e=this.offscreenCanvasContext.getImageData(-ie,-ie,re.width+2*ie,re.height+2*ie);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),_e}}o.br.setPbf(o.bs);class ee{constructor(re){this._mrt=new o.br(re.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=re.uid,this.tileID=re.tileID,this.source=re.source}parse(re,ie){const _e=this._mrt;this.status="parsing",this._entireBuffer=re;try{_e.parseHeader(re),this._isHeaderLoaded=!0;const Re=[];for(const De in _e.layers){const Ge=_e.getLayer(De),ot=Ge.getDataRange(Ge.getBandList()),Ye=_e.createDecodingTask(ot),rt=re.slice(ot.firstByte,ot.lastByte+1),zt=o.br.performDecoding(rt,Ye).then(it=>Ye.complete(null,it)).catch(it=>Ye.complete(it,null));Re.push(zt)}Promise.allSettled(Re).then(()=>ie(null,_e)).catch(De=>ie(De))}catch(Re){ie(Re)}}}class de{constructor(re){this.actor=re,this.loading={},this.loaded={}}loadTile(re,ie){const _e=re.uid,Re=re.request,De=this.loading[_e]=new ee(re),{cancel:Ge}=o.bt(Re,(ot,Ye,rt)=>{const zt=!this.loading[_e];if(delete this.loading[_e],zt||ot||!Ye)return De.status="done",zt||(this.loaded[_e]=De),ie(ot);De.parse(Ye,(it,$t)=>{if(it||!$t)return ie(it);ie(null,$t,rt)}),this.loaded[_e]=De});De.abort=Ge}reloadTile(re,ie){ie(null,void 0)}abortTile(re,ie){const _e=re.uid,Re=this.loading[_e];Re&&(Re.abort&&Re.abort(),delete this.loading[_e]),ie()}removeTile(re,ie){const _e=re.uid;this.loaded[_e]&&delete this.loaded[_e],ie()}decodeRasterArray(re,ie){o.br.performDecoding(re.buffer,re.task).then(_e=>ie(null,_e)).catch(_e=>ie(_e))}}const fe=o.fA.prototype.toGeoJSON;class ye{constructor(re){this._feature=re,this.extent=o.al,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))}loadGeometry(){if(this._feature.type===1){const re=[];for(const ie of this._feature.geometry)re.push([new o.P(ie[0],ie[1])]);return re}{const re=[];for(const ie of this._feature.geometry){const _e=[];for(const Re of ie)_e.push(new o.P(Re[0],Re[1]));re.push(_e)}return re}}toGeoJSON(re,ie,_e){return fe.call(this,re,ie,_e)}}class ge{constructor(re,ie){this.name=re,this.extent=o.al,this.length=ie.length,this._jsonFeatures=ie}feature(re){return new ye(this._jsonFeatures[re])}}class we{constructor(re){this.layers={},this.extent=o.al;for(const ie of Object.keys(re))this.layers[ie]=new ge(ie,re[ie])}}const Se=64/4096,xe=128;class Te{constructor(){this.features=new Map}clear(){this.features.clear()}load(re=[],ie){for(const _e of re){const Re=_e.id;if(Re==null)continue;let De=this.features.get(Re);De&&this.updateCache(De,ie),_e.geometry?(De=Ue(_e),this.updateCache(De,ie),this.features.set(Re,De)):this.features.delete(Re),this.updateCache(De,ie)}}updateCache(re,ie){for(const{canonical:_e,uid:Re}of Object.values(ie)){const{z:De,x:Ge,y:ot}=_e;ze(re,Math.pow(2,De),Ge,ot)&&delete ie[Re]}}getTile(re,ie,_e){const Re=Math.pow(2,re),De=[];for(const Ge of this.features.values())ze(Ge,Re,ie,_e)&&De.push(qe(Ge,Re,ie,_e));return{features:De}}getFeatures(){return[...this.features.values()]}}function ze({minX:je,minY:re,maxX:ie,maxY:_e},Re,De,Ge){return je<(De+1+Se)/Re&&re<(Ge+1+Se)/Re&&ie>(De-Se)/Re&&_e>(Ge-Se)/Re}function Ue(je){const{id:re,geometry:ie,properties:_e}=je;if(!ie)return;if(ie.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Re,coordinates:De}=ie,Ge={id:re,type:1,geometry:[],tags:_e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ot=Ge.geometry;if(Re==="Point")We(De,ot,Ge);else if(Re==="MultiPoint")for(const Ye of De)We(Ye,ot,Ge);else if(Re==="LineString")Ge.type=2,Be(De,ot,Ge);else if(Re==="MultiLineString")Ge.type=2,Xe(De,ot,Ge);else if(Re==="Polygon")Ge.type=3,Xe(De,ot,Ge,!0);else{if(Re!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Ge.type=3;for(const Ye of De)Xe(Ye,ot,Ge,!0)}return Ge}function We([je,re],ie,_e){const Re=o.aF(je);let De=o.aJ(re);De=De<0?0:De>1?1:De,ie.push(Re,De),_e.minX=Math.min(_e.minX,Re),_e.minY=Math.min(_e.minY,De),_e.maxX=Math.max(_e.maxX,Re),_e.maxY=Math.max(_e.maxY,De)}function Be(je,re,ie,_e=!1,Re=!1){const De=[];for(const Ge of je)We(Ge,De,ie);re.push(De),_e&&function(Ge,ot){let Ye=0;for(let rt=0,zt=Ge.length,it=zt-2;rt<zt;it=rt,rt+=2)Ye+=(Ge[rt]-Ge[it])*(Ge[rt+1]+Ge[it+1]);if(Ye>0===ot)for(let rt=0,zt=Ge.length;rt<zt/2;rt+=2){const it=Ge[rt],$t=Ge[rt+1];Ge[rt]=Ge[zt-2-rt],Ge[rt+1]=Ge[zt-1-rt],Ge[zt-2-rt]=it,Ge[zt-1-rt]=$t}}(De,Re)}function Xe(je,re,ie,_e=!1){for(let Re=0;Re<je.length;Re++)Be(je[Re],re,ie,_e,Re===0)}function qe(je,re,ie,_e){const{id:Re,type:De,geometry:Ge,tags:ot}=je,Ye=[];if(De===1)(function(rt,zt,it,$t,Qt){for(let Ft=0;Ft<rt.length;Ft+=2){const jt=Math.round(o.al*(rt[Ft+0]*zt-it)),rn=Math.round(o.al*(rt[Ft+1]*zt-$t));Qt.push([jt,rn])}})(Ge,re,ie,_e,Ye);else for(const rt of Ge)at(rt,re,ie,_e,Ye);return{id:Re,type:De,geometry:Ye,tags:ot}}function at(je,re,ie,_e,Re){const De=-xe,Ge=o.al+xe;let ot;for(let Ye=0;Ye<je.length-2;Ye+=2){let rt=Math.round(o.al*(je[Ye+0]*re-ie)),zt=Math.round(o.al*(je[Ye+1]*re-_e)),it=Math.round(o.al*(je[Ye+2]*re-ie)),$t=Math.round(o.al*(je[Ye+3]*re-_e));const Qt=it-rt,Ft=$t-zt;rt<De&&it<De||(rt<De?(zt+=Math.round(Ft*((De-rt)/Qt)),rt=De):it<De&&($t=zt+Math.round(Ft*((De-rt)/Qt)),it=De),zt<De&&$t<De||(zt<De?(rt+=Math.round(Qt*((De-zt)/Ft)),zt=De):$t<De&&(it=rt+Math.round(Qt*((De-zt)/Ft)),$t=De),rt>=Ge&&it>=Ge||(rt>=Ge?(zt+=Math.round(Ft*((Ge-rt)/Qt)),rt=Ge):it>=Ge&&($t=zt+Math.round(Ft*((Ge-rt)/Qt)),it=Ge),zt>=Ge&&$t>=Ge||(zt>=Ge?(rt+=Math.round(Qt*((Ge-zt)/Ft)),zt=Ge):$t>=Ge&&(it=rt+Math.round(Qt*((Ge-zt)/Ft)),$t=Ge),ot&&rt===ot[ot.length-1][0]&&zt===ot[ot.length-1][1]||(ot=[[rt,zt]],Re.push(ot)),ot.push([it,$t])))))}}function Ke({name:je,features:re},ie){ie.writeStringField(1,je),ie.writeVarintField(5,o.al);const _e=new Map,Re=new Map,De={keys:_e,values:Re,feature:null};for(const Ge of re)De.feature=Ge,ie.writeMessage(2,tt,De);for(const Ge of _e.keys())ie.writeStringField(3,Ge);for(const Ge of Re.keys())ie.writeMessage(4,Rt,Ge)}function tt(je,re){const ie=je.feature;ie.id!==void 0&&Number.isSafeInteger(+ie.id)&&re.writeVarintField(1,+ie.id),ie.tags&&re.writeMessage(2,vt,je),re.writeVarintField(3,ie.type),re.writeMessage(4,Nt,ie)}function vt({keys:je,values:re,feature:ie},_e){for(const Re of Object.keys(ie.tags)){let De=ie.tags[Re];if(De===null)continue;let Ge=je.get(Re);Ge===void 0&&(Ge=je.size,je.set(Re,Ge)),_e.writeVarint(Ge);const ot=typeof De;ot!=="string"&&ot!=="boolean"&&ot!=="number"&&(De=JSON.stringify(De));let Ye=re.get(De);Ye===void 0&&(Ye=re.size,re.set(De,Ye)),_e.writeVarint(Ye)}}function Pt(je,re){return(re<<3)+(7&je)}function ft(je){return je<<1^je>>31}function Nt(je,re){const{geometry:ie,type:_e}=je;let Re=0,De=0;if(_e===1){re.writeVarint(Pt(1,ie.length));for(const Ge of ie){const ot=Ge[0]-Re,Ye=Ge[1]-De;re.writeVarint(ft(ot)),re.writeVarint(ft(Ye)),Re+=ot,De+=Ye}}else for(const Ge of ie){re.writeVarint(Pt(1,1));const ot=Ge.length-(_e===3?1:0);for(let Ye=0;Ye<ot;Ye++){Ye===1&&re.writeVarint(Pt(2,ot-1));const rt=Ge[Ye][0]-Re,zt=Ge[Ye][1]-De;re.writeVarint(ft(rt)),re.writeVarint(ft(zt)),Re+=rt,De+=zt}_e===3&&re.writeVarint(Pt(7,1))}}function Rt(je,re){const ie=typeof je;ie==="string"?re.writeStringField(1,je):ie==="boolean"?re.writeBooleanField(7,je):ie==="number"&&(je%1!=0?re.writeDoubleField(3,je):je<0?re.writeSVarintField(6,je):re.writeVarintField(5,je))}const pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:je=>je},yt=Math.fround||(xt=new Float32Array(1),je=>(xt[0]=+je,xt[0]));var xt;const bt=3,Ct=5,tn=6;class Zt{constructor(re){this.options=Object.assign(Object.create(pt),re),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(re){const{log:ie,minZoom:_e,maxZoom:Re}=this.options;ie&&console.time("total time");const De=`prepare ${re.length} points`;ie&&console.time(De),this.points=re;const Ge=[];for(let Ye=0;Ye<re.length;Ye++){const rt=re[Ye];if(!rt.geometry)continue;const[zt,it]=rt.geometry.coordinates,$t=yt(Mt(zt)),Qt=yt(hn(it));Ge.push($t,Qt,1/0,Ye,-1,1),this.options.reduce&&Ge.push(0)}let ot=this.trees[Re+1]=this._createTree(Ge);ie&&console.timeEnd(De);for(let Ye=Re;Ye>=_e;Ye--){const rt=+Date.now();ot=this.trees[Ye]=this._createTree(this._cluster(ot,Ye)),ie&&console.log("z%d: %d clusters in %dms",Ye,ot.numItems,+Date.now()-rt)}return ie&&console.timeEnd("total time"),this}getClusters(re,ie){let _e=((re[0]+180)%360+360)%360-180;const Re=Math.max(-90,Math.min(90,re[1]));let De=re[2]===180?180:((re[2]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)_e=-180,De=180;else if(_e>De){const it=this.getClusters([_e,Re,180,Ge],ie),$t=this.getClusters([-180,Re,De,Ge],ie);return it.concat($t)}const ot=this.trees[this._limitZoom(ie)],Ye=ot.range(Mt(_e),hn(Ge),Mt(De),hn(Re)),rt=ot.data,zt=[];for(const it of Ye){const $t=this.stride*it;zt.push(rt[$t+Ct]>1?In(rt,$t,this.clusterProps):this.points[rt[$t+bt]])}return zt}getChildren(re){const ie=this._getOriginId(re),_e=this._getOriginZoom(re),Re="No cluster with the specified id.",De=this.trees[_e];if(!De)throw new Error(Re);const Ge=De.data;if(ie*this.stride>=Ge.length)throw new Error(Re);const ot=this.options.radius/(this.options.extent*Math.pow(2,_e-1)),Ye=De.within(Ge[ie*this.stride],Ge[ie*this.stride+1],ot),rt=[];for(const zt of Ye){const it=zt*this.stride;Ge[it+4]===re&&rt.push(Ge[it+Ct]>1?In(Ge,it,this.clusterProps):this.points[Ge[it+bt]])}if(rt.length===0)throw new Error(Re);return rt}getLeaves(re,ie,_e){const Re=[];return this._appendLeaves(Re,re,ie=ie||10,_e=_e||0,0),Re}getTile(re,ie,_e){const Re=this.trees[this._limitZoom(re)],De=Math.pow(2,re),{extent:Ge,radius:ot}=this.options,Ye=ot/Ge,rt=(_e-Ye)/De,zt=(_e+1+Ye)/De,it={features:[]};return this._addTileFeatures(Re.range((ie-Ye)/De,rt,(ie+1+Ye)/De,zt),Re.data,ie,_e,De,it),ie===0&&this._addTileFeatures(Re.range(1-Ye/De,rt,1,zt),Re.data,De,_e,De,it),ie===De-1&&this._addTileFeatures(Re.range(0,rt,Ye/De,zt),Re.data,-1,_e,De,it),it.features.length?it:null}getClusterExpansionZoom(re){let ie=this._getOriginZoom(re)-1;for(;ie<=this.options.maxZoom;){const _e=this.getChildren(re);if(ie++,_e.length!==1)break;re=_e[0].properties.cluster_id}return ie}_appendLeaves(re,ie,_e,Re,De){const Ge=this.getChildren(ie);for(const ot of Ge){const Ye=ot.properties;if(Ye&&Ye.cluster?De+Ye.point_count<=Re?De+=Ye.point_count:De=this._appendLeaves(re,Ye.cluster_id,_e,Re,De):De<Re?De++:re.push(ot),re.length===_e)break}return De}_createTree(re){const ie=new o.c3(re.length/this.stride|0,this.options.nodeSize,Float32Array);for(let _e=0;_e<re.length;_e+=this.stride)ie.add(re[_e],re[_e+1]);return ie.finish(),ie.data=re,ie}_addTileFeatures(re,ie,_e,Re,De,Ge){for(const ot of re){const Ye=ot*this.stride,rt=ie[Ye+Ct]>1;let zt,it,$t;if(rt)zt=Cn(ie,Ye,this.clusterProps),it=ie[Ye],$t=ie[Ye+1];else{const jt=this.points[ie[Ye+bt]];zt=jt.properties;const[rn,yn]=jt.geometry.coordinates;it=Mt(rn),$t=hn(yn)}const Qt={type:1,geometry:[[Math.round(this.options.extent*(it*De-_e)),Math.round(this.options.extent*($t*De-Re))]],tags:zt};let Ft;Ft=rt||this.options.generateId?ie[Ye+bt]:this.points[ie[Ye+bt]].id,Ft!==void 0&&(Qt.id=Ft),Ge.features.push(Qt)}}_limitZoom(re){return Math.max(this.options.minZoom,Math.min(Math.floor(+re),this.options.maxZoom+1))}_cluster(re,ie){const{radius:_e,extent:Re,reduce:De,minPoints:Ge}=this.options,ot=_e/(Re*Math.pow(2,ie)),Ye=re.data,rt=[],zt=this.stride;for(let it=0;it<Ye.length;it+=zt){if(Ye[it+2]<=ie)continue;Ye[it+2]=ie;const $t=Ye[it],Qt=Ye[it+1],Ft=re.within(Ye[it],Ye[it+1],ot),jt=Ye[it+Ct];let rn=jt;for(const yn of Ft){const rr=yn*zt;Ye[rr+2]>ie&&(rn+=Ye[rr+Ct])}if(rn>jt&&rn>=Ge){let yn,rr=$t*jt,En=Qt*jt,Zn=-1;const ar=(it/zt<<5)+(ie+1)+this.points.length;for(const qr of Ft){const Ar=qr*zt;if(Ye[Ar+2]<=ie)continue;Ye[Ar+2]=ie;const yr=Ye[Ar+Ct];rr+=Ye[Ar]*yr,En+=Ye[Ar+1]*yr,Ye[Ar+4]=ar,De&&(yn||(yn=this._map(Ye,it,!0),Zn=this.clusterProps.length,this.clusterProps.push(yn)),De(yn,this._map(Ye,Ar)))}Ye[it+4]=ar,rt.push(rr/rn,En/rn,1/0,ar,-1,rn),De&&rt.push(Zn)}else{for(let yn=0;yn<zt;yn++)rt.push(Ye[it+yn]);if(rn>1)for(const yn of Ft){const rr=yn*zt;if(!(Ye[rr+2]<=ie)){Ye[rr+2]=ie;for(let En=0;En<zt;En++)rt.push(Ye[rr+En])}}}}return rt}_getOriginId(re){return re-this.points.length>>5}_getOriginZoom(re){return(re-this.points.length)%32}_map(re,ie,_e){if(re[ie+Ct]>1){const Ge=this.clusterProps[re[ie+tn]];return _e?Object.assign({},Ge):Ge}const Re=this.points[re[ie+bt]].properties,De=this.options.map(Re);return _e&&De===Re?Object.assign({},De):De}}function In(je,re,ie){return{type:"Feature",id:je[re+bt],properties:Cn(je,re,ie),geometry:{type:"Point",coordinates:[(_e=je[re],360*(_e-.5)),Jt(je[re+1])]}};var _e}function Cn(je,re,ie){const _e=je[re+Ct],Re=_e>=1e4?`${Math.round(_e/1e3)}k`:_e>=1e3?Math.round(_e/100)/10+"k":_e,De=je[re+tn],Ge=De===-1?{}:Object.assign({},ie[De]);return Object.assign(Ge,{cluster:!0,cluster_id:je[re+bt],point_count:_e,point_count_abbreviated:Re})}function Mt(je){return je/360+.5}function hn(je){const re=Math.sin(je*Math.PI/180),ie=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return ie<0?0:ie>1?1:ie}function Jt(je){const re=(180-360*je)*Math.PI/180;return 360*Math.atan(Math.exp(re))/Math.PI-90}function Ut(je,re,ie,_e){let Re=_e;const De=re+(ie-re>>1);let Ge,ot=ie-re;const Ye=je[re],rt=je[re+1],zt=je[ie],it=je[ie+1];for(let $t=re+3;$t<ie;$t+=3){const Qt=Tn(je[$t],je[$t+1],Ye,rt,zt,it);if(Qt>Re)Ge=$t,Re=Qt;else if(Qt===Re){const Ft=Math.abs($t-De);Ft<ot&&(Ge=$t,ot=Ft)}}Re>_e&&(Ge-re>3&&Ut(je,re,Ge,_e),je[Ge+2]=Re,ie-Ge>3&&Ut(je,Ge,ie,_e))}function Tn(je,re,ie,_e,Re,De){let Ge=Re-ie,ot=De-_e;if(Ge!==0||ot!==0){const Ye=((je-ie)*Ge+(re-_e)*ot)/(Ge*Ge+ot*ot);Ye>1?(ie=Re,_e=De):Ye>0&&(ie+=Ge*Ye,_e+=ot*Ye)}return Ge=je-ie,ot=re-_e,Ge*Ge+ot*ot}function On(je,re,ie,_e){const Re={id:je??null,type:re,geometry:ie,tags:_e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(re==="Point"||re==="MultiPoint"||re==="LineString")Kn(Re,ie);else if(re==="Polygon")Kn(Re,ie[0]);else if(re==="MultiLineString")for(const De of ie)Kn(Re,De);else if(re==="MultiPolygon")for(const De of ie)Kn(Re,De[0]);return Re}function Kn(je,re){for(let ie=0;ie<re.length;ie+=3)je.minX=Math.min(je.minX,re[ie]),je.minY=Math.min(je.minY,re[ie+1]),je.maxX=Math.max(je.maxX,re[ie]),je.maxY=Math.max(je.maxY,re[ie+1])}function Un(je,re,ie,_e){if(!re.geometry)return;const Re=re.geometry.coordinates;if(Re&&Re.length===0)return;const De=re.geometry.type,Ge=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let ot=[],Ye=re.id;if(ie.promoteId?Ye=re.properties[ie.promoteId]:ie.generateId&&(Ye=_e||0),De==="Point")Pn(Re,ot);else if(De==="MultiPoint")for(const rt of Re)Pn(rt,ot);else if(De==="LineString")Qn(Re,ot,Ge,!1);else if(De==="MultiLineString"){if(ie.lineMetrics){for(const rt of Re)ot=[],Qn(rt,ot,Ge,!1),je.push(On(Ye,"LineString",ot,re.properties));return}un(Re,ot,Ge,!1)}else if(De==="Polygon")un(Re,ot,Ge,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const rt of re.geometry.geometries)Un(je,{id:Ye,geometry:rt,properties:re.properties},ie,_e);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const rt of Re){const zt=[];un(rt,zt,Ge,!0),ot.push(zt)}}je.push(On(Ye,De,ot,re.properties))}function Pn(je,re){re.push(nn(je[0]),$n(je[1]),0)}function Qn(je,re,ie,_e){let Re,De,Ge=0;for(let Ye=0;Ye<je.length;Ye++){const rt=nn(je[Ye][0]),zt=$n(je[Ye][1]);re.push(rt,zt,0),Ye>0&&(Ge+=_e?(Re*zt-rt*De)/2:Math.sqrt(Math.pow(rt-Re,2)+Math.pow(zt-De,2))),Re=rt,De=zt}const ot=re.length-3;re[2]=1,Ut(re,0,ot,ie),re[ot+2]=1,re.size=Math.abs(Ge),re.start=0,re.end=re.size}function un(je,re,ie,_e){for(let Re=0;Re<je.length;Re++){const De=[];Qn(je[Re],De,ie,_e),re.push(De)}}function nn(je){return je/360+.5}function $n(je){const re=Math.sin(je*Math.PI/180),ie=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return ie<0?0:ie>1?1:ie}function Ln(je,re,ie,_e,Re,De,Ge,ot){if(_e/=re,De>=(ie/=re)&&Ge<_e)return je;if(Ge<ie||De>=_e)return null;const Ye=[];for(const rt of je){const zt=rt.geometry;let it=rt.type;const $t=Re===0?rt.minX:rt.minY,Qt=Re===0?rt.maxX:rt.maxY;if($t>=ie&&Qt<_e){Ye.push(rt);continue}if(Qt<ie||$t>=_e)continue;let Ft=[];if(it==="Point"||it==="MultiPoint")qn(zt,Ft,ie,_e,Re);else if(it==="LineString")er(zt,Ft,ie,_e,Re,!1,ot.lineMetrics);else if(it==="MultiLineString")Jn(zt,Ft,ie,_e,Re,!1);else if(it==="Polygon")Jn(zt,Ft,ie,_e,Re,!0);else if(it==="MultiPolygon")for(const jt of zt){const rn=[];Jn(jt,rn,ie,_e,Re,!0),rn.length&&Ft.push(rn)}if(Ft.length){if(ot.lineMetrics&&it==="LineString"){for(const jt of Ft)Ye.push(On(rt.id,it,jt,rt.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Ft.length===1?(it="LineString",Ft=Ft[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Ft.length===3?"Point":"MultiPoint"),Ye.push(On(rt.id,it,Ft,rt.tags))}}return Ye.length?Ye:null}function qn(je,re,ie,_e,Re){for(let De=0;De<je.length;De+=3){const Ge=je[De+Re];Ge>=ie&&Ge<=_e&&Ir(re,je[De],je[De+1],je[De+2])}}function er(je,re,ie,_e,Re,De,Ge){let ot=tr(je);const Ye=Re===0?_r:$r;let rt,zt,it=je.start;for(let rn=0;rn<je.length-3;rn+=3){const yn=je[rn],rr=je[rn+1],En=je[rn+2],Zn=je[rn+3],ar=je[rn+4],qr=Re===0?yn:rr,Ar=Re===0?Zn:ar;let yr=!1;Ge&&(rt=Math.sqrt(Math.pow(yn-Zn,2)+Math.pow(rr-ar,2))),qr<ie?Ar>ie&&(zt=Ye(ot,yn,rr,Zn,ar,ie),Ge&&(ot.start=it+rt*zt)):qr>_e?Ar<_e&&(zt=Ye(ot,yn,rr,Zn,ar,_e),Ge&&(ot.start=it+rt*zt)):Ir(ot,yn,rr,En),Ar<ie&&qr>=ie&&(zt=Ye(ot,yn,rr,Zn,ar,ie),yr=!0),Ar>_e&&qr<=_e&&(zt=Ye(ot,yn,rr,Zn,ar,_e),yr=!0),!De&&yr&&(Ge&&(ot.end=it+rt*zt),re.push(ot),ot=tr(je)),Ge&&(it+=rt)}let $t=je.length-3;const Qt=je[$t],Ft=je[$t+1],jt=Re===0?Qt:Ft;jt>=ie&&jt<=_e&&Ir(ot,Qt,Ft,je[$t+2]),$t=ot.length-3,De&&$t>=3&&(ot[$t]!==ot[0]||ot[$t+1]!==ot[1])&&Ir(ot,ot[0],ot[1],ot[2]),ot.length&&re.push(ot)}function tr(je){const re=[];return re.size=je.size,re.start=je.start,re.end=je.end,re}function Jn(je,re,ie,_e,Re,De){for(const Ge of je)er(Ge,re,ie,_e,Re,De,!1)}function Ir(je,re,ie,_e){je.push(re,ie,_e)}function _r(je,re,ie,_e,Re,De){const Ge=(De-re)/(_e-re);return Ir(je,De,ie+(Re-ie)*Ge,1),Ge}function $r(je,re,ie,_e,Re,De){const Ge=(De-ie)/(Re-ie);return Ir(je,re+(_e-re)*Ge,De,1),Ge}function mr(je,re){const ie=[];for(let _e=0;_e<je.length;_e++){const Re=je[_e],De=Re.type;let Ge;if(De==="Point"||De==="MultiPoint"||De==="LineString")Ge=yi(Re.geometry,re);else if(De==="MultiLineString"||De==="Polygon"){Ge=[];for(const ot of Re.geometry)Ge.push(yi(ot,re))}else if(De==="MultiPolygon"){Ge=[];for(const ot of Re.geometry){const Ye=[];for(const rt of ot)Ye.push(yi(rt,re));Ge.push(Ye)}}ie.push(On(Re.id,De,Ge,Re.tags))}return ie}function yi(je,re){const ie=[];ie.size=je.size,je.start!==void 0&&(ie.start=je.start,ie.end=je.end);for(let _e=0;_e<je.length;_e+=3)ie.push(je[_e]+re,je[_e+1],je[_e+2]);return ie}function Vr(je,re){if(je.transformed)return je;const ie=1<<je.z,_e=je.x,Re=je.y;for(const De of je.features){const Ge=De.geometry,ot=De.type;if(De.geometry=[],ot===1)for(let Ye=0;Ye<Ge.length;Ye+=2)De.geometry.push(Kr(Ge[Ye],Ge[Ye+1],re,ie,_e,Re));else for(let Ye=0;Ye<Ge.length;Ye++){const rt=[];for(let zt=0;zt<Ge[Ye].length;zt+=2)rt.push(Kr(Ge[Ye][zt],Ge[Ye][zt+1],re,ie,_e,Re));De.geometry.push(rt)}}return je.transformed=!0,je}function Kr(je,re,ie,_e,Re,De){return[Math.round(ie*(je*_e-Re)),Math.round(ie*(re*_e-De))]}function Rr(je,re,ie,_e,Re){const De=re===Re.maxZoom?0:Re.tolerance/((1<<re)*Re.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:je.length,source:null,x:ie,y:_e,z:re,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ot of je)ii(Ge,ot,De,Re);return Ge}function ii(je,re,ie,_e){const Re=re.geometry,De=re.type,Ge=[];if(je.minX=Math.min(je.minX,re.minX),je.minY=Math.min(je.minY,re.minY),je.maxX=Math.max(je.maxX,re.maxX),je.maxY=Math.max(je.maxY,re.maxY),De==="Point"||De==="MultiPoint")for(let ot=0;ot<Re.length;ot+=3)Ge.push(Re[ot],Re[ot+1]),je.numPoints++,je.numSimplified++;else if(De==="LineString")Hr(Ge,Re,je,ie,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let ot=0;ot<Re.length;ot++)Hr(Ge,Re[ot],je,ie,De==="Polygon",ot===0);else if(De==="MultiPolygon")for(let ot=0;ot<Re.length;ot++){const Ye=Re[ot];for(let rt=0;rt<Ye.length;rt++)Hr(Ge,Ye[rt],je,ie,!0,rt===0)}if(Ge.length){let ot=re.tags||null;if(De==="LineString"&&_e.lineMetrics){ot={};for(const rt in re.tags)ot[rt]=re.tags[rt];ot.mapbox_clip_start=Re.start/Re.size,ot.mapbox_clip_end=Re.end/Re.size}const Ye={geometry:Ge,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:ot};re.id!==null&&(Ye.id=re.id),je.features.push(Ye)}}function Hr(je,re,ie,_e,Re,De){const Ge=_e*_e;if(_e>0&&re.size<(Re?Ge:_e))return void(ie.numPoints+=re.length/3);const ot=[];for(let Ye=0;Ye<re.length;Ye+=3)(_e===0||re[Ye+2]>Ge)&&(ie.numSimplified++,ot.push(re[Ye],re[Ye+1])),ie.numPoints++;Re&&function(Ye,rt){let zt=0;for(let it=0,$t=Ye.length,Qt=$t-2;it<$t;Qt=it,it+=2)zt+=(Ye[it]-Ye[Qt])*(Ye[it+1]+Ye[Qt+1]);if(zt>0===rt)for(let it=0,$t=Ye.length;it<$t/2;it+=2){const Qt=Ye[it],Ft=Ye[it+1];Ye[it]=Ye[$t-2-it],Ye[it+1]=Ye[$t-1-it],Ye[$t-2-it]=Qt,Ye[$t-1-it]=Ft}}(ot,De),je.push(ot)}const ut={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ur{constructor(re,ie){const _e=(ie=this.options=function(De,Ge){for(const ot in Ge)De[ot]=Ge[ot];return De}(Object.create(ut),ie)).debug;if(_e&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let Re=function(De,Ge){const ot=[];if(De.type==="FeatureCollection")for(let Ye=0;Ye<De.features.length;Ye++)Un(ot,De.features[Ye],Ge,Ye);else Un(ot,De.type==="Feature"?De:{geometry:De},Ge);return ot}(re,ie);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Re=function(De,Ge){const ot=Ge.buffer/Ge.extent;let Ye=De;const rt=Ln(De,1,-1-ot,ot,0,-1,2,Ge),zt=Ln(De,1,1-ot,2+ot,0,-1,2,Ge);return(rt||zt)&&(Ye=Ln(De,1,-ot,1+ot,0,-1,2,Ge)||[],rt&&(Ye=mr(rt,1).concat(Ye)),zt&&(Ye=Ye.concat(mr(zt,-1)))),Ye}(Re,ie),Re.length&&this.splitTile(Re,0,0,0),_e&&(Re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(re,ie,_e,Re,De,Ge,ot){const Ye=[re,ie,_e,Re],rt=this.options,zt=rt.debug;for(;Ye.length;){Re=Ye.pop(),_e=Ye.pop(),ie=Ye.pop(),re=Ye.pop();const it=1<<ie,$t=fr(ie,_e,Re);let Qt=this.tiles[$t];if(!Qt&&(zt>1&&console.time("creation"),Qt=this.tiles[$t]=Rr(re,ie,_e,Re,rt),this.tileCoords.push({z:ie,x:_e,y:Re}),zt)){zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,_e,Re,Qt.numFeatures,Qt.numPoints,Qt.numSimplified),console.timeEnd("creation"));const yr=`z${ie}`;this.stats[yr]=(this.stats[yr]||0)+1,this.total++}if(Qt.source=re,De==null){if(ie===rt.indexMaxZoom||Qt.numPoints<=rt.indexMaxPoints)continue}else{if(ie===rt.maxZoom||ie===De)continue;if(De!=null){const yr=De-ie;if(_e!==Ge>>yr||Re!==ot>>yr)continue}}if(Qt.source=null,re.length===0)continue;zt>1&&console.time("clipping");const Ft=.5*rt.buffer/rt.extent,jt=.5-Ft,rn=.5+Ft,yn=1+Ft;let rr=null,En=null,Zn=null,ar=null,qr=Ln(re,it,_e-Ft,_e+rn,0,Qt.minX,Qt.maxX,rt),Ar=Ln(re,it,_e+jt,_e+yn,0,Qt.minX,Qt.maxX,rt);re=null,qr&&(rr=Ln(qr,it,Re-Ft,Re+rn,1,Qt.minY,Qt.maxY,rt),En=Ln(qr,it,Re+jt,Re+yn,1,Qt.minY,Qt.maxY,rt),qr=null),Ar&&(Zn=Ln(Ar,it,Re-Ft,Re+rn,1,Qt.minY,Qt.maxY,rt),ar=Ln(Ar,it,Re+jt,Re+yn,1,Qt.minY,Qt.maxY,rt),Ar=null),zt>1&&console.timeEnd("clipping"),Ye.push(rr||[],ie+1,2*_e,2*Re),Ye.push(En||[],ie+1,2*_e,2*Re+1),Ye.push(Zn||[],ie+1,2*_e+1,2*Re),Ye.push(ar||[],ie+1,2*_e+1,2*Re+1)}}getTile(re,ie,_e){re=+re,ie=+ie,_e=+_e;const Re=this.options,{extent:De,debug:Ge}=Re;if(re<0||re>24)return null;const ot=1<<re,Ye=fr(re,ie=ie+ot&ot-1,_e);if(this.tiles[Ye])return Vr(this.tiles[Ye],De);Ge>1&&console.log("drilling down to z%d-%d-%d",re,ie,_e);let rt,zt=re,it=ie,$t=_e;for(;!rt&&zt>0;)zt--,it>>=1,$t>>=1,rt=this.tiles[fr(zt,it,$t)];return rt&&rt.source?(Ge>1&&(console.log("found parent tile z%d-%d-%d",zt,it,$t),console.time("drilling down")),this.splitTile(rt.source,zt,it,$t,re,ie,_e),Ge>1&&console.timeEnd("drilling down"),this.tiles[Ye]?Vr(this.tiles[Ye],De):null):null}}function fr(je,re,ie){return 32*((1<<je)*ie+re)+je}function Fn(je,re){const ie=je.tileID.canonical;if(!this._geoJSONIndex)return void re(null,null);const _e=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!_e)return void re(null,null);const Re=rt=>rt.tags&&"3d_elevation_id"in rt.tags&&"source"in rt.tags&&rt.tags.source==="elevation",De=_e.features.filter(rt=>Re(rt));let Ge={_geojsonTileLayer:_e.features};De.length>0&&(Ge={_geojsonTileLayer:_e.features.filter(rt=>!Re(rt)),hd_road_elevation:De});const ot=new we(Ge),Ye=function(rt){const zt=new o.bs;for(const it of Object.keys(rt))zt.writeMessage(3,Ke,{name:it,features:rt[it]});return zt.finish()}(Ge).buffer;re(null,{vectorTile:ot,rawData:Ye})}class Gt extends ne{constructor(re,ie,_e,Re,De,Ge,ot){super(re,ie,_e,Re,De,Fn,ot),Ge&&(this.loadGeoJSON=Ge),this._dynamicIndex=new Te}loadData(re,ie){const _e=re&&re.request,Re=_e&&_e.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(re,(De,Ge)=>{if(De||!Ge)return ie(De);if(typeof Ge!="object")return ie(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`));{try{if(re.filter){const Ye=o.U(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));Ge.features=Ge.features.filter(rt=>Ye.value.evaluate({zoom:0},rt))}re.dynamic?(Ge.type==="Feature"&&(Ge={type:"FeatureCollection",features:[Ge]}),re.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Ge.features,this.loaded),re.cluster&&(Ge.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=re.cluster?new Zt(function({superclusterOptions:Ye,clusterProperties:rt}){if(!rt||!Ye)return Ye;const zt={},it={},$t={accumulated:null,zoom:0},Qt={properties:null},Ft=Object.keys(rt);for(const jt of Ft){const[rn,yn]=rt[jt],rr=o.U(yn),En=o.U(typeof rn=="string"?[rn,["accumulated"],["get",jt]]:rn);zt[jt]=rr.value,it[jt]=En.value}return Ye.map=jt=>{Qt.properties=jt;const rn={};for(const yn of Ft)rn[yn]=zt[yn].evaluate($t,Qt);return rn},Ye.reduce=(jt,rn)=>{Qt.properties=rn;for(const yn of Ft)$t.accumulated=jt[yn],jt[yn]=it[yn].evaluate($t,Qt)},Ye}(re)).load(Ge.features):re.dynamic?this._dynamicIndex:function(Ye,rt){return new ur(Ye,rt)}(Ge,re.geojsonVtOptions)}catch(Ye){return ie(Ye)}const ot={};if(Re){const Ye=y(_e);Ye&&(ot.resourceTiming={},ot.resourceTiming[re.source]=JSON.parse(JSON.stringify(Ye)))}ie(null,ot)}})}reloadTile(re,ie){const _e=this.loaded;return _e&&_e[re.uid]?re.partial?ie(null,void 0):super.reloadTile(re,ie):this.loadTile(re,ie)}loadGeoJSON(re,ie){if(re.request)o.m(re.request,ie);else{if(typeof re.data!="string")return ie(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return ie(null,JSON.parse(re.data))}catch{return ie(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(re,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom(re.clusterId))}catch(_e){ie(_e)}}getClusterChildren(re,ie){try{ie(null,this._geoJSONIndex.getChildren(re.clusterId))}catch(_e){ie(_e)}}getClusterLeaves(re,ie){try{ie(null,this._geoJSONIndex.getLeaves(re.clusterId,re.limit,re.offset))}catch(_e){ie(_e)}}}class mn{constructor(re,ie,_e){this.tileID=new o.aP(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.tileZoom=re.tileZoom,this.uid=re.uid,this.zoom=re.zoom,this.canonical=re.tileID.canonical,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=re.projection,this.brightness=ie,this.worldview=_e}parse(re,ie,_e,Re){this.status="parsing";const De=new o.aP(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),Ge=[],ot=ie.familiesBySource[_e.source],Ye=new o.fm(De,_e.promoteId);Ye.bucketLayerIDs=[],Ye.is3DTile=!0,o.fB(re).then(rt=>{if(!rt)return Re(new Error("Could not parse tile"));const zt=rt.json.extensionsUsed&&rt.json.extensionsUsed.includes("MAPBOX_mesh_features")||rt.json.asset.extras&&rt.json.asset.extras.MAPBOX_mesh_features,it=rt.json.extensionsUsed&&rt.json.extensionsUsed.includes("EXT_meshopt_compression"),$t=new o.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const Qt in ot)for(const Ft of ot[Qt]){const jt=Ft[0];Ye.bucketLayerIDs.push(Ft.map(rr=>o.B(rr.id,rr.scope))),jt.recalculate($t,[]);const rn=o.fC(rt,1/o.d6(_e.tileID.canonical)),yn=new o.fD(Ft,rn,De,zt,it,this.brightness,Ye,this.worldview);zt||(yn.needsUpload=!0),Ge.push(yn),yn.evaluate(jt)}this.status="done",Re(null,{buckets:Ge,featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(rt=>Re(new Error(rt.message)))}}class Xn{constructor(re,ie,_e,Re,De,Ge,ot,Ye){this.actor=re,this.layerIndex=ie,this.availableImages=_e,this.availableModels=Re,this.brightness=ot,this.loading={},this.loaded={},this.worldview=Ye}loadTile(re,ie){const _e=re.uid,Re=this.loading[_e]=new mn(re,this.brightness,this.worldview);o.bt(re.request,(De,Ge)=>{const ot=!this.loading[_e];return delete this.loading[_e],ot||De?(Re.status="done",ot||(this.loaded[_e]=Re),ie(De)):Ge&&Ge.byteLength!==0?void Re.parse(Ge,this.layerIndex,re,(Ye,rt)=>{Re.status="done",this.loaded=this.loaded||{},this.loaded[_e]=Re,Ye||!rt?ie(Ye):ie(null,rt)}):(Re.status="done",this.loaded[_e]=Re,ie())})}reloadTile(re,ie){const _e=this.loaded,Re=re.uid;if(_e&&_e[Re]){const De=_e[Re];De.projection=re.projection,De.brightness=re.brightness;const Ge=(ot,Ye)=>{De.reloadCallback&&(delete De.reloadCallback,this.loadTile(re,ie)),ie(ot,Ye)};De.status==="parsing"?De.reloadCallback=Ge:De.status==="done"&&this.loadTile(re,ie)}}abortTile(re,ie){const _e=re.uid;this.loading[_e]&&delete this.loading[_e],ie()}removeTile(re,ie){const _e=this.loaded,Re=re.uid;_e&&_e[Re]&&delete _e[Re],ie()}}class gr{constructor(re){this.self=re,this.actor=new o.fF(re,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new o.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=o.cl({name:"mercator"}),this.workerSourceTypes={vector:ne,geojson:Gt,"raster-dem":se,"raster-array":de,"batched-model":Xn},this.workerSources={},this.self.registerWorkerSource=(ie,_e)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=_e},this.self.registerRTLTextPlugin=ie=>{if(o.fG.isParsed())throw new Error("RTL text plugin already registered.");o.fG.setState({pluginStatus:o.fH.parsed,pluginURL:o.fG.getPluginURL()}),o.fG.applyArabicShaping=ie.applyArabicShaping,o.fG.processBidirectionalText=ie.processBidirectionalText,o.fG.processStyledBidirectionalText=ie.processStyledBidirectionalText;for(const _e of this.rtlPluginParsingListeners)_e(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(re,ie,_e){delete this.layerIndexes[re],delete this.availableImages[re],delete this.availableModels[re],delete this.workerSources[re],_e()}checkIfReady(re,ie,_e){_e()}setReferrer(re,ie){this.referrer=ie}spriteLoaded(re,ie){this.isSpriteLoaded[re]||(this.isSpriteLoaded[re]={});const{scope:_e,isLoaded:Re}=ie;if(this.isSpriteLoaded[re][_e]=Re,this.workerSources[re]&&this.workerSources[re][_e])for(const De in this.workerSources[re][_e]){const Ge=this.workerSources[re][_e][De];for(const ot in Ge){const Ye=Ge[ot];Ye instanceof ne&&(Ye.isSpriteLoaded=Re,Ye.fire(new o.z("isSpriteLoaded")))}}}setImages(re,ie,_e){this.availableImages[re]||(this.availableImages[re]={});const{scope:Re,images:De}=ie;if(this.availableImages[re][Re]=De,this.workerSources[re]&&this.workerSources[re][Re]){for(const Ge in this.workerSources[re][Re]){const ot=this.workerSources[re][Re][Ge];for(const Ye in ot)ot[Ye].availableImages=De}_e()}else _e()}setModels(re,{scope:ie,models:_e},Re){if(this.availableModels[re]||(this.availableModels[re]={}),this.availableModels[re][ie]=_e,this.workerSources[re]&&this.workerSources[re][ie]){for(const De in this.workerSources[re][ie]){const Ge=this.workerSources[re][ie][De];for(const ot in Ge)Ge[ot].availableModels=_e}Re()}else Re()}setProjection(re,ie){this.projections[re]=o.cl(ie)}setBrightness(re,ie,_e){this.brightness=ie,_e()}setWorldview(re,ie,_e){this.worldview=ie,_e()}setLayers(re,ie,_e){this.getLayerIndex(re,ie.scope).replace(ie.layers,ie.options),_e()}updateLayers(re,ie,_e){this.getLayerIndex(re,ie.scope).update(ie.layers,ie.removedIds,ie.options),_e()}loadTile(re,ie,_e){ie.projection=this.projections[re]||this.defaultProjection,this.getWorkerSource(re,ie.type,ie.source,ie.scope).loadTile(ie,_e)}decodeRasterArray(re,ie,_e){this.getWorkerSource(re,ie.type,ie.source,ie.scope).decodeRasterArray(ie,_e)}reloadTile(re,ie,_e){ie.projection=this.projections[re]||this.defaultProjection,this.getWorkerSource(re,ie.type,ie.source,ie.scope).reloadTile(ie,_e)}abortTile(re,ie,_e){this.getWorkerSource(re,ie.type,ie.source,ie.scope).abortTile(ie,_e)}removeTile(re,ie,_e){this.getWorkerSource(re,ie.type,ie.source,ie.scope).removeTile(ie,_e)}removeSource(re,ie,_e){if(!(this.workerSources[re]&&this.workerSources[re][ie.scope]&&this.workerSources[re][ie.scope][ie.type]&&this.workerSources[re][ie.scope][ie.type][ie.source]))return;const Re=this.workerSources[re][ie.scope][ie.type][ie.source];delete this.workerSources[re][ie.scope][ie.type][ie.source],Re.removeSource!==void 0?Re.removeSource(ie,_e):_e()}loadWorkerSource(re,ie,_e){try{this.self.importScripts(ie.url),_e()}catch(Re){_e(Re.toString())}}syncRTLPluginState(re,ie,_e){if(o.fG.isParsed())_e(null,!0);else if(o.fG.isParsing())this.rtlPluginParsingListeners.push(_e);else try{o.fG.setState(ie);const Re=o.fG.getPluginURL();!o.fG.isLoaded()||o.fG.isParsed()||o.fG.isParsing()||Re==null||(o.fG.setState({pluginStatus:o.fH.parsing,pluginURL:o.fG.getPluginURL()}),this.self.importScripts(Re),o.fG.isParsed()?_e(null,!0):this.rtlPluginParsingListeners.push(_e))}catch(Re){_e(Re.toString())}}setDracoUrl(re,ie){this.dracoUrl=ie}getAvailableImages(re,ie){this.availableImages[re]||(this.availableImages[re]={});let _e=this.availableImages[re][ie];return _e||(_e=[]),_e}getAvailableModels(re,ie){this.availableModels[re]||(this.availableModels[re]={});let _e=this.availableModels[re][ie];return _e||(_e={}),_e}getLayerIndex(re,ie){this.layerIndexes[re]||(this.layerIndexes[re]={});let _e=this.layerIndexes[re][ie];return _e||(_e=this.layerIndexes[re][ie]=new P,_e.scope=ie),_e}getWorkerSource(re,ie,_e,Re){const De=this.workerSources;return De[re]||(De[re]={}),De[re][Re]||(De[re][Re]={}),De[re][Re][ie]||(De[re][Re][ie]={}),this.isSpriteLoaded[re]||(this.isSpriteLoaded[re]={}),De[re][Re][ie][_e]||(De[re][Re][ie][_e]=new this.workerSourceTypes[ie]({send:(Ge,ot,Ye,rt,zt,it)=>this.actor.send(Ge,ot,Ye,re,zt,it),scheduler:this.actor.scheduler},this.getLayerIndex(re,Re),this.getAvailableImages(re,Re),this.getAvailableModels(re,Re),this.isSpriteLoaded[re][Re],void 0,this.brightness,this.worldview)),De[re][Re][ie][_e]}rasterizeImagesWorker(re,ie,_e){const Re=new Map;for(const[De,{image:Ge,imageVariant:ot}]of ie.tasks.entries()){const Ye=this.imageRasterizer.rasterize(ot,Ge,ie.scope,re);Re.set(De,Ye)}_e(void 0,Re)}removeRasterizedImages(re,ie,_e){this.imageRasterizer.removeImagesFromCacheByIds(ie.imageIds,ie.scope,re),_e()}enforceCacheSizeLimit(re,ie){o.fI(ie)}getWorkerPerformanceMetrics(re,ie,_e){_e(void 0,void 0)}}return o.fE(self)&&(self.worker=new gr(self)),gr}),d(["./shared"],function(o){var y="3.16.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},C={mark(m){performance.mark(m)},measure(m,a,u){performance.measure(m,a,u)}};function P(m){const a=m.name.split("?")[0];return o.a(a)&&a.includes("mapbox-gl.js")?"javascript":o.a(a)&&a.includes("mapbox-gl.css")?"css":o.b(a)?"fontRange":o.c(a)?"sprite":o.i(a)?"style":o.d(a)?"tilejson":"other"}var A,D={},k=function(){if(A)return D;function m(g){return!a(g)}function a(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,R=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(R);try{E=new Worker(O),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(O),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var R=E.getImageData(0,0,1,1);return R&&R.width===S.width}()?(u[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[x]=function(S){var E,R=function(O){var $=document.createElement("canvas"),U=Object.create(m.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=O,$.getContext("webgl2",U)}(S);if(!R)return!1;try{E=R.createShader(R.VERTEX_SHADER)}catch{return!1}return!(!E||R.isContextLost())&&(R.shaderSource(E,"void main() {}"),R.compileShader(E),R.getShaderParameter(E,R.COMPILE_STATUS)===!0)}(x)),u[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}A=1,D.supported=m,D.notSupportedReason=a;var u={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},D}();function B(m,a,u){const g=document.createElement(m);return a!=null&&(g.className=a),u&&u.appendChild(g),g}function N(m,a,u){const g=document.createElementNS("http://www.w3.org/2000/svg",m);for(const x of Object.keys(a))g.setAttributeNS(null,x,String(a[x]));return u&&u.appendChild(g),g}const j=typeof document<"u"?document.documentElement&&document.documentElement.style:null,V=j&&j.userSelect!==void 0?"userSelect":"WebkitUserSelect";let K;function Y(){j&&V&&(K=j[V],j[V]="none")}function Z(){j&&V&&(j[V]=K)}function te(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",te,!0)}function ne(){window.addEventListener("click",te,!0),window.setTimeout(()=>{window.removeEventListener("click",te,!0)},0)}function se(m,a){const u=m.getBoundingClientRect();return fe(m,u,a)}function ee(m,a){const u=m.getBoundingClientRect(),g=[];for(let x=0;x<a.length;x++)g.push(fe(m,u,a[x]));return g}function de(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function fe(m,a,u){const g=m.offsetWidth===a.width?1:m.offsetWidth/a.width;return new o.P((u.clientX-a.left)*g,(u.clientY-a.top)*g)}const ye="01",ge="NO_ACCESS_TOKEN";class we{constructor(a,u,g){this._transformRequestFn=a,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const a=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ye,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,u){return this._transformRequestFn&&this._transformRequestFn(a,u)||{url:a}}normalizeStyleURL(a,u){if(!o.h(a))return a;const g=xe(a);return g.params.push(`sdk=js-${y}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(a,u){if(!o.h(a))return a;const g=xe(a);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(a,u){if(!o.h(a))return a;const g=xe(a);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(a,u,g,x){if(!o.h(a))return a;const S=xe(a);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),g&&S.params.push(`language=${g}`),x&&S.params.push(`worldview=${x}`),this._makeAPIURL(S,this._customAccessToken||u)}normalizeIconsetURL(a,u){const g=xe(a);return o.h(a)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):Te(g)}normalizeSpriteURL(a,u,g,x){const S=xe(a);return o.h(a)?(S.path=`/styles/v1${S.path}/sprite${u}${g}`,this._makeAPIURL(S,this._customAccessToken||x)):(S.path+=`${u}${g}`,Te(S))}normalizeTileURL(a,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!o.h(a))return a;const x=xe(a);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&x.authority!=="raster"&&g===512?"@2x":""}${o.k.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${o.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${o.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${o.e.TILE_URL_VERSION}${x.path}`);const S=this._customAccessToken||function(E){for(const R of E){const O=R.match(/^access_token=(.*)$/);if(O)return O[1]}return null}(x.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,S)}canonicalizeTileURL(a,u){const g=xe(a);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return a;let x="mapbox://";g.path.match(/^\/raster\/v1\//)?x+=`raster/${g.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${g.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${g.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let S=g.params;return u&&(S=S.filter(E=>!E.match(/^access_token=/))),S.length&&(x+=`?${S.join("&")}`),x}canonicalizeTileset(a,u){const g=!!u&&o.h(u),x=[];for(const S of a.tiles||[])o.j(S)?x.push(this.canonicalizeTileURL(S,g)):x.push(S);return x}_makeAPIURL(a,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=xe(o.e.API_URL);if(a.protocol=x.protocol,a.authority=x.authority,a.protocol==="http"){const S=a.params.indexOf("secure");S>=0&&a.params.splice(S,1)}if(x.path!=="/"&&(a.path=`${x.path}${a.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Te(a);if(u=u||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return a.params=a.params.filter(S=>S.indexOf("access_token")===-1),a.params.push(`access_token=${u||""}`),Te(a)}}const Se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(m){const a=m.match(Se);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Te(m){const a=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${a}`}const ze="mapbox.eventData";function Ue(m){if(!m)return null;const a=m.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(o.l(a[1]))}catch{return null}}class We{constructor(a){this.type=a,this.anonId=null,this.anonIdTimestamp=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=Ue(o.e.ACCESS_TOKEN);let g="";return g=u&&u.u?o.f(u.u):o.e.ACCESS_TOKEN||"",a?`${ze}.${a}:${g}`:`${ze}:${g}`}fetchEventData(){const a=o.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.getStorageKey("uuidTimestamp");if(a)try{const S=localStorage.getItem(u);S&&(this.eventData=JSON.parse(S));const E=localStorage.getItem(g);E&&(this.anonId=E);const R=localStorage.getItem(x);R&&(this.anonIdTimestamp=Number(R));const O=Date.now()-864e5;(!this.anonIdTimestamp||this.anonIdTimestamp<O)&&this.refreshUUID()}catch{o.w("Unable to read from LocalStorage")}}refreshUUID(){this.anonId=o.u(),this.anonIdTimestamp=Date.now()}saveEventData(){const a=o.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.getStorageKey("uuidTimestamp"),S=this.anonId,E=this.anonIdTimestamp;if(a&&S)try{localStorage.setItem(g,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData)),E&&localStorage.setItem(x,E.toString())}catch{o.w("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,g,x){if(!o.e.EVENTS_URL)return;const S=xe(o.e.EVENTS_URL);S.params.push(`access_token=${x||o.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(a).toISOString()},R=u?Object.assign(E,u):E,O={url:Te(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};this.pendingRequest=o.p(O,$=>{this.pendingRequest=null,g($),this.saveEventData(),this.processRequests(x)})}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const Be=new class extends We{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,a){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(u=>o.h(u)||o.j(u))&&this.queueRequest(Date.now(),a)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.anonIdTimestamp&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=Ue(o.e.ACCESS_TOKEN),u=a?a.u:o.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;o.v(this.anonId)||(this.refreshUUID(),g=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),E=new Date(x),R=(x-this.eventData.lastSuccess)/864e5;g=g||R>=1||R<-1||S.getDate()!==E.getDate()}else g=!0;g?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ye,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=x,this.eventData.tokenU=u)},m):this.processRequests()}},Xe=Be.postTurnstileEvent.bind(Be),qe=new class extends We{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,a,u,g){this.skuToken=a,this.errorCb=g,o.e.EVENTS_URL&&(u||o.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},u):this.errorCb(new Error(ge)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId&&this.anonIdTimestamp||this.fetchEventData(),o.v(this.anonId)||this.refreshUUID(),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ye,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):a&&(this.success[a]=!0)},m))}remove(){this.errorCb=null}},at=qe.postMapLoadEvent.bind(qe),Ke=new class extends We{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let a=this.mapInstanceIdMap.get(m);return a||(a=o.u(),this.mapInstanceIdMap.set(m,a)),a}getEventId(m){const a=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,a+1),a}postStyleLoadEvent(m,a){const{map:u,style:g,importedStyles:x}=a;if(!o.e.EVENTS_URL||!m&&!o.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(u),E={mapInstanceId:S,eventId:this.getEventId(S),style:g};x.length&&(E.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:E},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,payload:u}=this.queue.shift();this.postEvent(a,u,()=>{},m)}},tt=Ke.postStyleLoadEvent.bind(Ke),vt=new class extends We{constructor(m){super("metrics"),m&&(this.data=m)}postMetricsEvent(m){if(!o.e.EVENTS_URL||!m&&!o.e.ACCESS_TOKEN)return;this.anonId||this.fetchEventData(),o.v(this.anonId)||this.refreshUUID();const a=Object.assign({},this.data,{sessionId:this.anonId});this.queueRequest({timestamp:Date.now(),payload:a},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,payload:u}=this.queue.shift();this.postEvent(a,u,()=>{},m)}}({attributes:[{name:"maps/js/layer-animations/style-with-appearances"}]}),Pt=vt.postMetricsEvent.bind(vt),ft=new class extends We{constructor(){super("gljs.performance")}postPerformanceEvent(m,a){o.e.EVENTS_URL&&(m||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:u}=this.queue.shift(),g=function(x){const S=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),R=function(X){const Q={};if(X){for(const ae in X)if(ae!=="other")for(const ue of X[ae]){const ce=`${ae}ResolveRangeMin`,pe=`${ae}ResolveRangeMax`,Ce=`${ae}RequestCount`,ve=`${ae}RequestCachedCount`;Q[ce]=Math.min(Q[ce]||1/0,ue.startTime),Q[pe]=Math.max(Q[pe]||-1/0,ue.responseEnd);const Fe=Ie=>{Q[Ie]===void 0&&(Q[Ie]=0),++Q[Ie]};ue.transferSize!==void 0&&ue.transferSize===0&&Fe(ve),Fe(Ce)}}return Q}(function(X,Q){const ae={};if(X)for(const ue of X){const ce=Q(ue);ae[ce]===void 0&&(ae[ce]=[]),ae[ce].push(ue)}return ae}(S,P)),O=window.devicePixelRatio,$=navigator.connection||navigator.mozConnection||navigator.webkitConnection,U=$?$.effectiveType:void 0,q={counters:[],metadata:[],attributes:[]},H=(X,Q,ae)=>{ae!=null&&X.push({name:Q,value:ae.toString()})};for(const X in R)H(q.counters,X,R[X]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(H(q.counters,"interactionRangeMin",x.interactionRange[0]),H(q.counters,"interactionRangeMax",x.interactionRange[1])),E)for(const X of Object.values(b)){const Q=E.find(ae=>ae.name===X);Q&&H(q.counters,X,Q.startTime)}return H(q.counters,"visibilityHidden",x.visibilityHidden),H(q.attributes,"style",function(X){if(X)for(const Q of X){const ae=Q.name.split("?")[0];if(o.i(ae)){const ue=ae.split("/").slice(-2);if(ue.length===2)return`mapbox://styles/${ue[0]}/${ue[1]}`}}}(S)),H(q.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),H(q.attributes,"fogEnabled",x.fogEnabled?"true":"false"),H(q.attributes,"projection",x.projection),H(q.attributes,"zoom",x.zoom),H(q.metadata,"devicePixelRatio",O),H(q.metadata,"connectionEffectiveType",U),H(q.metadata,"navigatorUserAgent",navigator.userAgent),H(q.metadata,"screenWidth",window.screen.width),H(q.metadata,"screenHeight",window.screen.height),H(q.metadata,"windowWidth",window.innerWidth),H(q.metadata,"windowHeight",window.innerHeight),H(q.metadata,"mapWidth",x.width/O),H(q.metadata,"mapHeight",x.height/O),H(q.metadata,"webglRenderer",x.renderer),H(q.metadata,"webglVendor",x.vendor),H(q.metadata,"sdkVersion",y),H(q.metadata,"sdkIdentifier","mapbox-gl-js"),q}(u);for(const x of g.metadata);for(const x of g.counters);for(const x of g.attributes);this.postEvent(a,g,()=>{},m)}},Nt=ft.postPerformanceEvent.bind(ft),Rt=new class extends We{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,a,u,g){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const x=xe(o.e.API_URL+o.e.SESSION_PATH);x.params.push(`sku=${a||""}`),x.params.push(`access_token=${g||o.e.ACCESS_TOKEN||""}`);const S={url:Te(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(S,E=>{this.pendingRequest=null,u(E),this.saveEventData(),this.processRequests(g)})}getSessionAPI(m,a,u,g){this.skuToken=a,this.errorCb=g,o.e.SESSION_PATH&&o.e.API_URL&&(u||o.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},u):this.errorCb(new Error(ge)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):a&&(this.success[a]=!0)},m)}remove(){this.errorCb=null}},pt=Rt.getSessionAPI.bind(Rt),yt=new Set;function xt(m,a){a?yt.add(m):yt.delete(m)}class bt{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(a,u){this._updatedSourceCaches[a]=u,this.setDirty()}discardSourceCacheUpdate(a){delete this._updatedSourceCaches[a]}updateLayer(a){const u=a.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(a.id),this.setDirty()}removeLayer(a){const u=a.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][a.id]=a,this._updatedLayers[u].delete(a.id),this._updatedPaintProps.delete(a.fqid),this.setDirty()}getRemovedLayer(a){return this._removedLayers[a.scope]?this._removedLayers[a.scope][a.id]:null}discardLayerRemoval(a){this._removedLayers[a.scope]&&delete this._removedLayers[a.scope][a.id]}getLayerUpdatesByScope(){const a={};for(const u in this._updatedLayers)a[u]=a[u]||{},a[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)a[u]=a[u]||{},a[u].removedIds=Object.keys(this._removedLayers[u]);return a}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(a){this._updatedPaintProps.add(a.fqid),this.setDirty()}getUpdatedImages(a){return this._updatedImages[a]?Array.from(this._updatedImages[a].values()):[]}updateImage(a,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(o.I.toString(a)),this.setDirty()}resetUpdatedImages(a){this._updatedImages[a]&&this._updatedImages[a].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Ct(m){const{userImage:a}=m;return!!(a&&a.render&&a.render())&&(m.data.replace(new Uint8Array(a.data.buffer)),!0)}class tn extends o.E{constructor(a){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=a,a!=="raster"&&o.r()&&(this.imageRasterizerDispatcher=new o.D(o.t(),this,"Image Rasterizer Worker",1))}addScope(a){this.loaded.set(a,!1),this.imageProviders.set(a,new Map),this.images.set(a,new Map),this.updatedImages.set(a,new Set),this.callbackDispatchedThisFrame.set(a,new Set),this.patterns.set(a,new Map),this.atlasImage.set(a,new o.q({width:1,height:1}))}removeScope(a){this.loaded.delete(a),this.imageProviders.delete(a),this.images.delete(a),this.updatedImages.delete(a),this.callbackDispatchedThisFrame.delete(a),this.patterns.delete(a),this.atlasImage.delete(a);const u=this.atlasTexture.get(a);u&&(u.destroy(),this.atlasTexture.delete(a))}addImageProvider(a,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(a.id,a)}removeImageProvider(a,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(a)}getPendingImageProviders(){const a=[];for(const u of this.imageProviders.values())for(const g of u.values())g.hasPendingRequests()&&a.push(g);return a}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new o.x),this._imageRasterizer}isLoaded(){for(const a of this.loaded.keys())if(!this.loaded.get(a))return!1;return!0}setLoaded(a,u){if(this.loaded.get(u)!==a&&(this.loaded.set(u,a),a)){for(const{ids:g,callback:x}of this.requestors)this._notify(g,u,x);this.requestors=[]}}hasImage(a,u){return!!this.getImage(a,u)}getImage(a,u){return this.images.get(u).get(a.toString())}addImage(a,u,g){this._validate(a,g)&&this.images.get(u).set(a.toString(),g)}_validate(a,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new o.y(new Error(`Image "${a.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new o.y(new Error(`Image "${a.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new o.y(new Error(`Image "${a.name}" has invalid "content" value`))),g=!1),g}_validateStretch(a,u){if(!a)return!0;let g=0;for(const x of a){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(a,u){return a?a.length!==4||!u.usvg&&(a[0]<0||u.data.width<a[0]||a[1]<0||u.data.height<a[1]||a[2]<0||u.data.width<a[2]||a[3]<0||u.data.height<a[3])?!1:!(a[2]<a[0]||a[3]<a[1]):!0}updateImage(a,u,g){const x=this.images.get(u).get(a.toString());g.version=x.version+1,this.images.get(u).set(a.toString(),g),this.updatedImages.get(u).add(a),this.removeFromImageRasterizerCache(a,u)}clearUpdatedImages(a){this.updatedImages.get(a).clear()}removeFromImageRasterizerCache(a,u){this.spriteFormat!=="raster"&&(o.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[a],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([a],u))}removeImage(a,u){const g=this.images.get(u),x=g.get(a.toString());g.delete(a.toString()),this.patterns.get(u).delete(a.toString()),this.removeFromImageRasterizerCache(a,u),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(a){return Array.from(this.images.get(a).keys()).map(u=>o.I.from(u))}getImages(a,u,g){const x=[],S=[],E=this.imageProviders.get(u);for(const U of a){if(!U.iconsetId){x.push(U);continue}const q=E.get(U.iconsetId);q&&(this.getImage(U,u)?S.push(U):q.addPendingRequest(U))}if(x.length===0)return void this._notify(S,u,g);let R=!0;const O=!!this.loaded.get(u),$=this.images.get(u);if(!O)for(const U of x)$.has(U.toString())||(R=!1);O||R?this._notify(x,u,g):this.requestors.push({ids:x,scope:u,callback:g})}rasterizeImages(a,u){const g=new Map,{tasks:x,scope:S}=a;for(const[E,R]of x.entries()){const O=this.getImage(R.id,S);O&&g.set(E,{image:O,imageVariant:R})}this._rasterizeImages(S,g,u)}_rasterizeImages(a,u,g){if(o.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:a},g);else{const x=new Map;for(const[S,{image:E,imageVariant:R}]of u.entries())x.set(S,this.imageRasterizer.rasterize(R,E,a,0));g(void 0,x)}}getUpdatedImages(a){return this.updatedImages.get(a)||new Set}_notify(a,u,g){const x=this.images.get(u),S=new Map;for(const E of a){if(!x.get(E.toString())){if(E.iconsetId)continue;this.fire(new o.z("styleimagemissing",{id:E.name}))}const R=x.get(E.toString());if(!R){o.w(`Image "${E.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const O={data:R.usvg?null:R.data.clone(),pixelRatio:R.pixelRatio,sdf:R.sdf,usvg:R.usvg,version:R.version,stretchX:R.stretchX,stretchY:R.stretchY,content:R.content,hasRenderCallback:!!(R.userImage&&R.userImage.render)};R.usvg&&Object.assign(O,{width:R.icon.usvg_tree.width,height:R.icon.usvg_tree.height}),S.set(o.I.toString(E),O)}g(null,S)}getPixelSize(a){const{width:u,height:g}=this.atlasImage.get(a);return{width:u,height:g}}getPattern(a,u,g){const x=a.toString(),S=this.patterns.get(u),E=S.get(x),R=this.getImage(a,u);if(!R)return null;if(E){if(E.position.version===R.version)return E.position;E.position.version=R.version}else{if(R.usvg&&!R.data){const O=this.getPatternInFlightId(x,u);if(this.patternsInFlight.has(O))return null;this.patternsInFlight.add(O);const $=new o.A(a).scaleSelf(o.o.devicePixelRatio),U=new Map([[$.toString(),{image:R,imageVariant:$}]]);return this._rasterizeImages(u,U,(q,H)=>this.storePatternImage($,u,R,g,H)),null}this.storePattern(a,u,R)}return this._updatePatternAtlas(u,g),S.get(x).position}getPatternInFlightId(a,u){return o.B(a,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(a,u,g,x,S){const E=a.toString(),R=S?S.get(E):void 0;R&&(g.data=R,this.storePattern(a.id,u,g),this._updatePatternAtlas(u,x),this.patternsInFlight.delete(this.getPatternInFlightId(a.id.toString(),u)))}storePattern(a,u,g){const x={w:g.data.width+2*o.C,h:g.data.height+2*o.C,x:0,y:0},S=new o.F(x,g,o.C);this.patterns.get(u).set(a.toString(),{bin:x,position:S})}destroyAtlasTextures(){for(const a of this.atlasTexture.values())a&&a.destroy();this.atlasTexture.clear()}bind(a,u){const g=a.gl;let x=this.atlasTexture.get(u);x?this.dirty&&(x.update(this.atlasImage.get(u)),this.dirty=!1):(x=new o.T(a,this.atlasImage.get(u),g.RGBA8),this.atlasTexture.set(u,x)),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(a,u){const g=this.patterns.get(a),x=Array.from(g.values()).map(({bin:$})=>$),{w:S,h:E}=o.G(x),R=this.atlasImage.get(a);R.resize({width:S||1,height:E||1});const O=this.images.get(a);for(const[$,{bin:U,position:q}]of g.entries()){let H=q.padding;const X=U.x+H,Q=U.y+H,ae=O.get($).data,ue=ae.width,ce=ae.height;H=H>1?H-1:H,o.q.copy(ae,R,{x:0,y:0},{x:X,y:Q},{width:ue,height:ce},u),o.q.copy(ae,R,{x:0,y:ce-H},{x:X,y:Q-H},{width:ue,height:H},u),o.q.copy(ae,R,{x:0,y:0},{x:X,y:Q+ce},{width:ue,height:H},u),o.q.copy(ae,R,{x:ue-H,y:0},{x:X-H,y:Q},{width:H,height:ce},u),o.q.copy(ae,R,{x:0,y:0},{x:X+ue,y:Q},{width:H,height:ce},u),o.q.copy(ae,R,{x:ue-H,y:ce-H},{x:X-H,y:Q-H},{width:H,height:H},u),o.q.copy(ae,R,{x:0,y:ce-H},{x:X+ue,y:Q-H},{width:H,height:H},u),o.q.copy(ae,R,{x:0,y:0},{x:X+ue,y:Q+ce},{width:H,height:H},u),o.q.copy(ae,R,{x:ue-H,y:0},{x:X-H,y:Q+ce},{width:H,height:H},u)}this.dirty=!0}beginFrame(){for(const a of this.images.keys())this.callbackDispatchedThisFrame.set(a,new Set)}dispatchRenderCallbacks(a,u){const g=this.images.get(u);for(const x of a){if(this.callbackDispatchedThisFrame.get(u).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(x.toString());const S=g.get(x.toString());Ct(S)&&this.updateImage(x,u,S)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function Zt(m){const a=m.value,u=m.valueSpec,g=m.style,x=m.styleSpec,S=m.key,E=m.arrayElementValidator||_r;if(!Array.isArray(a))return[new o.V(S,a,`array expected, ${o.K(a)} found`)];if(u.length&&a.length!==u.length)return[new o.V(S,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new o.V(S,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let R={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};x.$version<7&&(R.function=u.function),o.H(u.value)&&(R=u.value);let O=[];for(let $=0;$<a.length;$++)O=O.concat(E({array:a,arrayIndex:$,value:a[$],valueSpec:R,style:g,styleSpec:x,key:`${S}[${$}]`},!0));return O}function In(m){const a=m.key,u=m.value,g=m.valueSpec;if(!o.L(u))return[new o.V(a,u,`number expected, ${o.K(u)} found`)];if(u!=u)return[new o.V(a,u,"number expected, NaN found")];if("minimum"in g){let x=g.minimum;if(Array.isArray(g.minimum)&&(x=g.minimum[m.arrayIndex]),u<x)return[new o.V(a,u,`${u} is less than the minimum value ${x}`)]}if("maximum"in g){let x=g.maximum;if(Array.isArray(g.maximum)&&(x=g.maximum[m.arrayIndex]),u>x)return[new o.V(a,u,`${u} is greater than the maximum value ${x}`)]}return[]}function Cn(m){const a=m.key,u=m.value;if(!o.H(u))return[new o.V(a,u,`object expected, ${o.K(u)} found`)];const g=m.valueSpec,x=o.J(u.type);let S,E,R,O={};const $=x!=="categorical"&&u.property===void 0,U=!$,q=function(ae){const ue=ae.stops;return Array.isArray(ue)&&Array.isArray(ue[0])&&o.H(ue[0][0])}(u),H=$r({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(ae){if(x==="identity")return[new o.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[];const ce=ae.value;return ue=ue.concat(Zt({key:ae.key,value:ce,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),Array.isArray(ce)&&ce.length===0&&ue.push(new o.V(ae.key,ce,"array must have at least one stop")),ue},default:function(ae){return _r({key:ae.key,value:ae.value,valueSpec:g,style:ae.style,styleSpec:ae.styleSpec})}}});return x==="identity"&&$&&H.push(new o.V(m.key,m.value,'missing required property "property"')),x==="identity"||u.stops||H.push(new o.V(m.key,m.value,'missing required property "stops"')),x==="exponential"&&g.expression&&!o.M(g)&&H.push(new o.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(U&&!o.N(g)?H.push(new o.V(m.key,m.value,"property functions not supported")):$&&!o.O(g)&&H.push(new o.V(m.key,m.value,"zoom functions not supported"))),x!=="categorical"&&!q||u.property!==void 0||H.push(new o.V(m.key,m.value,'"property" property is required')),H;function X(ae){let ue=[];const ce=ae.value,pe=ae.key;if(!Array.isArray(ce))return[new o.V(pe,ce,`array expected, ${o.K(ce)} found`)];if(ce.length!==2)return[new o.V(pe,ce,`array length 2 expected, length ${ce.length} found`)];if(q){if(!o.H(ce[0]))return[new o.V(pe,ce,`object expected, ${o.K(ce[0])} found`)];const Ce=ce[0];if(Ce.zoom===void 0)return[new o.V(pe,ce,"object stop key must have zoom")];if(Ce.value===void 0)return[new o.V(pe,ce,"object stop key must have value")];const ve=o.J(Ce.zoom);if(typeof ve!="number")return[new o.V(pe,Ce.zoom,"stop zoom values must be numbers")];if(R&&R>ve)return[new o.V(pe,Ce.zoom,"stop zoom values must appear in ascending order")];ve!==R&&(R=ve,E=void 0,O={}),ue=ue.concat($r({key:`${pe}[0]`,value:ce[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:In,value:Q}}))}else ue=ue.concat(Q({key:`${pe}[0]`,value:ce[0],style:ae.style,styleSpec:ae.styleSpec},ce));return o.Q(o.S(ce[1]))?ue.concat([new o.V(`${pe}[1]`,ce[1],"expressions are not allowed in function stops.")]):ue.concat(_r({key:`${pe}[1]`,value:ce[1],valueSpec:g,style:ae.style,styleSpec:ae.styleSpec}))}function Q(ae,ue){const ce=o.K(ae.value),pe=o.J(ae.value),Ce=ae.value!==null?ae.value:ue;if(S){if(ce!==S)return[new o.V(ae.key,Ce,`${ce} stop domain type must match previous stop domain type ${S}`)]}else S=ce;if(ce!=="number"&&ce!=="string"&&ce!=="boolean"&&typeof pe!="number"&&typeof pe!="string"&&typeof pe!="boolean")return[new o.V(ae.key,Ce,"stop domain value must be a number, string, or boolean")];if(ce!=="number"&&x!=="categorical"){let ve=`number expected, ${ce} found`;return o.N(g)&&x===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ae.key,Ce,ve)]}return x!=="categorical"||ce!=="number"||typeof pe=="number"&&isFinite(pe)&&Math.floor(pe)===pe?x!=="categorical"&&ce==="number"&&typeof pe=="number"&&typeof E=="number"&&E!==void 0&&pe<E?[new o.V(ae.key,Ce,"stop domain values must appear in ascending order")]:(E=pe,x==="categorical"&&pe in O?[new o.V(ae.key,Ce,"stop domain values must be unique")]:(O[pe]=!0,[])):[new o.V(ae.key,Ce,`integer expected, found ${String(pe)}`)]}}function Mt(m){const a=(m.expressionContext==="property"?o.W:o.U)(o.S(m.value),m.valueSpec);if(a.result==="error")return a.value.map(g=>new o.V(`${m.key}${g.key}`,m.value,g.message));const u=a.value.expression||a.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!u.outputDefined())return[new o.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!o.Z(u))return[new o.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return hn(u,m);if(m.expressionContext==="appearance")return Jt(u,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!o.X(u,["zoom","feature-state"]))return[new o.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!o.Y(u))return[new o.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hn(m,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const x of a.valueSpec.expression.parameters)u.delete(x);if(u.size===0)return[];const g=[];return m instanceof o._&&u.has(m.name)?[new o.V(a.key,a.value,`["${m.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(m.eachChild(x=>{g.push(...hn(x,a))}),g)}function Jt(m,a){const u=new Set;if(a.valueSpec&&a.valueSpec.expression)for(const x of a.valueSpec.expression.parameters)u.add(x);if(u.size===0)return[];const g=[];return m instanceof o._&&!u.has(m.name)?[new o.V(a.key,a.value,`["${m.name}"] is not an allowed parameter`)]:(m.eachChild(x=>{g.push(...Jt(x,a))}),g)}function Ut(m){const a=m.key,u=m.value,g=m.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(o.J(u))===-1&&x.push(new o.V(a,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(o.J(u))===-1&&x.push(new o.V(a,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),x}function Tn(m){return o.a2(o.S(m.value))?Mt(Object.assign({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):On(m)}function On(m){const a=m.value,u=m.key;if(!Array.isArray(a))return[new o.V(u,a,`array expected, ${o.K(a)} found`)];if(a.length<1)return[new o.V(u,a,"filter array must have at least 1 element")];const g=m.styleSpec;let x=Ut({key:`${u}[0]`,value:a[0],valueSpec:g.filter_operator});switch(o.J(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&o.J(a[1])==="$type"&&x.push(new o.V(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&x.push(new o.V(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(o.a0(a[1])||x.push(new o.V(`${u}[1]`,a[1],`string expected, ${o.K(a[1])} found`)));for(let S=2;S<a.length;S++)o.J(a[1])==="$type"?x=x.concat(Ut({key:`${u}[${S}]`,value:a[S],valueSpec:g.geometry_type})):o.a0(a[S])||o.L(a[S])||o.$(a[S])||x.push(new o.V(`${u}[${S}]`,a[S],`string, number, or boolean expected, ${o.K(a[S])} found.`));break;case"any":case"all":case"none":for(let S=1;S<a.length;S++)x=x.concat(On({key:`${u}[${S}]`,value:a[S],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":a.length!==2?x.push(new o.V(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):o.a0(a[1])||x.push(new o.V(`${u}[1]`,a[1],`string expected, ${o.K(a[1])} found`))}return x}function Kn(m,a){const u=m.key,g=m.style,x=m.layer,S=m.styleSpec,E=m.value,R=m.objectKey,O=S[`${a}_${m.layerType}`];if(!O)return[];const $=R.match(/^(.*)-use-theme$/);if($&&O[$[1]])return o.Q(o.S(E))?[].concat(_r({key:u,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:S,expressionContext:"property",propertyType:a,propertyKey:R})):_r({key:u,value:E,valueSpec:{type:"string"},style:g,styleSpec:S});const U=R.match(/^(.*)-transition$/);if(a==="paint"&&U&&O[U[1]]&&O[U[1]].transition)return _r({key:u,value:E,valueSpec:S.transition,style:g,styleSpec:S});const q=m.valueSpec||O[R];if(!q)return[new o.a3(u,E,`unknown property "${R}"`)];let H;if(o.a0(E)&&o.N(q)&&!q.tokens&&(H=/^{([^}]+)}$/.exec(E))){const Q=`\`{ "type": "identity", "property": ${H?JSON.stringify(H[1]):'"_"'} }\``;return[new o.V(u,E,`"${R}" does not support interpolation syntax
Use an identity property function instead: ${Q}.`)]}const X=[];if(m.layerType==="symbol")R!=="text-field"||!g||g.glyphs||g.imports||X.push(new o.V(u,E,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&o.a4(o.S(E))&&o.J(E.type)==="identity"&&X.push(new o.V(u,E,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&a==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&o.N(q)&&(o.a5(q)||o.O(q))){const Q=o.W(o.S(E),q).value,ae="expression"in Q&&Q.expression||"_styleExpression"in Q&&Q._styleExpression&&Q._styleExpression.expression;ae&&!o.X(ae,["measure-light"])&&(R==="model-emissive-strength"&&o.Y(ae)&&o.Z(ae)||X.push(new o.V(u,E,`${R} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return X.concat(_r({key:m.key,value:E,valueSpec:q,style:g,styleSpec:S,expressionContext:"property",propertyType:a,propertyKey:R}))}function Un(m){return Kn(m,"paint")}function Pn(m){return Kn(m,"layout")}function Qn(m){let a=[];const u=m.value,g=m.key,x=m.style,S=m.styleSpec;if(!o.H(u))return[new o.V(g,u,"object expected")];u.type||u.ref||a.push(new o.V(g,u,'either "type" or "ref" is required'));let E=o.J(u.type);const R=o.J(u.ref);if(u.id){const O=o.J(u.id);for(let $=0;$<m.arrayIndex;$++){const U=x.layers[$];o.J(U.id)===O&&a.push(new o.V(g,u.id,`duplicate layer id "${O}", previously used at line ${U.id.__line__}`))}}if("ref"in u){let O;["type","source","source-layer","filter","layout"].forEach($=>{$ in u&&a.push(new o.V(g,u[$],`"${$}" is prohibited for ref layers`))}),x.layers.forEach($=>{o.J($.id)===R&&(O=$)}),O?O.ref?a.push(new o.V(g,u.ref,"ref cannot reference another ref layer")):E=o.J(O.type):typeof R=="string"&&a.push(new o.V(g,u.ref,`ref layer "${R}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(u.source)if(o.a0(u.source)){const O=x.sources&&x.sources[u.source],$=O&&o.J(O.type);O?$==="vector"&&E==="raster"?a.push(new o.V(g,u.source,`layer "${u.id}" requires a raster source`)):$==="raster"&&E!=="raster"?a.push(new o.V(g,u.source,`layer "${u.id}" requires a vector source`)):$!=="vector"||u["source-layer"]?$==="raster-dem"&&E!=="hillshade"?a.push(new o.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):$!=="raster-array"||["raster","raster-particle"].includes(E)?E==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&$==="geojson"&&!O.lineMetrics?a.push(new o.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):E==="raster-particle"&&$!=="raster-array"&&a.push(new o.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):a.push(new o.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):a.push(new o.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new o.V(g,u.source,`source "${u.source}" not found`))}else a.push(new o.V(`${g}.source`,u.source,'"source" must be a string'));else a.push(new o.V(g,u,'missing required property "source"'));return a=a.concat($r({key:g,value:u,valueSpec:S.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_r({key:`${g}.type`,value:u.type,valueSpec:S.layer.type,style:m.style,styleSpec:m.styleSpec,object:u,objectKey:"type"}),filter:O=>Tn(Object.assign({layerType:E},O)),layout:O=>$r({layer:u,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":$=>Pn(Object.assign({layerType:E},$))}}),paint:O=>$r({layer:u,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":$=>Un(Object.assign({layerType:E,layer:u},$))}}),appearances(O){const $=Zt({key:O.key,value:O.value,valueSpec:O.valueSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:H=>function(X){const{key:Q,layer:ae,layerType:ue}=X,ce=o.J(X.value),pe=o.J(ce.name),Ce=o.J(ce.condition),ve=$r({key:Q,value:ce,valueSpec:X.styleSpec.appearance,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{condition:Fe=>function(Ie){const $e=[];return $e.push(...Mt({key:Ie.key,value:Ie.object.condition,valueSpec:o.a6.appearance.condition,expressionContext:"appearance"})),$e}(Object.assign({layer:ae,layerType:ue},Fe)),properties:Fe=>function(Ie){const $e=[],{styleSpec:Le,layer:Me,layerType:Ve}=Ie,st=Le[`paint_${Ve}`],nt=Le[`layout_${Ve}`],Et=Ie.object[Ie.objectKey];for(const mt in Et){const Lt=mt in st?"paint":mt in nt?"layout":void 0;if(!Lt){$e.push(new o.V(Ie.key,mt,`unknown property "${mt}" for layer type "${Ve}"`));continue}const ln=Object.assign({},Ie,{key:`${Ie.key}.${mt}`,object:Et,objectKey:mt,layer:Me,layerType:Ve,value:Et[mt],valueSpec:Lt==="paint"?st[mt]:nt[mt]});$e.push(...Kn(ln,Lt))}return $e}(Object.assign({layer:ae,layerType:ue},Fe))}});return pe!=="hidden"&&Ce===void 0&&ve.push(new o.V(X.key,"name",'Appearance with name different than "hidden" must have a condition')),ve}(Object.assign({layerType:E,layer:u},H))}),U=Array.isArray(O.value)?O.value:[],q=new Set;return U.forEach((H,X)=>{const Q=o.J(H.name);if(Q)if(q.has(Q)){const ae=o.J(u.id);$.push(new o.V(O.key,Q,`Duplicated appearance name "${Q}" for layer "${ae}"`))}else q.add(Q)}),$}}})),a}function un({key:m,value:a}){return o.a0(a)?[]:[new o.V(m,a,`string expected, ${o.K(a)} found`)]}const nn={promoteId:function m({key:a,value:u}){if(o.a0(u))return un({key:a,value:u});if(Array.isArray(u)){const x=[],S=o.S(u),E=o.U(S);return E.result==="error"&&E.value.forEach(R=>{x.push(new o.V(`${a}${R.key}`,null,`${R.message}`))}),o.X(E.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||x.push(new o.V(`${a}`,null,"promoteId expression should be only feature dependent")),x}if(!o.H(u))return[new o.V(a,u,`string, expression or object expected, "${o.K(u)}" found`)];const g=[];for(const x in u)g.push(...m({key:`${a}.${x}`,value:u[x]}));return g}};function $n(m){const a=m.value,u=m.key,g=m.styleSpec,x=m.style;if(!o.H(a))return[new o.V(u,a,`object expected, ${o.K(a)} found`)];if(!("type"in a))return[new o.V(u,a,'"type" is required')];const S=o.J(a.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&("url"in a||"tiles"in a||E.push(new o.a3(u,a,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat($r({key:u,value:a,valueSpec:g[`source_${S.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:nn})),E;case"geojson":if(E=$r({key:u,value:a,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:nn}),"cluster"in a&&"clusterProperties"in a){if(!o.H(a.clusterProperties))return[new o.V(`${u}.clusterProperties`,a,`object expected, ${o.K(a)} found`)];for(const R in a.clusterProperties){const O=a.clusterProperties[R];if(!Array.isArray(O))return[new o.V(`${u}.clusterProperties.${R}`,O,"array expected")];const[$,U]=O,q=typeof $=="string"?[$,["accumulated"],["get",R]]:$;E.push(...Mt({key:`${u}.${R}.map`,value:U,expressionContext:"cluster-map"})),E.push(...Mt({key:`${u}.${R}.reduce`,value:q,expressionContext:"cluster-reduce"}))}}return E;case"video":return $r({key:u,value:a,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return $r({key:u,value:a,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new o.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ut({key:`${u}.type`,value:a.type,valueSpec:{values:Ln(g)}})}}function Ln(m){return m.source.reduce((a,u)=>{const g=m[u];return g.type.type==="enum"&&(a=a.concat(Object.keys(g.type.values||{}))),a},[])}function qn(m){const a=m.value,u=m.styleSpec,g=u.light,x=m.style;if(a===void 0)return[];if(!o.H(a))return[new o.V("light",a,`object expected, ${o.K(a)} found`)];let S=[];for(const E in a){const R=E.match(/^(.*)-transition$/),O=E.match(/^(.*)-use-theme$/);S=S.concat(O&&g[O[1]]?_r({key:E,value:a[E],valueSpec:{type:"string"},style:x,styleSpec:u}):R&&g[R[1]]&&g[R[1]].transition?_r({key:E,value:a[E],valueSpec:u.transition,style:x,styleSpec:u}):g[E]?_r({key:E,value:a[E],valueSpec:g[E],style:x,styleSpec:u}):[new o.V(E,a[E],`unknown property "${E}"`)])}return S}function er(m){const a=m.value;if(!a)return[];const u=m.key;if(!o.H(a))return[new o.V(u,a,`object expected, ${o.K(a)} found`)];let g=[];const x=m.styleSpec,S=x["light-3d"],E=m.style,R=m.style.lights;for(const U of["type","id"])if(!(U in a))return g=g.concat([new o.V(u,a,`missing property "${U}"`)]),g;if(!o.a0(a.type))return g=g.concat([new o.V(`${u}.type`,a.type,"string expected")]),g;if(R)for(let U=0;U<m.arrayIndex;U++){const q=o.J(a.type),H=R[U];o.J(H.type)===q&&g.push(new o.V(u,a.id,`duplicate light type "${a.type}", previously defined at line ${H.id.__line__}`))}const O=`properties_light_${a.type}`;if(!(O in x))return g=g.concat([new o.V(`${u}.type`,a,`Invalid light type ${a.type}`)]),g;const $=x[O];for(const U in a)if(U==="properties"){const q=a[U];if(!o.H(q))return g=g.concat([new o.V("properties",q,`object expected, ${o.K(q)} found`)]),g;for(const H in q){const X=H.match(/^(.*)-transition$/),Q=H.match(/^(.*)-use-theme$/);g=g.concat(Q&&$[Q[1]]?_r({key:U,value:q[H],valueSpec:{type:"string"},style:E,styleSpec:x}):X&&$[X[1]]&&$[X[1]].transition?_r({key:U,value:a[U],valueSpec:x.transition,style:E,styleSpec:x}):$[H]?_r({key:H,value:q[H],valueSpec:$[H],style:E,styleSpec:x}):[new o.a3(m.key,q[H],`unknown property "${H}"`)])}}else g=g.concat(S[U]?_r({key:U,value:a[U],valueSpec:S[U],style:E,styleSpec:x}):[new o.a3(U,a[U],`unknown property "${U}"`)]);return g}function tr(m){const a=m.value,u=m.key,g=m.style,x=m.styleSpec,S=x.terrain;if(a==null)return[];if(!o.H(a))return[new o.V("terrain",a,`object expected, ${o.K(a)} found`)];let E=[];for(const R in a){const O=R.match(/^(.*)-transition$/),$=R.match(/^(.*)-use-theme$/);E=E.concat($&&S[$[1]]?_r({key:R,value:a[R],valueSpec:{type:"string"},style:g,styleSpec:x}):O&&S[O[1]]&&S[O[1]].transition?_r({key:R,value:a[R],valueSpec:x.transition,style:g,styleSpec:x}):S[R]?_r({key:R,value:a[R],valueSpec:S[R],style:g,styleSpec:x}):[new o.a3(R,a[R],`unknown property "${R}"`)])}if(a.source)if(o.a0(a.source)){const R=g.sources&&g.sources[a.source],O=R&&o.J(R.type);R?O!=="raster-dem"&&E.push(new o.V(`${u}.source`,a.source,`terrain cannot be used with a source of type ${O}, it only be used with a "raster-dem" source type`)):E.push(new o.V(`${u}.source`,a.source,`source "${a.source}" not found`))}else E.push(new o.V(`${u}.source`,a.source,"source must be a string"));else E.push(new o.V(u,a,'terrain is missing required property "source"'));return E}function Jn(m){const a=m.value,u=m.style,g=m.styleSpec,x=g.fog;if(a===void 0)return[];if(!o.H(a))return[new o.V("fog",a,`object expected, ${o.K(a)} found`)];let S=[];for(const E in a){const R=E.match(/^(.*)-transition$/),O=E.match(/^(.*)-use-theme$/);S=S.concat(O&&x[O[1]]?_r({key:E,value:a[E],valueSpec:{type:"string"},style:u,styleSpec:g}):R&&x[R[1]]&&x[R[1]].transition?_r({key:E,value:a[E],valueSpec:g.transition,style:u,styleSpec:g}):x[E]?_r({key:E,value:a[E],valueSpec:x[E],style:u,styleSpec:g}):[new o.a3(E,a[E],`unknown property "${E}"`)])}return S}const Ir={"*":()=>[],array:Zt,boolean:function(m){const a=m.value,u=m.key;return o.$(a)?[]:[new o.V(u,a,`boolean expected, ${o.K(a)} found`)]},number:In,color:function({key:m,value:a}){return o.a0(a)?o.a1.parseCSSColor(a)===null?[new o.V(m,a,`color expected, "${a}" found`)]:[]:[new o.V(m,a,`color expected, ${o.K(a)} found`)]},enum:Ut,filter:Tn,function:Cn,layer:Qn,object:$r,source:$n,model:o.a7,light:qn,"light-3d":er,terrain:tr,fog:Jn,string:un,formatted:function(m){return un(m).length===0?[]:Mt(m)},resolvedImage:function(m){return un(m).length===0?[]:Mt(m)},projection:function(m){const a=m.value,u=m.styleSpec,g=u.projection,x=m.style;if(o.H(a)){let S=[];for(const E in a)S=S.concat(_r({key:E,value:a[E],valueSpec:g[E],style:x,styleSpec:u}));return S}return o.a0(a)?[]:[new o.V("projection",a,`object or string expected, ${o.K(a)} found`)]},import:function(m){const a=m.key,{value:u,styleSpec:g}=m;if(!o.H(u))return[new o.V(a,u,"import must be an object")];const{data:x,...S}=u;Object.defineProperty(S,"__line__",{value:u.__line__,enumerable:!1});let E=$r(Object.assign({},m,{value:S,valueSpec:g.import}));return o.J(S.id)===""&&E.push(new o.V(`${m.key}.id`,S,"import id can't be an empty string")),x&&(E=E.concat(yi(x,g,{key:`${m.key}.data`}))),E},iconset:function(m){const a=m.value,u=m.key,g=m.styleSpec,x=m.style;if(!o.H(a))return[new o.V(u,a,"object expected")];if(!a.type)return[new o.V(u,a,'"type" is required')];const S=o.J(a.type);let E=[];if(E=E.concat($r({key:u,value:a,valueSpec:g[`iconset_${S}`],style:x,styleSpec:g})),function(R,O){return!(R!=="source"||!O.source)}(S,a)){const R=x.sources&&x.sources[a.source],O=R&&o.J(R.type);R?O!=="raster-array"&&E.push(new o.V(u,a.source,`iconset cannot be used with a source of type ${String(O)}, it only be used with a "raster-array" source type`)):E.push(new o.V(u,a.source,`source "${a.source}" not found`))}return E}};function _r(m,a=!1){const u=m.value,g=m.valueSpec,x=m.styleSpec;if(g.expression){if(o.a4(o.J(u)))return Cn(m);if(o.Q(o.S(u)))return Mt(m)}if(g.type&&Ir[g.type]){const S=Ir[g.type](m);return a===!0&&S.length>0&&Array.isArray(m.value)?Mt(m):S}return $r(Object.assign({},m,{valueSpec:g.type?x[g.type]:g}))}function $r(m){const a=m.key,u=m.value,g=m.valueSpec||{},x=m.objectElementValidators||{},S=m.style,E=m.styleSpec;if(!o.H(u))return[new o.V(a,u,`object expected, ${o.K(u)} found`)];let R=[];for(const O in u){const $=O.split(".")[0];let U;x[$]?U=x[$]:g[$]?U=_r:x["*"]?U=x["*"]:g["*"]&&(U=_r),U?R=R.concat(U({key:(a&&`${a}.`)+O,value:u[O],valueSpec:g[$]||g["*"],style:S,styleSpec:E,object:u,objectKey:O},u)):R.push(new o.a3(a,u[O],`unknown property "${O}"`))}for(const O in g){if(x[O])continue;const $=g[O];$.required&&$.default===void 0&&u[O]===void 0&&R.push(new o.V(a,u,`missing required property "${O}"`))}return R}function mr({key:m,value:a}){const u=un({key:m,value:a});if(u.length)return u;const g=a;return g.indexOf("{fontstack}")===-1&&u.push(new o.V(m,a,'"glyphs" url must include a "{fontstack}" token')),g.indexOf("{range}")===-1&&u.push(new o.V(m,a,'"glyphs" url must include a "{range}" token')),u}function yi(m,a=o.a6,u={}){return $r({key:u.key||"",value:m,valueSpec:Object.assign(a.$root,{"*":{type:"*"}}),styleSpec:a,style:m,objectElementValidators:{glyphs:mr}})}function Vr(m,a=o.a6){return je(yi(m,a))}const Kr=m=>je($n(m)),Rr=m=>je(qn(m)),ii=m=>je(er(m)),Hr=m=>je(tr(m)),ut=m=>je(Jn(m)),ur=m=>je(function(a){const u=a.value,g=a.style,x=a.styleSpec,S=x.snow;if(u===void 0)return[];if(!o.H(u))return[new o.V("snow",u,`object expected, ${o.K(u)} found`)];let E=[];for(const R in u){const O=R.match(/^(.*)-transition$/);E=E.concat(O&&S[O[1]]&&S[O[1]].transition?_r({key:R,value:u[R],valueSpec:x.transition,style:g,styleSpec:x}):S[R]?_r({key:R,value:u[R],valueSpec:S[R],style:g,styleSpec:x}):[new o.a3(R,u[R],`unknown property "${R}"`)])}return E}(m)),fr=m=>je(function(a){const u=a.value,g=a.style,x=a.styleSpec,S=x.rain;if(u===void 0)return[];if(!o.H(u))return[new o.V("rain",u,`object expected, ${o.K(u)} found`)];let E=[];for(const R in u){const O=R.match(/^(.*)-transition$/);E=E.concat(O&&S[O[1]]&&S[O[1]].transition?_r({key:R,value:u[R],valueSpec:x.transition,style:g,styleSpec:x}):S[R]?_r({key:R,value:u[R],valueSpec:S[R],style:g,styleSpec:x}):[new o.a3(R,u[R],`unknown property "${R}"`)])}return E}(m)),Fn=m=>je(Qn(m)),Gt=m=>je(Tn(m)),mn=m=>je(Un(m)),Xn=m=>je(Pn(m)),gr=m=>je(o.a7(m));function je(m){return m.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function re(m,a){let u=!1;if(a&&a.length)for(const g of a)g instanceof o.a3?o.w(g.message):(m.fire(new o.y(new Error(g.message))),u=!0);return u}const ie=o.a6.light;let _e;class Re extends o.E{constructor(a,u="flat"){super(),this._transitionable=new o.a8(_e||(_e=new o.a9({anchor:new o.aa(ie.anchor),position:new o.ab(ie.position),color:new o.aa(ie.color),intensity:new o.aa(ie.intensity)}))),this.setLight(a,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,u,g={}){this._validate(Rr,a,g)||(this._transitionable.setTransitionOrValue(a),this.id=u)}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,u,g){return(!g||g.validate!==!1)&&re(this,a.call(Vr,Object.assign({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}}const De=o.a6.terrain;let Ge=class extends o.E{constructor(m,a,u,g,x){super(),this.scope=u,this._transitionable=new o.a8(new o.a9({source:new o.aa(De.source),exaggeration:new o.aa(De.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a,this.worldview=x}get(){return this._transitionable.serialize()}set(m,a){this._transitionable.setTransitionOrValue(m,a)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new o.ac(m,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const a=m.value.expression;if(!a)return null;let u=-1,g=-1,x=1;for(const S of a.zoomStops)x=a.evaluate(new o.ac(S,{worldview:this.worldview})),x>.01?(u=S,g=-1):g=S;return x<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof o.ad}};const ot=45,Ye=65,rt=.05;function zt(m,a,u,g){const x=o.ah(ot,Ye,u),[S,E]=it(m,g);let R=1-Math.min(1,Math.exp((a-S)/(E-S)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*x*m.alpha}function it(m,a){const u=.5/Math.tan(.5*a);return[m.range[0]+u,m.range[1]+u]}function $t(m,a,u,g,x){const S=o.af([],[a,u,g],x.mercatorFogMatrix);return zt(m,o.ag(S),x.pitch,x._fov)}function Qt(m,a,u,g,x,S,E){const R=[[u,g,0],[x,g,0],[x,S,0],[u,S,0]];let O=Number.MAX_VALUE,$=-Number.MAX_VALUE;for(const U of R){const q=o.af([],U,a),H=o.ag(q);O=Math.min(O,H),$=Math.max($,H)}return[zt(m,O,E.pitch,E._fov),zt(m,$,E.pitch,E._fov)]}const Ft=o.a6.fog;class jt extends o.E{constructor(a,u,g,x){super();const S=new o.a9({range:new o.aa(Ft.range),color:new o.aa(Ft.color),"color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new o.aa(Ft["high-color"]),"high-color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new o.aa(Ft["space-color"]),"space-color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new o.aa(Ft["horizon-blend"]),"star-intensity":new o.aa(Ft["star-intensity"]),"vertical-range":new o.aa(Ft["vertical-range"])});this._transitionable=new o.a8(S,g,new Map(x)),this.set(a,x),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new o.ai(S),this.scope=g}get state(){const a=this._transform,u=a.projection.name==="globe",g=o.aj(a.zoom),x=this.properties.get("range"),S=[.5,3];return{range:u?[o.ak(S[0],x[0],g),o.ak(S[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,u,g={}){if(this._validate(ut,a,g))return;const x=Object.assign({},a);for(const S of Object.keys(Ft))x[S]===void 0&&(x[S]=Ft[S].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.ah(ot,Ye,a))*u.a}getOpacityAtLatLng(a,u){return this._transform.projection.supportsFog?function(g,x,S){const E=o.ae.fromLngLat(x),R=S.elevation?S.elevation.getAtPointOrZero(E):0;return $t(g,E.x,E.y,R,S)}(this.state,a,u):0}getOpacityForTile(a){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(a.toUnwrapped());return Qt(this.state,u,0,0,o.al,o.al,this._transform)}getOpacityForBounds(a,u,g,x,S){return this._transform.projection.supportsFog?Qt(this.state,a,u,g,x,S,this._transform):[1,1]}getFovAdjustedRange(a){return this._transform.projection.supportsFog?it(this.state,a):[0,1]}isVisibleOnFrustum(a){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const x=a.points[g];let S;if(x[2]>=0)S=x;else{const E=a.points[g-4];S=o.am(E,x,E[2]/(E[2]-x[2]))}if($t(this.state,S[0],S[1],0,this._transform)>=rt)return!0}return!1}updateConfig(a){this._transitionable.setTransitionOrValue(this._options,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,u,g){return(!g||g.validate!==!1)&&re(this,a.call(Vr,Object.assign({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}}let rn,yn,rr,En,Zn=class extends o.E{constructor(m,a,u,g){super();const x=rn||(rn=new o.a9({density:new o.aa(o.a6.snow.density),intensity:new o.aa(o.a6.snow.intensity),color:new o.aa(o.a6.snow.color),opacity:new o.aa(o.a6.snow.opacity),vignette:new o.aa(o.a6.snow.vignette),"vignette-color":new o.aa(o.a6.snow["vignette-color"]),"center-thinning":new o.aa(o.a6.snow["center-thinning"]),direction:new o.aa(o.a6.snow.direction),"flake-size":new o.aa(o.a6.snow["flake-size"])}));this._transitionable=new o.a8(x,u,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ai(x),this.scope=u}get state(){const m=this.properties.get("opacity"),a=this.properties.get("color"),u=this.properties.get("direction"),g=o.an(u[0]),x=-Math.max(o.an(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette"),R=this.properties.get("vignette-color");return R.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.ao(a.r,a.g,a.b,a.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:R}}get(){return this._transitionable.serialize()}set(m,a,u={}){if(this._validate(ur,m,u))return;const g=Object.assign({},m),x=o.a6.snow;for(const S of Object.keys(x))g[S]===void 0&&(g[S]=x[S].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,a,u){return(!u||u.validate!==!1)&&re(this,m.call(Vr,Object.assign({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}},ar=class extends o.E{constructor(m,a,u,g){super();const x=yn||(yn=new o.a9({density:new o.aa(o.a6.rain.density),intensity:new o.aa(o.a6.rain.intensity),color:new o.aa(o.a6.rain.color),opacity:new o.aa(o.a6.rain.opacity),vignette:new o.aa(o.a6.rain.vignette),"vignette-color":new o.aa(o.a6.rain["vignette-color"]),"center-thinning":new o.aa(o.a6.rain["center-thinning"]),direction:new o.aa(o.a6.rain.direction),"droplet-size":new o.aa(o.a6.rain["droplet-size"]),"distortion-strength":new o.aa(o.a6.rain["distortion-strength"])}));this._transitionable=new o.a8(x,u,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ai(x),this.scope=u}get state(){const m=this.properties.get("opacity"),a=this.properties.get("color"),u=this.properties.get("direction"),g=o.an(u[0]),x=-Math.max(o.an(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.ao(a.r,a.g,a.b,a.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(m,a,u={}){if(this._validate(fr,m,u))return;const g=Object.assign({},m),x=o.a6.rain;for(const S of Object.keys(x))g[S]===void 0&&(g[S]=x[S].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,a)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,a,u){return(!u||u.validate!==!1)&&re(this,m.call(Vr,Object.assign({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}};class qr extends o.E{constructor(a,u,g,x){super(),this.scope=g,this._options=a,this.properties=new o.ai(u),this._transitionable=new o.a8(u,g,new Map(x)),this._transitionable.setTransitionOrValue(a.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(a){this._transitionable.setTransitionOrValue(this._options.properties,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(a,u){this._options=a,this._transitionable.setTransitionOrValue(a.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ar{constructor(a,u,g){this.screenBounds=a,this.cameraPoint=g.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=u,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,g)}static createFromScreenPoints(a,u){let g,x;if(a instanceof o.P||typeof a[0]=="number"){const S=o.P.convert(a);g=[S],x=u.isPointAboveHorizon(S)}else{const S=o.P.convert(a[0]),E=o.P.convert(a[1]),R=S.add(E)._div(2);g=[S,E],x=o.aq(S,E).every(O=>u.isPointAboveHorizon(O))&&u.isPointAboveHorizon(R)}return new Ar(g,x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return o.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],x=o.aq(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),o.ar(x,a)}bufferedCameraGeometryGlobe(a){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],x=o.aq(u,g,a),S=this.cameraPoint.clone();switch(3*((S.y>u.y)+(S.y>g.y))+((S.x>u.x)+(S.x>g.x))){case 0:x[0]=S,x[4]=S.clone();break;case 1:x.splice(1,0,S);break;case 2:x[1]=S;break;case 3:x.splice(4,0,S);break;case 5:x.splice(2,0,S);break;case 6:x[3]=S;break;case 7:x.splice(3,0,S);break;case 8:x[2]=S}return x}containsTile(a,u,g,x=0){const S=Math.max(a.queryPadding,a.evaluateQueryRenderedFeaturePadding())/u._pixelsPerMercatorPixel+1,E=g?this._bufferedCameraMercator(S,u):this._bufferedScreenMercator(S,u);let R=a.tileID.wrap+(E.unwrapped?x:0);const O=E.polygon.map(ue=>o.as(a.tileTransform,ue,R));if(!o.at(O,0,0,o.al,o.al))return;R=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const $=this.screenGeometryMercator.polygon.map(ue=>o.au(a.tileTransform,ue,R)),U=$.map(ue=>new o.P(ue[0],ue[1])),q=u.getFreeCameraOptions().position||new o.ae(0,0,0),H=o.au(a.tileTransform,q,R),X=$.map(ue=>{const ce=o.av(ue,ue,H);return o.aw(ce,ce),new o.ax(H,ce)}),Q=o.ay(a,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:X,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(ae=o.az(O),ae.min.x=o.aA(ae.min.x,0,o.al),ae.min.y=o.aA(ae.min.y,0,o.al),ae.max.x=o.aA(ae.max.x,0,o.al),ae.max.y=o.aA(ae.max.y,0,o.al),ae),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:Q};var ae}_bufferedScreenMercator(a,u){const g=ni(a);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),u):{polygon:this.bufferedScreenGeometry(a).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(a,u){const g=ni(a);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),u):{polygon:this.bufferedCameraGeometry(a).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(a,u){const g=function(S,E){const R=o.aB([],E.pixelMatrix,E.globeMatrix),O=[0,-o.aD,0,1],$=[0,o.aD,0,1],U=[0,0,0,1];o.aC(O,O,R),o.aC($,$,R),o.aC(U,U,R);const q=new o.P(O[0]/O[3],O[1]/O[3]),H=new o.P($[0]/$[3],$[1]/$[3]),X=o.aE(S,q)&&O[3]<U[3],Q=o.aE(S,H)&&$[3]<U[3];if(!X&&!Q)return null;const ae=function($e,Le,Me){for(let Ve=1;Ve<$e.length;Ve++){const st=Jr(Le.pointCoordinate3D($e[Ve-1]).x),nt=Jr(Le.pointCoordinate3D($e[Ve]).x);if(Me<0){if(st<nt)return{idx:Ve,t:-st/(nt-1-st)}}else if(nt<st)return{idx:Ve,t:(1-st)/(nt+1-st)}}return null}(S,E,X?-1:1);if(!ae)return null;const{idx:ue,t:ce}=ae;let pe=ue>1?yr(S.slice(0,ue),E):[],Ce=ue<S.length?yr(S.slice(ue),E):[];pe=pe.map($e=>new o.P(Jr($e.x),$e.y)),Ce=Ce.map($e=>new o.P(Jr($e.x),$e.y));const ve=[...pe];ve.length===0&&ve.push(Ce[Ce.length-1]);const Fe=o.ak(ve[ve.length-1].y,(Ce.length===0?pe[0]:Ce[0]).y,ce);let Ie;return Ie=X?[new o.P(0,Fe),new o.P(0,0),new o.P(1,0),new o.P(1,Fe)]:[new o.P(1,Fe),new o.P(1,1),new o.P(0,1),new o.P(0,Fe)],ve.push(...Ie),Ce.length===0?ve.push(pe[0]):ve.push(...Ce),{polygon:ve.map($e=>new o.ae($e.x,$e.y)),unwrapped:!1}}(a,u);if(g)return g;const x=function(S,E){let R=!1,O=-1/0,$=0;for(let q=0;q<S.length-1;q++)S[q].x>O&&(O=S[q].x,$=q);for(let q=0;q<S.length-1;q++){const H=($+q)%(S.length-1),X=S[H],Q=S[H+1];Math.abs(X.x-Q.x)>.5&&(X.x<Q.x?(X.x+=1,H===0&&(S[S.length-1].x+=1)):(Q.x+=1,H+1===S.length-1&&(S[0].x+=1)),R=!0)}const U=o.aF(E.center.lng);return R&&U<Math.abs(U-1)&&S.forEach(q=>{q.x-=1}),{polygon:S,unwrapped:R}}(yr(a,u).map(S=>new o.P(Jr(S.x),S.y)),u);return{polygon:x.polygon.map(S=>new o.ae(S.x,S.y)),unwrapped:x.unwrapped}}}function yr(m,a){return o.aG(m,u=>{const g=a.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Jr(m){return m<0?1+m%1:m%1}function ni(m){return 100*m|0}function Qr(m,a,u,g,x){const S=function(R,O){if(R)return x(R);if(O){if(m.url&&O.tiles&&m.tiles&&delete m.tiles,O.variants){if(!Array.isArray(O.variants))return x(new Error("variants must be an array"));for(const U of O.variants){if(U==null||typeof U!="object"||U.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(U.capabilities))return x(new Error("capabilities must be an array"));if(U.capabilities.length===1&&U.capabilities[0]==="meshopt"){O=Object.assign(O,U);break}}}const $=o.aH(Object.assign({},O,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);$.tiles=a.canonicalizeTileset($,m.url),x(null,$)}},E=function(R,O,$){if(!R)return null;if(!O&&!$)return R;$=$||R.worldview_default;const U=Object.values(R.language||{});if(U.length===0)return null;const q=Object.values(R.worldview||{});if(q.length===0)return null;const H=U.every(Q=>Q===O),X=q.every(Q=>Q===$);return H&&X?R:O in(R.language_options||{})||$ in(R.worldview_options||{})?null:R.language_options&&R.worldview_options?R:null}(m.data,u,g);return E?o.o.frame(()=>S(null,E)):m.url?o.m(a.transformRequest(a.normalizeSourceURL(m.url,null,u,g),o.R.Source),S):o.o.frame(()=>{const{data:R,...O}=m;S(null,O)})}function li(m,a){const u=Math.pow(2,a.z),g=Math.floor(o.aF(m.getWest())*u),x=Math.floor(o.aJ(m.getNorth())*u),S=Math.ceil(o.aF(m.getEast())*u),E=Math.ceil(o.aJ(m.getSouth())*u);return a.x>=g&&a.x<S&&a.y>=x&&a.y<E}class Ui{constructor(a,u,g){this.bounds=a?o.aI.convert(this.validateBounds(a)):null,this.minzoom=u||0,this.maxzoom=g||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}addExtraBounds(a){if(a){this.extraBounds||(this.extraBounds=[]);for(const u of a)this.extraBounds.push(o.aI.convert(this.validateBounds(u)))}}contains(a){if(a.z>this.maxzoom||a.z<this.minzoom||this.bounds&&!li(this.bounds,a))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(li(u,a))return!0;return!1}static fromTileJSON(a){if(!a.bounds&&!a.extra_bounds)return null;const u=new Ui(a.bounds,a.minzoom,a.maxzoom);return u.addExtraBounds(a.extra_bounds),u}}class oo extends o.E{constructor(a,u,g,x){if(super(),this.id=a,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,o.aH(u,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new o.aK}load(a){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Qr(this._options,this.map._requestManager,u,g,(x,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new o.y(x));else if(S){if(Object.assign(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of S.vector_layers)this.vectorLayerIds.push(E.id),S.worldview&&S.worldview[E.source]&&this.localizableLayerIds.add(E.id)}this.tileBounds=Ui.fromTileJSON(S),Xe(S.tiles,this.map._requestManager._customAccessToken),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}a&&a(x)})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(a,u){const g=a.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(g),S=this.map._requestManager.transformRequest(x,o.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,R=E?{image:E.image.clone()}:null,O={request:S,data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,lut:R,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:a.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault,indoor:this.map.indoor?this.map.indoor.getIndoorTileOptions(this.id,this.scope):null};if(this.hasWorldviews&&o.h(g)&&(O.localizableLayerIds=this.localizableLayerIds),O.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired")a.state==="loading"?a.reloadCallback=u:a.request=a.actor.send("reloadTile",O,$.bind(this));else if(a.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",O,$.bind(this),void 0,!0);else{const U=o.aL.call({deduped:this._deduped},O,(q,H)=>{if(q||!H)$.call(this,q);else{const X=o.aM(H.responseHeaders);O.data={cacheControl:X.cacheControl,expires:X.expires,rawData:H.rawData.slice(0)},a.actor&&a.actor.send("loadTile",O,$.bind(this),void 0,!0)}},!0);a.request={cancel:U}}function $(U,q){return delete a.request,a.aborted?u(null):U&&U.status!==404?u(U):(q&&q.resourceTiming&&(a.resourceTiming=q.resourceTiming),this.map._refreshExpiredTiles&&q&&a.setExpiryData(q),a.loadVectorData(q,this.map.painter),o.aN(this.dispatcher),u(null,q),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,u){a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope}),a.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ti extends o.E{constructor(a,u,g,x){super(),this.id=a,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},u),Object.assign(this,o.aH(u,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=Qr(this._options,this.map._requestManager,null,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new o.y(g)):x&&(Object.assign(this,x),x.raster_layers&&(this.rasterLayers=x.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),this.tileBounds=Ui.fromTileJSON(x),Xe(x.tiles),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))),a&&a(g)})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(a){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,u){const g=o.o.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);a.request=o.n(this.map._requestManager.transformRequest(x,o.R.Tile),(S,E,R)=>{if(delete a.request,a.aborted)return a.state="unloaded",u(null);if(S)return a.state="errored",u(S);if(!E)return u(null);const O=o.aM(R);this.map._refreshExpiredTiles&&a.setExpiryData(O),a.setTexture(E,this.map.painter),a.state="loaded",o.aN(this.dispatcher),u(null)})}abortTile(a,u){a.request&&(a.request.cancel(),delete a.request),u&&u()}unloadTile(a,u){a.texture&&a.texture instanceof o.T?(a.destroy(!0),a.texture&&a.texture instanceof o.T&&this.map.painter.saveTileTexture(a.texture)):a.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function wr([m,a],u,g,{scaled:x=!0}={}){const{tileSize:S,buffer:E}=g,{x:R,y:O,z:$}=u;if(!isFinite(R)||!isFinite(O)||!isFinite($))throw new Error("Invalid MRT header");const U=2**$,q=U*o.aF(m),H=U*o.aJ(a);return function([X,Q],ae,{scaled:ue=!0}={}){if(!ae)throw new Error("bandView is undefined");const{data:ce,tileSize:pe,buffer:Ce,offset:ve,scale:Fe,dimension:Ie}=ae;if(X<-Ce||X>pe+Ce||Q<-Ce||Q>pe+Ce)throw new Error(`Point (${X}, ${Q}) out of bounds for tileSize=${pe}, buffer=${Ce}`);const $e=(Q+Ce)*(pe+2*Ce)+(X+Ce);if(new Uint32Array(ce.buffer)[$e]===4294967295)return null;let Le=[];Le=ue?[]:new ae.data.constructor(Ie);for(let Me=0;Me<Ie;Me++)Le[Me]=Math.round(1e12*(ce[Ie*$e+Me]*Fe+ve))/1e12;return Le}([Math.min(Math.max(-E,Math.floor((q-R)*S)),S-1+E),Math.min(Math.max(-E,Math.floor((H-O)*S)),S-1+E)],g,{scaled:x})}class nr extends Ti{constructor(a,u,g,x){super(a,u,g,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},u)}triggerRepaint(a){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,a.tileID),this.map.triggerRepaint()}loadTile(a,u){const g=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,o.R.Tile),S={request:x,uid:a.uid,tileID:a.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};a.source=this.id,a.scope=this.scope,a.requestParams=x,a.actor||(a.actor=this.dispatcher.getActor());const E=(R,O,$)=>{if(delete a.request,a.aborted)return a.state="unloaded",u(null);if(R)return R.name==="AbortError"?void 0:(a.state="errored",u(R));if(this.map._refreshExpiredTiles&&O){const U=o.aM($);a.setExpiryData(U)}if(this.partial&&a.state!=="expired")a.state="empty";else if(!this.partial){if(!O)return u(null);a.state="loaded",a._isHeaderLoaded=!0,a._mrt=O}u(null)};a.request=this.partial?a.fetchHeader(void 0,E.bind(this)):a.actor.send("loadTile",S,E.bind(this),void 0,!0)}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a,u){const g=a.texturePerLayer;if(a.flushAllQueues(),g.size){a.destroy(!0);for(const x of g.values())this.map.painter.saveTileTexture(x)}else a.destroy()}prepareTile(a,u,g,x){a._isHeaderLoaded&&(a.state!=="empty"&&(a.state="reloading"),a.fetchBandForRender(u,g,x,(S,E)=>{if(S)return a.state="errored",this.fire(new o.y(S)),void this.triggerRepaint(a);E&&(a._isHeaderLoaded=!0,a.setTexturePerLayer(g,E,this.map.painter),a.state="loaded",this.triggerRepaint(a))}))}getInitialBand(a){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:S})=>S===a),g=u&&u.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(a,u,g){if(!a)return;const x=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let S=null;u instanceof o.aQ?S=u.paint.get("raster-array-band"):u instanceof o.aR&&(S=u.paint.get("raster-particle-array-band"));const E=S||this.getInitialBand(x);if(E==null)return;if(!a.textureDescriptorPerLayer.get(u.id))return void this.prepareTile(a,x,u.id,E);if(a.updateNeeded(u.id,E)&&!g)return;const R=a.textureDescriptorPerLayer.get(u.id);return Object.assign({},R,{texture:a.texturePerLayer.get(u.id)})}getImages(a,u){const g=new Map;for(const x of a)for(const S of u){const[E,R]=S.split("/"),O=x.getLayer(E);if(!O||!O.hasBand(R)||!O.hasDataForBand(R))continue;const{bytes:$,tileSize:U,buffer:q}=O.getBandView(R),H=U+2*q,X={data:new o.q({width:H,height:H},$),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(S,X)}return g}queryRasterArrayValueByBandId(a,u,g){const x=u._mrt;return new Promise(S=>{const E={},R=new Set;for(const[O,$]of Object.entries(x.layers)){if(g.layerName&&O!==g.layerName)continue;const U={};E[O]=U;for(const{bands:q}of $.dataIndex)for(const H of q)g.bands&&!g.bands.includes(H)||(R.add(o.B(O,H)),u.fetchBand(O,null,H,X=>{o.o.frame(()=>{U[H]=X?null:wr([a.lng,a.lat],x,$.getBandView(H)),R.delete(o.B(O,H)),R.size===0&&S(E)})},!1))}R.size===0&&S(E)})}_loadTileForQuery(a,u){if(this._loadTileLoaded[a.uid])return void u(null,a._mrt);if(this._loadTilePending[a.uid])return void this._loadTilePending[a.uid].push(u);this._loadTilePending[a.uid]=[u];const g=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,o.R.Tile);a.actor.send("loadTile",{request:x,uid:a.uid,tileID:a.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},(S,E,R)=>{if(S)return this._loadTilePending[a.uid].forEach(O=>O(S,null)),void delete this._loadTilePending[a.uid];if(!E)return this._loadTilePending[a.uid].forEach(O=>O(null,null)),void delete this._loadTilePending[a.uid];if(this.map._refreshExpiredTiles&&E){const O=o.aM(R);a.setExpiryData(O)}a._mrt=E,a._isHeaderLoaded=!0,a.state="loaded",this._loadTilePending[a.uid].forEach(O=>O(null,E)),this._loadTileLoaded[a.uid]=!0,delete this._loadTilePending[a.uid]},void 0,!0)}queryRasterArrayValueByAllBands(a,u,g){return new Promise((x,S)=>{this._loadTileForQuery(u,(E,R)=>{E?S(E):x(R?this.queryRasterArrayValueByBandId(a,u,g):null)})})}queryRasterArrayValue(a,u){const g=o.aS.convert(a),x=this.findLoadedParent(g);return x&&x._mrt?u.bands||!this.partial?this.queryRasterArrayValueByBandId(g,x,u):this.queryRasterArrayValueByAllBands(g,x,u):Promise.resolve(null)}findLoadedParent(a){const u=o.ae.fromLngLat(a,this.map.transform.tileSize),g=this.maxzoom+1,x=1<<g,S=Math.floor(u.x),E=Math.floor((u.x-S)*x),R=Math.floor(u.y*x),O=this.map.style.getSourceCache(this.id),$=new o.aP(g,S,g,E,R);return O.findLoadedParent($,this.minzoom)}}const xi={vector:oo,raster:Ti,"raster-dem":class extends Ti{constructor(m,a,u,g){super(m,a,u,g),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(m,a){const u=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,S){x&&(m.state="errored",a(x)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",a(null))}m.request=o.n(this.map._requestManager.transformRequest(u,o.R.Tile),(function(x,S,E){if(delete m.request,m.aborted)m.state="unloaded",a(null);else if(x)m.state="errored",a(x);else if(S){const R=o.aM(E);this.map._refreshExpiredTiles&&m.setExpiryData(R);const O=ImageBitmap&&S instanceof ImageBitmap&&o.r(),$=1-(S.width-o.aO(S.width))/2;$<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const U=O?S:o.o.getImageData(S,$),q={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:U,encoding:this.encoding,padding:$};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",q,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const a=m.canonical,u=Math.pow(2,a.z),g=(a.x-1+u)%u,x=a.x===0?m.wrap-1:m.wrap,S=(a.x+1+u)%u,E=a.x+1===u?m.wrap+1:m.wrap,R={};return R[new o.aP(m.overscaledZ,x,a.z,g,a.y).key]={backfilled:!1},R[new o.aP(m.overscaledZ,E,a.z,S,a.y).key]={backfilled:!1},a.y>0&&(R[new o.aP(m.overscaledZ,x,a.z,g,a.y-1).key]={backfilled:!1},R[new o.aP(m.overscaledZ,m.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},R[new o.aP(m.overscaledZ,E,a.z,S,a.y-1).key]={backfilled:!1}),a.y+1<u&&(R[new o.aP(m.overscaledZ,x,a.z,g,a.y+1).key]={backfilled:!1},R[new o.aP(m.overscaledZ,m.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},R[new o.aP(m.overscaledZ,E,a.z,S,a.y+1).key]={backfilled:!1}),R}},"raster-array":nr,geojson:class extends o.E{constructor(m,a,u,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=a.data,this._options=Object.assign({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.minzoom!==void 0&&(this.minzoom=a.minzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const x=o.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*x,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*x,extent:o.al,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:o.al,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*x,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter,dynamic:a.dynamic},a.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new o.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new o.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const a=new Map;for(const u of this._data.features)a.set(u.id,u);for(const u of m.features)a.set(u.id,u);this._data.features=[...a.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},a),this}getClusterChildren(m,a){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},a),this}getClusterLeaves(m,a,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:a,offset:u},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.z("dataloading",{dataType:"source"})),this._loaded=!1;const a=Object.assign({append:m},this.workerOptions);a.scope=this.scope;const u=this._data;typeof u=="string"?(a.request=this.map._requestManager.transformRequest(o.o.resolveURL(u),o.R.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,a,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new o.y(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(S.resourceTiming=x.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new o.z("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const m=o.B(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,a){const u=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,x=g?{image:g.image.clone()}:null,S=this._partialReload,E={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:o.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:m.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:S,worldview:this.map.getWorldview(),indoor:this.map.indoor?this.map.indoor.getIndoorTileOptions(this.id,this.scope):null};m.request=this.actor.send(u,E,(R,O)=>S&&!O?(m.state="loaded",a(null)):(delete m.request,m.destroy(),m.aborted?a(null):R?a(R):(m.loadVectorData(O,this.map.painter,u==="reloadTile"),a(null))),void 0,u==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,a){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aT{constructor(m,a,u,g){super(m,a,u,g),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const a of m.urls)this.urls.push(this.map._requestManager.transformRequest(a,o.R.Source).url);o.aU(this.urls,(a,u)=>{this._loaded=!0,a?this.fire(new o.y(a)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const a=this.video.seekable;m<a.start(0)||m>a.end(0)?this.fire(new o.y(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,a=m.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(m,this.video,a.RGBA8),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aT,model:o.aW,"batched-model":class extends o.E{constructor(m,a,u,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=a,this.tiles=this._options.tiles,this.maxzoom=a.maxzoom||19,this.minzoom=a.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();const m=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Qr(this._options,this.map._requestManager,a,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new o.y(g))):x&&(Object.assign(this,x),x.bounds&&(this.tileBounds=new Ui(x.bounds,this.minzoom,this.maxzoom)),Xe(x.tiles,this.map._requestManager._customAccessToken),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,a){const u=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,o.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:o.o.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=a;else{if(m.buckets){const S=Object.values(m.buckets);for(const E of S)E.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,x.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(S,E){return m.aborted?a(null):S&&S.status!==404?a(S):(this.map._refreshExpiredTiles&&E&&m.setExpiryData(E),m.loadModelData(E,this.map.painter),m.state="loaded",void a(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends o.aT{constructor(m,a,u,g){super(m,a,u,g),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new o.y(new o.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.y(new o.V(`sources.${m}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new o.y(new o.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new o.y(new o.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.y(new o.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof o.aV||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(a,this.canvas,a.gl.RGBA8,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends o.E{constructor(m,a,u,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=a,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ui(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,o.aH(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:a,y:u,z:g}=m.canonical;return this._implementation.hasTile({x:a,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,a){const{x:u,y:g,z:x}=m.tileID.canonical,S=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:x},{signal:S.signal})).then((function(E){return delete m.request,m.aborted?(m.state="unloaded",a(null)):E===void 0?(m.state="errored",a(null)):E===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",a(null)):function(R){return R instanceof ImageData||R instanceof HTMLCanvasElement||R instanceof ImageBitmap||R instanceof HTMLImageElement}(E)?(this.loadTileData(m,E),m.state="loaded",void a(null)):(m.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.name!=="AbortError"&&(m.state="errored",a(E))}),m.request.cancel=()=>S.abort()}loadTileData(m,a){m.setTexture(a,this.map.painter)}unloadTile(m,a){if(m.texture&&m.texture instanceof o.T?(m.destroy(!0),m.texture&&m.texture instanceof o.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:x})}a&&a()}abortTile(m,a){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),a&&a()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=o.B(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}}},oi=function(m,a,u,g){const x=new xi[a.type](m,a,u,g);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return o.aX(["load","abort","unload","serialize","prepare"],x),x};function Li(m,a,u=""){return`${u}:${a.id||""}:${a.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:x,importId:S}=g;return`featureset:${x}${S?`:import:${S}`:""}`}}(m.target)}`}function ki(m,a,u,g=""){if(m.uniqueFeatureID){const x=Li(m,a,g);if(u.has(x))return!0;u.add(x)}return!1}function ho(m,a,u,g,x=!1){const S=a.sourceCache.transform,E=a.sourceCache.tilesIn(m,a.has3DLayers,x);E.sort(Ho);const R=[];for(const O of E){const $=O.tile.queryRenderedFeatures(a,O,u,g,S,x);Object.keys($).length&&R.push({wrappedTileID:O.tile.tileID.wrapped().key,queryResults:$})}for(const O in a.layers){const $=a.layers[O];if($.styleLayer){const U=$.styleLayer.queryRenderedFeatures(m,a.sourceCache,g);Object.keys(U).length&&R.push({wrappedTileID:0,queryResults:U})}}return R.length===0?{}:function(O){const $={},U={};for(const q of O){const H=q.queryResults,X=q.wrappedTileID,Q=U[X]=U[X]||{};for(const ae in H){const ue=H[ae],ce=Q[ae]=Q[ae]||{},pe=$[ae]=$[ae]||[];for(const Ce of ue)ce[Ce.featureIndex]||(ce[Ce.featureIndex]=!0,pe.push(Ce))}}return $}(R)}function Uo(m,a,u,g,x,S){const E={},R=g.queryRenderedSymbols(m),O=[];for(const $ of Object.keys(R).map(Number))O.push(x[$]);O.sort(Ho);for(const $ of O){const U=$.featureIndex.lookupSymbolFeatures(R[$.bucketInstanceId],$.bucketIndex,$.sourceLayerIndex,a,u,S);for(const q in U){const H=E[q]=E[q]||[],X=U[q];X.sort((Q,ae)=>{const ue=$.featureSortOrder;if(ue){const ce=ue.indexOf(Q.featureIndex);return ue.indexOf(ae.featureIndex)-ce}return ae.featureIndex-Q.featureIndex});for(const Q of X)H.push(Q)}}return E}function Qo(m,a){const u=m.getRenderableIds().map(S=>m.getTileByID(S)),g=[],x={};for(let S=0;S<u.length;S++){const E=u[S],R=E.tileID.canonical.key;x[R]||(x[R]=!0,E.querySourceFeatures(g,a))}return g}function Ho(m,a){const u=m.tileID,g=a.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function ea(m,a){const u={};if(!a)return u;for(const g of m){const x=g.layerIds.map(S=>a.getLayer(S)).filter(Boolean);if(x.length!==0){g.layers=x,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(S=>x.filter(E=>E.id===S)[0]));for(const S of x)u[S.fqid]=g}}return u}const Oo=32,Br=33,Xr=new Uint16Array(8184);for(let m=0;m<2046;m++){let a=m+2,u=0,g=0,x=0,S=0,E=0,R=0;for(1&a?x=S=E=Oo:u=g=R=Oo;(a>>=1)>1;){const $=u+x>>1,U=g+S>>1;1&a?(x=u,S=g,u=E,g=R):(u=x,g=S,x=E,S=R),E=$,R=U}const O=4*m;Xr[O+0]=u,Xr[O+1]=g,Xr[O+2]=x,Xr[O+3]=S}const eo=new Uint16Array(2178),qo=new Uint8Array(1089),Eo=new Uint16Array(1089);function Go(m){return m===0?-.03125:m===32?.03125:0}const Ia={type:2,extent:o.al,loadGeometry:()=>[[new o.P(0,0),new o.P(o.al+1,0),new o.P(o.al+1,o.al+1),new o.P(0,o.al+1),new o.P(0,0)]]};class Ko{constructor(a,u,g,x,S,E){this.tileID=a,this.uid=o.b1(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection),this.worldview=E,this._hasAppearances=null}registerFadeDuration(a){const u=a+this.timeAdded;u<o.o.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aY(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,g){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=ea(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const S=this.buckets[x];if(S instanceof o.b3){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const S=this.buckets[x];if(S instanceof o.b3&&S.hasRTLText){this.hasRTLText=!0,o.b4();break}}this.queryPadding=0;for(const x in this.buckets){const S=this.buckets[x],E=u.style.getOwnLayer(x);if(!E)continue;const R=E.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,R)}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas),this._lastUpdatedBrightness=a.brightness}else this.collisionBoxArray=new o.b2}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(a,u,g){a&&(a.resourceTiming&&(this.resourceTiming=a.resourceTiming),this.buckets=Object.assign({},this.buckets,ea(a.buckets,u.style)),a.featureIndex&&(this.latestFeatureIndex=a.featureIndex))}getBucket(a){return this.buckets[a.fqid]}upload(a,u){for(const S in this.buckets){const E=this.buckets[S];if(E.uploadPending()){let R={},O=[],$={zoom:0,pitch:0,brightness:0,worldview:""};if(u){if(u.style){O=u.style.listImages();const U=E.layers[0],q=U.sourceLayer||"_geojsonTileLayer",H=u.style.getLayerSourceCache(U);H&&(R=H._state.getState(q,void 0))}$={zoom:u.transform.zoom||0,pitch:u.transform.pitch||0,brightness:u.style.getBrightness()||0,worldview:u.worldview||""}}E.upload(a,this.tileID.canonical,R,O,$)}}const g=a.gl,x=this.imageAtlas;x&&!x.uploaded&&(this.imageAtlasTexture=new o.T(a,x.image,g.RGBA8,{useMipmap:!!x.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(a,this.glyphAtlasImage,g.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(a,this.lineAtlas.image,g.R8),this.lineAtlas.uploaded=!0)}prepare(a,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=u.style.getBrightness();this._hasAppearances===null&&(this._hasAppearances=this.hasAppearances(u)),(this._lastUpdatedBrightness||x||this._hasAppearances)&&(!this._hasAppearances&&this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}evaluateQueryRenderedFeaturePadding(){let a=0;for(const u in this.buckets){const g=this.buckets[u];g.evaluateQueryRenderedFeaturePadding&&(a=Math.max(a,g.evaluateQueryRenderedFeaturePadding()))}return a}queryRenderedFeatures(a,u,g,x,S,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const R=this.evaluateQueryRenderedFeaturePadding(),O=function($,U){const q=o.bp([],[.5*$.width,.5*-$.height,1]);return o.bq(q,q,[1,-1,0]),o.aB(q,q,$.calculateProjMatrix(U.toUnwrapped())),Float32Array.from(q)}(S,this.tileID);return this.latestFeatureIndex.query(a,{tilespaceGeometry:u,pixelPosMatrix:O,transform:x,availableImages:g,tileTransform:this.tileTransform,worldview:this.worldview,queryRadius:R})}querySourceFeatures(a,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),S=u?u.sourceLayer:"",E=x._geojsonTileLayer||x[S];if(!E)return;const R=o.b5(u&&u.filter),{z:O,x:$,y:U}=this.tileID.canonical,q={z:O,x:$,y:U};for(let H=0;H<E.length;H++){const X=E.feature(H);if(R.needGeometry){const ue=o.b6(X,!0);if(!R.filter(new o.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ue,this.tileID.canonical))continue}else if(!R.filter(new o.ac(this.tileID.overscaledZ,{worldview:this.worldview}),X))continue;const Q=g.getId(X,S),ae=new o.b7(X,O,$,U,Q);ae.tile=q,a.push(ae)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const g=o.b8(a.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const S=this.expirationTime-u;S?this.expirationTime=g+Math.max(S,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(a){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&a&&this.updateBuckets(a)}hasAppearances(a){for(const u in this.buckets)if(a.style.hasLayer(u)&&this.buckets[u].layers.some(g=>g.appearances&&g.appearances.length>0))return!0;return!1}updateBuckets(a,u){if(!this.latestFeatureIndex||!a.style)return;const g=this.latestFeatureIndex.loadVTLayers(),x=a.style.listImages(),S=a.style.getBrightness();for(const E in this.buckets){if(!a.style.hasLayer(E))continue;const R=this.buckets[E],O=R.layers[0],$=O.sourceLayer||"_geojsonTileLayer",U=g[$],q=a.style.getLayerSourceCache(O);let H={};q&&(H=q._state.getState($,void 0));const X=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},Q=Object.keys(H).length>0&&!u;if(R.hasAppearances=R.layers.some(ue=>ue.appearances&&ue.appearances.length>0),(Q&&R.stateDependentLayers.length!==0||u)&&R.update(H,U,x,X,Q?R.stateDependentLayers:R.layers,u,S),Q&&R.stateDependentLayers.length!==0||u||R.hasAppearances){const ue={zoom:a.transform.zoom,pitch:a.transform.pitch,brightness:a.style.getBrightness()||0,worldview:a.worldview};R.updateAppearances(this.tileID.canonical,H,x,ue)}(R instanceof o.b9||R instanceof o.ba)&&a._terrain&&a._terrain.enabled&&q&&R.uploadPending()&&a._terrain._clearRenderCacheForTile(q.id,this.tileID);const ae=a&&a.style&&a.style.getOwnLayer(E);ae&&(this.queryPadding=Math.max(this.queryPadding,ae.queryRadius(R)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=o.o.now()+a}setTexture(a,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture&&this.texture instanceof o.T?this.texture.update(a):(this.texture=new o.T(g,a,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(a,u){const g={};for(const x of u)g[x]=!0;this.dependencies[a]=g}hasDependency(a,u){for(const g of a){const x=this.dependencies[g];if(x){for(const S of u)if(x[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=o.bb(Ia,this.tileID.canonical,this.tileTransform)[0],x=new o.bc,S=new o.bd;for(let E=0;E<g.length;E++){const{x:R,y:O}=g[E];x.emplaceBack(R,O),S.emplaceBack(E)}S.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(S),this._tileDebugBuffer=a.createVertexBuffer(x,o.be.members),this._tileDebugSegments=o.bf.simpleSegment(0,0,x.length,S.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=o.bb(Ia,this.tileID.canonical,this.tileTransform)[0];let x,S;if(this.isRaster){const E=function(R,O){const $=o.aY(R,O),U=Math.pow(2,R.z);for(let ue=0;ue<Br;ue++)for(let ce=0;ce<Br;ce++){const pe=o.aZ((R.x+(ce+Go(ce))/Oo)/U),Ce=o.a_((R.y+(ue+Go(ue))/Oo)/U),ve=O.project(pe,Ce),Fe=ue*Br+ce;eo[2*Fe+0]=Math.round((ve.x*$.scale-$.x)*o.al),eo[2*Fe+1]=Math.round((ve.y*$.scale-$.y)*o.al)}qo.fill(0),Eo.fill(0);for(let ue=2045;ue>=0;ue--){const ce=4*ue,pe=Xr[ce+0],Ce=Xr[ce+1],ve=Xr[ce+2],Fe=Xr[ce+3],Ie=pe+ve>>1,$e=Ce+Fe>>1,Le=Ie+$e-Ce,Me=$e+pe-Ie,Ve=Ce*Br+pe,st=Fe*Br+ve,nt=$e*Br+Ie,Et=Math.hypot((eo[2*Ve+0]+eo[2*st+0])/2-eo[2*nt+0],(eo[2*Ve+1]+eo[2*st+1])/2-eo[2*nt+1])>=16;qo[nt]=qo[nt]||(Et?1:0),ue<1022&&(qo[nt]=qo[nt]||qo[(Ce+Me>>1)*Br+(pe+Le>>1)]||qo[(Fe+Me>>1)*Br+(ve+Le>>1)])}const q=new o.a$,H=new o.b0;let X=0;function Q(ue,ce){const pe=ce*Br+ue;return Eo[pe]===0&&(q.emplaceBack(eo[2*pe+0],eo[2*pe+1],ue*o.al/Oo,ce*o.al/Oo),Eo[pe]=++X),Eo[pe]-1}function ae(ue,ce,pe,Ce,ve,Fe){const Ie=ue+pe>>1,$e=ce+Ce>>1;if(Math.abs(ue-ve)+Math.abs(ce-Fe)>1&&qo[$e*Br+Ie])ae(ve,Fe,ue,ce,Ie,$e),ae(pe,Ce,ve,Fe,Ie,$e);else{const Le=Q(ue,ce),Me=Q(pe,Ce),Ve=Q(ve,Fe);H.emplaceBack(Le,Me,Ve)}}return ae(0,0,Oo,Oo,Oo,0),ae(Oo,Oo,0,0,0,Oo),{vertices:q,indices:H}}(this.tileID.canonical,u);x=E.vertices,S=E.indices}else{x=new o.a$,S=new o.b0;for(const{x:R,y:O}of g)x.emplaceBack(R,O,0,0);const E=o.bg(x.int16.subarray(0,4*x.length),void 0,4);for(let R=0;R<E.length;R+=3)S.emplaceBack(E[R],E[R+1],E[R+2])}this._tileBoundsBuffer=a.createVertexBuffer(x,o.bh.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(S),this._tileBoundsSegments=o.bf.simpleSegment(0,0,x.length,S.length)}_makeGlobeTileDebugBuffers(a,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const x=this.tileID.canonical,S=o.bi(x,u),E=o.bj(S),R=o.aj(u.zoom);let O;R>0&&(O=o.bk(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,x,u,E,O,R),this._makeGlobeTileDebugTextBuffer(a,x,u,E,O,R)}_globePoint(a,u,g,x,S,E,R){let O=o.bl(a,u,g);if(E){const $=1<<g.z,U=o.aF(x.center.lng),q=o.aJ(x.center.lat),H=(g.x+.5)/$-U;let X=0;H>.5?X=-1:H<-.5&&(X=1);let Q=(a/o.al+g.x)/$+X,ae=(u/o.al+g.y)/$;Q=(Q-U)*x._pixelsPerMercatorPixel+U,ae=(ae-q)*x._pixelsPerMercatorPixel+q;const ue=[Q*x.worldSize,ae*x.worldSize,0];o.af(ue,ue,E),O=o.bm(O,ue,R)}return o.af(O,O,S)}_makeGlobeTileDebugBorderBuffer(a,u,g,x,S,E){const R=new o.bc,O=new o.bd,$=new o.bn,U=(H,X,Q,ae,ue)=>{const ce=(Q-H)/(ue-1),pe=(ae-X)/(ue-1),Ce=R.length;for(let ve=0;ve<ue;ve++){const Fe=H+ve*ce,Ie=X+ve*pe;R.emplaceBack(Fe,Ie);const $e=this._globePoint(Fe,Ie,u,g,x,S,E);$.emplaceBack($e[0],$e[1],$e[2]),O.emplaceBack(Ce+ve)}},q=o.al;U(0,0,q,0,16),U(q,0,q,q,16),U(q,q,0,q,16),U(0,q,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(O),this._tileDebugBuffer=a.createVertexBuffer(R,o.be.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer($,o.bo.members),this._tileDebugSegments=o.bf.simpleSegment(0,0,R.length,O.length)}_makeGlobeTileDebugTextBuffer(a,u,g,x,S,E){const R=o.al/4,O=new o.bc,$=new o.b0,U=new o.bn,q=25;$.reserve(32),O.reserve(q),U.reserve(q);const H=(X,Q)=>q*X+Q;for(let X=0;X<q;X++){const Q=X*R;for(let ae=0;ae<q;ae++){const ue=ae*R;O.emplaceBack(ue,Q);const ce=this._globePoint(ue,Q,u,g,x,S,E);U.emplaceBack(ce[0],ce[1],ce[2])}}for(let X=0;X<4;X++)for(let Q=0;Q<4;Q++){const ae=H(X,Q),ue=H(X,Q+1),ce=H(X+1,Q),pe=H(X+1,Q+1);$.emplaceBack(ae,ue,ce),$.emplaceBack(ce,ue,pe)}this._tileDebugTextIndexBuffer=a.createIndexBuffer($),this._tileDebugTextBuffer=a.createVertexBuffer(O,o.be.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(U,o.bo.members),this._tileDebugTextSegments=o.bf.simpleSegment(0,0,q,32)}destroy(a=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!a&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.br.setPbf(o.bs);class sa extends Ko{constructor(a,u,g,x,S){super(a,u,g,x,S),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(a){return this._mrt&&this._mrt.getLayer(a)}setTexturePerLayer(a,u,g){const x=g.context,S=x.gl;let E=this.texturePerLayer.get(a)||g.getTileTexture(u.width);E&&E instanceof o.T?E.update(u,{premultiply:!1}):E=new o.T(x,u,S.RGBA8,{premultiply:!1}),this.texturePerLayer.has(a)||this.texturePerLayer.set(a,E)}flushQueues(a){const u=this._workQueuePerLayer.get(a)||[],g=this._fetchQueuePerLayer.get(a)||[];for(;u.length;)u.pop()();for(;g.length;)g.pop()()}flushAllQueues(){for(const a of this._workQueuePerLayer.keys()){const u=this._workQueuePerLayer.get(a)||[];for(;u.length;)u.pop()()}for(const a of this._fetchQueuePerLayer.keys()){const u=this._fetchQueuePerLayer.get(a)||[];for(;u.length;)u.pop()()}}fetchHeader(a=16384,u){const g=this._mrt=new o.br(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(a-1)}});return this.entireBuffer=null,this.request=o.bt(x,(S,E,R)=>{if(S)u(S);else try{const O=g.getHeaderLength(E);if(O>a)return void(this.request=this.fetchHeader(O,u));g.parseHeader(E),this._isHeaderLoaded=!0;let $=0;for(const U of Object.values(g.layers))$=Math.max($,U.dataIndex[U.dataIndex.length-1].lastByte);E.byteLength>=$&&(this.entireBuffer=E),u(null,this.entireBuffer||E,R)}catch(O){u(O)}}),this.request}fetchBandForRender(a,u,g,x){this.fetchBand(a,u,g,S=>{if(S)return void x(S);this.updateTextureDescriptor(a,u,g);const E=this.textureDescriptorPerLayer.get(u);x(null,E?E.img:null)})}fetchBand(a,u,g,x,S=!0){const E=this._mrt;if(!this._isHeaderLoaded||!E)return void x(new Error("Tile header is not ready"));const R=this.actor;if(!R)return void x(new Error("Can't fetch tile band without an actor"));let O;const $=o.B(String(g),o.B(this.tileID.key,a));let U=this._taskQueue.get($);U?U.add(x):(U=new Set,U.add(x),this._taskQueue.set($,U));const q=(ae,ue)=>{O.complete(ae,ue),ae?x(ae):(U.values().forEach(ce=>ce(null,ue)),this._taskQueue.delete($))},H=(ae,ue)=>{if(ae)return x(ae);const ce=R.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ue,task:O},q,void 0,!0);if(u!==null){const pe=this._workQueuePerLayer.get(u)||[];pe.push(()=>{ce&&ce.cancel(),O.cancel()}),this._workQueuePerLayer.has(u)||this._workQueuePerLayer.set(u,pe)}};let X;try{X=E.getLayer(a)}catch(ae){if(this.state==="reloading")return;throw ae}if(!X)return void x(new Error(`Unknown sourceLayer "${a}"`));if(X.hasDataForBand(g))return U.values().forEach(ae=>ae(null,null)),void this._taskQueue.delete($);const Q=X.getDataRange([g]);if(O=E.createDecodingTask(Q),!O||O.tasks.length)if(u!==null&&this.flushQueues(u),this.entireBuffer)H(null,this.entireBuffer.slice(Q.firstByte,Q.lastByte+1));else{const ae=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Q.firstByte}-${Q.lastByte}`}}),ue=o.bt(ae,H);if(u!==null){const ce=this._fetchQueuePerLayer.get(u)||[];ce.push(()=>{ue.cancel(),O.cancel()}),this._fetchQueuePerLayer.has(u)||this._fetchQueuePerLayer.set(u,ce)}}}updateNeeded(a,u){return(!this.textureDescriptorPerLayer.get(a)||this.textureDescriptorPerLayer.get(a).band!==u||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(a,u,g){if(!this._mrt)return;const x=this._mrt.getLayer(a);if(!x||!x.hasBand(g)||!x.hasDataForBand(g))return;const{bytes:S,tileSize:E,buffer:R,offset:O,scale:$}=x.getBandView(g),U=E+2*R,q=new o.q({width:U,height:U},S),H=this.texturePerLayer.get(u);H&&H instanceof o.T&&H.update(q,{premultiply:!1}),this.textureDescriptorPerLayer.set(u,{layer:a,band:g,img:q,buffer:R,offset:O,tileSize:E,format:x.pixelFormat,mix:[$,256*$,65536*$,16777216*$]})}destroy(a=!1){if(super.destroy(a),delete this._mrt,!a)for(const u of this.texturePerLayer.values())u&&u instanceof o.T&&u.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class Ss{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,g){const x=a.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const S={value:u,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout(()=>{this.remove(a,S)},g)),this.data[x].push(S),this.order.push(x),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const g=a.wrapped().key,x=u===void 0?0:this.data[g].indexOf(u),S=this.data[g][x];return this.data[g].splice(x,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const g in this.data)for(const x of this.data[g])a(x.value)||u.push(x);for(const g of u)this.remove(g.value.tileID,g)}}class Ku{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,g){const x=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][x]=this.stateChanges[a][x]||{},Object.assign(this.stateChanges[a][x],g),this.deletedStates[a]===null){this.deletedStates[a]={};for(const S in this.state[a])S!==x&&(this.deletedStates[a][S]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][x]===null){this.deletedStates[a][x]={};for(const S in this.state[a][x])g[S]||(this.deletedStates[a][x][S]=null)}else for(const S in g)this.deletedStates[a]&&this.deletedStates[a][x]&&this.deletedStates[a][x][S]===null&&delete this.deletedStates[a][x][S]}removeFeatureState(a,u,g){if(this.deletedStates[a]===null)return;const x=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},g&&u!==void 0)this.deletedStates[a][x]!==null&&(this.deletedStates[a][x]=this.deletedStates[a][x]||{},this.deletedStates[a][x][g]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][x])for(g in this.deletedStates[a][x]={},this.stateChanges[a][x])this.deletedStates[a][x][g]=null;else this.deletedStates[a][x]=null;else this.deletedStates[a]=null}getState(a,u){const g=this.state[a]||{},x=this.stateChanges[a]||{},S=this.deletedStates[a];if(S===null)return{};if(u!==void 0){const R=String(u),O=Object.assign({},g[R],x[R]);if(S){const $=S[u];if($===null)return{};for(const U in $)delete O[U]}return O}const E=Object.assign({},g,x);if(S)for(const R in S)delete E[R];return E}initializeTileState(a,u){a.refreshFeatureState(u)}coalesceChanges(a,u){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const S={};for(const E in this.stateChanges[x])this.state[x][E]||(this.state[x][E]={}),Object.assign(this.state[x][E],this.stateChanges[x][E]),S[E]=this.state[x][E];g[x]=S}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const S={};if(this.deletedStates[x]===null)for(const E in this.state[x])S[E]={},this.state[x][E]={};else for(const E in this.deletedStates[x]){if(this.deletedStates[x][E]===null)this.state[x][E]={};else if(this.state[x][E])for(const R of Object.keys(this.deletedStates[x][E]))delete this.state[x][E][R];S[E]=this.state[x][E]}g[x]=g[x]||{},Object.assign(g[x],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in a)a[x].refreshFeatureState(u)}}class Ja extends o.E{constructor(a,u,g){super(),this.id=a,this._onlySymbols=g,u.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new Ss(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ku,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles)if(!this._tiles[a].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,a.isExtraShadowCaster=this._shadowCasterTiles[a.tileID.key],this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a)}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a)}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(a,this.map?this.map.painter:void 0),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(Xu).map(a=>a.key)}getRenderableIds(a,u){const g=[];for(const x in this._tiles)this._isIdRenderable(+x,a,u)&&g.push(this._tiles[x]);return a?g.sort((x,S)=>{const E=x.tileID,R=S.tileID,O=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),$=new o.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-R.overscaledZ||$.y-O.y||$.x-O.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(Xu).map(x=>x.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u,g){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())&&(g||!this._shadowCasterTiles[a])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const g=this._tiles[a];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,a,u)))}_tileLoaded(a,u,g,x,S){if(x){if(a.state="errored",x.status!==404)this._source.fire(new o.y(x,{tile:a}));else{if(this._source.fire(new o.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:a})),!(a.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const R=this.map.painter.terrain;this.update(this.transform,R.getScaledDemTileSize(),!0),R.resetTileLookupCache(this.id)}else this.update(this.transform)}return}a.timeAdded=o.o.now(),g==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null);let E=new Map;S&&S.responseHeaders&&(E=S.responseHeaders),this._source.fire(new o.z("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id,responseHeaders:E}))}_backfillDEM(a){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const S=u[x];if(a.neighboringTiles&&a.neighboringTiles[S]){const E=this.getTileByID(S);g(a,E),g(E,a)}}function g(x,S){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let E=S.tileID.canonical.x-x.tileID.canonical.x;const R=S.tileID.canonical.y-x.tileID.canonical.y,O=Math.pow(2,x.tileID.canonical.z),$=S.tileID.key;E===0&&R===0||Math.abs(R)>1||(Math.abs(E)>1&&(Math.abs(E+O)===1?E+=O:Math.abs(E-O)===1&&(E-=O)),S.dem&&x.dem&&(x.dem.backfillBorder(S.dem,E,R),x.neighboringTiles&&x.neighboringTiles[$]&&(x.neighboringTiles[$].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,g,x){for(const S in this._tiles){let E=this._tiles[S];if(x[S]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>g)continue;let R=E.tileID;for(;E&&E.tileID.overscaledZ>u+1;){const $=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[$.key],E&&E.hasData()&&(R=$)}let O=R;for(;O.overscaledZ>u;)if(O=O.scaledTo(O.overscaledZ-1),a[O.key]){x[R.key]=R;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const g=this._loadedParentTiles[a.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=a.overscaledZ-1;g>=u;g--){const x=a.scaledTo(g),S=this._getLoadedTile(x);if(S)return S}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const g=Math.ceil(a.width/u)+1,x=Math.ceil(a.height/u)+1,S=Math.floor(g*x*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(R)}handleWrapJump(a){const u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){const g={};for(const x in this._tiles){const S=this._tiles[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),g[S.tileID.key]=S}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(a,u,g,x,S){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(a,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const E=this._source.type==="batched-model";let R,O=this._source.maxzoom;const $=this.map&&this.map.painter?this.map.painter._terrain:null;if($&&$.sourceCache===this&&$.attenuationRange()){const H=$.attenuationRange()[0],X=Math.floor(H)-Math.log2($.getDemUpscale());O>X&&(O=X)}if(this.used||this.usedForTerrain){if(this._source.tileID)R=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new o.aP(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y));else if(this.tileCoverLift!==0){const H=a.clone();H.tileCoverLift=this.tileCoverLift,R=H.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.minzoom<=1&&a.projection.name==="globe"&&(R.push(new o.aP(1,0,1,0,0)),R.push(new o.aP(1,0,1,1,0)),R.push(new o.aP(1,0,1,0,1)),R.push(new o.aP(1,0,1,1,1)))}else if(R=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.hasTile){const H=this._source.hasTile.bind(this._source);R=R.filter(X=>H(X))}}else R=[];if(R.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Dr(this._source.type)){const H=a.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),X=Math.min(H,this._source.maxzoom);if(E){const Q=a.extendTileCover(R,X);for(const ae of Q)R.push(ae)}else if(S){const Q=a.extendTileCoverToNearPlane(R,this.transform.getFrustum(X),X);for(const ae of Q)R.push(ae)}else if(this.castsShadows&&x){const Q=a.extendTileCover(R,X,x);for(const ae of Q)this._shadowCasterTiles[ae.key]=!0,R.push(ae)}}const U=this._updateRetainedTiles(R);if(Dr(this._source.type)&&R.length!==0){const H={},X={},Q=Object.keys(U);for(const ue of Q){const ce=U[ue],pe=this._tiles[ue];if(!pe||pe.fadeEndTime&&pe.fadeEndTime<=o.o.now())continue;const Ce=this.findLoadedParent(ce,Math.max(ce.overscaledZ-Ja.maxOverzooming,this._source.minzoom));Ce&&(this._addTile(Ce.tileID),H[Ce.tileID.key]=Ce.tileID),X[ue]=ce}const ae=R[R.length-1].overscaledZ;for(const ue in this._tiles){const ce=this._tiles[ue];if(U[ue]||!ce.hasData())continue;let pe=ce.tileID;for(;pe.overscaledZ>ae;){pe=pe.scaledTo(pe.overscaledZ-1);const Ce=this._tiles[pe.key];if(Ce&&Ce.hasData()&&X[pe.key]){U[ue]=ce.tileID;break}}}for(const ue in H)U[ue]||(this._coveredTiles[ue]=!0,U[ue]=H[ue])}for(const H in U)this._tiles[H].clearFadeHold();const q=o.bu(this._tiles,U);for(const H of q){const X=this._tiles[H];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(+H)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(a.length===0)return u;const g={},x=a.reduce(($,U)=>Math.min($,U.overscaledZ),1/0),S=a[0].overscaledZ,E=Math.max(S-Ja.maxOverzooming,this._source.minzoom),R=Math.max(S+Ja.maxUnderzooming,this._source.minzoom),O={};for(const $ of a){const U=this._addTile($);u[$.key]=$,U.hasData()||x<this._source.maxzoom&&(O[$.key]=$)}this._retainLoadedChildren(O,x,R,u);for(const $ of a){let U=this._tiles[$.key];if(U.hasData())continue;if($.canonical.z>=this._source.maxzoom){const H=$.children(this._source.maxzoom)[0],X=this.getTile(H);if(X&&X.hasData()){u[H.key]=H;continue}}else{const H=$.children(this._source.maxzoom);if(u[H[0].key]&&u[H[1].key]&&u[H[2].key]&&u[H[3].key])continue}let q=U.wasRequested();for(let H=$.overscaledZ-1;H>=E;--H){const X=$.scaledTo(H);if(g[X.key]||(g[X.key]=!0,U=this.getTile(X),!U&&q&&(U=this._addTile(X)),U&&(u[X.key]=X,q=U.wasRequested(),U.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let g,x=this._tiles[a].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}u.push(x.key);const S=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;x=S}for(const S of u)this._loadedParentTiles[S]=g}}_addTile(a){let u=this._tiles[a.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[a.key]||this._reloadTile(a.key,"reloading"),u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const g=!!u;if(!g){const x=this.map?this.map.painter:null,S=this._source.tileSize*a.overscaleFactor();u=this._source.type==="raster-array"?new sa(a,S,this.transform.tileZoom,x,this._isRaster):new Ko(a,S,this.transform.tileZoom,x,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u.uses++,this._tiles[a.key]=u,g||this._source.fire(new o.z("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const g=u.getExpiryTimeout();g&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},g))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,g){const x=[],S=this.transform;if(!S)return x;const E=S.projection.name==="globe",R=o.aF(S.center.lng);for(const O in this._tiles){const $=this._tiles[O];if(g&&$.clearQueryDebugViz(),$.holdingForFade())continue;let U;if(E){const q=$.tileID.canonical;if(q.z===0){const H=[Math.abs(o.aA(R,...ti(q,-1))-R),Math.abs(o.aA(R,...ti(q,1))-R)];U=[0,2*H.indexOf(Math.min(...H))-1]}else{const H=[Math.abs(o.aA(R,...ti(q,-1))-R),Math.abs(o.aA(R,...ti(q,0))-R),Math.abs(o.aA(R,...ti(q,1))-R)];U=[H.indexOf(Math.min(...H))-1]}}else U=[0];for(const q of U){const H=a.containsTile($,S,u,q);H&&x.push(H)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(a){return this._getRenderableCoordinates(a)}_getRenderableCoordinates(a,u){const g=this.getRenderableIds(a,u).map(S=>this._tiles[S].tileID),x=this.transform.projection.name==="globe";for(const S of g)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=x?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return g}sortCoordinatesByDistance(a){const u=a.slice(),g=this.transform._camera.position,x=this.transform._camera.forward(),S={};for(const E of u){const R=1/(1<<E.canonical.z);S[E.key]=((E.canonical.x+.5)*R+E.wrap-g[0])*x[0]+((E.canonical.y+.5)*R-g[1])*x[1]-g[2]*x[2]}return u.sort((E,R)=>S[E.key]-S[R.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(Dr(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=o.o.now())return!0}return!1}setFeatureState(a,u,g){this._state.updateState(a=a||"_geojsonTileLayer",u,g)}removeFeatureState(a,u,g){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,g)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,g){const x=this._tiles[a];x&&x.setDependencies(u,g)}reloadTilesForDependencies(a,u){for(const g in this._tiles)this._tiles[g].hasDependency(a,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(a,u))}_preloadTiles(a,u){if(!this._sourceLoaded){const O=()=>{this._sourceLoaded&&(this._source.off("data",O),this._preloadTiles(a,u))};return void this._source.on("data",O)}const g=new Map,x=Array.isArray(a)?a:[a],S=this.map.painter.terrain,E=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const O of x){const $=O.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const U of $)g.set(U.key,U);this.usedForTerrain&&O.updateElevation(!1)}const R=Array.from(g.values());o.bv(R,(O,$)=>{const U=new Ko(O,this._source.tileSize*O.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(U,q=>{this._source.type==="raster-dem"&&U.dem&&this._backfillDEM(U),$(q,U)})},u)}}function Xu(m,a){const u=Math.abs(2*m.wrap)-+(m.wrap<0),g=Math.abs(2*a.wrap)-+(a.wrap<0);return m.overscaledZ-a.overscaledZ||g-u||a.canonical.y-m.canonical.y||a.canonical.x-m.canonical.x}function Dr(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function ti(m,a){const u=1<<m.z;return[m.x/u+a,(m.x+1)/u+a]}Ja.maxOverzooming=10,Ja.maxUnderzooming=3;class Do{constructor(a){this.style=a,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const a=!1,u=!1;for(const g in this.style._mergedLayers){const x=this.style._mergedLayers[g];if(x.type==="fill-extrusion"||x.type==="building")this.layers.push({layer:x,visible:a,visibilityChanged:u});else if(x.type==="model"){const S=this.style.getLayerSource(x);S&&S.type==="batched-model"&&this.layers.push({layer:x,visible:a,visibilityChanged:u})}}}onNewFrame(a){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let x=!1;g.type==="fill-extrusion"?x=!g.isHidden(a)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="building"?x=!g.isHidden(a)&&g.paint.get("building-opacity")>0:g.type==="model"&&(x=!g.isHidden(a)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&u.visible,u.visible=x}}updateZOffset(a,u){this.currentBuildingBuckets=[];for(const x of this.layers){const S=x.layer,E=this.style.getLayerSourceCache(S);let R=1;S.type==="fill-extrusion"?R=x.visible?S.paint.get("fill-extrusion-vertical-scale"):0:S.type==="building"&&(R=x.visible?S.paint.get("building-vertical-scale"):0);let O=E?E.getTile(u):null;if(!O&&E)for(const $ in E._tiles){const U=E._tiles[$];if(u.canonical.isChildOf(U.tileID.canonical)){O=U;break}}this.currentBuildingBuckets.push({bucket:O?O.getBucket(S):null,tileID:O?O.tileID:u,verticalScale:R})}a.hasAnyZOffset=!1;let g=!1;for(let x=0;x<a.symbolInstances.length;x++){const S=a.symbolInstances.get(x),E=S.zOffset,R=this._getHeightAtTileOffset(u,S.tileAnchorX,S.tileAnchorY);S.zOffset=R!==Number.NEGATIVE_INFINITY?R:E,g||E===S.zOffset||(g=!0),a.hasAnyZOffset||S.zOffset===0||(a.hasAnyZOffset=!0)}g&&(a.zOffsetBuffersNeedUpload=!0,a.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(a,u,g,x){let S=u,E=g;if(a.canonical.z!==x.canonical.z){const R=x.canonical,O=1/(1<<a.canonical.z-R.z);S=(u+a.canonical.x*o.al)*O-R.x*o.al|0,E=(g+a.canonical.y*o.al)*O-R.y*o.al|0}return{tileX:S,tileY:E}}_getHeightAtTileOffset(a,u,g){let x,S;for(let E=0;E<this.layers.length;++E){const R=this.layers[E].layer;if(R.type!=="fill-extrusion"&&R.type!=="building")continue;const{bucket:O,tileID:$,verticalScale:U}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:q,tileY:H}=this._mapCoordToOverlappingTile(a,u,g,$),X=O.getHeightAtTileCoord(q,H);X&&X.height!==void 0&&(X.hidden?x=X.height:S=Math.max(X.height*U,S||0))}if(S!==void 0)return S;for(let E=0;E<this.layers.length;++E){const R=this.layers[E];if(R.layer.type!=="model"||!R.visible)continue;const{bucket:O,tileID:$}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:U,tileY:q}=this._mapCoordToOverlappingTile(a,u,g,$),H=O.getHeightAtTileCoord(U,q);if(H&&!H.hidden)return H.height===void 0&&x!==void 0?Math.min(H.maxHeight,x)*H.verticalScale:H.height?H.height*H.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function No(m,a){const u={};for(const g in m)g!=="ref"&&(u[g]=m[g]);return o.bw.forEach(g=>{g in a&&(u[g]=a[g])}),u}function bo(m){m=m.slice();const a=Object.create(null);for(let u=0;u<m.length;u++)a[m[u].id]=m[u];for(let u=0;u<m.length;u++)"ref"in m[u]&&(m[u]=No(m[u],a[m[u].ref]));return m}const ci={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Zu(m,a,u){u.push({command:ci.addSource,args:[m,a[m]]})}function iu(m,a,u){a.push({command:ci.removeSource,args:[m]}),u[m]=!0}function Yl(m,a,u,g){iu(m,u,g),Zu(m,a,u)}function i_(m,a,u){let g;for(g in m[u])if(m[u].hasOwnProperty(g)&&g!=="data"&&!o.bx(m[u][g],a[u][g]))return!1;for(g in a[u])if(a[u].hasOwnProperty(g)&&g!=="data"&&!o.bx(m[u][g],a[u][g]))return!1;return!0}function Ef(m,a,u,g,x,S){let E;for(E in a=a||{},m=m||{})m.hasOwnProperty(E)&&(o.bx(m[E],a[E])||u.push({command:S,args:[g,E,a[E],x]}));for(E in a)a.hasOwnProperty(E)&&!m.hasOwnProperty(E)&&(o.bx(m[E],a[E])||u.push({command:S,args:[g,E,a[E],x]}))}function Tf(m){return m.id}function If(m,a){return m[a.id]=a,m}function Yu(m,a,u){const g=a.createTileMatrix(m,m.worldSize,u.toUnwrapped());return o.aB(new Float32Array(16),m.projMatrix,g)}function gb(m,a,u){if(a.projection.name===u.projection.name)return m.projMatrix;const g=u.clone();return g.setProjection(a.projection),Yu(g,a.getProjection(),m)}function cm(m,a,u){return a.name===u.projection.name?m.projMatrix:Yu(u,a,m)}class ZE{constructor(a,u){this.reset(a,u)}reset(a,u){this.points=a||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=o.aA(a,0,1);let u=1,g=this._distances[u];const x=a*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const S=u-1,E=this._distances[S],R=g-E,O=R>0?(x-E)/R:0;return this.points[S].mult(1-O).add(this.points[u].mult(O))}}class Pf{constructor(a,u,g){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(a/g),this.yCellCount=Math.ceil(u/g);for(let E=0;E<this.xCellCount*this.yCellCount;E++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=u,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,u,g,x,S){this._forEachCell(u,g,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(a,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(a,u,g,x,S,E){this.boxCells[S].push(E)}_insertCircleCell(a,u,g,x,S,E){this.circleCells[S].push(E)}_query(a,u,g,x,S,E){if(g<0||a>this.width||x<0||u>this.height)return!S&&[];const R=[];if(a<=0&&u<=0&&this.width<=g&&this.height<=x){if(S)return!0;for(let O=0;O<this.boxKeys.length;O++)R.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const $=this.circles[3*O],U=this.circles[3*O+1],q=this.circles[3*O+2];R.push({key:this.circleKeys[O],x1:$-q,y1:U-q,x2:$+q,y2:U+q})}return E?R.filter(E):R}return this._forEachCell(a,u,g,x,this._queryCell,R,{hitTest:S,seenUids:{box:{},circle:{}}},E),S?R.length>0:R}_queryCircle(a,u,g,x,S){const E=a-g,R=a+g,O=u-g,$=u+g;if(R<0||E>this.width||$<0||O>this.height)return!x&&[];const U=[];return this._forEachCell(E,O,R,$,this._queryCellCircle,U,{hitTest:x,circle:{x:a,y:u,radius:g},seenUids:{box:{},circle:{}}},S),x?U.length>0:U}query(a,u,g,x,S){return this._query(a,u,g,x,!1,S)}hitTest(a,u,g,x,S){return this._query(a,u,g,x,!0,S)}hitTestCircle(a,u,g,x){return this._queryCircle(a,u,g,!0,x)}_queryCell(a,u,g,x,S,E,R,O){const $=R.seenUids,U=this.boxCells[S];if(U!==null){const H=this.bboxes;for(const X of U)if(!$.box[X]){$.box[X]=!0;const Q=4*X;if(a<=H[Q+2]&&u<=H[Q+3]&&g>=H[Q+0]&&x>=H[Q+1]&&(!O||O(this.boxKeys[X]))){if(R.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[X],x1:H[Q],y1:H[Q+1],x2:H[Q+2],y2:H[Q+3]})}}}const q=this.circleCells[S];if(q!==null){const H=this.circles;for(const X of q)if(!$.circle[X]){$.circle[X]=!0;const Q=3*X;if(this._circleAndRectCollide(H[Q],H[Q+1],H[Q+2],a,u,g,x)&&(!O||O(this.circleKeys[X]))){if(R.hitTest)return E.push(!0),!0;{const ae=H[Q],ue=H[Q+1],ce=H[Q+2];E.push({key:this.circleKeys[X],x1:ae-ce,y1:ue-ce,x2:ae+ce,y2:ue+ce})}}}}}_queryCellCircle(a,u,g,x,S,E,R,O){const $=R.circle,U=R.seenUids,q=this.boxCells[S];if(q!==null){const X=this.bboxes;for(const Q of q)if(!U.box[Q]){U.box[Q]=!0;const ae=4*Q;if(this._circleAndRectCollide($.x,$.y,$.radius,X[ae+0],X[ae+1],X[ae+2],X[ae+3])&&(!O||O(this.boxKeys[Q])))return E.push(!0),!0}}const H=this.circleCells[S];if(H!==null){const X=this.circles;for(const Q of H)if(!U.circle[Q]){U.circle[Q]=!0;const ae=3*Q;if(this._circlesCollide(X[ae],X[ae+1],X[ae+2],$.x,$.y,$.radius)&&(!O||O(this.circleKeys[Q])))return E.push(!0),!0}}}_forEachCell(a,u,g,x,S,E,R,O){const $=this._convertToXCellCoord(a),U=this._convertToYCellCoord(u),q=this._convertToXCellCoord(g),H=this._convertToYCellCoord(x);for(let X=$;X<=q;X++)for(let Q=U;Q<=H;Q++)if(S.call(this,a,u,g,x,this.xCellCount*Q+X,E,R,O))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,u,g,x,S,E){const R=x-a,O=S-u,$=g+E;return $*$>R*R+O*O}_circleAndRectCollide(a,u,g,x,S,E,R){const O=(E-x)/2,$=Math.abs(a-(x+O));if($>O+g)return!1;const U=(R-S)/2,q=Math.abs(u-(S+U));if(q>U+g)return!1;if($<=O||q<=U)return!0;const H=$-O,X=q-U;return H*H+X*X<=g*g}}const Hs={unknown:0,flipRequired:1,flipNotRequired:2},Mf=Math.tan(85*Math.PI/180);function jd(m,a,u,g,x,S,E){const R=o.bB();if(u)if(S.name==="globe"){const O=o.bC(x,a);o.aB(R,R,O)}else{const O=o.bD([],E);R[0]=O[0],R[1]=O[1],R[4]=O[2],R[5]=O[3],g||o.bA(R,R,x.angle)}else o.aB(R,x.labelPlaneMatrix,m);return R}function Rf(m,a,u,g,x,S,E){const R=jd(m,a,u,g,x,S,E);return S.name==="globe"&&u||(R[2]=R[6]=R[10]=R[14]=0),R}function xc(m,a,u,g,x,S,E){if(u){if(S.name==="globe"){const R=jd(m,a,u,g,x,S,E);return o.bk(R,R),o.aB(R,m,R),R}{const R=o.by(m),O=o.bz([]);return O[0]=E[0],O[1]=E[1],O[4]=E[2],O[5]=E[3],o.aB(R,R,O),g||o.bA(R,R,-x.angle),R}}return x.glCoordMatrix}function la(m,a,u,g){const x=[m,a,u,1];u?o.aC(x,x,g):fl(x,x,g);const S=x[3];return x[0]/=S,x[1]/=S,x[2]/=S,x}function o_(m,a){return Math.min(.5+m/a*.5,1.5)}function a_(m,a){const u=m[0]/m[3],g=m[1]/m[3];return u>=-a[0]&&u<=a[0]&&g>=-a[1]&&g<=a[1]}function s_(m,a,u,g,x,S,E,R,O,$,U=1){const q=u.transform,H=g?m.textSizeData:m.iconSizeData,X=o.bJ(H,u.transform.zoom,U),Q=q.projection.name==="globe",ae=[256/u.width*2+1,256/u.height*2+1],ue=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ue.clear();let ce=null;Q&&(ce=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const pe=m.lineVertexArray,Ce=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,ve=u.transform.width/u.transform.height;let Fe,Ie=!1;for(let $e=0;$e<Ce.length;$e++){const Le=Ce.get($e),{numGlyphs:Me,writingMode:Ve}=Le;if(Ve!==o.bK.vertical||Ie||Fe===o.bK.horizontal||(Ie=!0),Fe=Ve,(Le.hidden||Ve===o.bK.vertical)&&!Ie){bc(Me,ue);continue}Ie=!1;const st=new o.P(Le.tileAnchorX,Le.tileAnchorY),nt=m.elevationType==="road",Et=!!q.elevation||nt;let{x:mt,y:Lt,z:ln}=q.projection.projectTilePoint(st.x,st.y,$.canonical),ht=null;if(Et){const Rn=nt?m.getElevationFeatureForText($e):null;ht={getElevation:O,elevation:q.elevation,elevationFeature:Rn};const[cr,Yr,ui]=O(st,q.elevation,Rn);mt+=cr,Lt+=Yr,ln+=ui}const Qe=[mt,Lt,ln,1];if(o.aC(Qe,Qe,a),!a_(Qe,ae)){bc(Me,ue);continue}const kt=Qe[3],gt=o_(u.transform.getCameraToCenterDistance(q.projection),kt),Kt=o.bL(H,X,Le),pn=E?Kt/gt:Kt*gt,Nn=la(mt,Lt,ln,x);if(Nn[3]<=0){bc(Me,ue);continue}let an={};const dn=o.an(m.layers[0].layout.get("text-max-angle")),jn=Math.cos(dn),Mn=E?null:ht,wn=vb(Le,pn,!1,R,a,x,S,m.glyphOffsetArray,pe,ue,ce,Nn,st,an,ve,Mn,q.projection,$,E,jn);Ie=wn.useVertical,Mn&&wn.needsFlipping&&(an={}),(wn.notEnoughRoom||Ie||wn.needsFlipping&&vb(Le,pn,!0,R,a,x,S,m.glyphOffsetArray,pe,ue,ce,Nn,st,an,ve,Mn,q.projection,$,E,jn).notEnoughRoom)&&bc(Me,ue)}g?(m.text.dynamicLayoutVertexBuffer.updateData(ue),ce&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(ce)):(m.icon.dynamicLayoutVertexBuffer.updateData(ue),ce&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(ce))}function Mi(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue){const{lineStartIndex:ce,glyphStartIndex:pe,segment:Ce}=R,ve=pe+R.numGlyphs,Fe=ce+R.lineLength,Ie=a.getoffsetX(pe),$e=a.getoffsetX(ve-1),Le=Af(m*Ie,u,g,x,S,E,Ce,ce,Fe,O,$,U,q,H,!0,X,Q,ae,ue);if(!Le)return null;const Me=Af(m*$e,u,g,x,S,E,Ce,ce,Fe,O,$,U,q,H,!0,X,Q,ae,ue);return Me?{first:Le,last:Me}:null}function l_(m,a,u,g){return m===o.bK.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:m===o.bK.vertical?g>0?{needsFlipping:!0}:null:a!==Hs.unknown&&function(x,S){return x===0||Math.abs(S/x)>Mf}(u,g)?a===Hs.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function vb(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe,Ce){const ve=a/24,Fe=m.lineOffsetX*ve,Ie=m.lineOffsetY*ve,{lineStartIndex:$e,glyphStartIndex:Le,numGlyphs:Me,segment:Ve,writingMode:st,flipState:nt}=m,Et=$e+m.lineLength,mt=Lt=>{if(U){const[kt,gt,Kt]=Lt.up,pn=$.length;o.bM(U,pn+0,kt,gt,Kt),o.bM(U,pn+1,kt,gt,Kt),o.bM(U,pn+2,kt,gt,Kt),o.bM(U,pn+3,kt,gt,Kt)}const[ln,ht,Qe]=Lt.point;o.bN($,ln,ht,Qe,Lt.angle)};if(Me>1){const Lt=Mi(ve,R,Fe,Ie,u,q,H,m,O,S,X,ae,!1,ue,ce,pe,Ce);if(!Lt)return{notEnoughRoom:!0};if(g&&!u){let[ln,ht,Qe]=Lt.first.point,[kt,gt,Kt]=Lt.last.point;[ln,ht]=la(ln,ht,Qe,E),[kt,gt]=la(kt,gt,Kt,E);const pn=l_(st,nt,(kt-ln)*Q,gt-ht);if(m.flipState=pn&&pn.needsFlipping?Hs.flipRequired:Hs.flipNotRequired,pn)return pn}mt(Lt.first);for(let ln=Le+1;ln<Le+Me-1;ln++){const ht=Af(ve*R.getoffsetX(ln),Fe,Ie,u,q,H,Ve,$e,Et,O,S,X,ae,!1,!1,ue,ce,pe,Ce);if(!ht)return $.length-=4*(ln-Le),{notEnoughRoom:!0};mt(ht)}mt(Lt.last)}else{if(g&&!u){const ln=la(H.x,H.y,0,x),ht=$e+Ve+1,Qe=new o.P(O.getx(ht),O.gety(ht)),kt=la(Qe.x,Qe.y,0,x),gt=kt[3]>0?kt:vr(H,Qe,ln,1,x,void 0,ue,ce.canonical),Kt=l_(st,nt,(gt[0]-ln[0])*Q,gt[1]-ln[1]);if(m.flipState=Kt&&Kt.needsFlipping?Hs.flipRequired:Hs.flipNotRequired,Kt)return Kt}const Lt=Af(ve*R.getoffsetX(Le),Fe,Ie,u,q,H,Ve,$e,Et,O,S,X,ae,!1,!1,ue,ce,pe,Ce);if(!Lt)return{notEnoughRoom:!0};mt(Lt)}return{}}function _b(m,a,u,g,x){const{x:S,y:E,z:R}=g.projectTilePoint(m.x,m.y,a);if(!x)return la(S,E,R,u);const[O,$,U]=x.getElevation(m,x.elevation,x.elevationFeature);return la(S+O,E+$,R+U,u)}function vr(m,a,u,g,x,S,E,R){const O=_b(m.sub(a)._unit()._add(m),R,x,E,S);return o.av(O,u,O),o.aw(O,O),o.bG(O,u,O,g)}function Af(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe){const Ce=g?m-a:m+a;let ve=Ce>0?1:-1,Fe=0;g&&(ve*=-1,Fe=Math.PI),ve<0&&(Fe+=Math.PI);let Ie=R+E+(ve>0?0:1)|0,$e=x,Le=x,Me=0,Ve=0;const st=Math.abs(Ce),nt=[],Et=[];let mt=S,Lt=mt,ln=o.bE([]);const ht=()=>vr(Lt,mt,Le,st-Me+1,U,H,ae,ue.canonical);for(;Me+Ve<=st;){if(Ie+=ve,Ie<R||Ie>=O)return null;if(Le=$e,Lt=mt,nt.push(Le),X&&Et.push(Lt),mt=new o.P($.getx(Ie),$.gety(Ie)),$e=q[Ie],!$e){const Mn=_b(mt,ue.canonical,U,ae,H);$e=Mn[3]>0?q[Ie]=Mn:ht()}Me+=Ve;const dn=o.av([],$e,Le),jn=o.bF(Le,$e);if(u&&jn>0&&Ve>0&&o.bI(ln,dn)/(Ve*jn)<pe)return null;Ve=jn,ln=dn}Q&&H&&(q[Ie]&&($e=ht(),Ve=o.bF(Le,$e),ln=o.av([],$e,Le)),q[Ie]=$e);const Qe=(st-Me)/Ve,kt=mt.sub(Lt)._mult(Qe)._add(Lt),gt=o.bG([],Le,ln,Qe);let Kt=[0,0,1],pn=ln[0],Nn=ln[1];if(ce&&(Kt=ae.upVector(ue.canonical,kt.x,kt.y),Kt[0]!==0||Kt[1]!==0||Kt[2]!==1)){const dn=[Kt[2],0,-Kt[0]],jn=o.bH([],Kt,dn);o.aw(dn,dn),o.aw(jn,jn),pn=o.bI(ln,dn),Nn=o.bI(ln,jn)}if(u){const dn=o.bH([],Kt,ln);o.aw(dn,dn),o.bG(gt,gt,dn,u*ve)}const an=Fe+Math.atan2(Nn,pn);return nt.push(gt),X&&Et.push(kt),{point:gt,angle:an,path:nt,tilePath:Et,up:Kt}}function bc(m,a){const u=a.length,g=u+4*m;a.resize(g),a.float32.fill(-1/0,4*u,4*g)}function fl(m,a,u){const g=a[0],x=a[1];return m[0]=u[0]*g+u[4]*x+u[12],m[1]=u[1]*g+u[5]*x+u[13],m[3]=u[3]*g+u[7]*x+u[15],m}const pl=100;class Vd{constructor(a,u,g=new Pf(a.width+200,a.height+200,25),x=new Pf(a.width+200,a.height+200,25)){this.transform=a,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+pl,this.screenBottomBoundary=a.height+pl,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=u}placeCollisionBox(a,u,g,x,S,E,R,O,$,U,q){let H=g.projectedAnchorX,X=g.projectedAnchorY,Q=g.projectedAnchorZ;const ae=g.tileAnchorX,ue=g.tileAnchorY,ce=g.elevation,pe=g.tileID,Ce=a.getProjection();if(ce&&pe){const[Et,mt,Lt]=Ce.upVector(pe.canonical,g.tileAnchorX,g.tileAnchorY),ln=Ce.upVectorScale(pe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Et*ce*ln,X+=mt*ce*ln,Q+=Lt*ce*ln}const ve=a.projection.name==="globe",Fe=a.projection.name==="globe"?o.aj(this.transform.zoom):0;if(pe&&ve&&Fe<1&&!E){const Et=1<<pe.canonical.z,mt=o.bO(ae,ue);o.bP(mt,mt,1/o.al),o.bQ(mt,mt,o.bO(pe.canonical.x,pe.canonical.y)),o.bP(mt,mt,1/Et),o.bR(mt,mt,o.bO(x[0],x[1])),mt[0]=o.bS(mt[0],-.5,.5),o.bP(mt,mt,o.al);const Lt=o.bT(mt[0],mt[1],o.al/(2*Math.PI),1);o.aC(Lt,Lt,S),H=o.ak(H,Lt[0],Fe),X=o.ak(X,Lt[1],Fe),Q=o.ak(Q,Lt[2],Fe)}const Ie=this.projectAndGetPerspectiveRatio(U,H,X,Q,g.tileID,Ce.name==="globe"||!!ce||this.transform.pitch>0,Ce),$e=$*Ie.perspectiveRatio,Le=(g.x1*u+R.x-g.padding)*$e+Ie.point.x,Me=(g.y1*u+R.y-g.padding)*$e+Ie.point.y,Ve=(g.x2*u+R.x+g.padding)*$e+Ie.point.x,st=(g.y2*u+R.y+g.padding)*$e+Ie.point.y,nt=Ie.perspectiveRatio<=.55||Ie.occluded;return!this.isInsideGrid(Le,Me,Ve,st)||!O&&this.grid.hitTest(Le,Me,Ve,st,q)||nt?{box:[],offscreen:!1,occluded:Ie.occluded}:{box:[Le,Me,Ve,st],offscreen:this.isOffscreen(Le,Me,Ve,st),occluded:!1}}placeCollisionCircles(a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue){const ce=[],pe=this.transform.elevation,Ce=a.getProjection(),ve=a.elevationType==="road",Fe=!!pe||ve,Ie=o.bU.getAtTileOffsetFunc(ue,this.transform.center.lat,this.transform.worldSize,Ce),$e=new o.P(g.tileAnchorX,g.tileAnchorY),Le=new o.P(g.tileAnchorX,g.tileAnchorY);let{x:Me,y:Ve,z:st}=Ce.projectTilePoint(Le.x,Le.y,ue.canonical),nt=null;if(Fe){const jn=ve?a.getElevationFeatureForText(x):null;nt={getElevation:Ie,elevation:pe,elevationFeature:jn};const[Mn,wn,Rn]=Ie($e,pe,jn);Me+=Mn,Ve+=wn,st+=Rn}const Et=Ce.name==="globe",mt=this.projectAndGetPerspectiveRatio(O,Me,Ve,st,ue,Et||!!pe||this.transform.pitch>0,Ce),{perspectiveRatio:Lt}=mt,ln=(H?R/Lt:R*Lt)/o.bX,ht=la(Me,Ve,st,$),Qe=g.lineOffsetX*ln,kt=g.lineOffsetY*ln,gt=o.an(a.layers[0].layout.get("text-max-angle")),Kt=Math.cos(gt),pn=mt.signedDistanceFromCamera>0?Mi(ln,E,Qe,kt,ve&&g.flipState===1,ht,Le,g,S,$,{},Fe&&!H?nt:null,H&&Fe,Ce,ue,H,Kt):null;let Nn=!1,an=!1,dn=!0;if(pn&&!mt.occluded){const jn=.5*Q*Lt+ae,Mn=new o.P(-100,-100),wn=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Rn=new ZE,{first:cr,last:Yr}=pn,ui=cr.path.length;let zi=[];for(let kr=ui-1;kr>=1;kr--)zi.push(cr.path[kr]);for(let kr=1;kr<Yr.path.length;kr++)zi.push(Yr.path[kr]);const br=2.5*jn;U&&(zi=zi.map(([kr,Oi,di],Vi)=>(Fe&&!Et&&(di=Ie(Vi<ui-1?cr.tilePath[ui-1-Vi]:Yr.tilePath[Vi-ui+2],pe,nt.elevationFeature)[2]),la(kr,Oi,di,U))),zi.some(kr=>kr[3]<=0)&&(zi=[]));let ai=[];if(zi.length>0){let kr=1/0,Oi=-1/0,di=1/0,Vi=-1/0;for(const vi of zi)kr=Math.min(kr,vi[0]),di=Math.min(di,vi[1]),Oi=Math.max(Oi,vi[0]),Vi=Math.max(Vi,vi[1]);Oi>=Mn.x&&kr<=wn.x&&Vi>=Mn.y&&di<=wn.y&&(ai=[zi.map(vi=>new o.P(vi[0],vi[1]))],(kr<Mn.x||Oi>wn.x||di<Mn.y||Vi>wn.y)&&(ai=o.bV(ai,Mn.x,Mn.y,wn.x,wn.y)))}for(const kr of ai){Rn.reset(kr,.25*jn);let Oi=0;Oi=Rn.length<=.5*jn?1:Math.ceil(Rn.paddedLength/br)+1;for(let di=0;di<Oi;di++){const Vi=di/Math.max(Oi-1,1),vi=Rn.lerp(Vi),Fr=vi.x+pl,Ei=vi.y+pl;ce.push(Fr,Ei,jn,0);const Ur=Fr-jn,Ki=Ei-jn,Pi=Fr+jn,Sr=Ei+jn;if(dn=dn&&this.isOffscreen(Ur,Ki,Pi,Sr),an=an||this.isInsideGrid(Ur,Ki,Pi,Sr),!u&&this.grid.hitTestCircle(Fr,Ei,jn,X)&&(Nn=!0,!q))return{circles:[],offscreen:!1,collisionDetected:Nn,occluded:!1}}}}return{circles:!q&&Nn||!an?[]:ce,offscreen:dn,collisionDetected:Nn,occluded:mt.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,x=1/0,S=-1/0,E=-1/0;for(const U of a){const q=new o.P(U.x+pl,U.y+pl);g=Math.min(g,q.x),x=Math.min(x,q.y),S=Math.max(S,q.x),E=Math.max(E,q.y),u.push(q)}const R=this.grid.query(g,x,S,E).concat(this.ignoredGrid.query(g,x,S,E)),O={},$={};for(const U of R){const q=U.key;if(O[q.bucketInstanceId]===void 0&&(O[q.bucketInstanceId]={}),O[q.bucketInstanceId][q.featureIndex])continue;const H=[new o.P(U.x1,U.y1),new o.P(U.x2,U.y1),new o.P(U.x2,U.y2),new o.P(U.x1,U.y2)];o.bW(u,H)&&(O[q.bucketInstanceId][q.featureIndex]=!0,$[q.bucketInstanceId]===void 0&&($[q.bucketInstanceId]=[]),$[q.bucketInstanceId].push(q.featureIndex))}return $}insertCollisionBox(a,u,g,x,S){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:S},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,u,g,x,S){const E=u?this.ignoredGrid:this.grid,R={bucketInstanceId:g,featureIndex:x,collisionGroupID:S};for(let O=0;O<a.length;O+=4)E.insertCircle(R,a[O],a[O+1],a[O+2])}projectAndGetPerspectiveRatio(a,u,g,x,S,E,R){const O=[u,g,x,1];let $=!1;x||this.transform.pitch>0?(o.aC(O,O,a),this.fogState&&S&&R.name!=="globe"&&($=function(H,X,Q,ae,ue,ce){const pe=ce.calculateFogTileMatrix(ue),Ce=[X,Q,ae];return o.af(Ce,Ce,pe),zt(H,o.ag(Ce),ce.pitch,ce._fov)}(this.fogState,u,g,x,S.toUnwrapped(),this.transform)>.9)):fl(O,O,a);const U=O[3];return{point:new o.P((O[0]/U+1)/2*this.transform.width+pl,(-O[1]/U+1)/2*this.transform.height+pl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/U*.5,1.5),signedDistanceFromCamera:U,occluded:E&&O[2]>U||$}}isOffscreen(a,u,g,x){return g<pl||a>=this.screenRightBoundary||x<pl||u>this.screenBottomBoundary}isInsideGrid(a,u,g,x){return g>=0&&a<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const a=o.bz([]);return o.bq(a,a,[-100,-100,0]),a}}class Yn{constructor(a,u,g,x){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class gi{constructor(a,u,g,x,S,E=!1){this.text=new Yn(a?a.text:null,u,g,S),this.icon=new Yn(a?a.icon:null,u,x,S),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ii{constructor(a,u,g,x=!1){this.text=a,this.icon=u,this.skipFade=g,this.clipped=x}}class Cs{constructor(){this.invProjMatrix=o.bB(),this.viewportMatrix=o.bB(),this.circles=[]}}class Ud{constructor(a,u,g,x,S){this.bucketInstanceId=a,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=S}}class Ai{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const u=++this.maxGroupID;this.collisionGroups[a]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[a]}}function Of(m,a,u,g,x){const{horizontalAlign:S,verticalAlign:E}=o.c0(m),R=-(S-.5)*a,O=-(E-.5)*u,$=o.c1(m,g);return new o.P(R+$[0]*x,O+$[1]*x)}function Ju(m,a,u,g,x){const S=new o.P(m,a);return u&&S._rotate(g?x:-x),S}class Df{constructor(a,u,g,x,S,E){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new Vd(this.transform,S),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ai(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,u,g,x,S=1){const E=g.getBucket(u),R=g.latestFeatureIndex;if(!E||!R||u.fqid!==E.layerIds[0])return;const O=E.layers[0].layout,$=E.layers[0].paint,U=g.collisionBoxArray,q=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),H=g.tileSize/o.al,X=g.tileID.toUnwrapped();this.transform.setProjection(E.projection);const Q=(ae=g.tileID,ue=E.getProjection(),ce=this.transform,ue.name===this.projection?ce.calculateProjMatrix(ae.toUnwrapped()):Yu(ce,ue,ae));var ae,ue,ce;const pe=O.get("text-pitch-alignment")==="map",Ce=O.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const ve=u.dynamicFilter(),Fe=u.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(g),$e=Rf(Q,g.tileID.canonical,pe,Ce,this.transform,E.getProjection(),Ie);let Le=null;const Me=E.getProjection().createInversionMatrix(this.transform,g.tileID.canonical);if(pe){const Qe=xc(Q,g.tileID.canonical,pe,Ce,this.transform,E.getProjection(),Ie);Le=o.aB([],this.transform.labelPlaneMatrix,Qe)}let Ve=null;ve&&g.latestFeatureIndex&&(Ve={unwrappedTileID:X,dynamicFilter:ve,dynamicFilterNeedsFeature:Fe}),this.retainedQueryData[E.bucketInstanceId]=new Ud(E.bucketInstanceId,R,E.sourceLayerIndex,E.index,g.tileID);const[st,nt]=E.layers[0].layout.get("text-size-scale-range"),Et=o.aA(S,st,nt),[mt,Lt]=O.get("icon-size-scale-range"),ln=o.aA(S,mt,Lt),ht={bucket:E,layout:O,paint:$,posMatrix:Q,invMatrix:Me,mercatorCenter:[o.aF(this.transform.center.lng),o.aJ(this.transform.center.lat)],textLabelPlaneMatrix:$e,labelToScreenMatrix:Le,clippingData:Ve,scale:q,textPixelRatio:H,holdingForFade:g.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:o.bJ(E.textSizeData,this.transform.zoom,Et),partiallyEvaluatedIconSize:o.bJ(E.iconSizeData,this.transform.zoom,ln),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(x)for(const Qe of E.sortKeyRanges){const{sortKey:kt,symbolInstanceStart:gt,symbolInstanceEnd:Kt}=Qe;a.push({sortKey:kt,symbolInstanceStart:gt,symbolInstanceEnd:Kt,parameters:ht})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:ht})}attemptAnchorPlacement(a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe,Ce,ve,Fe){const{textOffset0:Ie,textOffset1:$e,crossTileID:Le}=ae,Me=[Ie,$e],Ve=Of(a,E,R,Me,O),st=this.collisionIndex.placeCollisionBox(ce,O,u,g,x,S,Ju(Ve.x,Ve.y,$,U,this.transform.angle),Q,q,H,X.predicate);if(Ce){const nt=ce.getSymbolInstanceIconSize(Fe,this.transform.zoom,ae.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,nt,Ce,g,x,S,Ju(Ve.x,Ve.y,$,U,this.transform.angle),Q,q,H,X.predicate).box.length===0)return}if(st.box.length>0){let nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Le]&&this.prevPlacement.placements[Le]&&this.prevPlacement.placements[Le].text&&(nt=this.prevPlacement.variableOffsets[Le].anchor),this.variableOffsets[Le]={textOffset:Me,width:E,height:R,anchor:a,textScale:O,prevAnchor:nt},this.markUsedJustification(ce,a,ae,pe),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,pe,ae),this.placedOrientations[Le]=pe),{shift:Ve,placedGlyphBoxes:st}}}placeLayerBucketPart(a,u,g,x,S=1){const{bucket:E,layout:R,paint:O,posMatrix:$,textLabelPlaneMatrix:U,labelToScreenMatrix:q,clippingData:H,textPixelRatio:X,mercatorCenter:Q,invMatrix:ae,holdingForFade:ue,collisionBoxArray:ce,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:Ce,collisionGroup:ve,latestFeatureIndex:Fe}=a.parameters,Ie=R.get("text-optional"),$e=R.get("icon-optional"),Le=R.get("text-allow-overlap"),Me=R.get("icon-allow-overlap"),Ve=R.get("text-rotation-alignment")==="map",st=R.get("icon-rotation-alignment")==="map",nt=R.get("text-pitch-alignment")==="map",Et=O.get("symbol-z-offset"),mt=R.get("symbol-elevation-reference")==="sea",Lt=R.get("symbol-placement"),[ln,ht]=R.get("text-size-scale-range"),[Qe,kt]=R.get("icon-size-scale-range"),gt=o.aA(S,ln,ht),Kt=o.aA(S,Qe,kt),pn=R.get("text-variable-anchor"),Nn=Ve&&Lt!=="point",an=st&&Lt!=="point",dn=pn&&E.hasTextData(),jn=E.hasIconTextFit()&&dn&&E.hasIconData();this.transform.setProjection(E.projection);const Mn=dn||Nn,wn=an||jn;let Rn=Le&&(Me||!E.hasIconData()||$e),cr=Me&&(Le||!E.hasTextData()||Ie);const Yr=!Et.isConstant();!E.collisionArrays&&ce&&E.deserializeCollisionBoxes(ce),g&&x&&E.updateCollisionDebugBuffers(this.transform.zoom,ce,gt,Kt);const ui=(br,ai,kr)=>{const{crossTileID:Oi,numVerticalGlyphVertices:di}=br;let Vi=null;if(H&&H.dynamicFilterNeedsFeature||Yr){const go=this.retainedQueryData[E.bucketInstanceId];Vi=Fe.loadFeature({featureIndex:br.featureIndex,bucketIndex:go.bucketIndex,sourceLayerIndex:go.sourceLayerIndex,layoutVertexArrayOffset:0})}if(H&&!(0,H.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch,worldview:E.worldview},Vi,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new o.P(br.tileAnchorX,br.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[Oi]=new Ii(!1,!1,!1,!0),void u.add(Oi);const vi=Et.evaluate(Vi,{});if(u.has(Oi))return;if(ue)return void(this.placements[Oi]=new Ii(!1,!1,!1));let Fr=!1,Ei=!1,Ur=!0,Ki=!1,Pi=!1,Sr=null,fi={box:null,offscreen:null,occluded:null},ao={box:null},Ro=null,mo=null,So=null,ys=0,ls=0,ka=0;kr.textFeatureIndex?ys=kr.textFeatureIndex:br.useRuntimeCollisionCircles&&(ys=br.featureIndex),kr.verticalTextFeatureIndex&&(ls=kr.verticalTextFeatureIndex);const Ha=E.elevationFeatures?E.elevationFeatures[br.elevationFeatureIndex]:void 0,Xs=go=>{go.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Ao=this.transform.elevation;go.elevation=mt?vi:vi+o.bU.getAtTileOffset(go.tileID,new o.P(go.tileAnchorX,go.tileAnchorY),Ao,Ha),go.elevation+=br.zOffset},Fa=kr.textBox;if(Fa){Xs(Fa);const go=$i=>{let zo=o.bK.horizontal;if(E.allowVerticalPlacement&&!$i&&this.prevPlacement){const wa=this.prevPlacement.placedOrientations[Oi];wa&&(this.placedOrientations[Oi]=wa,zo=wa,this.markUsedOrientation(E,zo,br))}return zo},Ao=($i,zo)=>{if(E.allowVerticalPlacement&&di>0&&kr.verticalTextBox){for(const wa of E.writingModes)if(wa===o.bK.vertical?(fi=zo(),ao=fi):fi=$i(),fi&&fi.box&&fi.box.length)break}else fi=$i()};if(pn){let $i=pn;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Oi]){const vo=this.prevPlacement.variableOffsets[Oi];$i.indexOf(vo.anchor)>0&&($i=$i.filter(Ys=>Ys!==vo.anchor),$i.unshift(vo.anchor))}const zo=(vo,Ys,xh)=>{const Ac=E.getSymbolInstanceTextSize(pe,br,this.transform.zoom,ai),bh=(vo.x2-vo.x1)*Ac+2*vo.padding,wh=(vo.y2-vo.y1)*Ac+2*vo.padding,Js=br.hasIconTextFit&&!Me?Ys:null;Js&&Xs(Js);let rc={box:[],offscreen:!1,occluded:!1};const pa=Le?2*$i.length:$i.length;for(let Qs=0;Qs<pa;++Qs){const hd=this.attemptAnchorPlacement($i[Qs%$i.length],vo,Q,ae,Mn,bh,wh,Ac,Ve,nt,X,$,ve,Qs>=$i.length,br,ai,E,xh,Js,pe,Ce);if(hd&&(rc=hd.placedGlyphBoxes,rc&&rc.box&&rc.box.length)){Fr=!0,Sr=hd.shift;break}}return rc};Ao(()=>zo(Fa,kr.iconBox,o.bK.horizontal),()=>{const vo=kr.verticalTextBox;return vo&&Xs(vo),E.allowVerticalPlacement&&!(fi&&fi.box&&fi.box.length)&&di>0&&vo?zo(vo,kr.verticalIconBox,o.bK.vertical):{box:null,offscreen:null,occluded:null}}),fi&&(Fr=fi.box,Ur=fi.offscreen,Ki=fi.occluded);const wa=go(!(!fi||!fi.box));if(!Fr&&this.prevPlacement){const vo=this.prevPlacement.variableOffsets[Oi];vo&&(this.variableOffsets[Oi]=vo,this.markUsedJustification(E,vo.anchor,br,wa))}}else{const $i=(zo,wa)=>{const vo=E.getSymbolInstanceTextSize(pe,br,this.transform.zoom,ai),Ys=this.collisionIndex.placeCollisionBox(E,vo,zo,Q,ae,Mn,new o.P(0,0),Le,X,$,ve.predicate);return Ys&&Ys.box&&Ys.box.length&&(this.markUsedOrientation(E,wa,br),this.placedOrientations[Oi]=wa),Ys};Ao(()=>$i(Fa,o.bK.horizontal),()=>{const zo=kr.verticalTextBox;return E.allowVerticalPlacement&&di>0&&zo?(Xs(zo),$i(zo,o.bK.vertical)):{box:null,offscreen:null,occluded:null}}),go(!!(fi&&fi.box&&fi.box.length))}}if(Ro=fi,Fr=Ro&&Ro.box&&Ro.box.length>0,Ur=Ro&&Ro.offscreen,Ki=Ro&&Ro.occluded,br.useRuntimeCollisionCircles){const go=br.centerJustifiedTextSymbolIndex>=0?br.centerJustifiedTextSymbolIndex:br.verticalPlacedTextSymbolIndex,Ao=E.text.placedSymbolArray.get(go),$i=o.bL(E.textSizeData,pe,Ao),zo=R.get("text-padding");mo=this.collisionIndex.placeCollisionCircles(E,Le,Ao,go,E.lineVertexArray,E.glyphOffsetArray,$i,$,U,q,g,nt,ve.predicate,br.collisionCircleDiameter*$i/o.bX,zo,this.retainedQueryData[E.bucketInstanceId].tileID),Fr=Le||mo.circles.length>0&&!mo.collisionDetected,Ur=Ur&&mo.offscreen,Ki=mo.occluded}if(kr.iconFeatureIndex&&(ka=kr.iconFeatureIndex),kr.iconBox){const go=Ao=>{Xs(Ao);const $i=br.hasIconTextFit&&Sr?Ju(Sr.x,Sr.y,Ve,nt,this.transform.angle):new o.P(0,0),zo=E.getSymbolInstanceIconSize(Ce,this.transform.zoom,br.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,zo,Ao,Q,ae,wn,$i,Me,X,$,ve.predicate)};ao&&ao.box&&ao.box.length&&kr.verticalIconBox?(So=go(kr.verticalIconBox),Ei=So.box.length>0):(So=go(kr.iconBox),Ei=So.box.length>0),Ur=Ur&&So.offscreen,Pi=So.occluded}const Zs=Ie||br.numHorizontalGlyphVertices===0&&di===0,bl=$e||br.numIconVertices===0;if(Zs||bl?bl?Zs||(Ei=Ei&&Fr):Fr=Ei&&Fr:Ei=Fr=Ei&&Fr,Fr&&Ro&&Ro.box&&this.collisionIndex.insertCollisionBox(Ro.box,R.get("text-ignore-placement"),E.bucketInstanceId,ao&&ao.box&&ls?ls:ys,ve.ID),Ei&&So&&this.collisionIndex.insertCollisionBox(So.box,R.get("icon-ignore-placement"),E.bucketInstanceId,ka,ve.ID),mo&&(Fr&&this.collisionIndex.insertCollisionCircles(mo.circles,R.get("text-ignore-placement"),E.bucketInstanceId,ys,ve.ID),g)){const go=E.bucketInstanceId;let Ao=this.collisionCircleArrays[go];Ao===void 0&&(Ao=this.collisionCircleArrays[go]=new Cs);for(let $i=0;$i<mo.circles.length;$i+=4)Ao.circles.push(mo.circles[$i+0]),Ao.circles.push(mo.circles[$i+1]),Ao.circles.push(mo.circles[$i+2]),Ao.circles.push(mo.collisionDetected?1:0)}const ba=E.projection.name!=="globe";Rn=Rn&&(ba||!Ki),cr=cr&&(ba||!Pi),this.placements[Oi]=new Ii(Fr||Rn,Ei||cr,Ur||E.justReloaded),u.add(Oi)},zi=this.retainedQueryData[E.bucketInstanceId].tileID;if(E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,zi),E.elevationType==="road"&&E.updateRoadElevation(zi.canonical),E.updateZOffset(),E.sortFeaturesByY){const br=E.getSortedSymbolIndexes(this.transform.angle);for(let ai=br.length-1;ai>=0;--ai){const kr=br[ai];ui(E.symbolInstances.get(kr),kr,E.collisionArrays[kr])}E.hasAnyZOffset&&o.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const br=E.getSortedIndexesByZOffset();for(let ai=0;ai<br.length;++ai){const kr=br[ai];ui(E.symbolInstances.get(kr),kr,E.collisionArrays[kr])}}else for(let br=a.symbolInstanceStart;br<a.symbolInstanceEnd;br++)ui(E.symbolInstances.get(br),br,E.collisionArrays[br]);if(g&&E.bucketInstanceId in this.collisionCircleArrays){const br=this.collisionCircleArrays[E.bucketInstanceId];o.bk(br.invProjMatrix,$),br.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(a,u,g,x){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:O,crossTileID:$}=g,U=o.c2(u),q=x===o.bK.vertical?O:U==="left"?S:U==="center"?E:U==="right"?R:-1;S>=0&&(a.text.placedSymbolArray.get(S).crossTileID=q>=0&&S!==q?0:$),E>=0&&(a.text.placedSymbolArray.get(E).crossTileID=q>=0&&E!==q?0:$),R>=0&&(a.text.placedSymbolArray.get(R).crossTileID=q>=0&&R!==q?0:$),O>=0&&(a.text.placedSymbolArray.get(O).crossTileID=q>=0&&O!==q?0:$)}markUsedOrientation(a,u,g){const x=u===o.bK.horizontal||u===o.bK.horizontalOnly?u:0,S=u===o.bK.vertical?u:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:$}=g,U=a.text.placedSymbolArray;E>=0&&(U.get(E).placedOrientation=x),R>=0&&(U.get(R).placedOrientation=x),O>=0&&(U.get(O).placedOrientation=x),$>=0&&(U.get($).placedOrientation=S)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(a):1,S=u?u.opacities:{},E=u?u.variableOffsets:{},R=u?u.placedOrientations:{};for(const O in this.placements){const $=this.placements[O],U=S[O];U?(this.opacities[O]=new gi(U,x,$.text,$.icon,null,$.clipped),g=g||$.text!==U.text.placed||$.icon!==U.icon.placed):(this.opacities[O]=new gi(null,x,$.text,$.icon,$.skipFade,$.clipped),g=g||$.text||$.icon)}for(const O in S){const $=S[O];if(!this.opacities[O]){const U=new gi($,x,!1,!1);U.isHidden()||(this.opacities[O]=U,g=g||$.text.placed||$.icon.placed)}}for(const O in E)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=E[O]);for(const O in R)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=R[O]);g?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:a)}updateLayerOpacities(a,u,g,x){const S=new Set;for(const E of u){const R=E.getBucket(a);R&&E.latestFeatureIndex&&a.fqid===R.layerIds[0]&&(this.updateBucketOpacities(R,S,E,E.collisionBoxArray,g,x,E.tileID,a.scope),R.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(R,E.tileID),R.elevationType==="road"&&R.updateRoadElevation(E.tileID.canonical),R.updateZOffset())}}updateBucketOpacities(a,u,g,x,S,E,R,O){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const $=a.layers[0].layout,U=a.layers[0].paint,q=!!a.layers[0].dynamicFilter(),H=new gi(null,0,!1,!1,!0),X=$.get("text-allow-overlap"),Q=$.get("icon-allow-overlap"),ae=$.get("text-variable-anchor"),ue=$.get("text-rotation-alignment")==="map",ce=$.get("text-pitch-alignment")==="map",pe=U.get("symbol-z-offset"),Ce=$.get("symbol-elevation-reference")==="sea",ve=!pe.isConstant(),Fe=new gi(null,0,X&&(Q||!a.hasIconData()||$.get("icon-optional")),Q&&(X||!a.hasTextData()||$.get("text-optional")),!0);!a.collisionArrays&&x&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(x);const Ie=(Le,Me,Ve)=>{for(let st=0;st<Me/4;st++)Le.opacityVertexArray.emplaceBack(Ve)};let $e=0;E&&a.updateReplacement(R,E);for(let Le=0;Le<a.symbolInstances.length;Le++){const Me=a.symbolInstances.get(Le),{numHorizontalGlyphVertices:Ve,numVerticalGlyphVertices:st,crossTileID:nt,numIconVertices:Et,tileAnchorX:mt,tileAnchorY:Lt}=Me;let ln=null;const ht=this.retainedQueryData[a.bucketInstanceId];ve&&Me&&ht&&(ln=g.latestFeatureIndex.loadFeature({featureIndex:Me.featureIndex,bucketIndex:ht.bucketIndex,sourceLayerIndex:ht.sourceLayerIndex,layoutVertexArrayOffset:0}));const Qe=pe.evaluate(ln,{}),kt=u.has(nt);let gt=this.opacities[nt];kt?gt=H:gt||(gt=Fe,this.opacities[nt]=gt),u.add(nt);const Kt=Ve>0||st>0,pn=Et>0,Nn=this.placedOrientations[nt],an=Nn===o.bK.vertical,dn=Nn===o.bK.horizontal||Nn===o.bK.horizontalOnly;!Kt&&!pn||gt.isHidden()||$e++;let jn=!1;if((Kt||pn)&&E)for(const Mn of a.activeReplacements){if(o.bY(Mn,S,o.bZ.Symbol,O)||Mn.min.x>mt||mt>Mn.max.x||Mn.min.y>Lt||Lt>Mn.max.y)continue;const wn=o.b_(mt,Lt,R.canonical,Mn.footprintTileId.canonical);if(jn=o.b$(wn,Mn.footprint),jn)break}if(Kt){const Mn=jn?xa:kf(gt.text);Ie(a.text,Ve,an?xa:Mn),Ie(a.text,st,dn?xa:Mn);const wn=gt.text.isHidden(),{leftJustifiedTextSymbolIndex:Rn,centerJustifiedTextSymbolIndex:cr,rightJustifiedTextSymbolIndex:Yr,verticalPlacedTextSymbolIndex:ui}=Me,zi=a.text.placedSymbolArray,br=wn||an?1:0;Rn>=0&&(zi.get(Rn).hidden=br),cr>=0&&(zi.get(cr).hidden=br),Yr>=0&&(zi.get(Yr).hidden=br),ui>=0&&(zi.get(ui).hidden=wn||dn?1:0);const ai=this.variableOffsets[nt];ai&&this.markUsedJustification(a,ai.anchor,Me,Nn);const kr=this.placedOrientations[nt];kr&&(this.markUsedJustification(a,"left",Me,kr),this.markUsedOrientation(a,kr,Me))}if(pn){const Mn=jn?xa:kf(gt.icon),{placedIconSymbolIndex:wn,verticalPlacedIconSymbolIndex:Rn}=Me,cr=a.icon.placedSymbolArray,Yr=gt.icon.isHidden()?1:0;wn>=0&&(Ie(a.icon,Et,an?xa:Mn),cr.get(wn).hidden=Yr),Rn>=0&&(Ie(a.icon,Me.numVerticalIconVertices,dn?xa:Mn),cr.get(Rn).hidden=Yr)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Mn=a.collisionArrays[Le];if(Mn){let wn=new o.P(0,0),Rn=!0;if(Mn.textBox||Mn.verticalTextBox){if(ae){const Yr=this.variableOffsets[nt];Yr?(wn=Of(Yr.anchor,Yr.width,Yr.height,Yr.textOffset,Yr.textScale),ue&&wn._rotate(ce?this.transform.angle:-this.transform.angle)):Rn=!1}q&&(Rn=!gt.clipped),Mn.textBox&&Pa(a.textCollisionBox.collisionVertexArray,gt.text.placed,!Rn||an,Qe,Ce,wn.x,wn.y),Mn.verticalTextBox&&Pa(a.textCollisionBox.collisionVertexArray,gt.text.placed,!Rn||dn,Qe,Ce,wn.x,wn.y)}const cr=Rn&&!!(!dn&&Mn.verticalIconBox);Mn.iconBox&&Pa(a.iconCollisionBox.collisionVertexArray,gt.icon.placed,cr,Qe,Ce,Me.hasIconTextFit?wn.x:0,Me.hasIconTextFit?wn.y:0),Mn.verticalIconBox&&Pa(a.iconCollisionBox.collisionVertexArray,gt.icon.placed,!cr,Qe,Ce,Me.hasIconTextFit?wn.x:0,Me.hasIconTextFit?wn.y:0)}}}if(a.fullyClipped=$e===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const Le=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=Le.invProjMatrix,a.placementViewportMatrix=Le.viewportMatrix,a.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>a}setStale(){this.stale=!0}}function Pa(m,a,u,g,x,S,E){m.emplaceBack(a?1:0,u?1:0,S||0,E||0,g,x?1:0),m.emplaceBack(a?1:0,u?1:0,S||0,E||0,g,x?1:0),m.emplaceBack(a?1:0,u?1:0,S||0,E||0,g,x?1:0),m.emplaceBack(a?1:0,u?1:0,S||0,E||0,g,x?1:0)}const ta=Math.pow(2,25),YE=Math.pow(2,24),Lf=Math.pow(2,17),c_=Math.pow(2,16),zf=Math.pow(2,9),um=Math.pow(2,8),u_=Math.pow(2,1);function kf(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const a=m.placed?1:0,u=Math.floor(127*m.opacity);return u*ta+a*YE+u*Lf+a*c_+u*zf+a*um+u*u_+a}const xa=0;class wc{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,u,g,x,S,E){const R=this._bucketParts;for(;this._currentTileIndex<a.length;)if(u.getBucketParts(R,x,a[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((O,$)=>O.sortKey-$.sortKey));this._currentPartIndex<R.length;){const O=R[this._currentPartIndex];if(u.placeLayerBucketPart(O,this._seenCrossTileIDs,g,O.symbolInstanceStart===0,E),this._currentPartIndex++,S())return!0}return!1}}class gs{constructor(a,u,g,x,S,E,R,O,$){this.placement=new Df(a,S,E,R,O,$),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(a,u,g,x,S){const E=o.o.now(),R=()=>{const O=o.o.now()-E;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=u[a[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=$)&&(!O.maxzoom||O.maxzoom>$)){const U=O,q=U.layout.get("symbol-z-elevate"),H=U.layout.get("symbol-sort-key").constantOr(1)!==void 0,X=U.layout.get("symbol-z-order"),Q=X==="viewport-y"||X==="auto"&&!(X!=="viewport-y"&&H),ae=U.layout.get("text-allow-overlap")||U.layout.get("icon-allow-overlap")||U.layout.get("text-ignore-placement")||U.layout.get("icon-ignore-placement"),ue=Q&&ae,ce=this._inProgressLayer=this._inProgressLayer||new wc(U),pe=o.B(O.source,O.scope);if(ce.continuePlacement(q||ue?x[pe]:g[pe],this.placement,this._showCollisionBoxes,O,R,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const dm=512/o.al/2;class Hd{constructor(a,u,g){this.tileID=a,this.bucketInstanceId=g,this.index=new o.c3(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=a.canonical.x*o.al,S=a.canonical.y*o.al;for(let E=0;E<u.length;E++){const{key:R,crossTileID:O,tileAnchorX:$,tileAnchorY:U}=u.get(E),q=Math.floor((x+$)*dm),H=Math.floor((S+U)*dm);this.index.add(q,H),this.keys.push(R),this.crossTileIDs.push(O)}this.index.finish()}findMatches(a,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),S=dm/Math.pow(2,u.canonical.z-this.tileID.canonical.z),E=u.canonical.x*o.al,R=u.canonical.y*o.al;for(let O=0;O<a.length;O++){const $=a.get(O);if($.crossTileID)continue;const{key:U,tileAnchorX:q,tileAnchorY:H}=$,X=Math.floor((E+q)*S),Q=Math.floor((R+H)*S),ae=this.index.range(X-x,Q-x,X+x,Q+x).sort((ue,ce)=>ue-ce);for(const ue of ae){const ce=this.crossTileIDs[ue];if(this.keys[ue]===U&&!g.has(ce)){g.add(ce),$.crossTileID=ce;break}}}}}class fa{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Jl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const u=Math.round((a-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],S={};for(const E in x){const R=x[E];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+u),S[R.tileID.key]=R}this.indexes[g]=S}this.lng=a}addBucket(a,u,g){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);const x=this.usedCrossTileIDs[a.overscaledZ];for(const S in this.indexes){const E=this.indexes[S];if(Number(S)>a.overscaledZ)for(const R in E){const O=E[R];O.tileID.isChildOf(a)&&O.findMatches(u.symbolInstances,a,x)}else{const R=E[a.scaledTo(Number(S)).key];R&&R.findMatches(u.symbolInstances,a,x)}}for(let S=0;S<u.symbolInstances.length;S++){const E=u.symbolInstances.get(S);E.crossTileID||(E.crossTileID=g.generate(),x.add(E.crossTileID))}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new Hd(a,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(a,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[a].delete(g)}removeStaleBuckets(a){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const S in x)a[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[S]),delete x[S],u=!0)}return u}}class Sc{constructor(){this.layerIndexes={},this.crossTileIDs=new fa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,u,g,x){let S=this.layerIndexes[a.fqid];S===void 0&&(S=this.layerIndexes[a.fqid]=new Jl);let E=!1;const R={};x.name!=="globe"&&S.handleWrapJump(g);for(const O of u){const $=O.getBucket(a);$&&a.fqid===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(O.tileID,$,this.crossTileIDs)&&(E=!0),R[$.bucketInstanceId]=!0)}return S.removeStaleBuckets(R)&&(E=!0),E}pruneUnusedLayers(a){const u={};a.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const Lo=771;class jr{constructor(a,u,g,x){this.blendFunction=a,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=g,this.blendEquation=x}}jr.Replace=[1,0,1,0],jr.disabled=new jr(jr.Replace,o.ao.transparent,[!1,!1,!1,!1]),jr.unblended=new jr(jr.Replace,o.ao.transparent,[!0,!0,!0,!0]),jr.alphaBlended=new jr([1,Lo,1,Lo],o.ao.transparent,[!0,!0,!0,!0]),jr.alphaBlendedNonPremultiplied=new jr([770,Lo,770,Lo],o.ao.transparent,[!0,!0,!0,!0]),jr.multiply=new jr([774,0,774,0],o.ao.transparent,[!0,!0,!0,!0]),jr.additive=new jr([1,1,1,1],o.ao.transparent,[!0,!0,!0,!0]);class Hn{constructor(a,u,g){this.func=a,this.mask=u,this.range=g}}Hn.ReadOnly=!1,Hn.ReadWrite=!0,Hn.disabled=new Hn(519,Hn.ReadOnly,[0,1]);const Qu=7680;class Tr{constructor(a,u,g,x,S,E){this.test=a,this.ref=u,this.mask=g,this.fail=x,this.depthFail=S,this.pass=E}}Tr.disabled=new Tr({func:519,mask:0},0,0,Qu,Qu,Qu);const Gd=1029,hm=2305;class xr{constructor(a,u,g){this.enable=a,this.mode=u,this.frontFace=g}}function Ff(m,a){const u=o.c9(m,3);o.cb(m,a),o.cf(m,3,u)}function fm(m,a){const u=o.c6([]);return o.c7(u,u,-a),o.c8(u,u,-m),u}function yb(m,a){const u=[m[0],m[1],0],g=[a[0],a[1],0];if(o.ag(u)>=1e-15){const E=o.aw([],u);o.c4(g,E,o.bI(g,E)),a[0]=g[0],a[1]=g[1]}const x=o.bH([],a,m);if(o.c5(x)<1e-15)return null;const S=Math.atan2(-x[1],x[0]);return fm(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}xr.disabled=new xr(!1,Gd,hm),xr.backCCW=new xr(!0,Gd,hm),xr.backCW=new xr(!0,Gd,2304),xr.frontCW=new xr(!0,1028,2304),xr.frontCCW=new xr(!0,1028,hm);class Ql{constructor(a,u){this.position=a,this.orientation=u}get position(){return this._position}set position(a){if(a){const u=a instanceof o.ae?a:new o.ae(a[0],a[1],a[2]);this._renderWorldCopies&&(u.x=o.bS(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(a,u,g){if(this.orientation=null,!this.position)return;const x=this.position,S=g||(this._elevation?this._elevation.getAtPointOrZero(o.ae.fromLngLat(a)):0),E=o.ae.fromLngLat(a,S),R=[E.x-x.x,E.y-x.y,E.z-x.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=yb(R,u)}setPitchBearing(a,u){this.orientation=fm(o.an(a),o.an(-u))}}class pm{constructor(a,u){this._transform=o.bz([]),this.orientation=u,this.position=a}get mercatorPosition(){const a=this.position;return new o.ae(a[0],a[1],a[2])}get position(){const a=o.c9(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var u;a&&o.cf(this._transform,3,[(u=a)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||o.c6([]),a&&Ff(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,u){this._orientation=fm(a,u),Ff(this._transform,this._orientation)}forward(){const a=o.c9(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=o.c9(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=o.c9(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,u){const g=new Float64Array(16);return o.bk(g,this.getWorldToCamera(a,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(a,u,g){const x=this.position;o.c4(x,x,-a);const S=new Float64Array(16);return o.bp(S,[g,g,g]),o.bq(S,S,x),S[10]*=u,S}getWorldToCamera(a,u){const g=new Float64Array(16),x=new Float64Array(4),S=this.position;return o.ca(x,this._orientation),o.c4(S,S,-a),o.cb(g,x),o.bq(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(a,u,g,x){const S=new Float64Array(16);return o.cc(S,a,u,g,x),S}getCameraToClipOrthographic(a,u,g,x,S,E){const R=new Float64Array(16);return o.cd(R,a,u,g,x,S,E),R}getDistanceToElevation(a,u=!1){const g=a===0?0:o.ce(a,u?o.a_(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new pm([...this.position],[...this.orientation])}}const Ma={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Qa{constructor(a=0,u=0,g=0,x=0){if(isNaN(a)||a<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=u,this.left=g,this.right=x}interpolate(a,u,g){return u.top!=null&&a.top!=null&&(this.top=o.ak(a.top,u.top,g)),u.bottom!=null&&a.bottom!=null&&(this.bottom=o.ak(a.bottom,u.bottom,g)),u.left!=null&&a.left!=null&&(this.left=o.ak(a.left,u.left,g)),u.right!=null&&a.right!=null&&(this.right=o.ak(a.right,u.right,g)),this}getCenter(a,u){const g=o.aA((this.left+a-this.right)/2,0,a),x=o.aA((this.top+u-this.bottom)/2,0,u);return new o.P(g,x)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Qa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const ed=15;class Wd{constructor(a,u,g,x,S,E,R){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=a||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(E),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new o.aS(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Qa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new pm,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const a=new Wd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a._allowWorldUnderZoom=this._allowWorldUnderZoom,a}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<ed}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(a,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(a||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return o.aH(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=o.cl(this.projectionOptions);const g=this.getProjection(),x=!o.bx(u,g);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(a){return this._orthographicProjectionAtLowPitch!==a&&(this._orthographicProjectionAtLowPitch=a,this._calcMatrices(),!0)}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.cl({name:"mercator"});const u=a!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bS(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const u=-a*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=o.cm(),o.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const u=o.aA(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=o.an(a),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const u=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(a){this._tileCoverLift!==a&&(this._tileCoverLift=a)}_updateCameraOnTerrain(){const a=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&a===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||a===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=a||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const a=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(a)}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,S=0;for(let E=0;E<u.length;E++){const R=new o.P(u[E][0]*this.width,g+u[E][1]*(this.height-g)),O=a.pointCoordinate(R);if(!O)continue;const $=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);x+=O[3]*$,S+=$}return S===0?NaN:x/S}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const a=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(a),S=this._mercatorZfromZoom(this._maxZoom),E=Math.max(x-g,S);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let g;g=a.z<this._camera.position[2]?[u.x,u.y,u.z]:[a.x,a.y,a.z];const x=o.ag(o.av([],this._camera.position,g));return o.aA(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let u=!1;if(a.orientation&&!o.co(a.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(a.orientation)),a.position){const g=[a.position.x,a.position.y,a.position.z];o.cp(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,u=new Ql;return u.position=new o.ae(a[0],a[1],a[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(a){if(!o.cq(a))return!1;o.cr(a,a);const u=o.cs([],[0,0,-1],a),g=o.cs([],[0,-1,0],a);if(g[2]<0)return!1;const x=yb(u,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(a){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;a[2]=o.aA(a[2],x/g,x/u),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,u,g){this._unmodified=!1,this._edgeInsets.interpolate(a,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const u=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(a){const u=[new o.ct(0,a)];if(this.renderWorldCopies){const g=this.pointCoordinate(new o.P(0,0)),x=this.pointCoordinate(new o.P(this.width,0)),S=this.pointCoordinate(new o.P(this.width,this.height)),E=this.pointCoordinate(new o.P(0,this.height)),R=Math.floor(Math.min(g.x,x.x,S.x,E.x)),O=Math.floor(Math.max(g.x,x.x,S.x,E.x)),$=1;for(let U=R-$;U<=O+$;U++)U!==0&&u.push(new o.ct(U,a))}return u}isLODDisabled(a){return(!a||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(a,u,g){let x=[];const S=g!=null,E=!S;if(E&&this.zoom<u||S&&g[0]===0&&g[1]===0)return x;const R=new Set,O=(U,q,H,X,Q)=>{const ae=o.cX(q,U,H,X,Q);R.has(ae)||(x.push(new o.aP(U,q,H,X,Q)),R.add(ae))};for(let U=0;U<a.length;U++){const q=a[U];if(E&&q.canonical.z!==u)continue;const H=q.canonical,X=q.overscaledZ,Q=q.wrap,ae=1<<H.z,ue=H.x+1<ae,ce=H.x>0,pe=H.y+1<ae,Ce=H.y>0,ve=q.wrap-(ce?0:1),Fe=q.wrap+(ue?0:1),Ie=ce?H.x-1:ae-1,$e=ue?H.x+1:0;if(S)g[0]<0?(O(X,Fe,H.z,$e,H.y),g[1]<0&&pe&&(O(X,Q,H.z,H.x,H.y+1),O(X,Fe,H.z,$e,H.y+1)),g[1]>0&&Ce&&(O(X,Q,H.z,H.x,H.y-1),O(X,Fe,H.z,$e,H.y-1))):g[0]>0?(O(X,ve,H.z,Ie,H.y),g[1]<0&&pe&&(O(X,Q,H.z,H.x,H.y+1),O(X,ve,H.z,Ie,H.y+1)),g[1]>0&&Ce&&(O(X,Q,H.z,H.x,H.y-1),O(X,ve,H.z,Ie,H.y-1))):g[1]<0&&pe?O(X,Q,H.z,H.x,H.y+1):Ce&&O(X,Q,H.z,H.x,H.y-1);else{const Le=q.visibleQuadrants;1&Le&&(O(X,ve,H.z,Ie,H.y),Ce&&(O(X,Q,H.z,H.x,H.y-1),O(X,ve,H.z,Ie,H.y-1))),2&Le&&(O(X,Fe,H.z,$e,H.y),Ce&&(O(X,Q,H.z,H.x,H.y-1),O(X,Fe,H.z,$e,H.y-1))),4&Le&&(O(X,ve,H.z,Ie,H.y),pe&&(O(X,Q,H.z,H.x,H.y+1),O(X,ve,H.z,Ie,H.y+1))),8&Le&&(O(X,Fe,H.z,$e,H.y),pe&&(O(X,Q,H.z,H.x,H.y+1),O(X,Fe,H.z,$e,H.y+1)))}}const $=[];for(const U of x)x.some(q=>U.isChildOf(q))||$.push(U);if(x=$.filter(U=>!a.some(q=>!!(U.overscaledZ<u&&q.isChildOf(U))||U.equals(q)||U.isChildOf(q))),E){const U=1<<u,q=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),H=[U*q.x,U*q.y],X=4,Q=X*X;x=x.filter(ae=>{const ue=ae.canonical.x+.5-H[0],ce=ae.canonical.y+.5-H[1];return ue*ue+ce*ce<Q})}return x}extendTileCoverToNearPlane(a,u,g){const x=[],S=new Set;for(const pe of a)S.add(pe.key);const E=(pe,Ce,ve,Fe,Ie)=>{const $e=o.cX(Ce,pe,ve,Fe,Ie);S.has($e)||(x.push(new o.aP(pe,Ce,ve,Fe,Ie)),S.add($e))},R=a.reduce((pe,Ce)=>Math.max(pe,Ce.overscaledZ),g),O=1<<g,$=[new o.P(0,0),new o.P(o.al,0),new o.P(o.al,o.al),new o.P(0,o.al)],U=new o.P(0,0),q=new o.P(0,0),H=(pe,Ce)=>{const ve=Math.floor(pe[0]),Fe=Math.floor(pe[1]),Ie=(pe[0]-ve)*o.al,$e=(pe[1]-Fe)*o.al,Le=Math.floor(Ce[0]),Me=Math.floor(Ce[1]),Ve=(Ce[0]-Le)*o.al,st=(Ce[1]-Me)*o.al;for(let nt=-1;nt<=1;nt++){const Et=ve+nt;if(!(Et<0||Et>=O)){U.x=Ie-nt*o.al,q.x=Ve-(Et-Le)*o.al;for(let mt=-1;mt<=1;mt++){const Lt=Fe+mt;U.y=$e-mt*o.al,q.y=st-(Lt-Me)*o.al,o.cY(U,q,$)&&E(R,0,g,Et,Lt)}}}},X=u.points,Q=X[o.cu],ae=X[o.cv],ue=this._projectToGround(Q,X[o.cw]),ce=this._projectToGround(ae,X[o.cx]);return H(Q,ue),H(ae,ce),x}_projectToGround(a,u){return o.cy(o.cz(),a,u,a[2]/(a[2]-u[2]))}coveringTiles(a){let u=this.coveringZoomLevel(a);const g=u,x=this.elevation&&this.elevation.exaggeration(),S=x&&!a.isTerrainDEM,E=this.projection.name==="mercator";if(a.minzoom!==void 0&&u<a.minzoom)return[];a.maxzoom!==void 0&&u>a.maxzoom&&(u=a.maxzoom);const R=this.locationCoordinate(this.center),O=this.center.lat,$=1<<u,U=[$*R.x,$*R.y,0],q=this.projection.name==="globe",H=!q,X=o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,H),Q=q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ae=$*o.ce(1,this.center.lat),ue=this._camera.position[2]/o.ce(1,this.center.lat),ce=[$*Q.x,$*Q.y,ue*(H?1:ae)],pe=q||x,Ce=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),ve=this.isLODDisabled(!0)?u:0;let Fe;if(this._elevation&&a.isTerrainDEM)Fe=1e4*this._elevation.exaggeration();else if(this._elevation){const Qe=this._elevation.getMinMaxForVisibleTiles();Fe=Qe?Qe.max:this._centerAltitude}else Fe=this._centerAltitude;const Ie=a.isTerrainDEM?-Fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,$e=this.projection.isReprojectedInTileSpace?o.cB(this):1,Le=Qe=>{const gt=new o.ae(Qe.x+25e-6,Qe.y,Qe.z),Kt=new o.ae(Qe.x,Qe.y+25e-6,Qe.z),pn=Qe.toLngLat(),Nn=gt.toLngLat(),an=Kt.toLngLat(),dn=this.locationCoordinate(pn),jn=this.locationCoordinate(Nn),Mn=this.locationCoordinate(an),wn=Math.hypot(jn.x-dn.x,jn.y-dn.y),Rn=Math.hypot(Mn.x-dn.x,Mn.y-dn.y);return Math.sqrt(wn*Rn)*$e/25e-6},Me=Qe=>{const kt=Fe,gt=Ie;return{aabb:o.cE(this,$,0,0,0,Qe,gt,kt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:kt,wrap:Qe,fullyVisible:!1}},Ve=[];let st=[];const nt=u,Et=a.reparseOverscaled?g:u,mt=(ue-this._centerAltitude)*ae,Lt=Qe=>{if(!this._elevation||!Qe.tileID||!E)return;const kt=this._elevation.getMinMaxForTile(Qe.tileID),gt=Qe.aabb;kt?(gt.min[2]=kt.min,gt.max[2]=kt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(Qe.shouldSplit=ht(Qe),Qe.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},ln=(Qe,kt)=>{if(.707*kt<Qe)return 1;const gt=kt/Qe;return gt/(1.4144271570014144+(Math.pow(1.1,gt-1.4144271570014144+1)-1)/(1.1-1)-1)},ht=Qe=>{if(Qe.zoom<ve)return!0;if(Qe.zoom===nt)return!1;if(Qe.shouldSplit!=null)return Qe.shouldSplit;const kt=Qe.aabb.distanceX(ce),gt=Qe.aabb.distanceY(ce);let Kt=mt,pn=1;if(q){Kt=Qe.aabb.distanceZ(ce);const Rn=Math.pow(2,Qe.zoom),cr=o.a_((Qe.y+1)/Rn),Yr=o.a_(Qe.y/Rn),ui=Math.min(Math.max(O,cr),Yr),zi=o.d0(ui)/o.d0(O);if(pn=ui===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,zi/this._mercatorScaleRatio),this.zoom<=o.cZ&&Qe.zoom===nt-1&&zi>=.9)return!0}else if(S&&(Kt=Qe.aabb.distanceZ(ce)*ae),this.projection.isReprojectedInTileSpace&&g<=5){const Rn=Math.pow(2,Qe.zoom),cr=Le(new o.ae((Qe.x+.5)/Rn,(Qe.y+.5)/Rn));pn=cr>.85?1:cr}if(!E&&!q){const Rn=Math.sqrt(kt*kt+gt*gt+Kt*Kt);let cr=(1<<nt-Qe.zoom)*Ce*pn;return cr*=ln(Math.max(Kt,mt),Rn),Rn<cr}let Nn=Number.MAX_VALUE,an=0;const dn=Qe.aabb.getCorners(),jn=[];for(const Rn of dn){o.av(jn,Rn,ce),q||(S?jn[2]*=ae:jn[2]=mt);const cr=o.bI(jn,this._camera.forward());cr<Nn&&(Nn=cr,an=Math.abs(jn[2]))}let Mn=(1<<nt-Qe.zoom)*Ce*pn;if(Mn*=ln(Math.max(an,mt),Nn),Nn<Mn)return!0;const wn=Qe.aabb.closestPoint(U);return wn[0]===U[0]&&wn[1]===U[1]};if(this.renderWorldCopies)for(let Qe=1;Qe<=3;Qe++)Ve.push(Me(-Qe)),Ve.push(Me(Qe));for(Ve.push(Me(0));Ve.length>0;){const Qe=Ve.pop(),kt=Qe.x,gt=Qe.y;let Kt=Qe.fullyVisible;const pn=()=>this.projection.name==="globe"&&(Qe.y===0||Qe.y===(1<<Qe.zoom)-1);if(!Kt){let Nn=pe?Qe.aabb.intersects(X):Qe.aabb.intersectsFlat(X);if(Nn===0&&pn()){const an=new o.cC(Qe.zoom,kt,gt);Nn=o.cD(this,$,an,!0).intersects(X)}if(Nn===0)continue;Kt=Nn===2}if(Qe.zoom!==nt&&ht(Qe))for(let Nn=0;Nn<4;Nn++){const an=(kt<<1)+Nn%2,dn=(gt<<1)+(Nn>>1),jn={aabb:E?Qe.aabb.quadrant(Nn):o.cE(this,$,Qe.zoom+1,an,dn,Qe.wrap,Qe.minZ,Qe.maxZ,this.projection),zoom:Qe.zoom+1,x:an,y:dn,wrap:Qe.wrap,fullyVisible:Kt,tileID:void 0,shouldSplit:void 0,minZ:Qe.minZ,maxZ:Qe.maxZ};S&&!q&&(jn.tileID=new o.aP(Qe.zoom+1===nt?Et:Qe.zoom+1,Qe.wrap,Qe.zoom+1,an,dn),Lt(jn)),Ve.push(jn)}else{const Nn=Qe.zoom===nt?Et:Qe.zoom;if(a.minzoom&&a.minzoom>Nn)continue;let an=0;if(!Kt){let wn=pe?Qe.aabb.intersectsPrecise(X):Qe.aabb.intersectsPreciseFlat(X);if(wn===0&&pn()){const Rn=new o.cC(Qe.zoom,kt,gt);wn=o.cD(this,$,Rn,!0).intersectsPrecise(X)}if(wn===0)continue;if(a.calculateQuadrantVisibility)if(X.containsPoint(Qe.aabb.center))an=15;else for(let Rn=0;Rn<4;Rn++)Qe.aabb.quadrant(Rn).intersects(X)!==0&&(an|=1<<Rn)}const dn=U[0]-(.5+kt+(Qe.wrap<<Qe.zoom))*(1<<u-Qe.zoom),jn=U[1]-.5-gt,Mn=Qe.tileID?Qe.tileID:new o.aP(Nn,Qe.wrap,Qe.zoom,kt,gt);a.calculateQuadrantVisibility&&(Mn.visibleQuadrants=an),st.push({tileID:Mn,distanceSq:dn*dn+jn*jn})}}if(this.fogCullDistSq){const Qe=this.fogCullDistSq,kt=this.horizonLineFromTop();st=st.filter(gt=>{const Kt=[0,0,0,1],pn=[o.al,o.al,0,1],Nn=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());o.aC(Kt,Kt,Nn),o.aC(pn,pn,Nn);const an=o.cF([],Kt,pn),dn=o.cG([],Kt,pn),jn=o.c_(an,dn);if(jn===0)return!0;let Mn=!1;const wn=this._elevation;if(wn&&jn>Qe&&kt!==0){const Rn=this.calculateProjMatrix(gt.tileID.toUnwrapped());let cr;a.isTerrainDEM||(cr=wn.getMinMaxForTile(gt.tileID)),cr||(cr={min:Ie,max:Fe});const Yr=o.cH(this.rotation),ui=[Yr[0]*o.al,Yr[1]*o.al,cr.max];o.af(ui,ui,Rn),Mn=(1-ui[1])*this.height*.5<kt}return jn<Qe||Mn})}return st.sort((Qe,kt)=>Qe.distanceSq-kt.distanceSq).map(Qe=>Qe.tileID)}resize(a,u){this.width=a,this.height=u,this.pixelsToGLUnits=[2/a,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log2(a)}project(a){const u=o.aA(a.lat,-o.cI,o.cI),g=this.projection.project(a.lng,u);return new o.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,u){let g,x;const S=this.centerPoint;if(this.projection.name==="globe"){const R=this.worldSize;g=(u.x-S.x)/R,x=(u.y-S.y)/R}else{const R=this.pointCoordinate(u),O=this.pointCoordinate(S);g=R.x-O.x,x=R.y-O.y}const E=this.locationCoordinate(a);this.setLocation(new o.ae(E.x-g,E.y-x))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a,u){return this.projection.locationPoint(this,a,u)}locationPoint3D(a,u){return this.projection.locationPoint(this,a,u,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a,u){return this.coordinateLocation(this.pointCoordinate3D(a,u))}locationCoordinate(a,u){const g=u?o.ce(u,a.lat):void 0,x=this.projection.project(a.lng,a.lat);return new o.ae(x.x,x.y,g)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,u){const g=u??this._centerAltitude,x=[a.x,a.y,0,1],S=[a.x,a.y,1,1];o.aC(x,x,this.pixelMatrixInverse),o.aC(S,S,this.pixelMatrixInverse);const E=S[3];o.cJ(x,x,1/x[3]),o.cJ(S,S,1/E);const R=x[2],O=S[2];return{p0:x,p1:S,t:R===O?0:(g-R)/(O-R)}}screenPointToMercatorRay(a){const u=[a.x,a.y,0,1],g=[a.x,a.y,1,1];return o.aC(u,u,this.pixelMatrixInverse),o.aC(g,g,this.pixelMatrixInverse),o.cJ(u,u,1/u[3]),o.cJ(g,g,1/g[3]),u[2]=o.ce(u[2],this._center.lat)*this.worldSize,g[2]=o.ce(g[2],this._center.lat)*this.worldSize,o.cJ(u,u,1/this.worldSize),o.cJ(g,g,1/this.worldSize),new o.ax([u[0],u[1],u[2]],o.aw([],o.av([],g,u)))}rayIntersectionCoordinate(a){const{p0:u,p1:g,t:x}=a,S=o.ce(u[2],this._center.lat),E=o.ce(g[2],this._center.lat);return new o.ae(o.ak(u[0],g[0],x)/this.worldSize,o.ak(u[1],g[1],x)/this.worldSize,o.ak(S,E,x))}pointCoordinate(a,u=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,u)}pointCoordinate3D(a,u){if(!this.elevation)return this.pointCoordinate(a,u);let g=this.projection.pointCoordinate3D(this,a.x,a.y);if(g)return new o.ae(g[0],g[1],g[2]);let x=0,S=this.horizonLineFromTop();if(a.y>S)return this.pointCoordinate(a,u);const E=.02*S,R=a.clone();for(let O=0;O<10&&S-x>E;O++){R.y=o.ak(x,S,.66);const $=this.projection.pointCoordinate3D(this,R.x,R.y);$?(S=R.y,g=$):x=R.y}return g?new o.ae(g[0],g[1],g[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=o.cK)return!this.isPointAboveHorizon(a);const u=this.pointCoordinate(a);return u.y>=0&&u.y<=1}_coordinatePoint(a,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,x=[a.x*this.worldSize,a.y*this.worldSize,g+a.toAltitude(),1];return o.aC(x,x,this.pixelMatrix),x[3]>0?new o.P(x[0]/x[3],x[1]/x[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:a,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,S=this.pointLocation3D(new o.P(u,a)),E=this.pointLocation3D(new o.P(x,a)),R=this.pointLocation3D(new o.P(x,g)),O=this.pointLocation3D(new o.P(u,g));let $=Math.min(S.lng,E.lng,R.lng,O.lng),U=Math.max(S.lng,E.lng,R.lng,O.lng),q=Math.min(S.lat,E.lat,R.lat,O.lat),H=Math.max(S.lat,E.lat,R.lat,O.lat);const X=Math.pow(2,-this.zoom)/16*270,Q=this.projection.name==="globe"?1:4,ae=(ue,ce,pe,Ce,ve)=>{const Fe=(ue+pe)/2,Ie=(ce+Ce)/2,$e=new o.P(Fe,Ie),{lng:Le,lat:Me}=this.pointLocation3D($e),Ve=Math.max(0,$-Le,q-Me,Le-U,Me-H);$=Math.min($,Le),U=Math.max(U,Le),q=Math.min(q,Me),H=Math.max(H,Me),(ve<Q||Ve>X)&&(ae(ue,ce,Fe,Ie,ve+1),ae(Fe,Ie,pe,Ce,ve+1))};if(ae(u,a,x,a,1),ae(x,a,x,g,1),ae(x,g,u,g,1),ae(u,g,u,a,1),this.projection.name==="globe"){const[ue,ce]=o.cL(this);ue?(H=90,U=180,$=-180):ce&&(q=-90,U=180,$=-180)}return new o.aI(new o.aS($,q),new o.aS(U,H))}_getBoundsRectangular(a,u){const{top:g,left:x}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,R=new o.P(x,g),O=new o.P(E,g),$=new o.P(E,S),U=new o.P(x,S);let q=this.pointCoordinate(R,a),H=this.pointCoordinate(O,a);const X=this.pointCoordinate($,u),Q=this.pointCoordinate(U,u),ae=(ue,ce)=>(ce.y-ue.y)/(ce.x-ue.x);return q.y>1&&H.y>=0?q=new o.ae((1-Q.y)/ae(Q,q)+Q.x,1):q.y<0&&H.y<=1&&(q=new o.ae(-Q.y/ae(Q,q)+Q.x,0)),H.y>1&&q.y>=0?H=new o.ae((1-X.y)/ae(X,H)+X.x,1):H.y<0&&q.y<=1&&(H=new o.ae(-X.y/ae(X,H)+X.x,0)),new o.aI().extend(this.coordinateLocation(q)).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(X))}_getBoundsRectangularTerrain(){const a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=a.visibleDemTiles.reduce((g,x)=>{if(x.dem){const S=x.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*a.exaggeration(),u.max*a.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return a?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-o.cI,this.maxLat=o.cI,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.aF(this.minLng)*this.tileSize,this.worldMaxX=o.aF(this.maxLng)*this.tileSize,this.worldMinY=o.aJ(this.maxLat)*this.tileSize,this.worldMaxY=o.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,u){return this.projection.createTileMatrix(this,u,a)}calculateDistanceTileData(a){const u=a.key,g=this._distanceTileDataCache;if(g[u])return g[u];const x=a.canonical,S=1/this.height,E=this.cameraWorldSize,R=E/this.zoomScale(x.z),O=(x.x+Math.pow(2,x.z)*a.wrap)*R,$=x.y*R,U=this.point;U.x*=E/this.worldSize,U.y*=E/this.worldSize;const q=this.angle,H=Math.sin(-q),X=-Math.cos(-q);return g[u]={bearing:[H,X],center:[(U.x-O)*S,(U.y-$)*S],scale:R/o.al*S},g[u]}calculateFogTileMatrix(a){const u=a.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return o.aB(x,this.worldToFogMatrix,x),g[u]=new Float32Array(x),g[u]}calculateProjMatrix(a,u=!1,g=!1){const x=a.key;let S;if(S=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,S[x])return S[x];const E=this.calculatePosMatrix(a,this.worldSize);let R;return R=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,o.aB(E,R,E),S[x]=new Float32Array(E),S[x]}calculatePixelsToTileUnitsMatrix(a){const u=a.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const x=o.cM(a,this);return g[u]=x,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const a=1/this.worldSize,u=o.bp([],[a,a,a]);return o.aB(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const a=this._elevation;this._updateCameraState();const u=o.ce(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=this._camera.forward(),S=o.ce(1,this._center.lat);g[2]/=S,x[2]/=S,o.aw(x,x);const E=a.raycast(g,x,a.exaggeration());if(E){const R=o.bG([],g,x,E),O=new o.ae(R[0],R[1],o.ce(R[2],o.a_(R[1]))),$=(O.z+o.ag([O.x-g[0],O.y-g[1],O.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ($),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;const u=this._elevation,g=o.ce(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),S=u.getAtPointOrZero(new o.ae(...x)),E=this.pixelsPerMeter/this.worldSize*S,R=this._minimumHeightOverTerrain(),O=x[2]-E;if(O<=R)if(O<0||a){const $=this.locationCoordinate(this._center,this._centerAltitude),U=[x[0],x[1],$.z-x[2]],q=o.ag(U);U[2]-=(R-O)/this._pixelsPerMercatorPixel;const H=o.ag(U);if(H===0)return;o.c4(U,U,q/H*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],$.z*this._pixelsPerMercatorPixel-U[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const H=this.center;return H.lat=o.aA(H.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(H.lng=o.aA(H.lng,this.minLng,this.maxLng)),this.center=H,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:x}=this.point;let S=0,E=g,R=x;const O=this.width/2,$=this.height/2,U=this.worldMinY*this.scale,q=this.worldMaxY*this.scale;if(x-$<U&&(R=U+$),x+$>q&&(R=q-$),q-U<this.height&&(S=Math.max(S,this.height/(q-U)),R=(q+U)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const H=this.worldMinX*this.scale,X=this.worldMaxX*this.scale,Q=this.worldSize/2-(H+X)/2;E=(g+Q+this.worldSize)%this.worldSize-Q,E-O<H&&(E=H+O),E+O>X&&(E=X-O),X-H<this.width&&(S=Math.max(S,this.width/(X-H)),E=(X+H)/2)}E===g&&R===x||this._allowWorldUnderZoom||(this.center=this.unproject(new o.P(E,R))),S&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.ce(1,this.center.lat)/o.ce(1,o.d1));const x=o.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?g:1,E=this._camera.getWorldToCamera(this.worldSize,S);let R;const O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(O[8]=2*-a.x/this.width,O[9]=2*a.y/this.height,this.isOrthographic){let Me=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ve=Me*this.aspect,st=-Ve,nt=-Me;Ve-=a.x,st-=a.x,Me+=a.y,nt+=a.y,R=this._camera.getCameraToClipOrthographic(st,Ve,nt,Me,this._nearZ,this._farZ),((Et,mt,Lt,ln)=>{for(let ht=0;ht<16;ht++)Et[ht]=o.ak(mt[ht],Lt[ht],ln)})(R,R,O,o.c$(this.pitch>=ed?1:this.pitch/ed))}else R=O;const $=o.cO([],O,E);let U=o.cO([],R,E);if(this.projection.isReprojectedInTileSpace){const Me=this.locationCoordinate(this.center),Ve=o.bz([]);o.bq(Ve,Ve,[Me.x*this.worldSize,Me.y*this.worldSize,0]),o.aB(Ve,Ve,o.cP(this)),o.bq(Ve,Ve,[-Me.x*this.worldSize,-Me.y*this.worldSize,0]),o.aB(U,U,Ve),o.aB($,$,Ve),this.inverseAdjustmentMatrix=o.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.cR([],U,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=U,this.invProjMatrix=o.bk(new Float64Array(16),this.projMatrix),u){const Me=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Me[8]=2*-a.x/this.width,Me[9]=2*a.y/this.height,this.expandedFarZProjMatrix=o.cO([],Me,E)}else this.expandedFarZProjMatrix=this.projMatrix;const q=o.bk([],R);this.frustumCorners=o.cS.fromInvProjectionMatrix(q,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const H=new Float32Array(16);o.bz(H),o.cR(H,H,[1,-1,1]),o.cT(H,H,this._pitch),o.bA(H,H,this.angle);const X=o.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.by(X);const Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;X[8]=2*-a.x/this.width,X[9]=2*(a.y+Q)/this.height,this.skyboxMatrix=o.aB(H,X,H);const ae=this.point,ue=ae.x,ce=ae.y,pe=this.width%2/2,Ce=this.height%2/2,ve=Math.cos(this.angle),Fe=Math.sin(this.angle),Ie=ue-Math.round(ue)+ve*pe+Fe*Ce,$e=ce-Math.round(ce)+ve*Ce+Fe*pe,Le=new Float64Array(U);if(o.bq(Le,Le,[Ie>.5?Ie-1:Ie,$e>.5?$e-1:$e,0]),this.alignedProjMatrix=Le,U=o.bB(),o.cR(U,U,[this.width/2,-this.height/2,1]),o.bq(U,U,[1,-1,0]),this.labelPlaneMatrix=U,U=o.bB(),o.cR(U,U,[1,-1,1]),o.bq(U,U,[-1,-1,0]),o.cR(U,U,[2/this.width,2/this.height,1]),this.glCoordMatrix=U,this.pixelMatrix=o.aB(new Float64Array(16),this.labelPlaneMatrix,$),this._calcFogMatrices(),this._distanceTileDataCache={},U=o.bk(new Float64Array(16),this.pixelMatrix),!U)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=U,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.cU(this);const Me=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.af(Me,Me,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=U;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,S=[a,a,u];o.c4(S,S,x),o.c4(g,g,-1),o.cV(g,g,S);const E=o.bB();o.bq(E,E,g),o.cR(E,E,S),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,u,x)}_computeCameraPosition(a){const u=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-a/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*S,x.y/this.worldSize-g[1]*S,a/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=a[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(S=Math.min((u-g)/x,1)),this._camera.position=o.bG([],this._camera.position,a,S),this._updateStateFromCamera()}_updateStateFromCamera(){const a=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),S=o.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.an(this._maxPitch)),R=Math.max((a[2]-S)/Math.cos(g),E),O=this._zoomFromMercatorZ(R);o.bG(a,a,u,R),this._pitch=o.aA(g,o.an(this.minPitch),o.an(this.maxPitch)),this.angle=o.bS(x,-Math.PI,Math.PI),this._setZoom(o.aA(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.ae(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,a)*this.tileSize))}zoomFromMercatorZAdjusted(a){let u=0,g=o.cK,x=0,S=1/0;for(;g-u>1e-6&&g>u;){const E=u+.5*(g-u),R=this.tileSize*Math.pow(2,E),O=this.getCameraToCenterDistance(this.projection,E,R),$=this.scaleZoom(O/(Math.max(0,a)*this.tileSize)),U=Math.abs(E-$);U<S&&(S=U,x=E),E<$?u=E:g=E}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,u){const g=Math.min(a.x,u.x),x=Math.max(a.x,u.x),S=Math.min(a.y,u.y),E=Math.max(a.y,u.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const R=[new o.P(g,S),new o.P(x,E),new o.P(g,E),new o.P(x,S)],O=this.renderWorldCopies?-3:0,$=this.renderWorldCopies?4:1;for(const U of R){const q=this.pointRayIntersection(U);if(q.t<0)return!0;const H=this.rayIntersectionCoordinate(q);if(H.x<O||H.y<0||H.x>$||H.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(a,u){const g=o.ag(o.av([],this._camera.position,a)),x=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const a=function([u,g,x],S){const E=[u,g,x,1];o.aC(E,E,S);const R=E[3]=Math.max(E[3],1e-6);return E[0]/=R,E[1]/=R,E[2]/=R,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,a))}}getCameraToCenterDistance(a,u=this.zoom,g=this.worldSize){const x=o.cN(a,u,this.width,this.height,1024),S=a.pixelSpaceConversion(this.center.lat,g,x);let E=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(E=o.ak(1,E,o.c$(this.pitch>=ed?1:this.pitch/ed))),E}getWorldToCameraMatrix(){const a=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.aB(a,a,this.globeMatrix),a}getFrustum(a){return o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,this.projection.zAxisUnit==="meters")}}const Cc=(m,a)=>{if(a>0&&m.terrain&&o.w("Cutoff is currently disabled on terrain"),a<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=m.transform,g=Math.max(Math.abs(u._zoom-(m.minCutoffZoom-1)),1),x=u.isLODDisabled(!1)?o.ah(60,45,u.pitch):o.ah(30,15,u.pitch),S=u._farZ-u._nearZ,E=a*u.height,R=((1-(O=x))*u.cameraToCenterDistance+O*(u._farZ+E))*g;var O;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(R-u._nearZ)/S,(R-E-u._nearZ)/S]}}},Ra={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class JE{constructor(a,u){this.aabb=a,this.lastCascade=u}}class QE{add(a,u){const g=this.receivers[a.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[a.key]=new JE(u,null)}clear(){this.receivers={}}get(a){return this.receivers[a.key]}computeRequiredCascades(a,u,g){const x=o.d8.fromPoints(a.points);let S=0;for(const E in this.receivers){const R=this.receivers[E];if(!R||!x.intersectsAabb(R.aabb))continue;R.aabb.min=x.closestPoint(R.aabb.min),R.aabb.max=x.closestPoint(R.aabb.max);const O=R.aabb.getCorners();for(let $=0;$<g.length;$++){let U=!0;for(const q of O){const H=[q[0]*u,q[1]*u,q[2]];if(o.af(H,H,g[$].matrix),H[0]<-1||H[0]>1||H[1]<-1||H[1]>1){U=!1;break}}if(R.lastCascade=$,S=Math.max(S,$),U)break}}return S+1}}class Nf{constructor(a){this.painter=a,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new QE,this._depthMode=new Hn(a.context.gl.LEQUAL,Hn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,a.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),a.tp.registerParameter(Ra,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),a.tp.registerParameter(Ra,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),a.tp.registerParameter(Ra,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),a.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const a of this._cascades)a.texture.destroy(),a.framebuffer.destroy();this._cascades=[]}updateShadowParameters(a,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const x=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((Q,ae)=>{const ue=g.style._mergedLayers[ae];return Q+(ue.hasShadowPass()&&!ue.isHidden(a.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=g.context,E=Ra.shadowMapResolution,R=Ra.shadowMapResolution;if(this._cascades.length===0||Ra.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let Q=0;Q<Ra.cascadeCount;++Q){const ae=g._shadowMapDebug,ue=S.gl,ce=S.createFramebuffer(E,R,ae,"texture"),pe=new o.T(S,{width:E,height:R,data:null},ue.DEPTH_COMPONENT16);if(ce.depthAttachment.set(pe.texture),ae){const Ce=new o.T(S,{width:E,height:R,data:null},ue.RGBA8);ce.colorAttachment.set(Ce.texture)}this._cascades.push({framebuffer:ce,texture:pe,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.cA,scale:0})}}this.shadowDirection=xb(u);let O=0;if(a.elevation){const Q=a.elevation,ae=[1e4,-1e4];Q.visibleDemTiles.filter(ue=>ue.dem).forEach(ue=>{const ce=ue.dem.tree;ae[0]=Math.min(ae[0],ce.minimums[0]),ae[1]=Math.max(ae[1],ce.maximums[0])}),ae[0]!==1e4&&(O=(ae[1]-ae[0])*Q.exaggeration())}const $=1.5*a.cameraToCenterDistance,U=3*$,q=new Float64Array(16);for(let Q=0;Q<this._cascades.length;++Q){const ae=this._cascades[Q];let ue=a.height/50,ce=1;Ra.cascadeCount===1?ce=U:Q===0?ce=$:(ue=$,ce=U);const[pe,Ce]=bb(a,this.shadowDirection,ue,ce,Ra.shadowMapResolution,O);ae.scale=a.scale,ae.matrix=pe,ae.boundingSphereRadius=Ce,o.bk(q,ae.matrix),ae.frustum=o.cA.fromInvProjectionMatrix(q,1,0,!0),ae.far=ce}const H=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[H].far,this._cascades[H].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ra.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ra.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ma.ShadowMap0,this._uniformValues.u_shadowmap_1=Ma.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const X=g.transform.elevation;for(const Q of this._groundShadowTiles){let ae={min:0,max:0};if(X){const ue=X.getMinMaxForTile(Q);ue&&(ae=ue)}this.addShadowReceiver(Q.toUnwrapped(),ae.min,ae.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(a){this._enabled=a}drawShadowPass(a,u){if(!this.enabled)return;const g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,Ra.shadowMapResolution,Ra.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){g.currentShadowCascade=S,x.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),x.clear({color:o.ao.white,depth:1});for(const E of a.order){const R=a._mergedLayers[E];if(!R.hasShadowPass()||R.isHidden(g.transform.zoom))continue;const O=a.getLayerSourceCache(R),$=O?u[O.id]:void 0;(R.type==="model"||$&&$.length)&&g.renderLayer(g,O,R,$)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const a=this.painter,u=a.style,g=a.context,x=g.gl,S=u.directionalLight,E=u.ambientLight;if(!S||!E)return;const R=[],O=Cc(a,a.longestCutoffRange);O.shouldRenderCutoff&&R.push("RENDER_CUTOFF"),R.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&R.push("NORMAL_OFFSET");const $=ml(u,S,E),U=new Hn(x.LEQUAL,Hn.ReadOnly,a.depthRangeFor3D),q=new Tr({func:x.EQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.KEEP);for(const H of this._groundShadowTiles){const X=H.toUnwrapped(),Q=a.isTileAffectedByFog(H),ae=a.getOrCreateProgram("groundShadow",{defines:R,overrideFog:Q});this.setupShadows(X,ae),a.uploadCommonUniforms(g,ae,X,null,O);const ue={u_matrix:a.transform.calculateProjMatrix(X),u_ground_shadow_factor:$};ae.draw(a,x.TRIANGLES,U,q,jr.multiply,xr.disabled,ue,"ground_shadow",a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments,null,a.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?jr.unblended:jr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(a){const u=this.painter.transform,g=u.calculatePosMatrix(a,u.worldSize);return o.aB(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(a){const u=o.by(a);return o.aB(u,this._cascades[this.painter.currentShadowCascade].matrix,a),u}setupShadows(a,u,g){if(!this.enabled)return;const x=this.painter.transform,S=this.painter.context,E=S.gl,R=this._uniformValues,O=new Float64Array(16),$=x.calculatePosMatrix(a,x.worldSize);for(let U=0;U<this._cascades.length;U++)o.aB(O,this._cascades[U].matrix,$),R[U===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),S.activeTexture.set(E.TEXTURE0+Ma.ShadowMap0+U),this._cascades[U].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=!!g,this.useNormalOffset){const U=o.d6(a.canonical),q=2/x.tileSize*o.al/Ra.shadowMapResolution,H=q*this._cascades[0].boundingSphereRadius,X=q*this._cascades[this._cascades.length-1].boundingSphereRadius,Q=(g==="vector-tile"?1:3)*function(ae,ue,ce,pe,Ce){const ve=o.aA((ae-22)/-22,0,1);return .125*(1-ve)+4*ve}(x.zoom);R.u_shadow_normal_offset=[U,H*Q,X*Q],R.u_shadow_bias=[1e-4,.0012,.012]}else R.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(S,R)}setupShadowsFromMatrix(a,u,g=!1){if(!this.enabled)return;const x=this.painter.context,S=x.gl,E=this._uniformValues,R=new Float64Array(16);for(let O=0;O<Ra.cascadeCount;O++)o.aB(R,this._cascades[O].matrix,a),E[O===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(R),x.activeTexture.set(S.TEXTURE0+Ma.ShadowMap0+O),this._cascades[O].texture.bindExtraParam(S.LINEAR,S.LINEAR,S.CLAMP_TO_EDGE,S.CLAMP_TO_EDGE,S.GREATER);if(this.useNormalOffset=g,g){const O=Ra.normalOffset;E.u_shadow_normal_offset=[1,O,O],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(x,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(a,u,g,x){if(x[2]>=0)return{};const S=function(O,$,U){const q=U/(1<<O.canonical.z);return new o.d8([O.canonical.x*q+O.wrap*U,O.canonical.y*q+O.wrap*U,0],[(O.canonical.x+1)*q+O.wrap*U,(O.canonical.y+1)*q+O.wrap*U,$])}(a,u,g).getCorners(),E=u/-x[2];x[0]<0?(o.d7(S[0],S[0],[x[0]*E,0,0]),o.d7(S[3],S[3],[x[0]*E,0,0])):x[0]>0&&(o.d7(S[1],S[1],[x[0]*E,0,0]),o.d7(S[2],S[2],[x[0]*E,0,0])),x[1]<0?(o.d7(S[0],S[0],[0,x[1]*E,0]),o.d7(S[1],S[1],[0,x[1]*E,0])):x[1]>0&&(o.d7(S[2],S[2],[0,x[1]*E,0]),o.d7(S[3],S[3],[0,x[1]*E,0]));const R={};return R.vertices=S,R.planes=[ou(S[1],S[0],S[4]),ou(S[2],S[1],S[5]),ou(S[3],S[2],S[6]),ou(S[0],S[3],S[7])],R}addShadowReceiver(a,u,g){this._receivers.add(a,o.d8.fromTileIdAndHeight(a,u,g))}getMaxCascadeForTile(a){const u=this._receivers.get(a);return u&&u.lastCascade?u.lastCascade:0}}function ou(m,a,u){const g=o.av([],u,a),x=o.av([],m,a),S=o.bH([],g,x),E=o.ag(S);return E===0?[0,0,1,0]:(o.c4(S,S,1/E),[S[0],S[1],S[2],-o.bI(S,a)])}function xb(m){const a=m.properties.get("direction"),u=o.d3(a.x,a.y,a.z);u[2]=o.aA(u[2],0,75);const g=o.d5([u[0],u[1],u[2]]);return o.d4(g.x,g.y,g.z)}function ml(m,a,u){const g=a.properties.get("color-use-theme")==="none",x=a.properties.get("color"),S=a.properties.get("intensity"),E=a.properties.get("direction"),R=[E.x,E.y,E.z],O=u.properties.get("color-use-theme")==="none",$=u.properties.get("color"),U=u.properties.get("intensity"),q=Math.max(o.bI([0,0,1],R),0),H=[0,0,0];o.c4(H,$.toPremultipliedRenderColor(O?null:m.getLut(a.scope)).toArray01Linear().slice(0,3),U);const X=[0,0,0];return o.c4(X,x.toPremultipliedRenderColor(g?null:m.getLut(u.scope)).toArray01Linear().slice(0,3),q*S),o.da([H[0]>0?H[0]/(H[0]+X[0]):0,H[1]>0?H[1]/(H[1]+X[1]):0,H[2]>0?H[2]/(H[2]+X[2]):0])}function bb(m,a,u,g,x,S){const E=m.zoom,R=m.scale,O=m.worldSize,$=1/O,U=m.aspect,q=Math.sqrt(1+U*U)*Math.tan(.5*m.fovX),H=q*q,X=g-u,Q=g+u;let ae,ue;H>X/Q?(ae=g,ue=g*q):(ae=.5*Q*(1+H),ue=.5*Math.sqrt(X*X+2*(g*g+u*u)*H+Q*Q*H*H));const ce=m.projection.pixelsPerMeter(m.center.lat,O),pe=m._camera.getCameraToWorldMercator(),Ce=[0,0,-ae*$];o.af(Ce,Ce,pe);let ve=ue*$;const Fe=m._edgeInsets;if(!(Fe.left===0&&Fe.top===0&&Fe.right===0&&Fe.bottom===0||Fe.left===Fe.right&&Fe.top===Fe.bottom)){const Kt=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?ce:1),pn=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,u,g);pn[8]=2*-m.centerOffset.x/m.width,pn[9]=2*m.centerOffset.y/m.height;const Nn=new Float64Array(16);o.cO(Nn,pn,Kt);const an=new Float64Array(16);o.bk(an,Nn);const dn=o.cA.fromInvProjectionMatrix(an,O,E,!0);for(const jn of dn.points){const Mn=((Ie=jn)[0]/=R,Ie[1]/=R,Ie[2]=o.ce(Ie[2],m._center.lat),Ie);ve=Math.max(ve,o.c5(o.d9([],Ce,Mn)))}}var Ie;ve*=x/(x-1);const $e=Math.acos(a[2]),Le=Math.atan2(-a[0],-a[1]),Me=new pm;Me.position=Ce,Me.setPitchBearing($e,Le);const Ve=Me.getWorldToCamera(O,ce),st=ve*O,nt=Math.min(m._mercatorZfromZoom(17)*O*-2,-2*st),Et=Me.getCameraToClipOrthographic(-st,st,-st,st,nt,(st+S*ce)/a[2]),mt=new Float64Array(16);o.aB(mt,Et,Ve);const Lt=o.d4(Math.floor(1e6*Ce[0])/1e6*O,Math.floor(1e6*Ce[1])/1e6*O,0),ln=.5*x,ht=[0,0,0];o.af(ht,Lt,mt),o.c4(ht,ht,ln);const Qe=[Math.floor(ht[0]),Math.floor(ht[1]),Math.floor(ht[2])],kt=[0,0,0];o.av(kt,ht,Qe),o.c4(kt,kt,-1/ln);const gt=new Float64Array(16);return o.bz(gt),o.bq(gt,gt,kt),o.aB(mt,gt,mt),[mt,st]}class mm extends o.E{constructor(a){super(),this.requestManager=a,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(a,u){return o.db(this.requestManager.transformRequest(u,o.R.Model).url).then(g=>{if(!g)return;const x=o.dc(g),S=new o.dd(a,u,void 0,void 0,x);return S.computeBoundsAndApplyParent(),S}).catch(g=>{if(g&&g.status===404)return null;this.fire(new o.y(new Error(`Could not load model ${a} from ${u}: ${g.message}`)))})}load(a,u,g={forceReload:!1}){this.models[u]||(this.models[u]={});const x=Object.keys(a),S=[],E=[];for(const R of x){const O=a[R];this.hasURLBeenRequested(O)&&!g.forceReload||(this.modelByURL[O]={modelId:R,scope:u},S.push(this.loadModel(R,O)),E.push(R)),this.models[u][R]||(this.models[u][R]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+E.length,Promise.allSettled(S).then(R=>{for(let O=0;O<R.length;O++){const{status:$}=R[O];if($==="rejected")continue;const{value:U}=R[O];this.models[u][E[O]]||(this.models[u][E[O]]={model:null,numReferences:1}),this.models[u][E[O]].model=U}this.numModelsLoading[u]-=E.length,this.fire(new o.z("data",{dataType:"style"}))}).catch(R=>{this.fire(new o.y(new Error(`Could not load models: ${R.message}`)))})}isLoaded(){for(const a in this.numModelsLoading)if(this.numModelsLoading[a]>0)return!1;return!0}hasModel(a,u,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(a,u):this.getModelByURL(this.modelUris[u][a]))}getModel(a,u){return this.models[u]||(this.models[u]={}),this.models[u][a]?this.models[u][a].model:void 0}getModelByURL(a){if(!a)return null;const u=this.modelByURL[a];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(a,u){return this.models[u]&&this.models[u][a]!==void 0}getModelURIs(a){return this.modelUris[a]||{}}addModel(a,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const x=this.requestManager.normalizeModelURL(u);if((this.hasModel(a,g,{exactIdMatch:!0})||this.hasModelBeenAdded(a,g))&&this.modelUris[g][a]===x)this.models[g][a].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:S,modelId:E}=this.modelByURL[x];this.models[S][E].numReferences++}else this.modelUris[g][a]=x,this.load({[a]:this.modelUris[g][a]},g)}addModelURLs(a,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const x in a)g[x]=this.requestManager.normalizeModelURL(a[x])}reloadModels(a){this.load(this.modelUris[a],a,{forceReload:!0})}addModelsFromBucket(a,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const x of a)this.hasModel(x,u,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[u][x].numReferences++:this.modelUris[u][x]&&!this.hasURLBeenRequested(x)?g[x]=this.modelUris[u][x]:!this.hasURLBeenRequested(x)&&o.de(x,!1)&&(this.modelUris[u][x]=this.requestManager.normalizeModelURL(x),g[x]=this.modelUris[u][x]);this.load(g,u)}hasURLBeenRequested(a){return this.modelByURL[a]!==void 0}removeModel(a,u,g=!1,x=!1){if(this.models[u]&&this.models[u][a]&&(this.models[u][a].numReferences--,this.models[u][a].numReferences===0||x)){const S=this.modelUris[u][a];g||delete this.modelUris[u][a],delete this.modelByURL[S];const E=this.models[u][a].model;if(!E)return;delete this.models[u][a],E.destroy()}}destroy(){for(const a of Object.keys(this.models))for(const u of Object.keys(this.models[a])){const g=this.models[a][u].model;delete this.models[a][u],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(a){return this.models[a]||(this.models[a]={}),Object.keys(this.models[a])}upload(a,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(a.context)}}const Bf=o.a6.colorTheme,au=new o.a9({data:new o.aa(Bf.data)});function eT(m){if(!m.metadata||!m.metadata.content_area)return;const a=o.o.devicePixelRatio,{left:u,top:g,width:x,height:S}=m.metadata.content_area,E=u*a,R=g*a;return[E,R,E+x*a,R+S*a]}function wb(m){if(m)return m.map(([a,u])=>[a*o.o.devicePixelRatio,u*o.o.devicePixelRatio])}class tT{constructor(a,u,g){this.id=a,this.scope=u,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(a){this.missingRequests.has(a.name)||this.pendingRequests.has(a.name)||this.pendingRequests.add(a.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const a=new Map;if(!this.sourceCache.loaded())return a;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return a;const g=this.sourceCache.getSource();if(!(g instanceof nr))return a;const x=u.map(E=>this.sourceCache.getTile(E)),S=g.getImages(x,Array.from(this.pendingRequests));for(const[E,R]of S)a.set(o.I.from({name:E,iconsetId:this.id}),R),this.pendingRequests.delete(E);for(const E of this.pendingRequests)this.missingRequests.add(E);return this.pendingRequests.clear(),a}}const su=(m,a)=>re(m,a&&a.filter(u=>u.identifier!=="source.canvas")),nT=o.aH(ci,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setLayerProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),d_=o.aH(ci,["setCenter","setZoom","setBearing","setPitch"]),gm=new Set(["background","sky","slot","custom"]),h_={version:8,layers:[],sources:{}},f_={duration:300,delay:0};class gl extends o.E{constructor(a,u={}){super(),this.map=a,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=Object.assign({},f_),this._buildingIndex=new Do(this),this.crossTileSymbolIndex=new Sc,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedIndoor={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._hasAppearances=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._importedAsBasemap=!1,this._changes=u.styleChanges||new bt,this.dispatcher=u.dispatcher?u.dispatcher:new o.D(o.dg(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new tn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new o.dh(a._requestManager,u.localFontFamily?o.di.all:u.localIdeographFontFamily?o.di.ideographs:o.di.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new mm(a._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._indoorDependentLayers=u.indoorDependentLayers?u.indoorDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",o.dj());const g=this;this._rtlTextPluginCallback=gl.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(S,E)=>{if(o.dk(S),E&&E.every(R=>R))for(const R in g._sourceCaches){const O=g._sourceCaches[R],$=O.getSource().type;$!=="vector"&&$!=="geojson"||O.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const S=this.getOwnSource(x.sourceId);if(S&&S.vectorLayerIds)for(const E in this._layers){const R=this._layers[E];R.source===S.id&&this._validateLayer(R)}})}load(a){return a?(typeof a=="string"?this.loadURL(a):this.loadJSON(a),this):this}_getGlobalId(a){if(!a)return null;if(typeof a=="string"){if(o.h(a))return a;const u=o.dl(a);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${o.dm(JSON.stringify(a))}`}_diffStyle(a,u,g){this.globalId=this._getGlobalId(a);const x=(S,E)=>{try{E(null,this.setState(S,g))}catch(R){E(R,!1)}};if(typeof a=="string"){const S=this.map._requestManager.normalizeStyleURL(a),E=this.map._requestManager.transformRequest(S,o.R.Style);o.m(E,(R,O)=>{R?this.fire(new o.y(R)):O&&x(O,u)})}else typeof a=="object"&&x(a,u)}loadURL(a,u={}){this.fire(new o.z("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!o.h(a);this.globalId=this._getGlobalId(a),a=this.map._requestManager.normalizeStyleURL(a,u.accessToken),this.resolvedImports.add(a);const x=this.importsCache.get(a);if(x)return this._load(x,g);const S=this.map._requestManager.transformRequest(a,o.R.Style);this._request=o.m(S,(E,R)=>{if(this._request=null,E)this.fire(new o.y(E));else if(R)return this.importsCache.set(a,R),this._load(R,g)})}loadJSON(a,u={}){this.fire(new o.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(a),this._request=o.o.frame(()=>{this._request=null,this._load(a,u.validate!==!1)})}loadEmpty(){this.fire(new o.z("dataloading",{dataType:"style"})),this._load(h_,!1)}_loadImports(a,u,g){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const S of a){const E=this._createFragmentStyle(S),R=new Promise(U=>{E.once("style.import.load",U),E.once("error",U)}).then(()=>this.mergeAll());if(x.push(R),this.resolvedImports.has(S.url)){E.loadEmpty();continue}const O=S.data||this.importsCache.get(S.url);O?(E.loadJSON(O,{validate:u}),this._isInternalStyle(O)&&(E.globalId=null)):S.url?E.loadURL(S.url,{validate:u}):E.loadEmpty();const $={style:E,id:S.id,config:S.config};if(g){const U=this.fragments.findIndex(({id:q})=>q===g);this.fragments=this.fragments.slice(0,U).concat($).concat(this.fragments.slice(U))}else this.fragments.push($)}return Promise.allSettled(x)}getImportGlobalIds(a=this,u=new Set){for(const g of a.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(a){const u=this.scope?o.B(a.id,this.scope):a.id;let g;const x=this._initialConfig&&this._initialConfig[u];(a.config||x)&&(g=Object.assign({},a.config,x));const S=new gl(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:a["color-theme"],configDependentLayers:this._configDependentLayers,indoorDependentLayers:this._indoorDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this._updateLayers(this._indoorDependentLayers),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(a){return this.isRootStyle()&&(a.fragment||!!a.schema&&a.fragment!==!1)}_load(a,u){if(this._isInternalStyle(a)){const S=Object.assign({},h_,{imports:[{id:"basemap",data:a,url:""}]},a.center?{center:a.center}:{},a.bearing?{bearing:a.bearing}:{},a.pitch?{pitch:a.pitch}:{},a.zoom?{zoom:a.zoom}:{},a.light?{light:a.light}:{});return this._importedAsBasemap=!0,void this._load(S,u)}if(this.updateConfig(this._config,a.schema),u&&su(this,Vr(a)))return;this._loaded=!0,this.stylesheet=o.dn(a);const g=()=>{for(const O in a.sources)this.addSource(O,a.sources[O],{validate:!1,isInitialLoad:!0});if(a.iconsets)for(const O in a.iconsets)this.addIconset(O,a.iconsets[O]);a.sprite?this._loadIconset(a.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&a.glyphs&&this.glyphManager.setURL(a.glyphs);const S=bo(this.stylesheet.layers);if(this._order=S.map(O=>O.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const O=this.stylesheet.lights[0];this.light=new Re(O.properties,O.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Re(this.stylesheet.light)),this._layers={};for(const O of S){const $=o.dt(O,this.scope,this._styleColorTheme.lut,this.options);$.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add($.fqid),$.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add($.fqid),this._hasAppearances=this._hasAppearances||$.getAppearances().length!==0,$.setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$;const U=this.getOwnLayerSourceCache($),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();U&&$.canCastShadows()&&q&&(U.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const E=this.stylesheet.terrain;E&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.z("data",{dataType:"style"}));const R=this.isRootStyle();a.imports?this._loadImports(a.imports,u).then(()=>{this._reloadImports(),this.fire(new o.z(R?"style.load":"style.import.load"))}).catch(O=>{this.fire(new o.y(new Error("Failed to load imports",O))),this.fire(new o.z(R?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.z(R?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const S=this._evaluateColorThemeData(x);this._loadColorTheme(S).then(()=>{g()}).catch(E=>{o.w(`Couldn't load color theme from the stylesheet: ${E}`),g()})}else this._styleColorTheme.lut=null,g()}isRootStyle(){return this.importDepth===0}hasAppearances(){return this._hasAppearances}mergeAll(){let a,u,g,x,S,E,R,O,$,U;const q={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(H=>{if(H.stylesheet){if(H.light!=null&&(a=H.light),H.stylesheet.lights)for(const X of H.stylesheet.lights)X.type==="ambient"&&H.ambientLight!=null&&(u=H.ambientLight),X.type==="directional"&&H.directionalLight!=null&&(g=H.directionalLight);x=this._prioritizeTerrain(x,H.terrain,H.stylesheet.terrain),H.stylesheet.fog&&H.fog!=null&&(S=H.fog),H.stylesheet.snow&&H.snow!=null&&(E=H.snow),H.stylesheet.rain&&H.rain!=null&&(R=H.rain),H.stylesheet.camera!=null&&(U=H.stylesheet.camera),H.stylesheet.projection!=null&&(O=H.stylesheet.projection),H.stylesheet.transition!=null&&($=H.stylesheet.transition),q[H.scope]=H._styleColorTheme}}),this.light=a,this.ambientLight=u,this.directionalLight=g,this.fog=S,this.snow=E,this.rain=R,this._styleColorThemeForScope=q,x===null?delete this.terrain:this.terrain=x,this.camera=U||{"camera-projection":"perspective"},this.projection=O||{name:"mercator"},this.transition=Object.assign({},f_,$),this.mergeSources(),this.mergeLayers(),this.mergeIndoor()}forEachFragmentStyle(a){const u=g=>{for(const x of g.fragments)u(x.style);a(g)};u(this)}_prioritizeTerrain(a,u,g){const x=a&&a.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:x?a:null:u!=null&&(!a||x||u&&u.drapeRenderMode===1)?u:a}mergeTerrain(){let a;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{a=this._prioritizeTerrain(a,u.terrain,u.stylesheet.terrain)}),a===null?delete this.terrain:this.terrain=a}mergeProjection(){let a;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(a=u.stylesheet.projection)}),this.projection=a||{name:"mercator"}}mergeSources(){const a={},u={},g={};this.forEachFragmentStyle(x=>{for(const S in x._sourceCaches){const E=o.B(S,x.scope);a[E]=x._sourceCaches[S]}for(const S in x._otherSourceCaches){const E=o.B(S,x.scope);u[E]=x._otherSourceCaches[S]}for(const S in x._symbolSourceCaches){const E=o.B(S,x.scope);g[E]=x._symbolSourceCaches[S]}}),this._mergedSourceCaches=a,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeIndoor(){this.forEachFragmentStyle(a=>{if(a.stylesheet&&a.stylesheet.indoor)for(const u of Object.values(a.stylesheet.indoor)){const g=u,x=o.B(g.sourceId,a.scope);this._mergedIndoor[x]=new Set(g.sourceLayers||[])}})}mergeLayers(){const a={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const R of E._order){const O=E._layers[R];if(O.type==="slot"){const $=o.dp(R);if(a[$])continue;a[$]=[]}O.slot&&a[O.slot]?a[O.slot].push(O):u.push(O)}}),this._mergedOrder=[];let x=-1;const S=(E=[])=>{for(const R of E)if(R.type==="slot"){const O=o.dp(R.id);a[O]&&S(a[O]),this._mergedSlots.push(O)}else{const O=o.B(R.id,R.scope);this._mergedOrder.push(O),g[O]=R,R.is3D(!!this.terrain)&&(this._has3DLayers=!0,x=this._mergedOrder.length-1),R.type==="circle"&&(this._hasCircleLayers=!0),R.type==="symbol"&&(this._hasSymbolLayers=!0),R.type==="clip"&&(this._clipLayerPresent=!0)}};if(S(u),this._has3DLayers){const E={};for(let R=0;R<this._mergedOrder.length;++R){const O=this._mergedOrder[R];E[O]=R===x?1:R<x?g[O].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort((R,O)=>E[R]-E[O])}this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(a){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,a),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(a){return a.data?function(u,g,x,S){const E=Object.assign({},g);for(const O of Object.keys(Bf))E[O]===void 0&&(E[O]=Bf[O].default);const R=new o.a8(au,u,new Map(x));return R.setTransitionOrValue(E,x),R.untransitioned().possiblyEvaluate(new o.ac(0,{worldview:void 0}))}(this.scope,a,this.options).get("data"):null}_loadColorTheme(a){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,x)=>{const S="data:image/png;base64,";if(!a||a.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let E=a;E.startsWith(S)||(E=S+E);const R=o.I.from("mapbox-reserved-lut"),O=new Image;O.src=E,O.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},O.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:$,height:U,data:q}=o.o.getImageData(O);if(U>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if($!==U*U)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(R)&&this.removeImage(R),this.addImage(R,{data:new o.q({width:$,height:U},q),pixelRatio:1,sdf:!1,usvg:!1,version:0});const H=this.imageManager.getImage(R,this.scope);H?(this._styleColorTheme.lut={image:H.data,data:a},g()):x(new Error("Missing LUT image."))}})}getLut(a){const u=this._styleColorThemeForScope[a];return u?u.lut:null}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(a){this._spriteRequest=function(u,g,x){let S,E,R;const O=o.o.devicePixelRatio>1?"@2x":"";let $=o.m(g.transformRequest(g.normalizeSpriteURL(u,O,".json"),o.R.SpriteJSON),(H,X)=>{$=null,R||(R=H,S=X,q())}),U=o.n(g.transformRequest(g.normalizeSpriteURL(u,O,".png"),o.R.SpriteImage),(H,X)=>{U=null,R||(R=H,E=X,q())});function q(){if(R)x(R);else if(S&&E){const H=o.o.getImageData(E),X={};for(const Q in S){const{width:ae,height:ue,x:ce,y:pe,sdf:Ce,pixelRatio:ve,stretchX:Fe,stretchY:Ie,content:$e}=S[Q],Le=new o.q({width:ae,height:ue});o.q.copy(H,Le,{x:ce,y:pe},{x:0,y:0},{width:ae,height:ue},null),X[Q]={data:Le,pixelRatio:ve!==void 0?ve:1,sdf:Ce!==void 0&&Ce,stretchX:Fe,stretchY:Ie,content:$e,usvg:!1,version:0}}x(null,X)}}return{cancel(){$&&($.cancel(),$=null),U&&(U.cancel(),U=null)}}}(a,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new o.y(u));else if(g){const x=new Map;for(const S in g)x.set(o.I.from(S),g[S]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.z("data",{dataType:"style"}))})}addIconset(a,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSourceCache(u.source);if(!g)return void this.fire(new o.y(new Error(`Source "${u.source}" as specified by iconset "${a}" does not exist and cannot be used as an iconset source`)));const x=g.getSource();if(x.type!=="raster-array")return void this.fire(new o.y(new Error(`Source "${u.source}" as specified by iconset "${a}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const S=new tT(a,this.scope,g);this.imageManager.addImageProvider(S,this.scope)}removeIconset(a){this.imageManager.removeImageProvider(a,this.scope)}_loadIconset(a){if(!o.h(a)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(a);const u=this.map._spriteFormat==="auto";var g,x;this._spriteRequest=(x=(S,E)=>{if(this._spriteRequest=null,S)u?this._loadSprite(a):this.fire(new o.y(S));else if(E){const R=new Map;for(const O in E)R.set(o.I.from(O),E[O]);this.addImages(R)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.z("data",{dataType:"style"}))},o.bt((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(a),o.R.Iconset),(S,E)=>{if(S)return void x(S);const R={},O=o.df(new o.bs(E));for(const $ of O.icons){const U={version:1,pixelRatio:o.o.devicePixelRatio,content:eT($),stretchX:$.metadata?wb($.metadata.stretch_x_areas):void 0,stretchY:$.metadata?wb($.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:$};R[$.name]=U}x(null,R)}))}_validateLayer(a){const u=this.getOwnSource(a.source);if(!u)return;const g=a.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.y(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:a}of this.fragments)if(!a.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((a,u)=>{const g=this.fragments[u];return g&&g.style&&(a.data=g.style.serialize()),a})}_serializeSources(){const a={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();a[g.id]||(a[g.id]=g.serialize())}return a}_serializeLayers(a){const u=[];for(const g of a){const x=this._layers[g];x&&x.type!=="custom"&&u.push(x.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(a){return a?this.order:this._mergedOrder}isLayerDraped(a){return!!this.terrain&&a.isDraped(this.getLayerSourceCache(a))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(a){const u=this.getOwnLayer(a);if(u)return u;this.fire(new o.y(new Error(`The layer '${a}' does not exist in the map's style.`)))}_checkSource(a){const u=this.getOwnSource(a);if(u)return u;this.fire(new o.y(new Error(`The source '${a}' does not exist in the map's style.`)))}precompilePrograms(a,u){const g=this.map.painter;if(g)for(let x=a.minzoom||0;x<(a.maxzoom||25.5);x++){const S=a.getProgramIds();if(S)for(const E of S){const R=a.getDefaultProgramParams(E,u.zoom,this._styleColorTheme.lut);R&&(g.style=this,this.fog&&(g._fogVisible=!0,R.overrideFog=!0,g.getOrCreateProgram(E,R)),g._fogVisible=!1,R.overrideFog=!1,g.getOrCreateProgram(E,R),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(R.overrideRtt=!0,g.getOrCreateProgram(E,R)))}}}update(a){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(a),this.directionalLight&&this.directionalLight.recalculate(a);const u=this.calculateLightsBrightness();a.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),a.worldview!==this._worldview&&(this._worldview=a.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const g=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const R=this._changes.getLayerUpdatesByScope();for(const O in R){const{updatedIds:$,removedIds:U}=R[O];($||U)&&(this._updateWorkerLayers(O,$,U),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(a),this.light&&this.light.updateTransitions(a),this.ambientLight&&this.ambientLight.updateTransitions(a),this.directionalLight&&this.directionalLight.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this.snow&&this.snow.updateTransitions(a),this.rain&&this.rain.updateTransitions(a),this._changes.reset()}const S={};for(const R in this._mergedSourceCaches){const O=this._mergedSourceCaches[R];S[R]=O.used,O.used=!1,O.tileCoverLift=0}for(const R of this._mergedOrder){const O=this._mergedLayers[R];if(O.recalculate(a,this._availableImages),!O.isHidden(a.zoom)){const $=this.getLayerSourceCache(O);$&&($.used=!0,$.tileCoverLift=Math.max($.tileCoverLift,O.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(O,a)}):this.precompilePrograms(O,a))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const E=this.imageManager.getPendingImageProviders();for(const R of E)R.sourceCache.used=!0;for(const R in S){const O=this._mergedSourceCaches[R];S[R]!==O.used&&O.getSource().fire(new o.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light&&this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.snow&&this.snow.recalculate(a),this.rain&&this.rain.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new o.z("data",{dataType:"style"}))}updateImageProviders(){const a=this.imageManager.getPendingImageProviders();for(const u of a){const g=u.resolvePendingRequests(),x=this.getFragmentStyle(u.scope);x&&x.addImages(g)}}_updateTilesForChangedImages(){const a={};for(const u in this._mergedSourceCaches){const g=this._mergedSourceCaches[u].getSource().scope;a[g]=a[g]||this._changes.getUpdatedImages(g),a[g].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],a[g])}for(const u in a)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(a,u,g){const x=this.getFragmentStyle(a);x&&this.dispatcher.broadcast("updateLayers",{layers:u?x._serializeLayers(u):[],scope:a,removedIds:g||[],options:x.options})}setState(a,u){if(this._checkLoaded(),su(this,Vr(a)))return!1;(a=o.dn(a)).layers=bo(a.layers);const g=function(E,R){if(!E)return[{command:ci.setStyle,args:[R]}];let O=[];try{if(!o.bx(E.version,R.version))return[{command:ci.setStyle,args:[R]}];if(o.bx(E.center,R.center)||O.push({command:ci.setCenter,args:[R.center]}),o.bx(E.zoom,R.zoom)||O.push({command:ci.setZoom,args:[R.zoom]}),o.bx(E.bearing,R.bearing)||O.push({command:ci.setBearing,args:[R.bearing]}),o.bx(E.pitch,R.pitch)||O.push({command:ci.setPitch,args:[R.pitch]}),o.bx(E.sprite,R.sprite)||O.push({command:ci.setSprite,args:[R.sprite]}),o.bx(E.glyphs,R.glyphs)||O.push({command:ci.setGlyphs,args:[R.glyphs]}),o.bx(E.imports,R.imports)||function(X=[],Q=[],ae){Q=Q||[];const ue=(X=X||[]).map(Tf),ce=Q.map(Tf),pe=X.reduce(If,{}),Ce=Q.reduce(If,{}),ve=ue.slice();let Fe,Ie,$e,Le;for(Fe=0,Ie=0;Fe<ue.length;Fe++)$e=ue[Fe],Ce.hasOwnProperty($e)?Ie++:(ae.push({command:ci.removeImport,args:[$e]}),ve.splice(ve.indexOf($e,Ie),1));for(Fe=0,Ie=0;Fe<ce.length;Fe++)$e=ce[ce.length-1-Fe],ve[ve.length-1-Fe]!==$e&&(pe.hasOwnProperty($e)?(ae.push({command:ci.removeImport,args:[$e]}),ve.splice(ve.lastIndexOf($e,ve.length-Ie),1)):Ie++,Le=ve[ve.length-Fe],ae.push({command:ci.addImport,args:[Ce[$e],Le]}),ve.splice(ve.length-Fe,0,$e));for(const Me of Q){const Ve=pe[Me.id];Ve&&(delete Ve.data,o.bx(Ve,Me)||ae.push({command:ci.updateImport,args:[Me.id,Me]}))}}(E.imports,R.imports,O),o.bx(E.transition,R.transition)||O.push({command:ci.setTransition,args:[R.transition]}),o.bx(E.light,R.light)||O.push({command:ci.setLight,args:[R.light]}),o.bx(E.fog,R.fog)||O.push({command:ci.setFog,args:[R.fog]}),o.bx(E.snow,R.snow)||O.push({command:ci.setSnow,args:[R.snow]}),o.bx(E.rain,R.rain)||O.push({command:ci.setRain,args:[R.rain]}),o.bx(E.projection,R.projection)||O.push({command:ci.setProjection,args:[R.projection]}),o.bx(E.lights,R.lights)||O.push({command:ci.setLights,args:[R.lights]}),o.bx(E.camera,R.camera)||O.push({command:ci.setCamera,args:[R.camera]}),o.bx(E.iconsets,R.iconsets)||function(X,Q,ae){let ue;for(ue in Q=Q||{},X=X||{})X.hasOwnProperty(ue)&&(Q.hasOwnProperty(ue)||ae.push({command:ci.removeIconset,args:[ue]}));for(ue in Q){if(!Q.hasOwnProperty(ue))continue;const ce=Q[ue];X.hasOwnProperty(ue)?o.bx(X[ue],ce)||(ae.push({command:ci.removeIconset,args:[ue]}),ae.push({command:ci.addIconset,args:[ue,ce]})):ae.push({command:ci.addIconset,args:[ue,ce]})}}(E.iconsets,R.iconsets,O),!o.bx(E["color-theme"],R["color-theme"]))return[{command:ci.setStyle,args:[R]}];const $={},U=[];(function(X,Q,ae,ue){let ce;for(ce in Q=Q||{},X=X||{})X.hasOwnProperty(ce)&&(Q.hasOwnProperty(ce)||iu(ce,ae,ue));for(ce in Q){if(!Q.hasOwnProperty(ce))continue;const pe=Q[ce];X.hasOwnProperty(ce)?o.bx(X[ce],pe)||(X[ce].type==="geojson"&&pe.type==="geojson"&&i_(X,Q,ce)?ae.push({command:ci.setGeoJSONSourceData,args:[ce,pe.data]}):Yl(ce,Q,ae,ue)):Zu(ce,Q,ae)}})(E.sources,R.sources,U,$);const q=[];E.layers&&E.layers.forEach(X=>{X.source&&$[X.source]?O.push({command:ci.removeLayer,args:[X.id]}):q.push(X)});let H=E.terrain;H&&$[H.source]&&(O.push({command:ci.setTerrain,args:[void 0]}),H=void 0),O=O.concat(U),o.bx(H,R.terrain)||O.push({command:ci.setTerrain,args:[R.terrain]}),function(X,Q,ae){Q=Q||[];const ue=(X=X||[]).map(Tf),ce=Q.map(Tf),pe=X.reduce(If,{}),Ce=Q.reduce(If,{}),ve=ue.slice(),Fe=Object.create(null);let Ie,$e,Le,Me,Ve,st,nt;for(Ie=0,$e=0;Ie<ue.length;Ie++)Le=ue[Ie],Ce.hasOwnProperty(Le)?$e++:(ae.push({command:ci.removeLayer,args:[Le]}),ve.splice(ve.indexOf(Le,$e),1));for(Ie=0,$e=0;Ie<ce.length;Ie++)Le=ce[ce.length-1-Ie],ve[ve.length-1-Ie]!==Le&&(pe.hasOwnProperty(Le)?(ae.push({command:ci.removeLayer,args:[Le]}),ve.splice(ve.lastIndexOf(Le,ve.length-$e),1)):$e++,st=ve[ve.length-Ie],ae.push({command:ci.addLayer,args:[Ce[Le],st]}),ve.splice(ve.length-Ie,0,Le),Fe[Le]=!0);for(Ie=0;Ie<ce.length;Ie++)if(Le=ce[Ie],Me=pe[Le],Ve=Ce[Le],!Fe[Le]&&!o.bx(Me,Ve))if(o.bx(Me.source,Ve.source)&&o.bx(Me["source-layer"],Ve["source-layer"])&&o.bx(Me.type,Ve.type)){for(nt in Ef(Me.layout,Ve.layout,ae,Le,null,ci.setLayoutProperty),Ef(Me.paint,Ve.paint,ae,Le,null,ci.setPaintProperty),o.bx(Me.slot,Ve.slot)||ae.push({command:ci.setSlot,args:[Le,Ve.slot]}),o.bx(Me.filter,Ve.filter)||ae.push({command:ci.setFilter,args:[Le,Ve.filter]}),o.bx(Me.minzoom,Ve.minzoom)&&o.bx(Me.maxzoom,Ve.maxzoom)||ae.push({command:ci.setLayerZoomRange,args:[Le,Ve.minzoom,Ve.maxzoom]}),Me)Me.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&nt!=="slot"&&(nt.indexOf("paint.")===0?Ef(Me[nt],Ve[nt],ae,Le,nt.slice(6),ci.setPaintProperty):o.bx(Me[nt],Ve[nt])||ae.push({command:ci.setLayerProperty,args:[Le,nt,Ve[nt]]}));for(nt in Ve)Ve.hasOwnProperty(nt)&&!Me.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&nt!=="slot"&&(nt.indexOf("paint.")===0?Ef(Me[nt],Ve[nt],ae,Le,nt.slice(6),ci.setPaintProperty):o.bx(Me[nt],Ve[nt])||ae.push({command:ci.setLayerProperty,args:[Le,nt,Ve[nt]]}))}else ae.push({command:ci.removeLayer,args:[Le]}),st=ve[ve.lastIndexOf(Le)+1],ae.push({command:ci.addLayer,args:[Ve,st]})}(q,R.layers,O)}catch($){console.warn("Unable to compute style diff:",$),O=[{command:ci.setStyle,args:[R]}]}return O}(this.serialize(),a).filter(E=>!(E.command in d_));if(g.length===0)return!1;const x=g.filter(E=>!(E.command in nT));if(x.length>0)throw new Error(`Unimplemented: ${x.map(E=>E.command).join(", ")}.`);const S=[];return g.forEach(E=>{S.push(this[E.command](...E.args))}),u&&Promise.all(S).then(u).catch(u),this.stylesheet=a,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(a){if(a.size===0)return this;for(const[u,g]of a.entries()){if(this.getImage(u))return this.fire(new o.y(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this}addImage(a,u){return this.getImage(a)?this.fire(new o.y(new Error(`An image with the name "${a.name}" already exists.`))):(this.imageManager.addImage(a,this.scope,u),this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this)}updateImage(a,u,g=!1){this.imageManager.updateImage(a,this.scope,u),g&&(this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})))}getImage(a){return this.imageManager.getImage(a,this.scope)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a,this.scope),this._changes.updateImage(a,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this):this.fire(new o.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(a){return this.modelManager.addModelURLs(a,this.scope),this._updateWorkerModels(),this.fire(new o.z("data",{dataType:"style"})),this}addModel(a,u,g={}){return this._checkLoaded(),this._validate(gr,`models.${a}`,u,null,g)||(this.modelManager.addModel(a,u,this.scope),this.fire(new o.z("data",{dataType:"style"}))),this}hasModel(a){return this.modelManager.hasModel(a,this.scope)}removeModel(a){return this.hasModel(a)?(this.modelManager.removeModel(a,this.scope,!1,!0),this.fire(new o.z("data",{dataType:"style"})),this):this.fire(new o.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(a,u,g={}){if(this._checkLoaded(),this.getOwnSource(a)!==void 0)throw new Error(`There is already a source with ID "${a}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Kr,`sources.${a}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=oi(a,u,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const S=E=>{const R=(E?"symbol:":"other:")+x.id,O=o.B(R,this.scope),$=this._sourceCaches[R]=new Ja(O,x,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=$,$.onAdd(this.map)};S(!1),u.type!=="vector"&&u.type!=="geojson"||S(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(a){this._checkLoaded();const u=this.getOwnSource(a);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===a)return this.fire(new o.y(new Error(`Source "${a}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===a)return this.fire(new o.y(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find(([S,E])=>E.type==="source"&&E.source===a);if(x)return this.fire(new o.y(new Error(`Source "${a}" cannot be removed while iconset "${x[0]}" is using it.`)))}const g=this.getOwnSourceCaches(a);for(const x of g){const S=o.dp(x.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(x.id),x.fire(new o.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(a,u){this._checkLoaded(),this.getOwnSource(a).setData(u),this._changes.setDirty()}getOwnSource(a){const u=this.getOwnSourceCache(a);return u&&u.getSource()}getOwnSources(){const a=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&a.push(g.getSource())}return a}areTilesLoaded(){const a=this._mergedSourceCaches;for(const u in a){const g=a[u]._tiles;for(const x in g){const S=g[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(a){if(this._checkLoaded(),!a)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const S of a){if(this._validate(ii,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(S),E.updateTransitions(u)}else this.ambientLight=new qr(S,rr||(rr=new o.a9({color:new o.aa(o.a6.properties_light_ambient.color),"color-use-theme":new o.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.aa(o.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(S),E.updateTransitions(u)}else this.directionalLight=new qr(S,En||(En=new o.a9({direction:new o.ap(o.a6.properties_light_directional.direction),color:new o.aa(o.a6.properties_light_directional.color),"color-use-theme":new o.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.aa(o.a6.properties_light_directional.intensity),"cast-shadows":new o.aa(o.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new o.aa(o.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new o.aa(o.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=Object.assign(u,{worldview:this.map.getWorldview()}),x=new o.ac(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const a=this.directionalLight,u=this.ambientLight;if(!a||!u)return;const g=H=>.2126*(H[0]<=.03928?H[0]/12.92:Math.pow((H[0]+.055)/1.055,2.4))+.7152*(H[1]<=.03928?H[1]/12.92:Math.pow((H[1]+.055)/1.055,2.4))+.0722*(H[2]<=.03928?H[2]/12.92:Math.pow((H[2]+.055)/1.055,2.4)),x=a.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),S=a.properties.get("intensity"),E=a.properties.get("direction"),R=1-o.d3(E.x,E.y,E.z)[2]/90,O=g(x)*S*R,$=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),U=u.properties.get("intensity"),q=g($)*U;return Number(((O+q)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const a=[];return this.directionalLight&&a.push(this.directionalLight.get()),this.ambientLight&&a.push(this.ambientLight.get()),a}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(a){if(a==null||a===""&&this.isRootStyle())return this;if(o.dq(a)){const u=o.dr(a),g=this.fragments.find(({id:S})=>S===u);if(!g)return;const x=o.dp(a);return g.style.getFragmentStyle(x)}{const u=this.fragments.find(({id:g})=>g===a);return u?u.style:void 0}}setFeaturesetSelectors(a){if(!a)return;const u={},g=(x,S="")=>`${x}::${S}`;this._featuresetSelectors={};for(const x in a){const S=this._featuresetSelectors[x]=[];for(const E of a[x].selectors){if(E.featureNamespace){const O=this.getOwnLayer(E.layer);if(!O){o.w(`Layer is undefined for selector: ${E.layer}`);continue}const $=g(O.source,O.sourceLayer);if($ in u&&u[$]!==E.featureNamespace){o.w(`"featureNamespace ${E.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}u[$]=E.featureNamespace}let R;if(E.properties)for(const O in E.properties){const $=o.U(E.properties[O]);$.result==="success"&&(R=R||{},R[O]=$.value)}S.push({layerId:E.layer,namespace:E.featureNamespace,properties:R,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(a){const u=this.getFragmentStyle(a);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const x in u.stylesheet.featuresets)g.push({featuresetId:x,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(a,u){const g=this.getFragmentStyle(u),x=g.stylesheet.featuresets;if(!x||!x[a])return this.fire(new o.y(new Error(`The featureset '${a}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const E of x[a].selectors){const R=g.getOwnLayer(E.layer);R&&S.push(R)}return S}getConfigProperty(a,u){const g=this.getFragmentStyle(a);if(!g)return null;const x=o.B(u,g.scope),S=g.options.get(x),E=S?S.value||S.default:null;return E?E.serialize():null}isIndoorEnabled(){return Object.keys(this._mergedIndoor).length>0}getIndoorSourceLayers(a,u){const g=o.B(a,u);return this._mergedIndoor[g]}setIndoorData(a,u){this.map.indoor.setIndoorData(u)}updateIndoorDependentLayers(){this._updateLayers(this._indoorDependentLayers),this.map._styleDirty=!0,this.map.triggerRepaint()}setConfigProperty(a,u,g){const x=this.getFragmentStyle(a);if(!x)return;const S=x.stylesheet.schema;if(!S||!S[u])return;const E=o.U(g);if(E.result!=="success")return void su(this,E.value);const R=E.value.expression,O=o.B(u,x.scope),$=x.options.get(O);if(!$)return;let U;const{minValue:q,maxValue:H,stepValue:X,type:Q,values:ae}=S[u],ue=o.U(S[u].default);ue.result==="success"&&(U=ue.value.expression),U?(this.options.set(O,Object.assign({},$,{value:R,default:U,minValue:q,maxValue:H,stepValue:X,type:Q,values:ae})),this.updateConfigDependencies(u)):this.fire(new o.y(new Error(`No schema defined for the config option "${u}" in the "${a}" fragment.`)))}getConfig(a){const u=this.getFragmentStyle(a);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const x={};for(const S in g){const E=o.B(S,u.scope),R=u.options.get(E),O=R?R.value||R.default:null;x[S]=O?O.serialize():null}return x}setConfig(a,u){const g=this.getFragmentStyle(a);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(a){const u=this.getFragmentStyle(a);return u?u.stylesheet.schema:null}setSchema(a,u){const g=this.getFragmentStyle(a);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(a,u){if(this._config=a,a||u)if(u)for(const g in u){let x,S;const E=o.U(u[g].default);if(E.result==="success"&&(x=E.value.expression),a&&a[g]!==void 0){const H=o.U(a[g]);H.result==="success"&&(S=H.value.expression)}const{minValue:R,maxValue:O,stepValue:$,type:U,values:q}=u[g];if(x){const H=o.B(g,this.scope);this.options.set(H,{default:x,value:S,minValue:R,maxValue:O,stepValue:$,type:U,values:q})}else this.fire(new o.y(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new o.y(new Error("Attempting to set config for a style without schema.")))}_updateLayers(a,u=()=>!0){for(const g of a){const x=this.getLayer(g);x&&u(x)&&(x.possiblyEvaluateVisibility(),this._updateLayer(x),this._changes.setDirty())}}updateConfigDependencies(a){this._updateLayers(this._configDependentLayers,u=>!a||u.expressionDependencies.configDependencies.has(a)),this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const x=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&x!==""||u._styleColorTheme.lut&&x!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(a,u,g={}){this._checkLoaded();const x=a.id;if(this._layers[x])return void this.fire(new o.y(new Error(`Layer with id "${x}" already exists on this map`)));let S;if(a.type==="custom"){if(su(this,o.ds(a)))return;S=o.dt(a,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof a.source=="object"&&(this.addSource(x,a.source),a=o.dn(a),a=Object.assign(a,{source:x})),this._validate(Fn,`layers.${x}`,a,{arrayIndex:-1},g))return;S=o.dt(a,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}})}const E=o.B(S.source,S.scope);S.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(E),S.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(E);let R=this._order.length;if(u){const q=this._order.indexOf(u);if(q===-1)return void this.fire(new o.y(new Error(`Layer with id "${u}" does not exist on this map.`)));S.slot===this._layers[u].slot?R=q:o.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(R,0,x),this._layerOrderChanged=!0,this._layers[x]=S;const O=this.getOwnLayerSourceCache(S),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&S.canCastShadows()&&$&&(O.castsShadows=!0);const U=this._changes.getRemovedLayer(S);if(U&&S.source&&O&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const q=o.B(S.source,S.scope);U.type!==S.type?this._changes.updateSourceCache(q,"clear"):(this._changes.updateSourceCache(q,"reload"),O.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(a,u){this._checkLoaded();const g=this._checkLayer(a);if(!g||a===u)return;const x=this._order.indexOf(a);this._order.splice(x,1);let S=this._order.length;if(u){const E=this._order.indexOf(u);if(E===-1)return void this.fire(new o.y(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?S=E:o.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,a),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(a){this._checkLoaded();const u=this._checkLayer(a);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(a);this._order.splice(g,1),delete this._layers[a],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._indoorDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const x=this.getOwnLayerSourceCache(u);if(x&&x.castsShadows){let S=!1;for(const E in this._layers)if(this._layers[E].source===u.source&&this._layers[E].canCastShadows()){S=!0;break}x.castsShadows=S}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(a){return this._layers[a]}hasLayer(a){return a in this._mergedLayers}hasLayerType(a){for(const u in this._layers)if(this._layers[u].type===a)return!0;return!1}setLayerZoomRange(a,u,g){this._checkLoaded();const x=this._checkLayer(a);x&&(x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(a,u){this._checkLoaded();const g=this._checkLayer(a);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(a,u,g={}){this._checkLoaded();const x=this._checkLayer(a);if(x&&!o.bx(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(Gt,`layers.${x.id}.filter`,u,{layerType:x.type},g)||(x.filter=o.dn(u),this._updateLayer(x)))}getFilter(a){const u=this._checkLayer(a);if(u)return o.dn(u.filter)}setLayoutProperty(a,u,g,x={}){this._checkLoaded();const S=this._checkLayer(a);if(S&&!o.bx(S.getLayoutProperty(u),g)){if(g!=null&&(!x||x.validate!==!1)&&su(S,Xn.call(Vr,{key:`layers.${a}.layout.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:o.a6,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(u,g),S.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),S.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(S.fqid),this._updateLayer(S)}}setLayerProperty(a,u,g,x={}){this._checkLoaded();const S=this._checkLayer(a);S&&(u==="appearances"?(S.setAppearances(g),this._changes.setDirty()):S.isPaintProperty(u)?this.setPaintProperty(a,u,g,x):this.setLayoutProperty(a,u,g,x))}getLayoutProperty(a,u){const g=this._checkLayer(a);if(g)return g.getLayoutProperty(u)}setPaintProperty(a,u,g,x={}){this._checkLoaded();const S=this._checkLayer(a);if(!S||o.bx(S.getPaintProperty(u),g)||g!=null&&(!x||x.validate!==!1)&&su(S,mn.call(Vr,{key:`layers.${a}.paint.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:o.a6})))return;const E=S.setPaintProperty(u,g);S.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),S.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(S.fqid),E&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(a,u){const g=this._checkLayer(a);if(g)return g.getPaintProperty(u)}setFeatureState(a,u){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){const{featuresetId:O,importId:$}=a.target,U=this.getFragmentStyle($),q=U.getFeaturesetLayers(O);for(const{source:H,sourceLayer:X}of q)U.setFeatureState({id:a.id,source:H,sourceLayer:X},u)}else if("layerId"in a.target){const{layerId:O}=a.target,$=this.getLayer(O);this.setFeatureState({id:a.id,source:$.source,sourceLayer:$.sourceLayer},u)}return}const g=a.source,x=a.sourceLayer,S=this._checkSource(g);if(!S)return;const E=S.type;if(E==="geojson"&&x)return void this.fire(new o.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!x)return void this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new o.y(new Error("The feature id parameter must be provided.")));const R=this.getOwnSourceCaches(g);for(const O of R)O.setFeatureState(x,a.id,u)}removeFeatureState(a,u){if(this._checkLoaded(),"target"in a){if("featuresetId"in a.target){const{featuresetId:O,importId:$}=a.target,U=this.getFragmentStyle($),q=U.getFeaturesetLayers(O);for(const{source:H,sourceLayer:X}of q)U.removeFeatureState({id:a.id,source:H,sourceLayer:X},u)}else if("layerId"in a.target){const{layerId:O}=a.target,$=this.getLayer(O);this.removeFeatureState({id:a.id,source:$.source,sourceLayer:$.sourceLayer},u)}return}const g=a.source,x=this._checkSource(g);if(!x)return;const S=x.type,E=S==="vector"?a.sourceLayer:void 0;if(S==="vector"&&!E)return void this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new o.y(new Error("A feature id is required to remove its specific state property.")));const R=this.getOwnSourceCaches(g);for(const O of R)O.removeFeatureState(E,a.id,u)}getFeatureState(a){if(this._checkLoaded(),"target"in a){let S;if("featuresetId"in a.target){const{featuresetId:E,importId:R}=a.target,O=this.getFragmentStyle(R),$=O.getFeaturesetLayers(E);for(const{source:U,sourceLayer:q}of $){const H=O.getFeatureState({id:a.id,source:U,sourceLayer:q});if(H&&!S)S=H;else if(!o.bx(S,H))return void this.fire(new o.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in a.target){const{layerId:E}=a.target,R=this.getLayer(E);S=this.getFeatureState({id:a.id,source:R.source,sourceLayer:R.sourceLayer})}return S}const u=a.source,g=a.sourceLayer,x=this._checkSource(u);if(x){if(x.type!=="vector"||g)return a.id===void 0&&this.fire(new o.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,a.id);this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(a){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,a),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const a=this.getTerrain(),u=a&&this.terrain&&this.terrain.scope===this.scope?a:this.stylesheet.terrain;return o.du({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(a){for(const u of Object.values(this._mergedLayers))a(u)&&this._updateLayer(u)}_updateLayer(a){this._changes.updateLayer(a);const u=this.getLayerSourceCache(a),g=o.B(a.source,a.scope),x=this._changes.getUpdatedSourceCaches();a.source&&!x[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const u=R=>this._mergedLayers[R].is3D(!!this.terrain),g=this.order,x={},S=[];for(let R=g.length-1;R>=0;R--){const O=g[R];if(u(O)){x[O]=R;for(const $ of a){const U=$[O];if(U)for(const q of U)S.push(q)}}}S.sort((R,O)=>O.intersectionZ-R.intersectionZ);const E=[];for(let R=g.length-1;R>=0;R--){const O=g[R];if(u(O))for(let $=S.length-1;$>=0;$--){const U=S[$].feature;if(U.layer&&x[U.layer.id]<R)break;E.push(U),S.pop()}else for(const $ of a){const U=$[O];if(U)for(const q of U)E.push(q.feature)}}return E}queryRasterValue(a,u,g){const x=this.getOwnSource(a);return x?x.type!=="raster-array"?(this.fire(new o.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):x.queryRasterArrayValue(u,g):(this.fire(new o.y(new Error(`Source with id "${a}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(a,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(Gt,"queryRenderedFeatures.filter",u.filter,null,u),x=o.b5(u.filter));const S={},E=U=>{if(gm.has(U.type))return;const q=this.getOwnLayerSourceCache(U),H=S[q.id]=S[q.id]||{sourceCache:q,layers:{},has3DLayers:!1};U.is3D(!!this.terrain)&&(H.has3DLayers=!0),H.layers[U.fqid]=H.layers[U.fqid]||{styleLayer:U,targets:[]},H.layers[U.fqid].targets.push({filter:x})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new o.y(new Error("parameters.layers must be an Array."))),[];for(const U of u.layers){const q=this._layers[U];if(!q)return this.fire(new o.y(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];E(q)}}else for(const U in this._layers)E(this._layers[U]);const R=this._queryRenderedFeatures(a,S,g),O=this._flattenAndSortRenderedFeatures(R),$=[];for(const U of O)o.dv(U.layer.id)===this.scope&&$.push(U);return $}queryRenderedFeatureset(a,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(Gt,"queryRenderedFeatures.filter",u.filter,null,u),x=o.b5(u.filter));const S="mock",E=[];if(u&&u.target)E.push(Object.assign({},u,{targetId:S,filter:x}));else{const U=this.getFeaturesetDescriptors();for(const q of U)E.push({targetId:S,filter:x,target:q});for(const{style:q}of this.fragments){const H=q.getFeaturesetDescriptors();for(const X of H)E.push({targetId:S,filter:x,target:X})}}const R=this.queryRenderedTargets(a,E,g),O=[],$=new Set;for(const U of R)for(const q of U.variants[S])ki(q,U,$)||O.push(new o.dw(U,q));return O}queryRenderedTargets(a,u,g){const x={},S=(R,O,$,U)=>{const q=x[O.id]=x[O.id]||{sourceCache:O,layers:{},has3DLayers:!1};if(q.layers[R.fqid]=q.layers[R.fqid]||{styleLayer:R,targets:[]},R.is3D(!!this.terrain)&&(q.has3DLayers=!0),!U)return $.uniqueFeatureID=!1,void q.layers[R.fqid].targets.push($);q.layers[R.fqid].targets.push(Object.assign({},$,{namespace:U.namespace,properties:U.properties,uniqueFeatureID:U.uniqueFeatureID}))};for(const R of u)if("featuresetId"in R.target){const{featuresetId:O,importId:$}=R.target,U=this.getFragmentStyle($);if(!U||!U._featuresetSelectors)continue;const q=U._featuresetSelectors[O];if(!q){this.fire(new o.y(new Error(`The featureset '${O}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const H of q){const X=U.getOwnLayer(H.layerId);X&&!gm.has(X.type)&&S(X,U.getOwnLayerSourceCache(X),R,H)}}else if("layerId"in R.target){const{layerId:O}=R.target,$=this.getLayer(O);if(!$||gm.has($.type))continue;S($,this.getLayerSourceCache($),R)}const E=this._queryRenderedFeatures(a,x,g);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(a,u,g){const x=[],S=!!this.map._showQueryGeometry,E=Ar.createFromScreenPoints(a,g);for(const R in u){const O=ho(E,u[R],this._availableImages,g,S);Object.keys(O).length&&x.push(O)}if(this.placement)for(const R in u){if(!u[R].sourceCache._onlySymbols)continue;const O=Uo(E.screenGeometry,u[R],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(O).length&&x.push(O)}return x}querySourceFeatures(a,u){const g=u&&u.filter;g&&this._validate(Gt,"querySourceFeatures.filter",g,null,u);let x=[];const S=this.getOwnSourceCaches(a);for(const E of S)x=x.concat(Qo(E,u));return x}addSourceType(a,u,g){return gl.getSourceType(a)?g(new Error(`A source type called "${a}" already exists.`)):(gl.setSourceType(a,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(a,u,g={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const R in a)if(!o.bx(a[R],x[R])){S=!0;break}if(!S)return;const E=this._getTransitionParameters();this.light.setLight(a,u,g),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(a,u=1){if(this._checkLoaded(),!a)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,a===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=a;const x=a.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const R="terrain-dem-src";this.addSource(R,g.source),g=o.dn(g),g=Object.assign(g,{source:R})}const S=Object.assign({},g),E={};if(this.terrain&&x){S.source=this.terrain.get().source;const R=this.terrain?this.getFragmentStyle(this.terrain.scope):null;R&&(E.style=R.serialize())}if(this._validate(Hr,"terrain",S,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new o.z("data",{dataType:"style"}))}else{const S=this.terrain,E=S.get();for(const R of Object.keys(o.a6.terrain))!g.hasOwnProperty(R)&&o.a6.terrain[R].default&&(g[R]=o.a6.terrain[R].default);for(const R in a)if(!o.bx(a[R],E[R])){S.set(a,this.options),this.stylesheet.terrain=a;const O=this._getTransitionParameters({duration:0});S.updateTransitions(O),this.fire(new o.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const u=this.fog=new jt(a,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(a){const u=this.snow=new Zn(a,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(a){const u=this.rain=new ar(a,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!o.bx(u.get(),a)){u.set(a,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(a);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(a){if(this._checkLoaded(),!a)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!o.bx(u.get(),a)){u.set(a,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(a);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(a){if(this._checkLoaded(),!a)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!o.bx(u.get(),a)){u.set(a,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(a);this._markersNeedUpdate=!0}_reloadColorTheme(){const a=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void a();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new o.z("colorthemeset")),a()}).catch(x=>{o.w(`Couldn't set color theme: ${x}`)})}setColorTheme(a){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&o.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=a,this._reloadColorTheme()}setImportColorTheme(a,u){const g=this.getFragmentStyle(a);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(a){return{now:o.o.now(),transition:Object.assign(this.transition,a)}}updateDrapeFirstLayers(){if(!this.terrain)return;const a=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?a.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...u)}_createTerrain(a,u){const g=this.terrain=new Ge(a,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=a),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const a in this._layers){const u=this._layers[a];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const u=this._layers[a];u.type==="symbol"&&this._updateLayer(u)}}_validate(a,u,g,x,S={}){if(S&&S.validate===!1)return!1;const E=Object.assign({},this.serialize());return su(this,a.call(Vr,Object.assign({key:u,style:E,value:g,styleSpec:o.a6},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.dx.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._mergedLayers)this._mergedLayers[a].setEventedParent(null);for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles(),this._mergedSourceCaches[a].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(a){const u=this.getSourceCaches(a);for(const g of u)g.clearTiles()}clearSources(){for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles()}clearLayers(){for(const a in this._mergedLayers){const u=this._mergedLayers[a];u._clear&&u._clear()}}reloadSource(a){const u=this.getSourceCaches(a);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const a of this.getSources())a.reload&&a.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(a=>{a.modelManager.reloadModels(a.scope)})}updateSources(a){let u;this.directionalLight&&(u=xb(this.directionalLight));const g=new Set;for(const x in this._mergedLayers){const S=this._mergedLayers[x];S.hasElevation()&&!g.has(S.source)&&g.add(S.source)}for(const x in this._mergedSourceCaches){const S=this._mergedSourceCaches[x],E=g.has(S._source.id);S.update(a,void 0,void 0,u,E)}}_generateCollisionBoxes(){for(const a in this._sourceCaches){const u=this._sourceCaches[a];u.resume(),u.reload()}}_updatePlacement(a,u,g,x,S,E,R=!1){let O=!1,$=!1;const U={},q={};for(const H of this._mergedOrder){const X=this._mergedLayers[H];if(X.type!=="symbol")continue;const Q=o.B(X.source,X.scope);let ae=U[Q];if(!ae){const ce=this.getLayerSourceCache(X);if(!ce)continue;const pe=ce.getRenderableIds(!0).map(Ce=>ce.getTileByID(Ce));q[Q]=pe.slice(),ae=U[Q]=pe.sort((Ce,ve)=>ve.tileID.overscaledZ-Ce.tileID.overscaledZ||(Ce.tileID.isLessThan(ve.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(X,ae,u.center.lng,u.projection);O=O||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),R=R||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new o.z("neworder")),(R||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.o.now(),u.zoom))&&(this.pauseablePlacement=new gs(u,this._mergedOrder,R,g,x,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,U,q,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.o.now()),$=!0),O&&this.pauseablePlacement.placement.setStale()),$||O){this._buildingIndex.onNewFrame(u.zoom);for(let H=0;H<this._mergedOrder.length;H++){const X=this._mergedLayers[this._mergedOrder[H]];if(X.type!=="symbol")continue;const Q=this.isLayerClipped(X);this.placement.updateLayerOpacities(X,U[o.B(X.source,X.scope)],H,Q?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.o.now())}}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}addImport(a,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:S})=>S===a.id)!==-1)return void this.fire(new o.y(new Error(`Import with id '${a.id}' already exists in the map's style.`)));if(!u)return g.push(a),this._loadImports([a],!0);const x=g.findIndex(({id:S})=>S===u);return x===-1&&this.fire(new o.y(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(a).concat(g.slice(x)),this._loadImports([a],!0,u)}updateImport(a,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(a);return x===-1?this:typeof u=="string"?(this.setImportUrl(a,u),this):(u.url&&u.url!==g[x].url&&this.setImportUrl(a,u.url),o.bx(u.config,g[x].config)||this.setImportConfig(a,u.config,u.data.schema),o.bx(u.data,g[x].data)||this.setImportData(a,u.data),this)}moveImport(a,u){this._checkLoaded();let g=this.stylesheet.imports||[];const x=this.getImportIndex(a);if(x===-1)return this;const S=this.getImportIndex(u);if(S===-1)return this;const E=g[x],R=this.fragments[x];return g=g.filter(({id:O})=>O!==a),this.fragments=this.fragments.filter(({id:O})=>O!==a),this.stylesheet.imports=g.slice(0,S).concat(E).concat(g.slice(S)),this.fragments=this.fragments.slice(0,S).concat(R).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(a,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(a);if(x===-1)return this;g[x].url=u;const S=this.fragments[x];return S.style=this._createFragmentStyle(g[x]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(u),this}setImportData(a,u){this._checkLoaded();const g=this.getImportIndex(a),x=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(a,x[g].url))}setImportConfig(a,u,g){this._checkLoaded();const x=this.getImportIndex(a),S=this.stylesheet.imports||[];if(x===-1)return this;u?S[x].config=u:delete S[x].config;const E=this.fragments[x];g&&E.style.stylesheet&&(E.style.stylesheet.schema=g);const R=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=u,E.style.updateConfig(u,R),this.updateConfigDependencies(),this}removeImport(a){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(a);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(a){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===a);return u===-1&&this.fire(new o.y(new Error(`Import '${a}' does not exist in the map's style and cannot be updated.`))),u}getLayer(a){return this._mergedLayers[a]}getSources(){const a=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&a.push(g.getSource())}return a}getSource(a,u){const g=this.getSourceCache(a,u);return g&&g.getSource()}getLayerSource(a){const u=this.getLayerSourceCache(a);return u&&u.getSource()}getSourceCache(a,u){const g=o.B(a,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(a){const u=o.B(a.source,a.scope);return a.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(a){if(a==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[a]&&u.push(this._mergedOtherSourceCaches[a]),this._mergedSymbolSourceCaches[a]&&u.push(this._mergedSymbolSourceCaches[a]),u}updateSourceCaches(){const a=this._changes.getUpdatedSourceCaches();for(const u in a){const g=a[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(a){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const x=this.getLayer(g);x&&x.updateTransitions(a)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(a){this.stylesheet.glyphs=a,this.glyphManager.setURL(a)}getImages(a,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const x=E=>{if(E){const R=u.images.map(O=>o.I.toString(O));E.setDependencies(u.tileID.key,u.type,R)}},S=o.B(u.source,u.scope);x(this._mergedOtherSourceCaches[S]),x(this._mergedSymbolSourceCaches[S]),u.images.some(E=>E.iconsetId)&&this.fire(new o.z("data",{dataType:"style"}))}rasterizeImages(a,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(a,u,g){this.glyphManager.getGlyphs(u.stacks,g)}getResource(a,u,g){return o.dy(u,g)}getOwnSourceCache(a){return this._otherSourceCaches[a]}getOwnLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}getOwnSourceCaches(a){const u=[];return this._otherSourceCaches[a]&&u.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&u.push(this._symbolSourceCaches[a]),u}_isSourceCacheLoaded(a){const u=this.getOwnSourceCaches(a);return u.length===0?(this.fire(new o.y(new Error(`There is no source with ID '${a}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(a,u){if(!this._clipLayerPresent&&a.type!=="fill-extrusion"&&a.type!=="building")return!1;const g=a.type==="fill-extrusion"&&(a.sourceLayer==="building"||a.sourceLayer==="procedural_buildings"),x=a.type==="building";if(a.is3D(!!this.terrain)){if(g||x||u&&u.type==="batched-model"||a.type==="model")return!0}else if(a.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(a=>{a.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}gl.getSourceType=function(m){return xi[m]},gl.setSourceType=function(m,a){xi[m]=a},gl.registerForPluginStateChange=o.dz;class td extends o.E{constructor(a){super(),this._style=a,this._buildings={},this._activeFloors=new Set,this._activeFloorsVisible=!0,this._indoorState={selectedFloorId:null,lastActiveFloors:null,activeFloorsVisible:!0},o.aX(["_updateUI"],this)}destroy(){this._buildings={},this._activeFloors=new Set,this._indoorState=null}selectFloor(a){a===this._selectedFloorId&&this._activeFloorsVisible||(this._selectedFloorId=a,this._activeFloorsVisible=!0,this._updateActiveFloors())}setActiveFloorsVisibility(a){this._activeFloorsVisible=a,this._updateActiveFloors(),this._updateIndoorSelector()}setIndoorData(a){for(const[u,g]of Object.entries(a.buildings))if(this._buildings[u])for(const x of g.floorIds)this._buildings[u].floors[x]||(this._buildings[u].floors[x]=g.floors[x]);else this._buildings[u]=g;for(const u of a.activeFloors)this._activeFloors.add(u);this._updateIndoorSelector()}getIndoorTileOptions(a,u){const g=this._style.getIndoorSourceLayers(a,u);return g&&this._indoorState?{sourceLayers:g,indoorState:this._indoorState}:null}_updateUI(a,u,g){const x=function(S,E,R,O){let $=null,U=Number.MAX_SAFE_INTEGER;if(O<16)return null;for(const[q,H]of Object.entries(S)){const X=H.center;if(X){const Q=E.distanceTo(o.aS.convert(X));Q<U&&R.contains(X)&&(U=Q,$=q)}}return $}(this._buildings,u,g,a);x!==this._closestBuildingId&&(this._closestBuildingId=x,this._updateIndoorSelector())}_updateIndoorSelector(){const a=this._buildings,u=this._closestBuildingId,g=u&&a?a[u]:void 0;if(!g)return void this.fire(new o.z("selector-update",{selectedFloorId:null,activeFloorsVisible:this._activeFloorsVisible,floors:[]}));let x=null;for(const E of g.floorIds)if(this._activeFloors&&this._activeFloors.has(E)){x=E;break}const S=Array.from(g.floorIds).map(E=>({id:E,name:g.floors[E].name,zIndex:g.floors[E].zIndex})).sort((E,R)=>R.zIndex-E.zIndex);this.fire(new o.z("selector-update",{selectedFloorId:x,activeFloorsVisible:this._activeFloorsVisible,floors:S}))}_updateActiveFloors(){const a=this._activeFloors;this._activeFloors=new Set,this._indoorState={selectedFloorId:this._selectedFloorId,lastActiveFloors:a,activeFloorsVisible:this._activeFloorsVisible},this._style.updateIndoorDependentLayers()}}var $f=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,p_=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,m_=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifndef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_id) attrib
#define DECLARE_MATERIAL_TABLE_INFO
#endif`,qd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Kd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,g_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,vm=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Gs=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,_m=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,fn=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,v_=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Xd=[];vl($f,Xd),vl(m_,Xd),vl(p_,Xd);const Zd={"_prelude_fog.vertex.glsl":g_,"_prelude_terrain.vertex.glsl":Kd,"_prelude_shadow.vertex.glsl":fn,"_prelude_material_table.vertex.glsl":`#ifdef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define MATERIAL_TABLE_DEBUG 0
uniform int u_material_offset;uniform int u_vertex_offset;layout(std140,binding=0)readonly buffer material_buffer{uvec4 material_data[];};struct MaterialInfo{uint dataOffset;
#if MATERIAL_TABLE_DEBUG
vec4 colorDebug;
#endif
};uint read_buf_no_offset(uint iDword) {return material_data[iDword/4u][iDword % 4u];}uint read_buf(uint iDword) {iDword+=uint(u_material_offset/4);return read_buf_no_offset(iDword);}float read_buf_float(uint iDword){return uintBitsToFloat(read_buf(iDword));}uint read_buf_uint8(uint iDword,uint iUint8){uint dwordOffset=iDword+(iUint8/4u);uint byteOffset=iUint8 & 3u;uint bitOffset=8u*byteOffset;uint mask=0xffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint read_buf_uint16(uint iDword,uint iUint16){uint dwordOffset=iDword+(iUint16 >> 1u);uint bitOffset=(iUint16 & 1u)*16u;uint mask=0xffffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint nrDwordsForVertexIdEntries(uint nrMaterialLookupEntries) {return nrMaterialLookupEntries;}uint nrDwordsForMaterialIdEntries(uint nrMaterialLookupEntries) {return (nrMaterialLookupEntries*2u+3u)/4u;}uint findRangeBinarySearch(uint vertexId,uint numRanges,uint dwordOffset) {uint left=0u;uint right=numRanges-1u;for (uint i=0u; i < 16u; i++) { 
if (left > right) {break;}uint mid=(left+right)/2u;uint start=read_buf(dwordOffset+mid);uint nextStart=(mid+1u < numRanges) ? read_buf(dwordOffset+mid+1u) : 0xffffffffu;if (vertexId >=start && vertexId < nextStart) {return mid;} else if (vertexId < start) {if (mid==0u) {break;}right=mid-1u;} else {left=mid+1u;}}return 0u; 
}uint readVertexId(uint dwordOffset,uint iMaterialLookupEntry) {return read_buf(dwordOffset+iMaterialLookupEntry);}uint findRange(uint vertexId,uint numRanges,uint dwordOffset) {uint iRange;if(numRanges <=64u){uint vertexBegin;for(iRange=0u; iRange < numRanges;++iRange) {vertexBegin=readVertexId(dwordOffset,iRange);if(vertexBegin > vertexId) {break;}}iRange=iRange==0u? 0u : iRange-1u;} else { 
iRange=findRangeBinarySearch(vertexId,numRanges,dwordOffset);}return iRange;}MaterialInfo read_material_info(uint vertex_id) {MaterialInfo info;
#if MATERIAL_TABLE_DEBUG
const vec4 red=vec4(1.0,0.0,0.0,1.0);const vec4 orange=vec4(1.0,0.5,0.0,1.0);const vec4 yellow=vec4(1.0,1.0,0.0,1.0);const vec4 green=vec4(0.0,1.0,0.0,1.0);const vec4 indigo=vec4(0.294,0.0,0.510,1.0);const vec4 blue=vec4(0.0,0.0,1.0,1.0);const vec4 purple=vec4(0.5,0.0,0.5,1.0);const vec4 pink=vec4(1.0,0.0,1.0,1.0);info.colorDebug=green;
#endif
uint offset=0u;
#if MATERIAL_TABLE_DEBUG
bool keepFinding=true;uint magic=read_buf(offset);if(magic !=0xCAFEBABEu) {info.colorDebug=red;keepFinding=false;return info;}
#endif
offset++;
#if MATERIAL_TABLE_DEBUG
uint nrMaterials=read_buf(offset);uint nrVertices=read_buf(offset+1u);if(keepFinding && vertex_id >=nrVertices) {info.colorDebug=red;keepFinding=false;}
#endif
offset+=2u;uint nrMaterialLookupEntries=read_buf(offset++);uint perMaterialEntrySizeDwords=read_buf(offset++);
#if MATERIAL_TABLE_DEBUG
if(keepFinding && perMaterialEntrySizeDwords !=1u) {info.colorDebug=red;keepFinding=false;}
#endif
uint iMaterialLookup=findRange(vertex_id,nrMaterialLookupEntries,offset);
#if MATERIAL_TABLE_DEBUG
if(keepFinding)
{uint vertexBeginCheck=readVertexId(offset,iMaterialLookup);if(vertexBeginCheck > vertex_id) {info.colorDebug=red;keepFinding=false;}if(iMaterialLookup < nrMaterialLookupEntries-1u) {uint vertexEndCheck=readVertexId(offset,iMaterialLookup+1u);if(vertexEndCheck <=vertex_id) {info.colorDebug=red;keepFinding=false;}}}
#endif
offset+=nrDwordsForVertexIdEntries(nrMaterialLookupEntries);uint materialId=iMaterialLookup;
#if MATERIAL_TABLE_DEBUG
if(keepFinding) {if(materialId >=nrMaterialLookupEntries) {info.colorDebug=red;}}
#endif
info.dataOffset=offset+materialId*perMaterialEntrySizeDwords;return info;}uint get_data_location(const MaterialInfo matInfo,uint attribOffsetBytes)
{uint attribFieldOffsetDwords=attribOffsetBytes/4u;return matInfo.dataOffset+attribFieldOffsetDwords;}vec4 read_material_vec4(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec4(read_buf_float(loc),read_buf_float(loc+1u),read_buf_float(loc+2u),read_buf_float(loc+3u));}vec2 read_material_vec2(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec2(read_buf_float(loc),read_buf_float(loc+1u));}float read_material_float(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return read_buf_float(loc);}
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_offset) read_material_float(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_offset) read_material_vec4(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_offset) read_material_vec2(matInfo,attrib_offset)
#define DECLARE_MATERIAL_TABLE_INFO MaterialInfo materialInfo=read_material_info(uint(gl_VertexID));
#define DECLARE_MATERIAL_TABLE_INFO_DEBUG(dbgColor) MaterialInfo materialInfo=read_material_info(uint(gl_VertexID)); dbgColor=materialInfo.colorDebug;
#endif`,"_prelude_fog.fragment.glsl":vm,"_prelude_shadow.fragment.glsl":v_,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Gs,"_prelude_raster_particle.glsl":_m},jf={};ei("",Kd),ei(vm,g_),ei(v_,fn),ei(Gs,""),ei(_m,"");const Vf=ei(p_,m_),ec=$f;var ym={background:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef FLOOD_LIGHT
in highp float v_flood_radius;in float v_has_flood_light;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;uniform vec3 u_flood_light_color;uniform float u_flood_light_intensity;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=linearTosRGB(color.rgb);
#ifdef FLOOD_LIGHT
float flood_radiance=(1.0-min(v_pos.z/v_flood_radius,1.0))*u_flood_light_intensity*v_has_flood_light;color.rgb=mix(color.rgb,u_flood_light_color,flood_radiance);
#endif
color.rgb=mix(color.rgb,linearTosRGB(base_color.rgb),emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in float a_flood_light_wall_radius_1i16;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
#ifdef FLOOD_LIGHT
out highp float v_flood_radius;out float v_has_flood_light;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;const float FLOOD_LIGHT_MAX_RADIUS_METER=2048.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
#ifdef FLOOD_LIGHT
v_flood_radius=(a_flood_light_wall_radius_1i16/MAX_INT_16*FLOOD_LIGHT_MAX_RADIUS_METER);v_has_flood_light=step(0.0,v_flood_radius);
#endif
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:ei(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:ei(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ei("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ei(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ei(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ei("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ei("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ei("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:ei(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:ei(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:ei(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ei(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ei(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ei(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),1.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:ei("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:ei("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:ei(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:ei(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#define APPEARANCE_ICON 1.0
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float a_size_max= floor(a_size[1]*0.5);float a_apperance_icon=a_size[1]-2.0*a_size_max;vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (a_apperance_icon==APPEARANCE_ICON) {size=a_size_max/128.0;} else if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size_max,u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
#ifdef Z_TEST_OCCLUSION
out_fade_opacity*=occlusion_opacity;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:ei("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ei(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,qd),skyboxGradient:ei(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,qd),skyboxCapture:ei(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ei(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ei(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef FLIP_Y
coord.y=1.0-coord.y;
#endif
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#ifdef CLIP_ZERO_TO_ONE
v_depth=-1.0+2.0*v_depth; 
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ei(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ei(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:ei("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:ei("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:ei("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:ei("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function vl(m,a){const u=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const S of x)a.includes(S)||a.push(S)}}function ei(m,a){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,x={},S=[],E=[];if(m=m.replace(u,(O,$)=>(E.push($),"")),(a=a.replace(u,(O,$)=>(S.push($),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let R=[...Xd];vl(m,R),vl(a,R);for(const O of[...S,...E])Zd[O]||console.error(`Undefined include: ${O}`),jf[O]||(jf[O]=[],vl(Zd[O],jf[O])),R=[...R,...jf[O]];return{fragmentSource:m=m.replace(g,(O,$,U,q,H)=>(x[H]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
in ${U} ${q} ${H};
#else
uniform ${U} ${q} u_${H};
#endif
`:$==="initialize"?`
#ifdef HAS_UNIFORM_u_${H}
    ${U} ${q} ${H} = u_${H};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    in ${U} ${q} ${H};
#endif
`:$==="initialize-attribute"?"":void 0)),vertexSource:a=a.replace(g,(O,$,U,q,H)=>{const X=`MATERIAL_ATTRIBUTE_OFFSET_${H}`,Q=q==="float"?"vec2":q,ae=`GET_ATTRIBUTE_${Q}(a_${H}, materialInfo, ${X})`,ue=H.match(/color/)?"color":Q;return $==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${H}
in ${U} ${q} a_${H};
#endif
`:x[H]?$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
    #if !defined(${X})
        in ${U} ${Q} a_${H};
    #endif
out ${U} ${q} ${H};
#else
uniform ${U} ${q} u_${H};
#endif
`:$==="initialize"?ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${U} ${q} ${H} = u_${H};
#endif
`:`
#if !defined(HAS_UNIFORM_u_${H}) 
    #ifdef ${X}
        ${H} = unpack_mix_${ue}(${ae}, u_${H}_t);
    #else
        ${H} = unpack_mix_${ue}(a_${H}, u_${H}_t);
    #endif
#else
    ${U} ${q} ${H} = u_${H};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    in ${U} ${q} a_${H};
    out ${U} ${q} ${H};
#endif
`:$==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    ${H} = a_${H};
#endif
`:void 0:$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
    #if !defined(${X})
        in ${U} ${Q} a_${H};
    #endif  
#else
uniform ${U} ${q} u_${H};
#endif
`:$==="define-instanced"?ue==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${H}0;
in vec4 a_${H}1;
in vec4 a_${H}2;
in vec4 a_${H}3;
#else
uniform ${U} ${q} u_${H};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${U} ${Q} a_${H};
#else
uniform ${U} ${q} u_${H};
#endif
`:$==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    ${U} ${q} ${H} = a_${H};
#endif
`:ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    #ifdef ${X}
        ${U} ${q} ${H} = ${ae};
    #else
        ${U} ${q} ${H} = a_${H};
    #endif
#else
    ${U} ${q} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    #ifdef ${X}
        ${U} ${q} ${H} = unpack_mix_${ue}(${ae}, u_${H}_t);
    #else
        ${U} ${q} ${H} = unpack_mix_${ue}(a_${H}, u_${H}_t);
    #endif
#else
    ${U} ${q} ${H} = u_${H};
#endif
`}),usedDefines:R,vertexIncludes:S,fragmentIncludes:E}}class Yd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,u,g,x,S,E,R,O){this.context=a;let $=this.boundPaintVertexBuffers.length!==x.length;for(let q=0;!$&&q<x.length;q++)this.boundPaintVertexBuffers[q]!==x[q]&&($=!0);let U=this.boundDynamicVertexBuffers.length!==R.length;for(let q=0;!U&&q<R.length;q++)this.boundDynamicVertexBuffers[q]!==R[q]&&(U=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||$||U||this.boundIndexBuffer!==S||this.boundVertexOffset!==E)this.freshBind(u,g,x,S,E,R,O);else{a.bindVertexArrayOES.set(this.vao);for(const q of R)q&&(q.bind(),O&&q.instanceCount&&q.setVertexAttribDivisor(a.gl,u,O));S&&S.dynamicDraw&&S.bind()}}freshBind(a,u,g,x,S,E,R){const O=this.context,$=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=E,u.enableAttributes($,a),u.bind(),u.setVertexAttribPointers($,a,S);for(const U of g)U.enableAttributes($,a),U.bind(),U.setVertexAttribPointers($,a,S);for(const U of E)U&&(U.enableAttributes($,a),U.bind(),U.setVertexAttribPointers($,a,S),R&&U.instanceCount&&U.setVertexAttribDivisor($,a,R));x&&x.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function rT(m,a){const u=Math.pow(2,a.canonical.z),g=a.canonical.y;return[new o.ae(0,g/u).toLngLat().lat,new o.ae(0,(g+1)/u).toLngLat().lat]}function iT(m,a,u,g,x,S,E){const R=m.context,O=R.gl,$=u.hillshadeFBO;if(!$)return;m.prepareDrawTile();const U=m.isTileAffectedByFog(a),q=m.getOrCreateProgram("hillshade",{overrideFog:U});R.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,$.colorAttachment.get());const H=((ue,ce,pe,Ce)=>{const ve=pe.paint.get("hillshade-shadow-color"),Fe=pe.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ie=pe.paint.get("hillshade-highlight-color"),$e=pe.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Le=pe.paint.get("hillshade-accent-color"),Me=pe.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ve=pe.paint.get("hillshade-emissive-strength");let st=o.an(pe.paint.get("hillshade-illumination-direction"));if(pe.paint.get("hillshade-illumination-anchor")==="viewport")st-=ue.transform.angle;else if(ue.style&&ue.style.enable3dLights()&&ue.style.directionalLight){const Et=ue.style.directionalLight.properties.get("direction"),mt=o.d3(Et.x,Et.y,Et.z);st=o.an(mt[1])}const nt=!ue.options.moving;return{u_matrix:Ce||ue.transform.calculateProjMatrix(ce.tileID.toUnwrapped(),nt),u_image:0,u_latrange:rT(0,ce.tileID),u_light:[pe.paint.get("hillshade-exaggeration"),st],u_shadow:ve.toPremultipliedRenderColor(Fe?null:pe.lut),u_highlight:Ie.toPremultipliedRenderColor($e?null:pe.lut),u_emissive_strength:Ve,u_accent:Le.toPremultipliedRenderColor(Me?null:pe.lut)}})(m,u,g,m.terrain?a.projMatrix:null);m.uploadCommonUniforms(R,q,a.toUnwrapped());const{tileBoundsBuffer:X,tileBoundsIndexBuffer:Q,tileBoundsSegments:ae}=m.getTileBoundsBuffers(u);q.draw(m,O.TRIANGLES,x,S,E,xr.disabled,H,g.id,X,Q,ae)}function xm(m,a,u){if(!a.needsDEMTextureUpload)return;const g=m.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||m.getTileTexture(u.stride);const S=u.getPixels();a.demTexture?a.demTexture.update(S,{premultiply:!1}):a.demTexture=new o.T(g,S,x.R32F,{premultiply:!1}),a.needsDEMTextureUpload=!1}function oT(m,a,u){const g=m.context,x=g.gl;if(!a.dem)return;const S=a.dem;if(g.activeTexture.set(x.TEXTURE1),xm(m,a,S),!a.demTexture)return;a.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const E=S.dim;g.activeTexture.set(x.TEXTURE0);let R=a.hillshadeFBO;if(!R){const H=new o.T(g,{width:E,height:E,data:null},x.RGBA8);H.bind(x.LINEAR,x.CLAMP_TO_EDGE),R=a.hillshadeFBO=g.createFramebuffer(E,E,!0,"renderbuffer"),R.colorAttachment.set(H.texture)}g.bindFramebuffer.set(R.framebuffer),g.viewport.set([0,0,E,E]);const{tileBoundsBuffer:O,tileBoundsIndexBuffer:$,tileBoundsSegments:U}=m.getMercatorTileBoundsBuffers(),q=[];m.linearFloatFilteringSupported()&&q.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:q}).draw(m,x.TRIANGLES,Hn.disabled,Tr.disabled,jr.unblended,xr.disabled,((H,X)=>{const Q=X.stride,ae=o.bB();return o.cd(ae,0,o.al,-o.al,0,0,1),o.bq(ae,ae,[0,-o.al,0]),{u_matrix:ae,u_image:1,u_dimension:[Q,Q],u_zoom:H.overscaledZ}})(a.tileID,S),u.id,O,$,U),a.needsHillshadePrepare=!1}class fo{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Sb extends fo{getDefault(){return o.ao.transparent.toNonPremultipliedRenderColor(null)}set(a){const u=this.current;(a.r!==u.r||a.g!==u.g||a.b!==u.b||a.a!==u.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class __ extends fo{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class aT extends fo{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class sT extends fo{getDefault(){return[!0,!0,!0,!0]}set(a){const u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||a[3]!==u[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class lT extends fo{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class cT extends fo{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Cb extends fo{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const u=this.current;(a.func!==u.func||a.ref!==u.ref||a.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class uT extends fo{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class bm extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;a?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=a,this.dirty=!1}}class dT extends fo{getDefault(){return[0,1]}set(a){const u=this.current;(a[0]!==u[0]||a[1]!==u[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Eb extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;a?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=a,this.dirty=!1}}class y_ extends fo{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class wm extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;a?u.enable(u.BLEND):u.disable(u.BLEND),this.current=a,this.dirty=!1}}class x_ extends fo{getDefault(){const a=this.gl;return[a.ONE,a.ZERO,a.ONE,a.ZERO]}set(a){const u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||a[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class nd extends fo{getDefault(){return o.ao.transparent.toNonPremultipliedRenderColor(null)}set(a){const u=this.current;(a.r!==u.r||a.g!==u.g||a.b!==u.b||a.a!==u.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Jd extends fo{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(a,a),this.current=a,this.dirty=!1)}}class Uf extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;a?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=a,this.dirty=!1}}class Qd extends fo{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class Tb extends fo{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let b_=class extends fo{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Ib extends fo{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class eh extends fo{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||a[3]!==u[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Sm extends fo{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Cm extends fo{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class w_ extends fo{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Em extends fo{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Hf extends fo{getDefault(){return null}set(a){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Pb extends fo{getDefault(){return null}set(a){this.gl&&(a!==this.current||this.dirty)&&(this.gl.bindVertexArray(a),this.current=a,this.dirty=!1)}}class Mb extends fo{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Rb extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class th extends fo{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Tm extends fo{constructor(a,u){super(a),this.context=a,this.parent=u}getDefault(){return null}}class hT extends Tm{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class Ab extends Tm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class fT extends Tm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class S_ extends Ab{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const C_=(m,a,u)=>({u_matrix:m,u_image0:0,u_skirt_height:a,u_ground_shadow_factor:u}),Im=(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:S,u_image0:0,u_frustum_tl:E,u_frustum_tr:R,u_frustum_br:O,u_frustum_bl:$,u_globe_pos:U,u_globe_radius:q,u_viewport:H,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9),u_skirt_height:X,u_far_z_cutoff:Q});function Pm(m,a){return m!=null&&a!=null&&!(!m.hasData()||!a.hasData())&&m.demTexture!=null&&a.demTexture!=null&&m.tileID.key!==a.tileID.key}const rd=new class{constructor(){this.operations={}}newMorphing(m,a,u,g,x){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==u.tileID.key&&(S.queued=u)}else this.operations[m]={startTime:g,phase:0,duration:x,from:a,to:u,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const a=this.operations[m];return{from:a.from,to:a.to,phase:a.phase}}update(m){for(const a in this.operations){const u=this.operations[a];for(u.phase=(m-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,m)){delete this.operations[a];break}}}_nextOp(m,a){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=a,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},E_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Ob(m,a,u){if(a===0)return 0;const g=a<1&&u===514?.25/a:1;return 6*Math.pow(1.5,22-m)*Math.max(a,1)*g}function Gf(m,a){const u=1<<m.z;return!a&&(m.x===0||m.x===u-1)||m.y===0||m.y===u-1}const id=m=>({u_matrix:m});function Mm(m,a,u,g,x){if(x>0){const S=o.o.now(),E=(S-m.timeAdded)/x,R=a?(S-a.timeAdded)/x:-1,O=u.getSource(),$=g.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),U=!a||Math.abs(a.tileID.overscaledZ-$)>Math.abs(m.tileID.overscaledZ-$),q=U&&m.refreshedUponExpiration?1:o.aA(U?E:1-R,0,1);return a?{opacity:1,mix:1-q,isFading:E<1}:{opacity:q,mix:0,isFading:E<1}}return{opacity:1,mix:0,isFading:!1}}class Ws extends Ja{constructor(a){const u=oi("mock-dem",{type:"raster-dem",maxzoom:a.transform.maxZoom},a.style.dispatcher,a.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,u){a.state="loaded",u(null)}}class T_ extends Ja{constructor(a){const u=oi("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},a.style.dispatcher,a.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,u,g){if(a.freezeTileCoverage)return;this.transform=a;const x=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,E)=>{if(S[E.key]="",!this._tiles[E.key]){const R=new Ko(E,this._source.tileSize*E.overscaleFactor(),a.tileZoom,void 0,void 0,this._source.worldview);R.state="loaded",this._tiles[E.key]=R}return S},{});for(const S in this._tiles)S in x||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(a){const u=this.proxyCachedFBO[a];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Wf extends o.aP{constructor(a,u,g){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class qf extends o.bU{constructor(a,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},a.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,S]=function(O){const $=new o.bc,U=new o.b0,q=131;$.reserve(17161),U.reserve(33800);const H=o.al/128,X=o.al+H/2,Q=X+H;for(let ue=-H;ue<Q;ue+=H)for(let ce=-H;ce<Q;ce+=H){const pe=ce<0||ce>X||ue<0||ue>X?24575:0,Ce=o.aA(Math.round(ce),0,o.al),ve=o.aA(Math.round(ue),0,o.al);$.emplaceBack(Ce+pe,ve)}const ae=(ue,ce)=>{const pe=ce*q+ue;U.emplaceBack(pe+1,pe,pe+q),U.emplaceBack(pe+q,pe+q+1,pe+1)};for(let ue=1;ue<129;ue++)for(let ce=1;ce<129;ce++)ae(ce,ue);return[0,129].forEach(ue=>{for(let ce=0;ce<130;ce++)ae(ce,ue),ae(ue,ce)}),[$,U,32768]}(),E=a.context;this.gridBuffer=E.createVertexBuffer(g,o.be.members),this.gridIndexBuffer=E.createIndexBuffer(x),this.gridSegments=o.bf.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=o.bf.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new T_(u.map),this.orthoMatrix=o.bB(),o.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.al,0,o.al,0,1);const R=E.gl;this._overlapStencilMode=new Tr({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ws(u.map),this._pendingGroundEffectLayers=[]}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),this._style=a,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(a,u,g){if(a&&a.terrain){this._style!==a&&(this.style=a,this._evaluationZoom=void 0);const x=a.terrain.properties,S=a.terrain.drapeRenderMode===0,E=a.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.o.now();const R=a.terrain&&a.terrain.scope,O=x.get("source"),$=S?this._mockSourceCache:a.getSourceCache(O,R);if(!$)return void o.w(`Couldn't find terrain source "${O}".`);if(this.sourceCache=$,this._attenuationRange=a.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(u):x.get("exaggeration"),!u.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const U=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const q=this.getScaledDemTileSize();this.sourceCache.update(u,q,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,U(),this._initializing=!0),U(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(a){if(this._attenuationRange&&a.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(a.zoom);const u=this._previousCameraAltitude,g=a.getFreeCameraOptions().position.z/a.pixelsPerMeter*a.worldSize;this._previousCameraAltitude=g;const x=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const S=a.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(S);let R=S-this._previousZoom;const O=this._previousUpdateTimestamp;let $=S;this._evaluationZoom!=null&&($=this._evaluationZoom,Math.abs(S-$)>.5&&(R=.5*(S-$+R)),R*x<0&&($+=R)),this._evaluationZoom=$;const U=E.getExaggeration($),q=U===E.getExaggeration(Math.max(0,$-.1));if(q&&Math.abs(U-this._exaggeration)<.01)return U;let H=Math.min(.1,.00375*(this._updateTimestamp-O));return(q||U<.1||Math.abs(R)<1e-4)&&(H=Math.min(.2,4*H)),o.ak(this._exaggeration,U,H)}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(a){a.dataType==="source"&&a.coord?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._mergedSourceCaches)this._style._mergedSourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(o.ae.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(O=>{const $=u.getTileByID(O).tileID;return $.projMatrix=g.calculateProjMatrix($.toUnwrapped()),$});(function(O,$){const U=$.transform.pointCoordinate($.transform.getCameraPoint()),q=new o.P(U.x,U.y);O.sort((H,X)=>{if(X.overscaledZ-H.overscaledZ)return X.overscaledZ-H.overscaledZ;const Q=new o.P(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),ae=new o.P(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ue=q.mult(1<<H.canonical.z);return ue.x-=.5,ue.y-=.5,ue.distSqr(Q)-ue.distSqr(ae)})})(x,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},x.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const O in E){const $=E[O];if(!$.used||($!==this.sourceCache&&this.resetTileLookupCache($.id),this._setupProxiedCoordsForOrtho($,a[O],S),$.usedForTerrain))continue;const U=a[O];$.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[u.id]=x.map(O=>new Wf(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const R={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const $=this.terrainTileForTile[O.key];if(!$)continue;const U=$.tileID.key;U in R||(this._visibleDemTiles.push($),R[U]=U)}}_assignTerrainTiles(a){this._initializing||a.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const a=this.painter.context,u=a.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],S=x.dem;!S||x.demTexture&&!x.needsDEMTextureUpload||(a.activeTexture.set(u.TEXTURE1),xm(this.painter,x,S))}}_prepareDemTileUniforms(a,u,g,x){if(!u||u.demTexture==null)return!1;const S=a.tileID.canonical,E=Math.pow(2,u.tileID.canonical.z-S.z),R=x||"";return g[`u_dem_tl${R}`]=[S.x*E%1,S.y*E%1],g[`u_dem_scale${R}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let a=0;const u=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const S=x.dem.tree.minimums[0];return S>0&&a++,g+S},0);return a?u/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,u=a.gl;a.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new o.dK({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(x,{premultiply:!1}):S=this._emptyDEMTexture=new o.T(a,x,u.R32F,{premultiply:!1}),S}setupElevationDraw(a,u,g){const x=this.painter.context,S=x.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let R=null,O=null,$=1;if(g&&g.morphing&&this._useVertexMorphing){const X=g.morphing.srcDemTile,Q=g.morphing.dstDemTile;$=g.morphing.phase,X&&Q&&(this._prepareDemTileUniforms(a,X,E,"_prev")&&(O=X),this._prepareDemTileUniforms(a,Q,E)&&(R=Q))}const U=X=>X&&X.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let q=null;var H;if(this.enabled?O&&R?(q=R.demTexture,x.activeTexture.set(S.TEXTURE4),O.demTexture.bind(U(O),S.CLAMP_TO_EDGE),E.u_dem_lerp=$):(R=this.terrainTileForTile[a.tileID.key],q=this._prepareDemTileUniforms(a,R,E)?R.demTexture:this.emptyDEMTexture):q=this.emptyDEMTexture,x.activeTexture.set(S.TEXTURE2),q&&(E.u_dem_size=(H=q).size[0]===1?1:H.size[0]-2,q.bind(U(R),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,E),g&&g.useMeterToDem&&R){const X=(1<<R.tileID.canonical.z)*o.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=X}if(g&&g.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(x,E),this.painter.transform.projection.name==="globe"){const X=this.globeUniformValues(this.painter.transform,a.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(x,X)}}globeUniformValues(a,u,g){const x=a.projection;return{u_tile_tl_up:x.upVector(u,0,0),u_tile_tr_up:x.upVector(u,o.al,0),u_tile_br_up:x.upVector(u,o.al,o.al),u_tile_bl_up:x.upVector(u,0,o.al),u_tile_up_scale:g?o.dL(1):x.upVectorScale(u,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){const u=this.painter,g=this.painter.context;a.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,S,E,R,O){if(x.transform.projection.name==="globe")(function($,U,q,H,X){const Q=$.context,ae=Q.gl;let ue,ce;const pe=$.transform,Ce=o.dD($,Q,pe),ve=(Et,mt)=>{if(ce===mt)return;const Lt=[E_[mt],"PROJECTION_GLOBE_VIEW"];Ce&&Lt.push("CUSTOM_ANTIALIASING");const ln=$.isTileAffectedByFog(Et);ue=$.getOrCreateProgram("globeRaster",{defines:Lt,overrideFog:ln}),ce=mt},Fe=$.colorModeForRenderPass(),Ie=new Hn(ae.LEQUAL,Hn.ReadWrite,$.depthRangeFor3D);rd.update(X);const $e=o.dE(pe),Le=[o.aF(pe.center.lng),o.aJ(pe.center.lat)],Me=$.globeSharedBuffers,Ve=[pe.width*o.o.devicePixelRatio,pe.height*o.o.devicePixelRatio],st=Float32Array.from(pe.globeMatrix),nt={useDenormalizedUpVectorScale:!0};{const Et=$.transform,mt=Ob(Et.zoom,U.exaggeration(),U.sourceCache._source.tileSize);ce=-1;const Lt=ae.TRIANGLES;for(const ln of H){const ht=q.getTile(ln),Qe=Tr.disabled,kt=U.prevTerrainTileForTile[ln.key],gt=U.terrainTileForTile[ln.key];Pm(kt,gt)&&rd.newMorphing(ln.key,kt,gt,X,250),Q.activeTexture.set(ae.TEXTURE0),ht.texture&&ht.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const Kt=rd.getMorphValuesForProxy(ln.key),pn=Kt?1:0;Kt&&Object.assign(nt,{morphing:{srcDemTile:Kt.from,dstDemTile:Kt.to,phase:o.dC(Kt.phase)}});const Nn=o.dF(ln.canonical),an=o.dG(Nn.getCenter().lat),dn=o.dH(ln.canonical,Nn,an,Et.worldSize/Et._pixelsPerMercatorPixel),jn=o.bj(o.dI(ln.canonical)),Mn=Im(Et.expandedFarZProjMatrix,st,$e,jn,o.aj(Et.zoom),Le,Et.frustumCorners.TL,Et.frustumCorners.TR,Et.frustumCorners.BR,Et.frustumCorners.BL,Et.globeCenterInViewSpace,Et.globeRadius,Ve,mt,Et._farZ,dn);if(ve(ln,pn),ue&&(U.setupElevationDraw(ht,ue,nt),$.uploadCommonUniforms(Q,ue,ln.toUnwrapped()),Me)){const[wn,Rn,cr]=Me.getGridBuffers(an,mt!==0);ue.draw($,Lt,Ie,Qe,Fe,xr.backCCW,Mn,"globe_raster",wn,Rn,cr)}}}if(Me&&($.renderDefaultNorthPole||$.renderDefaultSouthPole)){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ce&&Et.push("CUSTOM_ANTIALIASING"),ue=$.getOrCreateProgram("globeRaster",{defines:Et});for(const mt of H){const{x:Lt,y:ln,z:ht}=mt.canonical,Qe=ln===0,kt=ln===(1<<ht)-1,[gt,Kt,pn,Nn]=Me.getPoleBuffers(ht,!1);if(Nn&&(Qe||kt)){const an=q.getTile(mt);Q.activeTexture.set(ae.TEXTURE0),an.texture&&an.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);let dn=o.dJ(ht,Lt,pe);const jn=o.bj(o.dI(mt.canonical)),Mn=(wn,Rn)=>wn.draw($,ae.TRIANGLES,Ie,Tr.disabled,Fe,xr.disabled,Im(pe.expandedFarZProjMatrix,dn,dn,jn,0,Le,pe.frustumCorners.TL,pe.frustumCorners.TR,pe.frustumCorners.BR,pe.frustumCorners.BL,pe.globeCenterInViewSpace,pe.globeRadius,Ve,0,pe._farZ),"globe_pole_raster",Rn,pn,Nn);U.setupElevationDraw(an,ue,nt),$.uploadCommonUniforms(Q,ue,mt.toUnwrapped()),Qe&&$.renderDefaultNorthPole&&Mn(ue,gt),kt&&$.renderDefaultSouthPole&&(dn=o.cR(o.bB(),dn,[1,-1,1]),Mn(ue,Kt))}}}})(x,S,E,R,O);else{const $=x.context,U=$.gl;let q,H;const X=x.shadowRenderer,Q=Cc(x,x.longestCutoffRange),ae=Fe=>{if(H===Fe)return;const Ie=[];Ie.push(E_[Fe]),Q.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF"),X&&(Ie.push("RENDER_SHADOWS","DEPTH_TEXTURE"),X.useNormalOffset&&Ie.push("NORMAL_OFFSET")),q=x.getOrCreateProgram("terrainRaster",{defines:Ie}),H=Fe},ue=x.colorModeForRenderPass(),ce=new Hn(U.LEQUAL,Hn.ReadWrite,x.depthRangeFor3D);rd.update(O);const pe=x.transform,Ce=Ob(pe.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let ve=[0,0,0];if(X){const Fe=x.style.directionalLight,Ie=x.style.ambientLight;Fe&&Ie&&(ve=ml(x.style,Fe,Ie))}{H=-1;const Fe=U.TRIANGLES,[Ie,$e]=[S.gridIndexBuffer,S.gridSegments];for(const Le of R){const Me=E.getTile(Le),Ve=Tr.disabled,st=S.prevTerrainTileForTile[Le.key],nt=S.terrainTileForTile[Le.key];Pm(st,nt)&&rd.newMorphing(Le.key,st,nt,O,250),$.activeTexture.set(U.TEXTURE0),Me.texture&&Me.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const Et=rd.getMorphValuesForProxy(Le.key),mt=Et?1:0;let Lt;Et&&(Lt={morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:o.dC(Et.phase)}});const ln=C_(Le.projMatrix,Gf(Le.canonical,pe.renderWorldCopies)?Ce/10:Ce,ve);if(ae(mt),!q)continue;S.setupElevationDraw(Me,q,Lt);const ht=Le.toUnwrapped();X&&X.setupShadows(ht,q),x.uploadCommonUniforms($,q,ht,null,Q),q.draw(x,Fe,ce,Ve,ue,xr.backCCW,ln,"terrain_raster",S.gridBuffer,Ie,$e)}}}}(u,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,x=this.proxySourceCache,S=this.proxiedCoords[x.id],E=this._drapedRenderBatches.shift(),R=u.style.order,O=[];let $=0;for(const U of S){const q=x.getTileByID(U.proxyTileKey),H=x.proxyCachedFBO[U.key]?x.proxyCachedFBO[U.key][a]:void 0,X=H!==void 0?x.renderCache[H]:this.pool[$++],Q=H!==void 0;if(q.texture=X.tex,Q&&!X.dirty){O.push(q.tileID);continue}let ae;g.bindFramebuffer.set(X.fb.framebuffer),this.renderedToTile=!1,X.dirty&&(g.clear({color:o.ao.transparent,stencil:0}),X.dirty=!1);for(let ue=E.start;ue<=E.end;++ue){const ce=u.style._mergedLayers[R[ue]];if(ce.isHidden(u.transform.zoom))continue;const pe=u.style.getLayerSourceCache(ce),Ce=pe?this.proxyToSource[U.key][pe.id]:[U];if(!Ce)continue;const ve=Ce;g.viewport.set([0,0,X.fb.width,X.fb.height]),ae!==(pe?pe.id:null)&&(this._setupStencil(X,Ce,ce,pe),ae=pe?pe.id:null),u.renderLayer(u,pe,ce,ve)}if(this._drapedRenderBatches.length===0)for(const ue of this._pendingGroundEffectLayers){const ce=u.style._mergedLayers[R[ue]];if(ce.isHidden(u.transform.zoom))continue;const pe=u.style.getLayerSourceCache(ce),Ce=pe?this.proxyToSource[U.key][pe.id]:[U];if(!Ce)continue;const ve=Ce;g.viewport.set([0,0,X.fb.width,X.fb.height]),ae!==(pe?pe.id:null)&&(this._setupStencil(X,Ce,ce,pe),ae=pe?pe.id:null),u.renderLayer(u,pe,ce,ve)}this.renderedToTile?(X.dirty=!0,O.push(q.tileID)):Q||--$,$===5&&($=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),E.end+1}postRender(){}isLayerOrderingCorrect(a){const u=a.order.length;let g=-1,x=u;for(let S=0;S<u;++S)this._style.isLayerDraped(a._mergedLayers[a.order[S]])?g=Math.max(g,S):x=Math.min(x,S);return x>g}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{a=Math.min(a,u.dem.tree.minimums[0])}),a===0?a:(a-30)*this._exaggeration}raycast(a,u,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const E=S.tileID,R=1<<E.overscaledZ,{x:O,y:$}=E.canonical,U=O/R,q=(O+1)/R,H=$/R,X=($+1)/R;return{minx:U,miny:H,maxx:q,maxy:X,t:S.dem.tree.raycastRoot(U,H,q,X,a,u,g),tile:S}});x.sort((S,E)=>(S.t!==null?S.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const S of x){if(S.t==null)return null;const E=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,a,u,g);if(E!=null)return E}return null}_createFBO(){const a=this.painter.context,u=a.gl,g=this.drapeBufferSize;a.activeTexture.set(u.TEXTURE0);const x=new o.T(a,{width:g[0],height:g[1],data:null},u.RGBA8);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const S=a.createFramebuffer(g[0],g[1],!0,null);return S.colorAttachment.set(x.texture),S.depthAttachment=new S_(a,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:S,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const a in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const u=this._style._mergedLayers[a],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let a=!1;for(const g of this._style.getSources())if(g instanceof oo){a=!0;break}if(!a)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(S&&!u[S.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof o.ad){u[S.id]=!0;for(const E of this.proxyCoords){const R=this.proxyToSource[E.key][S.id];if(R)for(const O of R)this._clearRenderCacheForTile(S.id,O)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Ti){a=!0;break}if(!a)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(!S||u[S.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const E=x.paint.get("raster-fade-duration");for(const R of this.proxyCoords){const O=this.proxyToSource[R.key][S.id];if(O)for(const $ of O){const U=Mm(S.getTile($),S.findLoadedParent($,0),S,this.painter.transform,E);(U.opacity!==1||U.mix!==0)&&this._clearRenderCacheForTile(S.id,$)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const a=this._style.order,u=a.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let x,S=0,E=this._style._mergedLayers[a[S]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++S<u;)E=this._style._mergedLayers[a[S]];for(;S<u;++S){const R=this._style._mergedLayers[a[S]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?x===void 0&&(x=S):(R.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),x!==void 0&&(g.push({start:x,end:S-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:S-1}),g.length!==0){const R=g[g.length-1];this._pendingGroundEffectLayers.every(O=>O>R.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(a){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const E=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let R=0;R<E.length;++R){const O=Object.values(E[R]);u.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let E=g.length-1;E>=0;E--){const R=g[E];if(u.getTileByID(R.key),u.proxyCachedFBO[R.key]!==void 0){const O=a[R.key],$=this.proxyToSource[R.key];let U=0;for(const q in $){const H=$[q],X=O[q];if(!X||X.length!==H.length||H.some((Q,ae)=>Q!==X[ae]||x[q]&&x[q].hasOwnProperty(Q.key))){U=-1;break}++U}for(const q in u.proxyCachedFBO[R.key])u.renderCache[u.proxyCachedFBO[R.key][q]].dirty=U<0||U!==Object.values(O).length}}const S=[...this._drapedRenderBatches];S.sort((E,R)=>R.end-R.start-(E.end-E.start));for(const E of S)for(const R of g){if(u.proxyCachedFBO[R.key])continue;let O=u.renderCachePool.pop();O===void 0&&u.renderCache.length<50&&(O=u.renderCache.length,u.renderCache.push(this._createFBO())),O!==void 0&&(u.proxyCachedFBO[R.key]={},u.proxyCachedFBO[R.key][E.start]=O,u.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(a,u,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,E=S.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let R;if(g.isTileClipped())R=u.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):Tr.disabled}_renderTileClippingMasks(a,u){const g=this.painter,x=this.painter.context,S=x.gl;g._tileClippingMaskIDs={},x.setColorMode(jr.disabled),x.setDepthMode(Hn.disabled);const E=g.getOrCreateProgram("clippingMask");for(const R of a){const O=g._tileClippingMaskIDs[R.key]=--u;E.draw(g,S.TRIANGLES,Hn.disabled,new Tr({func:S.ALWAYS,mask:0},O,255,S.KEEP,S.KEEP,S.REPLACE),jr.disabled,xr.disabled,id(R.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(a){const u=this.painter.transform;if(a.x<0||a.x>u.width||a.y<0||a.y>u.height)return null;const g=[a.x,a.y,1,1];o.aC(g,g,u.pixelMatrixInverse),o.cJ(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const x=u._camera.position,S=o.ce(1,u.center.lat),E=[x[0],x[1],x[2]/S,0],R=o.d9([],g.slice(0,3),E);o.aw(R,R);const O=this.raycast(E,R,this._exaggeration);return O!==null&&O?(o.bG(E,E,R,O),E[3]=E[2],E[2]*=S,E):null}_setupProxiedCoordsForOrtho(a,u,g){if(a.getSource()instanceof o.aT)return this._setupProxiedCoordsForImageSource(a,u,g);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const x=this.proxiedCoords[a.id]=[],S=this.proxyCoords;for(let O=0;O<S.length;O++){const $=S[O],U=this._findTileCoveringTileID($,a);if(U){const q=this._createProxiedId($,U,g[$.key]&&g[$.key][a.id]);x.push(q),this.proxyToSource[$.key][a.id]=[q]}}let E=!1;const R=new Set;for(let O=0;O<u.length;O++){const $=a.getTile(u[O]);if(!$||!$.hasData())continue;const U=this._findTileCoveringTileID($.tileID,this.proxySourceCache);if(U&&U.tileID.canonical.z!==$.tileID.canonical.z){const q=this.proxyToSource[U.tileID.key][a.id],H=this._createProxiedId(U.tileID,$,g[U.tileID.key]&&g[U.tileID.key][a.id]);q?q.splice(q.length-1,0,H):this.proxyToSource[U.tileID.key][a.id]=[H];const X=this.proxyToSource[U.tileID.key][a.id];R.has(X)||R.add(X),x.push(H),E=!0}}if(this._sourceTilesOverlap[a.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const O of R)O.sort(($,U)=>U.overscaledZ-$.overscaledZ)}_setupProxiedCoordsForImageSource(a,u,g){if(!a.getSource().loaded())return;const x=this.proxiedCoords[a.id]=[],S=this.proxyCoords,E=a.getSource(),R=E.tileID;if(!R)return;const O=new o.P(R.x,R.y)._div(1<<R.z),$=E.coordinates.map(o.ae.fromLngLat).reduce((q,H)=>(q.min.x=Math.min(q.min.x,H.x-O.x),q.min.y=Math.min(q.min.y,H.y-O.y),q.max.x=Math.max(q.max.x,H.x-O.x),q.max.y=Math.max(q.max.y,H.y-O.y),q),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),U=(q,H)=>{const X=q.wrap+q.canonical.x/(1<<q.canonical.z),Q=q.canonical.y/(1<<q.canonical.z),ae=o.al/(1<<q.canonical.z),ue=H.wrap+H.canonical.x/(1<<H.canonical.z),ce=H.canonical.y/(1<<H.canonical.z);return X+ae<ue+$.min.x||X>ue+$.max.x||Q+ae<ce+$.min.y||Q>ce+$.max.y};for(let q=0;q<S.length;q++){const H=S[q];for(let X=0;X<u.length;X++){const Q=a.getTile(u[X]);if(!Q||!Q.hasData()||U(H,Q.tileID))continue;const ae=this._createProxiedId(H,Q,g[H.key]&&g[H.key][a.id]),ue=this.proxyToSource[H.key][a.id];ue?ue.push(ae):this.proxyToSource[H.key][a.id]=[ae],x.push(ae)}}}_createProxiedId(a,u,g){let x=this.orthoMatrix;if(g){const S=g.find(E=>E.key===u.tileID.key);if(S)return S}if(u.tileID.key!==a.key){const S=a.canonical.z-u.tileID.canonical.z;let E,R,O;x=o.bB();const $=u.tileID.wrap-a.wrap<<a.overscaledZ;S>0?(E=o.al>>S,R=E*((u.tileID.canonical.x<<S)-a.canonical.x+$),O=E*((u.tileID.canonical.y<<S)-a.canonical.y)):(E=o.al<<-S,R=o.al*(u.tileID.canonical.x-(a.canonical.x+$<<-S)),O=o.al*(u.tileID.canonical.y-(a.canonical.y<<-S))),o.cd(x,0,E,0,E,0,1),o.bq(x,x,[R,O,0])}return new Wf(u.tileID,a.key,x)}_findTileCoveringTileID(a,u){let g=u.getTile(a);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[u.id],S=x[a.key];if(g=S?u.getTileByID(S):null,g&&g.hasData()||S===null)return g;let E=g?g.tileID:a,R=E.overscaledZ;const O=u.getSource().minzoom,$=[];if(!S){const q=u.getSource().maxzoom;if(a.canonical.z>=q){const H=a.canonical.z-q;u.getSource().reparseOverscaled?(R=Math.max(a.canonical.z+2,u.transform.tileZoom),E=new o.aP(R,a.wrap,q,a.canonical.x>>H,a.canonical.y>>H)):H!==0&&(R=q,E=new o.aP(R,a.wrap,q,a.canonical.x>>H,a.canonical.y>>H))}E.key!==a.key&&($.push(E.key),g=u.getTile(E))}const U=q=>{$.forEach(H=>{x[H]=q}),$.length=0};for(R-=1;R>=O&&(!g||!g.hasData());R--){g&&U(g.tileID.key);const q=E.calculateScaledKey(R);if(g=u.getTileByID(q),g&&g.hasData())break;const H=x[q];if(H===null)break;H===void 0?$.push(q):g=u.getTileByID(H)}return U(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,u){let g=this._tilesDirty[a];g||(g=this._tilesDirty[a]={}),g[u.key]=!0}}function I_(m,a,u){const g=function(R,O,$){const U=o.bI(O,R),q=o.bI($,[.2126,.7152,.0722]),H=(Q,ae,ue)=>(1-ue)*Q+ue*ae,X=H(1-.3*Math.min(q,1),1,Math.min(U+1,1));return H(.92,1,Math.asin(o.aA(O[2],-1,1))/Math.PI+.5)*X}(m,[0,0,1],a),x=[0,0,0];o.c4(x,u.slice(0,3),g);const S=[0,0,0];o.c4(S,a.slice(0,3),m[2]);const E=[0,0,0];return o.d7(E,x,S),o.da(E)}const P_=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],M_=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Kf{static cacheKey(a,u,g,x){let S=`${u}${x?x.cacheKey:""}`;for(const E of g)a.usedDefines.includes(E)&&(S+=`/${E}`);return S}constructor(a,u,g,x,S,E){const R=a.gl;this.program=R.createProgram(),this.configuration=x,this.name=u,this.fixedDefines=[...E];let O=x?x.defines():[];O=O.concat(E.map(Q=>`#define ${Q}`));const $=`#version 300 es
`;let U=$+O.concat("precision mediump float;",ec,Vf.fragmentSource).join(`
`);for(const Q of g.fragmentIncludes)U+=`
${Zd[Q]}`;U+=`
${g.fragmentSource}`;let q=$+O.concat("precision highp float;",ec,Vf.vertexSource).join(`
`);for(const Q of g.vertexIncludes)q+=`
${Zd[Q]}`;this.forceManualRenderingForInstanceIDShaders=a.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(q+=`
uniform int u_instanceID;
`),q+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(q=q.replaceAll("gl_InstanceID","u_instanceID"));const H=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(H,U),R.compileShader(H),R.attachShader(this.program,H);const X=R.createShader(R.VERTEX_SHADER);R.isContextLost()?this.failedToCreate=!0:(R.shaderSource(X,q),R.compileShader(X),R.attachShader(this.program,X),this.attributes={},R.linkProgram(this.program),R.deleteShader(X),R.deleteShader(H),this.fixedUniforms=S(a),this.binderUniforms=x?x.getUniforms(a):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Q=>({u_instanceID:new o.cg(Q)}))(a)),(E.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(Q=>({u_dem:new o.cg(Q),u_dem_prev:new o.cg(Q),u_dem_tl:new o.cj(Q),u_dem_scale:new o.ci(Q),u_dem_tl_prev:new o.cj(Q),u_dem_scale_prev:new o.ci(Q),u_dem_size:new o.ci(Q),u_dem_lerp:new o.ci(Q),u_exaggeration:new o.ci(Q),u_depth:new o.cg(Q),u_depth_size_inv:new o.cj(Q),u_depth_range_unpack:new o.cj(Q),u_occluder_half_size:new o.ci(Q),u_occlusion_depth_offset:new o.ci(Q),u_meter_to_dem:new o.ci(Q),u_label_plane_matrix_inv:new o.ck(Q)}))(a)),E.includes("GLOBE")&&(this.globeUniforms=(Q=>({u_tile_tl_up:new o.ch(Q),u_tile_tr_up:new o.ch(Q),u_tile_br_up:new o.ch(Q),u_tile_bl_up:new o.ch(Q),u_tile_up_scale:new o.ci(Q)}))(a)),E.includes("FOG")&&(this.fogUniforms=(Q=>({u_fog_matrix:new o.ck(Q),u_fog_range:new o.cj(Q),u_fog_color:new o.d2(Q),u_fog_horizon_blend:new o.ci(Q),u_fog_vertical_limit:new o.cj(Q),u_fog_temporal_offset:new o.ci(Q),u_frustum_tl:new o.ch(Q),u_frustum_tr:new o.ch(Q),u_frustum_br:new o.ch(Q),u_frustum_bl:new o.ch(Q),u_globe_pos:new o.ch(Q),u_globe_radius:new o.ci(Q),u_globe_transition:new o.ci(Q),u_is_globe:new o.cg(Q),u_viewport:new o.cj(Q)}))(a)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Q=>({u_cutoff_params:new o.d2(Q)}))(a)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Q=>({u_lighting_ambient_color:new o.ch(Q),u_lighting_directional_dir:new o.ch(Q),u_lighting_directional_color:new o.ch(Q),u_ground_radiance:new o.ch(Q)}))(a)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Q=>({u_light_matrix_0:new o.ck(Q),u_light_matrix_1:new o.ck(Q),u_fade_range:new o.cj(Q),u_shadow_normal_offset:new o.ch(Q),u_shadow_intensity:new o.ci(Q),u_shadow_texel_size:new o.ci(Q),u_shadow_map_resolution:new o.ci(Q),u_shadow_direction:new o.ch(Q),u_shadow_bias:new o.ch(Q),u_shadowmap_0:new o.cg(Q),u_shadowmap_1:new o.cg(Q)}))(a)))}getAttributeLocation(a,u){let g=this.attributes[u];return g===void 0&&(g=this.attributes[u]=a.getAttribLocation(this.program,u)),g}setTerrainUniformValues(a,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setGlobeUniformValues(a,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setFogUniformValues(a,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setCutoffUniformValues(a,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setLightsUniformValues(a,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setShadowUniformValues(a,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;a.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}_drawDebugWireframe(a,u,g,x,S,E,R,O,$,U){const q=a.options.wireframe;if(q.terrain===!1&&q.layers2D===!1&&q.layers3D===!1)return;const H=a.context;if(!(!(!q.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!q.layers2D||a._terrain&&a._terrain.renderingToTexture||!P_.includes(this.name))||!(!q.layers3D||!M_.includes(this.name))))return;const X=H.gl,Q=a.wireframeDebugCache.getLinesFromTrianglesBuffer(a.frameCounter,S,H);if(!Q)return;const ae=[...this.fixedDefines];ae.push("DEBUG_WIREFRAME");const ue=a.getOrCreateProgram(this.name,{config:this.configuration,defines:ae});H.program.set(ue.program);const ce=(ve,Fe,Ie)=>{if(Fe[ve]&&Ie[ve])for(const $e in Fe[ve])Ie[ve][$e]&&Ie[ve][$e].set(Ie.program,$e,Fe[ve][$e].current)};$&&$.setUniforms(ue.program,H,ue.binderUniforms,R,{zoom:O}),ce("fixedUniforms",this,ue),ce("terrainUniforms",this,ue),ce("globeUniforms",this,ue),ce("fogUniforms",this,ue),ce("lightsUniforms",this,ue),ce("shadowUniforms",this,ue),Q.bind(),H.setColorMode(new jr([X.ONE,X.ONE_MINUS_SRC_ALPHA,X.ZERO,X.ONE],o.ao.transparent,[!0,!0,!0,!1])),H.setDepthMode(new Hn(u.func===X.LESS?X.LEQUAL:u.func,Hn.ReadOnly,u.range)),H.setStencilMode(Tr.disabled);const pe=3*E.primitiveLength*2,Ce=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const ve=U||1;for(let Fe=0;Fe<ve;++Fe)ue.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Fe),X.drawElements(X.LINES,pe,X.UNSIGNED_SHORT,Ce)}else U&&U>1?X.drawElementsInstanced(X.LINES,pe,X.UNSIGNED_SHORT,Ce,U):X.drawElements(X.LINES,pe,X.UNSIGNED_SHORT,Ce);S.bind(),H.program.set(this.program),H.setDepthMode(u),H.setStencilMode(g),H.setColorMode(x)}checkUniforms(a,u,g){if(this.fixedDefines.includes(u)){for(const x of Object.keys(g))if(!g[x].initialized)throw new Error(`Program '${this.name}', from draw '${a}': uniform ${x} not set but required by ${u} being defined`)}}draw(a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue){const ce=a.context,pe=ce.gl;if(this.failedToCreate)return;ce.program.set(this.program),ce.setDepthMode(g),ce.setStencilMode(x),ce.setColorMode(S),ce.setCullFace(E);for(const Fe of Object.keys(this.fixedUniforms))this.fixedUniforms[Fe].set(this.program,Fe,R[Fe]);Q&&Q.setUniforms(this.program,ce,this.binderUniforms,H,{zoom:X});const Ce={[pe.POINTS]:1,[pe.LINES]:2,[pe.TRIANGLES]:3,[pe.LINE_STRIP]:1}[u];this.checkUniforms(O,"RENDER_SHADOWS",this.shadowUniforms);const ve=ue&&ue>0?1:void 0;for(const Fe of q.get()){const Ie=Fe.vaos||(Fe.vaos={});if((Ie[O]||(Ie[O]=new Yd)).bind(ce,this,$,Q?Q.getPaintVertexBuffers():[],U,Fe.vertexOffset,ae||[],ve),this.forceManualRenderingForInstanceIDShaders){const $e=ue||1;for(let Le=0;Le<$e;++Le)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Le),U?pe.drawElements(u,Fe.primitiveLength*Ce,pe.UNSIGNED_SHORT,Fe.primitiveOffset*Ce*2):pe.drawArrays(u,Fe.vertexOffset,Fe.vertexLength)}else ue&&ue>1?pe.drawElementsInstanced(u,Fe.primitiveLength*Ce,pe.UNSIGNED_SHORT,Fe.primitiveOffset*Ce*2,ue):U?pe.drawElements(u,Fe.primitiveLength*Ce,pe.UNSIGNED_SHORT,Fe.primitiveOffset*Ce*2):pe.drawArrays(u,Fe.vertexOffset,Fe.vertexLength);u===pe.TRIANGLES&&U&&this._drawDebugWireframe(a,g,x,S,U,Fe,H,X,Q,ue)}}}function Rm(m,a,u=0){const g=Math.pow(2,a.tileID.overscaledZ),x=a.tileSize*Math.pow(2,m.transform.tileZoom)/g,S=x*(a.tileID.canonical.x+a.tileID.wrap*g),E=x*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ay(a,1,m.transform.tileZoom),u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E],u_pattern_transition:u}}const nh={terrain:0,flat:1},Am=o.bB(),Om=(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce)=>{const pe=a.style.light,Ce=pe.properties.get("position"),ve=[Ce.x,Ce.y,Ce.z],Fe=o.dN();pe.properties.get("anchor")==="viewport"&&(o.dO(Fe,-a.transform.angle),o.dP(ve,ve,Fe));const Ie=pe.properties.get("color").toPremultipliedRenderColor(null),$e=a.transform,Le={u_matrix:m,u_lightpos:ve,u_lightintensity:pe.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Am,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:nh[$],u_base_type:nh[U],u_ao:x,u_edge_radius:S,u_width_scale:E,u_flood_light_color:Q,u_vertical_scale:ae,u_flood_light_intensity:ue,u_ground_shadow_factor:ce};return $e.projection.name==="globe"&&(Le.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],Le.u_zoom_transition=q,Le.u_inv_rot_matrix=X,Le.u_merc_center=H,Le.u_up_dir=$e.projection.upVector(new o.cC(0,0,0),H[0]*o.al,H[1]*o.al),Le.u_height_lift=O),Le},Db=(m,a,u,g,x,S)=>({u_matrix:m,u_edge_radius:a,u_width_scale:u,u_vertical_scale:g,u_height_type:nh[x],u_base_type:nh[S]}),Lb=(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce)=>{const pe=Om(m,a,u,g,x,S,E,R,$,U,q,H,X,Q,ae,ue,1,[0,0,0]),Ce={u_height_factor:-Math.pow(2,R.overscaledZ)/O.tileSize/8};return Object.assign(pe,Rm(a,O,ce),Ce)},rh=(m,a,u,g,x,S,E,R,O,$,U)=>({u_matrix:a,u_opacity:u,u_ao_pass:g?1:0,u_meter_to_tile:x,u_ao:S,u_flood_light_intensity:E,u_flood_light_color:R,u_attenuation:O,u_edge_radius:$,u_fb:0,u_fb_size:U,u_dynamic_offset:1}),zb=(m,a,u)=>({u_matrix:m,u_emissive_strength:a,u_ground_shadow_factor:u}),kb=(m,a,u,g,x,S=0)=>Object.assign(zb(m,a,x),Rm(u,g,S)),pT=(m,a,u,g)=>({u_matrix:m,u_world:u,u_emissive_strength:a,u_ground_shadow_factor:g}),mT=(m,a,u,g,x,S,E=0)=>Object.assign(kb(m,a,u,g,S,E),{u_world:x}),gT=(m,a)=>({u_matrix:m,u_ground_shadow_factor:a}),Dm=(m,a,u,g,x)=>({u_matrix:m,u_camera_pos:[a[0],a[1],a[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:x}),R_=(m,a,u,g,x,S,E,R,O)=>({u_matrix:m,u_normal_matrix:a,u_opacity:u,u_faux_facade_ao_intensity:g,u_camera_pos:x,u_tile_to_meter:S,u_facade_emissive_chance:E,u_flood_light_color:R,u_flood_light_intensity:O}),A_=m=>({u_matrix:m}),Fb=m=>({u_matrix:m}),ih=(m,a,u,g,x,S,E,R)=>{const O=o.al/S.tileSize;return{u_matrix:m,u_inv_rot_matrix:a,u_camera_to_center_distance:u.getCameraToCenterDistance(R),u_extrude_scale:[u.pixelsToGLUnits[0]/O,u.pixelsToGLUnits[1]/O],u_zoom_transition:g,u_tile_id:E,u_merc_center:x}},O_=(m,a,u=1)=>({u_matrix:m,u_color:a,u_overlay:0,u_overlay_scale:u}),Nb=o.bB(),Bb=(m,a,u,g,x,S,E)=>{const R=m.transform,O=R.projection.name==="globe",$=O?o.dQ(R.zoom,a.canonical)*R._pixelsPerMercatorPixel:o.ay(u,1,S),U={u_matrix:a.projMatrix,u_extrude_scale:$,u_intensity:E,u_inv_rot_matrix:Nb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){U.u_inv_rot_matrix=g,U.u_merc_center=x,U.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],U.u_zoom_transition=o.aj(R.zoom);const q=x[0]*o.al,H=x[1]*o.al;U.u_up_dir=R.projection.upVector(new o.cC(0,0,0),q,H)}return U};function Lm(m,[a,u,g,x],[S,E]){if(S===E)return[0,0,0,0];const R=255*(m-1)/(m*(E-S));return[a*R,u*R,g*R,x*R]}function Ec(m,a,[u,g]){return u===g?0:.5/m+(a-u)*(m-1)/(m*(g-u))}const Xf=(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe,Ce,ve)=>({u_matrix:m,u_normalize_matrix:a,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:$,u_fade_t:U.mix,u_opacity:U.opacity*q.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:q.paint.get("raster-brightness-min"),u_brightness_high:q.paint.get("raster-brightness-max"),u_saturation_factor:o.dS(q.paint.get("raster-saturation")),u_contrast_factor:o.dR(q.paint.get("raster-contrast")),u_spin_weights:zm(q.paint.get("raster-hue-rotate")),u_perspective_transform:H,u_raster_elevation:X,u_zoom_transition:E,u_merc_center:R,u_cutoff_params:O,u_colorization_mix:Lm(o.dT,ae,ce),u_colorization_offset:Ec(o.dT,ue,ce),u_color_ramp:Q,u_texture_offset:[Ce/(pe+2*Ce),pe/(pe+2*Ce)],u_texture_res:[pe+2*Ce,pe+2*Ce],u_emissive_strength:ve});function zm(m){m*=Math.PI/180;const a=Math.sin(m),u=Math.cos(m);return[(2*u+1)/3,(-Math.sqrt(3)*a-u+1)/3,(Math.sqrt(3)*a-u+1)/3]}const od=.05,lu=(m,a,u,g,x,S,E,R,O,$,U,q)=>({u_matrix:m,u_normalize_matrix:a,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:$,u_fade_t:U.mix,u_opacity:U.opacity,u_image0:0,u_image1:1,u_raster_elevation:q,u_zoom_transition:E,u_merc_center:R,u_cutoff_params:O}),D_=(m,a,u,g,x,S,E,R,O,$)=>({u_particle_texture:m,u_particle_texture_side_len:a,u_tile_offset:u,u_velocity:g,u_color_ramp:S,u_velocity_res:x,u_max_speed:E,u_uv_offset:R,u_data_scale:[255*O[0],255*O[1]],u_data_offset:$,u_particle_pos_scale:1.1,u_particle_pos_offset:[od,od]}),km=(m,a,u,g,x,S,E,R,O,$)=>({u_particle_texture:m,u_particle_texture_side_len:a,u_velocity:u,u_velocity_res:g,u_max_speed:x,u_speed_factor:S,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:R,u_data_scale:[255*O[0],255*O[1]],u_data_offset:$,u_particle_pos_scale:1.1,u_particle_pos_offset:[od,od]}),L_=o.bB(),z_=(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe,Ce,ve,Fe,Ie,$e)=>{const Le=x.transform,Me={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:Le.getCameraToCenterDistance(pe),u_rotate_symbol:+u,u_aspect_ratio:Le.width/Le.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:E,u_coord_matrix:R,u_is_text:+$,u_elevation_from_sea:O?1:0,u_pitch_with_map:+g,u_texsize:U,u_texsize_icon:q,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:L_,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:L_,u_up_vector:[0,-1,0],u_color_adj_mat:Fe,u_icon_transition:Ie||0,u_gamma_scale:g?x.transform.getCameraToCenterDistance(pe)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:o.o.devicePixelRatio,u_is_halo:1,u_scale_factor:$e||1,u_ground_shadow_factor:Ce,u_inv_matrix:o.bk(o.bB(),E),u_normal_scale:ve,u_lutTexture:Ma.LUT};return pe.name==="globe"&&(Me.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],Me.u_zoom_transition=Q,Me.u_inv_rot_matrix=ue,Me.u_merc_center=ae,Me.u_camera_forward=Le._camera.forward(),Me.u_ecef_origin=o.dU(Le.globeMatrix,X.toUnwrapped()),Me.u_tile_matrix=Float32Array.from(Le.globeMatrix),Me.u_up_vector=ce),Me},Fm=(m,a,u,g)=>({u_matrix:m,u_emissive_strength:a,u_opacity:u,u_color:g}),Nm=(m,a,u,g,x,S,E,R,O)=>Object.assign(function($,U,q,H,X,Q){const{width:ae,height:ue}=H.imageManager.getPixelSize(U),ce=Math.pow(2,Q.tileID.overscaledZ),pe=Q.tileSize*Math.pow(2,H.transform.tileZoom)/ce,Ce=pe*(Q.tileID.canonical.x+Q.tileID.wrap*ce),ve=pe*Q.tileID.canonical.y;return{u_image:0,u_pattern_tl:q.tl,u_pattern_br:q.br,u_texsize:[ae,ue],u_pattern_size:q.displaySize,u_pattern_units_to_pixels:X?[H.transform.width,-1*H.transform.height]:[1/o.ay(Q,1,H.transform.tileZoom),1/o.ay(Q,1,H.transform.tileZoom)],u_pixel_coord_upper:[Ce>>16,ve>>16],u_pixel_coord_lower:[65535&Ce,65535&ve]}}(0,S,E,g,R,O),{u_matrix:m,u_emissive_strength:a,u_opacity:u}),k_=new Float32Array(o.bz([])),Bm=(m,a,u,g,x,S,E,R,O,$,U,q,H,X=[0,0,0],Q,ae,ue)=>{const ce=x.style.light,pe=ce.properties.get("position"),Ce=[-pe.x,-pe.y,pe.z],ve=o.dN();ce.properties.get("anchor")==="viewport"&&(o.dO(ve,-x.transform.angle),o.dP(Ce,Ce,ve));const Fe=U.alphaMode==="MASK",Ie=ce.properties.get("color").toNonPremultipliedRenderColor(null),$e=H.paint.get("model-ambient-occlusion-intensity"),Le=H.paint.get("model-color").constantOr(o.ao.white).toNonPremultipliedRenderColor(null);return Le.a=H.paint.get("model-color-mix-intensity").constantOr(0),ue&&(Le.r=ue[0],Le.g=ue[1],Le.b=ue[2],Le.a=ue[3]),ae&&(Le.r=ae.color.r,Le.g=ae.color.g,Le.b=ae.color.b,Le.a=ae.colorMix,q=ae.emissionStrength,S=ae.opacity),{u_matrix:m,u_lighting_matrix:a,u_normal_matrix:u,u_node_matrix:g||k_,u_lightpos:Ce,u_lightintensity:ce.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_camera_pos:X,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+Fe,u_alphaCutoff:U.alphaCutoff,u_baseColorFactor:E.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:R.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:O,u_roughnessFactor:$,u_baseColorTexture:Ma.BaseColor,u_metallicRoughnessTexture:Ma.MetallicRoughness,u_normalTexture:Ma.Normal,u_occlusionTexture:Ma.Occlusion,u_emissionTexture:Ma.Emission,u_lutTexture:Ma.LUT,u_color_mix:Le.toArray01(),u_aoIntensity:$e,u_emissive_strength:q,u_occlusionTextureTransform:Q||[0,0,0,0]}},oh=(m,a=k_,u=k_)=>({u_matrix:m,u_instance:a,u_node_matrix:u}),vT={fillExtrusion:m=>({u_matrix:new o.ck(m),u_lightpos:new o.ch(m),u_lightintensity:new o.ci(m),u_lightcolor:new o.ch(m),u_vertical_gradient:new o.ci(m),u_opacity:new o.ci(m),u_edge_radius:new o.ci(m),u_width_scale:new o.ci(m),u_ao:new o.cj(m),u_height_type:new o.cg(m),u_base_type:new o.cg(m),u_tile_id:new o.ch(m),u_zoom_transition:new o.ci(m),u_inv_rot_matrix:new o.ck(m),u_merc_center:new o.cj(m),u_up_dir:new o.ch(m),u_height_lift:new o.ci(m),u_flood_light_color:new o.ch(m),u_vertical_scale:new o.ci(m),u_flood_light_intensity:new o.ci(m),u_ground_shadow_factor:new o.ch(m)}),fillExtrusionDepth:m=>({u_matrix:new o.ck(m),u_edge_radius:new o.ci(m),u_width_scale:new o.ci(m),u_vertical_scale:new o.ci(m),u_height_type:new o.cg(m),u_base_type:new o.cg(m)}),fillExtrusionPattern:m=>({u_matrix:new o.ck(m),u_lightpos:new o.ch(m),u_lightintensity:new o.ci(m),u_lightcolor:new o.ch(m),u_vertical_gradient:new o.ci(m),u_height_factor:new o.ci(m),u_edge_radius:new o.ci(m),u_width_scale:new o.ci(m),u_ao:new o.cj(m),u_height_type:new o.cg(m),u_base_type:new o.cg(m),u_tile_id:new o.ch(m),u_zoom_transition:new o.ci(m),u_inv_rot_matrix:new o.ck(m),u_merc_center:new o.cj(m),u_up_dir:new o.ch(m),u_height_lift:new o.ci(m),u_image:new o.cg(m),u_texsize:new o.cj(m),u_pixel_coord_upper:new o.cj(m),u_pixel_coord_lower:new o.cj(m),u_tile_units_to_pixels:new o.ci(m),u_opacity:new o.ci(m),u_pattern_transition:new o.ci(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new o.ck(m),u_opacity:new o.ci(m),u_ao_pass:new o.ci(m),u_meter_to_tile:new o.ci(m),u_ao:new o.cj(m),u_flood_light_intensity:new o.ci(m),u_flood_light_color:new o.ch(m),u_attenuation:new o.ci(m),u_edge_radius:new o.ci(m),u_fb:new o.cg(m),u_fb_size:new o.ci(m),u_dynamic_offset:new o.ci(m)}),fill:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_ground_shadow_factor:new o.ch(m)}),fillPattern:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_image:new o.cg(m),u_texsize:new o.cj(m),u_pixel_coord_upper:new o.cj(m),u_pixel_coord_lower:new o.cj(m),u_tile_units_to_pixels:new o.ci(m),u_ground_shadow_factor:new o.ch(m),u_pattern_transition:new o.ci(m)}),fillOutline:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_world:new o.cj(m),u_ground_shadow_factor:new o.ch(m)}),fillOutlinePattern:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_world:new o.cj(m),u_image:new o.cg(m),u_texsize:new o.cj(m),u_pixel_coord_upper:new o.cj(m),u_pixel_coord_lower:new o.cj(m),u_tile_units_to_pixels:new o.ci(m),u_ground_shadow_factor:new o.ch(m),u_pattern_transition:new o.ci(m)}),building:m=>({u_matrix:new o.ck(m),u_normal_matrix:new o.ck(m),u_opacity:new o.ci(m),u_faux_facade_ao_intensity:new o.ci(m),u_camera_pos:new o.ch(m),u_tile_to_meter:new o.ci(m),u_facade_emissive_chance:new o.ci(m),u_flood_light_color:new o.ch(m),u_flood_light_intensity:new o.ci(m)}),buildingBloom:m=>({u_matrix:new o.ck(m)}),buildingDepth:m=>({u_matrix:new o.ck(m)}),elevatedStructuresDepth:m=>({u_matrix:new o.ck(m),u_depth_bias:new o.ci(m)}),elevatedStructures:m=>({u_matrix:new o.ck(m),u_ground_shadow_factor:new o.ch(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new o.ck(m),u_camera_pos:new o.ch(m),u_depth_bias:new o.ci(m),u_height_scale:new o.ci(m),u_reset_depth:new o.ci(m)}),circle:o.dX,collisionBox:m=>({u_matrix:new o.ck(m),u_inv_rot_matrix:new o.ck(m),u_camera_to_center_distance:new o.ci(m),u_extrude_scale:new o.cj(m),u_zoom_transition:new o.ci(m),u_merc_center:new o.cj(m),u_tile_id:new o.ch(m)}),collisionCircle:m=>({u_matrix:new o.ck(m),u_inv_matrix:new o.ck(m),u_camera_to_center_distance:new o.ci(m),u_viewport_size:new o.cj(m)}),debug:m=>({u_color:new o.dA(m),u_matrix:new o.ck(m),u_overlay:new o.cg(m),u_overlay_scale:new o.ci(m)}),clippingMask:m=>({u_matrix:new o.ck(m)}),heatmap:m=>({u_extrude_scale:new o.ci(m),u_intensity:new o.ci(m),u_matrix:new o.ck(m),u_inv_rot_matrix:new o.ck(m),u_merc_center:new o.cj(m),u_tile_id:new o.ch(m),u_zoom_transition:new o.ci(m),u_up_dir:new o.ch(m)}),heatmapTexture:m=>({u_image:new o.cg(m),u_color_ramp:new o.cg(m),u_opacity:new o.ci(m)}),hillshade:m=>({u_matrix:new o.ck(m),u_image:new o.cg(m),u_latrange:new o.cj(m),u_light:new o.cj(m),u_shadow:new o.dA(m),u_highlight:new o.dA(m),u_emissive_strength:new o.ci(m),u_accent:new o.dA(m)}),hillshadePrepare:m=>({u_matrix:new o.ck(m),u_image:new o.cg(m),u_dimension:new o.cj(m),u_zoom:new o.ci(m)}),line:o.dW,linePattern:o.dV,raster:m=>({u_matrix:new o.ck(m),u_normalize_matrix:new o.ck(m),u_globe_matrix:new o.ck(m),u_merc_matrix:new o.ck(m),u_grid_matrix:new o.dB(m),u_tl_parent:new o.cj(m),u_scale_parent:new o.ci(m),u_fade_t:new o.ci(m),u_opacity:new o.ci(m),u_image0:new o.cg(m),u_image1:new o.cg(m),u_brightness_low:new o.ci(m),u_brightness_high:new o.ci(m),u_saturation_factor:new o.ci(m),u_contrast_factor:new o.ci(m),u_spin_weights:new o.ch(m),u_perspective_transform:new o.cj(m),u_raster_elevation:new o.ci(m),u_zoom_transition:new o.ci(m),u_merc_center:new o.cj(m),u_cutoff_params:new o.d2(m),u_colorization_mix:new o.d2(m),u_colorization_offset:new o.ci(m),u_color_ramp:new o.cg(m),u_texture_offset:new o.cj(m),u_texture_res:new o.cj(m),u_emissive_strength:new o.ci(m)}),rasterParticle:m=>({u_matrix:new o.ck(m),u_normalize_matrix:new o.ck(m),u_globe_matrix:new o.ck(m),u_merc_matrix:new o.ck(m),u_grid_matrix:new o.dB(m),u_tl_parent:new o.cj(m),u_scale_parent:new o.ci(m),u_fade_t:new o.ci(m),u_opacity:new o.ci(m),u_image0:new o.cg(m),u_image1:new o.cg(m),u_raster_elevation:new o.ci(m),u_zoom_transition:new o.ci(m),u_merc_center:new o.cj(m),u_cutoff_params:new o.d2(m)}),rasterParticleTexture:m=>({u_texture:new o.cg(m),u_opacity:new o.ci(m)}),rasterParticleDraw:m=>({u_particle_texture:new o.cg(m),u_particle_texture_side_len:new o.ci(m),u_tile_offset:new o.cj(m),u_velocity:new o.cg(m),u_color_ramp:new o.cg(m),u_velocity_res:new o.cj(m),u_max_speed:new o.ci(m),u_uv_offset:new o.cj(m),u_data_scale:new o.cj(m),u_data_offset:new o.ci(m),u_particle_pos_scale:new o.ci(m),u_particle_pos_offset:new o.cj(m)}),rasterParticleUpdate:m=>({u_particle_texture:new o.cg(m),u_particle_texture_side_len:new o.ci(m),u_velocity:new o.cg(m),u_velocity_res:new o.cj(m),u_max_speed:new o.ci(m),u_speed_factor:new o.ci(m),u_reset_rate:new o.ci(m),u_rand_seed:new o.ci(m),u_uv_offset:new o.cj(m),u_data_scale:new o.cj(m),u_data_offset:new o.ci(m),u_particle_pos_scale:new o.ci(m),u_particle_pos_offset:new o.cj(m)}),symbol:m=>({u_is_size_zoom_constant:new o.cg(m),u_is_size_feature_constant:new o.cg(m),u_size_t:new o.ci(m),u_size:new o.ci(m),u_camera_to_center_distance:new o.ci(m),u_rotate_symbol:new o.cg(m),u_aspect_ratio:new o.ci(m),u_fade_change:new o.ci(m),u_matrix:new o.ck(m),u_label_plane_matrix:new o.ck(m),u_coord_matrix:new o.ck(m),u_is_text:new o.cg(m),u_elevation_from_sea:new o.cg(m),u_pitch_with_map:new o.cg(m),u_texsize:new o.cj(m),u_texsize_icon:new o.cj(m),u_texture:new o.cg(m),u_texture_icon:new o.cg(m),u_gamma_scale:new o.ci(m),u_device_pixel_ratio:new o.ci(m),u_tile_id:new o.ch(m),u_zoom_transition:new o.ci(m),u_inv_rot_matrix:new o.ck(m),u_merc_center:new o.cj(m),u_camera_forward:new o.ch(m),u_tile_matrix:new o.ck(m),u_up_vector:new o.ch(m),u_ecef_origin:new o.ch(m),u_is_halo:new o.cg(m),u_icon_transition:new o.ci(m),u_color_adj_mat:new o.ck(m),u_scale_factor:new o.ci(m),u_ground_shadow_factor:new o.ch(m),u_inv_matrix:new o.ck(m),u_normal_scale:new o.ci(m),u_lutTexture:new o.cg(m)}),background:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_opacity:new o.ci(m),u_color:new o.dA(m)}),backgroundPattern:m=>({u_matrix:new o.ck(m),u_emissive_strength:new o.ci(m),u_opacity:new o.ci(m),u_image:new o.cg(m),u_pattern_tl:new o.cj(m),u_pattern_br:new o.cj(m),u_texsize:new o.cj(m),u_pattern_size:new o.cj(m),u_pixel_coord_upper:new o.cj(m),u_pixel_coord_lower:new o.cj(m),u_pattern_units_to_pixels:new o.cj(m)}),terrainRaster:m=>({u_matrix:new o.ck(m),u_image0:new o.cg(m),u_skirt_height:new o.ci(m),u_ground_shadow_factor:new o.ch(m)}),skybox:m=>({u_matrix:new o.ck(m),u_sun_direction:new o.ch(m),u_cubemap:new o.cg(m),u_opacity:new o.ci(m),u_temporal_offset:new o.ci(m)}),skyboxGradient:m=>({u_matrix:new o.ck(m),u_color_ramp:new o.cg(m),u_center_direction:new o.ch(m),u_radius:new o.ci(m),u_opacity:new o.ci(m),u_temporal_offset:new o.ci(m)}),skyboxCapture:m=>({u_matrix_3f:new o.dB(m),u_sun_direction:new o.ch(m),u_sun_intensity:new o.ci(m),u_color_tint_r:new o.d2(m),u_color_tint_m:new o.d2(m),u_luminance:new o.ci(m)}),globeRaster:m=>({u_proj_matrix:new o.ck(m),u_globe_matrix:new o.ck(m),u_normalize_matrix:new o.ck(m),u_merc_matrix:new o.ck(m),u_zoom_transition:new o.ci(m),u_merc_center:new o.cj(m),u_image0:new o.cg(m),u_grid_matrix:new o.dB(m),u_skirt_height:new o.ci(m),u_far_z_cutoff:new o.ci(m),u_frustum_tl:new o.ch(m),u_frustum_tr:new o.ch(m),u_frustum_br:new o.ch(m),u_frustum_bl:new o.ch(m),u_globe_pos:new o.ch(m),u_globe_radius:new o.ci(m),u_viewport:new o.cj(m)}),globeAtmosphere:m=>({u_frustum_tl:new o.ch(m),u_frustum_tr:new o.ch(m),u_frustum_br:new o.ch(m),u_frustum_bl:new o.ch(m),u_horizon:new o.ci(m),u_transition:new o.ci(m),u_fadeout_range:new o.ci(m),u_atmosphere_fog_color:new o.d2(m),u_high_color:new o.d2(m),u_space_color:new o.d2(m),u_temporal_offset:new o.ci(m),u_horizon_angle:new o.ci(m)}),model:m=>({u_matrix:new o.ck(m),u_lighting_matrix:new o.ck(m),u_normal_matrix:new o.ck(m),u_node_matrix:new o.ck(m),u_lightpos:new o.ch(m),u_lightintensity:new o.ci(m),u_lightcolor:new o.ch(m),u_camera_pos:new o.ch(m),u_opacity:new o.ci(m),u_baseColorFactor:new o.d2(m),u_emissiveFactor:new o.d2(m),u_metallicFactor:new o.ci(m),u_roughnessFactor:new o.ci(m),u_baseTextureIsAlpha:new o.cg(m),u_alphaMask:new o.cg(m),u_alphaCutoff:new o.ci(m),u_baseColorTexture:new o.cg(m),u_metallicRoughnessTexture:new o.cg(m),u_normalTexture:new o.cg(m),u_occlusionTexture:new o.cg(m),u_emissionTexture:new o.cg(m),u_lutTexture:new o.cg(m),u_color_mix:new o.d2(m),u_aoIntensity:new o.ci(m),u_emissive_strength:new o.ci(m),u_occlusionTextureTransform:new o.d2(m)}),modelDepth:m=>({u_matrix:new o.ck(m),u_instance:new o.ck(m),u_node_matrix:new o.ck(m)}),groundShadow:m=>({u_matrix:new o.ck(m),u_ground_shadow_factor:new o.ch(m)}),stars:m=>({u_matrix:new o.ck(m),u_up:new o.ch(m),u_right:new o.ch(m),u_intensity_multiplier:new o.ci(m)}),snowParticle:m=>({u_modelview:new o.ck(m),u_projection:new o.ck(m),u_time:new o.ci(m),u_cam_pos:new o.ch(m),u_velocityConeAperture:new o.ci(m),u_velocity:new o.ci(m),u_horizontalOscillationRadius:new o.ci(m),u_horizontalOscillationRate:new o.ci(m),u_boxSize:new o.ci(m),u_billboardSize:new o.ci(m),u_simpleShapeParameters:new o.cj(m),u_screenSize:new o.cj(m),u_thinningCenterPos:new o.cj(m),u_thinningShape:new o.ch(m),u_thinningAffectedRatio:new o.ci(m),u_thinningParticleOffset:new o.ci(m),u_particleColor:new o.d2(m),u_direction:new o.ch(m)}),rainParticle:m=>({u_modelview:new o.ck(m),u_projection:new o.ck(m),u_time:new o.ci(m),u_cam_pos:new o.ch(m),u_texScreen:new o.cg(m),u_velocityConeAperture:new o.ci(m),u_velocity:new o.ci(m),u_boxSize:new o.ci(m),u_rainDropletSize:new o.cj(m),u_distortionStrength:new o.ci(m),u_rainDirection:new o.ch(m),u_color:new o.d2(m),u_screenSize:new o.cj(m),u_thinningCenterPos:new o.cj(m),u_thinningShape:new o.ch(m),u_thinningAffectedRatio:new o.ci(m),u_thinningParticleOffset:new o.ci(m),u_shapeDirectionalPower:new o.ci(m),u_shapeNormalPower:new o.ci(m),u_mode:new o.ci(m)}),vignette:m=>({u_vignetteShape:new o.ch(m),u_vignetteColor:new o.d2(m)}),occlusion:m=>({u_matrix:new o.ck(m),u_anchorPos:new o.ch(m),u_screenSizePx:new o.cj(m),u_occluderSizePx:new o.cj(m),u_color:new o.d2(m)})};class cu{constructor(a,u,g,x){this.id=cu.uniqueIdxCounter,cu.uniqueIdxCounter++,this.context=a;const S=a.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||x||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){this.id=cu.uniqueIdxCounter,cu.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}cu.uniqueIdxCounter=0;const $b={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _T{constructor(a,u,g,x,S,E){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.instanceCount=E,this.context=a;const R=a.gl;this.buffer=R.createBuffer(),a.bindVertexBuffer.set(this.buffer),R.bufferData(R.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?R.DYNAMIC_DRAW:R.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,u){for(let g=0;g<this.attributes.length;g++){const x=u.getAttributeLocation(a,this.attributes[g].name);x!==-1&&a.enableVertexAttribArray(x)}}setVertexAttribPointers(a,u,g){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],E=u.getAttributeLocation(a,S.name);E!==-1&&a.vertexAttribPointer(E,S.components,a[$b[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(a,u,g){for(let x=0;x<this.attributes.length;x++){const S=u.getAttributeLocation(a,this.attributes[x].name);S!==-1&&this.instanceCount&&this.instanceCount>0&&a.vertexAttribDivisor(S,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $m{constructor(a,u,g,x,S){this.context=a,this.width=u,this.height=g;const E=this.framebuffer=a.gl.createFramebuffer();x&&(this.colorAttachment=new hT(a,E)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Ab(a,E):new fT(a,E))}destroy(){const a=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&a.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&a.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&a.deleteTexture(u)}a.deleteFramebuffer(this.framebuffer)}}class jm{constructor(a,u){this.gl=a,this.clearColor=new Sb(this),this.clearDepth=new __(this),this.clearStencil=new aT(this),this.colorMask=new sT(this),this.depthMask=new lT(this),this.stencilMask=new cT(this),this.stencilFunc=new Cb(this),this.stencilOp=new uT(this),this.stencilTest=new bm(this),this.depthRange=new dT(this),this.depthTest=new Eb(this),this.depthFunc=new y_(this),this.blend=new wm(this),this.blendFunc=new x_(this),this.blendColor=new nd(this),this.blendEquation=new Jd(this),this.cullFace=new Uf(this),this.cullFaceSide=new Qd(this),this.frontFace=new Tb(this),this.program=new b_(this),this.activeTexture=new Ib(this),this.viewport=new eh(this),this.bindFramebuffer=new Sm(this),this.bindRenderbuffer=new Cm(this),this.bindTexture=new w_(this),this.bindVertexBuffer=new Em(this),this.bindElementBuffer=new Hf(this),this.bindVertexArrayOES=new Pb(this),this.pixelStoreUnpack=new Mb(this),this.pixelStoreUnpackPremultiplyAlpha=new Rb(this),this.pixelStoreUnpackFlipY=new th(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=a.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),this.maxPointSize=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,u,g){return new cu(this,a,u,g)}createVertexBuffer(a,u,g,x,S){return new _T(this,a,u,g,x,S)}createRenderbuffer(a,u,g){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,a,u,g),this.bindRenderbuffer.set(null),S}createFramebuffer(a,u,g,x){return new $m(this,a,u,g,x)}clear({color:a,depth:u,stencil:g,colorMask:x}){const S=this.gl;let E=0;a&&(E|=S.COLOR_BUFFER_BIT,this.clearColor.set(a.toNonPremultipliedRenderColor(null)),this.colorMask.set(x||[!0,!0,!0,!0])),u!==void 0&&(E|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(E|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),S.clear(E)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){o.bx(a.blendFunction,jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor),a.blendEquation?this.blendEquation.set(a.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(a.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let tc;function Zf(m,a,u,g,x,S,E){const R=m.context,O=R.gl,$=m.transform,U=[o.aF($.center.lng),o.aJ($.center.lat)],q=u.layout.get("symbol-placement"),H=u.layout.get("text-variable-anchor"),X=u.layout.get("icon-rotation-alignment")==="map",Q=u.layout.get("text-rotation-alignment")==="map",ae=q!=="point",ue=[];let ce=0,pe=0;for(let Me=0;Me<g.length;Me++){const Ve=g[Me],st=a.getTile(Ve),nt=st.getBucket(u);if(!nt)continue;const Et=nt.getProjection().createInversionMatrix($,Ve.canonical),mt=[],Lt=gb(Ve,nt,$),ln=!E&&X&&ae,ht=E&&Q&&ae,Qe=H&&nt.hasTextData(),kt=nt.hasIconTextFit()&&Qe&&nt.hasIconData(),gt=ln||ht||E&&Qe||kt,Kt=nt.projection.name==="globe",pn=Kt?o.aj($.zoom):0;Kt&&(mt.push("PROJECTION_GLOBE_VIEW"),gt&&mt.push("PROJECTED_POS_ON_VIEWPORT"));const Nn=m.getOrCreateProgram("collisionBox",{defines:mt});let an=Lt;x[0]===0&&x[1]===0||(an=m.translatePosMatrix(Lt,st,x,S));const dn=E?nt.textCollisionBox:nt.iconCollisionBox,jn=nt.collisionCircleArray;if(jn.length>0){const wn=o.bB(),Rn=an;o.cO(wn,nt.placementInvProjMatrix,$.glCoordMatrix),o.cO(wn,wn,nt.placementViewportMatrix),ue.push({circleArray:jn,circleOffset:pe,transform:Rn,invTransform:wn,projection:nt.getProjection()}),ce+=jn.length/4,pe=ce}if(!dn)continue;m.terrain&&m.terrain.setupElevationDraw(st,Nn);const Mn=Kt?[Ve.canonical.x,Ve.canonical.y,1<<Ve.canonical.z]:[0,0,0];Nn.draw(m,O.LINES,Hn.disabled,Tr.disabled,m.colorModeForRenderPass(),xr.disabled,ih(an,Et,$,pn,U,st,Mn,nt.getProjection()),u.id,dn.layoutVertexBuffer,dn.indexBuffer,dn.segments,null,$.zoom,null,[dn.collisionVertexBuffer,dn.collisionVertexBufferExt])}if(!E||!ue.length)return;const Ce=m.getOrCreateProgram("collisionCircle"),ve=new o.dY;ve.resize(4*ce),ve._trim();let Fe=0;for(const Me of ue)for(let Ve=0;Ve<Me.circleArray.length/4;Ve++){const st=4*Ve,nt=Me.circleArray[st+0],Et=Me.circleArray[st+1],mt=Me.circleArray[st+2],Lt=Me.circleArray[st+3];ve.emplace(Fe++,nt,Et,mt,Lt,0),ve.emplace(Fe++,nt,Et,mt,Lt,1),ve.emplace(Fe++,nt,Et,mt,Lt,2),ve.emplace(Fe++,nt,Et,mt,Lt,3)}(!tc||tc.length<2*ce)&&(tc=function(Me){const Ve=2*Me,st=new o.b0;st.resize(Ve),st._trim();for(let nt=0;nt<Ve;nt++){const Et=6*nt;st.uint16[Et+0]=4*nt+0,st.uint16[Et+1]=4*nt+1,st.uint16[Et+2]=4*nt+2,st.uint16[Et+3]=4*nt+2,st.uint16[Et+4]=4*nt+3,st.uint16[Et+5]=4*nt+0}return st}(ce));const Ie=R.createIndexBuffer(tc,!0),$e=R.createVertexBuffer(ve,o.dZ.members,!0);for(const Me of ue){const Ve={u_matrix:Me.transform,u_inv_matrix:Me.invTransform,u_camera_to_center_distance:(Le=$).getCameraToCenterDistance(Me.projection),u_viewport_size:[Le.width,Le.height]};Ce.draw(m,O.TRIANGLES,Hn.disabled,Tr.disabled,m.colorModeForRenderPass(),xr.disabled,Ve,u.id,$e,Ie,o.bf.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,$.zoom)}var Le;$e.destroy(),Ie.destroy()}const uu=o.bB();function F_(m){const a=m._camera.getWorldToCamera(m.worldSize,1),u=o.aB([],a,m.globeMatrix);o.bk(u,u);const g=[0,0,0],x=[0,1,0,0];return o.aC(x,x,u),g[0]=x[0],g[1]=x[1],g[2]=x[2],o.aw(g,g),g}function Vm({width:m,height:a,anchor:u,textOffset:g,textScale:x},S){const{horizontalAlign:E,verticalAlign:R}=o.c0(u),O=-(E-.5)*m,$=-(R-.5)*a,U=o.c1(u,g);return new o.P((O/x+U[0])*S,($/x+U[1])*S)}function Um(m,a,u,g,x,S,E,R,O,$){const U=m.text.placedSymbolArray,q=m.text.dynamicLayoutVertexArray,H=m.icon.dynamicLayoutVertexArray,X={},Q=m.getProjection(),ae=cm(E,Q,x),ue=x.elevation,ce=Q.upVectorScale(E.canonical,x.center.lat,x.worldSize).metersToTile;q.clear();for(let pe=0;pe<U.length;pe++){const Ce=U.get(pe),{tileAnchorX:ve,tileAnchorY:Fe,numGlyphs:Ie}=Ce,$e=Ce.hidden||!Ce.crossTileID||m.allowVerticalPlacement&&!Ce.placedOrientation?null:g[Ce.crossTileID];if($e){let Le=0,Me=0,Ve=0;const st=m.elevationType==="road";if(ue||st){const gt=st?m.getElevationFeatureForText(pe):null,Kt=o.bU.getAtTileOffset(E,new o.P(ve,Fe),ue,gt),[pn,Nn,an]=Q.upVector(E.canonical,ve,Fe);Le=Kt*pn*ce,Me=Kt*Nn*ce,Ve=Kt*an*ce}let[nt,Et,mt,Lt]=la(Ce.projectedAnchorX+Le,Ce.projectedAnchorY+Me,Ce.projectedAnchorZ+Ve,u?ae:S);const ln=o_(x.getCameraToCenterDistance(Q),Lt);let ht=o.bL(m.textSizeData,O,Ce)*ln/o.bX;u&&(ht*=m.tilePixelRatio/R);const Qe=Vm($e,ht);u?({x:nt,y:Et,z:mt}=Q.projectTilePoint(ve+Qe.x,Fe+Qe.y,E.canonical),[nt,Et,mt]=la(nt+Le,Et+Me,mt+Ve,S)):(a&&Qe._rotate(-x.angle),nt+=Qe.x,Et+=Qe.y,mt=0);const kt=m.allowVerticalPlacement&&Ce.placedOrientation===o.bK.vertical?Math.PI/2:0;for(let gt=0;gt<Ie;gt++)o.bN(q,nt,Et,mt,kt);$&&Ce.associatedIconIndex>=0&&(X[Ce.associatedIconIndex]={x:nt,y:Et,z:mt,angle:kt})}else bc(Ie,q)}if($){H.clear();const pe=m.icon.placedSymbolArray;for(let Ce=0;Ce<pe.length;Ce++){const ve=pe.get(Ce),{numGlyphs:Fe}=ve,Ie=X[Ce];if(ve.hidden||!Ie)bc(Fe,H);else{const{x:$e,y:Le,z:Me,angle:Ve}=Ie;for(let st=0;st<Fe;st++)o.bN(H,$e,Le,Me,Ve)}}m.icon.dynamicLayoutVertexBuffer.updateData(H)}m.text.dynamicLayoutVertexBuffer.updateData(q)}function Yf(m,a,u,g,x,S,E={}){const R=u.paint.get("icon-translate"),O=u.paint.get("text-translate"),$=u.paint.get("icon-translate-anchor"),U=u.paint.get("text-translate-anchor"),q=u.layout.get("icon-rotation-alignment"),H=u.layout.get("text-rotation-alignment"),X=u.layout.get("icon-pitch-alignment"),Q=u.layout.get("text-pitch-alignment"),ae=u.layout.get("icon-keep-upright"),ue=u.layout.get("text-keep-upright"),ce=u.paint.get("icon-color-saturation"),pe=u.paint.get("icon-color-contrast"),Ce=u.paint.get("icon-color-brightness-min"),ve=u.paint.get("icon-color-brightness-max"),Fe=u.layout.get("symbol-elevation-reference")==="sea",Ie=u.layout.get("icon-image-use-theme")==="none",$e=m.context,Le=$e.gl,Me=m.transform,Ve=q==="map",st=H==="map",nt=X==="map",Et=Q==="map",mt=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Lt=!1;const ln=m.depthModeForSublayer(0,Hn.ReadOnly),ht=new Hn(m.context.gl.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D),Qe=[o.aF(Me.center.lng),o.aJ(Me.center.lat)],kt=u.layout.get("text-variable-anchor"),gt=Me.projection.name==="globe",Kt=[],pn=[0,-1,0];for(const Nn of g){const an=a.getTile(Nn),dn=an.getBucket(u);if(!dn||dn.projection.name==="mercator"&&gt||dn.fullyClipped)continue;const jn=dn.projection.name==="globe",Mn=jn?o.aj(Me.zoom):0,wn=cm(Nn,dn.getProjection(),Me),Rn=Me.calculatePixelsToTileUnitsMatrix(an),cr=kt&&dn.hasTextData(),Yr=dn.hasIconTextFit()&&cr&&dn.hasIconData(),ui=dn.getProjection().createInversionMatrix(Me,Nn.canonical),zi=(1<<an.tileID.canonical.z)*o.al/m.transform.worldSize,br=Pi=>{let Sr=[0,0,0];if(Pi){const fi=m.style.directionalLight,ao=m.style.ambientLight;fi&&ao&&(Sr=ml(m.style,fi,ao))}return Sr},ai=Pi=>{Me.depthOcclusionForSymbolsAndCircles&&(u.hasOcclusionOpacityProperties||m.terrain)&&(Pi.push("DEPTH_D24"),Pi.push("DEPTH_OCCLUSION"))},kr=Pi=>{u.lut&&!Ie&&(u.lut.texture||(u.lut.texture=new o.d_(m.context,u.lut.image,[u.lut.image.height,u.lut.image.height,u.lut.image.height],$e.gl.RGBA8)),$e.activeTexture.set($e.gl.TEXTURE0+Ma.LUT),u.lut.texture&&u.lut.texture.bind($e.gl.LINEAR,$e.gl.CLAMP_TO_EDGE),Pi.push("APPLY_LUT_ON_GPU"))},Oi=()=>{const Pi=Ve&&u.layout.get("symbol-placement")!=="point",Sr=[];ai(Sr),kr(Sr);const fi=Pi||Yr,ao=dn.elevationType==="road",Ro=m.shadowRenderer,mo=ao&&nt&&!!Ro&&Ro.enabled,So=br(mo),ys=ao&&nt&&!m.terrain?ht:ln,ls=u.paint.get("icon-image-cross-fade");m.terrainRenderModeElevated()&&nt&&Sr.push("PITCH_WITH_MAP_TERRAIN"),jn&&(Sr.push("PROJECTION_GLOBE_VIEW"),fi&&Sr.push("PROJECTED_POS_ON_VIEWPORT")),ls>0&&dn.hasAnySecondaryIcon&&Sr.push("ICON_TRANSITION"),!dn.icon.zOffsetVertexBuffer||ao&&m.terrain||Sr.push("Z_OFFSET"),ce===0&&pe===0&&Ce===0&&ve===1||Sr.push("COLOR_ADJUSTMENT"),dn.sdfIcons&&Sr.push("RENDER_SDF"),mo&&Sr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ao&&nt&&!m.terrain&&dn.icon.orientationVertexBuffer&&Sr.push("ELEVATED_ROADS");const ka=dn.icon.programConfigurations.get(u.id),Ha=m.getOrCreateProgram("symbol",{config:ka,defines:Sr}),Xs=an.imageAtlasTexture?an.imageAtlasTexture.size:[0,0],Fa=dn.iconSizeData,Zs=o.bJ(Fa,Me.zoom),bl=nt||!Me.isOrthographic,ba=jd(wn,an.tileID.canonical,nt,Ve,Me,dn.getProjection(),Rn),go=xc(wn,an.tileID.canonical,nt,Ve,Me,dn.getProjection(),Rn),Ao=m.translatePosMatrix(go,an,R,$,!0),$i=m.translatePosMatrix(wn,an,R,$),zo=fi?uu:ba,wa=Ve&&!nt&&!Pi;let vo=pn;!gt&&!Me.mercatorFromTransition||Ve||(vo=F_(Me));const Ys=jn?vo:pn,xh=u.getColorAdjustmentMatrix(ce,pe,Ce,ve),Ac=z_(Fa.kind,Zs,wa,nt,m,$i,zo,Ao,Fe,!1,Xs,[0,0],0,Nn,Mn,Qe,ui,Ys,dn.getProjection(),So,zi,xh,ls,null),bh=an.imageAtlasTexture?an.imageAtlasTexture:null,wh=u.layout.get("icon-size").constantOr(0)!==1||dn.iconsNeedLinear,Js=dn.sdfIcons||m.options.rotating||m.options.zooming||wh||bl?Le.LINEAR:Le.NEAREST,rc=dn.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,pa=m.terrain&&nt&&Pi?o.bk(o.bB(),ba):uu;if(Pi&&dn.icon){const Qs=o.bU.getAtTileOffsetFunc(Nn,Me.center.lat,Me.worldSize,dn.getProjection()),hd=Rf(wn,an.tileID.canonical,nt,Ve,Me,dn.getProjection(),Rn),u1=u.layout.get("icon-size-scale-range"),ug=o.aA(m.scaleFactor,u1[0],u1[1]);s_(dn,wn,m,!1,hd,go,nt,ae,Qs,Nn,ug)}return{program:Ha,buffers:dn.icon,uniformValues:Ac,atlasTexture:bh,atlasTextureIcon:null,atlasInterpolation:Js,atlasInterpolationIcon:null,isSDF:dn.sdfIcons,hasHalo:rc,depthMode:ys,tile:an,renderWithShadows:mo,labelPlaneMatrixInv:pa}},di=()=>{const Pi=st&&u.layout.get("symbol-placement")!=="point",Sr=[],fi=Pi||kt||Yr,ao=dn.elevationType==="road",Ro=m.shadowRenderer,mo=ao&&Et&&!!Ro&&Ro.enabled,So=br(mo),ys=ao&&Et&&!m.terrain?ht:ln;m.terrainRenderModeElevated()&&Et&&Sr.push("PITCH_WITH_MAP_TERRAIN"),jn&&(Sr.push("PROJECTION_GLOBE_VIEW"),fi&&Sr.push("PROJECTED_POS_ON_VIEWPORT")),!dn.text.zOffsetVertexBuffer||ao&&m.terrain||Sr.push("Z_OFFSET"),dn.iconsInText&&Sr.push("RENDER_TEXT_AND_SYMBOL"),Sr.push("RENDER_SDF"),mo&&Sr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ao&&Et&&!m.terrain&&dn.text.orientationVertexBuffer&&Sr.push("ELEVATED_ROADS"),ai(Sr);const ls=dn.text.programConfigurations.get(u.id),ka=m.getOrCreateProgram("symbol",{config:ls,defines:Sr});let Ha,Xs=[0,0],Fa=null;const Zs=dn.textSizeData;dn.iconsInText&&(Xs=an.imageAtlasTexture?an.imageAtlasTexture.size:[0,0],Fa=an.imageAtlasTexture?an.imageAtlasTexture:null,Ha=Et||!Me.isOrthographic||m.options.rotating||m.options.zooming||Zs.kind==="composite"||Zs.kind==="camera"?Le.LINEAR:Le.NEAREST);const bl=an.glyphAtlasTexture?an.glyphAtlasTexture.size:[0,0],ba=u.layout.get("text-size-scale-range"),go=o.aA(m.scaleFactor,ba[0],ba[1]),Ao=o.bJ(Zs,Me.zoom,go),$i=jd(wn,an.tileID.canonical,Et,st,Me,dn.getProjection(),Rn),zo=xc(wn,an.tileID.canonical,Et,st,Me,dn.getProjection(),Rn),wa=m.translatePosMatrix(zo,an,O,U,!0),vo=m.translatePosMatrix(wn,an,O,U),Ys=fi?uu:$i,xh=st&&!Et&&!Pi;let Ac=pn;!gt&&!Me.mercatorFromTransition||st||(Ac=F_(Me));const bh=z_(Zs.kind,Ao,xh,Et,m,vo,Ys,wa,Fe,!0,bl,Xs,0,Nn,Mn,Qe,ui,jn?Ac:pn,dn.getProjection(),So,zi,null,null,go),wh=an.glyphAtlasTexture?an.glyphAtlasTexture:null,Js=Le.LINEAR,rc=u.paint.get("text-halo-width").constantOr(1)!==0,pa=m.terrain&&Et&&Pi?o.bk(o.bB(),$i):uu;if(Pi&&dn.text){const Qs=o.bU.getAtTileOffsetFunc(Nn,Me.center.lat,Me.worldSize,dn.getProjection()),hd=Rf(wn,an.tileID.canonical,Et,st,Me,dn.getProjection(),Rn);s_(dn,wn,m,!0,hd,zo,Et,ue,Qs,Nn,go)}return{program:ka,buffers:dn.text,uniformValues:bh,atlasTexture:wh,atlasTextureIcon:Fa,atlasInterpolation:Js,atlasInterpolationIcon:Ha,isSDF:!0,hasHalo:rc,depthMode:ys,tile:an,renderWithShadows:mo,labelPlaneMatrixInv:pa}},Vi=dn.icon.segments.get().length,vi=dn.text.segments.get().length,Fr=Vi&&!E.onlyText?Oi():null,Ei=vi&&!E.onlyIcons?di():null,Ur=u.paint.get("icon-opacity").constantOr(1),Ki=u.paint.get("text-opacity").constantOr(1);if(mt&&dn.canOverlap){Lt=!0;const Pi=Ur&&!E.onlyText?dn.icon.segments.get():[],Sr=Ki&&!E.onlyIcons?dn.text.segments.get():[];for(const fi of Pi)Kt.push({segments:new o.bf([fi]),sortKey:fi.sortKey,state:Fr});for(const fi of Sr)Kt.push({segments:new o.bf([fi]),sortKey:fi.sortKey,state:Ei})}else E.onlyText||Kt.push({segments:Ur?dn.icon.segments:new o.bf([]),sortKey:0,state:Fr}),E.onlyIcons||Kt.push({segments:Ki?dn.text.segments:new o.bf([]),sortKey:0,state:Ei})}Lt&&Kt.sort((Nn,an)=>Nn.sortKey-an.sortKey);for(const Nn of Kt){const an=Nn.state;if(an)if(m.terrain?m.terrain.setupElevationDraw(an.tile,an.program,{useDepthForOcclusion:Me.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:an.labelPlaneMatrixInv}):m.setupDepthForOcclusion(Me.depthOcclusionForSymbolsAndCircles,an.program),$e.activeTexture.set(Le.TEXTURE0),an.atlasTexture&&an.atlasTexture.bind(an.atlasInterpolation,Le.CLAMP_TO_EDGE,!0),an.atlasTextureIcon&&($e.activeTexture.set(Le.TEXTURE1),an.atlasTextureIcon&&an.atlasTextureIcon.bind(an.atlasInterpolationIcon,Le.CLAMP_TO_EDGE,!0)),an.renderWithShadows&&m.shadowRenderer.setupShadows(an.tile.tileID.toUnwrapped(),an.program,"vector-tile"),m.uploadCommonLightUniforms(m.context,an.program),an.hasHalo){const dn=an.uniformValues;dn.u_is_halo=1,Hm(an.buffers,Nn.segments,u,m,an.program,an.depthMode,x,S,dn,2),dn.u_is_halo=0}else{if(an.isSDF){const dn=an.uniformValues;an.hasHalo&&(dn.u_is_halo=1,Hm(an.buffers,Nn.segments,u,m,an.program,an.depthMode,x,S,dn,1)),dn.u_is_halo=0}Hm(an.buffers,Nn.segments,u,m,an.program,an.depthMode,x,S,an.uniformValues,1)}}}function Hm(m,a,u,g,x,S,E,R,O,$){const U=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer,m.orientationVertexBuffer];x.draw(g,g.context.gl.TRIANGLES,S,E,R,xr.disabled,O,u.id,m.layoutVertexBuffer,m.indexBuffer,a,u.paint,g.transform.zoom,m.programConfigurations.get(u.id),U,$)}function jb(m,a){const u=1<<m.canonical.z,g=(a.x*u-m.canonical.x-m.wrap*u)*o.al,x=(a.y*u-m.canonical.y)*o.al,S=o.e7(a.z,a.y);return o.d4(g,x,S)}function ad(m,a,u,g,x){if(!u.layout||u.layout.get("fill-elevation-reference")==="none"||u.paint.get("fill-opacity").constantOr(1)===0)return;const S=m.context.gl,E=new Hn(m.context.gl.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D),R=new Hn(m.context.gl.GREATER,Hn.ReadWrite,m.depthRangeFor3D),O=function(X){let Q=.01;return X.isOrthographic&&(Q=o.ak(1e-4,Q,o.c$(X.pitch>=ed?1:X.pitch/ed))),2*Q}(m.transform),$=m.transform.getFreeCameraOptions().position,U="elevatedStructuresDepthReconstruct",q=m.getOrCreateProgram(U,{defines:["DEPTH_RECONSTRUCTION"]}),H=m.getOrCreateProgram(U);for(const X of g){const Q=a.getTile(X),ae=Q.getBucket(u);if(!ae)continue;const ue=ae.elevatedStructures;if(!ue)continue;const ce=ae.elevationBufferData.heightRange,pe=jb(X.toUnwrapped(),$),Ce=m.translatePosMatrix(X.projMatrix,Q,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let ve,Fe,Ie,$e;if(x==="initialize"){if(!ce||ce.min>=1||ue.depthSegments.segments[0].primitiveLength===0)continue;ve=Dm(Ce,pe,O,1,0),Fe=E,Ie=ue.depthSegments,$e=q}else if(x==="reset"){if(!ce||ce.min>=0||ue.maskSegments.segments[0].primitiveLength===0)continue;ve=Dm(Ce,pe,0,0,1),Fe=R,Ie=ue.maskSegments,$e=q}else if(x==="geometry"){if(ue.depthSegments.segments[0].primitiveLength===0)continue;ve=Dm(Ce,pe,O,1,0),Fe=E,Ie=ue.depthSegments,$e=H}$e.draw(m,S.TRIANGLES,Fe,Tr.disabled,jr.disabled,xr.disabled,ve,u.id,ue.vertexBuffer,ue.indexBuffer,Ie,u.paint,m.transform.zoom)}}function ah(m,a,u){const{painter:g,sourceCache:x,layer:S,coords:E,colorMode:R,elevationType:O,terrainEnabled:$,pass:U}=m,q=g.context.gl,H=S.paint.get("fill-pattern"),X=S.paint.get("fill-pattern-cross-fade"),Q=H.constantOr(null);let ae=O;O!=="road"||a&&!$||(ae="none");const ue=ae==="road",ce=m.painter.shadowRenderer,pe=ue&&!!ce&&ce.enabled,Ce=new Hn(g.context.gl.LEQUAL,Hn.ReadOnly,g.depthRangeFor3D);let ve=[0,0,0];if(pe){const $e=g.style.directionalLight,Le=g.style.ambientLight;$e&&Le&&(ve=ml(g.style,$e,Le))}const Fe=H&&H.constantOr(1),Ie=($e,Le)=>{let Me,Ve,st,nt,Et;Le?(Me=Fe&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",st=q.LINES):(Me=Fe?"fillPattern":"fill",st=q.TRIANGLES);for(const mt of E){const Lt=x.getTile(mt);if(Fe&&!Lt.patternsLoaded())continue;const ln=Lt.getBucket(S);if(!ln)continue;const ht=a?ln.elevationBufferData:ln.bufferData;if(ht.isEmpty())continue;g.prepareDrawTile();const Qe=ht.programConfigurations.get(S.id),kt=g.isTileAffectedByFog(mt),gt=[],Kt=[];ue&&(gt.push("ELEVATED_ROADS"),Kt.push(ht.elevatedLayoutVertexBuffer)),pe&&gt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Fe&&(g.context.activeTexture.set(q.TEXTURE0),Lt.imageAtlasTexture&&Lt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),Qe.updatePaintBuffers());let pn=!1;if(Q&&Lt.imageAtlas){const Mn=Lt.imageAtlas,wn=o.e2.from(Q),Rn=wn.getPrimary().scaleSelf(o.o.devicePixelRatio).toString(),cr=wn.getSecondary(),Yr=Mn.patternPositions.get(Rn),ui=cr?Mn.patternPositions.get(cr.scaleSelf(o.o.devicePixelRatio).toString()):null;pn=!!Yr&&!!ui,Yr&&Qe.setConstantPatternPositions(Yr,ui)}X>0&&(pn||Qe.getPatternTransitionVertexBuffer("fill-pattern"))&&gt.push("FILL_PATTERN_TRANSITION");const Nn=g.getOrCreateProgram(Me,{config:Qe,overrideFog:kt,defines:gt}),an=g.translatePosMatrix(mt.projMatrix,Lt,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));pe&&ce.setupShadows(Lt.tileID.toUnwrapped(),Nn,"vector-tile");const dn=S.paint.get("fill-emissive-strength");if(Le){nt=ht.lineIndexBuffer,Et=ht.lineSegments;const Mn=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[q.drawingBufferWidth,q.drawingBufferHeight];Ve=Me==="fillOutlinePattern"&&Fe?mT(an,dn,g,Lt,Mn,ve,X):pT(an,dn,Mn,ve)}else nt=ht.indexBuffer,Et=ht.triangleSegments,Ve=Fe?kb(an,dn,g,Lt,ve,X):zb(an,dn,ve);g.uploadCommonUniforms(g.context,Nn,mt.toUnwrapped());let jn=$e;(O==="road"&&!$||O==="offset")&&(jn=Ce),Nn.draw(g,st,jn,u||g.stencilModeForClipping(mt),R,xr.disabled,Ve,S.id,ht.layoutVertexBuffer,nt,Et,S.paint,g.transform.zoom,Qe,Kt)}};g.renderPass===U&&Ie(g.depthModeForSublayer(1,g.renderPass==="opaque"?Hn.ReadWrite:Hn.ReadOnly),!1),ae==="none"&&g.renderPass==="translucent"&&S.paint.get("fill-antialias")&&Ie(g.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Hn.ReadOnly),!0)}function Dn(m,a,u,g,x,S,E,R){u.resetLayerRenderingStats(m);const O=m.context,$=O.gl,U=m.transform,q=u.paint.get("fill-extrusion-pattern"),H=u.paint.get("fill-extrusion-pattern-cross-fade"),X=q.constantOr(null),Q=q.constantOr(1),ae=u.paint.get("fill-extrusion-opacity"),ue=m.style.enable3dLights(),ce=u.paint.get(ue&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),pe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ce],Ce=u.layout.get("fill-extrusion-edge-radius"),ve=Ce>0&&!u.paint.get("fill-extrusion-rounded-roof"),Fe=ve?0:Ce,Ie=U.projection.name==="globe"?o.ea():0,$e=U.projection.name==="globe",Le=$e?o.aj(U.zoom):0,Me=[o.aF(U.center.lng),o.aJ(U.center.lat)],Ve=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",st=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Ve?null:u.lut).toArray01().slice(0,3),nt=u.paint.get("fill-extrusion-flood-light-intensity"),Et=u.paint.get("fill-extrusion-vertical-scale"),mt=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Lt=u.paint.get("fill-extrusion-height-alignment"),ln=u.paint.get("fill-extrusion-base-alignment"),ht=Cc(m,u.paint.get("fill-extrusion-cutoff-fade-range")),Qe=[];let kt;$e&&Qe.push("PROJECTION_GLOBE_VIEW"),pe[0]>0&&Qe.push("FAUX_AO"),ve&&Qe.push("ZERO_ROOF_RADIUS"),R&&Qe.push("HAS_CENTROID"),nt>0&&Qe.push("FLOOD_LIGHT"),ht.shouldRenderCutoff&&Qe.push("RENDER_CUTOFF"),mt&&Qe.push("RENDER_WALL_MODE");const gt=m.renderPass==="shadow",Kt=m.shadowRenderer,pn=gt&&!!Kt,Nn=gt?xr.disabled:xr.backCCW;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let an=[0,0,0];if(Kt){const Mn=m.style.directionalLight,wn=m.style.ambientLight;Mn&&wn&&(an=ml(m.style,Mn,wn)),gt||(Qe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Kt.useNormalOffset&&Qe.push("NORMAL_OFFSET")),kt=Qe.concat(["SHADOWS_SINGLE_CASCADE"])}const dn=pn?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",jn=u.getLayerRenderingStats();for(const Mn of g){const wn=a.getTile(Mn),Rn=wn.getBucket(u);if(!Rn||Rn.projection.name!==U.projection.name)continue;let cr=!1;Kt&&(cr=Kt.getMaxCascadeForTile(Mn.toUnwrapped())===0);const Yr=m.isTileAffectedByFog(Mn),ui=Rn.programConfigurations.get(u.id);let zi=!1;if(X&&wn.imageAtlas){const vi=wn.imageAtlas,Fr=o.e2.from(X),Ei=Fr.getPrimary().scaleSelf(o.o.devicePixelRatio).toString(),Ur=Fr.getSecondary(),Ki=vi.patternPositions.get(Ei),Pi=Ur?vi.patternPositions.get(Ur.scaleSelf(o.o.devicePixelRatio).toString()):null;zi=!!Ki&&!!Pi,Ki&&ui.setConstantPatternPositions(Ki,Pi)}H>0&&(zi||ui.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Qe.push("FILL_EXTRUSION_PATTERN_TRANSITION");const br=m.getOrCreateProgram(dn,{config:ui,defines:cr?kt:Qe,overrideFog:Yr});if(m.terrain&&m.terrain.setupElevationDraw(wn,br,{useMeterToDem:!0}),!Rn.centroidVertexBuffer){const vi=br.getAttributeLocation($,"a_centroid_pos");vi!==-1&&$.vertexAttrib2f(vi,0,0)}!gt&&Kt&&Kt.setupShadows(wn.tileID.toUnwrapped(),br,"vector-tile"),Q&&(m.context.activeTexture.set($.TEXTURE0),wn.imageAtlasTexture&&wn.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ui.updatePaintBuffers());const ai=u.paint.get("fill-extrusion-vertical-gradient"),kr=1/Rn.tileToMeter;let Oi;if(gt&&Kt){if(Vb(wn.tileID,Rn.maxHeight,m))continue;const vi=Kt.calculateShadowPassMatrixFromTile(wn.tileID.toUnwrapped());Oi=Db(vi,Fe,kr,Et,Lt,ln)}else{const vi=m.translatePosMatrix(Mn.expandedProjMatrix,wn,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Fr=U.projection.createInversionMatrix(U,Mn.canonical);Oi=Q?Lb(vi,m,ai,ae,pe,Fe,kr,Mn,wn,Ie,Lt,ln,Le,Me,Fr,st,Et,H):Om(vi,m,ai,ae,pe,Fe,kr,Mn,Ie,Lt,ln,Le,Me,Fr,st,Et,nt,an)}m.uploadCommonUniforms(O,br,Mn.toUnwrapped(),null,ht);let di=Rn.segments;if(U.projection.name==="mercator"&&!gt&&(di=Rn.getVisibleSegments(wn.tileID,m.terrain,m.transform.getFrustum(0)),!di.get().length))continue;if(jn)if(gt)for(const vi of di.get())jn.numRenderedVerticesInShadowPass+=vi.primitiveLength;else for(const vi of di.get())jn.numRenderedVerticesInTransparentPass+=vi.primitiveLength;const Vi=[];(m.terrain||R)&&Vi.push(Rn.centroidVertexBuffer),$e&&Vi.push(Rn.layoutVertexExtBuffer),mt&&Vi.push(Rn.wallVertexBuffer),br.draw(m,O.gl.TRIANGLES,x,S,E,Nn,Oi,u.id,Rn.layoutVertexBuffer,Rn.indexBuffer,di,u.paint,m.transform.zoom,ui,Vi)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}class N_{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function Tc(m,a,u,g,x,S,E,R,O,$,U,q,H,X,Q,ae,ue,ce,pe,Ce){const ve=a.context,Fe=ve.gl,Ie=a.transform,$e=a.transform.zoom,Le=[],Me=m.translate,Ve=m.translateAnchor,st=m.edgeRadius,nt=Cc(a,m.cutoffFadeRange);U==="clear"?(Le.push("CLEAR_SUBPASS"),Ce&&(Le.push("CLEAR_FROM_TEXTURE"),ve.activeTexture.set(Fe.TEXTURE0),Ce.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE))):U==="sdf"&&Le.push("SDF_SUBPASS"),ce&&Le.push("HAS_CENTROID"),nt.shouldRenderCutoff&&Le.push("RENDER_CUTOFF");const Et=(mt,Lt,ln,ht,Qe)=>{let kt=Le;Lt.groundRadiusBuffer!=null&&(kt=Le.concat("HAS_ATTRIBUTE_a_flood_light_ground_radius"));const gt=Lt.programConfigurations.get(g.id),Kt=a.isTileAffectedByFog(mt),pn=a.getOrCreateProgram("fillExtrusionGroundEffect",{config:gt,defines:kt,overrideFog:Kt}),Nn=rh(a,ht,q,$,Qe,[H,X*Qe],Q,ae,ue,$e>=17?0:st*Qe,Ce?Ce.size[0]:0),an=[];ce&&an.push(Lt.hiddenByLandmarkVertexBuffer),Lt.groundRadiusBuffer!=null&&an.push(Lt.groundRadiusBuffer),a.uploadCommonUniforms(ve,pn,mt.toUnwrapped(),null,nt),pn.draw(a,ve.gl.TRIANGLES,S,E,R,O,Nn,g.id,Lt.vertexBuffer,Lt.indexBuffer,ln,g.paint,$e,gt,an)};for(const mt of x){const Lt=u.getTile(mt),ln=Lt.getBucket(g);if(!ln||ln.projection.name!==Ie.projection.name||!ln.groundEffect||ln.groundEffect&&!ln.groundEffect.hasData())continue;const ht=ln.groundEffect,Qe=1/ln.tileToMeter;{const kt=a.translatePosMatrix(mt.projMatrix,Lt,Me,Ve),gt=ht.getDefaultSegment();Et(mt,ht,gt,kt,Qe)}if(pe)for(let kt=0;kt<4;kt++){const gt=o.e8[kt](mt),Kt=u.getTile(gt);if(!Kt)continue;const pn=Kt.getBucket(g);if(!pn||pn.projection.name!==Ie.projection.name||!pn.groundEffect||pn.groundEffect&&!pn.groundEffect.hasData())continue;const Nn=pn.groundEffect;let an,dn;kt===0?(an=[-o.al,0,0],dn=1):kt===1?(an=[o.al,0,0],dn=0):kt===2?(an=[0,-o.al,0],dn=3):(an=[0,o.al,0],dn=2);const jn=Nn.regionSegments[dn];if(!jn)continue;const Mn=new Float32Array(16);o.bq(Mn,mt.projMatrix,an),Et(mt,Nn,jn,a.translatePosMatrix(Mn,Lt,Me,Ve),Qe)}}}function du(m,a,u,g,x,S,E){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const R=S?S.findDEMTileFor(u):null;if(!(R&&R.dem||E))return;S&&R&&R.dem&&g.selfDEMTileTimestamp!==R.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=R.dem._timestamp);const O=ce=>new o.P(Math.ceil((ce+o.ec)*o.ed),0),$=ce=>{const pe=a.getSource().minzoom,Ce=Fe=>{const Ie=a.getTileByID(Fe);if(Ie&&Ie.hasData())return Ie.getBucket(x)},ve=[0,-1,1];for(const Fe of ve){if(ce.overscaledZ+Fe<pe)continue;const Ie=Ce(ce.calculateScaledKey(ce.overscaledZ+Fe));if(Ie)return Ie}},U=[0,0,0],q=(ce,pe)=>(U[0]=Math.min(ce.min.y,pe.min.y),U[1]=Math.max(ce.max.y,pe.max.y),U[2]=o.al-pe.min.x>ce.max.x?pe.min.x-o.al:ce.max.x,U),H=(ce,pe)=>(U[0]=Math.min(ce.min.x,pe.min.x),U[1]=Math.max(ce.max.x,pe.max.x),U[2]=o.al-pe.min.y>ce.max.y?pe.min.y-o.al:ce.max.y,U),X=[(ce,pe)=>q(ce,pe),(ce,pe)=>q(pe,ce),(ce,pe)=>H(ce,pe),(ce,pe)=>H(pe,ce)],Q=(ce,pe,Ce,ve,Fe,Ie,$e)=>{if(!S)return 0;const Le=[[Ie?Ce:ce,Ie?ce:Ce,0],[Ie?Ce:pe,Ie?pe:Ce,0]],Me=$e<0?o.al+$e:$e,Ve=[Ie?Me:(ce+pe)/2,Ie?(ce+pe)/2:Me,0];return Ce===0&&$e<0||Ce!==0&&$e>0?S.getForTilePoints(Fe,[Ve],!0,ve):Le.push(Ve),S.getForTilePoints(u,Le,!0,R),Math.max(Le[0][2],Le[1][2],Ve[2])/S.exaggeration()};for(let ce=0;ce<4;ce++){const pe=g.borderFeatureIndices[ce];if(pe.length===0)continue;const Ce=o.e8[ce](u),ve=$(Ce);if(!(ve&&ve instanceof o.e9))continue;const Fe=S?S.findDEMTileFor(Ce):null;if(!(Fe&&Fe.dem||E)||(S&&Fe&&Fe.dem&&g.borderDEMTileTimestamp[ce]!==Fe.dem._timestamp&&(g.borderDoneWithNeighborZ[ce]=-1,g.borderDEMTileTimestamp[ce]=Fe.dem._timestamp),g.borderDoneWithNeighborZ[ce]===ve.canonical.z))continue;ve.centroidVertexArray.length===0&&ve.createCentroidsBuffer();const Ie=(ce<2?1:5)-ce,$e=ve.borderDoneWithNeighborZ[Ie]!==g.canonical.z,Le=ve.borderFeatureIndices[Ie];let Me=0;if(g.canonical.z!==ve.canonical.z){for(const Ve of pe)g.showCentroid(g.featuresOnBorder[Ve]);if($e)for(const Ve of Le)ve.showCentroid(ve.featuresOnBorder[Ve]);g.borderDoneWithNeighborZ[ce]=ve.canonical.z,ve.borderDoneWithNeighborZ[Ie]=g.canonical.z}for(const Ve of pe){const st=g.featuresOnBorder[Ve],nt=g.centroidData[st.centroidDataIndex],Et=st.borders[ce];let mt;for(;Me<Le.length;){mt=ve.featuresOnBorder[Le[Me]];const Lt=mt.borders[Ie];if(Lt[1]>Et[0]+3||Lt[0]>Et[0]-3)break;ve.showCentroid(mt),Me++}if(mt&&Me<Le.length){const Lt=Me;let ln=0;for(;!(mt.borders[Ie][0]>Et[1]-3)&&(ln++,++Me!==Le.length);)mt=ve.featuresOnBorder[Le[Me]];mt=ve.featuresOnBorder[Le[Lt]];let ht=!1;if(ln>=1){const gt=mt.borders[Ie];Math.abs(Et[0]-gt[0])<3&&Math.abs(Et[1]-gt[1])<3&&(ln=1,ht=!0,Me=Lt+1)}else if(ln===0){g.showCentroid(st);continue}const Qe=ve.centroidData[mt.centroidDataIndex];E&&ht&&(((ae=nt).flags|(ue=Qe).flags)&o.eb?(ae.flags|=o.eb,ue.flags|=o.eb):(ae.flags&=~o.eb,ue.flags&=~o.eb));const kt=st.intersectsCount()>1||mt.intersectsCount()>1;if(ln>1)Me=Lt,nt.centroidXY=Qe.centroidXY=new o.P(0,0);else if(Fe&&Fe.dem&&!kt){const gt=X[ce](nt,Qe),Kt=ce%2?o.al-1:0,pn=Q(gt[0],Math.min(o.al-1,gt[1]),Kt,Fe,Ce,ce<2,gt[2]);nt.centroidXY=Qe.centroidXY=O(pn)}else kt?nt.centroidXY=Qe.centroidXY=new o.P(0,0):(nt.centroidXY=g.encodeBorderCentroid(st),Qe.centroidXY=ve.encodeBorderCentroid(mt));g.writeCentroidToBuffer(nt),ve.writeCentroidToBuffer(Qe)}else g.showCentroid(st)}g.borderDoneWithNeighborZ[ce]=ve.canonical.z,ve.borderDoneWithNeighborZ[Ie]=g.canonical.z}var ae,ue;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}const hu=[1,0,0],lr=[0,1,0],B_=[0,0,1];function Vb(m,a,u){const g=u.transform,x=u.shadowRenderer;if(!x)return!0;const S=m.toUnwrapped(),E=g.tileSize*x._cascades[u.currentShadowCascade].scale;let R=a;if(g.elevation){const ae=g.elevation.getMinMaxForTile(m);ae&&(R+=ae.max)}const O=[...x.shadowDirection];O[2]=-O[2];const $=x.computeSimplifiedTileShadowVolume(S,R,E,O);if(!$)return!1;const U=[hu,lr,B_,O,[O[0],0,O[2]],[0,O[1],O[2]]],q=g.projection.name==="globe",H=g.scaleZoom(E),X=o.cA.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,H,!q),Q=x.getCurrentCascadeFrustum();return X.intersectsPrecise($.vertices,$.planes,U)===0||Q.intersectsPrecise($.vertices,$.planes,U)===0}function Gm(m){const{painter:a,source:u,layer:g,coords:x}=m;let S=m.defines;const E=a.context,R=a.renderPass==="shadow",O=a.renderPass==="light-beam",$=a.shadowRenderer,U=o.ee(a.transform.center.lat,a.transform.zoom),q=Cc(a,g.paint.get("building-cutoff-fade-range"));q.shouldRenderCutoff&&(S=S.concat("RENDER_CUTOFF")),m.floodLightIntensity>0&&(S=S.concat("FLOOD_LIGHT"));for(const H of x){const X=u.getTile(H),Q=X.getBucket(g);if(!Q)continue;$&&$.getMaxCascadeForTile(H.toUnwrapped())===0&&(S=S.concat("SHADOWS_SINGLE_CASCADE"));const ae=Q.programConfigurations.get(g.id);let ue,ce,pe,Ce=a.translatePosMatrix(H.expandedProjMatrix,X,[0,0],"map");if(Ce=o.cR(o.bB(),Ce,[1,1,m.verticalScale]),R&&$){if(Vb(X.tileID,Q.maxHeight*U,a))continue;let Fe=$.calculateShadowPassMatrixFromTile(X.tileID.toUnwrapped());Fe=o.cR(o.bB(),Fe,[1,1,m.verticalScale]),pe=Fb(Fe),ue=ce=a.getOrCreateProgram("buildingDepth",{config:ae,defines:S,overrideFog:!1})}else if(O)ue=ce=a.getOrCreateProgram("buildingBloom",{config:ae,defines:S,overrideFog:!1}),pe=A_(Ce);else{const Fe=a.transform.calculatePosMatrix(H.toUnwrapped(),a.transform.worldSize);o.cR(Fe,Fe,[1,1,m.verticalScale]);const Ie=o.bB();o.cR(Ie,Fe,[1,-1,1/U]),o.bk(Ie,Ie),o.ef(Ie,Ie);const $e=a.transform.getFreeCameraOptions().position,Le=1<<H.canonical.z;if(pe=R_(Ce,Ie,m.opacity,m.facadeAOIntensity,[(($e.x-H.wrap)*Le-H.canonical.x)*o.al,($e.y*Le-H.canonical.y)*o.al,$e.z*Le*o.al],Q.tileToMeter,m.facadeEmissiveChance,m.floodLightColor,m.floodLightIntensity),ce=a.getOrCreateProgram("building",{config:ae,defines:S,overrideFog:!1}),m.depthOnly===!0)ue=ce;else{const Me=S.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ue=a.getOrCreateProgram("building",{config:ae,defines:Me,overrideFog:!1})}$&&($.setupShadowsFromMatrix(Fe,ce,!0),ue!==ce&&$.setupShadowsFromMatrix(Fe,ue,!0))}const ve=(Fe,Ie)=>{if(O){const $e=Fe.entranceBloom;Ie.draw(a,E.gl.TRIANGLES,m.depthMode,Tr.disabled,m.blendMode,xr.disabled,pe,g.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segmentsBucket,g.paint,a.transform.zoom,ae,[$e.layoutAttenuationBuffer,$e.layoutColorBuffer])}else{const $e=Fe.segmentsBucket;let Le=[Fe.layoutNormalBuffer,Fe.layoutCentroidBuffer,Fe.layoutColorBuffer,Fe.layoutFloodLightDataBuffer];Fe.layoutFacadePaintBuffer&&(Le=Le.concat([Fe.layoutFacadeDataBuffer,Fe.layoutFacadeVerticalRangeBuffer,Fe.layoutFacadePaintBuffer])),Ie.draw(a,E.gl.TRIANGLES,m.depthMode,Tr.disabled,m.blendMode,R?xr.disabled:xr.backCW,pe,g.id,Fe.layoutVertexBuffer,Fe.indexBuffer,$e,g.paint,a.transform.zoom,ae,Le)}};a.uploadCommonUniforms(E,ce,H.toUnwrapped(),null,q),Q.buildingWithoutFacade&&ve(Q.buildingWithoutFacade,ce),Q.buildingWithFacade&&(ue!==ce&&a.uploadCommonUniforms(E,ue,H.toUnwrapped(),null,q),ve(Q.buildingWithFacade,ue))}}function Wm(m,a,u,g,x,S,E,R,O,$,U,q,H){const X=m.context.gl,Q=m.depthModeForSublayer(1,Hn.ReadOnly,X.LEQUAL,!0),ae=.1*(1-(ue=U))+3*ue;var ue;const ce=m._showOverdrawInspector,pe=q,Ce=new N_;ce||Tc(Ce,m,a,u,g,Q,new Tr({func:X.ALWAYS,mask:255},255,255,X.KEEP,X.KEEP,X.REPLACE),new jr([X.ONE,X.ONE,X.ONE,X.ONE],o.ao.transparent,[!1,!1,!1,!0],X.MIN),xr.disabled,x,"sdf",S,E,R,O,$,ae,pe,!1);{const ve=ce?Tr.disabled:new Tr({func:X.EQUAL,mask:255},255,255,X.KEEP,X.DECR,X.DECR),Fe=ce?m.colorModeForRenderPass():new jr([X.ONE_MINUS_DST_ALPHA,X.DST_ALPHA,X.ONE,X.ONE],o.ao.transparent,[!0,!0,!0,!0]);Tc(Ce,m,a,u,g,Q,ve,Fe,xr.disabled,x,"color",S,E,R,O,$,ae,pe,!1)}}function $_(m){return[m[0]*o.eg,m[1]*o.eg,m[2]*o.eg,0]}function j_(m,a,u,g,x,S,E,R,O){const $=g.getSource(),U=u.globeSharedBuffers;if(!U)return;let q,H,X;if(a&&(q=g.getTile(a)),$ instanceof o.aT?(H=$.texture,X=o.dJ(0,0,u.transform)):q&&a&&(H=q.texture,X=o.dJ(a.canonical.z,a.canonical.x,u.transform)),!H||!X)return;m||(X=o.cR(o.bB(),X,[1,-1,1]));const Q=u.context,ae=Q.gl,ue=x.paint.get("raster-resampling")==="nearest"?ae.NEAREST:ae.LINEAR,ce=u.colorModeForDrapableLayerRenderPass(S),pe=E.defines;pe.push("GLOBE_POLES");const Ce=new Hn(ae.LEQUAL,Hn.ReadWrite,u.depthRangeFor3D),ve=Float32Array.from(u.transform.expandedFarZProjMatrix),Fe=Float32Array.from(o.bj(o.dI(new o.cC(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),Q.activeTexture.set(ae.TEXTURE0),H.bind(ue,ae.CLAMP_TO_EDGE),Q.activeTexture.set(ae.TEXTURE1),H.bind(ue,ae.CLAMP_TO_EDGE),"useMipmap"in H&&Q.extTextureFilterAnisotropic&&u.transform.pitch>20&&ae.texParameterf(ae.TEXTURE_2D,Q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Q.extTextureFilterAnisotropicMax);const[Ie,$e,Le,Me]=a?U.getPoleBuffers(a.canonical.z,!1):U.getPoleBuffers(0,!0),Ve=x.paint.get("raster-elevation");let st;m?(st=Ie,u.renderDefaultNorthPole=Ve!==0):(st=$e,u.renderDefaultSouthPole=Ve!==0);const nt=$_(E.mix),Et=((Lt,ln,ht,Qe,kt,gt,Kt,pn,Nn,an,dn,jn,Mn)=>Xf(Lt,ln,ht,new Float32Array(16),new Float32Array(9),[0,0],Qe,[0,0],[0,0,0,0],1,{opacity:1,mix:0},gt,[0,0],pn,2,an,dn,jn,1,0,Mn))(ve,Fe,X,o.aj(u.transform.zoom),0,x,0,Ve,0,nt,E.offset,E.range,S),mt=u.getOrCreateProgram("raster",{defines:pe});u.uploadCommonUniforms(Q,mt,null),mt.draw(u,ae.TRIANGLES,Ce,O,ce,R,Et,x.id,st,Le,Me)}function Ub(m){const a=m._nearZ,u=m.projection.farthestPixelDistance(m),g=u-a,x=.2*m.height,S=a+x;return[a,u,(S-x-a)/g,(S-a)/g]}function yT(m,a,u,g){if(m)return a instanceof nr&&m instanceof sa?a.getTextureDescriptor(m,u,!0):{texture:m.texture,mix:$_(g.mix),offset:g.offset,buffer:0,tileSize:1}}var xT=o.eh([{name:"a_index",type:"Int16",components:1}]);class Es{constructor(a,u,g,x){const S={width:g[0],height:g[1],data:null},E=a.gl;this.targetColorTexture=new o.T(a,S,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(a,S,E.RGBA8,{useMipmap:!1}),this.context=a,this.updateParticleTexture(u,x),this.lastInvalidatedAt=0}updateParticleTexture(a,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,x=u.width*u.height;this.particleTexture0=new o.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const S=new o.ei;S.reserve(x);for(let E=0;E<x;E++)S.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(S,xT.members,!0),this.particleSegment=o.bf.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(a){return!(this.lastInvalidatedAt<a&&(this.lastInvalidatedAt=o.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function V_(m,a,u){if(!m)return null;const g=a.getTextureDescriptor(m,u,!0);if(!g)return null;let{texture:x,mix:S,offset:E,tileSize:R,buffer:O,format:$}=g;if(!x||!$)return null;let U=!1;return $==="uint32"&&(U=!0,S[3]=0,S=Lm(o.ej,S,[0,u.paint.get("raster-particle-max-speed")]),E=Ec(o.ej,E,[0,u.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[O/(R+2*O),R/(R+2*O)],tileSize:R,scalarData:U,scale:S,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[$]]}}function ss(m){const a=m._nearZ,u=m.projection.farthestPixelDistance(m),g=u-a,x=.2*m.height,S=a+x;return[a,u,(S-x-a)/g,(S-a)/g]}const fu=new o.ao(1,0,0,1),Hb=new o.ao(0,1,0,1),U_=new o.ao(0,0,1,1),H_=new o.ao(1,0,1,1),G_=new o.ao(0,1,1,1);function W_(m,a,u,g,x,S){for(let E=0;E<u.length;E++)if(x){const $=new o.ao(g.r*.8,g.g*.8,g.b*.8,1);Ts(m,a,u[E],g,-1,-1,S),Ts(m,a,u[E],g,-1,1,S),Ts(m,a,u[E],g,1,1,S),Ts(m,a,u[E],g,1,-1,S),Ts(m,a,u[E],$,0,0,S)}else Ts(m,a,u[E],g,0,0,S)}function Ts(m,a,u,g,x,S,E){const R=m.context,O=m.transform,$=R.gl,U=O.projection.name==="globe",q=U?["PROJECTION_GLOBE_VIEW"]:[];let H=o.by(u.projMatrix);if(U&&o.aj(O.zoom)>0){const nt=o.bi(u.canonical,O),Et=o.ek(nt);H=o.aB(new Float32Array(16),O.globeMatrix,Et),o.aB(H,O.projMatrix,H)}const X=o.bB();X[12]+=2*x/(o.o.devicePixelRatio*O.width),X[13]+=2*S/(o.o.devicePixelRatio*O.height),o.aB(H,X,H);const Q=m.getOrCreateProgram("debug",{defines:q}),ae=a.getTileByID(u.key);m.terrain&&m.terrain.setupElevationDraw(ae,Q);const ue=Hn.disabled,ce=Tr.disabled,pe=m.colorModeForRenderPass(),Ce="$debug";R.activeTexture.set($.TEXTURE0),m.emptyTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),U?ae._makeGlobeTileDebugBuffers(m.context,O):ae._makeDebugTileBoundsBuffers(m.context,O.projection);const ve=ae._tileDebugBuffer||m.debugBuffer,Fe=ae._tileDebugIndexBuffer||m.debugIndexBuffer,Ie=ae._tileDebugSegments||m.debugSegments;if(Q.draw(m,$.LINE_STRIP,ue,ce,pe,xr.disabled,O_(H,g.toPremultipliedRenderColor(null)),Ce,ve,Fe,Ie,null,null,null,[ae._globeTileDebugBorderBuffer]),E){const nt=ae.latestRawTileData,Et=Math.floor((nt&&nt.byteLength||0)/1024);let mt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(mt+=` => ${u.overscaledZ}`),mt+=` ${ae.state}`,mt+=` ${Et}kb`,function(Lt,ln){Lt.initDebugOverlayCanvas();const ht=Lt.debugOverlayCanvas,Qe=Lt.context.gl,kt=Lt.debugOverlayCanvas.getContext("2d");kt.clearRect(0,0,ht.width,ht.height),kt.shadowColor="white",kt.shadowBlur=2,kt.lineWidth=1.5,kt.strokeStyle="white",kt.textBaseline="top",kt.font="bold 36px Open Sans, sans-serif",kt.fillText(ln,5,5),kt.strokeText(ln,5,5),Lt.debugOverlayTexture.update(ht),Lt.debugOverlayTexture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)}(m,mt)}const $e=a.getTile(u).tileSize,Le=512/Math.min($e,512)*(u.overscaledZ/O.zoom)*.5,Me=ae._tileDebugTextBuffer||m.debugBuffer,Ve=ae._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,st=ae._tileDebugTextSegments||m.debugSegments;Q.draw(m,$.TRIANGLES,ue,ce,jr.alphaBlended,xr.disabled,O_(H,o.ao.transparent.toPremultipliedRenderColor(null),Le),Ce,Me,Ve,st,null,null,null,[ae._globeTileDebugTextBuffer])}function Wi(m,a,u,g){sh(m,0,a+u/2,m.transform.width,u,g)}function Jf(m,a,u,g){sh(m,a-u/2,0,u,m.transform.height,g)}function sh(m,a,u,g,x,S){const E=m.context,R=E.gl;R.enable(R.SCISSOR_TEST),R.scissor(a*o.o.devicePixelRatio,u*o.o.devicePixelRatio,g*o.o.devicePixelRatio,x*o.o.devicePixelRatio),E.clear({color:S}),R.disable(R.SCISSOR_TEST)}const Gb=o.eh([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Wb}=Gb;function Ic(m,a,u,g){m.emplaceBack(a,u,g)}class q_{constructor(a){this.vertexArray=new o.el,this.indices=new o.b0,Ic(this.vertexArray,-1,-1,1),Ic(this.vertexArray,1,-1,1),Ic(this.vertexArray,-1,1,1),Ic(this.vertexArray,1,1,1),Ic(this.vertexArray,-1,-1,-1),Ic(this.vertexArray,1,-1,-1),Ic(this.vertexArray,-1,1,-1),Ic(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Wb),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=o.bf.simpleSegment(0,0,36,12)}}function _l(m,a,u,g,x,S){const E=m.context.gl,R=a.paint.get("sky-atmosphere-color"),O=a.paint.get("sky-atmosphere-halo-color"),$=a.paint.get("sky-atmosphere-sun-intensity"),U=((q,H,X,Q,ae)=>({u_matrix_3f:q,u_sun_direction:H,u_sun_intensity:X,u_color_tint_r:[Q.r,Q.g,Q.b,Q.a],u_color_tint_m:[ae.r,ae.g,ae.b,ae.a],u_luminance:5e-5}))(o.en(o.dN(),g),x,$,R.toPremultipliedRenderColor(null),O.toPremultipliedRenderColor(null));E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+S,a.skyboxTexture,0),u.draw(m,E.TRIANGLES,Hn.disabled,Tr.disabled,jr.unblended,xr.frontCW,U,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const sd=o.eh([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class on{constructor(a){const u=new o.eo;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new o.b0;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(u,sd.members),this.indexBuffer=a.createIndexBuffer(g),this.segments=o.bf.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const bn=o.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class lh{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class wo{constructor(a){this.colorModeAlphaBlendedWriteRGB=new jr([1,Lo,1,Lo],o.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new jr([1,0,1,0],o.ao.transparent,[!1,!1,!1,!0]),this.params=new lh,this.updateNeeded=!0,a.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),a.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(a){const u=a.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new on(u);const g=this.params.sizeRange,x=this.params.intensityRange,S=function(U){const q=o.eq(30),H=[];for(let X=0;X<U;++X){const Q=2*Math.PI*q(),ae=Math.acos(1-2*q())-.5*Math.PI;H.push(o.d4(Math.cos(ae)*Math.cos(Q),Math.cos(ae)*Math.sin(Q),Math.sin(ae)))}return H}(this.params.starsCount),E=o.eq(300),R=new o.ep,O=new o.b0;let $=0;for(let U=0;U<S.length;++U){const q=o.c4([],S[U],200),H=Math.max(0,1+.01*g*(1*E()-.5)),X=Math.max(0,1+.01*x*(1*E()-.5));R.emplaceBack(q[0],q[1],q[2],-1,-1,H,X),R.emplaceBack(q[0],q[1],q[2],1,-1,H,X),R.emplaceBack(q[0],q[1],q[2],1,1,H,X),R.emplaceBack(q[0],q[1],q[2],-1,1,H,X),O.emplaceBack($+0,$+1,$+2),O.emplaceBack($+0,$+2,$+3),$+=4}this.starsVx=u.createVertexBuffer(R,bn.members),this.starsIdx=u.createIndexBuffer(O),this.starsSegments=o.bf.simpleSegment(0,0,R.length,O.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(a,u){const g=a.context,x=g.gl,S=a.transform,E=new Hn(x.LEQUAL,Hn.ReadOnly,[0,1]),R=o.aj(S.zoom),O=a.style.getLut(u.scope),$=u.properties.get("color-use-theme")==="none",U=u.properties.get("color").toNonPremultipliedRenderColor($?null:O),q=u.properties.get("high-color-use-theme")==="none",H=u.properties.get("high-color").toNonPremultipliedRenderColor(q?null:O),X=u.properties.get("space-color-use-theme")==="none",Q=u.properties.get("space-color").toNonPremultipliedRenderColor(X?null:O),ae=5e-4,ue=o.er(u.properties.get("horizon-blend"),0,1,ae,.25),ce=o.dD(a,g,S)&&ue===ae?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,pe=a.frameCounter/1e3%1,Ce=o.ag(S.globeCenterInViewSpace),ve=Math.sqrt(Math.pow(Ce,2)-Math.pow(ce,2)),Fe=Math.acos(ve/Ce),Ie=$e=>{const Le=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];$e&&Le.push("ALPHA_PASS");const Me=a.getOrCreateProgram("globeAtmosphere",{defines:Le}),Ve=((nt,Et,mt,Lt,ln,ht,Qe,kt,gt,Kt,pn,Nn)=>({u_frustum_tl:nt,u_frustum_tr:Et,u_frustum_br:mt,u_frustum_bl:Lt,u_horizon:ln,u_transition:ht,u_fadeout_range:Qe,u_atmosphere_fog_color:kt.toArray01(),u_high_color:gt.toArray01(),u_space_color:Kt.toArray01(),u_temporal_offset:pn,u_horizon_angle:Nn}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,R,ue,U,H,Q,pe,Fe);a.uploadCommonUniforms(g,Me);const st=this.atmosphereBuffer;st&&Me.draw(a,x.TRIANGLES,E,Tr.disabled,$e?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,xr.backCW,Ve,$e?"atmosphere_glow_alpha":"atmosphere_glow",st.vertexBuffer,st.indexBuffer,st.segments)};Ie(!1),Ie(!0)}drawStars(a,u){const g=o.aA(u.properties.get("star-intensity"),0,1);if(g===0)return;const x=a.context,S=x.gl,E=a.transform,R=a.getOrCreateProgram("stars"),O=o.c6([]);o.c8(O,O,-E._pitch),o.c7(O,O,-E.angle),o.c8(O,O,o.an(E._center.lat)),o.es(O,O,-o.an(E._center.lng));const $=o.cb(new Float32Array(16),O),U=o.aB([],E.starsProjMatrix,$),q=o.en([],$),H=o.et([],q),X=[0,1,0];o.dP(X,X,H),o.c4(X,X,this.params.sizeMultiplier);const Q=[1,0,0];o.dP(Q,Q,H),o.c4(Q,Q,this.params.sizeMultiplier);const ae=(ue=X,ce=Q,pe=g,{u_matrix:Float32Array.from(U),u_up:ue,u_right:ce,u_intensity_multiplier:pe});var ue,ce,pe;a.uploadCommonUniforms(x,R),this.starsVx&&this.starsIdx&&R.draw(a,S.TRIANGLES,Hn.disabled,Tr.disabled,this.colorModeAlphaBlendedWriteRGB,xr.disabled,ae,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class lt{constructor(){this.visibleTiles=[]}updateBorders(a,u){const g=[],x=[],S=a._getRenderableCoordinates(!1,!0);for(const O of S){const $=a.getTile(O);if(!$.hasData())continue;const U=$.getBucket(u);U&&(U.isEmpty()||(g.push(O.key),x.push({bucket:U,tileID:O.canonical})))}let E=g.length!==this.visibleTiles.length;if(!E){g.sort();for(let O=0;O<g.length;O++)if(g[O]!==this.visibleTiles[O]){E=!0;break}}if(!E)return;const R=new Set;this.visibleTiles=g,x.sort((O,$)=>O.tileID.z-$.tileID.z||O.tileID.x-$.tileID.x||O.tileID.y-$.tileID.y);for(const O of x){const $=new Array,U=new Array,q=O.bucket;for(const H of q.featuresOnBorder)R.has(H.featureId)?U.push(H.footprintIndex):(R.add(H.featureId),$.push(H.footprintIndex));q.updateFootprintHiddenFlags($,o.eu,!1),q.updateFootprintHiddenFlags(U,o.eu,!0)}}}function K_(m,a){const u=[...m],g=a.cameraWorldSizeForFog/a.worldSize,x=o.bz([]);return o.cR(x,x,[g,g,1]),o.aB(u,x,u),o.aB(u,a.worldToFogMatrix,u),u}function ch(m,a,u,g,x){const S=u.material,E=g.context,{baseColorTexture:R,metallicRoughnessTexture:O}=S.pbrMetallicRoughness,{normalTexture:$,occlusionTexture:U,emissionTexture:q}=S;function H(Q,ae,ue){if(Q&&(m.push(ae),E.activeTexture.set(E.gl.TEXTURE0+ue),Q.gfxTexture)){const{minFilter:ce,magFilter:pe,wrapS:Ce,wrapT:ve}=Q.sampler;Q.gfxTexture.bindExtraParam(ce,pe,Ce,ve)}}H(R,"HAS_TEXTURE_u_baseColorTexture",Ma.BaseColor),H(O,"HAS_TEXTURE_u_metallicRoughnessTexture",Ma.MetallicRoughness),H($,"HAS_TEXTURE_u_normalTexture",Ma.Normal),H(U,"HAS_TEXTURE_u_occlusionTexture",Ma.Occlusion),H(q,"HAS_TEXTURE_u_emissionTexture",Ma.Emission),x&&(x.texture||(x.texture=new o.d_(g.context,x.image,[x.image.height,x.image.height,x.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+Ma.LUT),x.texture&&x.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),a.push(u.texcoordBuffer)),u.colorBuffer&&(m.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),a.push(u.colorBuffer)),u.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),a.push(u.normalBuffer)),u.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),a.push(u.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||m.push("DIFFUSE_SHADED");const X=g.shadowRenderer;X&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),X.useNormalOffset&&m.push("NORMAL_OFFSET"))}function uh(m,a,u,g,x,S){const E=u.paint.get("model-opacity").constantOr(1),R=a.context,O=new Hn(a.context.gl.LEQUAL,m.isLightMesh?Hn.ReadOnly:Hn.ReadWrite,a.depthRangeFor3D),$=a.transform,U=m.mesh,q=U.material,H=q.pbrMetallicRoughness,X=a.style.fog;let Q;Q=a.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:o.aB([],g.zScaleMatrix,m.nodeModelMatrix),o.aB(Q,g.negCameraPosMatrix,Q);const ae=o.bk([],Q);o.ef(ae,ae);const ue=u.paint.get("model-color-use-theme").constantOr("default")==="none",ce=u.paint.get("model-emissive-strength").constantOr(0),pe=Bm(new Float32Array(m.worldViewProjection),new Float32Array(Q),new Float32Array(ae),null,a,E,H.baseColorFactor,q.emissiveFactor,H.metallicFactor,H.roughnessFactor,q,ce,u,void 0,void 0,m.materialOverride,m.modelColor),Ce={defines:[]},ve=[],Fe=a.shadowRenderer;Fe&&(Fe.useNormalOffset=!1),ch(Ce.defines,ve,U,a,ue?null:u.lut);let Ie=null;if(X){const Me=K_(m.nodeModelMatrix,a.transform);if(Ie=new Float32Array(Me),$.projection.name!=="globe"){const Ve=U.aabb.min,st=U.aabb.max,[nt,Et]=X.getOpacityForBounds(Me,Ve[0],Ve[1],st[0],st[1]);Ce.overrideFog=nt>=rt||Et>=rt}}const $e=Cc(a,u.paint.get("model-cutoff-fade-range"));$e.shouldRenderCutoff&&Ce.defines.push("RENDER_CUTOFF");const Le=a.getOrCreateProgram("model",Ce);a.uploadCommonUniforms(R,Le,null,Ie,$e),a.renderPass!=="shadow"&&Fe&&Fe.setupShadowsFromMatrix(m.nodeModelMatrix,Le),Le.draw(a,R.gl.TRIANGLES,O,x,S,U.material.doubleSided?xr.disabled:xr.backCCW,pe,u.id,U.vertexBuffer,U.indexBuffer,U.segments,u.paint,a.transform.zoom,void 0,ve)}function qm(m,a,u){return m.type==="vector"?a.scope:u?"basemap":""}function Km(m,a,u,g,x,S,E,R,O){const $=m.transform,U=!!a.isGeometryBloom&&a.isGeometryBloom;if(U&&m.renderPass==="shadow")return;const q=$.projection.name==="globe"?o.eC(u,$):[...u];o.aB(q,q,a.globalMatrix);const H=o.aB([],g,q);if(a.meshes)for(const X of a.meshes){const Q=R.get(X.material.name);if(Q&&Q.opacity<=0)continue;if(X.material.alphaMode!=="BLEND"){E.push({mesh:X,depth:0,modelIndex:x,worldViewProjection:H,nodeModelMatrix:q,isLightMesh:U,materialOverride:Q,modelColor:O});continue}const ae=o.af([],X.centroid,H);!$.isOrthographic&&ae[2]<=0||S.push({mesh:X,depth:ae[2],modelIndex:x,worldViewProjection:H,nodeModelMatrix:q,isLightMesh:U,materialOverride:Q,modelColor:O})}if(a.children)for(const X of a.children)Km(m,X,u,g,x,S,E,R,O)}function dh(m,a,u,g){const x=u.shadowRenderer;if(!x)return;const S=x.getShadowPassDepthMode(),E=x.getShadowPassColorMode(),R=x.calculateShadowPassMatrixFromMatrix(a),O=oh(R);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,S,Tr.disabled,E,xr.disabled,O,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,u.transform.zoom,void 0,void 0)}function hh(m,a,u,g,x,S){for(const E of x){const R=Object.assign({},g);R.part=E;const O={type:"Unknown",id:a,properties:R},$={orientation:m.paint.get("model-rotation").evaluate(O,u)};S.set(E,$)}}function bT(m,a,u,g,x,S){for(const E of x){const R=Object.assign({},g);R.part=E;const O={type:"Unknown",id:a,properties:R},$={color:m.paint.get("model-color").evaluate(O,u),colorMix:m.paint.get("model-color-mix-intensity").evaluate(O,u),opacity:m.paint.get("model-opacity").evaluate(O,u),emissionStrength:m.paint.get("model-emissive-strength").evaluate(O,u)};S.set(E,$)}}function qb(m,a,u,g,x,S){if(u===1)for(const R of x)uh(R,m,a,S[R.modelIndex],Tr.disabled,m.colorModeForRenderPass());else{for(const R of x)uh(R,m,a,S[R.modelIndex],Tr.disabled,jr.disabled);for(const R of x)uh(R,m,a,S[R.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}const E=jr.additive;for(const R of g)uh(R,m,a,S[R.modelIndex],Tr.disabled,R.isLightMesh?E:m.colorModeForRenderPass())}function Kb(m,a,u){const g=a.updateZoomBasedPaintProperties(),x=function(S,E,R){let O,$,U,q=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&q>0){const H=S.terrain,X=H.findDEMTileFor(R);X&&X.dem?O=o.eE.create(H,R,X):q=0}if(q===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),q===E.validForExaggeration&&(q===0||O&&O._demTile&&O._demTile.tileID===E.validForDEMTile.id&&O._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const H in E.instancesPerModel){const X=E.instancesPerModel[H];for(let Q=0;Q<X.instancedDataArray.length;++Q){const ae=(O?q*O.getElevationAt(0|X.instancedDataArray.float32[16*Q],0|X.instancedDataArray.float32[16*Q+1],!0,!0):0)+X.instancesEvaluatedElevation[Q];X.instancedDataArray.float32[16*Q+6]=ae,$=$?Math.min(E.terrainElevationMin,ae):ae,U=U?Math.max(E.terrainElevationMax,ae):ae}}return E.terrainElevationMin=$||0,E.terrainElevationMax=U||0,E.validForExaggeration=q,E.validForDEMTile=O&&O._demTile?{id:O._demTile.tileID,timestamp:O._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,a,u);(g||x)&&(a.uploaded=!1,a.upload(m.context))}const qs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.d8([0,0,0],[o.al,o.al,0])};function X_(m,a){const u=1<<m.canonical.z,g=a.getFreeCameraOptions().position,x=a.elevation,S=m.canonical.x/u,E=(m.canonical.x+1)/u,R=m.canonical.y/u,O=(m.canonical.y+1)/u;let $=a._centerAltitude;if(x){const X=x.getMinMaxForTile(m);X&&X.max>$&&($=X.max)}const U=o.aA(g.x,S,E)-g.x,q=o.aA(g.y,R,O)-g.y,H=o.ce($,a.center.lat)-g.z;return a._zoomFromMercatorZ(Math.sqrt(U*U+q*q+H*H))}function Z_(m,a,u,g,x,S,E){const R=m.context,O=m.renderPass==="shadow",$=m.shadowRenderer,U=O&&$?$.getShadowPassDepthMode():new Hn(R.gl.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D),q=m.isTileAffectedByFog(S),H=m.transform.projection.name==="globe";if(u.meshes)for(const X of u.meshes){const Q=H?[]:["MODEL_POSITION_ON_GPU"],ae=[];let ue,ce,pe;const Ce=!H&&g.instancedDataArray.length>20;Ce&&Q.push("INSTANCED_ARRAYS");const ve=Cc(m,a.paint.get("model-cutoff-fade-range"));if(ve.shouldRenderCutoff&&Q.push("RENDER_CUTOFF"),O&&$)ue=m.getOrCreateProgram("modelDepth",{defines:Q}),ce=oh(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(u.globalMatrix)),pe=$.getShadowPassColorMode();else{ch(Q,ae,X,m,a.paint.get("model-color-use-theme").constantOr("default")==="none"?null:a.lut),ue=m.getOrCreateProgram("model",{defines:Q,overrideFog:q});const Ie=X.material,$e=Ie.pbrMetallicRoughness,Le=a.paint.get("model-opacity").constantOr(1),Me=a.paint.get("model-emissive-strength").constantOr(0);ce=Bm(S.expandedProjMatrix,Float32Array.from(u.globalMatrix),new Float32Array(16),null,m,Le,$e.baseColorFactor,Ie.emissiveFactor,$e.metallicFactor,$e.roughnessFactor,Ie,Me,a,x),$&&(E.shadowUniformsInitialized?ue.setShadowUniformValues(R,$.getShadowUniformValues()):($.setupShadows(S.toUnwrapped(),ue,"model-tile"),E.shadowUniformsInitialized=!0)),pe=ve.shouldRenderCutoff||Le<1||Ie.alphaMode!=="OPAQUE"?jr.alphaBlended:jr.unblended}m.uploadCommonUniforms(R,ue,S.toUnwrapped(),null,ve);const Fe=X.material.doubleSided?xr.disabled:xr.backCCW;if(Ce)ae.push(g.instancedDataBuffer),ue.draw(m,R.gl.TRIANGLES,U,Tr.disabled,pe,Fe,ce,a.id,X.vertexBuffer,X.indexBuffer,X.segments,a.paint,m.transform.zoom,void 0,ae,g.instancedDataArray.length);else{const Ie=O?"u_instance":"u_normal_matrix";for(let $e=0;$e<g.instancedDataArray.length;++$e)ce[Ie]=new Float32Array(g.instancedDataArray.arrayBuffer,64*$e,16),ue.draw(m,R.gl.TRIANGLES,U,Tr.disabled,pe,Fe,ce,a.id,X.vertexBuffer,X.indexBuffer,X.segments,a.paint,m.transform.zoom,void 0,ae)}}if(u.children)for(const X of u.children)Z_(m,a,X,g,x,S,E)}const Xb=[1,-1,1];function Xm(m,a,u,g){if(!u.modelManager)return!0;const x=u.modelManager;if(!u.shadowRenderer)return!0;const S=u.shadowRenderer,E=a.aabb;let R=!0,O=m.maxHeight;if(O===0){let U=0;for(const q in m.instancesPerModel){const H=x.getModel(q,g);H?U=Math.max(U,Math.max(Math.max(H.aabb.max[0],H.aabb.max[1]),H.aabb.max[2])):R=!1}O=m.maxScale*U*1.41+m.maxVerticalOffset,R&&(m.maxHeight=O)}E.max[2]=O,E.min[2]+=m.terrainElevationMin,E.max[2]+=m.terrainElevationMax,o.af(E.min,E.min,a.tileMatrix),o.af(E.max,E.max,a.tileMatrix);const $=E.intersects(S.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=$===2),$===0}function Qf(m,a){const u=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],x=m.uniformValues.u_cutoff_params[2],S=m.uniformValues.u_cutoff_params[3];return g===u||S===x?1:o.aA(((a-u)/(g-u)-x)/(S-x),0,1)}function ld(m,a,u,g){if(a.pitch<20)return 1;const x=a.getWorldToCameraMatrix();o.aB(x,x,m);const S=o.bT(u.min[0],u.min[1],u.min[2],1);let E=o.aC(o.eF(),S,x),R=E,O=E;S[1]=u.max[1],E=o.aC(o.eF(),S,x),R=E[1]<R[1]?E:R,O=E[1]>O[1]?E:O,S[0]=u.max[0],E=o.aC(o.eF(),S,x),R=E[1]<R[1]?E:R,O=E[1]>O[1]?E:O,S[1]=u.min[1],E=o.aC(o.eF(),S,x),R=E[1]<R[1]?E:R,O=E[1]>O[1]?E:O;const $=o.aA(g[0],0,1),U=100*a.pixelsPerMeter*o.aA(g[1],0,1),q=o.aA(g[2],0,1),H=o.eG(o.eF(),R,O,$),X=Math.tan(.5*a.fovX),Q=-H[2]*X;if(U===0)return H[1]<-Math.abs(Q)?q:1;const ae=(-Math.abs(Q)-H[1])/U,ue=(pe,Ce,ve)=>(1-ve)*pe+ve*Ce,ce=o.aA(ue(1,q,ae),q,1);return ue(1,ce,o.aA((a.pitch-20)/20,0,1))}class Zb{}class Yb{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(a,u,g){{const q=this._storage.get(u.id);if(q)return q.lastUsedFrameIdx=a,q.buf}const x=g.gl,S=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),E=new ArrayBuffer(S),R=new Int16Array(E);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const O=new o.eI;for(let q=0;q<S/2;q+=3){const H=R[q],X=R[q+1],Q=R[q+2];O.emplaceBack(H,X),O.emplaceBack(X,Q),O.emplaceBack(Q,H)}const $=g.bindVertexArrayOES.current,U=new Zb;return U.buf=new cu(g,O),U.lastUsedFrameIdx=a,this._storage.set(u.id,U),g.bindVertexArrayOES.set($),U.buf}update(a){for(const[u,g]of this._storage)a-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[a,u]of this._storage)u.buf.destroy(),this._storage.delete(a)}}class wT{constructor(a){this.occluderSize=30,this.depthOffset=-1e-4,a.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),a.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Jb=o.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class ST{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class es{constructor(a,u){this.revealStart=11,this.revealRange=2,a.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),a.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const CT=o.eh([{type:"Float32",name:"a_pos_2f",components:2}]);class ep{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(a,u){const g=a.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new o.eJ,R=new o.b0;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),R.emplaceBack(0,1,2),R.emplaceBack(0,2,3),this.vignetteVx=a.context.createVertexBuffer(E,CT.members),this.vignetteIdx=a.context.createIndexBuffer(R)}const x=o.bf.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){a.uploadCommonUniforms(a.context,g);const E={u_vignetteShape:(S={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:S.vignetteColor};g.draw(a,a.context.gl.TRIANGLES,Hn.disabled,Tr.disabled,jr.alphaBlended,xr.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,x)}var S}}class Xi{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(a,u){const g=a.getFreeCameraOptions().position,x=g.toAltitude(),S=g.toLngLat(),E=o.an(S.lng),R=o.an(S.lat),O=a.pixelsPerMeter/u,$=E*o.eL,U=o.eL*Math.log(Math.tan(Math.PI/4+R/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const q=-this._offsetYPrev+U,H=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+$)*O,this._accumulatedOffsetY+=q*O,this._accumulatedElevation+=H*O,this._offsetXPrev=$,this._offsetYPrev=U,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Zr(m,a){return[-(m[0]-Math.floor(m[0]/a)*a),-(m[1]-Math.floor(m[1]/a)*a),-(m[2]-Math.floor(m[2]/a)*a)]}function Y_(m){const a=o.eq(1323123451230),u=[];for(let g=0;g<m;++g){const x=2*a()-1,S=2*a()-1,E=2*a()-1;u.push(o.d4(x,S,E))}return u}function vs(m,a,u,g,x){const S=o.aA((x-u)/(g-u),0,1);return(1-S)*m+S*a}class cd{constructor(a){this._movement=new Xi,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new ep,this._ppmScaleFactor=a}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(a,u){const g=a.transform;this._movement.update(g,this._ppmScaleFactor);const x=g.starsProjMatrix,S=o.c6([]);o.c8(S,S,o.an(90)-g._pitch),o.c7(S,S,-g.angle);const E=o.cb(new Float32Array(16),S),R=o.eK(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),O=o.ef([],R),$=o.aB([],O,E),U=Date.now()/1e3;return this._accumulatedTimeFromStart+=(U-this._prevTime)*u,this._prevTime=U,{projectionMatrix:x,modelviewMatrix:$}}}class fh extends cd{constructor(a){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new es(a.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(a){const u=a.context;if(!this.particlesVx){const g=Y_(this.particlesCount),x=new o.eM,S=new o.b0;let E=0;const R=o.eq(1323123451230);for(let O=0;O<g.length;++O){const $=g[O],U=[2*R()-1,R(),R(),R()];x.emplaceBack($[0],$[1],$[2],-1,-1,...U),x.emplaceBack($[0],$[1],$[2],1,-1,...U),x.emplaceBack($[0],$[1],$[2],1,1,...U),x.emplaceBack($[0],$[1],$[2],-1,1,...U),S.emplaceBack(E+0,E+1,E+2),S.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=u.createVertexBuffer(x,Jb.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=a.transform.zoom;if(u.revealStart>g)return;const x=vs(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const S=structuredClone(this._params);let E=[-S.direction.x,S.direction.y,-100];o.aw(E,E);const R=structuredClone(this._vignetteParams);R.strength*=x,S.overrideStyleParameters||(S.intensity=a.style.rain.state.density,S.timeFactor=a.style.rain.state.intensity,S.color=structuredClone(a.style.rain.state.color),E=structuredClone(a.style.rain.state.direction),S.screenThinning.intensity=a.style.rain.state.centerThinning,S.dropletSizeX=a.style.rain.state.dropletSize[0],S.dropletSizeYScale=a.style.rain.state.dropletSize[1]/a.style.rain.state.dropletSize[0],S.distortionStrength=100*a.style.rain.state.distortionStrength,R.strength=1,R.color=structuredClone(a.style.rain.state.vignetteColor));const O=this.updateOnRender(a,S.timeFactor),$=a.context,U=$.gl,q=a.transform;this.screenTexture&&this.screenTexture.size[0]===a.width&&this.screenTexture.size[1]===a.height||(this.screenTexture=new o.T($,{width:a.width,height:a.height,data:null},U.RGBA8)),S.distortionStrength>0&&($.activeTexture.set(U.TEXTURE0),this.screenTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),U.copyTexSubImage2D(U.TEXTURE_2D,0,0,0,0,0,a.width,a.height));const H=a.getOrCreateProgram("rainParticle");a.uploadCommonUniforms($,H),$.activeTexture.set(U.TEXTURE0),this.screenTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const X=[S.color.r,S.color.g,S.color.b,S.color.a],Q=(ae,ue)=>{const ce=Zr(this._movement.getPosition(),ae),pe=S.dropletSizeX,Ce=S.dropletSizeX*S.dropletSizeYScale,ve=a.width/2,Fe=a.height/2,Ie=vs(0,S.screenThinning.start,0,1,S.screenThinning.intensity),$e=vs(.001,S.screenThinning.range,0,1,S.screenThinning.intensity),Le=vs(0,S.screenThinning.particleOffset,0,1,S.screenThinning.intensity),Me=(Ve={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ce,velocityConeAperture:S.velocityConeAperture,velocity:S.velocity,boxSize:ae,rainDropletSize:[pe,Ce],distortionStrength:S.distortionStrength,rainDirection:E,color:X,screenSize:[q.width,q.height],thinningCenterPos:[ve,Fe],thinningShape:[Ie,$e,Math.pow(10,S.screenThinning.fadePower)],thinningAffectedRatio:S.screenThinning.affectedRatio,thinningParticleOffset:Le,shapeDirectionalPower:S.shapeDirPower,shapeNormalPower:S.shapeNormalPower,mode:ue?0:1},{u_modelview:Float32Array.from(Ve.modelview),u_projection:Float32Array.from(Ve.projection),u_time:Ve.time,u_cam_pos:Ve.camPos,u_texScreen:0,u_velocityConeAperture:Ve.velocityConeAperture,u_velocity:Ve.velocity,u_boxSize:Ve.boxSize,u_rainDropletSize:Ve.rainDropletSize,u_distortionStrength:Ve.distortionStrength,u_rainDirection:Ve.rainDirection,u_color:Ve.color,u_screenSize:Ve.screenSize,u_thinningCenterPos:Ve.thinningCenterPos,u_thinningShape:Ve.thinningShape,u_thinningAffectedRatio:Ve.thinningAffectedRatio,u_thinningParticleOffset:Ve.thinningParticleOffset,u_shapeDirectionalPower:Ve.shapeDirectionalPower,u_shapeNormalPower:Ve.shapeNormalPower,u_mode:Ve.mode});var Ve;const st=Math.round(S.intensity*this.particlesCount),nt=o.bf.simpleSegment(0,0,4*st,2*st);H.draw(a,U.TRIANGLES,Hn.disabled,Tr.disabled,jr.alphaBlended,xr.disabled,Me,"rain_particles",this.particlesVx,this.particlesIdx,nt)};S.distortionStrength>0&&Q(S.boxSize,!0),Q(S.boxSize,!1),this._vignette.draw(a,R)}}const Pc=o.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class J_ extends cd{constructor(a){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new es(a.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(a){const u=a.context;if(!this.particlesVx){const g=Y_(this.particlesCount),x=new o.eN,S=new o.b0;let E=0;const R=o.eq(1323123451230);for(let O=0;O<g.length;++O){const $=g[O],U=R(),q=R(),H=R(),X=[O/g.length,U,q,H],Q=[R(),R()];x.emplaceBack($[0],$[1],$[2],-1,-1,...X,...Q),x.emplaceBack($[0],$[1],$[2],1,-1,...X,...Q),x.emplaceBack($[0],$[1],$[2],1,1,...X,...Q),x.emplaceBack($[0],$[1],$[2],-1,1,...X,...Q),S.emplaceBack(E+0,E+1,E+2),S.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=u.createVertexBuffer(x,Pc.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(a){if(!this._params.overrideStyleParameters&&!a.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];o.aw(g,g);const x=structuredClone(this._vignetteParams),S=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=a.transform.zoom;if(S.revealStart>E)return;const R=vs(0,1,S.revealStart,S.revealStart+S.revealRange,E);x.strength*=R,u.overrideStyleParameters||(u.intensity=a.style.snow.state.density,u.timeFactor=a.style.snow.state.intensity,u.color=structuredClone(a.style.snow.state.color),g=structuredClone(a.style.snow.state.direction),u.screenThinning.intensity=a.style.snow.state.centerThinning,u.billboardSize=2.79*a.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(a.style.snow.state.vignetteColor));const O=this.updateOnRender(a,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const $=a.context,U=$.gl,q=a.transform,H=a.getOrCreateProgram("snowParticle");a.uploadCommonUniforms($,H),((X,Q,ae)=>{const ue=Zr(this._movement.getPosition(),X),ce=q.width/2,pe=q.height/2,Ce=vs(0,ae.screenThinning.start,0,1,ae.screenThinning.intensity),ve=vs(.001,ae.screenThinning.range,0,1,ae.screenThinning.intensity),Fe=vs(0,ae.screenThinning.particleOffset,0,1,ae.screenThinning.intensity),Ie=($e={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ue,velocityConeAperture:ae.velocityConeAperture,velocity:ae.velocity,horizontalOscillationRadius:ae.horizontalOscillationRadius,horizontalOscillationRate:ae.horizontalOscillationRate,boxSize:X,billboardSize:1*ae.billboardSize,simpleShapeParameters:[ae.shapeFadeStart,ae.shapeFadePower],screenSize:[q.width,q.height],thinningCenterPos:[ce,pe],thinningShape:[Ce,ve,Math.pow(10,ae.screenThinning.fadePower)],thinningAffectedRatio:ae.screenThinning.affectedRatio,thinningParticleOffset:Fe,color:[ae.color.r,ae.color.g,ae.color.b,ae.color.a],direction:g},{u_modelview:Float32Array.from($e.modelview),u_projection:Float32Array.from($e.projection),u_time:$e.time,u_cam_pos:$e.camPos,u_velocityConeAperture:$e.velocityConeAperture,u_velocity:$e.velocity,u_horizontalOscillationRadius:$e.horizontalOscillationRadius,u_horizontalOscillationRate:$e.horizontalOscillationRate,u_boxSize:$e.boxSize,u_billboardSize:$e.billboardSize,u_simpleShapeParameters:$e.simpleShapeParameters,u_screenSize:$e.screenSize,u_thinningCenterPos:$e.thinningCenterPos,u_thinningShape:$e.thinningShape,u_thinningAffectedRatio:$e.thinningAffectedRatio,u_thinningParticleOffset:$e.thinningParticleOffset,u_particleColor:$e.color,u_direction:$e.direction});var $e;const Le=Math.round(ae.intensity*this.particlesCount),Me=o.bf.simpleSegment(0,0,4*Le,2*Le);this.particlesVx&&this.particlesIdx&&H.draw(a,U.TRIANGLES,Hn.disabled,Tr.disabled,jr.alphaBlended,xr.disabled,Ie,"snow_particles",this.particlesVx,this.particlesIdx,Me)})(u.boxSize,0,u),this._vignette.draw(a,x)}}const Q_={symbol:function(m,a,u,g,x){if(m.renderPass!=="translucent")return;const S=Tr.disabled,E=m.colorModeForRenderPass(),R=u.layout.get("text-variable-anchor"),O=u.layout.get("text-size-scale-range"),$=o.aA(m.scaleFactor,O[0],O[1]);R&&function(H,X,Q,ae,ue,ce,pe,Ce){const ve=X.transform,Fe=ue==="map",Ie=ce==="map";for(const $e of H){const Le=ae.getTile($e),Me=Le.getBucket(Q);if(!Me||!Me.text||!Me.text.segments.get().length)continue;const Ve=o.bJ(Me.textSizeData,ve.zoom,Ce),st=cm($e,Me.getProjection(),ve),nt=ve.calculatePixelsToTileUnitsMatrix(Le),Et=jd(st,Le.tileID.canonical,Ie,Fe,ve,Me.getProjection(),nt),mt=Me.hasIconTextFit()&&Me.hasIconData();Ve&&Um(Me,Fe,Ie,pe,ve,Et,$e,Math.pow(2,ve.zoom-Le.tileID.overscaledZ),Ve,mt)}}(g,m,u,a,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x,$);const U=u.paint.get("icon-opacity").constantOr(1)!==0,q=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(U||q)?Yf(m,a,u,g,S,E):(U&&Yf(m,a,u,g,S,E,{onlyIcons:!0}),q&&Yf(m,a,u,g,S,E,{onlyText:!0})),a.map.showCollisionBoxes&&(Zf(m,a,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Zf(m,a,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(m,a,u,g){if(m.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),S=u.paint.get("circle-stroke-width"),E=u.paint.get("circle-stroke-opacity"),R=u.layout.get("circle-sort-key").constantOr(1)!==void 0,O=u.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(S.constantOr(1)===0||E.constantOr(1)===0))return;const $=m.context,U=$.gl,q=m.transform,H=!(!m.terrain||!m.terrain.enabled),X=u.layout.get("circle-elevation-reference"),Q=m.depthModeForSublayer(0,Hn.ReadOnly),ae=new Hn(m.context.gl.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D),ue=X==="none"||H?Q:ae,ce=Tr.disabled,pe=m.colorModeForDrapableLayerRenderPass(O),Ce=q.projection.name==="globe",ve=[o.aF(q.center.lng),o.aJ(q.center.lat)],Fe=[];for(let $e=0;$e<g.length;$e++){const Le=g[$e],Me=a.getTile(Le),Ve=Me.getBucket(u);if(!Ve||Ve.projection.name!==q.projection.name)continue;const st=Ve.programConfigurations.get(u.id),nt=Ve.layoutVertexBuffer,Et=Ve.globeExtVertexBuffer,mt=Ve.indexBuffer,Lt=o.d$(u),ln=[Et],ht=m.isTileAffectedByFog(Le);Ce&&Lt.push("PROJECTION_GLOBE_VIEW"),Lt.push("DEPTH_D24"),m.terrain&&q.depthOcclusionForSymbolsAndCircles&&Lt.push("DEPTH_OCCLUSION"),Ve.hasElevation&&!m.terrain&&(Lt.push("ELEVATED_ROADS"),ln.push(Ve.elevatedLayoutVertexBuffer));const Qe=m.getOrCreateProgram("circle",{config:st,defines:Lt,overrideFog:ht}),kt=q.projection.createInversionMatrix(q,Le.canonical),gt={programConfiguration:st,program:Qe,layoutVertexBuffer:nt,dynamicBuffers:ln,indexBuffer:mt,uniformValues:o.e0(m,Le,Me,kt,ve,u),tile:Me};if(R){const Kt=Ve.segments.get();for(const pn of Kt)Fe.push({segments:new o.bf([pn]),sortKey:pn.sortKey,state:gt})}else Fe.push({segments:Ve.segments,sortKey:0,state:gt})}R&&Fe.sort(($e,Le)=>$e.sortKey-Le.sortKey);const Ie={useDepthForOcclusion:q.depthOcclusionForSymbolsAndCircles};for(const $e of Fe){const{programConfiguration:Le,program:Me,layoutVertexBuffer:Ve,dynamicBuffers:st,indexBuffer:nt,uniformValues:Et,tile:mt}=$e.state,Lt=$e.segments;m.terrain&&m.terrain.setupElevationDraw(mt,Me,Ie),m.uploadCommonUniforms($,Me,mt.tileID.toUnwrapped()),Me.draw(m,U.TRIANGLES,ue,ce,pe,xr.disabled,Et,u.id,Ve,nt,Lt,u.paint,q.zoom,Le,st)}},heatmap:function(m,a,u,g){if(u.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const x=m.context,S=x.gl,E=Tr.disabled,R=new jr([S.ONE,S.ONE,S.ONE,S.ONE],o.ao.transparent,[!0,!0,!0,!0]);(function(X,Q,ae,ue){const ce=X.gl,pe=Q.width*ue,Ce=Q.height*ue;X.activeTexture.set(ce.TEXTURE1),X.viewport.set([0,0,pe,Ce]);let ve=ae.heatmapFbo;if(!ve||ve&&(ve.width!==pe||ve.height!==Ce)){ve&&ve.destroy();const Fe=ce.createTexture();ce.bindTexture(ce.TEXTURE_2D,Fe),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MAG_FILTER,ce.LINEAR),ve=ae.heatmapFbo=X.createFramebuffer(pe,Ce,!0,null),function(Ie,$e,Le,Me,Ve,st){const nt=Ie.gl;nt.texImage2D(nt.TEXTURE_2D,0,Ie.extRenderToTextureHalfFloat?nt.RGBA16F:nt.RGBA,Ve,st,0,nt.RGBA,Ie.extRenderToTextureHalfFloat?nt.HALF_FLOAT:nt.UNSIGNED_BYTE,null),Me.colorAttachment.set(Le)}(X,0,Fe,ve,pe,Ce)}else ce.bindTexture(ce.TEXTURE_2D,ve.colorAttachment.get()),X.bindFramebuffer.set(ve.framebuffer)})(x,m,u,m.transform.projection.name==="globe"?.5:.25),x.clear({color:o.ao.transparent});const O=m.transform,$=O.projection.name==="globe",U=$?["PROJECTION_GLOBE_VIEW"]:[],q=$?xr.frontCCW:xr.disabled,H=[o.aF(O.center.lng),o.aJ(O.center.lat)];for(let X=0;X<g.length;X++){const Q=g[X];if(a.hasRenderableParent(Q))continue;const ae=a.getTile(Q),ue=ae.getBucket(u);if(!ue||ue.projection.name!==O.projection.name)continue;const ce=m.isTileAffectedByFog(Q),pe=ue.programConfigurations.get(u.id),Ce=m.getOrCreateProgram("heatmap",{config:pe,defines:U,overrideFog:ce}),{zoom:ve}=m.transform;m.terrain&&m.terrain.setupElevationDraw(ae,Ce),m.uploadCommonUniforms(x,Ce,Q.toUnwrapped());const Fe=O.projection.createInversionMatrix(O,Q.canonical);Ce.draw(m,S.TRIANGLES,Hn.disabled,E,R,q,Bb(m,Q,ae,Fe,H,ve,u.paint.get("heatmap-intensity")),u.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,u.paint,m.transform.zoom,pe,$?[ue.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,S){const E=x.context,R=E.gl,O=S.heatmapFbo;if(!O)return;E.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,O.colorAttachment.get()),E.activeTexture.set(R.TEXTURE1);let $=S.colorRampTexture;$||($=S.colorRampTexture=new o.T(E,S.colorRamp,R.RGBA8)),$.bind(R.LINEAR,R.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,R.TRIANGLES,Hn.disabled,Tr.disabled,x.colorModeForRenderPass(),xr.disabled,((U,q,H,X)=>({u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}))(0,S),S.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,S.paint,x.transform.zoom)}(m,u))},line:function(m,a,u,g){if(m.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),S=u.paint.get("line-width");if(x.constantOr(1)===0||S.constantOr(1)===0)return;const E=u.paint.get("line-emissive-strength"),R=u.paint.get("line-occlusion-opacity"),O=u.layout.get("line-elevation-reference"),$=u.layout.get("line-width-unit")==="meters",U=O==="sea",q=!(!m.terrain||!m.terrain.enabled),H=m.context,X=H.gl;if(u.hasElevatedBuckets&&m.transform.projection.name==="globe")return;const Q=u.layout.get("line-cross-slope"),ae=Q!==void 0,ue=Q<1,ce=m.colorModeForDrapableLayerRenderPass(E),pe=m.terrain&&m.terrain.renderingToTexture,Ce=pe?1:o.o.devicePixelRatio,ve=u.paint.get("line-dasharray"),Fe=ve.constantOr(1),Ie=u.layout.get("line-cap"),$e=ve.constantOr(null),Le=Ie.constantOr(null),Me=u.paint.get("line-pattern"),Ve=Me.constantOr(1),st=u.paint.get("line-pattern-cross-fade"),nt=Me.constantOr(null),Et=u.paint.get("line-opacity").constantOr(1);let mt=!Ve&&Et!==1||m.depthOcclusion&&R>0&&R<1;const Lt=u.paint.get("line-gradient"),ln=Ve?"linePattern":"line",ht=o.e1(u);let Qe;if(pe&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(mt=!1),R!==0&&m.depthOcclusion){const pn=u.paint._values["line-opacity"];pn&&pn.value&&pn.value.kind==="constant"?Qe=pn.value:o.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}S.value.kind!=="constant"&&S.value.isLineProgressConstant===!1&&ht.push("VARIABLE_LINE_WIDTH");const kt=(pn,Nn,an,dn,jn,Mn)=>{for(const wn of pn){const Rn=a.getTile(wn);if(Ve&&!Rn.patternsLoaded())continue;const cr=Rn.getBucket(u);if(!cr||cr.elevationType!=="none"&&!jn||cr.elevationType==="none"&&jn)continue;m.prepareDrawTile();const Yr=[...Nn],ui=m.shadowRenderer,zi=cr.elevationType==="road"&&!!ui&&ui.enabled;let br=[0,0,0];if(zi){const Sr=m.style.directionalLight,fi=m.style.ambientLight;Sr&&fi&&(br=ml(m.style,Sr,fi)),Yr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const ai=cr.programConfigurations.get(u.id);let kr=!1;if(nt&&Rn.imageAtlas){const Sr=o.e2.from(nt),fi=Sr.getPrimary().scaleSelf(Ce).toString(),ao=Rn.imageAtlas.patternPositions.get(fi),Ro=Sr.getSecondary(),mo=Ro?Rn.imageAtlas.patternPositions.get(Ro.scaleSelf(Ce).toString()):null;kr=!!ao&&!!mo,ao&&ai.setConstantPatternPositions(ao,mo)}st>0&&(kr||ai.getPatternTransitionVertexBuffer("line-pattern"))&&Yr.push("LINE_PATTERN_TRANSITION");const Oi=m.isTileAffectedByFog(wn),di=m.getOrCreateProgram(ln,{config:ai,defines:Yr,overrideFog:Oi});if(!Ve&&$e&&Le&&Rn.lineAtlas){const Sr=Rn.lineAtlas.getDash($e,Le);Sr&&ai.setConstantPatternPositions(Sr)}zi&&ui.setupShadows(Rn.tileID.toUnwrapped(),di,"vector-tile");let[Vi,vi]=u.paint.get("line-trim-offset");(Le==="round"||Le==="square")&&Vi!==vi&&(Vi===0&&(Vi-=1),vi===1&&(vi+=1));const Fr=pe?wn.projMatrix:null,Ei=$?1/cr.tileToMeter/o.ay(Rn,1,m.transform.zoom):1,Ur=$?1/cr.tileToMeter/o.ay(Rn,1,Math.floor(m.transform.zoom)):1,Ki=Ve?o.e3(m,Rn,u,Fr,Ce,Ei,Ur,[Vi,vi],br,st):o.e4(m,Rn,u,Fr,cr.lineClipsArray.length,Ce,Ei,Ur,[Vi,vi],br);if(Lt){const Sr=cr.gradients[u.id];let fi=Sr.texture;if(u.gradientVersion!==Sr.version){let ao=256;if(u.stepInterpolant){const Ro=a.getSource().maxzoom,mo=wn.canonical.z===Ro?Math.ceil(1<<m.transform.maxZoom-wn.canonical.z):1;ao=o.aA(o.e5(cr.maxLineLength/o.al*1024*mo),256,H.maxTextureSize)}Sr.gradient=o.e6({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:ao,image:Sr.gradient||void 0,clips:cr.lineClipsArray}),Sr.texture?Sr.texture.update(Sr.gradient):Sr.texture=new o.T(H,Sr.gradient,X.RGBA8),Sr.version=u.gradientVersion,fi=Sr.texture}H.activeTexture.set(X.TEXTURE1),fi.bind(u.stepInterpolant?X.NEAREST:X.LINEAR,X.CLAMP_TO_EDGE)}Fe&&(H.activeTexture.set(X.TEXTURE0),Rn.lineAtlasTexture&&Rn.lineAtlasTexture.bind(X.LINEAR,X.REPEAT),ai.updatePaintBuffers()),Ve&&(H.activeTexture.set(X.TEXTURE0),Rn.imageAtlasTexture&&Rn.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),ai.updatePaintBuffers()),jn&&!U&&m.terrain.setupElevationDraw(Rn,di),m.uploadCommonUniforms(H,di,wn.toUnwrapped());const Pi=Sr=>{Qe!=null&&(Qe.value=Et*R),di.draw(m,X.TRIANGLES,an,Sr,ce,xr.disabled,Ki,u.id,cr.layoutVertexBuffer,cr.indexBuffer,cr.segments,u.paint,m.transform.zoom,ai,[cr.layoutVertexBuffer2,cr.patternVertexBuffer,cr.zOffsetVertexBuffer]),Qe!=null&&(Qe.value=Et)};if(mt&&!jn){const Sr=m.stencilModeForClipping(wn).ref;Sr===0&&pe&&H.clear({stencil:0});const fi={func:X.EQUAL,mask:255};Ki.u_alpha_discard_threshold=.8,Pi(new Tr(fi,Sr,255,X.KEEP,X.KEEP,X.INVERT)),Ki.u_alpha_discard_threshold=0,Pi(new Tr(fi,Sr,255,X.KEEP,X.KEEP,X.KEEP))}else Ki.u_alpha_discard_threshold=mt&&jn&&Mn?.8:0,Pi(jn?dn:m.stencilModeForClipping(wn))}};let gt=m.depthModeForSublayer(0,Hn.ReadOnly);const Kt=new Hn(m.depthOcclusion?X.GREATER:X.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D);if(u.hasNonElevatedBuckets){const pn=!pe&&m.terrain;R!==0&&pn?o.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):pn?o.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):kt(g,ht,gt,Tr.disabled,!1,!0)}if(u.hasElevatedBuckets){O==="hd-road-markup"?q||(gt=Kt,ht.push("ELEVATED_ROADS")):(ht.push("ELEVATED"),gt=Kt,ae&&ht.push(ue?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),U&&ht.push("ELEVATION_REFERENCE_SEA"));const pn=mt?m.stencilModeFor3D():Tr.disabled;m.forceTerrainMode=!0,kt(g,ht,gt,pn,!0,!0),mt&&kt(g,ht,gt,pn,!0,!1),m.forceTerrainMode=!1}mt&&(m.resetStencilClippingMasks(),pe&&H.clear({stencil:0})),R===0||m.depthOcclusion||pe||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,a,u,g){const x=u.paint.get("fill-color"),S=u.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const E=u.paint.get("fill-emissive-strength"),R=m.colorModeForDrapableLayerRenderPass(E),O=u.paint.get("fill-pattern"),$=m.opaquePassEnabledForLayer()&&!O.constantOr(1)&&x.constantOr(o.ao.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";let U="none";u.layout.get("fill-elevation-reference")!=="none"?U="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(U="offset");const q=!(!m.terrain||!m.terrain.enabled),H={painter:m,sourceCache:a,layer:u,coords:g,colorMode:R,elevationType:U,terrainEnabled:q,pass:$};if(m.renderPass!=="shadow")if(U!=="offset"){if(ah(H,!1),U==="road"){const X=!q&&m.renderPass==="translucent";X&&ad(m,a,u,g,"geometry"),ah(H,!0,Tr.disabled),X&&function(Q){const{painter:ae,sourceCache:ue,layer:ce,coords:pe,colorMode:Ce}=Q,ve=ae.context.gl,Fe=Q.painter.shadowRenderer,Ie=!!Fe&&Fe.enabled,$e=new Hn(ae.context.gl.LEQUAL,Hn.ReadOnly,ae.depthRangeFor3D);let Le=[0,0,0];if(Ie){const Ve=ae.style.directionalLight,st=ae.style.ambientLight;Ve&&st&&(Le=ml(ae.style,Ve,st))}const Me=Ve=>{for(const st of pe){const nt=ue.getTile(st),Et=nt.getBucket(ce);if(!Et)continue;const mt=Et.elevatedStructures;if(!mt)continue;let Lt,ln;if(Ve?(Lt=mt.renderableBridgeSegments,ln=mt.bridgeProgramConfigurations.get(ce.id)):(Lt=mt.renderableTunnelSegments,ln=mt.tunnelProgramConfigurations.get(ce.id)),!Lt||Lt.segments[0].primitiveLength===0)continue;ln.updatePaintBuffers(),ae.prepareDrawTile();const ht=ae.isTileAffectedByFog(st),Qe=[];Ie&&Qe.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const kt=ae.getOrCreateProgram("elevatedStructures",{config:ln,overrideFog:ht,defines:Qe}),gt=ae.translatePosMatrix(st.projMatrix,nt,ce.paint.get("fill-translate"),ce.paint.get("fill-translate-anchor"));Ie&&Fe.setupShadows(nt.tileID.toUnwrapped(),kt,"vector-tile");const Kt=gT(gt,Le);ae.uploadCommonUniforms(ae.context,kt,st.toUnwrapped()),kt.draw(ae,ve.TRIANGLES,$e,Tr.disabled,Ce,xr.backCCW,Kt,ce.id,mt.vertexBuffer,mt.indexBuffer,Lt,ce.paint,ae.transform.zoom,ln,[mt.vertexBufferNormal])}};Me(!0),Me(!1)}(H)}}else ah(H,!1,m.stencilModeFor3D());else m.shadowRenderer&&U==="road"&&!q&&function(X){const{painter:Q,sourceCache:ae,layer:ue,coords:ce}=X,pe=Q.context.gl,Ce=X.painter.shadowRenderer;for(const ve of ce){const Fe=ae.getTile(ve),Ie=Fe.getBucket(ue);if(!Ie)continue;const $e=Ie.elevatedStructures;if(!$e||!$e.shadowCasterSegments||$e.shadowCasterSegments.segments[0].primitiveLength===0)continue;Q.prepareDrawTile();const Le=Ie.bufferData.programConfigurations.get(ue.id),Me=Q.isTileAffectedByFog(ve),Ve=Q.getOrCreateProgram("elevatedStructuresDepth",{config:Le,overrideFog:Me}),st=Ce.calculateShadowPassMatrixFromTile(Fe.tileID.toUnwrapped());Q.uploadCommonUniforms(Q.context,Ve,ve.toUnwrapped());const nt={u_matrix:st,u_depth_bias:0};Ve.draw(Q,pe.TRIANGLES,Ce.getShadowPassDepthMode(),Tr.disabled,Ce.getShadowPassColorMode(),xr.disabled,nt,ue.id,$e.vertexBuffer,$e.indexBuffer,$e.shadowCasterSegments,ue.paint,Q.transform.zoom,Le)}}(H)},"fill-extrusion":function(m,a,u,g){const x=u.paint.get("fill-extrusion-opacity"),S=m.context,E=S.gl,R=m.terrain,O=R&&R.renderingToTexture;if(x===0)return;const $=m.conflationActive&&m.style.isLayerClipped(u,a.getSource()),U=m.style.order.indexOf(u.fqid);if($&&function(q,H,X,Q,ae){for(const ue of Q){const ce=H.getTile(ue).getBucket(X);ce&&(ce.updateReplacement(ue,q.replacementSource,ae),ce.uploadCentroid(q.context))}}(m,a,u,g,U),R||$)for(const q of g){const H=a.getTile(q).getBucket(u);H&&du(m.context,a,q,H,u,R,$)}if(m.renderPass==="shadow"&&m.shadowRenderer){const q=m.shadowRenderer;if(R&&x<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.ad)return;const H=q.getShadowPassDepthMode(),X=q.getShadowPassColorMode();Dn(m,a,u,g,H,Tr.disabled,X,$)}else if(m.renderPass==="translucent"){const q=!u.paint.get("fill-extrusion-pattern").constantOr(1),H=u.paint.get("fill-extrusion-color").constantOr(o.ao.white);if(!O&&H.a!==0){const X=new Hn(m.context.gl.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D);x===1&&q?Dn(m,a,u,g,X,Tr.disabled,jr.unblended,$):(Dn(m,a,u,g,X,Tr.disabled,jr.disabled,$),Dn(m,a,u,g,X,m.stencilModeFor3D(),m.colorModeForRenderPass(),$),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&q&&(!R&&m.transform.projection.name!=="globe"||O)){const X=u.paint.get("fill-extrusion-opacity"),Q=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ue=u.paint.get("fill-extrusion-flood-light-intensity"),ce=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",pe=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ce?null:u.lut).toArray01().slice(0,3),Ce=Q>0&&ae>0,ve=ue>0,Fe=(Le,Me,Ve)=>(1-Ve)*Le+Ve*Me,Ie=new N_;Ie.translate=u.paint.get("fill-extrusion-translate"),Ie.translateAnchor=u.paint.get("fill-extrusion-translate-anchor"),Ie.edgeRadius=u.layout.get("fill-extrusion-edge-radius"),Ie.cutoffFadeRange=u.paint.get("fill-extrusion-cutoff-fade-range");const $e=Le=>{const Me=m.depthModeForSublayer(1,Hn.ReadOnly,E.LEQUAL,!0),Ve=u.paint.get(Le?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),st=Fe(.1,3,Ve),nt=m._showOverdrawInspector;if(!nt){const Et=new Tr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),mt=new jr([E.ONE,E.ONE,E.ONE,E.ONE],o.ao.transparent,[!1,!1,!1,!0],E.MIN);Tc(Ie,m,a,u,g,Me,Et,mt,xr.disabled,Le,"sdf",X,Q,ae,ue,pe,st,$,!1)}{const Et=nt?Tr.disabled:new Tr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),mt=nt?m.colorModeForRenderPass():new jr([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],o.ao.transparent,[!0,!0,!0,!0]);Tc(Ie,m,a,u,g,Me,Et,mt,xr.disabled,Le,"color",X,Q,ae,ue,pe,st,$,!1)}};if(O){const Le=(Me,Ve,st)=>{const nt=m.depthModeForSublayer(1,Hn.ReadOnly,E.LEQUAL,!1),Et=u.paint.get(Me?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),mt=Fe(.1,3,Et);{const Lt=new jr([E.ONE,E.ONE,E.ONE,E.ONE],o.ao.transparent,[!1,!1,!1,!0]);Tc(Ie,m,a,u,g,nt,Tr.disabled,Lt,xr.disabled,Me,"clear",X,Q,ae,ue,pe,mt,$,Ve)}{const Lt=new Tr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),ln=new jr([E.ONE,E.ONE,E.ONE,E.ONE],o.ao.transparent,[!1,!1,!1,!0],E.MIN);Tc(Ie,m,a,u,g,nt,Lt,ln,xr.disabled,Me,"sdf",X,Q,ae,ue,pe,mt,$,Ve)}{const Lt=Me?E.ZERO:E.ONE_MINUS_DST_ALPHA,ln=new Tr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),ht=new jr([Lt,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],o.ao.transparent,[!0,!0,!0,!0]);Tc(Ie,m,a,u,g,nt,ln,ht,xr.disabled,Me,"color",X,Q,ae,ue,pe,mt,$,Ve)}{const Lt=new jr([E.ONE,E.ONE,E.ONE,Me?E.ZERO:E.ONE],o.ao.transparent,[!1,!1,!1,!0],Me?E.FUNC_ADD:E.MAX);Tc(Ie,m,a,u,g,nt,Tr.disabled,Lt,xr.disabled,Me,"clear",X,Q,ae,ue,pe,mt,$,Ve,st)}};if(Ce||ve){let Me;if(m.prepareDrawTile(),R){const Ve=R.drapeBufferSize[0],st=R.drapeBufferSize[1];Me=R.framebufferCopyTexture,Me&&(!Me||Me.size[0]===Ve&&Me.size[1]===st)||(Me&&Me.destroy(),Me=R.framebufferCopyTexture=new o.T(S,new o.q({width:Ve,height:st}),E.RGBA8)),Me.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,Ve,st)}Ce&&Le(!0,!1,Me),ve&&Le(!1,!0,Me)}}else Ce&&$e(!0),ve&&$e(!1),(Ce||ve)&&m.resetStencilClippingMasks()}}},building:function(m,a,u,g){m.currentLayer<m.firstLightBeamLayer&&(m.firstLightBeamLayer=m.currentLayer);const x=u.paint.get("building-ambient-occlusion-ground-intensity"),S=u.paint.get("building-ambient-occlusion-ground-radius"),E=u.paint.get("building-ambient-occlusion-ground-attenuation"),R=u.paint.get("building-opacity");if(R<=0)return;let O=x>0&&S>0,$=!0;const U=u.paint.get("building-vertical-scale");if(U<=0)return;(!m.shadowRenderer||U<1)&&($=!1);const q=m.conflationActive&&m.style.isLayerClipped(u,a.getSource()),H=m.style.order.indexOf(u.fqid);if(function(X,Q,ae,ue,ce,pe){for(const Ce of pe){const ve=Q.getTile(Ce).getBucket(ae);ve&&(ce&&ve.updateReplacement(Ce,X.replacementSource,ue),ve.uploadUpdatedIndexBuffer(X.context))}}(m,a,u,H,q,g),function(X,Q,ae,ue){for(const ce of ue){const pe=Q.getTile(ce).getBucket(ae);pe&&pe.needsEvaluation()&&pe.uploadUpdatedColorBuffer(X.context)}}(m,a,u,g),u.resetLayerRenderingStats(m),m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0),m.renderPass==="shadow"&&m.shadowRenderer){const X=m.shadowRenderer,Q=[],ae=X.getShadowPassDepthMode();Gm({painter:m,source:a,layer:u,coords:g,defines:Q,blendMode:X.getShadowPassColorMode(),depthMode:ae,opacity:R,verticalScale:U,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}else if(m.renderPass==="translucent"){let X=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];$&&(X=X.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),m.shadowRenderer&&m.shadowRenderer.useNormalOffset&&(X=X.concat("NORMAL_OFFSET"));const Q=u.paint.get("building-facade-emissive-chance"),ae=u.paint.get("building-ambient-occlusion-intensity"),ue=u.paint.get("building-flood-light-intensity"),ce=u.paint.get("building-flood-light-color-use-theme").constantOr("default")==="none",pe=u.paint.get("building-flood-light-color").toNonPremultipliedRenderColor(ce?null:u.lut).toArray01().slice(0,3),Ce=u.paint.get("building-flood-light-ground-attenuation"),ve=ue>0,Fe=new Hn(m.context.gl.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D);R<1&&Gm({painter:m,source:a,layer:u,coords:g,defines:X,blendMode:jr.disabled,depthMode:Fe,opacity:R,verticalScale:U,facadeEmissiveChance:Q,facadeAOIntensity:ae,floodLightIntensity:ue,floodLightColor:pe,depthOnly:!0});const Ie=m.colorModeForRenderPass();Gm({painter:m,source:a,layer:u,coords:g,defines:X,blendMode:Ie,depthMode:Fe,opacity:R,verticalScale:U,facadeEmissiveChance:Q,facadeAOIntensity:ae,floodLightIntensity:ue,floodLightColor:pe}),O&&Wm(m,a,u,g,!0,R,x,S,ue,pe,E,q),ve&&Wm(m,a,u,g,!1,R,x,S,ue,pe,Ce,q)}else if(m.renderPass==="light-beam"){const X=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],Q=new Hn(m.context.gl.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D);Gm({painter:m,source:a,layer:u,coords:g,defines:X,blendMode:jr.alphaBlended,depthMode:Q,opacity:R,verticalScale:U,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1),m.resetStencilClippingMasks()},hillshade:function(m,a,u,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const x=m.context,S=m.terrain&&m.terrain.renderingToTexture,[E,R]=m.renderPass!=="translucent"||S?[{},g]:m.stencilConfigForOverlap(g);for(const O of R){const $=a.getTile(O);if($.needsHillshadePrepare&&m.renderPass==="offscreen")oT(m,$,u);else if(m.renderPass==="translucent"){const U=m.depthModeForSublayer(0,Hn.ReadOnly),q=u.paint.get("hillshade-emissive-strength"),H=m.colorModeForDrapableLayerRenderPass(q),X=S&&m.terrain?m.terrain.stencilModeForRTTOverlap(O):E[O.overscaledZ];iT(m,O,$,u,U,X,H)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,a,u,g,x,S){if(m.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const E=m.transform.projection.name==="globe",R=u.paint.get("raster-elevation")!==0,O=R&&E;if(m.renderElevatedRasterBackface&&!O)return;const $=m.context,U=$.gl,q=a.getSource(),H=function(Ie,$e,Le,Me){const Ve=$e.paint.get("raster-color"),st=Ie.type==="raster-array",nt=[],Et=$e.paint.get("raster-resampling"),mt=$e.paint.get("raster-color-mix");let Lt=$e.paint.get("raster-color-range");const ln=[mt[0],mt[1],mt[2],0],ht=mt[3];let Qe=Et==="nearest"?Me.NEAREST:Me.LINEAR;if(st&&(nt.push("RASTER_ARRAY"),Ve||nt.push("RASTER_COLOR"),Et==="linear"&&nt.push("RASTER_ARRAY_LINEAR"),Qe=Me.NEAREST,!Lt&&Ie.rasterLayers)){const kt=Ie.rasterLayers.find(({id:gt})=>gt===$e.sourceLayer);kt&&kt.fields&&kt.fields.range&&(Lt=kt.fields.range)}if(Lt=Lt||[0,1],Ve){nt.push("RASTER_COLOR"),Le.activeTexture.set(Me.TEXTURE2),$e.updateColorRamp(Lt);let kt=$e.colorRampTexture;kt||(kt=$e.colorRampTexture=new o.T(Le,$e.colorRamp,Me.RGBA8)),kt.bind(Me.LINEAR,Me.CLAMP_TO_EDGE)}return{mix:ln,range:Lt,offset:ht,defines:nt,resampling:Qe}}(q,u,$,U);if(q instanceof o.aT&&!g.length&&!E)return;const X=u.paint.get("raster-emissive-strength"),Q=m.colorModeForDrapableLayerRenderPass(X),ae=m.terrain&&m.terrain.renderingToTexture,ue=!m.options.moving,ce=u.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;if(q instanceof o.aT&&!g.length&&(q.onNorthPole||q.onSouthPole)){const Ie=R?m.stencilModeFor3D():Tr.disabled;return void j_(!!q.onNorthPole,null,m,a,u,X,H,xr.disabled,Ie)}if(!g.length)return;const[pe,Ce]=q instanceof o.aT||ae?[{},g]:m.stencilConfigForOverlap(g),ve=Ce[Ce.length-1].overscaledZ;O&&H.defines.push("PROJECTION_GLOBE_VIEW"),R&&H.defines.push("RENDER_CUTOFF");const Fe=(Ie,$e,Le)=>{for(const Me of Ie){const Ve=Me.toUnwrapped(),st=a.getTile(Me);if(ae&&(!st||!st.hasData()))continue;$.activeTexture.set(U.TEXTURE0);const nt=yT(st,q,u,H);if(!nt||!nt.texture)continue;const{texture:Et,mix:mt,offset:Lt,tileSize:ln,buffer:ht}=nt;let Qe,kt;ae?(Qe=Hn.disabled,kt=Me.projMatrix):R?(Qe=new Hn(U.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D),kt=E?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(Ve,ue)):(Qe=m.depthModeForSublayer(Me.overscaledZ-ve,u.paint.get("raster-opacity")===1?Hn.ReadWrite:Hn.ReadOnly,U.LESS),kt=m.transform.calculateProjMatrix(Ve,ue));const gt=m.terrain&&ae?m.terrain.stencilModeForRTTOverlap(Me):pe[Me.overscaledZ],Kt=S?0:u.paint.get("raster-fade-duration");st.registerFadeDuration(Kt);const pn=a.findLoadedParent(Me,0),Nn=Mm(st,pn,a,m.transform,Kt);let an,dn;!Nn.isFading&&st.refreshedUponExpiration&&(st.refreshedUponExpiration=!1),m.terrain&&m.terrain.prepareDrawTile(),$.activeTexture.set(U.TEXTURE0),Et.bind(ce,U.CLAMP_TO_EDGE),$.activeTexture.set(U.TEXTURE1),pn?(pn.texture&&pn.texture.bind(ce,U.CLAMP_TO_EDGE),an=Math.pow(2,pn.tileID.overscaledZ-st.tileID.overscaledZ),dn=[st.tileID.canonical.x*an%1,st.tileID.canonical.y*an%1]):Et.bind(ce,U.CLAMP_TO_EDGE),"useMipmap"in Et&&$.extTextureFilterAnisotropic&&m.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const jn=m.transform;let Mn;const wn=R?Ub(jn):[0,0,0,0];let Rn,cr,Yr,ui,zi,br=0;if(O&&q instanceof o.aT&&q.coordinates.length>3)Rn=Float32Array.from(o.bj(o.dI(new o.cC(0,0,0)))),cr=Float32Array.from(jn.globeMatrix),Yr=Float32Array.from(o.dE(jn)),ui=[o.aF(jn.center.lng),o.aJ(jn.center.lat)],Mn=q.elevatedGlobePerspectiveTransform,zi=q.elevatedGlobeGridMatrix||new Float32Array(9);else if(O){const di=o.dF(Me.canonical);br=o.dG(di.getCenter().lat),Rn=Float32Array.from(o.bj(o.dI(Me.canonical))),cr=Float32Array.from(jn.globeMatrix),Yr=Float32Array.from(o.dE(jn)),ui=[o.aF(jn.center.lng),o.aJ(jn.center.lat)],Mn=[0,0],zi=Float32Array.from(o.dH(Me.canonical,di,br,jn.worldSize/jn._pixelsPerMercatorPixel))}else Mn=q instanceof o.aT?q.perspectiveTransform:[0,0],Rn=new Float32Array(16),cr=new Float32Array(9),Yr=new Float32Array(16),ui=[0,0],zi=new Float32Array(9);const ai=Xf(kt,Rn,cr,Yr,zi,dn||[0,0],o.aj(m.transform.zoom),ui,wn,an||1,Nn,u,Mn,R?u.paint.get("raster-elevation"):0,2,mt,Lt,H.range,ln,ht,X),kr=m.isTileAffectedByFog(Me),Oi=m.getOrCreateProgram("raster",{defines:H.defines,overrideFog:kr});if(m.uploadCommonUniforms($,Oi,Ve),q instanceof o.aT){const di=q.elevatedGlobeVertexBuffer,Vi=q.elevatedGlobeIndexBuffer;if(ae||!E)q.boundsBuffer&&q.boundsSegments&&Oi.draw(m,U.TRIANGLES,Qe,Tr.disabled,Q,xr.disabled,ai,u.id,q.boundsBuffer,m.quadTriangleIndexBuffer,q.boundsSegments);else if(di&&Vi){const vi=jn.zoom<=o.cZ?q.elevatedGlobeSegments:q.getSegmentsForLongitude(jn.center.lng);vi&&Oi.draw(m,U.TRIANGLES,Qe,Tr.disabled,Q,$e,ai,u.id,di,Vi,vi)}}else if(O){Qe=new Hn(U.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D);const di=m.globeSharedBuffers;if(di){const[Vi,vi,Fr]=di.getGridBuffers(br,!1);Oi.draw(m,U.TRIANGLES,Qe,Le||gt,m.colorModeForRenderPass(),$e,ai,u.id,Vi,vi,Fr)}}else{const{tileBoundsBuffer:di,tileBoundsIndexBuffer:Vi,tileBoundsSegments:vi}=m.getTileBoundsBuffers(st);Oi.draw(m,U.TRIANGLES,Qe,gt,Q,xr.disabled,ai,u.id,di,Vi,vi)}}if(!(q instanceof o.aT)&&O)for(const Me of Ie){const Ve=Me.canonical.y===(1<<Me.canonical.z)-1;Me.canonical.y===0&&j_(!0,Me,m,a,u,X,H,$e,Le||Tr.disabled),Ve&&j_(!1,Me,m,a,u,X,H,$e===xr.frontCW?xr.backCW:xr.frontCW,Le||Tr.disabled)}};O?Fe(Ce,m.renderElevatedRasterBackface?xr.backCW:xr.frontCW,m.stencilModeFor3D()):Fe(Ce,xr.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,a,u,g,x,S){m.renderPass==="offscreen"&&function(E,R,O,$){if(!$.length)return;const U=E.context,q=U.gl,H=R.getSource();if(!(H instanceof nr))return;const X=Math.ceil(Math.sqrt(O.paint.get("raster-particle-count")));let Q=O.particlePositionRGBAImage;if(!Q||Q.width!==X){const Ce=function(ve){const Fe=ve*ve,Ie=new Uint8Array(4*Fe),$e=function(Me){return Me|=0,Me=Math.imul(2747636419^Me,2654435769),Me=Math.imul(Me^Me>>>16,2654435769),((Me=Math.imul(Me^Me>>>16,2654435769))>>>0)/4294967296},Le=1/1.1;for(let Me=0;Me<Fe;Me++){const Ve=Le*($e(2*Me+0)+od),st=Le*($e(2*Me+1)+od),nt=255*Ve%1,Et=255*st%1,mt=nt,Lt=st-Et/255,ln=Et;Ie[4*Me+0]=255*(Ve-nt/255),Ie[4*Me+1]=255*mt,Ie[4*Me+2]=255*Lt,Ie[4*Me+3]=255*ln}return Ie}(X);Q=O.particlePositionRGBAImage=new o.q({width:X,height:X},Ce)}let ae=O.particleFramebuffer;ae?ae.width!==X&&(ae.destroy(),ae=O.particleFramebuffer=U.createFramebuffer(X,X,!0,null)):ae=O.particleFramebuffer=U.createFramebuffer(X,X,!0,null);const ue=[];for(const Ce of $){const ve=R.getTile(Ce);if(!(ve instanceof sa))continue;const Fe=V_(ve,H,O);if(!Fe)continue;const Ie=[ve.tileSize,ve.tileSize];let $e=O.tileFramebuffer;$e||($e=O.tileFramebuffer=U.createFramebuffer(Ie[0],Ie[1],!0,null));let Le=ve.rasterParticleState;Le||(Le=ve.rasterParticleState=new Es(U,Ce,Ie,Q));const Me=Le.update(O.lastInvalidatedAt);Le.particleTextureDimension!==X&&Le.updateParticleTexture(Ce,Q);const Ve=Le.targetColorTexture;Le.targetColorTexture=Le.backgroundColorTexture,Le.backgroundColorTexture=Ve;const st=Le.particleTexture0;Le.particleTexture0=Le.particleTexture1,Le.particleTexture1=st,ue.push([Ce,Fe,Le,Me])}if(ue.length===0)return;const ce=o.o.now(),pe=O.previousDrawTimestamp?.001*(ce-O.previousDrawTimestamp):.0167;if(O.previousDrawTimestamp=ce,O.hasColorMap()){U.activeTexture.set(q.TEXTURE0+2);let Ce=O.colorRampTexture;Ce||(Ce=O.colorRampTexture=new o.T(U,O.colorRamp,q.RGBA8)),Ce.bind(q.LINEAR,q.CLAMP_TO_EDGE)}U.bindFramebuffer.set(O.tileFramebuffer.framebuffer),function(Ce,ve,Fe){const Ie=Ce.context,$e=Ie.gl,Le=ve.tileFramebuffer;Ie.activeTexture.set($e.TEXTURE0);const Me={u_texture:0,u_opacity:1.05*(st=ve.paint.get("raster-particle-fade-opacity-factor"))/(st+.05)},Ve=Ce.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var st;for(const nt of Fe){const[,,Et,mt]=nt;Le.colorAttachment.set(Et.targetColorTexture.texture),Ie.viewport.set([0,0,Le.width,Le.height]),Ie.clear({color:o.ao.transparent}),mt&&(Et.backgroundColorTexture.bind($e.NEAREST,$e.CLAMP_TO_EDGE),Ve.draw(Ce,$e.TRIANGLES,Hn.disabled,Tr.disabled,jr.alphaBlended,xr.disabled,Me,ve.id,Ce.viewportBuffer,Ce.quadTriangleIndexBuffer,Ce.viewportSegments))}}(E,O,ue),function(Ce,ve,Fe,Ie){const $e=Ce.context,Le=$e.gl,Me=Fe.tileFramebuffer,Ve=Ce.transform.projection.name==="globe",st=Fe.paint.get("raster-particle-max-speed");for(const nt of Ie){const[Et,mt,Lt]=nt;$e.activeTexture.set(Le.TEXTURE0+0),mt.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),Me.colorAttachment.set(Lt.targetColorTexture.texture);const ln=Ce.getOrCreateProgram("rasterParticleDraw",{defines:mt.defines,overrideFog:!1});$e.activeTexture.set(Le.TEXTURE0+1);const ht=mt.scalarData?[]:[0,1,2,3].map(gt=>o.e8[gt](Et));ht.push(Et);const Qe=Et.canonical.x,kt=Et.canonical.y;for(const gt of ht){const Kt=ve.getTile(Ve?gt.wrapped():gt);if(!Kt)continue;const pn=Kt.rasterParticleState;if(!pn)continue;const Nn=gt.canonical.x+(1<<gt.canonical.z)*(gt.wrap-Et.wrap),an=gt.canonical.y;pn.particleTexture0.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);const dn=D_(1,pn.particleTexture0.size[0],[Nn-Qe,an-kt],0,mt.texture.size,2,st,mt.textureOffset,mt.scale,mt.offset);ln.draw(Ce,Le.POINTS,Hn.disabled,Tr.disabled,jr.alphaBlended,xr.disabled,dn,Fe.id,pn.particleIndexBuffer,void 0,pn.particleSegment)}}}(E,R,O,ue),U.bindFramebuffer.set(O.particleFramebuffer.framebuffer),function(Ce,ve,Fe,Ie){const $e=Ce.context,Le=$e.gl,Me=ve.paint.get("raster-particle-max-speed"),Ve=Ie*ve.paint.get("raster-particle-speed-factor")*.15,st=function(Et){return Math.pow(Et,6)}(.01+1*ve.paint.get("raster-particle-reset-rate-factor")),nt=ve.particleFramebuffer;$e.viewport.set([0,0,nt.width,nt.height]);for(const Et of Fe){const[,mt,Lt]=Et;$e.activeTexture.set(Le.TEXTURE0+0),mt.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),$e.activeTexture.set(Le.TEXTURE0+1);const ln=Lt.particleTexture0;ln.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);const ht=km(1,ln.size[0],0,mt.texture.size,Me,Ve,st,mt.textureOffset,mt.scale,mt.offset);nt.colorAttachment.set(Lt.particleTexture1.texture),$e.clear({color:o.ao.transparent}),Ce.getOrCreateProgram("rasterParticleUpdate",{defines:mt.defines}).draw(Ce,Le.TRIANGLES,Hn.disabled,Tr.disabled,jr.unblended,xr.disabled,ht,ve.id,Ce.viewportBuffer,Ce.quadTriangleIndexBuffer,Ce.viewportSegments)}}(E,O,ue,pe)}(m,a,u,g),m.renderPass==="translucent"&&(function(E,R,O,$,U){const q=E.context,H=q.gl,X=R.getSource().tileSize,Q=5*(1-o.ah(o.cK,o.cK+1,E.transform.zoom))*X+O.paint.get("raster-particle-elevation"),ae=!E.options.moving,ue=E.transform.projection.name==="globe";if(!$.length)return;const[ce,pe]=E.stencilConfigForOverlap($),Ce=[];ue&&Ce.push("PROJECTION_GLOBE_VIEW");const ve=E.stencilModeFor3D();for(const Fe of pe){const Ie=Fe.toUnwrapped(),$e=R.getTile(Fe);if(!$e.rasterParticleState)continue;const Le=$e.rasterParticleState,Me=100;$e.registerFadeDuration(Me);const Ve=R.findLoadedParent(Fe,0),st=Mm($e,Ve,R,E.transform,Me);let nt,Et;E.terrain&&E.terrain.prepareDrawTile(),q.activeTexture.set(H.TEXTURE0),Le.targetColorTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),q.activeTexture.set(H.TEXTURE1),Ve&&Ve.rasterParticleState?(Ve.rasterParticleState.targetColorTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),nt=Math.pow(2,Ve.tileID.overscaledZ-$e.tileID.overscaledZ),Et=[$e.tileID.canonical.x*nt%1,$e.tileID.canonical.y*nt%1]):Le.targetColorTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const mt=ue?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Ie,ae),Lt=E.transform,ln=ss(Lt),ht=o.dF(Fe.canonical),Qe=o.dG(ht.getCenter().lat);let kt,gt,Kt,pn,Nn;ue?(kt=Float32Array.from(o.bj(o.dI(Fe.canonical))),gt=Float32Array.from(Lt.globeMatrix),Kt=Float32Array.from(o.dE(Lt)),pn=[o.aF(Lt.center.lng),o.aJ(Lt.center.lat)],Nn=Float32Array.from(o.dH(Fe.canonical,ht,Qe,Lt.worldSize/Lt._pixelsPerMercatorPixel))):(kt=new Float32Array(16),gt=new Float32Array(9),Kt=new Float32Array(16),pn=[0,0],Nn=new Float32Array(9));const an=lu(mt,kt,gt,Kt,Nn,Et||[0,0],o.aj(E.transform.zoom),pn,ln,nt||1,st,Q),dn=E.isTileAffectedByFog(Fe),jn=E.getOrCreateProgram("rasterParticle",{defines:Ce,overrideFog:dn});if(E.uploadCommonUniforms(q,jn,Ie),ue){const Mn=new Hn(H.LEQUAL,Hn.ReadOnly,E.depthRangeFor3D),wn=0,Rn=E.globeSharedBuffers;if(Rn){const[cr,Yr,ui]=Rn.getGridBuffers(Qe,wn!==0);jn.draw(E,H.TRIANGLES,Mn,ve,jr.alphaBlended,E.renderElevatedRasterBackface?xr.frontCCW:xr.backCCW,an,O.id,cr,Yr,ui)}}else{const Mn=E.depthModeForSublayer(0,Hn.ReadOnly),wn=ce[Fe.overscaledZ],{tileBoundsBuffer:Rn,tileBoundsIndexBuffer:cr,tileBoundsSegments:Yr}=E.getTileBoundsBuffers($e);jn.draw(E,H.TRIANGLES,Mn,wn,jr.alphaBlended,xr.disabled,an,O.id,Rn,cr,Yr)}}E.resetStencilClippingMasks()}(m,a,u,g),m.style.map.triggerRepaint())},background:function(m,a,u,g){const x=u.paint.get("background-color"),S=u.paint.get("background-color-use-theme").constantOr("default")==="none",E=u.paint.get("background-opacity"),R=u.paint.get("background-emissive-strength"),O=u.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const $=m.context,U=$.gl,q=m.transform,H=q.tileSize,X=u.paint.get("background-pattern");let Q;if(X!==void 0&&(X===null||(Q=m.imageManager.getPattern(o.I.from(X.toString()),u.scope,m.style.getLut(u.scope)),!Q)))return;const ae=!X&&x.a===1&&E===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ae)return;const ue=Tr.disabled,ce=m.depthModeForSublayer(0,ae==="opaque"?Hn.ReadWrite:Hn.ReadOnly),pe=m.colorModeForDrapableLayerRenderPass(R),Ce=X?"backgroundPattern":"background";let ve,Fe=g;if(Fe||(ve=m.getBackgroundTiles(),Fe=Object.values(ve).map(Ie=>Ie.tileID)),X&&($.activeTexture.set(U.TEXTURE0),m.imageManager.bind(m.context,u.scope)),O){const Ie=m.getOrCreateProgram(Ce,{overrideFog:!1,overrideRtt:!0}),$e=new Float32Array(o.bz([])),Le=new o.aP(0,0,0,0,0),Me=X?Nm($e,R,E,m,0,u.scope,Q,O,{tileID:Le,tileSize:H}):Fm($e,R,E,x.toPremultipliedRenderColor(S?null:u.lut));Ie.draw(m,U.TRIANGLES,ce,ue,pe,xr.disabled,Me,u.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const Ie of Fe){const $e=m.isTileAffectedByFog(Ie),Le=m.getOrCreateProgram(Ce,{overrideFog:$e}),Me=Ie.toUnwrapped(),Ve=g?Ie.projMatrix:m.transform.calculateProjMatrix(Me);m.prepareDrawTile();const st=a?a.getTile(Ie):ve?ve[Ie.key]:new Ko(Ie,H,q.zoom,m),nt=X?Nm(Ve,R,E,m,0,u.scope,Q,O,{tileID:Ie,tileSize:H}):Fm(Ve,R,E,x.toPremultipliedRenderColor(S?null:u.lut));m.uploadCommonUniforms($,Le,Me);const{tileBoundsBuffer:Et,tileBoundsIndexBuffer:mt,tileBoundsSegments:Lt}=m.getTileBoundsBuffers(st);Le.draw(m,U.TRIANGLES,ce,ue,pe,xr.disabled,nt,u.id,Et,mt,Lt)}},sky:function(m,a,u){const g=m._atmosphere?o.aj(m.transform.zoom):1,x=u.paint.get("sky-opacity")*g;if(x===0)return;const S=m.context,E=u.paint.get("sky-type"),R=new Hn(S.gl.LEQUAL,Hn.ReadOnly,[0,1]),O=m.frameCounter/1e3%1;E==="atmosphere"?m.renderPass==="offscreen"?u.needsSkyboxCapture(m)&&(function($,U,q,H){const X=$.context,Q=X.gl;let ae=U.skyboxFbo;if(!ae){ae=U.skyboxFbo=X.createFramebuffer(32,32,!0,null),U.skyboxGeometry=new q_(X),U.skyboxTexture=X.gl.createTexture(),Q.bindTexture(Q.TEXTURE_CUBE_MAP,U.skyboxTexture),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR);for(let Ce=0;Ce<6;++Ce)Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Q.RGBA,32,32,0,Q.RGBA,Q.UNSIGNED_BYTE,null)}X.bindFramebuffer.set(ae.framebuffer),X.viewport.set([0,0,32,32]);const ue=U.getCenter($,!0),ce=$.getOrCreateProgram("skyboxCapture"),pe=new Float64Array(16);o.bz(pe),o.em(pe,pe,.5*-Math.PI),_l($,U,ce,pe,ue,0),o.bz(pe),o.em(pe,pe,.5*Math.PI),_l($,U,ce,pe,ue,1),o.bz(pe),o.cT(pe,pe,.5*-Math.PI),_l($,U,ce,pe,ue,2),o.bz(pe),o.cT(pe,pe,.5*Math.PI),_l($,U,ce,pe,ue,3),o.bz(pe),_l($,U,ce,pe,ue,4),o.bz(pe),o.em(pe,pe,Math.PI),_l($,U,ce,pe,ue,5),X.viewport.set([0,0,$.width,$.height])}(m,u),u.markSkyboxValid(m)):m.renderPass==="sky"&&function($,U,q,H,X){const Q=$.context,ae=Q.gl,ue=$.transform,ce=$.getOrCreateProgram("skybox");Q.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_CUBE_MAP,U.skyboxTexture);const pe=((Ce,ve,Fe,Ie,$e)=>({u_matrix:Ce,u_sun_direction:ve,u_cubemap:0,u_opacity:Ie,u_temporal_offset:$e}))(ue.skyboxMatrix,U.getCenter($,!1),0,H,X);$.uploadCommonUniforms(Q,ce),ce.draw($,ae.TRIANGLES,q,Tr.disabled,$.colorModeForRenderPass(),xr.backCW,pe,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(m,u,R,x,O):E==="gradient"&&m.renderPass==="sky"&&function($,U,q,H,X){const Q=$.context,ae=Q.gl,ue=$.transform,ce=$.getOrCreateProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new q_(Q)),Q.activeTexture.set(ae.TEXTURE0);let pe=U.colorRampTexture;pe||(pe=U.colorRampTexture=new o.T(Q,U.colorRamp,ae.RGBA8)),pe.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const Ce=((ve,Fe,Ie,$e,Le)=>({u_matrix:ve,u_color_ramp:0,u_center_direction:Fe,u_radius:o.an(Ie),u_opacity:$e,u_temporal_offset:Le}))(ue.skyboxMatrix,U.getCenter($,!1),U.paint.get("sky-gradient-radius"),H,X);$.uploadCommonUniforms(Q,ce),ce.draw($,ae.TRIANGLES,q,Tr.disabled,$.colorModeForRenderPass(),xr.backCW,Ce,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(m,u,R,x,O)},custom:function(m,a,u,g){const x=m.context,S=u.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&u.isDraped(a)){if(m.renderPass==="offscreen"){const E=S.prerender;if(E){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const R=m.transform.pointMerc;E.call(S,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.aj(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else E.call(S,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const R=S.renderToTile;if(R){const O=g[0].canonical,$={x:O.x+g[0].wrap*(S.wrapTileId?0:1<<O.z),y:O.y,z:O.z};x.setDepthMode(Hn.disabled),x.setStencilMode(Tr.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),R.call(S,x.gl,$),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(Tr.disabled);const E=S.renderingMode==="3d"?new Hn(m.context.gl.LEQUAL,Hn.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Hn.ReadOnly);if(x.setDepthMode(E),m.transform.projection.name==="globe"){const R=m.transform.pointMerc;S.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.aj(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else S.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,a,u,g){if(m.renderPass==="opaque")return;const x=u.paint.get("model-opacity").constantOr(1),S=u.paint.get("model-elevation-reference"),E=S==="ground",R=S==="ground";if(x===0)return;const O=u.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!O||m.terrain&&x<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof o.ad))return;const $=m.shadowRenderer,U=u.paint.get("model-receive-shadows");$&&($.useNormalOffset=!0,U||($.enabled=!1));const q=()=>{$&&($.useNormalOffset=!0,U||($.enabled=!0))},H=a.getSource();if(m.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return function(ve,Fe,Ie,$e,Le){const Me=ve.transform,Ve=Me.projection.name==="globe",st=Me.getFreeCameraOptions().position;if(!ve.modelManager)return;const nt=ve.modelManager;Ie.modelManager=nt;const Et=ve.shadowRenderer;if(!Ie._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const mt=Ie._unevaluatedLayout._values["model-id"],Lt=Object.assign({},Ie.layout.get("model-id").parameters),ln=ve.style.order.indexOf(Ie.fqid);for(const ht of $e){const Qe=Fe.getTile(ht).getBucket(Ie);if(!Qe||Qe.projection.name!==Me.projection.name)continue;const kt=Qe.getModelUris();if(kt&&!Qe.modelsRequested&&(nt.addModelsFromBucket(kt,Le),Qe.modelsRequested=!0),Ve)Lt.zoom=ht.overscaledZ;else{const Mn=X_(ht,Me);Lt.zoom=Mn}const gt=mt.possiblyEvaluate(Lt);if(Kb(ve,Qe,ht),qs.shadowUniformsInitialized=!1,qs.useSingleShadowCascade=!!Et&&Et.getMaxCascadeForTile(ht.toUnwrapped())===0,ve.renderPass==="shadow"&&Et){if(ve.currentShadowCascade===1&&Qe.isInsideFirstShadowMapFrustum)continue;const Mn=Me.calculatePosMatrix(ht.toUnwrapped(),Me.worldSize);if(qs.tileMatrix.set(Mn),qs.shadowTileMatrix=Float32Array.from(Et.calculateShadowPassMatrixFromMatrix(Mn)),qs.aabb.min=[0,0,0],qs.aabb.max[0]=qs.aabb.max[1]=o.al,qs.aabb.max[2]=0,Xm(Qe,qs,ve,Ie.scope))continue}const Kt=1<<ht.canonical.z,pn=[((st.x-ht.wrap)*Kt-ht.canonical.x)*o.al,(st.y*Kt-ht.canonical.y)*o.al,st.z*Kt*o.al];ve.conflationActive&&Object.keys(Qe.instancesPerModel).length>0&&ve.style.isLayerClipped(Ie,Fe.getSource())&&Qe.updateReplacement(ht,ve.replacementSource,ln,Le)&&(Qe.uploaded=!1,Qe.upload(ve.context));let Nn=0;const an=new Array,dn=new Array,jn=new Array;for(let Mn in Qe.instancesPerModel){const wn=Qe.instancesPerModel[Mn];wn.features.length>0&&!Ve&&(Mn=gt.evaluate(wn.features[0].feature,{}));const Rn=nt.getModel(Mn,Le);if(Rn||nt.hasURLBeenRequested(Mn)||Qe.modelUris.includes(Mn)||(Qe.modelUris.push(Mn),Qe.modelsRequested=!1),Rn&&Rn.uploaded)if(Ve){const cr=o.c4([],[st.x,st.y,st.z],ve.transform.worldSize);o.ev(cr,cr);for(let Yr=0;Yr<wn.instancedDataArray.length;++Yr){const ui=[0,0,0],zi=[1,1,1],br=o.ew(),ai=wn.tileCoordinatesForInstance(Yr),kr=wn.transformForInstance(Yr);o.ex(zi,kr),o.ey(br,kr),o.ez(ui,br);const Oi=wn.translationForInstance(Yr),di=new o.aS(0,0);o.eA(Qe.canonical,di,ai.x,ai.y);const Vi=o.bB();o.eB(Vi,Rn,ve.transform,di,ui,zi,Oi,!0,!1,!1);const vi=wn.colorForInstance(Yr),Fr=o.bz([]),Ei=o.ee(di.lat,ve.transform.zoom),Ur=o.bp([],[1,1,1/Ei]);o.bq(Fr,Fr,cr),jn.push({zScaleMatrix:Ur,negCameraPosMatrix:Fr});for(const Ki of Rn.nodes)Km(ve,Ki,Vi,ve.transform.expandedFarZProjMatrix,Nn,an,dn,Rn.materialOverrides,vi);++Nn}}else for(const cr of Rn.nodes)Z_(ve,Ie,cr,wn,pn,ht,qs)}if(Ve)if(ve.renderPass==="shadow"){for(const Mn of dn)dh(Mn.mesh,Mn.nodeModelMatrix,ve,Ie);for(const Mn of an)dh(Mn.mesh,Mn.nodeModelMatrix,ve,Ie)}else qb(ve,Ie,1,an,dn,jn)}}(m,a,u,g,qm(H,u,m.style._importedAsBasemap)),void q();if(!H.loaded())return;if(H.type==="batched-model")return function(ve,Fe,Ie,$e){Ie.resetLayerRenderingStats(ve);const Le=ve.context,Me=ve.transform,Ve=ve.style.fog,st=ve.shadowRenderer;if(Me.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Me.projection.name} projection is not yet implemented`);const nt=ve.transform.getFreeCameraOptions().position,Et=o.c4([],[nt.x,nt.y,nt.z],ve.transform.worldSize),mt=o.ev([],Et),Lt=o.bz([]),ln=o.ee(Me.center.lat,Me.zoom),ht=o.bp([],[1,1,1/ln]);o.bq(Lt,Lt,mt);const Qe=Ie.paint.get("model-opacity").constantOr(1),kt=new Hn(Le.gl.LEQUAL,Hn.ReadWrite,ve.depthRangeFor3D),gt=new Hn(Le.gl.LEQUAL,Hn.ReadOnly,ve.depthRangeFor3D),Kt=new o.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),pn=ve.renderPass==="shadow",Nn=pn&&st?st.getCurrentCascadeFrustum():Me.getFrustum(Me.scaleZoom(Me.worldSize)),an=Ie.paint.get("model-front-cutoff"),dn=an[2]<1,jn=Cc(ve,Ie.paint.get("model-cutoff-fade-range")),Mn=Ie.getLayerRenderingStats();(function(wn,Rn,cr,Yr){const ui=wn.terrain?wn.terrain.exaggeration():0,zi=wn.transform.zoom;for(const br of Yr){const ai=Rn.getTile(br).getBucket(cr);ai&&(ai.setFilter(cr.filter),wn.conflationActive&&ai.updateReplacement(br,wn.replacementSource),ai.evaluateTransform(wn,cr),wn.terrain&&ui>0&&ai.elevationUpdate(wn.terrain,ui,br,cr.source),ai.needsReEvaluation(wn,zi,cr)&&ai.evaluate(cr))}})(ve,Fe,Ie,$e),function(){let wn,Rn,cr;dn?(wn=$e.length-1,Rn=-1,cr=-1):(wn=0,Rn=$e.length,cr=1);const Yr=new Float64Array(16),ui=o.cz(),zi=new o.P(0,0);for(let br=wn;br!==Rn;br+=cr){const ai=$e[br],kr=Fe.getTile(ai).getBucket(Ie);if(!kr||!kr.uploaded)continue;let Oi=!1;st&&(Oi=st.getMaxCascadeForTile(ai.toUnwrapped())===0);const di=Me.calculatePosMatrix(ai.toUnwrapped(),Me.worldSize),Vi=kr.modelTraits;!pn&&dn&&(o.bk(Yr,di),o.af(ui,Et,Yr),zi.x=ui[0],zi.y=ui[1]);const vi=[];kr.setFilter(Ie.filter);for(const Fr of kr.getNodesInfo()){if(Fr.hiddenByReplacement||!Fr.node.meshes)continue;const Ei=Fr.node;let Ur=0;ve.terrain&&Ei.elevation&&(Ur=Ei.elevation*ve.terrain.exaggeration());const Ki=(()=>{const Ha=Fr.aabb;return Kt.min=[...Ha.min],Kt.max=[...Ha.max],Kt.min[2]+=Ur,Kt.max[2]+=Ur,o.af(Kt.min,Kt.min,di),o.af(Kt.max,Kt.max,di),Kt})(),Pi=Fr.evaluatedScale;if(Pi[0]<=1&&Pi[1]<=1&&Pi[2]<=1&&Ki.intersects(Nn)===0)continue;if(!pn&&dn){const Ha=.16666666666666666;Fr.cameraCollisionOpacity=Et[0]>Ki.min[0]&&Et[0]<Ki.max[0]&&Et[1]>Ki.min[1]&&Et[1]<Ki.max[1]&&Et[2]*ln<Ki.max[2]&&Ei.footprint&&o.b$(zi,Ei.footprint)?Math.max(Fr.cameraCollisionOpacity-Ha,0):Math.min(1,Fr.cameraCollisionOpacity+Ha)}const Sr=[...di],fi=1/o.d6(ai.canonical),ao=Ei.anchor?Ei.anchor[0]:0,Ro=Ei.anchor?Ei.anchor[1]:0;o.bq(Sr,Sr,[ao*(Pi[0]-1)+Fr.evaluatedTranslation[0]*fi,Ro*(Pi[1]-1)+Fr.evaluatedTranslation[1]*fi,Ur+Fr.evaluatedTranslation[2]]),o.cp(Pi,o.eD)||o.cR(Sr,Sr,Pi);const mo=o.aB([],Sr,Ei.globalMatrix),So=o.aB([],Me.expandedFarZProjMatrix,mo),ys=o.aB([],Me.expandedFarZProjMatrix,Sr),ls=o.aC([],[ao,Ro,Ur,1],So)[2];Ei.hidden=!1;let ka=Qe;pn||(dn&&(ka*=Fr.cameraCollisionOpacity,ka*=ld(Sr,Me,Fr.aabb,an)),ka*=Qf(jn,ls)),ka!==0?vi.push({nodeInfo:Fr,depth:ls,opacity:ka,wvpForNode:So,wvpForTile:ys,nodeModelMatrix:mo,tileModelMatrix:Sr}):Ei.hidden=!0}pn||vi.sort((Fr,Ei)=>!dn||Fr.opacity===1&&Ei.opacity===1?Fr.depth<Ei.depth?-1:1:Fr.opacity===1?-1:Ei.opacity===1?1:Fr.depth>Ei.depth?-1:1);for(const Fr of vi){const Ei=Fr.nodeInfo,Ur=Ei.node;let Ki=o.aB([],ht,Fr.tileModelMatrix);o.aB(Ki,Lt,Ki);const Pi=o.bk([],Ki);o.ef(Pi,Pi),o.cR(Pi,Pi,Xb),Ki=o.aB(Ki,Ki,Ur.globalMatrix);const Sr=ve.renderPass==="light-beam",fi=Ie.paint.get("model-color-use-theme").constantOr("default")==="none",ao=Vi&o.eH.HasMapboxMeshFeatures,Ro=ao?0:Ei.evaluatedRMEA[0][2];for(let mo=0;mo<Ur.meshes.length;++mo){const So=Ur.meshes[mo],ys=mo===Ur.lightMeshIndex;let ls=Fr.wvpForNode;if(ys){if(!Sr&&!ve.terrain&&ve.shadowRenderer){ve.currentLayer<ve.firstLightBeamLayer&&(ve.firstLightBeamLayer=ve.currentLayer);continue}ls=Fr.wvpForTile}else if(Sr)continue;const ka={defines:[]},Ha=[];if(!pn&&st&&(st.useNormalOffset=!!So.normalBuffer),ch(ka.defines,Ha,So,ve,fi?null:Ie.lut),ao||ka.defines.push("DIFFUSE_SHADED"),Oi&&ka.defines.push("SHADOWS_SINGLE_CASCADE"),Mn&&(pn?Mn.numRenderedVerticesInShadowPass+=So.vertexArray.length:Mn.numRenderedVerticesInTransparentPass+=So.vertexArray.length),pn){dh(So,Fr.nodeModelMatrix,ve,Ie);continue}let Xs=null;if(Ve){const Ao=K_(Fr.nodeModelMatrix,ve.transform);if(Xs=new Float32Array(Ao),Me.projection.name!=="globe"){const $i=So.aabb.min,zo=So.aabb.max,[wa,vo]=Ve.getOpacityForBounds(Ao,$i[0],$i[1],zo[0],zo[1]);ka.overrideFog=wa>=rt||vo>=rt}}const Fa=So.material;let Zs;Fa.occlusionTexture&&Fa.occlusionTexture.offsetScale&&(Zs=Fa.occlusionTexture.offsetScale,ka.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const bl=ve.getOrCreateProgram("model",ka);!pn&&st&&st.setupShadowsFromMatrix(Fr.tileModelMatrix,bl,st.useNormalOffset),ve.uploadCommonUniforms(Le,bl,null,Xs);const ba=Fa.pbrMetallicRoughness;ba.metallicFactor=.9,ba.roughnessFactor=.5;const go=Bm(new Float32Array(ls),new Float32Array(Ki),new Float32Array(Pi),new Float32Array(Ur.globalMatrix),ve,Fr.opacity,ba.baseColorFactor,Fa.emissiveFactor,ba.metallicFactor,ba.roughnessFactor,Fa,Ro,Ie,[0,0,0],Zs);!ys&&(Ei.hasTranslucentParts||Fr.opacity<1)&&bl.draw(ve,Le.gl.TRIANGLES,kt,Tr.disabled,jr.disabled,xr.backCCW,go,Ie.id,So.vertexBuffer,So.indexBuffer,So.segments,Ie.paint,ve.transform.zoom,void 0,Ha),bl.draw(ve,Le.gl.TRIANGLES,ys?gt:kt,Tr.disabled,ys||Fr.opacity<1||Ei.hasTranslucentParts?jr.alphaBlended:jr.unblended,xr.backCCW,go,Ie.id,So.vertexBuffer,So.indexBuffer,So.segments,Ie.paint,ve.transform.zoom,void 0,Ha)}}}}()}(m,a,u,g),void q();if(H.type!=="model")return;const X=H.getModels(),Q=[],ae=m.transform.getFreeCameraOptions().position,ue=o.c4([],[ae.x,ae.y,ae.z],m.transform.worldSize);o.ev(ue,ue);const ce=[],pe=[];let Ce=0;for(const ve of X){const Fe=a.getFeatureState("",ve.id),Ie={type:"Unknown",id:ve.id,properties:ve.featureProperties},$e=u.paint.get("model-rotation").evaluate(Ie,Fe),Le=u.paint.get("model-scale").evaluate(Ie,Fe),Me=u.paint.get("model-translation").evaluate(Ie,Fe);hh(u,ve.id,Fe,ve.featureProperties,ve.nodeOverrideNames,ve.nodeOverrides),bT(u,ve.id,Fe,ve.featureProperties,ve.materialOverrideNames,ve.materialOverrides),ve.nodeOverrides.size>0&&ve.computeBoundsAndApplyParent(),ve.computeModelMatrix(m,$e,Le,Me,R,E,!1);const Ve=o.bz([]),st=o.ee(ve.position.lat,m.transform.zoom),nt=o.bp([],[1,1,1/st]);o.bq(Ve,Ve,ue),Q.push({zScaleMatrix:nt,negCameraPosMatrix:Ve});for(const Et of ve.nodes)Km(m,Et,ve.matrix,m.transform.expandedFarZProjMatrix,Ce,ce,pe,ve.materialOverrides);Ce++}if(ce.sort((ve,Fe)=>Fe.depth-ve.depth),m.renderPass!=="shadow")qb(m,u,x,ce,pe,Q),q();else{for(const ve of pe)dh(ve.mesh,ve.nodeModelMatrix,m,u);for(const ve of ce)dh(ve.mesh,ve.nodeModelMatrix,m,u);q()}}},Zm={line:function(m,a,u){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(a){const g=a.getVisibleCoordinates();for(const x of g){const S=a.getTile(x).getBucket(m);if(S&&(S.elevationType!=="none"?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,a,u){const g=a.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson"){const S=qm(g,m,u.style._importedAsBasemap);return void(u.modelManager&&u.modelManager.upload(u,S))}if(g.type==="batched-model"||g.type!=="model")return;const x=g.getModels();for(const S of x)S.upload(u.context)},raster:function(m,a,u){const g=a.getSource();if(!(g instanceof nr&&g.loaded()))return;const x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=m.paint.get("raster-array-band")||g.getInitialBand(x);if(S==null)return;const E=a.getIds().map(R=>a.getTileByID(R));for(const R of E)R.updateNeeded(m.id,S)&&g.prepareTile(R,x,m.id,S)},"raster-particle":function(m,a,u){const g=a.getSource();if(!(g instanceof nr&&g.loaded()))return;const x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=m.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(S==null)return;const E=a.getIds().map(R=>a.getTileByID(R));for(const R of E)R.updateNeeded(m.id,S)&&g.prepareTile(R,x,m.id,S)}},Ym={fill:ad},Ks={fill:function(m,a,u,g){if(!u.layout||u.layout.get("fill-elevation-reference")==="none"||u.paint.get("fill-opacity").constantOr(1)===0)return;const x=m.context.gl,S=new Hn(x.LEQUAL,Hn.ReadOnly,m.depthRangeFor3D),E=new Tr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),R=m.transform.getFreeCameraOptions().position,O=m.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const $ of g){const U=a.getTile($),q=U.getBucket(u);if(!q)continue;const H=q.elevatedStructures;if(!H||H.depthSegments.segments[0].primitiveLength===0)continue;const X=jb($.toUnwrapped(),R),Q=m.translatePosMatrix($.projMatrix,U,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),ae=Dm(Q,X,0,1,0);O.draw(m,x.TRIANGLES,S,E,jr.disabled,xr.disabled,ae,u.id,H.vertexBuffer,H.indexBuffer,H.depthSegments,u.paint,m.transform.zoom)}}};class pu{constructor(a,u,g,x,S,E){this.context=new jm(a,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=o.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const R=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const $ of R)this._debugParams.enabledLayers[$]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const $ of R)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],$);this.occlusionParams=new wT(S),this.setup(),this.numSublayers=Ja.maxUnderzooming+Ja.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.eO,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Nf(this),this._wireframeDebugCache=new Yb,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const O=new o.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,O,a.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x,this.worldview=E}updateTerrain(a,u){const g=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new qf(this,a));const x=this._terrain;this.transform.elevation=g?x:null,x.update(a,this.transform,u),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(a){const u=a.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=u.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const S=g+.78*(x-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(a){a&&!this._terrain&&(this._terrain=new qf(this,this.style)),this._forceTerrainMode=a}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(a,u){if(this.width=a*o.o.devicePixelRatio,this.height=u*o.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const a=this.context,u=new o.bc;u.emplaceBack(0,0),u.emplaceBack(o.al,0),u.emplaceBack(0,o.al),u.emplaceBack(o.al,o.al),this.tileExtentBuffer=a.createVertexBuffer(u,o.be.members),this.tileExtentSegments=o.bf.simpleSegment(0,0,4,2);const g=new o.bc;g.emplaceBack(0,0),g.emplaceBack(o.al,0),g.emplaceBack(0,o.al),g.emplaceBack(o.al,o.al),this.debugBuffer=a.createVertexBuffer(g,o.be.members),this.debugSegments=o.bf.simpleSegment(0,0,4,5);const x=new o.bc;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(x,o.be.members),this.viewportSegments=o.bf.simpleSegment(0,0,4,2);const S=new o.a$;S.emplaceBack(0,0,0,0),S.emplaceBack(o.al,0,o.al,0),S.emplaceBack(0,o.al,0,o.al),S.emplaceBack(o.al,o.al,o.al,o.al),this.mercatorBoundsBuffer=a.createVertexBuffer(S,o.bh.members),this.mercatorBoundsSegments=o.bf.simpleSegment(0,0,4,2);const E=new o.b0;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(E);const R=new o.bd;for(const $ of[0,1,3,2,0])R.emplaceBack($);this.debugIndexBuffer=a.createIndexBuffer(R),this.emptyTexture=new o.T(a,new o.q({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA8),this.identityMat=o.bB();const O=this.context.gl;this.stencilClearMode=new Tr({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,a.TRIANGLES,Hn.disabled,this.stencilClearMode,jr.disabled,xr.disabled,id(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,u,g){if(!u||this.currentStencilSource===u.id||!a.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(const O of g)if(this._tileClippingMaskIDs[O.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=u.id;const x=this.context,S=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(jr.disabled),x.setDepthMode(Hn.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of g){const O=u.getTile(R),$=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:U,tileBoundsIndexBuffer:q,tileBoundsSegments:H}=this.getTileBoundsBuffers(O);E.draw(this,S.TRIANGLES,Hn.disabled,new Tr({func:S.ALWAYS,mask:0},$,255,S.KEEP,S.KEEP,S.REPLACE),jr.disabled,xr.disabled,id(R.projMatrix),"$clipping",U,q,H)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,u=this.context.gl;return new Tr({func:u.NOTEQUAL,mask:255},a,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const u=this.context.gl;return new Tr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(a){const u=this.context.gl,g=a.sort((E,R)=>R.overscaledZ-E.overscaledZ),x=g[g.length-1].overscaledZ,S=g[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const E={};for(let R=0;R<S;R++)E[R+x]=new Tr({func:u.GEQUAL,mask:255},R+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[E,g]}return[{[x]:Tr.disabled},g]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new jr([a.CONSTANT_COLOR,a.ONE,a.CONSTANT_COLOR,a.ONE],new o.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jr.unblended:jr.alphaBlended}colorModeForDrapableLayerRenderPass(a){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new jr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new o.ao(0,0,0,a===void 0?0:a),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(a,u,g,x=!1){if(this.depthOcclusion)return new Hn(this.context.gl.GREATER,Hn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return Hn.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Hn(g||this.context.gl.LEQUAL,u,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const a=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),S=a.getParameter(a.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new $m(this.context,u,g,!1,"texture"),this.depthTexture=new o.T(this.context,{width:u,height:g,data:null},a.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),a.bindTexture(a.TEXTURE_2D,S),this.depthFBO&&(a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),a.blitFramebuffer(0,0,u,g,0,0,u,g,a.DEPTH_BUFFER_BIT,a.NEAREST),a.bindFramebuffer(a.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((a,u)=>a+u/this._fpsHistory.length,0))}render(a,u){const g=o.o.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=a.map.repaint,this.style=a,this.options=u;const x=this.style._mergedLayers,S=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(S).filter(ht=>{const Qe=x[ht];return!(Qe.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Qe.type]});let R=E(),O=!1,$=!1,U=null;for(const ht of R){const Qe=x[ht];Qe.type==="circle"?O=!0:Qe.type==="building"?U=Qe:Qe.type==="symbol"&&(Qe.hasOcclusionOpacityProperties?$=!0:O=!0)}let q=R.map(ht=>x[ht]);const H=this.style._mergedSourceCaches;this.imageManager=a.imageManager,this.modelManager=a.modelManager,this.symbolFadeChange=a.placement.symbolFadeChange(o.o.now()),this.imageManager.beginFrame();let X=0,Q=!1;for(const ht in H){const Qe=H[ht];Qe.used&&(Qe.prepare(this.context),Qe.getSource().usedInConflation&&++X)}let ae=!1;for(const ht of q)ht.isHidden(this.transform.zoom)||(ht.type==="clip"&&(ae=!0),this.prepareLayer(ht));const ue={},ce={},pe={},Ce={},ve={};for(const ht in H){const Qe=H[ht];ue[ht]=Qe.getVisibleCoordinates(),ce[ht]=ue[ht].slice().reverse(),pe[ht]=Qe.getVisibleCoordinates(!0).reverse(),Ce[ht]=Qe.getShadowCasterCoordinates(),ve[ht]=Qe.sortCoordinatesByDistance(ue[ht])}const Fe=ht=>{const Qe=this.style.getLayerSourceCache(ht);return Qe&&Qe.used?Qe.getSource():null};if(X||ae||this._clippingActiveLastFrame){const ht=[],Qe=[];let kt=0;for(const gt of q)this.isSourceForClippingOrConflation(gt,Fe(gt))&&(ht.push(gt),Qe.push(kt)),kt++;if(ht&&(ae||ht.length>1)||this._clippingActiveLastFrame){ae=!1;const gt=[];for(let Kt=0;Kt<ht.length;Kt++){const pn=ht[Kt],Nn=Qe[Kt],an=this.style.getLayerSourceCache(pn);if(!an||!an.used||!an.getSource().usedInConflation&&pn.type!=="clip"&&pn.type!=="building")continue;let dn=o.eP,jn=o.bZ.None;const Mn=[];let wn=!0;if(pn.type==="building")dn=o.eR;else if(pn.type==="clip"){dn=Nn;for(const Rn of pn.layout.get("clip-layer-types"))jn|=Rn==="model"?o.bZ.Model:Rn==="symbol"?o.bZ.Symbol:o.bZ.FillExtrusion;for(const Rn of pn.layout.get("clip-layer-scope"))Mn.push(Rn);pn.isHidden(this.transform.zoom)?wn=!1:ae=!0}wn&&gt.push({layer:pn.fqid,cache:an,order:dn,clipMask:jn,clipScope:Mn})}this.replacementSource.setSources(gt),Q=!0}}this._clippingActiveLastFrame=ae,Q||this.replacementSource.clear(),this.conflationActive=Q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ht=0;ht<q.length;ht++){const Qe=q[ht],kt=Qe.cutoffRange();if(this.longestCutoffRange=Math.max(kt,this.longestCutoffRange),kt>0){const gt=Fe(Qe);gt&&(this.minCutoffZoom=Math.max(gt.minzoom,this.minCutoffZoom)),Qe.minzoom&&(this.minCutoffZoom=Math.max(Qe.minzoom,this.minCutoffZoom))}Qe.is3D(S)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ht),this._lastOcclusionLayer=ht)}const Ie=this.style&&this.style.fog;Ie?(this._fogVisible=Ie.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ie.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(pe),this.opaquePassCutoff=0,R=E(),q=R.map(ht=>x[ht]));const $e=this._shadowRenderer;if($e){$e.updateShadowParameters(this.transform,this.style.directionalLight);for(const ht in H)for(const Qe of ue[ht]){let kt={min:0,max:0};this.terrain&&(kt=this.terrain.getMinMaxForTile(Qe)||kt),$e.addShadowReceiver(Qe.toUnwrapped(),kt.min,kt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.eQ(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new wo(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Le=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Me=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Le&&!this._snow&&(this._snow=new J_(this)),!Le&&this._snow&&(this._snow.destroy(),delete this._snow),Me&&!this._rain&&(this._rain=new fh(this)),!Me&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),U){this.buildingTileBorderManager||(this.buildingTileBorderManager=new lt);const ht=this.style.getLayerSourceCache(U);this.buildingTileBorderManager.updateBorders(ht,U)}if(!yt.has(this.context.gl))return;this.renderPass="offscreen";for(const ht of q){const Qe=a.getLayerSourceCache(ht);if(!ht.hasOffscreenPass()||ht.isHidden(this.transform.zoom))continue;const kt=Qe?ce[Qe.id]:void 0;(ht.type==="custom"||ht.type==="raster"||ht.type==="raster-particle"||ht.isSky()||kt&&kt.length)&&this.renderLayer(this,Qe,ht,kt)}this.depthRangeFor3D=[0,1-(q.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ce)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ve=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),st=(()=>{if(u.showOverdrawInspector)return o.ao.black;const ht=this.style.fog;if(ht&&this.transform.projection.supportsFog){const Qe=this.style.getLut(ht.scope);if(!Ve){const kt=ht.properties.get("color-use-theme")==="none",gt=ht.properties.get("color").toNonPremultipliedRenderColor(kt?null:Qe).toArray01();return new o.ao(...gt)}if(Ve){const kt=ht.properties.get("space-color-use-theme")==="none",gt=ht.properties.get("space-color").toNonPremultipliedRenderColor(kt?null:Qe).toArray01();return new o.ao(...gt)}}return o.ao.transparent})();if(this.context.clear({color:st,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=R.length-1;this.currentLayer>=0;this.currentLayer--){const ht=q[this.currentLayer],Qe=a.getLayerSourceCache(ht);if(ht.isSky())continue;const kt=Qe?(ht.is3D(S)?ve:ce)[Qe.id]:void 0;this._renderTileClippingMasks(ht,Qe,kt),this.renderLayer(this,Qe,ht,kt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ve&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<R.length;this.currentLayer++){const ht=q[this.currentLayer],Qe=a.getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,Qe,ht,Qe?ce[Qe.id]:void 0)}function nt(ht,Qe){let kt;return Qe&&(kt=(ht.type==="symbol"?pe:ht.is3D(S)?ve:ce)[Qe.id]),kt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<R.length;){const ht=q[this.currentLayer];if(ht.type==="raster"||ht.type==="raster-particle"){const Qe=a.getLayerSourceCache(ht);this.renderLayer(this,Qe,ht,nt(ht,Qe))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Et=0;$e&&(Et=$e.getShadowCastingLayerCount());let mt=!1,Lt=-1;for(let ht=0;ht<R.length;++ht){const Qe=q[ht];Qe.isHidden(this.transform.zoom)||Qe.is3D(S)&&(Lt=ht)}$&&Lt===-1&&(O=!0);let ln=!1;for(;this.currentLayer<R.length;){const ht=q[this.currentLayer],Qe=a.getLayerSourceCache(ht);if(ht.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!ln&&ht.is3D(S)&&!S){const kt=this.currentLayer,gt=Kt=>{for(this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){const pn=q[this.currentLayer];if(Ym[pn.type]){const Nn=this.style.getLayerSourceCache(pn);Ym[pn.type](this,Nn,pn,nt(pn,Nn),Kt)}}};gt("initialize"),gt("reset"),this.currentLayer=kt,ln=!0}if(O&&!mt&&this.terrain&&!this.transform.isOrthographic&&(mt=!0,this.blitDepth()),$&&Lt!==-1&&this.currentLayer===Lt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(ht,Qe,Qe?ue[Qe.id]:void 0),this.renderLayer(this,Qe,ht,nt(ht,Qe)),!this.terrain&&$e&&Et>0&&ht.hasShadowPass()&&--Et==0){{this.clearStencil(),this.resetStencilClippingMasks();const kt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){const gt=q[this.currentLayer];if(Ks[gt.type]){const Kt=this.style.getLayerSourceCache(gt);Ks[gt.type](this,Kt,gt,nt(gt,Kt))}}this.currentLayer=kt}if($e.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const kt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=kt;this.currentLayer++){const gt=q[this.currentLayer];if(!gt.hasLightBeamPass())continue;const Kt=a.getLayerSourceCache(gt);this.renderLayer(this,Kt,gt,Kt?ce[Kt.id]:void 0)}this.currentLayer=kt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const kt=this.currentLayer;this.depthOcclusion=!0;for(const gt of this.layersWithOcclusionOpacity){this.currentLayer=gt;const Kt=q[this.currentLayer],pn=a.getLayerSourceCache(Kt),Nn=pn?ce[pn.id]:void 0;this.terrain||this._renderTileClippingMasks(Kt,pn,pn?ue[pn.id]:void 0),this.renderLayer(this,pn,Kt,Nn)}this.depthOcclusion=!1,this.currentLayer=kt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;q.forEach(Qe=>{const kt=a.getLayerSourceCache(Qe);kt&&!Qe.isHidden(this.transform.zoom)&&kt.getVisibleCoordinates().length&&(!ht||ht.getSource().maxzoom<kt.getSource().maxzoom)&&(ht=kt)}),ht&&this.options.showTileBoundaries&&W_(this,ht,ht.getVisibleCoordinates(),o.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&W_(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ht){const Qe=ht.transform.padding;Wi(ht,ht.transform.height-(Qe.top||0),3,fu),Wi(ht,Qe.bottom||0,3,Hb),Jf(ht,Qe.left||0,3,U_),Jf(ht,ht.transform.width-(Qe.right||0),3,H_);const kt=ht.transform.centerPoint;(function(gt,Kt,pn,Nn){sh(gt,Kt-1,pn-10,2,20,Nn),sh(gt,Kt-10,pn-1,20,2,Nn)})(ht,kt.x,ht.transform.height-kt.y,G_)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Q||(this.conflationActive=!1)}prepareLayer(a){this.gpuTimingStart(a);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(a.type);if(Zm[a.type]&&(g||this.terrain&&a.type==="custom")){const x=this.style.getLayerSourceCache(a);Zm[a.type](a,x,this)}this.gpuTimingEnd()}renderLayer(a,u,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),a.transform.projection.unsupportedLayers&&a.transform.projection.unsupportedLayers.includes(g.type)&&(!a.terrain||g.type!=="custom")||g.type==="clip"||Q_[g.type](a,u,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let x=this.gpuTimers[a.id];x||(x=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(a.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const u={};for(const g in a){const x=a[g],S=this.context.extTimerQuery,E=S.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(x.query),u[g]=E}return u}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const x of a)g+=u.getQueryParameter(x,u.QUERY_RESULT)/1e6,u.deleteQuery(x);return g}translatePosMatrix(a,u,g,x,S){if(!g[0]&&!g[1])return a;const E=S?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(E){const $=Math.sin(E),U=Math.cos(E);g=[g[0]*U-g[1]*$,g[0]*$+g[1]*U]}const R=[S?g[0]:o.ay(u,g[0],this.transform.zoom),S?g[1]:o.ay(u,g[1],this.transform.zoom),0],O=new Float32Array(16);return o.bq(O,a,R),O}saveTileTexture(a){if(a.context!==this.context)return;const u=a.size[0],g=this._tileTextures[u];g?g.push(a):this._tileTextures[u]=[a]}getTileTexture(a){const u=this._tileTextures[a];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(a,u,g){const x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,S=[];return this.style&&this.style.enable3dLights()&&(a==="globeRaster"||a==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||x||u!==void 0&&!u||S.push("FOG","FOG_DITHERING"),x&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(a,u){this.cache=this.cache||{};const g=u&&u.defines||[],x=u&&u.config,S=this.currentGlobalDefines(a,u&&u.overrideFog,u&&u.overrideRtt).concat(g),E=Kf.cacheKey(ym[a],a,S,x);return this.cache[E]||(this.cache[E]=new Kf(this.context,a,ym[a],x,vT[a],S)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(a,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){const S=((E,R,O)=>{const $=E.properties.get("direction"),U=E.properties.get("color-use-theme")==="none",q=E.properties.get("color").toNonPremultipliedRenderColor(U?null:O.getLut(E.scope)).toArray01(),H=E.properties.get("intensity"),X=R.properties.get("color-use-theme")==="none",Q=R.properties.get("color").toNonPremultipliedRenderColor(X?null:O.getLut(R.scope)).toArray01(),ae=R.properties.get("intensity"),ue=[$.x,$.y,$.z],ce=o.dM(Q,ae),pe=o.dM(q,H);return{u_lighting_ambient_color:ce,u_lighting_directional_dir:ue,u_lighting_directional_color:pe,u_ground_radiance:I_(ue,pe,ce)}})(g,x,this.style);u.setLightsUniformValues(a,S)}}}uploadCommonUniforms(a,u,g,x,S){if(this.uploadCommonLightUniforms(a,u),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const R=E.getOpacity(this.transform.pitch),O=(($,U,q,H,X,Q,ae,ue,ce,pe,Ce,ve)=>{const Fe=$.transform,Ie=U.properties.get("color-use-theme")==="none",$e=U.properties.get("color").toNonPremultipliedRenderColor(Ie?null:$.style.getLut(U.scope)).toArray01();$e[3]=H;const Le=$.frameCounter/1e3%1,[Me,Ve]=U.properties.get("vertical-range");return{u_fog_matrix:q?Fe.calculateFogTileMatrix(q):ve||$.identityMat,u_fog_range:U.getFovAdjustedRange(Fe._fov),u_fog_color:$e,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Me,Ve),Ve],u_fog_temporal_offset:Le,u_frustum_tl:X,u_frustum_tr:Q,u_frustum_br:ae,u_frustum_bl:ue,u_globe_pos:ce,u_globe_radius:pe,u_viewport:Ce,u_globe_transition:o.aj(Fe.zoom),u_is_globe:+(Fe.projection.name==="globe")}})(this,E,g,R,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.o.devicePixelRatio,this.transform.height*o.o.devicePixelRatio],x);u.setFogUniformValues(a,O)}S&&u.setCutoffUniformValues(a,S.uniformValues)}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){const a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){const a=this.context.gl,u=a.createTexture();return a.bindTexture(a.TEXTURE_2D,u),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const a=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)u[x.key]=a[x.key]||new Ko(x,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(a,u){return!(!a.is3D(!(!this.terrain||!this.terrain.enabled))||a.type!=="clip"&&a.type!=="building"&&(a.minzoom&&a.minzoom>this.transform.zoom||(this.style._clipLayerPresent||a.sourceLayer!=="building"&&a.sourceLayer!=="procedural_buildings")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(a){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[a.key];return u||(this._cachedTileFogOpacities[a.key]=u=this.style.fog.getOpacityForTile(a)),u[0]>=rt||u[1]>=rt}setupDepthForOcclusion(a,u,g){const x=this.context,S=x.gl,E=!!g;var R;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(S.TEXTURE3),a&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((R=this.depthRangeFor3D)[1]-R[0]),-1-2*R[0]/(R[1]-R[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),x.activeTexture.set(S.TEXTURE0),E||u.setTerrainUniformValues(x,g)}}function ud(m,a){let u=!1,g=null;const x=()=>{g=null,u&&(m(),g=setTimeout(x,a),u=!1)};return()=>(u=!0,g||x(),g)}class Jm{constructor(a){this._hashName=a&&encodeURIComponent(a),o.aX(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ud(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const u=Qm(a);if(this._hashName){const g=this._hashName;let x=!1;const S=location.hash.slice(1).split("&").map(E=>{const R=E.split("=")[0];return R===g?(x=!0,`${R}=${u}`):E}).filter(E=>E);return x||S.push(`${g}=${u}`),`#${S.join("&")}`}return`#${u}`}_getCurrentHash(){const a=location.hash.replace("#","");if(this._hashName){let u;return a.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(Number(g)))){const g=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(u[3]||0):a.getBearing();return a.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Qm(m,a){const u=m.getCenter(),g=Math.round(100*m.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),E=Math.round(u.lng*S)/S,R=Math.round(u.lat*S)/S,O=m.getBearing(),$=m.getPitch();let U=a?`/${E}/${R}/${g}`:`${g}/${R}/${E}`;return(O||$)&&(U+="/"+Math.round(10*O)/10),$&&(U+=`/${Math.round($)}`),U}const ph={linearity:.3,easing:o.eS(0,0,.3,1)},mu=Object.assign({deceleration:2500,maxSpeed:1400},ph),ey=Object.assign({deceleration:20,maxSpeed:1400},ph),yl=Object.assign({deceleration:1e3,maxSpeed:360},ph),ty=Object.assign({deceleration:1e3,maxSpeed:90},ph);class eg{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.o.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,u=o.o.now();for(;a.length>0&&u-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const S=gh(u.pan.mag(),g,Object.assign({},mu,a||{}));x.offset=u.pan.mult(S.amount/u.pan.mag()),x.center=this._map.transform.center,mh(x,S)}if(u.zoom){const S=gh(u.zoom,g,ey);x.zoom=this._map.transform.zoom+S.amount,mh(x,S)}if(u.bearing){const S=gh(u.bearing,g,yl);x.bearing=this._map.transform.bearing+o.aA(S.amount,-179,179),mh(x,S)}if(u.pitch){const S=gh(u.pitch,g,ty);x.pitch=this._map.transform.pitch+S.amount,mh(x,S)}if(x.zoom||x.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function mh(m,a){(!m.duration||m.duration<a.duration)&&(m.duration=a.duration,m.easing=a.easing)}function gh(m,a,u){const{maxSpeed:g,linearity:x,deceleration:S}=u,E=o.aA(m*x/(a/1e3),-g,g),R=Math.abs(E)/(S*x);return{easing:u.easing,duration:1e3*R,amount:E*(R/2)}}class to extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,u,g,x={}){const S=se(u.getCanvasContainer(),g),E=u.unproject(S);super(a,Object.assign({point:S,lngLat:E,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class vh extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,u,g){const x=a==="touchend"?g.changedTouches:g.touches,S=ee(u.getCanvasContainer(),x),E=S.map(O=>u.unproject(O)),R=S.reduce((O,$,U,q)=>O.add($.div(q.length)),new o.P(0,0));super(a,{points:S,point:R,lngLats:E,lngLat:u.unproject(R),originalEvent:g}),this._defaultPrevented=!1}}class ny extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class ry{constructor(a,u){this._map=a,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new ny(this._map,a))}mousedown(a,u){return this._mousedownPos=u,this._firePreventable(new to(a.type,this._map,a))}mouseup(a){this._map.fire(new to(a.type,this._map,a))}preclick(a){const u=new MouseEvent("preclick",a);this._map.fire(new to(u.type,this._map,u))}click(a,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(a),this._map.fire(new to(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new to(a.type,this._map,a))}mouseover(a){this._map.fire(new to(a.type,this._map,a))}mouseout(a){this._map.fire(new to(a.type,this._map,a))}touchstart(a){return this._firePreventable(new vh(a.type,this._map,a))}touchmove(a){this._map.fire(new vh(a.type,this._map,a))}touchend(a){this._map.fire(new vh(a.type,this._map,a))}touchcancel(a){this._map.fire(new vh(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dd{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new to(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new to("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new to(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class iy{constructor(a,u){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,u){this.isEnabled()&&a.shiftKey&&a.button===0&&(Y(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(a,u){if(!this._active)return;const g=u,x=this._startPos,S=this._lastPos;if(!x||!S||S.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=B("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const E=Math.min(x.x,g.x),R=Math.max(x.x,g.x),O=Math.min(x.y,g.y),$=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${O}px)`,this._box.style.width=R-E+"px",this._box.style.height=$-O+"px")})}mouseupWindow(a,u){if(!this._active)return;const g=this._startPos,x=u;if(g&&a.button===0){if(this.reset(),ne(),g.x!==x.x||g.y!==x.y)return this._map.fire(new o.z("boxzoomend",{originalEvent:a})),{cameraAnimation:S=>S.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(a,u){return this._map.fire(new o.z(a,{originalEvent:u}))}}function tp(m,a){const u={};for(let g=0;g<m.length;g++)u[m[g].identifier]=a[g];return u}class oy{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const S=new o.P(0,0);for(const E of x)S._add(E);return S.div(x.length)}(u),this.touches=tp(g,u)))}touchmove(a,u,g){if(this.aborted||!this.centroid)return;const x=tp(g,u);for(const S in this.touches){const E=x[S];(!E||E.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(a,u,g){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class gu{constructor(a){this.singleTap=new oy(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,u,g){this.singleTap.touchstart(a,u,g)}touchmove(a,u,g){this.singleTap.touchmove(a,u,g)}touchend(a,u,g){const x=this.singleTap.touchend(a,u,g);if(x){const S=a.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(x)<30;if(S&&E||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class ay{constructor(){this._zoomIn=new gu({numTouches:1,numTaps:2}),this._zoomOut=new gu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,u,g){this._zoomIn.touchstart(a,u,g),this._zoomOut.touchstart(a,u,g)}touchmove(a,u,g){this._zoomIn.touchmove(a,u,g),this._zoomOut.touchmove(a,u,g)}touchend(a,u,g){const x=this._zoomIn.touchend(a,u,g),S=this._zoomOut.touchend(a,u,g);return x?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(x)},{originalEvent:a})}):S?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(S)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const tg={0:1,2:2},ng={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class _h{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,u){return!1}_move(a,u){return{}}mousedown(a,u){if(this._lastPoint)return;const g=de(a);this._correctButton(a,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(a,u){const g=this._lastPoint;if(g){if(a.preventDefault(),this._eventButton!=null&&function(x,S){const E=tg[S];return x.buttons===void 0||(x.buttons&E)!==E}(a,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(a){this._lastPoint&&de(a)===this._eventButton&&(this._moved&&ne(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sy extends _h{mousedown(a,u){super.mousedown(a,u),this._lastPoint&&(this._active=!0)}_correctButton(a,u){return u===0&&!a.ctrlKey}_move(a,u){return{around:u,panDelta:u.sub(a)}}}class rg extends _h{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?ng[a.pitchRotateKey]:void 0}_correctButton(a,u){return this._pitchRotateKey?u===0&&a[this._pitchRotateKey]:u===0&&a.ctrlKey||u===2}_move(a,u){const g=.8*(u.x-a.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class ly extends _h{constructor(a){super(a),this._pitchRotateKey=a.pitchRotateKey?ng[a.pitchRotateKey]:void 0}_correctButton(a,u){return this._pitchRotateKey?u===0&&a[this._pitchRotateKey]:u===0&&a.ctrlKey||u===2}_move(a,u){const g=-.5*(u.y-a.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(a){this._pitchRotateKey||a.preventDefault()}}class Qb{constructor(a,u){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),o.aX(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(a,u,g){return this._calculateTransform(a,u,g)}touchmove(a,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!o.eT())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,u,g)}}touchend(a,u,g){this._calculateTransform(a,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,u,g){g.length>0&&(this._active=!0);const x=tp(g,u),S=new o.P(0,0),E=new o.P(0,0);let R=0;for(const $ in x){const U=x[$],q=this._touches[$];q&&(S._add(U),E._add(U.sub(q)),R++,x[$]=U)}if(this._touches=x,R<this._minTouches||!E.mag())return;const O=E.div(R);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(R),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class ig{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,u,g){return{}}touchstart(a,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(a,u,g){const x=this._firstTwoTouches;if(!x)return;a.preventDefault();const[S,E]=x,R=np(g,u,S),O=np(g,u,E);if(!R||!O)return;const $=this._aroundCenter?null:R.add(O).div(2);return this._move([R,O],$,a)}touchend(a,u,g){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,E=np(g,u,x),R=np(g,u,S);E&&R||(this._active&&ne(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function np(m,a,u){for(let g=0;g<m.length;g++)if(m[g].identifier===u)return a[g]}function cy(m,a){return Math.log2(m/a)}class e1 extends ig{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,u){const g=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(cy(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cy(this._distance,g),pinchAround:u}}}function uy(m,a){return 180*m.angleWith(a)/Math.PI}class t1 extends ig{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,u){const g=this._vector;if(this._vector=a[0].sub(a[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:uy(this._vector,g),pinchAround:u}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const x=uy(a,g);return Math.abs(x)<u}}function og(m){return Math.abs(m.y)>Math.abs(m.x)}class n1 extends ig{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,og(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,u,g){const x=this._lastPoints;if(!x)return;const S=a[0].sub(x[0]),E=a[1].sub(x[1]);return this._map._cooperativeGestures&&!o.eT()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,E,g.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(S.y+E.y)/2*-.5})}gestureBeginsVertically(a,u,g){if(this._valid!==void 0)return this._valid;const x=a.mag()>=2,S=u.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const E=a.y>0==u.y>0;return og(a)&&og(u)&&E}}const r1={panStep:100,bearingStep:15,pitchStep:10};class i1{constructor(){const a=r1;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let u=0,g=0,x=0,S=0,E=0;switch(a.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:a.shiftKey?g=-1:(a.preventDefault(),S=-1);break;case 39:a.shiftKey?g=1:(a.preventDefault(),S=1);break;case 38:a.shiftKey?x=1:(a.preventDefault(),E=-1);break;case 40:a.shiftKey?x=-1:(a.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:R=>{const O=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:o1,zoom:u?Math.round(O)+u*(a.shiftKey?2:1):O,bearing:R.getBearing()+g*this._bearingStep,pitch:R.getPitch()+x*this._pitchStep,offset:[-S*this._panStep,-E*this._panStep],center:R.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function o1(m){return m*(2-m)}const a1=4.000244140625,ET=1/450;class TT{constructor(a,u){this._map=a,this._el=a.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ET,o.aX(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||o.eT()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const g=o.o.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%a1==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),a.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=a,this._delta-=u,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=se(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;this._type==="wheel"&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>a1?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&U!==0&&(U=1/U);const q=u(),H=Math.pow(2,q),X=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):H;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(X*U))),this._type==="wheel"&&(this._startZoom=q,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,S=this._easing;let E,R=!1;if(this._type==="wheel"&&x&&S){const $=Math.min((o.o.now()-this._lastWheelEventTime)/200,1),U=S($);E=o.ak(x,g,U),$<1?this._frameId||(this._frameId=!0):R=!0}else E=g,R=!0;this._active=!0,R&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let O=E-u();return O*this._lastDelta<0&&(O=0),{noInertia:!0,needsRenderFrame:!R,zoomDelta:O,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let u=o.eU;if(this._prevEase){const g=this._prevEase,x=(o.o.now()-g.start)/g.duration,S=g.easing(x+.01)-g.easing(x),E=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-E*E);u=o.eS(E,R,.25,1)}return this._prevEase={start:o.o.now(),duration:a,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class po{constructor(a,u){this._clickZoom=a,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class s1{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,u){return a.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(a.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class IT{constructor(){this._tap=new gu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,u,g){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(a,u,g))}touchmove(a,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,a.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(a,u,g)}touchend(a,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(a,u,g)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class PT{constructor(a,u,g){this._el=a,this._mousePan=u,this._touchPan=g}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class MT{constructor(a,u,g){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class rp{constructor(a,u,g,x){this._el=a,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ip=m=>m.zoom||m.drag||m.pitch||m.rotate;class dy extends o.z{}class ag{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,u){const g=o.av([],u,a);this.radius=o.ag(g[2]<0?o.eW([],g,this.constants):[g[0],g[1],0])}projectRay(a){o.eW(a,a,this.constants),o.aw(a,a),o.eX(a,a,this.constants);const u=o.c4([],a,this.radius);if(u[2]>0){const g=o.c4([],[0,0,1],o.bI(u,[0,0,1])),x=o.c4([],o.aw([],[u[0],u[1],0]),this.radius),S=o.d7([],u,o.c4([],o.av([],o.d7([],x,g),u),2));u[0]=S[0],u[1]=S[1]}return u}}function xl(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class sg{constructor(a,u){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new eg(a),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ag,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),o.aX(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,E]of this._listeners){const R=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(S,R,E)}}destroy(){for(const[a,u,g]of this._listeners){const x=a===document?this.handleWindowEvent:this.handleEvent;a.removeEventListener(u,x,g)}}_addDefaultHandlers(a){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new ry(u,a));const x=u.boxZoom=new iy(u,a);this._add("boxZoom",x);const S=new ay,E=new s1;u.doubleClickZoom=new po(E,S),this._add("tapZoom",S),this._add("clickZoom",E);const R=new IT;this._add("tapDragZoom",R);const O=u.touchPitch=new n1(u);this._add("touchPitch",O);const $=new rg(a),U=new ly(a);u.dragRotate=new MT(a,$,U),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const q=new sy(a),H=new Qb(u,a);u.dragPan=new PT(g,q,H),this._add("mousePan",q),this._add("touchPan",H,["touchZoom","touchRotate"]);const X=new t1,Q=new e1;u.touchZoomRotate=new rp(g,Q,X,R),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),this._add("blockableMapEvent",new dd(u));const ae=u.scrollZoom=new TT(u,this);this._add("scrollZoom",ae,["mousePan"]);const ue=u.keyboard=new i1;this._add("keyboard",ue);for(const ce of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[ce]&&u[ce].enable(a[ce])}_add(a,u,g){this._handlers.push({handlerName:a,handler:u,allowed:g}),this._handlersById[a]=u}stop(a){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ip(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,u,g){for(const x in a)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const u=[];for(const g of a)this._el.contains(g.target)&&u.push(g);return u}handleEvent(a,u){this._updatingCamera=!0;const g=a.type==="renderFrame",x=g?void 0:a,S={needsRenderFrame:!1},E={},R={},O=a.touches?this._getMapTouches(a.touches):void 0,$=O?ee(this._el,O):g?void 0:se(this._el,a);for(const{handlerName:H,handler:X,allowed:Q}of this._handlers){if(!X.isEnabled())continue;let ae;this._blockedByActive(R,Q,H)?X.reset():X[u||a.type]&&(ae=X[u||a.type](a,$,O),this.mergeHandlerResult(S,E,ae,H,x),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()),(ae||X.isActive())&&(R[H]=X)}const U={};for(const H in this._previousActiveHandlers)R[H]||(U[H]=x);this._previousActiveHandlers=R,(Object.keys(U).length||xl(S))&&(this._changes.push([S,E,U]),this._triggerRenderFrame()),(Object.keys(R).length||xl(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=S;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(a,u,g,x,S){if(!g)return;Object.assign(a,g);const E={handlerName:x,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(u.zoom=E),g.panDelta!==void 0&&(u.drag=E),g.pitchDelta!==void 0&&(u.pitch=E),g.bearingDelta!==void 0&&(u.rotate=E)}_applyChanges(){const a={},u={},g={};for(const[x,S,E]of this._changes)x.panDelta&&(a.panDelta=(a.panDelta||new o.P(0,0))._add(x.panDelta)),x.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(a.around=x.around),x.aroundCoord!==void 0&&(a.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(a.pinchAround=x.pinchAround),x.noInertia&&(a.noInertia=x.noInertia),Object.assign(u,S),Object.assign(g,E);this._updateMapTransform(a,u,g),this._changes=[]}_updateMapTransform(a,u,g){const x=this._map,S=x.transform,E=pe=>[pe.x,pe.y,pe.z];if((pe=>{const Ce=this._eventsInProgress.drag;return Ce&&!this._handlersById[Ce.handlerName].isActive()})()&&!xl(a)){const pe=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),pe!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&x._stop(!0),!xl(a))return void this._fireEvents(u,g,!0);let{panDelta:R,zoomDelta:O,bearingDelta:$,pitchDelta:U,around:q,aroundCoord:H,pinchAround:X}=a;S._isCameraConstrained&&(O>0&&(O=0),S._isCameraConstrained=!1),X!==void 0&&(q=X),(O||(pe=>u[pe]&&!this._eventsInProgress[pe])("drag"))&&q&&(this._dragOrigin=E(S.pointCoordinate3D(q)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",x._stop(!0),q=q||x.transform.centerPoint,$&&(S.bearing+=$),U&&(S.pitch+=U),S._updateCameraState();const Q=[0,0,0];if(R)if(S.projection.name==="mercator"){const pe=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(q).dir),Ce=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(q.sub(R)).dir);Q[0]=Ce[0]-pe[0],Q[1]=Ce[1]-pe[1]}else{const pe=S.pointCoordinate(q);if(S.projection.name==="globe"){R=R.rotate(-S.angle);const Ce=S._pixelsPerMercatorPixel/S.worldSize;Q[0]=-R.x*o.eV(o.a_(pe.y))*Ce,Q[1]=-R.y*o.eV(S.center.lat)*Ce}else{const Ce=S.pointCoordinate(q.sub(R));pe&&Ce&&(Q[0]=Ce.x-pe.x,Q[1]=Ce.y-pe.y)}}const ae=S.zoom,ue=[0,0,0];if(O){const pe=E(H||S.pointCoordinate3D(q)),Ce={dir:o.aw([],o.av([],pe,S._camera.position))};if(Ce.dir[2]<0){const ve=S.zoomDeltaToMovement(pe,O);o.c4(ue,Ce.dir,ve)}}const ce=o.d7(Q,Q,ue);S._translateCameraConstrained(ce),O&&Math.abs(S.zoom-ae)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(u,g,!0)}_fireEvents(a,u,g){const x=ip(this._eventsInProgress),S=ip(a),E={};for(const U in a){const{originalEvent:q}=a[U];this._eventsInProgress[U]||(E[`${U}start`]=q),this._eventsInProgress[U]=a[U]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const U in E)this._fireEvent(U,E[U]);S&&this._fireEvent("move",S.originalEvent);for(const U in a){const{originalEvent:q}=a[U];this._fireEvent(U,q)}const R={};let O;for(const U in this._eventsInProgress){const{handlerName:q,originalEvent:H}=this._eventsInProgress[U];this._handlersById[q].isActive()||(delete this._eventsInProgress[U],O=u[q]||H,R[`${U}end`]=O)}for(const U in R)this._fireEvent(U,R[U]);const $=ip(this._eventsInProgress);if(g&&(x||S)&&!$){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;U?(q(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:O})):(this._map.fire(new o.z("moveend",{originalEvent:O})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,u){this._map.fire(new o.z(a,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new dy("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Bo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class nc extends o.E{constructor(a,u){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,o.aX(["_renderFrameCallback"],this)}getCenter(){return new o.aS(this.transform.center.lng,this.transform.center.lat)}setCenter(a,u){return this.jumpTo({center:a},u)}panBy(a,u,g){return a=o.P.convert(a).mult(-1),this.panTo(this.transform.center,Object.assign({offset:a},u),g)}panTo(a,u,g){return this.easeTo(Object.assign({center:a},u),g)}getZoom(){return this.transform.zoom}setZoom(a,u){return this.jumpTo({zoom:a},u),this}zoomTo(a,u,g){return this.easeTo(Object.assign({zoom:a},u),g)}zoomIn(a,u){return this.zoomTo(this.getZoom()+1,a,u),this}zoomOut(a,u){return this.zoomTo(this.getZoom()-1,a,u),this}getBearing(){return this.transform.bearing}setBearing(a,u){return this.jumpTo({bearing:a},u),this}getPadding(){return this.transform.padding}setPadding(a,u){return this.jumpTo({padding:a},u),this}rotateTo(a,u,g){return this.easeTo(Object.assign({bearing:a},u),g)}resetNorth(a,u){return this.rotateTo(0,Object.assign({duration:1e3},a),u),this}resetNorthPitch(a,u){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},a),u),this}snapToNorth(a,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,u):this}getPitch(){return this.transform.pitch}setPitch(a,u){return this.jumpTo({pitch:a},u),this}cameraForBounds(a,u){a=o.aI.convert(a);const g=u&&u.bearing||0,x=u&&u.pitch||0,S=a.getNorthWest(),E=a.getSouthEast();return this._cameraForBounds(this.transform,S,E,g,x,u)}_extendPadding(a){const u={top:0,right:0,bottom:0,left:0};return a==null?Object.assign({},u,this.transform.padding):typeof a=="number"?{top:a,bottom:a,right:a,left:a}:Object.assign({},u,a)}_extendCameraOptions(a){return(a=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=this._extendPadding(a.padding),a}_minimumAABBFrustumDistance(a,u){const g=u.max[0]-u.min[0],x=u.max[1]-u.min[1];return g/x>a.aspect?g/(2*Math.tan(.5*a.fovX)*a.aspect):x/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,u,g,x,S,E){const R=a.clone(),O=this._extendCameraOptions(E);R.bearing=x,R.pitch=S;const $=o.aS.convert(u),U=o.aS.convert(g),q=.5*($.lat+U.lat),H=.5*($.lng+U.lng),X=o.eY(q,H),Q=o.aw([],X),ae=o.aw([],o.bH([],Q,[0,1,0])),ue=o.bH([],ae,Q),ce=[ae[0],ae[1],ae[2],0,ue[0],ue[1],ue[2],0,Q[0],Q[1],Q[2],0,0,0,0,1],pe=[X,o.eY($.lat,$.lng),o.eY(U.lat,$.lng),o.eY(U.lat,U.lng),o.eY($.lat,U.lng),o.eY(q,$.lng),o.eY(q,U.lng),o.eY($.lat,H),o.eY(U.lat,H)];let Ce=o.d8.fromPoints(pe.map(gt=>[o.bI(ae,gt),o.bI(ue,gt),o.bI(Q,gt)]));const ve=o.af([],Ce.center,ce);o.eZ(ve)===0&&o.e_(ve,0,0,1),o.aw(ve,ve),o.c4(ve,ve,o.aD),R.center=o.e$(ve);const Fe=R.getWorldToCameraMatrix(),Ie=o.bk(new Float64Array(16),Fe);Ce=o.d8.applyTransform(Ce,o.aB([],Fe,ce));const $e=this._extendAABB(Ce,R,O,x);if(!$e)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ce=$e,o.af(ve,ve,Fe);const Le=.5*(Ce.max[2]-Ce.min[2]),Me=this._minimumAABBFrustumDistance(R,Ce),Ve=o.c4([],[0,0,1],Le),st=o.d7(Ve,ve,Ve),nt=Me+(R.pitch===0?0:o.bF(ve,st)),Et=R.globeCenterInViewSpace,mt=o.av([],ve,[Et[0],Et[1],Et[2]]);o.aw(mt,mt),o.c4(mt,mt,nt);const Lt=o.d7([],ve,mt);o.af(Lt,Lt,Ie);const ln=o.eL/o.aD,ht=o.ag(Lt),Qe=o.ce(Math.max(ht*ln-o.eL,Number.EPSILON),0),kt=Math.min(R.zoomFromMercatorZAdjusted(Qe),O.maxZoom);return kt>.5*(o.cZ+o.cK)?(R.setProjection({name:"mercator"}),R.zoom=kt,this._cameraForBounds(R,u,g,x,S,E)):{center:R.center,zoom:kt,bearing:x,pitch:S}}_extendAABB(a,u,g,x){const S=.5*((g.padding.left||0)+(g.padding.right||0)),E=.5*((g.padding.top||0)+(g.padding.bottom||0)),R=E,O=S,$=S,U=E,q=u.width-(O+$),H=u.height-(R+U),X=o.av([],a.max,a.min),Q=Math.min(q/X[0],H/X[1]),ae=Math.min(u.scaleZoom(u.scale*Q),g.maxZoom);if(isNaN(ae))return null;const ue=u.scale/u.zoomScale(ae),ce=new o.d8([a.min[0]-O*ue,a.min[1]-U*ue,a.min[2]],[a.max[0]+$*ue,a.max[1]+R*ue,a.max[2]]),pe=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new o.P(g.offset.x,g.offset.y):o.P.convert(g.offset)).rotate(-o.an(x));return ce.center[0]-=pe.x*ue,ce.center[1]+=pe.y*ue,ce}queryTerrainElevation(a,u){const g=this.transform.elevation;return g?(u=Object.assign({},{exaggerated:!0},u),g.getAtPoint(o.ae.fromLngLat(a),null,u.exaggerated)):null}_cameraForBounds(a,u,g,x,S,E){if(a.projection.name==="globe")return this._cameraForBoundsOnGlobe(a,u,g,x,S,E);const R=a.clone(),O=this._extendCameraOptions(E);R.bearing=x,R.pitch=S;const $=o.aS.convert(u),U=o.aS.convert(g),q=new o.aS($.lng,U.lat),H=new o.aS(U.lng,$.lat),X=R.project($),Q=R.project(U),ae=this.queryTerrainElevation($),ue=this.queryTerrainElevation(U),ce=this.queryTerrainElevation(q),pe=this.queryTerrainElevation(H),Ce=[[X.x,X.y,Math.min(ae||0,ue||0,ce||0,pe||0)],[Q.x,Q.y,Math.max(ae||0,ue||0,ce||0,pe||0)]];let ve=o.d8.fromPoints(Ce);const Fe=R.getWorldToCameraMatrix(),Ie=o.bk(new Float64Array(16),Fe);ve=o.d8.applyTransform(ve,Fe);const $e=this._extendAABB(ve,R,O,x);if(!$e)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ve=$e;const Le=.5*o.av([],ve.max,ve.min)[2],Me=this._minimumAABBFrustumDistance(R,ve),Ve=[0,0,1,0];o.aC(Ve,Ve,Fe),o.f0(Ve,Ve);const st=o.c4([],Ve,Me+Le),nt=o.d7([],ve.center,st);o.af(ve.center,ve.center,Ie),o.af(nt,nt,Ie);const Et=R.unproject(new o.P(ve.center[0],ve.center[1])),mt=o.f1(R.projection,Et),Lt=Math.pow(2,mt),ln=Math.min(R._zoomFromMercatorZ(nt[2]*R.pixelsPerMeter*Lt/R.worldSize),O.maxZoom);return R.mercatorFromTransition&&ln<.5*(o.cZ+o.cK)?(R.setProjection({name:"globe"}),R.zoom=ln,this._cameraForBounds(R,u,g,x,S,E)):{center:Et,zoom:ln,bearing:x,pitch:S}}fitBounds(a,u,g){const x=this.cameraForBounds(a,u);return this._fitInternal(x,u,g)}fitScreenCoordinates(a,u,g,x,S){const E=o.P.convert(a),R=o.P.convert(u),O=new o.P(Math.min(E.x,R.x),Math.min(E.y,R.y)),$=new o.P(Math.max(E.x,R.x),Math.max(E.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,R))return this;const U=this.transform.pointLocation3D(O),q=this.transform.pointLocation3D($),H=this.transform.pointLocation3D(new o.P(O.x,$.y)),X=this.transform.pointLocation3D(new o.P($.x,O.y)),Q=[Math.min(U.lng,q.lng,H.lng,X.lng),Math.min(U.lat,q.lat,H.lat,X.lat)],ae=[Math.max(U.lng,q.lng,H.lng,X.lng),Math.max(U.lat,q.lat,H.lat,X.lat)],ue=x&&x.pitch?x.pitch:this.getPitch(),ce=this._cameraForBounds(this.transform,Q,ae,g,ue,x);return this._fitInternal(ce,x,S)}_fitInternal(a,u,g){return a?(u=Object.assign(a,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(a,u){this.stop();const g=a.preloadOnly?this.transform.clone():this.transform;let x=!1,S=!1,E=!1;"zoom"in a&&g.zoom!==+a.zoom&&(x=!0,g.zoom=+a.zoom),a.center!==void 0&&(g.center=o.aS.convert(a.center)),"bearing"in a&&g.bearing!==+a.bearing&&(S=!0,g.bearing=+a.bearing),"pitch"in a&&g.pitch!==+a.pitch&&(E=!0,g.pitch=+a.pitch);const R=typeof a.padding=="number"?this._extendPadding(a.padding):a.padding;if(a.padding!=null&&!g.isPaddingEqual(R))if(a.retainPadding===!1){const O=g.clone();O.padding=R,g.setLocationAtPoint(g.center,O.centerPoint)}else g.padding=R;return a.preloadOnly?(this._preloadTiles(g),this):(this.fire(new o.z("movestart",u)).fire(new o.z("move",u)),x&&this.fire(new o.z("zoomstart",u)).fire(new o.z("zoom",u)).fire(new o.z("zoomend",u)),S&&this.fire(new o.z("rotatestart",u)).fire(new o.z("rotate",u)).fire(new o.z("rotateend",u)),E&&this.fire(new o.z("pitchstart",u)).fire(new o.z("pitch",u)).fire(new o.z("pitchend",u)),this.fire(new o.z("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Bo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return o.w(Bo),this;this.stop();const x=g.zoom,S=g.pitch,E=g.bearing;g.setFreeCameraOptions(a);const R=x!==g.zoom,O=S!==g.pitch,$=E!==g.bearing;return this.fire(new o.z("movestart",u)).fire(new o.z("move",u)),R&&this.fire(new o.z("zoomstart",u)).fire(new o.z("zoom",u)).fire(new o.z("zoomend",u)),$&&this.fire(new o.z("rotatestart",u)).fire(new o.z("rotate",u)).fire(new o.z("rotateend",u)),O&&this.fire(new o.z("pitchstart",u)).fire(new o.z("pitch",u)).fire(new o.z("pitchend",u)),this.fire(new o.z("moveend",u)),this}easeTo(a,u){this._stop(!1,a.easeId),((a=Object.assign({offset:[0,0],duration:500,easing:o.eU},a)).animate===!1||this._prefersReducedMotion(a))&&(a.duration=0);const g=this.transform,x=this.getZoom(),S=this.getBearing(),E=this.getPitch(),R=this.getPadding(),O="zoom"in a?+a.zoom:x,$="bearing"in a?this._normalizeBearing(a.bearing,S):S,U="pitch"in a?+a.pitch:E,q=this._extendPadding(a.padding),H=o.P.convert(a.offset);let X,Q,ae;if(g.projection.name==="globe"){const Ve=o.ae.fromLngLat(g.center),st=H.rotate(-g.angle);Ve.x+=st.x/g.worldSize,Ve.y+=st.y/g.worldSize;const nt=Ve.toLngLat(),Et=o.aS.convert(a.center||nt);this._normalizeCenter(Et),X=g.centerPoint.add(st),Q=new o.P(Ve.x,Ve.y).mult(g.worldSize),ae=new o.P(o.aF(Et.lng),o.aJ(Et.lat)).mult(g.worldSize).sub(Q)}else{X=g.centerPoint.add(H);const Ve=g.pointLocation(X),st=o.aS.convert(a.center||Ve);this._normalizeCenter(st),Q=g.project(Ve),ae=g.project(st).sub(Q)}const ue=g.zoomScale(O-x);let ce,pe;a.around&&(ce=o.aS.convert(a.around),pe=g.locationPoint(ce));const Ce=this._zooming||O!==x,ve=this._rotating||S!==$,Fe=this._pitching||U!==E,Ie=!g.isPaddingEqual(q),$e=a.retainPadding===!1?g.clone():g,Le=Ve=>st=>{if(Ce&&(Ve.zoom=o.ak(x,O,st)),ve&&(Ve.bearing=o.ak(S,$,st)),Fe&&(Ve.pitch=o.ak(E,U,st)),Ie&&($e.interpolatePadding(R,q,st),X=$e.centerPoint.add(H)),ce)Ve.setLocationAtPoint(ce,pe);else{const nt=Ve.zoomScale(Ve.zoom-x),Et=O>x?Math.min(2,ue):Math.max(.5,ue),mt=Math.pow(Et,1-st),Lt=Ve.unproject(Q.add(ae.mult(st*mt)).mult(nt));Ve.setLocationAtPoint(Ve.renderWorldCopies?Lt.wrap():Lt,X)}return a.preloadOnly||this._fireMoveEvents(u),Ve};if(a.preloadOnly){const Ve=this._emulate(Le,a.duration,g);return this._preloadTiles(Ve),this}const Me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ce,this._rotating=ve,this._pitching=Fe,this._padding=Ie,this._easeId=a.easeId,this._prepareEase(u,a.noMoveStart,Me),this._ease(Le(g),Ve=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,Ve)},a),this}_prepareEase(a,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new o.z("movestart",a)),this._zooming&&!g.zooming&&this.fire(new o.z("zoomstart",a)),this._rotating&&!g.rotating&&this.fire(new o.z("rotatestart",a)),this._pitching&&!g.pitching&&this.fire(new o.z("pitchstart",a))}_fireMoveEvents(a){this.fire(new o.z("move",a)),this._zooming&&this.fire(new o.z("zoom",a)),this._rotating&&this.fire(new o.z("rotate",a)),this._pitching&&this.fire(new o.z("pitch",a))}_afterEase(a,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.z("zoomend",a)),x&&this.fire(new o.z("rotateend",a)),S&&this.fire(new o.z("pitchend",a)),this.fire(new o.z("moveend",a))}flyTo(a,u){if(this._prefersReducedMotion(a)){const gt=o.aH(a,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(gt,u)}this.stop(),a=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:o.eU},a);const g=this.transform,x=this.getZoom(),S=this.getBearing(),E=this.getPitch(),R=this.getPadding(),O="zoom"in a?o.aA(+a.zoom,g.minZoom,g.maxZoom):x,$="bearing"in a?this._normalizeBearing(a.bearing,S):S,U="pitch"in a?+a.pitch:E,q=this._extendPadding(a.padding),H=g.zoomScale(O-x),X=o.P.convert(a.offset);let Q=g.centerPoint.add(X);const ae=g.pointLocation(Q),ue=o.aS.convert(a.center||ae);this._normalizeCenter(ue);const ce=g.project(ae),pe=g.project(ue).sub(ce);let Ce=a.curve;const ve=Math.max(g.width,g.height),Fe=ve/H,Ie=pe.mag();if("minZoom"in a){const gt=o.aA(Math.min(a.minZoom,x,O),g.minZoom,g.maxZoom),Kt=ve/g.zoomScale(gt-x);Ce=Math.sqrt(Kt/Ie*2)}const $e=Ce*Ce;function Le(gt){const Kt=(Fe*Fe-ve*ve+(gt?-1:1)*$e*$e*Ie*Ie)/(2*(gt?Fe:ve)*$e*Ie);return Math.log(Math.sqrt(Kt*Kt+1)-Kt)}function Me(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function Ve(gt){return(Math.exp(gt)+Math.exp(-gt))/2}const st=Le(0);let nt=function(gt){return Ve(st)/Ve(st+Ce*gt)},Et=function(gt){return ve*((Ve(st)*(Me(Kt=st+Ce*gt)/Ve(Kt))-Me(st))/$e)/Ie;var Kt},mt=(Le(1)-st)/Ce;if(Math.abs(Ie)<1e-6||!isFinite(mt)){if(Math.abs(ve-Fe)<1e-6)return this.easeTo(a,u);const gt=Fe<ve?-1:1;mt=Math.abs(Math.log(Fe/ve))/Ce,Et=function(){return 0},nt=function(Kt){return Math.exp(gt*Ce*Kt)}}a.duration="duration"in a?+a.duration:1e3*mt/("screenSpeed"in a?+a.screenSpeed/Ce:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const Lt=S!==$,ln=U!==E,ht=!g.isPaddingEqual(q),Qe=a.retainPadding===!1?g.clone():g,kt=gt=>Kt=>{const pn=Kt*mt,Nn=1/nt(pn);gt.zoom=Kt===1?O:x+gt.scaleZoom(Nn),Lt&&(gt.bearing=o.ak(S,$,Kt)),ln&&(gt.pitch=o.ak(E,U,Kt)),ht&&(Qe.interpolatePadding(R,q,Kt),Q=Qe.centerPoint.add(X));const an=Kt===1?ue:gt.unproject(ce.add(pe.mult(Et(pn))).mult(Nn));return gt.setLocationAtPoint(gt.renderWorldCopies?an.wrap():an,Q),gt._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(u),gt};if(a.preloadOnly){const gt=this._emulate(kt,a.duration,g);return this._preloadTiles(gt),this}return this._zooming=!0,this._rotating=Lt,this._pitching=ln,this._padding=ht,this._prepareEase(u,!1),this._ease(kt(g),()=>this._afterEase(u),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(a){}_cancelRenderFrame(a){}_stop(a,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!a){const g=this.handlers;g&&g.stop(!1)}return this}_ease(a,u,g){g.animate===!1||g.duration===0?(a(1),u()):(this._easeStart=o.o.now(),this._easeOptions=g,this._onEaseFrame=a,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((o.o.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,u){a=o.bS(a,-180,180);const g=Math.abs(a-u);return Math.abs(a-360-u)<g&&(a-=360),Math.abs(a+360-u)<g&&(a+=360),a}_normalizeCenter(a){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=a.lng-u.center.lng;a.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&o.o.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,u,g){const x=Math.ceil(15*u/1e3),S=[],E=a(g.clone());for(let R=0;R<=x;R++){const O=E(R/x);S.push(O.clone())}return S}_preloadTiles(a,u){}}class yh{constructor(a={}){this.options=a,o.aX(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const u=this.options&&this.options.compact,g=a._getUIString("AttributionControl.ToggleAttribution");this._map=a,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const x=B("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",g),this._innerContainer=B("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(a){const g=u.reduce((x,S,E)=>(S.value&&(x+=`${S.key}=${S.value}${E<u.length-1?"&":""}`),x),"?");a.href=`${o.e.FEEDBACK_URL}/${g}#${Qm(this._map,!0)}`,a.rel="noopener nofollow"}}_updateData(a){!a||(a.dataType!=="source"||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility")&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._mergedSourceCaches;for(const x in u){const S=u[x];if(S.used){const E=S.getSource();E.attribution&&a.indexOf(E.attribution)<0&&a.push(E.attribution)}}a.sort((x,S)=>x.length-S.length),a=a.filter((x,S)=>{for(let E=S+1;E<a.length;E++)if(a[E].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const g=a.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,a.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class op{constructor(){o.aX(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=B("div","mapboxgl-ctrl");const u=B("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(const u in a){const g=a[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const u=a[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class hy{constructor(){o.aX(["_onIndoorUpdate"],this)}onAdd(a){return this._map=a,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("selector-update",u=>this._onIndoorUpdate(u)),this._container}_createButton(a,u){const g=B("button",a,this._container);return g.type="button",g.addEventListener("click",u),g}_createSeparator(){return B("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(a,u){this._map&&(a.setAttribute("aria-label",u),a.textContent=u)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("selector-update",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(a){if(!a||!a.floors)return this._model=a,void(this._container.style.display="none");const u=this._model;this._model=a,this._container.style.display="inline-block",this._container.style.borderRadius="8px",u&&Array.from(this._container.children).forEach(g=>g.remove()),a.floors.length>0&&(this.addBuildingsToggleButton(),this.addCurrentFloors(a.floors,a.activeFloorsVisible),this._updateBuildingsButtonState())}addBuildingsToggleButton(){const a=this._createButton("mapboxgl-ctrl-buildings-toggle",()=>{const u=this._map;this._model&&u&&u._setIndoorActiveFloorsVisibility(!this._model.activeFloorsVisible)});B("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden","true"),a.classList.add("mapboxgl-ctrl-level-button","mapboxgl-ctrl-buildings-toggle"),this._model&&!this._model.activeFloorsVisible&&a.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(a),this._createSeparator()}_updateBuildingsButtonState(){const a=this._container.querySelector(".mapboxgl-ctrl-buildings-toggle");a&&this._model&&(this._model.activeFloorsVisible?a.classList.remove("mapboxgl-ctrl-level-button-selected"):a.classList.add("mapboxgl-ctrl-level-button-selected"))}addCurrentFloors(a,u){for(let g=0;g<a.length;g++){const x=a[g],S=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(x.id)});this._setButtonTitle(S,x.zIndex.toString()),this._model&&x.id===this._model.selectedFloorId&&u&&S.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(S),g<a.length-1&&this._createSeparator()}}}class l1{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const u=++this._id;return this._queue.push({callback:a,id:u,cancelled:!1}),u}remove(a){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===a)return void(x.cancelled=!0)}run(a=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class ap{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const u=o.dC((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,u,g){this._start=this.getValue(u),this._end=a,this._startTime=u,this._endTime=u+g}}const RT={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class c1 extends o.z{constructor(a,u,g,x){const{point:S,lngLat:E,originalEvent:R,target:O}=a;super(a.type,{point:S,lngLat:E,originalEvent:R,target:O}),this.preventDefault=()=>{a.preventDefault()},this.id=u,this.interaction=g,this.feature=x}}class fy{constructor(a){this.map=a,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(a,u){if(this.typeById.has(a))throw new Error(`Interaction id "${a}" already exists.`);const g=u.filter;let x=u.type;g&&this.filters.set(a,o.b5(g)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const S=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(a,u)):S.size===0&&this.map.on(x,this.handleType),S.size===0&&this.interactionsByType.set(x,S),S.set(a,u),this.typeById.set(a,x)}get(a){const u=this.typeById.get(a);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(a):void 0}remove(a){const u=this.typeById.get(a);if(!u)return;this.typeById.delete(a),this.filters.delete(a);const g=this.interactionsByType.get(u);g&&(g.delete(a),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(a),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(a,u){const g=[];for(const[x,S]of u)S.target&&g.push({targetId:x,target:S.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(a,g,this.map.transform)}handleMove(a){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(a.point,Array.from(this.delegatedInteractions).reverse());u.length&&(a.type="mouseenter",this.handleType(a,u));const g=new Map;for(const[x,{feature:S}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||g.set(S.id,S);g.size&&(a.type="mouseleave",this.handleType(a,Array.from(g.values())))}handleOut(a){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(a.type="mouseleave",this.handleType(a,u)),this.hoveredFeatures.clear()}handleType(a,u){const g=a.type==="mouseenter";if(g&&!this.interactionsByType.has(a.type))return void o.w("mouseenter interaction required for mouseleave to work.");const x=Array.from(this.interactionsByType.get(a.type)).reverse(),S=!!u;u=u||this.queryTargets(a.point,x);let E=!1;const R=new Set;for(const O of u){for(const[$,U]of x){if(!U.target)continue;const q=O.variants?O.variants[$]:null;if(q){for(const H of q){if(ki(H,O,R,$))continue;const X=new o.dw(O,H),Q=Li(H,O,$);S&&X.id!==void 0&&(X.state=this.map.getFeatureState(X));const ae=g?this.prevHoveredFeatures.get(Q):null,ue=new c1(a,$,U,X),ce=ae?ae.stop:U.handler(ue);if(g&&this.hoveredFeatures.set(Q,{feature:O,stop:ce}),ce!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(const[O,$]of x){const{handler:U,target:q}=$;if(!q&&U(new c1(a,O,$,null))!==!1)break}}}function py(m,a){if(Array.isArray(m)&&Array.isArray(a)){const u=new Set(m),g=new Set(a);return u.size===g.size&&m.every(x=>g.has(x))}return o.bx(m,a)}const lg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},cg={showCompass:!0,showZoom:!0,visualizePitch:!1};class sp{constructor(a,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new rg({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,g&&(this.mousePitch=new ly({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),o.aX(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(a,u){this.mouseRotate.mousedown(a,u),this.mousePitch&&this.mousePitch.mousedown(a,u),Y()}move(a,u){const g=this.map,x=this.mouseRotate.mousemoveWindow(a,u),S=x&&x.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const E=this.mousePitch.mousemoveWindow(a,u),R=E&&E.pitchDelta;R&&g.setPitch(g.getPitch()+R)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(Object.assign({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),se(this.element,a)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,se(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ee(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=ee(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Mc(m,a,u){if(m=new o.aS(m.lng,m.lat),a){const g=new o.aS(m.lng-360,m.lat),x=new o.aS(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-u.center.lng)/360),E=u.locationPoint3D(m).distSqr(a),R=a.x<0||a.y<0||a.x>u.width||a.y>u.height;u.locationPoint3D(g).distSqr(a)<E&&(R||Math.abs(g.lng-u.center.lng)<S)?m=g:u.locationPoint3D(x).distSqr(a)<E&&(R||Math.abs(x.lng-u.center.lng)<S)&&(m=x)}for(;Math.abs(m.lng-u.center.lng)>180;){const g=u.locationPoint3D(m);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;m.lng>u.center.lng?m.lng-=360:m.lng+=360}return m}const Dl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ua={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Rc extends o.E{constructor(a,u){super(),(a instanceof HTMLElement||u)&&(a=Object.assign({element:a},u)),o.aX(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:x="#3FB1CE",scale:S=1,draggable:E=!1,clickTolerance:R=0,rotation:O=Ua.rotation,rotationAlignment:$=Ua.rotationAlignment,pitchAlignment:U=Ua.pitchAlignment,occludedOpacity:q=Ua.occludedOpacity,altitude:H=Ua.altitude}=a||{};this._anchor=g,this._color=x,this._scale=S,this._draggable=E,this._clickTolerance=R,this._rotation=O,this._rotationAlignment=$,this._pitchAlignment=U,this._occludedOpacity=q,this._altitude=H,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),a&&a.element?(this._element=a.element,this._offset=o.P.convert(a&&a.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=o.P.convert(a&&a.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",ae=>{ae.preventDefault()}),this._element.addEventListener("mousedown",ae=>{ae.preventDefault()});const X=this._element.classList;for(const ae in Dl)X.remove(`mapboxgl-marker-anchor-${ae}`);X.add(`mapboxgl-marker-anchor-${this._anchor}`);const Q=a&&a.className?a.className.trim().split(/\s+/):[];X.add(...Q),this._popup=null}_createDefaultMarker(){const a=B("div"),u=N("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},a);if(this._altitude===0){const g=N("radialGradient",{id:"shadowGradient"},N("defs",{},u));N("stop",{offset:"10%","stop-opacity":.4},g),N("stop",{offset:"100%","stop-opacity":.05},g),N("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return N("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),N("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),N("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),a}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=o.aS.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(a){return a===this._altitude||(this._defaultMarker&&(this._altitude===0&&a!==0||this._altitude!==0&&a===0)&&(this._element=this._createDefaultMarker()),this._altitude=a||Ua.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,a._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const u=a.code,g=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(a){const u=a.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map,u=this._pos;if(!a||!u)return!1;const g=a.unproject(u,this._altitude),x=a.getFreeCameraOptions();if(!x.position)return!1;const S=x.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const u=this._pos;if(!u||u.x<0||u.x>a.transform.width||u.y<0||u.y>a.transform.height)return void this._clearFadeTimer();const g=a.unproject(u,this._altitude);let x;a._showingGlobe()&&o.f4(a.transform,this._lngLat)?x=0:(x=1-a._queryFogOpacity(g),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px)
            ${Dl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const a=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!a||g!=="map")return"";if(!u._showingGlobe()){const O=u.getPitch();return O?`rotateX(${O}deg)`:""}const x=o.cW(o.f5(u.transform,this._lngLat)),S=a.sub(o.f6(u.transform)),E=Math.abs(S.x)+Math.abs(S.y);if(E===0)return"";const R=x/E;return`rotateX(${-S.y*R}deg) rotateY(${S.x*R}deg)`}_calculateZTransform(){const a=this._pos,u=this._map;if(!u||!a)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const S=u.project(new o.aS(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),E=u.project(new o.aS(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(S);g=o.cW(Math.atan2(E.y,E.x))-90}else g=-u.getBearing();else if(x==="horizon"){const S=o.ah(4,6,u.getZoom()),E=o.f6(u.transform);E.y+=S*u.transform.height;const R=a.sub(E),O=o.cW(Math.atan2(R.y,R.x));g=(O>90?O-270:O+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(a){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Mc(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),a===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=o.P.convert(a),this._update(),this}addClassName(a){return this._element.classList.add(a),this}removeClassName(a){return this._element.classList.remove(a),this}toggleClassName(a){return this._element.classList.toggle(a)}_onMove(a){const u=this._map;if(!u)return;const g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){const S=this._clickTolerance||u._clickTolerance;if(a.point.dist(g)<S)return;this._isDragging=!0}this._pos=a.point.sub(x),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.z("dragstart"))),this.fire(new o.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.z("dragend")),this._state="inactive"}_addDragHandler(a){const u=this._map,g=this._pos;u&&g&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(g),this._pointerdownPos=a.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const u=this._map;return u&&(a?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||Ua.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||Ua.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||Ua.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||Ua.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ll={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},AT={maxWidth:100,unit:"metric"},OT={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},DT={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},LT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function my(m=new o.P(0,0),a="bottom"){if(typeof m=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(a){case"top":return new o.P(0,m);case"top-left":return new o.P(u,u);case"top-right":return new o.P(-u,u);case"bottom":return new o.P(0,-m);case"bottom-left":return new o.P(u,-u);case"bottom-right":return new o.P(-u,-u);case"left":return new o.P(m,0);case"right":return new o.P(-m,0)}return new o.P(0,0)}return m instanceof o.P||Array.isArray(m)?o.P.convert(m):o.P.convert(m[a]||[0,0])}return{version:y,supported:k.supported,setRTLTextPlugin:o.fa,getRTLTextPluginStatus:o.f9,Map:class extends nc{constructor(m){C.mark(b.create);const a=m;if((m=Object.assign({},lg,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&o.f2(window)&&(m.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Wd(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new l1,this._domRenderTaskQueue=new l1,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.b1(),this._locale=Object.assign({},RT,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ap(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new we(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){const u=document.getElementById(m.container);if(!u)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=u}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,o.aX(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ST),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new sg(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||o.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),m.hash&&(this._hash=new Jm(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){a.center==null&&a.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const u=m.bounds;u&&(this.resize(),this.fitBounds(u,Object.assign({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new yh({customAttribution:m.customAttribution})),this._logoControl=new op,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent(),this._postStyleWithAppearanceEvent(),this._setupIndoor()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new o.z(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new o.z(`${u.dataType}dataloading`,u))}),this._interactions=new fy(this)}_getMapId(){return this._mapId}addControl(m,a){if(a===void 0&&(a=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[a];return a.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(m);return a>-1&&this._controls.splice(a,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new o.z("movestart",m)).fire(new o.z("move",m)),this.fire(new o.z("resize",m)),a&&this.fire(new o.z("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(o.aI.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new o.z("zoomstart")).fire(new o.z("zoom")).fire(new o.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new o.z("zoomstart")).fire(new o.z("zoom")).fire(new o.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new o.z("pitchstart")).fire(new o.z("pitch")).fire(new o.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new o.z("pitchstart")).fire(new o.z("pitch")).fire(new o.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(a=>a.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(a=>a==="auto"?navigator.language:a):m}setLanguage(m){const a=this._parseLanguage(m);if(!this.style||a===this._language)return this;this._language=a,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,a=m.projection.name;let u;a==="globe"&&m.zoom>=o.cK?(m.setMercatorFromTransition(),u=!0):a==="mercator"&&m.zoom<o.cK&&(m.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(m,a){return this._updateProjection(m||a||{name:"mercator"})}_updateProjection(m){let a;const u=this.transform.mercatorFromTransition;a=m.name==="globe"&&this.transform.zoom>=o.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate();const g=this.transform.getProjection().name==="mercator"&&u!==this.transform.mercatorFromTransition;return(a||g)&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,a){return this.transform.locationPoint3D(o.aS.convert(m),a)}unproject(m,a){return this.transform.pointLocation3D(o.P.convert(m),a)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,a,u){const g=x=>{let S=[];if(Array.isArray(a)){const E=a.filter(R=>this.getLayer(R));S=E.length?this.queryRenderedFeatures(x,{layers:E}):[]}else S=this.queryRenderedFeatures(x,{target:a});return S};if(m==="mouseenter"||m==="mouseover"){let x=!1;return{listener:u,targets:a,delegates:{mousemove:E=>{const R=g(E.point);R.length?x||(x=!0,u.call(this,new to(m,this,E.originalEvent,{features:R}))):x=!1},mouseout:()=>{x=!1}}}}if(m==="mouseleave"||m==="mouseout"){let x=!1;return{listener:u,targets:a,delegates:{mousemove:R=>{g(R.point).length?x=!0:x&&(x=!1,u.call(this,new to(m,this,R.originalEvent)))},mouseout:R=>{x&&(x=!1,u.call(this,new to(m,this,R.originalEvent)))}}}}{const x=S=>{const E=g(S.point);E.length&&(S.features=E,u.call(this,S),delete S.features)};return{listener:u,targets:a,delegates:{[m]:x}}}}on(m,a,u){if(typeof a=="function"||u===void 0)return super.on(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const g=this._createDelegatedListener(m,a,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(m,a,u){if(typeof a=="function"||u===void 0)return super.once(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const g=this._createDelegatedListener(m,a,u);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(m,a,u){if(typeof a=="function"||u===void 0)return super.off(m,a);if(typeof a=="string"&&(a=[a]),!this._areTargetsValid(a))return this;const g=this._delegatedListeners?this._delegatedListeners[m]:void 0;return g&&(x=>{for(let S=0;S<x.length;S++){const E=x[S];if(E.listener===u&&py(E.targets,a)){for(const R in E.delegates)this.off(R,E.delegates[R]);return x.splice(S,1),this}}})(g),this}queryRenderedFeatures(m,a){if(!this.style)return[];if(m===void 0||m instanceof o.P||Array.isArray(m)||a!==void 0||(a=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!a){const S=this.style.queryRenderedFeatures(m,void 0,this.transform),E=this.style.queryRenderedFeatureset(m,void 0,this.transform);return S.concat(E)}let u=!0;if(a.target&&(u=this._isTargetValid(a.target),u&&!a.layers))return this.style.queryRenderedFeatureset(m,a,this.transform);let g=!0;if(a.layers&&Array.isArray(a.layers)){for(const S of a.layers)if(!this._isValidId(S)){g=!1;break}if(g&&!a.target)return this.style.queryRenderedFeatures(m,a,this.transform)}let x=[];return g&&(x=x.concat(this.style.queryRenderedFeatures(m,a,this.transform))),u&&(x=x.concat(this.style.queryRenderedFeatureset(m,a,this.transform))),x}querySourceFeatures(m,a){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,a)}queryRasterValue(m,a,u){return this._isValidId(m)?this.style.queryRasterValue(m,a,u):Promise.resolve(null)}isPointOnSurface(m){const{name:a}=this.transform.projection;return a!=="globe"&&a!=="mercator"&&o.w(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(m))}addInteraction(m,a){return this._interactions.add(m,a),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,a){return a=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a),this.style&&m&&a.diff!==!1&&a.localFontFamily===this._localFontFamily&&a.localIdeographFontFamily===this._localIdeographFontFamily&&!a.config?(this.style._diffStyle(m,(u,g)=>{if(u){const x=typeof u=="string"?u:u instanceof Error?u.message:u.error;o.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(m,a)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(m,a))}_getUIString(m){const a=this._locale[m];if(a==null)throw new Error(`Missing UI string '${m}'`);return a}_updateStyle(m,a){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const u=Object.assign({},a);a&&a.config&&(u.initialConfig=a.config,delete u.config),this.style=new gl(this,u).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new gl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new o.y(new Error("IDs can't be empty."))),!1):!o.dq(m)||(this.fire(new o.y(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const a of m)if(!this._isValidId(a))return!1;return!0}return this._isTargetValid(m)}addSource(m,a){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,a),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,a,u){this._lazyInitEmptyStyle(),this.style.addSourceType(m,a,u)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,a,{pixelRatio:u=1,sdf:g=!1,stretchX:x,stretchY:S,content:E}={}){this._lazyInitEmptyStyle();const R=o.I.from(m);if(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap){const{width:O,height:$,data:U}=o.o.getImageData(a);this.style.addImage(R,{data:new o.q({width:O,height:$},U),pixelRatio:u,stretchX:x,stretchY:S,content:E,sdf:g,version:0,usvg:!1})}else if(a.width===void 0||a.height===void 0)this.fire(new o.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:$}=a,U=a;this.style.addImage(R,{data:new o.q({width:O,height:$},new Uint8Array(U.data)),pixelRatio:u,stretchX:x,stretchY:S,content:E,sdf:g,usvg:!1,version:0,userImage:U}),U.onAdd&&U.onAdd(this,m)}}updateImage(m,a){this._lazyInitEmptyStyle();const u=o.I.from(m),g=this.style.getImage(u);if(!g)return void this.fire(new o.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap?o.o.getImageData(a):a,{width:S,height:E,data:R}=x;if(S===void 0||E===void 0)return void this.fire(new o.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||E!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new o.y(new Error(`The width and height of the updated image (${S}, ${E})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const O=!(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap);let $=!1;g.usvg?(g.data=new o.q({width:S,height:E},new Uint8Array(R)),g.usvg=!1,g.icon=void 0,$=!0):g.data.replace(R,O),this.style.updateImage(u,g,$)}hasImage(m){return m?!!this.style&&!!this.style.getImage(o.I.from(m)):(this.fire(new o.y(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(o.I.from(m))}loadImage(m,a){o.n(this._requestManager.transformRequest(m,o.R.Image),(u,g)=>{a(u,g instanceof HTMLImageElement?o.o.getImageData(g):g)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,a){this._lazyInitEmptyStyle(),this.style.addModel(m,a)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new o.y(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,a){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,a),this._update(!0)):this}getSlot(m){const a=this.getLayer(m);return a&&a.slot||null}setSlot(m,a){return this.style.setSlot(m,a),this.style.mergeLayers(),this._update(!0)}addImport(m,a){return this.style.addImport(m,a).catch(u=>this.fire(new o.y(new Error("Failed to add import",u)))),this}updateImport(m,a){return typeof a!="string"&&a.id!==m?(this.removeImport(m),this.addImport(a)):(this.style.updateImport(m,a),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,a){return this.style.moveImport(m,a),this._update(!0)}moveLayer(m,a){return this._isValidId(m)?(this.style.moveLayer(m,a),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const a=this.style.getOwnLayer(m);return a?a.type==="custom"?a.implementation:a.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,a,u){return this._isValidId(m)?(this.style.setLayerZoomRange(m,a,u),this._update(!0)):this}setFilter(m,a,u={}){return this._isValidId(m)?(this.style.setFilter(m,a,u),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,a,u,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,a,u,g),this._update(!0)):this}getPaintProperty(m,a){return this._isValidId(m)?this.style.getPaintProperty(m,a):null}setLayoutProperty(m,a,u,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,a,u,g),this._update(!0)):this}getLayoutProperty(m,a){return this._isValidId(m)?this.style.getLayoutProperty(m,a):null}setLayerProperty(m,a,u,g={}){return this._isValidId(m)?(this.style.setLayerProperty(m,a,u,g),this._update(!0)):this}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,a){return this.style.setSchema(m,a),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,a){return this.style.setConfig(m,a),this._update(!0)}getConfigProperty(m,a){return this.style.getConfigProperty(m,a)}setConfigProperty(m,a,u){return this.style.setConfigProperty(m,a,u),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const a=m[0];a.properties?this.style.setFlatLight(a.properties,a.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,a={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,a){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,a),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.aS.convert(m),this.transform):0}setFeatureState(m,a){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,a),this._update())}removeFeatureState(m,a){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,a),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_selectIndoorFloor(m){this.indoor.selectFloor(m)}_setIndoorActiveFloorsVisibility(m){this.indoor.setActiveFloorsVisibility(m)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new hy),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let u,g,x,S=this._container;for(;S&&(!g||!x);){const E=window.getComputedStyle(S).transform;E&&E!=="none"&&(u=E.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),S=S.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=x?Math.abs(a/x):a}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupIndoor(){this.style.isIndoorEnabled()&&(this.indoor=new td(this.style),this.on("load",()=>{this._addIndoorControl(),this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds()),this.on("move",()=>{this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds())}),this.on("idle",()=>{this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds())})}))}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=B("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=B("div","mapboxgl-canvas-container",m);this._canvas=B("canvas","mapboxgl-canvas",a),this._interactive&&(a.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=B("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{g[x]=B("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,a){const u=o.o.devicePixelRatio||1;this._canvas.width=u*Math.ceil(m),this._canvas.height=u*Math.ceil(a),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${a}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const a=this._markers.indexOf(m);a!==-1&&this._markers.splice(a,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const a=this._popups.indexOf(m);a!==-1&&this._popups.splice(a,1)}_setupPainter(){const m=Object.assign({},k.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl2",m);a?(xt(a,!0),this.painter=new pu(a,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.k.testSupport(a)):this.fire(new o.y(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.z("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new o.z("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let a;this.fire(new o.z("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=o.o.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(a=x.createQuery(),x.beginQuery(u.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,U=this.transform.pitch,q=o.o.now(),H=new o.ac($,{now:q,fadeDuration:S,pitch:U,transition:this.style.transition,worldview:this._worldview});this.style.update(H)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(g);const R=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),R&&(this._placementDirty=R.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,C.mark(b.load),this.fire(new o.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const $=o.o.now()-g;x.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const U=x.getQueryParameter(a,x.QUERY_RESULT)/1e6;x.deleteQuery(a),this.fire(new o.z("gpu-timing-frame",{cpuTime:$,gpuTime:U}))},50)}if(this.listens("gpu-timing-layer")){const $=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers($);this.fire(new o.z("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const $=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender($);this.fire(new o.z("gpu-timing-deferred-render",{gpuTime:U}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(O||this._repaint)this.triggerRepaint();else{const $=this.idle();if($&&(E=this._updateAverageElevation(g,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),$&&(this.fire(new o.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new o.z("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,C.mark(b.fullLoad),this._performanceMetricsCollection&&Nt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const a of this._markers)m&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(const a of this._popups)!m||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(m,a=!1){const u=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(a||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=m;const E=Math.abs(x-S);if(E>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(S),u(S);this._averageElevation.easeTo(S,m,300)}else if(E>1e-4)return this._averageElevation.jumpTo(S),u(S)}return!!this._averageElevation.isEasing(m)&&u(this._averageElevation.getValue(m))}_authenticate(){pt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===ge||m.status===401)){const a=this.painter.context.gl;xt(a,!1),this._logoControl instanceof op&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),at(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&tt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_postStyleWithAppearanceEvent(){this.style.globalId&&this.style.hasAppearances()&&Pt(this._requestManager._customAccessToken)}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function x(S){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,S,0);const E=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,E),E}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(x(m),a.canvasCopies.map(x),a.timeStamps)}_canvasPixelComparison(m,a,u){let g=u[1]-u[0];const x=m.length/4;for(let S=0;S<a.length;S++){const E=a[S];let R=0;for(let O=0;O<E.length;O+=4)E[O]===m[O]&&E[O+1]===m[O+1]&&E[O+2]===m[O+2]&&E[O+3]===m[O+3]&&(R+=1);g+=(u[S+2]-u[S+1])*(1-R/x)}return g}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor&&this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),yt.delete(this.painter.context.gl),Rt.remove(),qe.remove(),this._removed=!0,this.fire(new o.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=o.o.frame(a=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(a)}))}_preloadTiles(m){const a=this.style?this.style.getSourceCaches():[];return o.bv(a,(u,g)=>u._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,a){o.f3(m,a)}get version(){return y}},NavigationControl:class{constructor(m={}){this.options=Object.assign({},cg,m),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(o.aX(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),B("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),B("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aX(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:a}):u.resetNorth({},{originalEvent:a}))}),this._compassIcon=B("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const a=m.getZoom(),u=a===m.getMaxZoom(),g=a===m.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sp(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,a){const u=B("button",m,this._container);return u.type="button",u.addEventListener("click",a),u}_setButtonTitle(m,a){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${a}`);m.setAttribute("aria-label",u),m.firstElementChild&&m.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends o.E{constructor(m={}){super();const a=navigator.geolocation;this.options=Object.assign({geolocation:a},Ll,m),o.aX(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ud(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const a=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,m(u)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>a(u.state!=="denied")).catch(()=>a()):a()}_isOutOfMapMaxBounds(m){const a=this._map.getMaxBounds(),u=m.coords;return!!a&&(u.longitude<a.getWest()||u.longitude>a.getEast()||u.latitude<a.getSouth()||u.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new o.z("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.z("geolocate",Object.assign({coords:m.coords,timestamp:m.timestamp},m.toJSON?{toJSON:m.toJSON.bind(m)}:{}))),this._finish()}}_updateCamera(m){const a=new o.aS(m.coords.longitude,m.coords.latitude),u=m.coords.accuracy,g=this._map.getBearing(),x=Object.assign({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(u),x,{geolocateSource:!0})}_updateMarker(m){if(m){const a=new o.aS(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,a=o.ce(1,m._center.lat)*m.worldSize,u=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.z("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=B("button","mapboxgl-ctrl-geolocate",this._container),B("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B("div","mapboxgl-user-location"),this._dotElement.appendChild(B("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(B("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=B("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.z("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(a=>{a==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yh,ScaleControl:class{constructor(m={}){this.options=Object.assign({},AT,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aX(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,a=this._map,u=a._containerHeight/2,g=a._containerWidth/2-m/2,x=a.unproject([g,u]),S=a.unproject([g+m,u]),E=x.distanceTo(S);if(this.options.unit==="imperial"){const R=3.2808*E;R>5280?this._setScale(m,R/5280,"mile"):this._setScale(m,R,"foot")}else this.options.unit==="nautical"?this._setScale(m,E/1852,"nautical-mile"):E>=1e3?this._setScale(m,E/1e3,"kilometer"):this._setScale(m,E,"meter")}_setScale(m,a,u){this._map._requestDomTask(()=>{const g=function(S){const E=Math.pow(10,`${Math.floor(S)}`.length-1);let R=S/E;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(O){const $=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*$)/$}(R),E*R}(a),x=g/a;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${OT[u]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:o.w("Full screen control 'container' must be a DOM element.")),o.aX(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=B("button","mapboxgl-ctrl-fullscreen",this._controlContainer);B("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:hy,Popup:class extends o.E{constructor(m){super(),this.options=Object.assign(Object.create(DT),m),this._altitude=this.options.altitude,o.aX(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new o.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new o.z("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=o.aS.convert(m),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const a=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=m;g=u.firstChild,g;)a.appendChild(g);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=B("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(m),this.options.closeButton){const u=this._closeButton=B("button","mapboxgl-popup-close-button",a);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let a;return this._classList.delete(m)?a=!1:(this._classList.add(m),a=!0),this._updateClassList(),a}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const a=this._map,u=this._container,g=this._pos;if(!a||!u||!g)return"bottom";const x=u.offsetWidth,S=u.offsetHeight,E=g.x<x/2,R=g.x>a.transform.width-x/2;if(g.y+m<S)return E?"top-left":R?"top-right":"top";if(g.y>a.transform.height-S){if(E)return"bottom-left";if(R)return"bottom-right"}return E?"left":R?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),m.className=a.join(" ")}_update(m){const a=this._map,u=this._content;if(!a||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=B("div","mapboxgl-popup",a.getContainer()),this._tip=B("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mc(this._lngLat,this._pos,a.transform)),!this._trackPointer||m){const x=this._pos=this._trackPointer&&m instanceof o.P?m:a.project(this._lngLat,this._altitude),S=my(this.options.offset),E=this._anchor=this._getAnchor(S.y),R=my(this.options.offset,E),O=x.add(R).round();a._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Dl[E]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&a._showingGlobe()){const x=o.f4(a.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(LT);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Rc,Style:gl,LngLat:o.aS,LngLatBounds:o.aI,Point:o.P,MercatorCoordinate:o.ae,FreeCameraOptions:Ql,Evented:o.E,config:o.e,prewarm:o.f8,clearPrewarmedResources:o.f7,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(m){o.e.ACCESS_TOKEN=m},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(m){o.e.API_URL=m},get workerCount(){return o.fh.workerCount},set workerCount(m){o.fh.workerCount=m},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){o.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){o.fg(m)},get workerUrl(){return o.ff.workerUrl},set workerUrl(m){o.ff.workerUrl=m},get workerClass(){return o.ff.workerClass},set workerClass(m){o.ff.workerClass=m},get workerParams(){return o.ff.workerParams},set workerParams(m){o.ff.workerParams=m},get dracoUrl(){return o.fe()},set dracoUrl(m){o.fd(m)},get meshoptUrl(){return o.fc()},set meshoptUrl(m){o.fb(m)},setNow:o.o.setNow,restoreNow:o.o.restoreNow}});var f=s;return f})})(w6);var MY=w6.exports;const al=jv(MY);al.accessToken="pk.eyJ1IjoibmdvY3R0ZCIsImEiOiJjbWJibmlod3MwMmluMnFyMG1xMWt0dTdrIn0.ok5SgmXGrHFLeMPf-OG5_w";const TI={type:"FeatureCollection",features:[{type:"Feature",properties:{id:"RG01",name:"Tri 1"},geometry:{type:"Polygon",coordinates:[[[105.7663,21.6153],[105.792,21.6153],[105.792,21.6325],[105.7663,21.6325],[105.7663,21.6153]]]}},{type:"Feature",properties:{id:"RG02",name:"Xm Bi"},geometry:{type:"Polygon",coordinates:[[[105.7925,21.6153],[105.8155,21.6153],[105.8155,21.6325],[105.7925,21.6325],[105.7925,21.6153]]]}}]},vd={type:"FeatureCollection",features:[{type:"Feature",properties:{pid:"P-001",region:"RG01"},geometry:{type:"Polygon",coordinates:[[[105.769,21.617],[105.775,21.617],[105.775,21.6215],[105.769,21.6215],[105.769,21.617]]]}},{type:"Feature",properties:{pid:"P-002",region:"RG01"},geometry:{type:"Polygon",coordinates:[[[105.776,21.617],[105.782,21.617],[105.782,21.6215],[105.776,21.6215],[105.776,21.617]]]}},{type:"Feature",properties:{pid:"P-003",region:"RG01"},geometry:{type:"Polygon",coordinates:[[[105.769,21.622],[105.775,21.622],[105.775,21.6265],[105.769,21.6265],[105.769,21.622]]]}},{type:"Feature",properties:{pid:"P-004",region:"RG02"},geometry:{type:"Polygon",coordinates:[[[105.795,21.617],[105.8005,21.617],[105.8005,21.6215],[105.795,21.6215],[105.795,21.617]]]}},{type:"Feature",properties:{pid:"P-005",region:"RG02"},geometry:{type:"Polygon",coordinates:[[[105.8012,21.617],[105.8067,21.617],[105.8067,21.6215],[105.8012,21.6215],[105.8012,21.617]]]}},{type:"Feature",properties:{pid:"P-006",region:"RG02"},geometry:{type:"Polygon",coordinates:[[[105.8072,21.617],[105.8127,21.617],[105.8127,21.6215],[105.8072,21.6215],[105.8072,21.617]]]}}]},RY=["2025-01","2025-02","2025-03","2025-04","2025-05","2025-06","2025-07","2025-08","2025-09","2025-10","2025-11","2025-12"],o3=["NDVI","EVI","NDWI","LAI","CIRE"];function AY(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}function OY(e){return function(){let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function DY(e,t,n){const i=AY(e+t+n),s=OY(i)();return e==="LAI"?+(1+s*4).toFixed(2):e==="CIRE"?+(.5+s*1.5).toFixed(2):+(.2+s*.7).toFixed(2)}function a3(e){let t=1/0,n=1/0,i=-1/0,s=-1/0;return(e.type==="FeatureCollection"?e.features:[e]).forEach(d=>{(d.geometry.type==="Polygon"?d.geometry.coordinates[0]:d.geometry.type==="MultiPolygon"?d.geometry.coordinates.flat(1)[0]:[d.geometry.coordinates]).forEach(o=>{const y=o[0],b=o[1];y<t&&(t=y),b<n&&(n=b),y>i&&(i=y),b>s&&(s=b)})}),[[t,n],[i,s]]}function s3(e,t,n){const i=new Blob([e],{type:n}),s=URL.createObjectURL(i),d=document.createElement("a");d.href=s,d.download=t,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(s)}function LY(){const e=I.useRef(null),t=I.useRef(null),[n,i]=I.useState("all"),[s,d]=I.useState("all"),[f,o]=I.useState("NDVI"),[y,b]=I.useState(.4),[C,P]=I.useState("2025-06"),[A,D]=I.useState(!0),[k,B]=I.useState("2025-05-01"),[N,j]=I.useState("2025-10-01"),[V,K]=I.useState(!1),[Y,Z]=I.useState([]),te=I.useRef({}),ne=I.useRef(null);I.useEffect(()=>{ne.current={type:"FeatureCollection",features:vd.features.map(Xe=>{const qe=Xe.geometry.coordinates[0].map(vt=>vt[0]),at=Xe.geometry.coordinates[0].map(vt=>vt[1]),Ke=(Math.min(...qe)+Math.max(...qe))/2,tt=(Math.min(...at)+Math.max(...at))/2;return{type:"Feature",properties:{pid:Xe.properties.pid,region:Xe.properties.region},geometry:{type:"Point",coordinates:[Ke,tt]}}})};const Be={};vd.features.forEach(Xe=>{const qe=Xe.properties.pid;Be[qe]={},o3.forEach(at=>{Be[qe][at]={},RY.forEach(Ke=>{Be[qe][at][Ke]=DY(at,Ke,qe)})})}),te.current=Be,se("all")},[]),I.useEffect(()=>{const Be=new al.Map({container:t.current,style:"mapbox://styles/mapbox/light-v11",center:[105.79,21.623],zoom:12.6,pitch:0});return e.current=Be,Be.addControl(new al.NavigationControl({visualizePitch:!0}),"top-right"),Be.addControl(new al.ScaleControl),Be.on("load",()=>{Be.addSource("regions",{type:"geojson",data:TI}),Be.addSource("plots",{type:"geojson",data:vd}),Be.addSource("centroids",{type:"geojson",data:ne.current}),Be.addLayer({id:"regions-fill",type:"fill",source:"regions",paint:{"fill-color":"#c7d2fe","fill-opacity":.35}}),Be.addLayer({id:"regions-line",type:"line",source:"regions",paint:{"line-color":"#6366f1","line-width":1.2}}),Be.addLayer({id:"plots-fill",type:"fill",source:"plots",paint:{"fill-color":["get","_color"],"fill-opacity":.65}}),Be.addLayer({id:"plots-line",type:"line",source:"plots",paint:{"line-color":"#334155","line-width":.8}}),Be.addLayer({id:"centroids",type:"circle",source:"centroids",paint:{"circle-radius":4,"circle-color":"#2563eb","circle-stroke-color":"#fff","circle-stroke-width":1}}),Be.addLayer({id:"plots-label",type:"symbol",source:"centroids",layout:{"text-field":["get","pid"],"text-size":11,"text-offset":[0,1.2]},paint:{"text-color":"#334155"}}),Be.on("click","plots-fill",Xe=>{const qe=Xe.features[0],at=qe.properties.pid,Ke=qe.properties.region,tt=te.current[at][f][C];new al.Popup().setLngLat(Xe.lngLat).setHTML(`
            <div style="font-weight:600">L: ${we(at)}</div>
            <div>Vng: ${Ke}</div>
            <div>${f} (${C}): <b>${tt}</b></div>
          `).addTo(Be)}),Be.on("mouseenter","plots-fill",()=>Be.getCanvas().style.cursor="pointer"),Be.on("mouseleave","plots-fill",()=>Be.getCanvas().style.cursor=""),fe()}),()=>Be.remove()},[]),I.useEffect(()=>{fe()},[n,s,f,y,C]);const se=Be=>{const Xe=vd.features.filter(qe=>Be==="all"?!0:qe.properties.region===Be);Z(Xe),d("all")},ee=Be=>{const Xe=Be.target.value;i(Xe),se(Xe),de(Xe)},de=(Be=n)=>{const Xe=e.current;if(!(!Xe||!Xe.isStyleLoaded()))if(Be==="all"){const qe=a3(TI);Xe.fitBounds(qe,{padding:30,duration:500})}else{const qe=TI.features.find(Ke=>Ke.properties.id===Be),at=a3(qe);Xe.fitBounds(at,{padding:30,duration:500})}},fe=()=>{var at;const Be=e.current;if(!Be||!Be.isStyleLoaded())return;const Xe={type:"FeatureCollection",features:vd.features.filter(Ke=>{const tt=n==="all"?!0:Ke.properties.region===n,vt=s==="all"?!0:Ke.properties.pid===s;return tt&&vt}).map(Ke=>{const tt=Ke.properties.pid,vt=ye(f,te.current[tt][f][C]),Pt=vt>=y?"#dcfce7":"#fee2e2";return{...Ke,properties:{...Ke.properties,_color:Pt,_value:vt}}})};(at=Be.getSource("plots"))==null||at.setData(Xe);const qe=s==="all"?"visible":"none";Be.setLayoutProperty("plots-label","visibility",qe)},ye=(Be,Xe)=>Be==="LAI"?Math.max(0,Math.min(1,(Xe-1)/4)):Be==="CIRE"?Math.max(0,Math.min(1,(Xe-.5)/1.5)):Xe,ge=Be=>{const[Xe,qe]=C.split("-").map(vt=>+vt);let at=qe+Be,Ke=Xe;at<1?(at=12,Ke--):at>12&&(at=1,Ke++);const tt=`${Ke}-${String(at).padStart(2,"0")}`;P(tt)},we=Be=>A?`ANON-${Be.slice(-3)}`:Be,Se=Be=>{const Xe=e.current;if(!Xe)return;const qe={regions:["regions-fill","regions-line"],plots:["plots-fill","plots-line"],centroids:["centroids"],labels:["plots-label"]}[Be];qe&&qe.forEach(at=>{const Ke=Xe.getLayoutProperty(at,"visibility");Xe.setLayoutProperty(at,"visibility",Ke==="none"?"visible":"none")})},xe=()=>{const Be=[["plot_id_anonymous","plot_id_real","region","index","period","value"]];vd.features.filter(qe=>(n==="all"||qe.properties.region===n)&&(s==="all"||qe.properties.pid===s)).forEach(qe=>{const at=qe.properties.pid,Ke=qe.properties.region,tt=te.current[at][f][C];Be.push([`ANON-${at.slice(-3)}`,at,Ke,f,C,tt])});const Xe=Be.map(qe=>qe.join(",")).join(`
`);s3(Xe,`tea_${f}_${C}.csv`,"text/csv")},Te=()=>{const Be={type:"FeatureCollection",features:vd.features.filter(Xe=>(n==="all"||Xe.properties.region===n)&&(s==="all"||Xe.properties.pid===s)).map(Xe=>{const qe=Xe.properties.pid,at=Xe.properties.region,Ke=te.current[qe][f][C];return{type:"Feature",properties:{plot_id:qe,plot_id_anonymous:`ANON-${qe.slice(-3)}`,region:at,index:f,period:C,value:Ke,meets_threshold:ye(f,Ke)>=y},geometry:Xe.geometry}})};s3(JSON.stringify(Be),`tea_${f}_${C}.geojson`,"application/geo+json")},ze=()=>{const Be=`https://api.example.org/research/tea-index?index=${f}&period=${C}&region=${n}&plot=${s}`;navigator.clipboard.writeText(Be).then(()=>{K(!0),setTimeout(()=>K(!1),1500)})},Ue=()=>{const Xe=vd.features.filter(at=>n==="all"?!0:at.properties.region===n).map(at=>te.current[at.properties.pid][f][C]),qe=(Xe.reduce((at,Ke)=>at+Ke,0)/Xe.length).toFixed(2);alert(`Trung bnh ${f} (${C})${n==="all"?" ton b":" ca "+n}: ${qe}`)},We=vd.features.filter(Be=>(n==="all"||Be.properties.region===n)&&(s==="all"||Be.properties.pid===s));return Ee.jsxs("div",{className:"app",children:[Ee.jsxs("header",{children:[Ee.jsxs("div",{className:"title",children:[Ee.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Ee.jsx("path",{d:"M12 3l9 4.5-9 4.5-9-4.5L12 3z",fill:"#2563eb"}),Ee.jsx("path",{d:"M21 12l-9 4.5-9-4.5",stroke:"#60a5fa","stroke-width":"1.2"}),Ee.jsx("path",{d:"M21 16.5L12 21 3 16.5",stroke:"#93c5fd","stroke-width":"1.2"})]}),Ee.jsxs("div",{children:[Ee.jsx("div",{className:"title-row",children:Ee.jsx("h1",{children:"Gim st sinh trng ch  Khng gian nh nghin cu"})}),Ee.jsx("div",{className:"hint",children:"Truy cp d liu n danh, ti thng k ch s GEE theo l/vng, xut CSV/GeoJSON (demo, khng gi endpoint tht)."})]})]}),Ee.jsxs("div",{className:"header-actions",children:[Ee.jsx("button",{className:"btn",onClick:xe,children:"Ti CSV"}),Ee.jsx("button",{className:"btn",onClick:Te,children:"Ti GeoJSON"})]})]}),Ee.jsxs("div",{className:"container",children:[Ee.jsxs("aside",{className:"panel",id:"filters",children:[Ee.jsx("h3",{children:"B lc & tham s"}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"Vng ch"}),Ee.jsxs("select",{id:"selRegion",className:"input",value:n,onChange:ee,children:[Ee.jsx("option",{value:"all",children:"Tt c vng"}),Ee.jsx("option",{value:"RG01",children:"RG01  Tri 1"}),Ee.jsx("option",{value:"RG02",children:"RG02  Xm Bi"})]})]}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"L ch"}),Ee.jsxs("select",{id:"selPlot",className:"input",value:s,onChange:Be=>d(Be.target.value),children:[Ee.jsx("option",{value:"all",children:"Tt c l"}),Y.map(Be=>Ee.jsx("option",{value:Be.properties.pid,children:Be.properties.pid},Be.properties.pid))]})]}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"Ch s GEE"}),Ee.jsx("select",{id:"selIndex",className:"input",value:f,onChange:Be=>o(Be.target.value),children:o3.map(Be=>Ee.jsx("option",{children:Be},Be))})]}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"Khong thi gian"}),Ee.jsx("input",{id:"dateFrom",className:"input",type:"date",value:k,onChange:Be=>B(Be.target.value)}),Ee.jsx("div",{style:{height:"6px"}}),Ee.jsx("input",{id:"dateTo",className:"input",type:"date",value:N,onChange:Be=>j(Be.target.value)})]}),Ee.jsxs("div",{className:"group",children:[Ee.jsxs("label",{children:["Ngng t mu theo ch s (",Ee.jsx("span",{id:"threshVal",children:y.toFixed(2)}),")"]}),Ee.jsx("input",{id:"threshold",className:"range",type:"range",min:"0",max:"1",step:"0.01",value:y,onChange:Be=>b(parseFloat(Be.target.value))})]}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"Ti d liu"}),Ee.jsxs("div",{className:"actions",children:[Ee.jsx("button",{className:"btn",onClick:xe,children:"Xut CSV"}),Ee.jsx("button",{className:"btn",onClick:Te,children:"Xut GeoJSON"})]}),Ee.jsx("div",{style:{height:"8px"}}),Ee.jsx("button",{className:"btn ghost",onClick:ze,title:"Sao chp URL API chc (demo)",children:"Copy API (readonly)"}),Ee.jsx("div",{id:"copyMsg",className:"hint",style:{display:V?"block":"none",marginTop:"6px"},children:" sao chp URL v d."})]}),Ee.jsx("hr",{style:{border:"none",borderTop:"1px solid var(--border)",margin:"12px 0"}}),Ee.jsxs("div",{className:"group",children:[Ee.jsx("label",{children:"Lp hin th"}),Ee.jsxs("div",{className:"layer-controls",children:[Ee.jsx("button",{className:"btn tool",onClick:()=>Se("regions"),children:"Vng"}),Ee.jsx("button",{className:"btn tool",onClick:()=>Se("plots"),children:"L"}),Ee.jsx("button",{className:"btn tool",onClick:()=>Se("centroids"),children:"Tm l"}),Ee.jsx("button",{className:"btn tool",onClick:()=>Se("labels"),children:"Nhn"})]})]}),Ee.jsx("div",{className:"hint",children:"Lu : Raster ch s c m phng bng t mu theo ngng cho l ch."})]}),Ee.jsxs("section",{className:"main",children:[Ee.jsxs("div",{className:"mapwrap",children:[Ee.jsx("div",{ref:t,id:"map"}),Ee.jsxs("div",{className:"toolbar",children:[Ee.jsx("button",{className:"tool",onClick:()=>de(),children:"Fit ton vng"}),Ee.jsx("button",{className:"tool",onClick:()=>ge(-1),children:" Thng trc"}),Ee.jsxs("div",{className:"tool period-display",children:[Ee.jsx("span",{className:"hint",children:"K:"}),Ee.jsx("strong",{children:C})]}),Ee.jsx("button",{className:"tool",onClick:()=>ge(1),children:"Thng sau "})]}),Ee.jsxs("div",{className:"legend",id:"legend",children:[Ee.jsx("div",{children:Ee.jsx("strong",{children:"Ch gii (theo ngng)"})}),Ee.jsxs("div",{className:"row",children:[Ee.jsx("span",{className:"swatch",style:{background:"#dcfce7"}}),"Ch s  ngng"]}),Ee.jsxs("div",{className:"row",children:[Ee.jsx("span",{className:"swatch",style:{background:"#fee2e2"}}),"Ch s < ngng"]})]})]}),Ee.jsxs("div",{className:"tablewrap",children:[Ee.jsxs("div",{className:"tablehead",children:[Ee.jsxs("div",{className:"table-title",children:[Ee.jsx("strong",{children:"Kt qu thng k"}),Ee.jsx("span",{className:"hint",children:"(n danh)"})]}),Ee.jsxs("div",{className:"table-actions",children:[Ee.jsx("button",{className:"btn",onClick:()=>{fe()},children:"Lm mi"}),Ee.jsx("button",{className:"btn primary",onClick:Ue,children:"Tnh tm tt"})]})]}),Ee.jsxs("table",{className:"table",id:"resultTable",children:[Ee.jsx("thead",{children:Ee.jsxs("tr",{children:[Ee.jsx("th",{children:"ID l (n danh)"}),Ee.jsx("th",{children:"Vng"}),Ee.jsx("th",{children:"Ch s"}),Ee.jsx("th",{children:"K"}),Ee.jsx("th",{children:"Gi tr TB"}),Ee.jsx("th",{children:"Trng thi"})]})}),Ee.jsx("tbody",{children:We.map(Be=>{var Pt,ft;const Xe=Be.properties.pid,qe=Be.properties.region,at=((ft=(Pt=te.current[Xe])==null?void 0:Pt[f])==null?void 0:ft[C])||0,Ke=ye(f,at),tt=Ke>=y?"t":Ke>=y-.05?"Cn theo di":"Thp",vt=Ke>=y?"pill":Ke>=y-.05?"pill warn":"pill danger";return Ee.jsxs("tr",{children:[Ee.jsx("td",{children:we(Xe)}),Ee.jsx("td",{children:qe}),Ee.jsx("td",{children:f}),Ee.jsx("td",{children:C}),Ee.jsx("td",{children:at}),Ee.jsx("td",{children:Ee.jsx("span",{className:vt,children:tt})})]},Xe)})})]})]})]})]})]})}var C6={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var d="",f=0;f<arguments.length;f++){var o=arguments[f];o&&(d=s(d,i(o)))}return d}function i(d){if(typeof d=="string"||typeof d=="number")return d;if(typeof d!="object")return"";if(Array.isArray(d))return n.apply(null,d);if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]"))return d.toString();var f="";for(var o in d)t.call(d,o)&&d[o]&&(f=s(f,o));return f}function s(d,f){return f?d?d+" "+f:d+f:d}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(C6);var zY=C6.exports;const St=jv(zY);function kn(){return kn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kn.apply(null,arguments)}function Nr(e){"@babel/helpers - typeof";return Nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(e)}var kY=Symbol.for("react.element"),FY=Symbol.for("react.transitional.element"),NY=Symbol.for("react.fragment");function E6(e){return e&&Nr(e)==="object"&&(e.$$typeof===kY||e.$$typeof===FY)&&e.type===NY}function vc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return Wt.Children.forEach(e,function(i){i==null&&!t.keepEmpty||(Array.isArray(i)?n=n.concat(vc(i)):E6(i)&&i.props?n=n.concat(vc(i.props.children,t)):n.push(i))}),n}var CM={},BY=function(t){};function $Y(e,t){}function jY(e,t){}function VY(){CM={}}function T6(e,t,n){!t&&!CM[n]&&(e(!1,n),CM[n]=!0)}function oa(e,t){T6($Y,e,t)}function UY(e,t){T6(jY,e,t)}oa.preMessage=BY;oa.resetWarned=VY;oa.noteOnce=UY;function HY(e,t){if(Nr(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Nr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I6(e){var t=HY(e,"string");return Nr(t)=="symbol"?t:t+""}function ke(e,t,n){return(t=I6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,i)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?l3(Object(n),!0).forEach(function(i){ke(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l3(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function xx(e){return e instanceof HTMLElement||e instanceof SVGElement}function WC(e){return e&&Nr(e)==="object"&&xx(e.nativeElement)?e.nativeElement:xx(e)?e:null}function lS(e){var t=WC(e);if(t)return t;if(e instanceof Wt.Component){var n;return(n=vx.findDOMNode)===null||n===void 0?void 0:n.call(vx,e)}return null}var P6={exports:{}},Vo={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lO=Symbol.for("react.element"),cO=Symbol.for("react.portal"),qC=Symbol.for("react.fragment"),KC=Symbol.for("react.strict_mode"),XC=Symbol.for("react.profiler"),ZC=Symbol.for("react.provider"),YC=Symbol.for("react.context"),GY=Symbol.for("react.server_context"),JC=Symbol.for("react.forward_ref"),QC=Symbol.for("react.suspense"),eE=Symbol.for("react.suspense_list"),tE=Symbol.for("react.memo"),nE=Symbol.for("react.lazy"),WY=Symbol.for("react.offscreen"),M6;M6=Symbol.for("react.module.reference");function yc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case lO:switch(e=e.type,e){case qC:case XC:case KC:case QC:case eE:return e;default:switch(e=e&&e.$$typeof,e){case GY:case YC:case JC:case nE:case tE:case ZC:return e;default:return t}}case cO:return t}}}Vo.ContextConsumer=YC;Vo.ContextProvider=ZC;Vo.Element=lO;Vo.ForwardRef=JC;Vo.Fragment=qC;Vo.Lazy=nE;Vo.Memo=tE;Vo.Portal=cO;Vo.Profiler=XC;Vo.StrictMode=KC;Vo.Suspense=QC;Vo.SuspenseList=eE;Vo.isAsyncMode=function(){return!1};Vo.isConcurrentMode=function(){return!1};Vo.isContextConsumer=function(e){return yc(e)===YC};Vo.isContextProvider=function(e){return yc(e)===ZC};Vo.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===lO};Vo.isForwardRef=function(e){return yc(e)===JC};Vo.isFragment=function(e){return yc(e)===qC};Vo.isLazy=function(e){return yc(e)===nE};Vo.isMemo=function(e){return yc(e)===tE};Vo.isPortal=function(e){return yc(e)===cO};Vo.isProfiler=function(e){return yc(e)===XC};Vo.isStrictMode=function(e){return yc(e)===KC};Vo.isSuspense=function(e){return yc(e)===QC};Vo.isSuspenseList=function(e){return yc(e)===eE};Vo.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===qC||e===XC||e===KC||e===QC||e===eE||e===WY||typeof e=="object"&&e!==null&&(e.$$typeof===nE||e.$$typeof===tE||e.$$typeof===ZC||e.$$typeof===YC||e.$$typeof===JC||e.$$typeof===M6||e.getModuleId!==void 0)};Vo.typeOf=yc;P6.exports=Vo;var II=P6.exports;function nm(e,t,n){var i=I.useRef({});return(!("value"in i.current)||n(i.current.condition,t))&&(i.current.value=e(),i.current.condition=t),i.current.value}var qY=Number(I.version.split(".")[0]),bx=function(t,n){typeof t=="function"?t(n):Nr(t)==="object"&&t&&"current"in t&&(t.current=n)},ru=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=n.filter(Boolean);return s.length<=1?s[0]:function(d){n.forEach(function(f){bx(f,d)})}},bf=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return nm(function(){return ru.apply(void 0,n)},n,function(s,d){return s.length!==d.length||s.every(function(f,o){return f!==d[o]})})},Fu=function(t){var n,i;if(!t)return!1;if(uO(t)&&qY>=19)return!0;var s=II.isMemo(t)?t.type.type:t.type;return!(typeof s=="function"&&!((n=s.prototype)!==null&&n!==void 0&&n.render)&&s.$$typeof!==II.ForwardRef||typeof t=="function"&&!((i=t.prototype)!==null&&i!==void 0&&i.render)&&t.$$typeof!==II.ForwardRef)};function uO(e){return I.isValidElement(e)&&!E6(e)}var KY=function(t){return uO(t)&&Fu(t)},rm=function(t){if(t&&uO(t)){var n=t;return n.props.propertyIsEnumerable("ref")?n.props.ref:n.ref}return null},EM=I.createContext(null);function XY(e){var t=e.children,n=e.onBatchResize,i=I.useRef(0),s=I.useRef([]),d=I.useContext(EM),f=I.useCallback(function(o,y,b){i.current+=1;var C=i.current;s.current.push({size:o,element:y,data:b}),Promise.resolve().then(function(){C===i.current&&(n==null||n(s.current),s.current=[])}),d==null||d(o,y,b)},[n,d]);return I.createElement(EM.Provider,{value:f},t)}var R6=function(){if(typeof Map<"u")return Map;function e(t,n){var i=-1;return t.some(function(s,d){return s[0]===n?(i=d,!0):!1}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var i=e(this.__entries__,n),s=this.__entries__[i];return s&&s[1]},t.prototype.set=function(n,i){var s=e(this.__entries__,n);~s?this.__entries__[s][1]=i:this.__entries__.push([n,i])},t.prototype.delete=function(n){var i=this.__entries__,s=e(i,n);~s&&i.splice(s,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,i){i===void 0&&(i=null);for(var s=0,d=this.__entries__;s<d.length;s++){var f=d[s];n.call(i,f[1],f[0])}},t}()}(),TM=typeof window<"u"&&typeof document<"u"&&window.document===document,eC=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),ZY=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(eC):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),YY=2;function JY(e,t){var n=!1,i=!1,s=0;function d(){n&&(n=!1,e()),i&&o()}function f(){ZY(d)}function o(){var y=Date.now();if(n){if(y-s<YY)return;i=!0}else n=!0,i=!1,setTimeout(f,t);s=y}return o}var QY=20,eJ=["top","right","bottom","left","width","height","size","weight"],tJ=typeof MutationObserver<"u",nJ=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=JY(this.refresh.bind(this),QY)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,i=n.indexOf(t);~i&&n.splice(i,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!TM||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),tJ?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!TM||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,i=n===void 0?"":n,s=eJ.some(function(d){return!!~i.indexOf(d)});s&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),A6=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var s=i[n];Object.defineProperty(e,s,{value:t[s],enumerable:!1,writable:!1,configurable:!0})}return e},Mv=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||eC},O6=rE(0,0,0,0);function tC(e){return parseFloat(e)||0}function c3(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(i,s){var d=e["border-"+s+"-width"];return i+tC(d)},0)}function rJ(e){for(var t=["top","right","bottom","left"],n={},i=0,s=t;i<s.length;i++){var d=s[i],f=e["padding-"+d];n[d]=tC(f)}return n}function iJ(e){var t=e.getBBox();return rE(0,0,t.width,t.height)}function oJ(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return O6;var i=Mv(e).getComputedStyle(e),s=rJ(i),d=s.left+s.right,f=s.top+s.bottom,o=tC(i.width),y=tC(i.height);if(i.boxSizing==="border-box"&&(Math.round(o+d)!==t&&(o-=c3(i,"left","right")+d),Math.round(y+f)!==n&&(y-=c3(i,"top","bottom")+f)),!sJ(e)){var b=Math.round(o+d)-t,C=Math.round(y+f)-n;Math.abs(b)!==1&&(o-=b),Math.abs(C)!==1&&(y-=C)}return rE(s.left,s.top,o,y)}var aJ=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Mv(e).SVGGraphicsElement}:function(e){return e instanceof Mv(e).SVGElement&&typeof e.getBBox=="function"}}();function sJ(e){return e===Mv(e).document.documentElement}function lJ(e){return TM?aJ(e)?iJ(e):oJ(e):O6}function cJ(e){var t=e.x,n=e.y,i=e.width,s=e.height,d=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,f=Object.create(d.prototype);return A6(f,{x:t,y:n,width:i,height:s,top:n,right:t+i,bottom:s+n,left:t}),f}function rE(e,t,n,i){return{x:e,y:t,width:n,height:i}}var uJ=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=rE(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=lJ(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),dJ=function(){function e(t,n){var i=cJ(n);A6(this,{target:t,contentRect:i})}return e}(),hJ=function(){function e(t,n,i){if(this.activeObservations_=[],this.observations_=new R6,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=i}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Mv(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new uJ(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Mv(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(i){return new dJ(i.target,i.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),D6=typeof WeakMap<"u"?new WeakMap:new R6,L6=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=nJ.getInstance(),i=new hJ(t,n,this);D6.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach(function(e){L6.prototype[e]=function(){var t;return(t=D6.get(this))[e].apply(t,arguments)}});var fJ=function(){return typeof eC.ResizeObserver<"u"?eC.ResizeObserver:L6}(),Uh=new Map;function pJ(e){e.forEach(function(t){var n,i=t.target;(n=Uh.get(i))===null||n===void 0||n.forEach(function(s){return s(i)})})}var z6=new fJ(pJ);function mJ(e,t){Uh.has(e)||(Uh.set(e,new Set),z6.observe(e)),Uh.get(e).add(t)}function gJ(e,t){Uh.has(e)&&(Uh.get(e).delete(t),Uh.get(e).size||(z6.unobserve(e),Uh.delete(e)))}function ja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u3(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,I6(i.key),i)}}function Va(e,t,n){return t&&u3(e.prototype,t),n&&u3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wx(e,t){return wx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wx(e,t)}function Uu(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wx(e,t)}function Sx(e){return Sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sx(e)}function dO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dO=function(){return!!e})()}function Mr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vJ(e,t){if(t&&(Nr(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mr(e)}function Hu(e){var t=dO();return function(){var n,i=Sx(e);if(t){var s=Sx(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return vJ(this,n)}}var _J=function(e){Uu(n,e);var t=Hu(n);function n(){return ja(this,n),t.apply(this,arguments)}return Va(n,[{key:"render",value:function(){return this.props.children}}]),n}(I.Component);function yJ(e,t){var n=e.children,i=e.disabled,s=I.useRef(null),d=I.useRef(null),f=I.useContext(EM),o=typeof n=="function",y=o?n(s):n,b=I.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),C=!o&&I.isValidElement(y)&&Fu(y),P=C?rm(y):null,A=bf(P,s),D=function(){var j;return lS(s.current)||(s.current&&Nr(s.current)==="object"?lS((j=s.current)===null||j===void 0?void 0:j.nativeElement):null)||lS(d.current)};I.useImperativeHandle(t,function(){return D()});var k=I.useRef(e);k.current=e;var B=I.useCallback(function(N){var j=k.current,V=j.onResize,K=j.data,Y=N.getBoundingClientRect(),Z=Y.width,te=Y.height,ne=N.offsetWidth,se=N.offsetHeight,ee=Math.floor(Z),de=Math.floor(te);if(b.current.width!==ee||b.current.height!==de||b.current.offsetWidth!==ne||b.current.offsetHeight!==se){var fe={width:ee,height:de,offsetWidth:ne,offsetHeight:se};b.current=fe;var ye=ne===Math.round(Z)?Z:ne,ge=se===Math.round(te)?te:se,we=Je(Je({},fe),{},{offsetWidth:ye,offsetHeight:ge});f==null||f(we,N,K),V&&Promise.resolve().then(function(){V(we,N)})}},[]);return I.useEffect(function(){var N=D();return N&&!i&&mJ(N,B),function(){return gJ(N,B)}},[s.current,i]),I.createElement(_J,{ref:d},C?I.cloneElement(y,{ref:A}):y)}var xJ=I.forwardRef(yJ),bJ="rc-observer-key";function wJ(e,t){var n=e.children,i=typeof n=="function"?[n]:vc(n);return i.map(function(s,d){var f=(s==null?void 0:s.key)||"".concat(bJ,"-").concat(d);return I.createElement(xJ,kn({},e,{key:f,ref:d===0?t:void 0}),s)})}var Wl=I.forwardRef(wJ);Wl.Collection=XY;function IM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function SJ(e){if(Array.isArray(e))return IM(e)}function k6(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hO(e,t){if(e){if(typeof e=="string")return IM(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IM(e,t):void 0}}function CJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zn(e){return SJ(e)||k6(e)||hO(e)||CJ()}var F6=function(t){return+setTimeout(t,16)},N6=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(F6=function(t){return window.requestAnimationFrame(t)},N6=function(t){return window.cancelAnimationFrame(t)});var d3=0,fO=new Map;function B6(e){fO.delete(e)}var Qi=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;d3+=1;var i=d3;function s(d){if(d===0)B6(i),t();else{var f=F6(function(){s(d-1)});fO.set(i,f)}}return s(n),i};Qi.cancel=function(e){var t=fO.get(e);return B6(e),N6(t)};function $6(e){if(Array.isArray(e))return e}function EJ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,s,d,f,o=[],y=!0,b=!1;try{if(d=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;y=!1}else for(;!(y=(i=d.call(n)).done)&&(o.push(i.value),o.length!==t);y=!0);}catch(C){b=!0,s=C}finally{try{if(!y&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(b)throw s}}return o}}function j6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function It(e,t){return $6(e)||EJ(e,t)||hO(e,t)||j6()}function Cx(e){for(var t=0,n,i=0,s=e.length;s>=4;++i,s-=4)n=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}function Bs(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function TJ(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}var h3="data-rc-order",f3="data-rc-priority",IJ="rc-util-key",PM=new Map;function V6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):IJ}function iE(e){if(e.attachTo)return e.attachTo;var t=document.querySelector("head");return t||document.body}function PJ(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function pO(e){return Array.from((PM.get(e)||e).children).filter(function(t){return t.tagName==="STYLE"})}function U6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Bs())return null;var n=t.csp,i=t.prepend,s=t.priority,d=s===void 0?0:s,f=PJ(i),o=f==="prependQueue",y=document.createElement("style");y.setAttribute(h3,f),o&&d&&y.setAttribute(f3,"".concat(d)),n!=null&&n.nonce&&(y.nonce=n==null?void 0:n.nonce),y.innerHTML=e;var b=iE(t),C=b.firstChild;if(i){if(o){var P=(t.styles||pO(b)).filter(function(A){if(!["prepend","prependQueue"].includes(A.getAttribute(h3)))return!1;var D=Number(A.getAttribute(f3)||0);return d>=D});if(P.length)return b.insertBefore(y,P[P.length-1].nextSibling),y}b.insertBefore(y,C)}else b.appendChild(y);return y}function H6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=iE(t);return(t.styles||pO(n)).find(function(i){return i.getAttribute(V6(t))===e})}function Ex(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=H6(e,t);if(n){var i=iE(t);i.removeChild(n)}}function MJ(e,t){var n=PM.get(e);if(!n||!TJ(document,n)){var i=U6("",t),s=i.parentNode;PM.set(e,s),e.removeChild(i)}}function Od(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=iE(n),s=pO(i),d=Je(Je({},n),{},{styles:s});MJ(i,d);var f=H6(t,d);if(f){var o,y;if((o=d.csp)!==null&&o!==void 0&&o.nonce&&f.nonce!==((y=d.csp)===null||y===void 0?void 0:y.nonce)){var b;f.nonce=(b=d.csp)===null||b===void 0?void 0:b.nonce}return f.innerHTML!==e&&(f.innerHTML=e),f}var C=U6(e,d);return C.setAttribute(V6(d),t),C}function RJ(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function ri(e,t){if(e==null)return{};var n,i,s=RJ(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(i=0;i<d.length;i++)n=d[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Yc(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function s(d,f){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,y=i.has(d);if(oa(!y,"Warning: There may be circular references"),y)return!1;if(d===f)return!0;if(n&&o>1)return!1;i.add(d);var b=o+1;if(Array.isArray(d)){if(!Array.isArray(f)||d.length!==f.length)return!1;for(var C=0;C<d.length;C++)if(!s(d[C],f[C],b))return!1;return!0}if(d&&f&&Nr(d)==="object"&&Nr(f)==="object"){var P=Object.keys(d);return P.length!==Object.keys(f).length?!1:P.every(function(A){return s(d[A],f[A],b)})}return!1}return s(e,t)}var AJ="%";function MM(e){return e.join(AJ)}var OJ=function(){function e(t){ja(this,e),ke(this,"instanceId",void 0),ke(this,"cache",new Map),ke(this,"extracted",new Set),this.instanceId=t}return Va(e,[{key:"get",value:function(n){return this.opGet(MM(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,i){return this.opUpdate(MM(n),i)}},{key:"opUpdate",value:function(n,i){var s=this.cache.get(n),d=i(s);d===null?this.cache.delete(n):this.cache.set(n,d)}}]),e}(),Rv="data-token-hash",qc="data-css-hash",Hh="__cssinjs_instance__";function DJ(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(qc,"]"))||[],n=document.head.firstChild;Array.from(t).forEach(function(s){s[Hh]=s[Hh]||e,s[Hh]===e&&document.head.insertBefore(s,n)});var i={};Array.from(document.querySelectorAll("style[".concat(qc,"]"))).forEach(function(s){var d=s.getAttribute(qc);if(i[d]){if(s[Hh]===e){var f;(f=s.parentNode)===null||f===void 0||f.removeChild(s)}}else i[d]=!0})}return new OJ(e)}var eb=I.createContext({hashPriority:"low",cache:DJ(),defaultCache:!0});function LJ(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var mO=function(){function e(){ja(this,e),ke(this,"cache",void 0),ke(this,"keys",void 0),ke(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Va(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var i,s,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f={map:this.cache};return n.forEach(function(o){if(!f)f=void 0;else{var y;f=(y=f)===null||y===void 0||(y=y.map)===null||y===void 0?void 0:y.get(o)}}),(i=f)!==null&&i!==void 0&&i.value&&d&&(f.value[1]=this.cacheCallTimes++),(s=f)===null||s===void 0?void 0:s.value}},{key:"get",value:function(n){var i;return(i=this.internalGet(n,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,i){var s=this;if(!this.has(n)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var d=this.keys.reduce(function(b,C){var P=It(b,2),A=P[1];return s.internalGet(C)[1]<A?[C,s.internalGet(C)[1]]:b},[this.keys[0],this.cacheCallTimes]),f=It(d,1),o=f[0];this.delete(o)}this.keys.push(n)}var y=this.cache;n.forEach(function(b,C){if(C===n.length-1)y.set(b,{value:[i,s.cacheCallTimes++]});else{var P=y.get(b);P?P.map||(P.map=new Map):y.set(b,{map:new Map}),y=y.get(b).map}})}},{key:"deleteByPath",value:function(n,i){var s=n.get(i[0]);if(i.length===1){var d;return s.map?n.set(i[0],{map:s.map}):n.delete(i[0]),(d=s.value)===null||d===void 0?void 0:d[0]}var f=this.deleteByPath(s.map,i.slice(1));return(!s.map||s.map.size===0)&&!s.value&&n.delete(i[0]),f}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(i){return!LJ(i,n)}),this.deleteByPath(this.cache,n)}}]),e}();ke(mO,"MAX_CACHE_SIZE",20);ke(mO,"MAX_CACHE_OFFSET",5);var p3=0,G6=function(){function e(t){ja(this,e),ke(this,"derivatives",void 0),ke(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=p3,t.length===0&&(t.length>0,void 0),p3+=1}return Va(e,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(i,s){return s(n,i)},void 0)}}]),e}(),PI=new mO;function RM(e){var t=Array.isArray(e)?e:[e];return PI.has(t)||PI.set(t,new G6(t)),PI.get(t)}var zJ=new WeakMap,MI={};function kJ(e,t){for(var n=zJ,i=0;i<t.length;i+=1){var s=t[i];n.has(s)||n.set(s,new WeakMap),n=n.get(s)}return n.has(MI)||n.set(MI,e()),n.get(MI)}var m3=new WeakMap;function H0(e){var t=m3.get(e)||"";return t||(Object.keys(e).forEach(function(n){var i=e[n];t+=n,i instanceof G6?t+=i.id:i&&Nr(i)==="object"?t+=H0(i):t+=i}),t=Cx(t),m3.set(e,t)),t}function g3(e,t){return Cx("".concat(t,"_").concat(H0(e)))}var AM=Bs();function dt(e){return typeof e=="number"?"".concat(e,"px"):e}function nC(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(s)return e;var d=Je(Je({},i),{},ke(ke({},Rv,t),qc,n)),f=Object.keys(d).map(function(o){var y=d[o];return y?"".concat(o,'="').concat(y,'"'):null}).filter(function(o){return o}).join(" ");return"<style ".concat(f,">").concat(e,"</style>")}var cS=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(t).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},FJ=function(t,n,i){return Object.keys(t).length?".".concat(n).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(t).map(function(s){var d=It(s,2),f=d[0],o=d[1];return"".concat(f,":").concat(o,";")}).join(""),"}"):""},W6=function(t,n,i){var s={},d={};return Object.entries(t).forEach(function(f){var o,y,b=It(f,2),C=b[0],P=b[1];if(i!=null&&(o=i.preserve)!==null&&o!==void 0&&o[C])d[C]=P;else if((typeof P=="string"||typeof P=="number")&&!(i!=null&&(y=i.ignore)!==null&&y!==void 0&&y[C])){var A,D=cS(C,i==null?void 0:i.prefix);s[D]=typeof P=="number"&&!(i!=null&&(A=i.unitless)!==null&&A!==void 0&&A[C])?"".concat(P,"px"):String(P),d[C]="var(".concat(D,")")}}),[d,FJ(s,n,{scope:i==null?void 0:i.scope})]},v3=Bs()?I.useLayoutEffect:I.useEffect,yo=function(t,n){var i=I.useRef(!0);v3(function(){return t(i.current)},n),v3(function(){return i.current=!1,function(){i.current=!0}},[])},OM=function(t,n){yo(function(i){if(!i)return t()},n)},NJ=Je({},qx),_3=NJ.useInsertionEffect,BJ=function(t,n,i){I.useMemo(t,i),yo(function(){return n(!0)},i)},$J=_3?function(e,t,n){return _3(function(){return e(),t()},n)}:BJ,jJ=Je({},qx),VJ=jJ.useInsertionEffect,UJ=function(t){var n=[],i=!1;function s(d){i||n.push(d)}return I.useEffect(function(){return i=!1,function(){i=!0,n.length&&n.forEach(function(d){return d()})}},t),s},HJ=function(){return function(t){t()}},GJ=typeof VJ<"u"?UJ:HJ;function gO(e,t,n,i,s){var d=I.useContext(eb),f=d.cache,o=[e].concat(zn(t)),y=MM(o),b=GJ([y]),C=function(k){f.opUpdate(y,function(B){var N=B||[void 0,void 0],j=It(N,2),V=j[0],K=V===void 0?0:V,Y=j[1],Z=Y,te=Z||n(),ne=[K,te];return k?k(ne):ne})};I.useMemo(function(){C()},[y]);var P=f.opGet(y),A=P[1];return $J(function(){s==null||s(A)},function(D){return C(function(k){var B=It(k,2),N=B[0],j=B[1];return D&&N===0&&(s==null||s(A)),[N+1,j]}),function(){f.opUpdate(y,function(k){var B=k||[],N=It(B,2),j=N[0],V=j===void 0?0:j,K=N[1],Y=V-1;return Y===0?(b(function(){(D||!f.opGet(y))&&(i==null||i(K,!1))}),null):[V-1,K]})}},[y]),A}var WJ={},qJ="css",Mp=new Map;function KJ(e){Mp.set(e,(Mp.get(e)||0)+1)}function XJ(e,t){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(Rv,'="').concat(e,'"]'));n.forEach(function(i){if(i[Hh]===t){var s;(s=i.parentNode)===null||s===void 0||s.removeChild(i)}})}}var ZJ=0;function YJ(e,t){Mp.set(e,(Mp.get(e)||0)-1);var n=new Set;Mp.forEach(function(i,s){i<=0&&n.add(s)}),Mp.size-n.size>ZJ&&n.forEach(function(i){XJ(i,t),Mp.delete(i)})}var JJ=function(t,n,i,s){var d=i.getDerivativeToken(t),f=Je(Je({},d),n);return s&&(f=s(f)),f},q6="token";function QJ(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=I.useContext(eb),s=i.cache.instanceId,d=i.container,f=n.salt,o=f===void 0?"":f,y=n.override,b=y===void 0?WJ:y,C=n.formatToken,P=n.getComputedToken,A=n.cssVar,D=kJ(function(){return Object.assign.apply(Object,[{}].concat(zn(t)))},t),k=H0(D),B=H0(b),N=A?H0(A):"",j=gO(q6,[o,e.id,k,B,N],function(){var V,K=P?P(D,b,e):JJ(D,b,e,C),Y=Je({},K),Z="";if(A){var te=W6(K,A.key,{prefix:A.prefix,ignore:A.ignore,unitless:A.unitless,preserve:A.preserve}),ne=It(te,2);K=ne[0],Z=ne[1]}var se=g3(K,o);K._tokenKey=se,Y._tokenKey=g3(Y,o);var ee=(V=A==null?void 0:A.key)!==null&&V!==void 0?V:se;K._themeKey=ee,KJ(ee);var de="".concat(qJ,"-").concat(Cx(se));return K._hashId=de,[K,de,Y,Z,(A==null?void 0:A.key)||""]},function(V){YJ(V[0]._themeKey,s)},function(V){var K=It(V,4),Y=K[0],Z=K[3];if(A&&Z){var te=Od(Z,Cx("css-variables-".concat(Y._themeKey)),{mark:qc,prepend:"queue",attachTo:d,priority:-999});te[Hh]=s,te.setAttribute(Rv,Y._themeKey)}});return j}var eQ=function(t,n,i){var s=It(t,5),d=s[2],f=s[3],o=s[4],y=i||{},b=y.plain;if(!f)return null;var C=d._tokenKey,P=-999,A={"data-rc-order":"prependQueue","data-rc-priority":"".concat(P)},D=nC(f,o,C,A,b);return[P,C,D]},tQ={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},K6="comm",X6="rule",Z6="decl",nQ="@import",rQ="@namespace",iQ="@keyframes",oQ="@layer",Y6=Math.abs,vO=String.fromCharCode;function J6(e){return e.trim()}function uS(e,t,n){return e.replace(t,n)}function aQ(e,t,n){return e.indexOf(t,n)}function gv(e,t){return e.charCodeAt(t)|0}function Av(e,t,n){return e.slice(t,n)}function Pu(e){return e.length}function sQ(e){return e.length}function Sw(e,t){return t.push(e),e}var oE=1,Ov=1,Q6=0,_c=0,Xa=0,Wv="";function _O(e,t,n,i,s,d,f,o){return{value:e,root:t,parent:n,type:i,props:s,children:d,line:oE,column:Ov,length:f,return:"",siblings:o}}function lQ(){return Xa}function cQ(){return Xa=_c>0?gv(Wv,--_c):0,Ov--,Xa===10&&(Ov=1,oE--),Xa}function Kc(){return Xa=_c<Q6?gv(Wv,_c++):0,Ov++,Xa===10&&(Ov=1,oE++),Xa}function Gh(){return gv(Wv,_c)}function dS(){return _c}function aE(e,t){return Av(Wv,e,t)}function Tx(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function uQ(e){return oE=Ov=1,Q6=Pu(Wv=e),_c=0,[]}function dQ(e){return Wv="",e}function RI(e){return J6(aE(_c-1,DM(e===91?e+2:e===40?e+1:e)))}function hQ(e){for(;(Xa=Gh())&&Xa<33;)Kc();return Tx(e)>2||Tx(Xa)>3?"":" "}function fQ(e,t){for(;--t&&Kc()&&!(Xa<48||Xa>102||Xa>57&&Xa<65||Xa>70&&Xa<97););return aE(e,dS()+(t<6&&Gh()==32&&Kc()==32))}function DM(e){for(;Kc();)switch(Xa){case e:return _c;case 34:case 39:e!==34&&e!==39&&DM(Xa);break;case 40:e===41&&DM(e);break;case 92:Kc();break}return _c}function pQ(e,t){for(;Kc()&&e+Xa!==57;)if(e+Xa===84&&Gh()===47)break;return"/*"+aE(t,_c-1)+"*"+vO(e===47?e:Kc())}function mQ(e){for(;!Tx(Gh());)Kc();return aE(e,_c)}function gQ(e){return dQ(hS("",null,null,null,[""],e=uQ(e),0,[0],e))}function hS(e,t,n,i,s,d,f,o,y){for(var b=0,C=0,P=f,A=0,D=0,k=0,B=1,N=1,j=1,V=0,K="",Y=s,Z=d,te=i,ne=K;N;)switch(k=V,V=Kc()){case 40:if(k!=108&&gv(ne,P-1)==58){aQ(ne+=uS(RI(V),"&","&\f"),"&\f",Y6(b?o[b-1]:0))!=-1&&(j=-1);break}case 34:case 39:case 91:ne+=RI(V);break;case 9:case 10:case 13:case 32:ne+=hQ(k);break;case 92:ne+=fQ(dS()-1,7);continue;case 47:switch(Gh()){case 42:case 47:Sw(vQ(pQ(Kc(),dS()),t,n,y),y),(Tx(k||1)==5||Tx(Gh()||1)==5)&&Pu(ne)&&Av(ne,-1,void 0)!==" "&&(ne+=" ");break;default:ne+="/"}break;case 123*B:o[b++]=Pu(ne)*j;case 125*B:case 59:case 0:switch(V){case 0:case 125:N=0;case 59+C:j==-1&&(ne=uS(ne,/\f/g,"")),D>0&&(Pu(ne)-P||B===0&&k===47)&&Sw(D>32?x3(ne+";",i,n,P-1,y):x3(uS(ne," ","")+";",i,n,P-2,y),y);break;case 59:ne+=";";default:if(Sw(te=y3(ne,t,n,b,C,s,o,K,Y=[],Z=[],P,d),d),V===123)if(C===0)hS(ne,t,te,te,Y,d,P,o,Z);else{switch(A){case 99:if(gv(ne,3)===110)break;case 108:if(gv(ne,2)===97)break;default:C=0;case 100:case 109:case 115:}C?hS(e,te,te,i&&Sw(y3(e,te,te,0,0,s,o,K,s,Y=[],P,Z),Z),s,Z,P,o,i?Y:Z):hS(ne,te,te,te,[""],Z,0,o,Z)}}b=C=D=0,B=j=1,K=ne="",P=f;break;case 58:P=1+Pu(ne),D=k;default:if(B<1){if(V==123)--B;else if(V==125&&B++==0&&cQ()==125)continue}switch(ne+=vO(V),V*B){case 38:j=C>0?1:(ne+="\f",-1);break;case 44:o[b++]=(Pu(ne)-1)*j,j=1;break;case 64:Gh()===45&&(ne+=RI(Kc())),A=Gh(),C=P=Pu(K=ne+=mQ(dS())),V++;break;case 45:k===45&&Pu(ne)==2&&(B=0)}}return d}function y3(e,t,n,i,s,d,f,o,y,b,C,P){for(var A=s-1,D=s===0?d:[""],k=sQ(D),B=0,N=0,j=0;B<i;++B)for(var V=0,K=Av(e,A+1,A=Y6(N=f[B])),Y=e;V<k;++V)(Y=J6(N>0?D[V]+" "+K:uS(K,/&\f/g,D[V])))&&(y[j++]=Y);return _O(e,t,n,s===0?X6:o,y,b,C,P)}function vQ(e,t,n,i){return _O(e,t,n,K6,vO(lQ()),Av(e,2,-2),0,i)}function x3(e,t,n,i,s){return _O(e,t,n,Z6,Av(e,0,i),Av(e,i+1,-1),i,s)}function LM(e,t){for(var n="",i=0;i<e.length;i++)n+=t(e[i],i,e,t)||"";return n}function _Q(e,t,n,i){switch(e.type){case oQ:if(e.children.length)break;case nQ:case rQ:case Z6:return e.return=e.return||e.value;case K6:return"";case iQ:return e.return=e.value+"{"+LM(e.children,i)+"}";case X6:if(!Pu(e.value=e.props.join(",")))return""}return Pu(n=LM(e.children,i))?e.return=e.value+"{"+n+"}":""}var b3="data-ant-cssinjs-cache-path",eU="_FILE_STYLE__",Bp,tU=!0;function yQ(){if(!Bp&&(Bp={},Bs())){var e=document.createElement("div");e.className=b3,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var t=getComputedStyle(e).content||"";t=t.replace(/^"/,"").replace(/"$/,""),t.split(";").forEach(function(s){var d=s.split(":"),f=It(d,2),o=f[0],y=f[1];Bp[o]=y});var n=document.querySelector("style[".concat(b3,"]"));if(n){var i;tU=!1,(i=n.parentNode)===null||i===void 0||i.removeChild(n)}document.body.removeChild(e)}}function xQ(e){return yQ(),!!Bp[e]}function bQ(e){var t=Bp[e],n=null;if(t&&Bs())if(tU)n=eU;else{var i=document.querySelector("style[".concat(qc,'="').concat(Bp[e],'"]'));i?n=i.innerHTML:delete Bp[e]}return[n,t]}var wQ="_skip_check_",nU="_multi_value_";function fS(e){var t=LM(gQ(e),_Q);return t.replace(/\{%%%\:[^;];}/g,";")}function SQ(e){return Nr(e)==="object"&&e&&(wQ in e||nU in e)}function w3(e,t,n){if(!t)return e;var i=".".concat(t),s=n==="low"?":where(".concat(i,")"):i,d=e.split(",").map(function(f){var o,y=f.trim().split(/\s+/),b=y[0]||"",C=((o=b.match(/^\w+/))===null||o===void 0?void 0:o[0])||"";return b="".concat(C).concat(s).concat(b.slice(C.length)),[b].concat(zn(y.slice(1))).join(" ")});return d.join(",")}var CQ=function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},s=i.root,d=i.injectHash,f=i.parentSelectors,o=n.hashId,y=n.layer;n.path;var b=n.hashPriority,C=n.transformers,P=C===void 0?[]:C;n.linters;var A="",D={};function k(j){var V=j.getName(o);if(!D[V]){var K=e(j.style,n,{root:!1,parentSelectors:f}),Y=It(K,1),Z=Y[0];D[V]="@keyframes ".concat(j.getName(o)).concat(Z)}}function B(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return j.forEach(function(K){Array.isArray(K)?B(K,V):K&&V.push(K)}),V}var N=B(Array.isArray(t)?t:[t]);return N.forEach(function(j){var V=typeof j=="string"&&!s?{}:j;if(typeof V=="string")A+="".concat(V,`
`);else if(V._keyframe)k(V);else{var K=P.reduce(function(Y,Z){var te;return(Z==null||(te=Z.visit)===null||te===void 0?void 0:te.call(Z,Y))||Y},V);Object.keys(K).forEach(function(Y){var Z=K[Y];if(Nr(Z)==="object"&&Z&&(Y!=="animationName"||!Z._keyframe)&&!SQ(Z)){var te=!1,ne=Y.trim(),se=!1;(s||d)&&o?ne.startsWith("@")?te=!0:ne==="&"?ne=w3("",o,b):ne=w3(Y,o,b):s&&!o&&(ne==="&"||ne==="")&&(ne="",se=!0);var ee=e(Z,n,{root:se,injectHash:te,parentSelectors:[].concat(zn(f),[ne])}),de=It(ee,2),fe=de[0],ye=de[1];D=Je(Je({},D),ye),A+="".concat(ne).concat(fe)}else{let Se=function(xe,Te){var ze=xe.replace(/[A-Z]/g,function(We){return"-".concat(We.toLowerCase())}),Ue=Te;!tQ[xe]&&typeof Ue=="number"&&Ue!==0&&(Ue="".concat(Ue,"px")),xe==="animationName"&&Te!==null&&Te!==void 0&&Te._keyframe&&(k(Te),Ue=Te.getName(o)),A+="".concat(ze,":").concat(Ue,";")};var ge,we=(ge=Z==null?void 0:Z.value)!==null&&ge!==void 0?ge:Z;Nr(Z)==="object"&&Z!==null&&Z!==void 0&&Z[nU]&&Array.isArray(we)?we.forEach(function(xe){Se(Y,xe)}):Se(Y,we)}})}}),s?y&&(A&&(A="@layer ".concat(y.name," {").concat(A,"}")),y.dependencies&&(D["@layer ".concat(y.name)]=y.dependencies.map(function(j){return"@layer ".concat(j,", ").concat(y.name,";")}).join(`
`))):A="{".concat(A,"}"),[A,D]};function rU(e,t){return Cx("".concat(e.join("%")).concat(t))}function EQ(){return null}var iU="style";function zM(e,t){var n=e.token,i=e.path,s=e.hashId,d=e.layer,f=e.nonce,o=e.clientOnly,y=e.order,b=y===void 0?0:y,C=I.useContext(eb),P=C.autoClear;C.mock;var A=C.defaultCache,D=C.hashPriority,k=C.container,B=C.ssrInline,N=C.transformers,j=C.linters,V=C.cache,K=C.layer,Y=n._tokenKey,Z=[Y];K&&Z.push("layer"),Z.push.apply(Z,zn(i));var te=AM,ne=gO(iU,Z,function(){var ye=Z.join("|");if(xQ(ye)){var ge=bQ(ye),we=It(ge,2),Se=we[0],xe=we[1];if(Se)return[Se,Y,xe,{},o,b]}var Te=t(),ze=CQ(Te,{hashId:s,hashPriority:D,layer:K?d:void 0,path:i.join("-"),transformers:N,linters:j}),Ue=It(ze,2),We=Ue[0],Be=Ue[1],Xe=fS(We),qe=rU(Z,Xe);return[Xe,Y,qe,Be,o,b]},function(ye,ge){var we=It(ye,3),Se=we[2];(ge||P)&&AM&&Ex(Se,{mark:qc,attachTo:k})},function(ye){var ge=It(ye,4),we=ge[0];ge[1];var Se=ge[2],xe=ge[3];if(te&&we!==eU){var Te={mark:qc,prepend:K?!1:"queue",attachTo:k,priority:b},ze=typeof f=="function"?f():f;ze&&(Te.csp={nonce:ze});var Ue=[],We=[];Object.keys(xe).forEach(function(Xe){Xe.startsWith("@layer")?Ue.push(Xe):We.push(Xe)}),Ue.forEach(function(Xe){Od(fS(xe[Xe]),"_layer-".concat(Xe),Je(Je({},Te),{},{prepend:!0}))});var Be=Od(we,Se,Te);Be[Hh]=V.instanceId,Be.setAttribute(Rv,Y),We.forEach(function(Xe){Od(fS(xe[Xe]),"_effect-".concat(Xe),Te)})}}),se=It(ne,3),ee=se[0],de=se[1],fe=se[2];return function(ye){var ge;return!B||te||!A?ge=I.createElement(EQ,null):ge=I.createElement("style",kn({},ke(ke({},Rv,de),qc,fe),{dangerouslySetInnerHTML:{__html:ee}})),I.createElement(I.Fragment,null,ge,ye)}}var TQ=function(t,n,i){var s=It(t,6),d=s[0],f=s[1],o=s[2],y=s[3],b=s[4],C=s[5],P=i||{},A=P.plain;if(b)return null;var D=d,k={"data-rc-order":"prependQueue","data-rc-priority":"".concat(C)};return D=nC(d,f,o,k,A),y&&Object.keys(y).forEach(function(B){if(!n[B]){n[B]=!0;var N=fS(y[B]),j=nC(N,f,"_effect-".concat(B),k,A);B.startsWith("@layer")?D=j+D:D+=j}}),[C,o,D]},oU="cssVar",IQ=function(t,n){var i=t.key,s=t.prefix,d=t.unitless,f=t.ignore,o=t.token,y=t.scope,b=y===void 0?"":y,C=I.useContext(eb),P=C.cache.instanceId,A=C.container,D=o._tokenKey,k=[].concat(zn(t.path),[i,b,D]),B=gO(oU,k,function(){var N=n(),j=W6(N,i,{prefix:s,unitless:d,ignore:f,scope:b}),V=It(j,2),K=V[0],Y=V[1],Z=rU(k,Y);return[K,Y,Z,i]},function(N){var j=It(N,3),V=j[2];AM&&Ex(V,{mark:qc,attachTo:A})},function(N){var j=It(N,3),V=j[1],K=j[2];if(V){var Y=Od(V,K,{mark:qc,prepend:"queue",attachTo:A,priority:-999});Y[Hh]=P,Y.setAttribute(Rv,i)}});return B},PQ=function(t,n,i){var s=It(t,4),d=s[1],f=s[2],o=s[3],y=i||{},b=y.plain;if(!d)return null;var C=-999,P={"data-rc-order":"prependQueue","data-rc-priority":"".concat(C)},A=nC(d,o,f,P,b);return[C,f,A]};ke(ke(ke({},iU,TQ),q6,eQ),oU,PQ);var Mo=function(){function e(t,n){ja(this,e),ke(this,"name",void 0),ke(this,"style",void 0),ke(this,"_keyframe",!0),this.name=t,this.style=n}return Va(e,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),e}();function Lg(e){return e.notSplit=!0,e}Lg(["borderTop","borderBottom"]),Lg(["borderTop"]),Lg(["borderBottom"]),Lg(["borderLeft","borderRight"]),Lg(["borderLeft"]),Lg(["borderRight"]);var yO=I.createContext({});function aU(e){return $6(e)||k6(e)||hO(e)||j6()}function Ul(e,t){for(var n=e,i=0;i<t.length;i+=1){if(n==null)return;n=n[t[i]]}return n}function sU(e,t,n,i){if(!t.length)return n;var s=aU(t),d=s[0],f=s.slice(1),o;return!e&&typeof d=="number"?o=[]:Array.isArray(e)?o=zn(e):o=Je({},e),i&&n===void 0&&f.length===1?delete o[d][f[0]]:o[d]=sU(o[d],f,n,i),o}function $c(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.length&&i&&n===void 0&&!Ul(e,t.slice(0,-1))?e:sU(e,t,n,i)}function MQ(e){return Nr(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function S3(e){return Array.isArray(e)?[]:{}}var RQ=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function av(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=S3(t[0]);return t.forEach(function(s){function d(f,o){var y=new Set(o),b=Ul(s,f),C=Array.isArray(b);if(C||MQ(b)){if(!y.has(b)){y.add(b);var P=Ul(i,f);C?i=$c(i,f,[]):(!P||Nr(P)!=="object")&&(i=$c(i,f,S3(b))),RQ(b).forEach(function(A){d([].concat(zn(f),[A]),y)})}}else i=$c(i,f,b)}d([])}),i}function AQ(){}const OQ=I.createContext({}),qv=()=>{const e=()=>{};return e.deprecated=AQ,e},DQ=I.createContext(void 0);var lU={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},LQ={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},zQ=Je(Je({},LQ),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",week:"Week",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const cU={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},C3={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},zQ),timePickerLocale:Object.assign({},cU)},Nl="${label} is not a valid ${type}",uf={locale:"en",Pagination:lU,DatePicker:C3,TimePicker:cU,Calendar:C3,global:{placeholder:"Please select",close:"Close"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckAll:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Nl,method:Nl,array:Nl,object:Nl,number:Nl,date:Nl,boolean:Nl,integer:Nl,float:Nl,regexp:Nl,email:Nl,url:Nl,hex:Nl},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};Object.assign({},uf.Modal);let pS=[];const E3=()=>pS.reduce((e,t)=>Object.assign(Object.assign({},e),t),uf.Modal);function kQ(e){if(e){const t=Object.assign({},e);return pS.push(t),E3(),()=>{pS=pS.filter(n=>n!==t),E3()}}Object.assign({},uf.Modal)}const xO=I.createContext(void 0),tb=(e,t)=>{const n=I.useContext(xO),i=I.useMemo(()=>{var d;const f=t||uf[e],o=(d=n==null?void 0:n[e])!==null&&d!==void 0?d:{};return Object.assign(Object.assign({},typeof f=="function"?f():f),o||{})},[e,t,n]),s=I.useMemo(()=>{const d=n==null?void 0:n.locale;return n!=null&&n.exist&&!d?uf.locale:d},[n]);return[i,s]},FQ="internalMark",NQ=e=>{const{locale:t={},children:n,_ANT_MARK__:i}=e;I.useEffect(()=>kQ(t==null?void 0:t.Modal),[t]);const s=I.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return I.createElement(xO.Provider,{value:s},n)},uU={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Ix=Object.assign(Object.assign({},uU),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),us=Math.round;function AI(e,t){const n=e.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=n.map(s=>parseFloat(s));for(let s=0;s<3;s+=1)i[s]=t(i[s]||0,n[s]||"",s);return n[3]?i[3]=n[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const T3=(e,t,n)=>n===0?e:e/100;function u0(e,t){const n=t||255;return e>n?n:e<0?0:e}class no{constructor(t){ke(this,"isValid",!0),ke(this,"r",0),ke(this,"g",0),ke(this,"b",0),ke(this,"a",1),ke(this,"_h",void 0),ke(this,"_s",void 0),ke(this,"_l",void 0),ke(this,"_v",void 0),ke(this,"_max",void 0),ke(this,"_min",void 0),ke(this,"_brightness",void 0);function n(s){return s[0]in t&&s[1]in t&&s[2]in t}if(t)if(typeof t=="string"){let d=function(f){return s.startsWith(f)};var i=d;const s=t.trim();/^#?[A-F\d]{3,8}$/i.test(s)?this.fromHexString(s):d("rgb")?this.fromRgbString(s):d("hsl")?this.fromHslString(s):(d("hsv")||d("hsb"))&&this.fromHsvString(s)}else if(t instanceof no)this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this._h=t._h,this._s=t._s,this._l=t._l,this._v=t._v;else if(n("rgb"))this.r=u0(t.r),this.g=u0(t.g),this.b=u0(t.b),this.a=typeof t.a=="number"?u0(t.a,1):1;else if(n("hsl"))this.fromHsl(t);else if(n("hsv"))this.fromHsv(t);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(t))}setR(t){return this._sc("r",t)}setG(t){return this._sc("g",t)}setB(t){return this._sc("b",t)}setA(t){return this._sc("a",t,1)}setHue(t){const n=this.toHsv();return n.h=t,this._c(n)}getLuminance(){function t(d){const f=d/255;return f<=.03928?f/12.92:Math.pow((f+.055)/1.055,2.4)}const n=t(this.r),i=t(this.g),s=t(this.b);return .2126*n+.7152*i+.0722*s}getHue(){if(typeof this._h>"u"){const t=this.getMax()-this.getMin();t===0?this._h=0:this._h=us(60*(this.r===this.getMax()?(this.g-this.b)/t+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/t+2:(this.r-this.g)/t+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const t=this.getMax()-this.getMin();t===0?this._s=0:this._s=t/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(t=10){const n=this.getHue(),i=this.getSaturation();let s=this.getLightness()-t/100;return s<0&&(s=0),this._c({h:n,s:i,l:s,a:this.a})}lighten(t=10){const n=this.getHue(),i=this.getSaturation();let s=this.getLightness()+t/100;return s>1&&(s=1),this._c({h:n,s:i,l:s,a:this.a})}mix(t,n=50){const i=this._c(t),s=n/100,d=o=>(i[o]-this[o])*s+this[o],f={r:us(d("r")),g:us(d("g")),b:us(d("b")),a:us(d("a")*100)/100};return this._c(f)}tint(t=10){return this.mix({r:255,g:255,b:255,a:1},t)}shade(t=10){return this.mix({r:0,g:0,b:0,a:1},t)}onBackground(t){const n=this._c(t),i=this.a+n.a*(1-this.a),s=d=>us((this[d]*this.a+n[d]*n.a*(1-this.a))/i);return this._c({r:s("r"),g:s("g"),b:s("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}clone(){return this._c(this)}toHexString(){let t="#";const n=(this.r||0).toString(16);t+=n.length===2?n:"0"+n;const i=(this.g||0).toString(16);t+=i.length===2?i:"0"+i;const s=(this.b||0).toString(16);if(t+=s.length===2?s:"0"+s,typeof this.a=="number"&&this.a>=0&&this.a<1){const d=us(this.a*255).toString(16);t+=d.length===2?d:"0"+d}return t}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const t=this.getHue(),n=us(this.getSaturation()*100),i=us(this.getLightness()*100);return this.a!==1?`hsla(${t},${n}%,${i}%,${this.a})`:`hsl(${t},${n}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(t,n,i){const s=this.clone();return s[t]=u0(n,i),s}_c(t){return new this.constructor(t)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(t){const n=t.replace("#","");function i(s,d){return parseInt(n[s]+n[d||s],16)}n.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=n[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=n[6]?i(6,7)/255:1)}fromHsl({h:t,s:n,l:i,a:s}){if(this._h=t%360,this._s=n,this._l=i,this.a=typeof s=="number"?s:1,n<=0){const A=us(i*255);this.r=A,this.g=A,this.b=A}let d=0,f=0,o=0;const y=t/60,b=(1-Math.abs(2*i-1))*n,C=b*(1-Math.abs(y%2-1));y>=0&&y<1?(d=b,f=C):y>=1&&y<2?(d=C,f=b):y>=2&&y<3?(f=b,o=C):y>=3&&y<4?(f=C,o=b):y>=4&&y<5?(d=C,o=b):y>=5&&y<6&&(d=b,o=C);const P=i-b/2;this.r=us((d+P)*255),this.g=us((f+P)*255),this.b=us((o+P)*255)}fromHsv({h:t,s:n,v:i,a:s}){this._h=t%360,this._s=n,this._v=i,this.a=typeof s=="number"?s:1;const d=us(i*255);if(this.r=d,this.g=d,this.b=d,n<=0)return;const f=t/60,o=Math.floor(f),y=f-o,b=us(i*(1-n)*255),C=us(i*(1-n*y)*255),P=us(i*(1-n*(1-y))*255);switch(o){case 0:this.g=P,this.b=b;break;case 1:this.r=C,this.b=b;break;case 2:this.r=b,this.b=P;break;case 3:this.r=b,this.g=C;break;case 4:this.r=P,this.g=b;break;case 5:default:this.g=b,this.b=C;break}}fromHsvString(t){const n=AI(t,T3);this.fromHsv({h:n[0],s:n[1],v:n[2],a:n[3]})}fromHslString(t){const n=AI(t,T3);this.fromHsl({h:n[0],s:n[1],l:n[2],a:n[3]})}fromRgbString(t){const n=AI(t,(i,s)=>s.includes("%")?us(i/100*255):i);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}}var Cw=2,I3=.16,BQ=.05,$Q=.05,jQ=.15,dU=5,hU=4,VQ=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function P3(e,t,n){var i;return Math.round(e.h)>=60&&Math.round(e.h)<=240?i=n?Math.round(e.h)-Cw*t:Math.round(e.h)+Cw*t:i=n?Math.round(e.h)+Cw*t:Math.round(e.h)-Cw*t,i<0?i+=360:i>=360&&(i-=360),i}function M3(e,t,n){if(e.h===0&&e.s===0)return e.s;var i;return n?i=e.s-I3*t:t===hU?i=e.s+I3:i=e.s+BQ*t,i>1&&(i=1),n&&t===dU&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function R3(e,t,n){var i;return n?i=e.v+$Q*t:i=e.v-jQ*t,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function Px(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=new no(e),s=i.toHsv(),d=dU;d>0;d-=1){var f=new no({h:P3(s,d,!0),s:M3(s,d,!0),v:R3(s,d,!0)});n.push(f)}n.push(i);for(var o=1;o<=hU;o+=1){var y=new no({h:P3(s,o),s:M3(s,o),v:R3(s,o)});n.push(y)}return t.theme==="dark"?VQ.map(function(b){var C=b.index,P=b.amount;return new no(t.backgroundColor||"#141414").mix(n[C],P).toHexString()}):n.map(function(b){return b.toHexString()})}var OI={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},kM=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];kM.primary=kM[5];var FM=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];FM.primary=FM[5];var NM=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];NM.primary=NM[5];var BM=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];BM.primary=BM[5];var $M=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];$M.primary=$M[5];var jM=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];jM.primary=jM[5];var VM=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];VM.primary=VM[5];var UM=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];UM.primary=UM[5];var rC=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];rC.primary=rC[5];var HM=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];HM.primary=HM[5];var GM=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];GM.primary=GM[5];var WM=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];WM.primary=WM[5];var qM=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];qM.primary=qM[5];var DI={red:kM,volcano:FM,orange:NM,gold:BM,yellow:$M,lime:jM,green:VM,cyan:UM,blue:rC,geekblue:HM,purple:GM,magenta:WM,grey:qM};function UQ(e,{generateColorPalettes:t,generateNeutralColorPalettes:n}){const{colorSuccess:i,colorWarning:s,colorError:d,colorInfo:f,colorPrimary:o,colorBgBase:y,colorTextBase:b}=e,C=t(o),P=t(i),A=t(s),D=t(d),k=t(f),B=n(y,b),N=e.colorLink||e.colorInfo,j=t(N),V=new no(D[1]).mix(new no(D[3]),50).toHexString();return Object.assign(Object.assign({},B),{colorPrimaryBg:C[1],colorPrimaryBgHover:C[2],colorPrimaryBorder:C[3],colorPrimaryBorderHover:C[4],colorPrimaryHover:C[5],colorPrimary:C[6],colorPrimaryActive:C[7],colorPrimaryTextHover:C[8],colorPrimaryText:C[9],colorPrimaryTextActive:C[10],colorSuccessBg:P[1],colorSuccessBgHover:P[2],colorSuccessBorder:P[3],colorSuccessBorderHover:P[4],colorSuccessHover:P[4],colorSuccess:P[6],colorSuccessActive:P[7],colorSuccessTextHover:P[8],colorSuccessText:P[9],colorSuccessTextActive:P[10],colorErrorBg:D[1],colorErrorBgHover:D[2],colorErrorBgFilledHover:V,colorErrorBgActive:D[3],colorErrorBorder:D[3],colorErrorBorderHover:D[4],colorErrorHover:D[5],colorError:D[6],colorErrorActive:D[7],colorErrorTextHover:D[8],colorErrorText:D[9],colorErrorTextActive:D[10],colorWarningBg:A[1],colorWarningBgHover:A[2],colorWarningBorder:A[3],colorWarningBorderHover:A[4],colorWarningHover:A[4],colorWarning:A[6],colorWarningActive:A[7],colorWarningTextHover:A[8],colorWarningText:A[9],colorWarningTextActive:A[10],colorInfoBg:k[1],colorInfoBgHover:k[2],colorInfoBorder:k[3],colorInfoBorderHover:k[4],colorInfoHover:k[4],colorInfo:k[6],colorInfoActive:k[7],colorInfoTextHover:k[8],colorInfoText:k[9],colorInfoTextActive:k[10],colorLinkHover:j[4],colorLink:j[6],colorLinkActive:j[7],colorBgMask:new no("#000").setA(.45).toRgbString(),colorWhite:"#fff"})}const HQ=e=>{let t=e,n=e,i=e,s=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?i=1:e>=6&&(i=2),e>4&&e<8?s=4:e>=8&&(s=6),{borderRadius:e,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:s}};function GQ(e){const{motionUnit:t,motionBase:n,borderRadius:i,lineWidth:s}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+t*2).toFixed(1)}s`,motionDurationSlow:`${(n+t*3).toFixed(1)}s`,lineWidthBold:s+1},HQ(i))}const WQ=e=>{const{controlHeight:t}=e;return{controlHeightSM:t*.75,controlHeightXS:t*.5,controlHeightLG:t*1.25}};function mS(e){return(e+8)/e}function qQ(e){const t=Array.from({length:10}).map((n,i)=>{const s=i-1,d=e*Math.pow(Math.E,s/5),f=i>1?Math.floor(d):Math.ceil(d);return Math.floor(f/2)*2});return t[1]=e,t.map(n=>({size:n,lineHeight:mS(n)}))}const KQ=e=>{const t=qQ(e),n=t.map(C=>C.size),i=t.map(C=>C.lineHeight),s=n[1],d=n[0],f=n[2],o=i[1],y=i[0],b=i[2];return{fontSizeSM:d,fontSize:s,fontSizeLG:f,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:o,lineHeightLG:b,lineHeightSM:y,fontHeight:Math.round(o*s),fontHeightLG:Math.round(b*f),fontHeightSM:Math.round(y*d),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function XQ(e){const{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}}const oc=(e,t)=>new no(e).setA(t).toRgbString(),d0=(e,t)=>new no(e).darken(t).toHexString(),ZQ=e=>{const t=Px(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},YQ=(e,t)=>{const n=e||"#fff",i=t||"#000";return{colorBgBase:n,colorTextBase:i,colorText:oc(i,.88),colorTextSecondary:oc(i,.65),colorTextTertiary:oc(i,.45),colorTextQuaternary:oc(i,.25),colorFill:oc(i,.15),colorFillSecondary:oc(i,.06),colorFillTertiary:oc(i,.04),colorFillQuaternary:oc(i,.02),colorBgSolid:oc(i,1),colorBgSolidHover:oc(i,.75),colorBgSolidActive:oc(i,.95),colorBgLayout:d0(n,4),colorBgContainer:d0(n,0),colorBgElevated:d0(n,0),colorBgSpotlight:oc(i,.85),colorBgBlur:"transparent",colorBorder:d0(n,15),colorBorderSecondary:d0(n,6)}};function JQ(e){OI.pink=OI.magenta,DI.pink=DI.magenta;const t=Object.keys(uU).map(n=>{const i=e[n]===OI[n]?DI[n]:Px(e[n]);return Array.from({length:10},()=>1).reduce((s,d,f)=>(s[`${n}-${f+1}`]=i[f],s[`${n}${f+1}`]=i[f],s),{})}).reduce((n,i)=>(n=Object.assign(Object.assign({},n),i),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),UQ(e,{generateColorPalettes:ZQ,generateNeutralColorPalettes:YQ})),KQ(e.fontSize)),XQ(e)),WQ(e)),GQ(e))}const fU=RM(JQ),KM={token:Ix,override:{override:Ix},hashed:!0},pU=Wt.createContext(KM),Mx="ant",bO="anticon",QQ=["outlined","borderless","filled","underlined"],eee=(e,t)=>t||(e?`${Mx}-${e}`:Mx),ji=I.createContext({getPrefixCls:eee,iconPrefixCls:bO}),{Consumer:Qxe}=ji,A3={};function Gu(e){const t=I.useContext(ji),{getPrefixCls:n,direction:i,getPopupContainer:s}=t,d=t[e];return Object.assign(Object.assign({classNames:A3,styles:A3},d),{getPrefixCls:n,direction:i,getPopupContainer:s})}const tee=`-ant-${Date.now()}-${Math.random()}`;function nee(e,t){const n={},i=(f,o)=>{let y=f.clone();return y=(o==null?void 0:o(y))||y,y.toRgbString()},s=(f,o)=>{const y=new no(f),b=Px(y.toRgbString());n[`${o}-color`]=i(y),n[`${o}-color-disabled`]=b[1],n[`${o}-color-hover`]=b[4],n[`${o}-color-active`]=b[6],n[`${o}-color-outline`]=y.clone().setA(.2).toRgbString(),n[`${o}-color-deprecated-bg`]=b[0],n[`${o}-color-deprecated-border`]=b[2]};if(t.primaryColor){s(t.primaryColor,"primary");const f=new no(t.primaryColor),o=Px(f.toRgbString());o.forEach((b,C)=>{n[`primary-${C+1}`]=b}),n["primary-color-deprecated-l-35"]=i(f,b=>b.lighten(35)),n["primary-color-deprecated-l-20"]=i(f,b=>b.lighten(20)),n["primary-color-deprecated-t-20"]=i(f,b=>b.tint(20)),n["primary-color-deprecated-t-50"]=i(f,b=>b.tint(50)),n["primary-color-deprecated-f-12"]=i(f,b=>b.setA(b.a*.12));const y=new no(o[0]);n["primary-color-active-deprecated-f-30"]=i(y,b=>b.setA(b.a*.3)),n["primary-color-active-deprecated-d-02"]=i(y,b=>b.darken(2))}return t.successColor&&s(t.successColor,"success"),t.warningColor&&s(t.warningColor,"warning"),t.errorColor&&s(t.errorColor,"error"),t.infoColor&&s(t.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(f=>`--${e}-${f}: ${n[f]};`).join(`
`)}
  }
  `.trim()}function ree(e,t){const n=nee(e,t);Bs()&&Od(n,`${tee}-dynamic-theme`)}const Fd=I.createContext(!1),iee=({children:e,disabled:t})=>{const n=I.useContext(Fd);return I.createElement(Fd.Provider,{value:t??n},e)},Dv=I.createContext(void 0),oee=({children:e,size:t})=>{const n=I.useContext(Dv);return I.createElement(Dv.Provider,{value:t||n},e)};function aee(){const e=I.useContext(Fd),t=I.useContext(Dv);return{componentDisabled:e,componentSize:t}}var mU=Va(function e(){ja(this,e)}),gU="CALC_UNIT",see=new RegExp(gU,"g");function LI(e){return typeof e=="number"?"".concat(e).concat(gU):e}var lee=function(e){Uu(n,e);var t=Hu(n);function n(i,s){var d;ja(this,n),d=t.call(this),ke(Mr(d),"result",""),ke(Mr(d),"unitlessCssVar",void 0),ke(Mr(d),"lowPriority",void 0);var f=Nr(i);return d.unitlessCssVar=s,i instanceof n?d.result="(".concat(i.result,")"):f==="number"?d.result=LI(i):f==="string"&&(d.result=i),d}return Va(n,[{key:"add",value:function(s){return s instanceof n?this.result="".concat(this.result," + ").concat(s.getResult()):(typeof s=="number"||typeof s=="string")&&(this.result="".concat(this.result," + ").concat(LI(s))),this.lowPriority=!0,this}},{key:"sub",value:function(s){return s instanceof n?this.result="".concat(this.result," - ").concat(s.getResult()):(typeof s=="number"||typeof s=="string")&&(this.result="".concat(this.result," - ").concat(LI(s))),this.lowPriority=!0,this}},{key:"mul",value:function(s){return this.lowPriority&&(this.result="(".concat(this.result,")")),s instanceof n?this.result="".concat(this.result," * ").concat(s.getResult(!0)):(typeof s=="number"||typeof s=="string")&&(this.result="".concat(this.result," * ").concat(s)),this.lowPriority=!1,this}},{key:"div",value:function(s){return this.lowPriority&&(this.result="(".concat(this.result,")")),s instanceof n?this.result="".concat(this.result," / ").concat(s.getResult(!0)):(typeof s=="number"||typeof s=="string")&&(this.result="".concat(this.result," / ").concat(s)),this.lowPriority=!1,this}},{key:"getResult",value:function(s){return this.lowPriority||s?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(s){var d=this,f=s||{},o=f.unit,y=!0;return typeof o=="boolean"?y=o:Array.from(this.unitlessCssVar).some(function(b){return d.result.includes(b)})&&(y=!1),this.result=this.result.replace(see,y?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),n}(mU),cee=function(e){Uu(n,e);var t=Hu(n);function n(i){var s;return ja(this,n),s=t.call(this),ke(Mr(s),"result",0),i instanceof n?s.result=i.result:typeof i=="number"&&(s.result=i),s}return Va(n,[{key:"add",value:function(s){return s instanceof n?this.result+=s.result:typeof s=="number"&&(this.result+=s),this}},{key:"sub",value:function(s){return s instanceof n?this.result-=s.result:typeof s=="number"&&(this.result-=s),this}},{key:"mul",value:function(s){return s instanceof n?this.result*=s.result:typeof s=="number"&&(this.result*=s),this}},{key:"div",value:function(s){return s instanceof n?this.result/=s.result:typeof s=="number"&&(this.result/=s),this}},{key:"equal",value:function(){return this.result}}]),n}(mU),uee=function(t,n){var i=t==="css"?lee:cee;return function(s){return new i(s,n)}},O3=function(t,n){return"".concat([n,t.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function Io(e){var t=I.useRef();t.current=e;var n=I.useCallback(function(){for(var i,s=arguments.length,d=new Array(s),f=0;f<s;f++)d[f]=arguments[f];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(d))},[]);return n}function Rx(e){var t=I.useRef(!1),n=I.useState(e),i=It(n,2),s=i[0],d=i[1];I.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function f(o,y){y&&t.current||d(o)}return[s,f]}function zI(e){return e!==void 0}function is(e,t){var n=t||{},i=n.defaultValue,s=n.value,d=n.onChange,f=n.postState,o=Rx(function(){return zI(s)?s:zI(i)?typeof i=="function"?i():i:typeof e=="function"?e():e}),y=It(o,2),b=y[0],C=y[1],P=s!==void 0?s:b,A=f?f(P):P,D=Io(d),k=Rx([P]),B=It(k,2),N=B[0],j=B[1];OM(function(){var K=N[0];b!==K&&D(b,K)},[N]),OM(function(){zI(s)||C(s)},[s]);var V=Io(function(K,Y){C(K,Y),j([P],Y)});return[A,V]}function D3(e,t,n,i){var s=Je({},t[e]);if(i!=null&&i.deprecatedTokens){var d=i.deprecatedTokens;d.forEach(function(o){var y=It(o,2),b=y[0],C=y[1];if(s!=null&&s[b]||s!=null&&s[C]){var P;(P=s[C])!==null&&P!==void 0||(s[C]=s==null?void 0:s[b])}})}var f=Je(Je({},n),s);return Object.keys(f).forEach(function(o){f[o]===t[o]&&delete f[o]}),f}var vU=typeof CSSINJS_STATISTIC<"u",XM=!0;function xo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!vU)return Object.assign.apply(Object,[{}].concat(t));XM=!1;var i={};return t.forEach(function(s){if(Nr(s)==="object"){var d=Object.keys(s);d.forEach(function(f){Object.defineProperty(i,f,{configurable:!0,enumerable:!0,get:function(){return s[f]}})})}}),XM=!0,i}var L3={};function dee(){}var hee=function(t){var n,i=t,s=dee;return vU&&typeof Proxy<"u"&&(n=new Set,i=new Proxy(t,{get:function(f,o){if(XM){var y;(y=n)===null||y===void 0||y.add(o)}return f[o]}}),s=function(f,o){var y;L3[f]={global:Array.from(n),component:Je(Je({},(y=L3[f])===null||y===void 0?void 0:y.component),o)}}),{token:i,keys:n,flush:s}};function z3(e,t,n){if(typeof n=="function"){var i;return n(xo(t,(i=t[e])!==null&&i!==void 0?i:{}))}return n??{}}function fee(e){return e==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return"max(".concat(i.map(function(d){return dt(d)}).join(","),")")},min:function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return"min(".concat(i.map(function(d){return dt(d)}).join(","),")")}}}var pee=1e3*60*10,mee=function(){function e(){ja(this,e),ke(this,"map",new Map),ke(this,"objectIDMap",new WeakMap),ke(this,"nextID",0),ke(this,"lastAccessBeat",new Map),ke(this,"accessBeat",0)}return Va(e,[{key:"set",value:function(n,i){this.clear();var s=this.getCompositeKey(n);this.map.set(s,i),this.lastAccessBeat.set(s,Date.now())}},{key:"get",value:function(n){var i=this.getCompositeKey(n),s=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,s}},{key:"getCompositeKey",value:function(n){var i=this,s=n.map(function(d){return d&&Nr(d)==="object"?"obj_".concat(i.getObjectID(d)):"".concat(Nr(d),"_").concat(d)});return s.join("|")}},{key:"getObjectID",value:function(n){if(this.objectIDMap.has(n))return this.objectIDMap.get(n);var i=this.nextID;return this.objectIDMap.set(n,i),this.nextID+=1,i}},{key:"clear",value:function(){var n=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(s,d){i-s>pee&&(n.map.delete(d),n.lastAccessBeat.delete(d))}),this.accessBeat=0}}}]),e}(),k3=new mee;function gee(e,t){return Wt.useMemo(function(){var n=k3.get(t);if(n)return n;var i=e();return k3.set(t,i),i},t)}var vee=function(){return{}};function _ee(e){var t=e.useCSP,n=t===void 0?vee:t,i=e.useToken,s=e.usePrefix,d=e.getResetStyles,f=e.getCommonStyle,o=e.getCompUnitless;function y(A,D,k,B){var N=Array.isArray(A)?A[0]:A;function j(se){return"".concat(String(N)).concat(se.slice(0,1).toUpperCase()).concat(se.slice(1))}var V=(B==null?void 0:B.unitless)||{},K=typeof o=="function"?o(A):{},Y=Je(Je({},K),{},ke({},j("zIndexPopup"),!0));Object.keys(V).forEach(function(se){Y[j(se)]=V[se]});var Z=Je(Je({},B),{},{unitless:Y,prefixToken:j}),te=C(A,D,k,Z),ne=b(N,k,Z);return function(se){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:se,de=te(se,ee),fe=It(de,2),ye=fe[1],ge=ne(ee),we=It(ge,2),Se=we[0],xe=we[1];return[Se,ye,xe]}}function b(A,D,k){var B=k.unitless,N=k.injectStyle,j=N===void 0?!0:N,V=k.prefixToken,K=k.ignore,Y=function(ne){var se=ne.rootCls,ee=ne.cssVar,de=ee===void 0?{}:ee,fe=i(),ye=fe.realToken;return IQ({path:[A],prefix:de.prefix,key:de.key,unitless:B,ignore:K,token:ye,scope:se},function(){var ge=z3(A,ye,D),we=D3(A,ye,ge,{deprecatedTokens:k==null?void 0:k.deprecatedTokens});return Object.keys(ge).forEach(function(Se){we[V(Se)]=we[Se],delete we[Se]}),we}),null},Z=function(ne){var se=i(),ee=se.cssVar;return[function(de){return j&&ee?Wt.createElement(Wt.Fragment,null,Wt.createElement(Y,{rootCls:ne,cssVar:ee,component:A}),de):de},ee==null?void 0:ee.key]};return Z}function C(A,D,k){var B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},N=Array.isArray(A)?A:[A,A],j=It(N,1),V=j[0],K=N.join("-"),Y=e.layer||{name:"antd"};return function(Z){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z,ne=i(),se=ne.theme,ee=ne.realToken,de=ne.hashId,fe=ne.token,ye=ne.cssVar,ge=s(),we=ge.rootPrefixCls,Se=ge.iconPrefixCls,xe=n(),Te=ye?"css":"js",ze=gee(function(){var at=new Set;return ye&&Object.keys(B.unitless||{}).forEach(function(Ke){at.add(cS(Ke,ye.prefix)),at.add(cS(Ke,O3(V,ye.prefix)))}),uee(Te,at)},[Te,V,ye==null?void 0:ye.prefix]),Ue=fee(Te),We=Ue.max,Be=Ue.min,Xe={theme:se,token:fe,hashId:de,nonce:function(){return xe.nonce},clientOnly:B.clientOnly,layer:Y,order:B.order||-999};typeof d=="function"&&zM(Je(Je({},Xe),{},{clientOnly:!1,path:["Shared",we]}),function(){return d(fe,{prefix:{rootPrefixCls:we,iconPrefixCls:Se},csp:xe})});var qe=zM(Je(Je({},Xe),{},{path:[K,Z,Se]}),function(){if(B.injectStyle===!1)return[];var at=hee(fe),Ke=at.token,tt=at.flush,vt=z3(V,ee,k),Pt=".".concat(Z),ft=D3(V,ee,vt,{deprecatedTokens:B.deprecatedTokens});ye&&vt&&Nr(vt)==="object"&&Object.keys(vt).forEach(function(yt){vt[yt]="var(".concat(cS(yt,O3(V,ye.prefix)),")")});var Nt=xo(Ke,{componentCls:Pt,prefixCls:Z,iconCls:".".concat(Se),antCls:".".concat(we),calc:ze,max:We,min:Be},ye?vt:ft),Rt=D(Nt,{hashId:de,prefixCls:Z,rootPrefixCls:we,iconPrefixCls:Se});tt(V,ft);var pt=typeof f=="function"?f(Nt,Z,te,B.resetFont):null;return[B.resetStyle===!1?null:pt,Rt]});return[qe,de]}}function P(A,D,k){var B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},N=C(A,D,k,Je({resetStyle:!1,order:-998},B)),j=function(K){var Y=K.prefixCls,Z=K.rootCls,te=Z===void 0?Y:Z;return N(Y,te),null};return j}return{genStyleHooks:y,genSubStyleComponent:P,genComponentStyleHook:C}}const qp=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],yee="5.27.6";function kI(e){return e>=0&&e<=255}function T0(e,t){const{r:n,g:i,b:s,a:d}=new no(e).toRgb();if(d<1)return e;const{r:f,g:o,b:y}=new no(t).toRgb();for(let b=.01;b<=1;b+=.01){const C=Math.round((n-f*(1-b))/b),P=Math.round((i-o*(1-b))/b),A=Math.round((s-y*(1-b))/b);if(kI(C)&&kI(P)&&kI(A))return new no({r:C,g:P,b:A,a:Math.round(b*100)/100}).toRgbString()}return new no({r:n,g:i,b:s,a:1}).toRgbString()}var xee=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function _U(e){const{override:t}=e,n=xee(e,["override"]),i=Object.assign({},t);Object.keys(Ix).forEach(A=>{delete i[A]});const s=Object.assign(Object.assign({},n),i),d=480,f=576,o=768,y=992,b=1200,C=1600;if(s.motion===!1){const A="0s";s.motionDurationFast=A,s.motionDurationMid=A,s.motionDurationSlow=A}return Object.assign(Object.assign(Object.assign({},s),{colorFillContent:s.colorFillSecondary,colorFillContentHover:s.colorFill,colorFillAlter:s.colorFillQuaternary,colorBgContainerDisabled:s.colorFillTertiary,colorBorderBg:s.colorBgContainer,colorSplit:T0(s.colorBorderSecondary,s.colorBgContainer),colorTextPlaceholder:s.colorTextQuaternary,colorTextDisabled:s.colorTextQuaternary,colorTextHeading:s.colorText,colorTextLabel:s.colorTextSecondary,colorTextDescription:s.colorTextTertiary,colorTextLightSolid:s.colorWhite,colorHighlight:s.colorError,colorBgTextHover:s.colorFillSecondary,colorBgTextActive:s.colorFill,colorIcon:s.colorTextTertiary,colorIconHover:s.colorText,colorErrorOutline:T0(s.colorErrorBg,s.colorBgContainer),colorWarningOutline:T0(s.colorWarningBg,s.colorBgContainer),fontSizeIcon:s.fontSizeSM,lineWidthFocus:s.lineWidth*3,lineWidth:s.lineWidth,controlOutlineWidth:s.lineWidth*2,controlInteractiveSize:s.controlHeight/2,controlItemBgHover:s.colorFillTertiary,controlItemBgActive:s.colorPrimaryBg,controlItemBgActiveHover:s.colorPrimaryBgHover,controlItemBgActiveDisabled:s.colorFill,controlTmpOutline:s.colorFillQuaternary,controlOutline:T0(s.colorPrimaryBg,s.colorBgContainer),lineType:s.lineType,borderRadius:s.borderRadius,borderRadiusXS:s.borderRadiusXS,borderRadiusSM:s.borderRadiusSM,borderRadiusLG:s.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:s.sizeXXS,paddingXS:s.sizeXS,paddingSM:s.sizeSM,padding:s.size,paddingMD:s.sizeMD,paddingLG:s.sizeLG,paddingXL:s.sizeXL,paddingContentHorizontalLG:s.sizeLG,paddingContentVerticalLG:s.sizeMS,paddingContentHorizontal:s.sizeMS,paddingContentVertical:s.sizeSM,paddingContentHorizontalSM:s.size,paddingContentVerticalSM:s.sizeXS,marginXXS:s.sizeXXS,marginXS:s.sizeXS,marginSM:s.sizeSM,margin:s.size,marginMD:s.sizeMD,marginLG:s.sizeLG,marginXL:s.sizeXL,marginXXL:s.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:d,screenXSMin:d,screenXSMax:f-1,screenSM:f,screenSMMin:f,screenSMMax:o-1,screenMD:o,screenMDMin:o,screenMDMax:y-1,screenLG:y,screenLGMin:y,screenLGMax:b-1,screenXL:b,screenXLMin:b,screenXLMax:C-1,screenXXL:C,screenXXLMin:C,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new no("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new no("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new no("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var F3=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const yU={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},bee={motionBase:!0,motionUnit:!0},wee={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},xU=(e,t,n)=>{const i=n.getDerivativeToken(e),{override:s}=t,d=F3(t,["override"]);let f=Object.assign(Object.assign({},i),{override:s});return f=_U(f),d&&Object.entries(d).forEach(([o,y])=>{const{theme:b}=y,C=F3(y,["theme"]);let P=C;b&&(P=xU(Object.assign(Object.assign({},f),C),{override:C},b)),f[o]=P}),f};function Vs(){const{token:e,hashed:t,theme:n,override:i,cssVar:s}=Wt.useContext(pU),d=`${yee}-${t||""}`,f=n||fU,[o,y,b]=QJ(f,[Ix,e],{salt:d,override:i,getComputedToken:xU,formatToken:_U,cssVar:s&&{prefix:s.prefix,key:s.key,unitless:yU,ignore:bee,preserve:wee}});return[f,b,t?y:"",o,s]}const df={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},ya=(e,t=!1)=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily}),nb=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),Kp=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),See=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),Cee=(e,t,n,i)=>{const s=`[class^="${t}"], [class*=" ${t}"]`,d=n?`.${n}`:s,f={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let o={};return i!==!1&&(o={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[d]:Object.assign(Object.assign(Object.assign({},o),f),{[s]:f})}},Nu=(e,t)=>({outline:`${dt(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:t??1,transition:"outline-offset 0s, outline 0s"}),hf=(e,t)=>({"&:focus-visible":Nu(e,t)}),bU=e=>({[`.${e}`]:Object.assign(Object.assign({},nb()),{[`.${e} .${e}-icon`]:{display:"block"}})}),Eee=e=>Object.assign(Object.assign({color:e.colorLink,textDecoration:e.linkDecoration,outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}`,border:0,padding:0,background:"none",userSelect:"none"},hf(e)),{"&:hover":{color:e.colorLinkHover,textDecoration:e.linkHoverDecoration},"&:focus":{color:e.colorLinkHover,textDecoration:e.linkFocusDecoration},"&:active":{color:e.colorLinkActive,textDecoration:e.linkHoverDecoration}}),{genStyleHooks:za,genComponentStyleHook:Tee,genSubStyleComponent:sE}=_ee({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=I.useContext(ji);return{rootPrefixCls:e(),iconPrefixCls:t}},useToken:()=>{const[e,t,n,i,s]=Vs();return{theme:e,realToken:t,hashId:n,token:i,cssVar:s}},useCSP:()=>{const{csp:e}=I.useContext(ji);return e??{}},getResetStyles:(e,t)=>{var n;const i=See(e);return[i,{"&":i},bU((n=t==null?void 0:t.prefix.iconPrefixCls)!==null&&n!==void 0?n:bO)]},getCommonStyle:Cee,getCompUnitless:()=>yU});function wU(e,t){return qp.reduce((n,i)=>{const s=e[`${i}1`],d=e[`${i}3`],f=e[`${i}6`],o=e[`${i}7`];return Object.assign(Object.assign({},n),t(i,{lightColor:s,lightBorderColor:d,darkColor:f,textColor:o}))},{})}const Iee=(e,t)=>{const[n,i]=Vs();return zM({token:i,hashId:"",path:["ant-design-icons",e],nonce:()=>t==null?void 0:t.nonce,layer:{name:"antd"}},()=>bU(e))},Pee=Object.assign({},qx),{useId:N3}=Pee,Mee=()=>"",Ree=typeof N3>"u"?Mee:N3;function Aee(e,t,n){var i;qv();const s=e||{},d=s.inherit===!1||!t?Object.assign(Object.assign({},KM),{hashed:(i=t==null?void 0:t.hashed)!==null&&i!==void 0?i:KM.hashed,cssVar:t==null?void 0:t.cssVar}):t,f=Ree();return nm(()=>{var o,y;if(!e)return t;const b=Object.assign({},d.components);Object.keys(e.components||{}).forEach(A=>{b[A]=Object.assign(Object.assign({},b[A]),e.components[A])});const C=`css-var-${f.replace(/:/g,"")}`,P=((o=s.cssVar)!==null&&o!==void 0?o:d.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:n==null?void 0:n.prefixCls},typeof d.cssVar=="object"?d.cssVar:{}),typeof s.cssVar=="object"?s.cssVar:{}),{key:typeof s.cssVar=="object"&&((y=s.cssVar)===null||y===void 0?void 0:y.key)||C});return Object.assign(Object.assign(Object.assign({},d),s),{token:Object.assign(Object.assign({},d.token),s.token),components:b,cssVar:P})},[s,d],(o,y)=>o.some((b,C)=>{const P=y[C];return!Yc(b,P,!0)}))}var Oee=["children"],SU=I.createContext({});function Dee(e){var t=e.children,n=ri(e,Oee);return I.createElement(SU.Provider,{value:n},t)}var Lee=function(e){Uu(n,e);var t=Hu(n);function n(){return ja(this,n),t.apply(this,arguments)}return Va(n,[{key:"render",value:function(){return this.props.children}}]),n}(I.Component);function zee(e){var t=I.useReducer(function(o){return o+1},0),n=It(t,2),i=n[1],s=I.useRef(e),d=Io(function(){return s.current}),f=Io(function(o){s.current=typeof o=="function"?o(s.current):o,i()});return[d,f]}var Dh="none",Ew="appear",Tw="enter",Iw="leave",B3="none",jc="prepare",sv="start",lv="active",wO="end",CU="prepared";function $3(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}function kee(e,t){var n={animationend:$3("Animation","AnimationEnd"),transitionend:$3("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete n.animationend.animation,"TransitionEvent"in t||delete n.transitionend.transition),n}var Fee=kee(Bs(),typeof window<"u"?window:{}),EU={};if(Bs()){var Nee=document.createElement("div");EU=Nee.style}var Pw={};function TU(e){if(Pw[e])return Pw[e];var t=Fee[e];if(t)for(var n=Object.keys(t),i=n.length,s=0;s<i;s+=1){var d=n[s];if(Object.prototype.hasOwnProperty.call(t,d)&&d in EU)return Pw[e]=t[d],Pw[e]}return""}var IU=TU("animationend"),PU=TU("transitionend"),MU=!!(IU&&PU),j3=IU||"animationend",V3=PU||"transitionend";function U3(e,t){if(!e)return null;if(Nr(e)==="object"){var n=t.replace(/-\w/g,function(i){return i[1].toUpperCase()});return e[n]}return"".concat(e,"-").concat(t)}const Bee=function(e){var t=I.useRef();function n(s){s&&(s.removeEventListener(V3,e),s.removeEventListener(j3,e))}function i(s){t.current&&t.current!==s&&n(t.current),s&&s!==t.current&&(s.addEventListener(V3,e),s.addEventListener(j3,e),t.current=s)}return I.useEffect(function(){return function(){n(t.current)}},[]),[i,n]};var RU=Bs()?I.useLayoutEffect:I.useEffect;const $ee=function(){var e=I.useRef(null);function t(){Qi.cancel(e.current)}function n(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;t();var d=Qi(function(){s<=1?i({isCanceled:function(){return d!==e.current}}):n(i,s-1)});e.current=d}return I.useEffect(function(){return function(){t()}},[]),[n,t]};var jee=[jc,sv,lv,wO],Vee=[jc,CU],AU=!1,Uee=!0;function OU(e){return e===lv||e===wO}const Hee=function(e,t,n){var i=Rx(B3),s=It(i,2),d=s[0],f=s[1],o=$ee(),y=It(o,2),b=y[0],C=y[1];function P(){f(jc,!0)}var A=t?Vee:jee;return RU(function(){if(d!==B3&&d!==wO){var D=A.indexOf(d),k=A[D+1],B=n(d);B===AU?f(k,!0):k&&b(function(N){function j(){N.isCanceled()||f(k,!0)}B===!0?j():Promise.resolve(B).then(j)})}},[e,d]),I.useEffect(function(){return function(){C()}},[]),[P,d]};function Gee(e,t,n,i){var s=i.motionEnter,d=s===void 0?!0:s,f=i.motionAppear,o=f===void 0?!0:f,y=i.motionLeave,b=y===void 0?!0:y,C=i.motionDeadline,P=i.motionLeaveImmediately,A=i.onAppearPrepare,D=i.onEnterPrepare,k=i.onLeavePrepare,B=i.onAppearStart,N=i.onEnterStart,j=i.onLeaveStart,V=i.onAppearActive,K=i.onEnterActive,Y=i.onLeaveActive,Z=i.onAppearEnd,te=i.onEnterEnd,ne=i.onLeaveEnd,se=i.onVisibleChanged,ee=Rx(),de=It(ee,2),fe=de[0],ye=de[1],ge=zee(Dh),we=It(ge,2),Se=we[0],xe=we[1],Te=Rx(null),ze=It(Te,2),Ue=ze[0],We=ze[1],Be=Se(),Xe=I.useRef(!1),qe=I.useRef(null);function at(){return n()}var Ke=I.useRef(!1);function tt(){xe(Dh),We(null,!0)}var vt=Io(function(Mt){var hn=Se();if(hn!==Dh){var Jt=at();if(!(Mt&&!Mt.deadline&&Mt.target!==Jt)){var Ut=Ke.current,Tn;hn===Ew&&Ut?Tn=Z==null?void 0:Z(Jt,Mt):hn===Tw&&Ut?Tn=te==null?void 0:te(Jt,Mt):hn===Iw&&Ut&&(Tn=ne==null?void 0:ne(Jt,Mt)),Ut&&Tn!==!1&&tt()}}}),Pt=Bee(vt),ft=It(Pt,1),Nt=ft[0],Rt=function(hn){switch(hn){case Ew:return ke(ke(ke({},jc,A),sv,B),lv,V);case Tw:return ke(ke(ke({},jc,D),sv,N),lv,K);case Iw:return ke(ke(ke({},jc,k),sv,j),lv,Y);default:return{}}},pt=I.useMemo(function(){return Rt(Be)},[Be]),yt=Hee(Be,!e,function(Mt){if(Mt===jc){var hn=pt[jc];return hn?hn(at()):AU}if(Ct in pt){var Jt;We(((Jt=pt[Ct])===null||Jt===void 0?void 0:Jt.call(pt,at(),null))||null)}return Ct===lv&&Be!==Dh&&(Nt(at()),C>0&&(clearTimeout(qe.current),qe.current=setTimeout(function(){vt({deadline:!0})},C))),Ct===CU&&tt(),Uee}),xt=It(yt,2),bt=xt[0],Ct=xt[1],tn=OU(Ct);Ke.current=tn;var Zt=I.useRef(null);RU(function(){if(!(Xe.current&&Zt.current===t)){ye(t);var Mt=Xe.current;Xe.current=!0;var hn;!Mt&&t&&o&&(hn=Ew),Mt&&t&&d&&(hn=Tw),(Mt&&!t&&b||!Mt&&P&&!t&&b)&&(hn=Iw);var Jt=Rt(hn);hn&&(e||Jt[jc])?(xe(hn),bt()):xe(Dh),Zt.current=t}},[t]),I.useEffect(function(){(Be===Ew&&!o||Be===Tw&&!d||Be===Iw&&!b)&&xe(Dh)},[o,d,b]),I.useEffect(function(){return function(){Xe.current=!1,clearTimeout(qe.current)}},[]);var In=I.useRef(!1);I.useEffect(function(){fe&&(In.current=!0),fe!==void 0&&Be===Dh&&((In.current||fe)&&(se==null||se(fe)),In.current=!0)},[fe,Be]);var Cn=Ue;return pt[jc]&&Ct===sv&&(Cn=Je({transition:"none"},Cn)),[Be,Ct,Cn,fe??t]}function Wee(e){var t=e;Nr(e)==="object"&&(t=e.transitionSupport);function n(s,d){return!!(s.motionName&&t&&d!==!1)}var i=I.forwardRef(function(s,d){var f=s.visible,o=f===void 0?!0:f,y=s.removeOnLeave,b=y===void 0?!0:y,C=s.forceRender,P=s.children,A=s.motionName,D=s.leavedClassName,k=s.eventProps,B=I.useContext(SU),N=B.motion,j=n(s,N),V=I.useRef(),K=I.useRef();function Y(){try{return V.current instanceof HTMLElement?V.current:lS(K.current)}catch{return null}}var Z=Gee(j,o,Y,s),te=It(Z,4),ne=te[0],se=te[1],ee=te[2],de=te[3],fe=I.useRef(de);de&&(fe.current=!0);var ye=I.useCallback(function(ze){V.current=ze,bx(d,ze)},[d]),ge,we=Je(Je({},k),{},{visible:o});if(!P)ge=null;else if(ne===Dh)de?ge=P(Je({},we),ye):!b&&fe.current&&D?ge=P(Je(Je({},we),{},{className:D}),ye):C||!b&&!D?ge=P(Je(Je({},we),{},{style:{display:"none"}}),ye):ge=null;else{var Se;se===jc?Se="prepare":OU(se)?Se="active":se===sv&&(Se="start");var xe=U3(A,"".concat(ne,"-").concat(Se));ge=P(Je(Je({},we),{},{className:St(U3(A,ne),ke(ke({},xe,xe&&Se),A,typeof A=="string")),style:ee}),ye)}if(I.isValidElement(ge)&&Fu(ge)){var Te=rm(ge);Te||(ge=I.cloneElement(ge,{ref:ye}))}return I.createElement(Lee,{ref:K},ge)});return i.displayName="CSSMotion",i}const wf=Wee(MU);var ZM="add",YM="keep",JM="remove",FI="removed";function qee(e){var t;return e&&Nr(e)==="object"&&"key"in e?t=e:t={key:e},Je(Je({},t),{},{key:String(t.key)})}function QM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(qee)}function Kee(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],i=0,s=t.length,d=QM(e),f=QM(t);d.forEach(function(b){for(var C=!1,P=i;P<s;P+=1){var A=f[P];if(A.key===b.key){i<P&&(n=n.concat(f.slice(i,P).map(function(D){return Je(Je({},D),{},{status:ZM})})),i=P),n.push(Je(Je({},A),{},{status:YM})),i+=1,C=!0;break}}C||n.push(Je(Je({},b),{},{status:JM}))}),i<s&&(n=n.concat(f.slice(i).map(function(b){return Je(Je({},b),{},{status:ZM})})));var o={};n.forEach(function(b){var C=b.key;o[C]=(o[C]||0)+1});var y=Object.keys(o).filter(function(b){return o[b]>1});return y.forEach(function(b){n=n.filter(function(C){var P=C.key,A=C.status;return P!==b||A!==JM}),n.forEach(function(C){C.key===b&&(C.status=YM)})}),n}var Xee=["component","children","onVisibleChanged","onAllRemoved"],Zee=["status"],Yee=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function Jee(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wf,n=function(i){Uu(d,i);var s=Hu(d);function d(){var f;ja(this,d);for(var o=arguments.length,y=new Array(o),b=0;b<o;b++)y[b]=arguments[b];return f=s.call.apply(s,[this].concat(y)),ke(Mr(f),"state",{keyEntities:[]}),ke(Mr(f),"removeKey",function(C){f.setState(function(P){var A=P.keyEntities.map(function(D){return D.key!==C?D:Je(Je({},D),{},{status:FI})});return{keyEntities:A}},function(){var P=f.state.keyEntities,A=P.filter(function(D){var k=D.status;return k!==FI}).length;A===0&&f.props.onAllRemoved&&f.props.onAllRemoved()})}),f}return Va(d,[{key:"render",value:function(){var o=this,y=this.state.keyEntities,b=this.props,C=b.component,P=b.children,A=b.onVisibleChanged;b.onAllRemoved;var D=ri(b,Xee),k=C||I.Fragment,B={};return Yee.forEach(function(N){B[N]=D[N],delete D[N]}),delete D.keys,I.createElement(k,D,y.map(function(N,j){var V=N.status,K=ri(N,Zee),Y=V===ZM||V===YM;return I.createElement(t,kn({},B,{key:K.key,visible:Y,eventProps:K,onVisibleChanged:function(te){A==null||A(te,{key:K.key}),te||o.removeKey(K.key)}}),function(Z,te){return P(Je(Je({},Z),{},{index:j}),te)})}))}}],[{key:"getDerivedStateFromProps",value:function(o,y){var b=o.keys,C=y.keyEntities,P=QM(b),A=Kee(C,P);return{keyEntities:A.filter(function(D){var k=C.find(function(B){var N=B.key;return D.key===N});return!(k&&k.status===FI&&D.status===JM)})}}}]),d}(I.Component);return ke(n,"defaultProps",{component:"div"}),n}Jee(MU);const H3=I.createContext(!0);function Qee(e){const t=I.useContext(H3),{children:n}=e,[,i]=Vs(),{motion:s}=i,d=I.useRef(!1);return d.current||(d.current=t!==s),d.current?I.createElement(H3.Provider,{value:s},I.createElement(Dee,{motion:s},n)):n}const ete=()=>null;var tte=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const nte=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let DU;function rte(){return DU||Mx}function ite(e){return Object.keys(e).some(t=>t.endsWith("Color"))}const ote=e=>{const{prefixCls:t,iconPrefixCls:n,theme:i,holderRender:s}=e;t!==void 0&&(DU=t),i&&ite(i)&&ree(rte(),i)},ate=e=>{const{children:t,csp:n,autoInsertSpaceInButton:i,alert:s,anchor:d,form:f,locale:o,componentSize:y,direction:b,space:C,splitter:P,virtual:A,dropdownMatchSelectWidth:D,popupMatchSelectWidth:k,popupOverflow:B,legacyLocale:N,parentContext:j,iconPrefixCls:V,theme:K,componentDisabled:Y,segmented:Z,statistic:te,spin:ne,calendar:se,carousel:ee,cascader:de,collapse:fe,typography:ye,checkbox:ge,descriptions:we,divider:Se,drawer:xe,skeleton:Te,steps:ze,image:Ue,layout:We,list:Be,mentions:Xe,modal:qe,progress:at,result:Ke,slider:tt,breadcrumb:vt,menu:Pt,pagination:ft,input:Nt,textArea:Rt,empty:pt,badge:yt,radio:xt,rate:bt,switch:Ct,transfer:tn,avatar:Zt,message:In,tag:Cn,table:Mt,card:hn,tabs:Jt,timeline:Ut,timePicker:Tn,upload:On,notification:Kn,tree:Un,colorPicker:Pn,datePicker:Qn,rangePicker:un,flex:nn,wave:$n,dropdown:Ln,warning:qn,tour:er,tooltip:tr,popover:Jn,popconfirm:Ir,floatButton:_r,floatButtonGroup:$r,variant:mr,inputNumber:yi,treeSelect:Vr}=e,Kr=I.useCallback((je,re)=>{const{prefixCls:ie}=e;if(re)return re;const _e=ie||j.getPrefixCls("");return je?`${_e}-${je}`:_e},[j.getPrefixCls,e.prefixCls]),Rr=V||j.iconPrefixCls||bO,ii=n||j.csp;Iee(Rr,ii);const Hr=Aee(K,j.theme,{prefixCls:Kr("")}),ut={csp:ii,autoInsertSpaceInButton:i,alert:s,anchor:d,locale:o||N,direction:b,space:C,splitter:P,virtual:A,popupMatchSelectWidth:k??D,popupOverflow:B,getPrefixCls:Kr,iconPrefixCls:Rr,theme:Hr,segmented:Z,statistic:te,spin:ne,calendar:se,carousel:ee,cascader:de,collapse:fe,typography:ye,checkbox:ge,descriptions:we,divider:Se,drawer:xe,skeleton:Te,steps:ze,image:Ue,input:Nt,textArea:Rt,layout:We,list:Be,mentions:Xe,modal:qe,progress:at,result:Ke,slider:tt,breadcrumb:vt,menu:Pt,pagination:ft,empty:pt,badge:yt,radio:xt,rate:bt,switch:Ct,transfer:tn,avatar:Zt,message:In,tag:Cn,table:Mt,card:hn,tabs:Jt,timeline:Ut,timePicker:Tn,upload:On,notification:Kn,tree:Un,colorPicker:Pn,datePicker:Qn,rangePicker:un,flex:nn,wave:$n,dropdown:Ln,warning:qn,tour:er,tooltip:tr,popover:Jn,popconfirm:Ir,floatButton:_r,floatButtonGroup:$r,variant:mr,inputNumber:yi,treeSelect:Vr},ur=Object.assign({},j);Object.keys(ut).forEach(je=>{ut[je]!==void 0&&(ur[je]=ut[je])}),nte.forEach(je=>{const re=e[je];re&&(ur[je]=re)}),typeof i<"u"&&(ur.button=Object.assign({autoInsertSpace:i},ur.button));const fr=nm(()=>ur,ur,(je,re)=>{const ie=Object.keys(je),_e=Object.keys(re);return ie.length!==_e.length||ie.some(Re=>je[Re]!==re[Re])}),{layer:Fn}=I.useContext(eb),Gt=I.useMemo(()=>({prefixCls:Rr,csp:ii,layer:Fn?"antd":void 0}),[Rr,ii,Fn]);let mn=I.createElement(I.Fragment,null,I.createElement(ete,{dropdownMatchSelectWidth:D}),t);const Xn=I.useMemo(()=>{var je,re,ie,_e;return av(((je=uf.Form)===null||je===void 0?void 0:je.defaultValidateMessages)||{},((ie=(re=fr.locale)===null||re===void 0?void 0:re.Form)===null||ie===void 0?void 0:ie.defaultValidateMessages)||{},((_e=fr.form)===null||_e===void 0?void 0:_e.validateMessages)||{},(f==null?void 0:f.validateMessages)||{})},[fr,f==null?void 0:f.validateMessages]);Object.keys(Xn).length>0&&(mn=I.createElement(DQ.Provider,{value:Xn},mn)),o&&(mn=I.createElement(NQ,{locale:o,_ANT_MARK__:FQ},mn)),mn=I.createElement(yO.Provider,{value:Gt},mn),y&&(mn=I.createElement(oee,{size:y},mn)),mn=I.createElement(Qee,null,mn);const gr=I.useMemo(()=>{const je=Hr||{},{algorithm:re,token:ie,components:_e,cssVar:Re}=je,De=tte(je,["algorithm","token","components","cssVar"]),Ge=re&&(!Array.isArray(re)||re.length>0)?RM(re):fU,ot={};Object.entries(_e||{}).forEach(([rt,zt])=>{const it=Object.assign({},zt);"algorithm"in it&&(it.algorithm===!0?it.theme=Ge:(Array.isArray(it.algorithm)||typeof it.algorithm=="function")&&(it.theme=RM(it.algorithm)),delete it.algorithm),ot[rt]=it});const Ye=Object.assign(Object.assign({},Ix),ie);return Object.assign(Object.assign({},De),{theme:Ge,token:Ye,components:ot,override:Object.assign({override:Ye},ot),cssVar:Re})},[Hr]);return K&&(mn=I.createElement(pU.Provider,{value:gr},mn)),fr.warning&&(mn=I.createElement(OQ.Provider,{value:fr.warning},mn)),Y!==void 0&&(mn=I.createElement(iee,{disabled:Y},mn)),I.createElement(ji.Provider,{value:fr},mn)},im=e=>{const t=I.useContext(ji),n=I.useContext(xO);return I.createElement(ate,Object.assign({parentContext:t,legacyLocale:n},e))};im.ConfigContext=ji;im.SizeContext=Dv;im.config=ote;im.useConfig=aee;Object.defineProperty(im,"SizeContext",{get:()=>Dv});function LU(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}function ste(e){return LU(e)instanceof ShadowRoot}function iC(e){return ste(e)?LU(e):null}function lte(e){return e.replace(/-(.)/g,function(t,n){return n.toUpperCase()})}function cte(e,t){oa(e,"[@ant-design/icons] ".concat(t))}function G3(e){return Nr(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(Nr(e.icon)==="object"||typeof e.icon=="function")}function W3(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(t,n){var i=e[n];switch(n){case"class":t.className=i,delete t.class;break;default:delete t[n],t[lte(n)]=i}return t},{})}function eR(e,t,n){return n?Wt.createElement(e.tag,Je(Je({key:t},W3(e.attrs)),n),(e.children||[]).map(function(i,s){return eR(i,"".concat(t,"-").concat(e.tag,"-").concat(s))})):Wt.createElement(e.tag,Je({key:t},W3(e.attrs)),(e.children||[]).map(function(i,s){return eR(i,"".concat(t,"-").concat(e.tag,"-").concat(s))}))}function zU(e){return Px(e)[0]}function kU(e){return e?Array.isArray(e)?e:[e]:[]}var ute=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,dte=function(t){var n=I.useContext(yO),i=n.csp,s=n.prefixCls,d=n.layer,f=ute;s&&(f=f.replace(/anticon/g,s)),d&&(f="@layer ".concat(d,` {
`).concat(f,`
}`)),I.useEffect(function(){var o=t.current,y=iC(o);Od(f,"@ant-design-icons",{prepend:!d,csp:i,attachTo:y})},[])},hte=["icon","className","onClick","style","primaryColor","secondaryColor"],G0={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function fte(e){var t=e.primaryColor,n=e.secondaryColor;G0.primaryColor=t,G0.secondaryColor=n||zU(t),G0.calculated=!!n}function pte(){return Je({},G0)}var Kv=function(t){var n=t.icon,i=t.className,s=t.onClick,d=t.style,f=t.primaryColor,o=t.secondaryColor,y=ri(t,hte),b=I.useRef(),C=G0;if(f&&(C={primaryColor:f,secondaryColor:o||zU(f)}),dte(b),cte(G3(n),"icon should be icon definiton, but got ".concat(n)),!G3(n))return null;var P=n;return P&&typeof P.icon=="function"&&(P=Je(Je({},P),{},{icon:P.icon(C.primaryColor,C.secondaryColor)})),eR(P.icon,"svg-".concat(P.name),Je(Je({className:i,onClick:s,style:d,"data-icon":P.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},y),{},{ref:b}))};Kv.displayName="IconReact";Kv.getTwoToneColors=pte;Kv.setTwoToneColors=fte;function FU(e){var t=kU(e),n=It(t,2),i=n[0],s=n[1];return Kv.setTwoToneColors({primaryColor:i,secondaryColor:s})}function mte(){var e=Kv.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var gte=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];FU(rC.primary);var Fo=I.forwardRef(function(e,t){var n=e.className,i=e.icon,s=e.spin,d=e.rotate,f=e.tabIndex,o=e.onClick,y=e.twoToneColor,b=ri(e,gte),C=I.useContext(yO),P=C.prefixCls,A=P===void 0?"anticon":P,D=C.rootClassName,k=St(D,A,ke(ke({},"".concat(A,"-").concat(i.name),!!i.name),"".concat(A,"-spin"),!!s||i.name==="loading"),n),B=f;B===void 0&&o&&(B=-1);var N=d?{msTransform:"rotate(".concat(d,"deg)"),transform:"rotate(".concat(d,"deg)")}:void 0,j=kU(y),V=It(j,2),K=V[0],Y=V[1];return I.createElement("span",kn({role:"img","aria-label":i.name},b,{ref:t,tabIndex:B,onClick:o,className:k}),I.createElement(Kv,{icon:i,primaryColor:K,secondaryColor:Y,style:N}))});Fo.displayName="AntdIcon";Fo.getTwoToneColor=mte;Fo.setTwoToneColor=FU;var vte={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},_te=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:vte}))},NU=I.forwardRef(_te),yte={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},xte=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:yte}))},SO=I.forwardRef(xte),bte=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,wte=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,Ste="".concat(bte," ").concat(wte).split(/[\s\n]+/),Cte="aria-",Ete="data-";function q3(e,t){return e.indexOf(t)===0}function Jc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;t===!1?n={aria:!0,data:!0,attr:!0}:t===!0?n={aria:!0}:n=Je({},t);var i={};return Object.keys(e).forEach(function(s){(n.aria&&(s==="role"||q3(s,Cte))||n.data&&q3(s,Ete)||n.attr&&Ste.includes(s))&&(i[s]=e[s])}),i}function BU(e){return e&&Wt.isValidElement(e)&&e.type===Wt.Fragment}const $U=(e,t,n)=>Wt.isValidElement(e)?Wt.cloneElement(e,typeof n=="function"?n(e.props||{}):n):t;function Bu(e,t){return $U(e,e,t)}function tR(e){return e!=null&&e===e.window}const Tte=e=>{var t,n;if(typeof window>"u")return 0;let i=0;return tR(e)?i=e.pageYOffset:e instanceof Document?i=e.documentElement.scrollTop:(e instanceof HTMLElement||e)&&(i=e.scrollTop),e&&!tR(e)&&typeof i!="number"&&(i=(n=((t=e.ownerDocument)!==null&&t!==void 0?t:e).documentElement)===null||n===void 0?void 0:n.scrollTop),i};function Ite(e,t,n,i){const s=n-t;return e/=i/2,e<1?s/2*e*e*e+t:s/2*((e-=2)*e*e+2)+t}function Pte(e,t={}){const{getContainer:n=()=>window,callback:i,duration:s=450}=t,d=n(),f=Tte(d),o=Date.now(),y=()=>{const C=Date.now()-o,P=Ite(C>s?s:C,f,e,s);tR(d)?d.scrollTo(window.pageXOffset,P):d instanceof Document||d.constructor.name==="HTMLDocument"?d.documentElement.scrollTop=P:d.scrollTop=P,C<s?Qi(y):typeof i=="function"&&i()};Qi(y)}const Wu=e=>{const[,,,,t]=Vs();return t?`${e}-css-var`:""};var ir={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,N:78,P:80,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,EQUALS:187,WIN_KEY:224},Mte={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},Rte=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Mte}))},CO=I.forwardRef(Rte);const EO=Wt.createContext(void 0),vp=100,jU={Modal:vp,Drawer:vp,Popover:vp,Popconfirm:vp,Tooltip:vp,Tour:vp,FloatButton:vp},Ate={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function Ote(e){return e in jU}const lE=(e,t)=>{const[,n]=Vs(),i=Wt.useContext(EO),s=Ote(e);let d;if(t!==void 0)d=[t,t];else{let f=i??0;s?f+=(i?0:n.zIndexPopupBase)+jU[e]:f+=Ate[e],d=[i===void 0?t:f,f]}return d};function VU(e,t){this.v=e,this.k=t}function Os(e,t,n,i){var s=Object.defineProperty;try{s({},"",{})}catch{s=0}Os=function(f,o,y,b){function C(P,A){Os(f,P,function(D){return this._invoke(P,A,D)})}o?s?s(f,o,{value:y,enumerable:!b,configurable:!b,writable:!b}):f[o]=y:(C("next",0),C("throw",1),C("return",2))},Os(e,t,n,i)}function TO(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n=typeof Symbol=="function"?Symbol:{},i=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function d(D,k,B,N){var j=k&&k.prototype instanceof o?k:o,V=Object.create(j.prototype);return Os(V,"_invoke",function(K,Y,Z){var te,ne,se,ee=0,de=Z||[],fe=!1,ye={p:0,n:0,v:e,a:ge,f:ge.bind(e,4),d:function(Se,xe){return te=Se,ne=0,se=e,ye.n=xe,f}};function ge(we,Se){for(ne=we,se=Se,t=0;!fe&&ee&&!xe&&t<de.length;t++){var xe,Te=de[t],ze=ye.p,Ue=Te[2];we>3?(xe=Ue===Se)&&(se=Te[(ne=Te[4])?5:(ne=3,3)],Te[4]=Te[5]=e):Te[0]<=ze&&((xe=we<2&&ze<Te[1])?(ne=0,ye.v=Se,ye.n=Te[1]):ze<Ue&&(xe=we<3||Te[0]>Se||Se>Ue)&&(Te[4]=we,Te[5]=Se,ye.n=Ue,ne=0))}if(xe||we>1)return f;throw fe=!0,Se}return function(we,Se,xe){if(ee>1)throw TypeError("Generator is already running");for(fe&&Se===1&&ge(Se,xe),ne=Se,se=xe;(t=ne<2?e:se)||!fe;){te||(ne?ne<3?(ne>1&&(ye.n=-1),ge(ne,se)):ye.n=se:ye.v=se);try{if(ee=2,te){if(ne||(we="next"),t=te[we]){if(!(t=t.call(te,se)))throw TypeError("iterator result is not an object");if(!t.done)return t;se=t.value,ne<2&&(ne=0)}else ne===1&&(t=te.return)&&t.call(te),ne<2&&(se=TypeError("The iterator does not provide a '"+we+"' method"),ne=1);te=e}else if((t=(fe=ye.n<0)?se:K.call(Y,ye))!==f)break}catch(Te){te=e,ne=1,se=Te}finally{ee=1}}return{value:t,done:fe}}}(D,B,N),!0),V}var f={};function o(){}function y(){}function b(){}t=Object.getPrototypeOf;var C=[][i]?t(t([][i]())):(Os(t={},i,function(){return this}),t),P=b.prototype=o.prototype=Object.create(C);function A(D){return Object.setPrototypeOf?Object.setPrototypeOf(D,b):(D.__proto__=b,Os(D,s,"GeneratorFunction")),D.prototype=Object.create(P),D}return y.prototype=b,Os(P,"constructor",b),Os(b,"constructor",y),y.displayName="GeneratorFunction",Os(b,s,"GeneratorFunction"),Os(P),Os(P,s,"Generator"),Os(P,i,function(){return this}),Os(P,"toString",function(){return"[object Generator]"}),(TO=function(){return{w:d,m:A}})()}function oC(e,t){function n(s,d,f,o){try{var y=e[s](d),b=y.value;return b instanceof VU?t.resolve(b.v).then(function(C){n("next",C,f,o)},function(C){n("throw",C,f,o)}):t.resolve(b).then(function(C){y.value=C,f(y)},function(C){return n("throw",C,f,o)})}catch(C){o(C)}}var i;this.next||(Os(oC.prototype),Os(oC.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),Os(this,"_invoke",function(s,d,f){function o(){return new t(function(y,b){n(s,f,y,b)})}return i=i?i.then(o,o):o()},!0)}function UU(e,t,n,i,s){return new oC(TO().w(e,t,n,i),s||Promise)}function Dte(e,t,n,i,s){var d=UU(e,t,n,i,s);return d.next().then(function(f){return f.done?f.value:d.next()})}function Lte(e){var t=Object(e),n=[];for(var i in t)n.unshift(i);return function s(){for(;n.length;)if((i=n.pop())in t)return s.value=i,s.done=!1,s;return s.done=!0,s}}function K3(e){if(e!=null){var t=e[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Nr(e)+" is not iterable")}function $s(){var e=TO(),t=e.m($s),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function i(f){var o=typeof f=="function"&&f.constructor;return!!o&&(o===n||(o.displayName||o.name)==="GeneratorFunction")}var s={throw:1,return:2,break:3,continue:3};function d(f){var o,y;return function(b){o||(o={stop:function(){return y(b.a,2)},catch:function(){return b.v},abrupt:function(P,A){return y(b.a,s[P],A)},delegateYield:function(P,A,D){return o.resultName=A,y(b.d,K3(P),D)},finish:function(P){return y(b.f,P)}},y=function(P,A,D){b.p=o.prev,b.n=o.next;try{return P(A,D)}finally{o.next=b.n}}),o.resultName&&(o[o.resultName]=b.v,o.resultName=void 0),o.sent=b.v,o.next=b.n;try{return f.call(this,o)}finally{b.p=o.prev,b.n=o.next}}}return($s=function(){return{wrap:function(y,b,C,P){return e.w(d(y),b,C,P&&P.reverse())},isGeneratorFunction:i,mark:e.m,awrap:function(y,b){return new VU(y,b)},AsyncIterator:oC,async:function(y,b,C,P,A){return(i(b)?UU:Dte)(d(y),b,C,P,A)},keys:Lte,values:K3}})()}function X3(e,t,n,i,s,d,f){try{var o=e[d](f),y=o.value}catch(b){return void n(b)}o.done?t(y):Promise.resolve(y).then(i,s)}function om(e){return function(){var t=this,n=arguments;return new Promise(function(i,s){var d=e.apply(t,n);function f(y){X3(d,i,s,f,o,"next",y)}function o(y){X3(d,i,s,f,o,"throw",y)}f(void 0)})}}var rb=Je({},zZ),zte=rb.version,NI=rb.render,kte=rb.unmountComponentAtNode,cE;try{var Fte=Number((zte||"").split(".")[0]);Fte>=18&&(cE=rb.createRoot)}catch{}function Z3(e){var t=rb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&Nr(t)==="object"&&(t.usingClientEntryPoint=e)}var aC="__rc_react_root__";function Nte(e,t){Z3(!0);var n=t[aC]||cE(t);Z3(!1),n.render(e),t[aC]=n}function Bte(e,t){NI==null||NI(e,t)}function $te(e,t){if(cE){Nte(e,t);return}Bte(e,t)}function jte(e){return nR.apply(this,arguments)}function nR(){return nR=om($s().mark(function e(t){return $s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var s;(s=t[aC])===null||s===void 0||s.unmount(),delete t[aC]}));case 1:case"end":return i.stop()}},e)})),nR.apply(this,arguments)}function Vte(e){kte(e)}function Ute(e){return rR.apply(this,arguments)}function rR(){return rR=om($s().mark(function e(t){return $s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(cE===void 0){i.next=2;break}return i.abrupt("return",jte(t));case 2:Vte(t);case 3:case"end":return i.stop()}},e)})),rR.apply(this,arguments)}const Hte=(e,t)=>($te(e,t),()=>Ute(t));let Gte=Hte;function Wte(e){return Gte}const BI=()=>({height:0,opacity:0}),Y3=e=>{const{scrollHeight:t}=e;return{height:t,opacity:1}},qte=e=>({height:e?e.offsetHeight:0}),$I=(e,t)=>(t==null?void 0:t.deadline)===!0||t.propertyName==="height",HU=(e=Mx)=>({motionName:`${e}-motion-collapse`,onAppearStart:BI,onEnterStart:BI,onAppearActive:Y3,onEnterActive:Y3,onLeaveStart:qte,onLeaveActive:BI,onAppearEnd:$I,onEnterEnd:$I,onLeaveEnd:$I,motionDeadline:500}),IO=(e,t,n)=>n!==void 0?n:`${e}-${t}`;function as(e,t){var n=Object.assign({},e);return Array.isArray(t)&&t.forEach(function(i){delete n[i]}),n}const uE=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),n=t.width,i=t.height;if(n||i)return!0}if(e.getBoundingClientRect){var s=e.getBoundingClientRect(),d=s.width,f=s.height;if(d||f)return!0}}return!1},Kte=e=>{const{componentCls:t,colorPrimary:n}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${n})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${e.motionDurationSlow} ${e.motionEaseInOut}`,`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`].join(",")}}}}},Xte=Tee("Wave",Kte),dE=`${Mx}-wave-target`;function Zte(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"&&e!=="canvastext"}function Yte(e){var t;const{borderTopColor:n,borderColor:i,backgroundColor:s}=getComputedStyle(e);return(t=[n,i,s].find(Zte))!==null&&t!==void 0?t:null}function jI(e){return Number.isNaN(e)?0:e}const Jte=e=>{const{className:t,target:n,component:i,registerUnmount:s}=e,d=I.useRef(null),f=I.useRef(null);I.useEffect(()=>{f.current=s()},[]);const[o,y]=I.useState(null),[b,C]=I.useState([]),[P,A]=I.useState(0),[D,k]=I.useState(0),[B,N]=I.useState(0),[j,V]=I.useState(0),[K,Y]=I.useState(!1),Z={left:P,top:D,width:B,height:j,borderRadius:b.map(se=>`${se}px`).join(" ")};o&&(Z["--wave-color"]=o);function te(){const se=getComputedStyle(n);y(Yte(n));const ee=se.position==="static",{borderLeftWidth:de,borderTopWidth:fe}=se;A(ee?n.offsetLeft:jI(-Number.parseFloat(de))),k(ee?n.offsetTop:jI(-Number.parseFloat(fe))),N(n.offsetWidth),V(n.offsetHeight);const{borderTopLeftRadius:ye,borderTopRightRadius:ge,borderBottomLeftRadius:we,borderBottomRightRadius:Se}=se;C([ye,ge,Se,we].map(xe=>jI(Number.parseFloat(xe))))}if(I.useEffect(()=>{if(n){const se=Qi(()=>{te(),Y(!0)});let ee;return typeof ResizeObserver<"u"&&(ee=new ResizeObserver(te),ee.observe(n)),()=>{Qi.cancel(se),ee==null||ee.disconnect()}}},[n]),!K)return null;const ne=(i==="Checkbox"||i==="Radio")&&(n==null?void 0:n.classList.contains(dE));return I.createElement(wf,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(se,ee)=>{var de,fe;if(ee.deadline||ee.propertyName==="opacity"){const ye=(de=d.current)===null||de===void 0?void 0:de.parentElement;(fe=f.current)===null||fe===void 0||fe.call(f).then(()=>{ye==null||ye.remove()})}return!1}},({className:se},ee)=>I.createElement("div",{ref:ru(d,ee),className:St(t,se,{"wave-quick":ne}),style:Z}))},Qte=(e,t)=>{var n;const{component:i}=t;if(i==="Checkbox"&&!(!((n=e.querySelector("input"))===null||n===void 0)&&n.checked))return;const s=document.createElement("div");s.style.position="absolute",s.style.left="0px",s.style.top="0px",e==null||e.insertBefore(s,e==null?void 0:e.firstChild);const d=Wte();let f=null;function o(){return f}f=d(I.createElement(Jte,Object.assign({},t,{target:e,registerUnmount:o})),s)},ene=(e,t,n)=>{const{wave:i}=I.useContext(ji),[,s,d]=Vs(),f=Io(b=>{const C=e.current;if(i!=null&&i.disabled||!C)return;const P=C.querySelector(`.${dE}`)||C,{showEffect:A}=i||{};(A||Qte)(P,{className:t,token:s,component:n,event:b,hashId:d})}),o=I.useRef(null);return b=>{Qi.cancel(o.current),o.current=Qi(()=>{f(b)})}},hE=e=>{const{children:t,disabled:n,component:i}=e,{getPrefixCls:s}=I.useContext(ji),d=I.useRef(null),f=s("wave"),[,o]=Xte(f),y=ene(d,St(f,o),i);if(Wt.useEffect(()=>{const C=d.current;if(!C||C.nodeType!==window.Node.ELEMENT_NODE||n)return;const P=A=>{!uE(A.target)||!C.getAttribute||C.getAttribute("disabled")||C.disabled||C.className.includes("disabled")&&!C.className.includes("disabled:")||C.getAttribute("aria-disabled")==="true"||C.className.includes("-leave")||y(A)};return C.addEventListener("click",P,!0),()=>{C.removeEventListener("click",P,!0)}},[n]),!Wt.isValidElement(t))return t??null;const b=Fu(t)?ru(rm(t),d):d;return Bu(t,{ref:b})},Bd=e=>{const t=Wt.useContext(Dv);return Wt.useMemo(()=>e?typeof e=="string"?e??t:typeof e=="function"?e(t):t:t,[e,t])},tne=e=>{const{componentCls:t}=e;return{[t]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},nne=e=>{const{componentCls:t,antCls:n}=e;return{[t]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${t}-item:empty`]:{display:"none"},[`${t}-item > ${n}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},rne=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-row-small":{rowGap:e.spaceGapSmallSize},"&-gap-row-middle":{rowGap:e.spaceGapMiddleSize},"&-gap-row-large":{rowGap:e.spaceGapLargeSize},"&-gap-col-small":{columnGap:e.spaceGapSmallSize},"&-gap-col-middle":{columnGap:e.spaceGapMiddleSize},"&-gap-col-large":{columnGap:e.spaceGapLargeSize}}}},GU=za("Space",e=>{const t=xo(e,{spaceGapSmallSize:e.paddingXS,spaceGapMiddleSize:e.padding,spaceGapLargeSize:e.paddingLG});return[nne(t),rne(t),tne(t)]},()=>({}),{resetStyle:!1});var WU=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const fE=I.createContext(null),pE=(e,t)=>{const n=I.useContext(fE),i=I.useMemo(()=>{if(!n)return"";const{compactDirection:s,isFirstItem:d,isLastItem:f}=n,o=s==="vertical"?"-vertical-":"-";return St(`${e}-compact${o}item`,{[`${e}-compact${o}first-item`]:d,[`${e}-compact${o}last-item`]:f,[`${e}-compact${o}item-rtl`]:t==="rtl"})},[e,t,n]);return{compactSize:n==null?void 0:n.compactSize,compactDirection:n==null?void 0:n.compactDirection,compactItemClassnames:i}},ine=e=>{const{children:t}=e;return I.createElement(fE.Provider,{value:null},t)},one=e=>{const{children:t}=e,n=WU(e,["children"]);return I.createElement(fE.Provider,{value:I.useMemo(()=>n,[n])},t)},ane=e=>{const{getPrefixCls:t,direction:n}=I.useContext(ji),{size:i,direction:s,block:d,prefixCls:f,className:o,rootClassName:y,children:b}=e,C=WU(e,["size","direction","block","prefixCls","className","rootClassName","children"]),P=Bd(K=>i??K),A=t("space-compact",f),[D,k]=GU(A),B=St(A,k,{[`${A}-rtl`]:n==="rtl",[`${A}-block`]:d,[`${A}-vertical`]:s==="vertical"},o,y),N=I.useContext(fE),j=vc(b),V=I.useMemo(()=>j.map((K,Y)=>{const Z=(K==null?void 0:K.key)||`${A}-item-${Y}`;return I.createElement(one,{key:Z,compactSize:P,compactDirection:s,isFirstItem:Y===0&&(!N||(N==null?void 0:N.isFirstItem)),isLastItem:Y===j.length-1&&(!N||(N==null?void 0:N.isLastItem))},K)}),[i,j,N]);return j.length===0?null:D(I.createElement("div",Object.assign({className:B},C),V))};var sne=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const qU=I.createContext(void 0),lne=e=>{const{getPrefixCls:t,direction:n}=I.useContext(ji),{prefixCls:i,size:s,className:d}=e,f=sne(e,["prefixCls","size","className"]),o=t("btn-group",i),[,,y]=Vs(),b=I.useMemo(()=>{switch(s){case"large":return"lg";case"small":return"sm";default:return""}},[s]),C=St(o,{[`${o}-${b}`]:b,[`${o}-rtl`]:n==="rtl"},d,y);return I.createElement(qU.Provider,{value:s},I.createElement("div",Object.assign({},f,{className:C})))},J3=/^[\u4E00-\u9FA5]{2}$/,iR=J3.test.bind(J3);function Q3(e){return typeof e=="string"}function VI(e){return e==="text"||e==="link"}function cne(e,t){if(e==null)return;const n=t?" ":"";return typeof e!="string"&&typeof e!="number"&&Q3(e.type)&&iR(e.props.children)?Bu(e,{children:e.props.children.split("").join(n)}):Q3(e)?iR(e)?Wt.createElement("span",null,e.split("").join(n)):Wt.createElement("span",null,e):BU(e)?Wt.createElement("span",null,e):e}function une(e,t){let n=!1;const i=[];return Wt.Children.forEach(e,s=>{const d=typeof s,f=d==="string"||d==="number";if(n&&f){const o=i.length-1,y=i[o];i[o]=`${y}${s}`}else i.push(s);n=f}),Wt.Children.map(i,s=>cne(s,t))}["default","primary","danger"].concat(zn(qp));const oR=I.forwardRef((e,t)=>{const{className:n,style:i,children:s,prefixCls:d}=e,f=St(`${d}-icon`,n);return Wt.createElement("span",{ref:t,className:f,style:i},s)}),eB=I.forwardRef((e,t)=>{const{prefixCls:n,className:i,style:s,iconClassName:d}=e,f=St(`${n}-loading-icon`,i);return Wt.createElement(oR,{prefixCls:n,className:f,style:s,ref:t},Wt.createElement(CO,{className:d}))}),UI=()=>({width:0,opacity:0,transform:"scale(0)"}),HI=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),dne=e=>{const{prefixCls:t,loading:n,existIcon:i,className:s,style:d,mount:f}=e,o=!!n;return i?Wt.createElement(eB,{prefixCls:t,className:s,style:d}):Wt.createElement(wf,{visible:o,motionName:`${t}-loading-icon-motion`,motionAppear:!f,motionEnter:!f,motionLeave:!f,removeOnLeave:!0,onAppearStart:UI,onAppearActive:HI,onEnterStart:UI,onEnterActive:HI,onLeaveStart:HI,onLeaveActive:UI},({className:y,style:b},C)=>{const P=Object.assign(Object.assign({},d),b);return Wt.createElement(eB,{prefixCls:t,className:St(s,y),style:P,ref:C})})},tB=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}}),hne=e=>{const{componentCls:t,fontSize:n,lineWidth:i,groupBorderColor:s,colorErrorHover:d}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:e.calc(i).mul(-1).equal(),[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:n}},tB(`${t}-primary`,s),tB(`${t}-danger`,d)]}};var fne=["b"],pne=["v"],GI=function(t){return Math.round(Number(t||0))},mne=function(t){if(t instanceof no)return t;if(t&&Nr(t)==="object"&&"h"in t&&"b"in t){var n=t,i=n.b,s=ri(n,fne);return Je(Je({},s),{},{v:i})}return typeof t=="string"&&/hsb/.test(t)?t.replace(/hsb/,"hsv"):t},Ax=function(e){Uu(n,e);var t=Hu(n);function n(i){return ja(this,n),t.call(this,mne(i))}return Va(n,[{key:"toHsbString",value:function(){var s=this.toHsb(),d=GI(s.s*100),f=GI(s.b*100),o=GI(s.h),y=s.a,b="hsb(".concat(o,", ").concat(d,"%, ").concat(f,"%)"),C="hsba(".concat(o,", ").concat(d,"%, ").concat(f,"%, ").concat(y.toFixed(y===0?0:2),")");return y===1?b:C}},{key:"toHsb",value:function(){var s=this.toHsv(),d=s.v,f=ri(s,pne);return Je(Je({},f),{},{b:d,a:this.a})}}]),n}(no),gne=function(t){return t instanceof Ax?t:new Ax(t)};gne("#1677ff");const vne=(e,t)=>(e==null?void 0:e.replace(/[^\w/]/g,"").slice(0,t?8:6))||"",_ne=(e,t)=>e?vne(e,t):"";let aR=function(){function e(t){ja(this,e);var n;if(this.cleared=!1,t instanceof e){this.metaColor=t.metaColor.clone(),this.colors=(n=t.colors)===null||n===void 0?void 0:n.map(s=>({color:new e(s.color),percent:s.percent})),this.cleared=t.cleared;return}const i=Array.isArray(t);i&&t.length?(this.colors=t.map(({color:s,percent:d})=>({color:new e(s),percent:d})),this.metaColor=new Ax(this.colors[0].color.metaColor)):this.metaColor=new Ax(i?"":t),(!t||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return Va(e,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return _ne(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:n}=this;return n?`linear-gradient(90deg, ${n.map(s=>`${s.color.toRgbString()} ${s.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(n){return!n||this.isGradient()!==n.isGradient()?!1:this.isGradient()?this.colors.length===n.colors.length&&this.colors.every((i,s)=>{const d=n.colors[s];return i.percent===d.percent&&i.color.equals(d.color)}):this.toHexString()===n.toHexString()}}])}();var yne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},xne=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:yne}))},sR=I.forwardRef(xne);const KU=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),bne=e=>({animationDuration:e,animationFillMode:"both"}),wne=e=>({animationDuration:e,animationFillMode:"both"}),PO=(e,t,n,i,s=!1)=>{const d=s?"&":"";return{[`
      ${d}${e}-enter,
      ${d}${e}-appear
    `]:Object.assign(Object.assign({},bne(i)),{animationPlayState:"paused"}),[`${d}${e}-leave`]:Object.assign(Object.assign({},wne(i)),{animationPlayState:"paused"}),[`
      ${d}${e}-enter${e}-enter-active,
      ${d}${e}-appear${e}-appear-active
    `]:{animationName:t,animationPlayState:"running"},[`${d}${e}-leave${e}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},Sne=new Mo("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Cne=new Mo("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),Ene=new Mo("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Tne=new Mo("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),Ine=new Mo("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Pne=new Mo("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),Mne=new Mo("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Rne=new Mo("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),Ane={"move-up":{inKeyframes:Mne,outKeyframes:Rne},"move-down":{inKeyframes:Sne,outKeyframes:Cne},"move-left":{inKeyframes:Ene,outKeyframes:Tne},"move-right":{inKeyframes:Ine,outKeyframes:Pne}},sC=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:s,outKeyframes:d}=Ane[t];return[PO(i,s,d,e.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{opacity:0,animationTimingFunction:e.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},MO=new Mo("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),RO=new Mo("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),AO=new Mo("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),OO=new Mo("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),One=new Mo("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Dne=new Mo("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),Lne=new Mo("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),zne=new Mo("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),kne={"slide-up":{inKeyframes:MO,outKeyframes:RO},"slide-down":{inKeyframes:AO,outKeyframes:OO},"slide-left":{inKeyframes:One,outKeyframes:Dne},"slide-right":{inKeyframes:Lne,outKeyframes:zne}},ff=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:s,outKeyframes:d}=kne[t];return[PO(i,s,d,e.motionDurationMid),{[`
      ${i}-enter,
      ${i}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},Fne=new Mo("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Nne=new Mo("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),nB=new Mo("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),rB=new Mo("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),Bne=new Mo("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),$ne=new Mo("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),jne=new Mo("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Vne=new Mo("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),Une=new Mo("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),Hne=new Mo("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),Gne=new Mo("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Wne=new Mo("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),qne={zoom:{inKeyframes:Fne,outKeyframes:Nne},"zoom-big":{inKeyframes:nB,outKeyframes:rB},"zoom-big-fast":{inKeyframes:nB,outKeyframes:rB},"zoom-left":{inKeyframes:jne,outKeyframes:Vne},"zoom-right":{inKeyframes:Une,outKeyframes:Hne},"zoom-up":{inKeyframes:Bne,outKeyframes:$ne},"zoom-down":{inKeyframes:Gne,outKeyframes:Wne}},DO=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:s,outKeyframes:d}=qne[t];return[PO(i,s,d,t==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},Kne=e=>e instanceof aR?e:new aR(e),Xne=(e,t)=>{const{r:n,g:i,b:s,a:d}=e.toRgb(),f=new Ax(e.toRgbString()).onBackground(t).toHsv();return d<=.5?f.v>.5:n*.299+i*.587+s*.114>192},XU=e=>{const{paddingInline:t,onlyIconSize:n}=e;return xo(e,{buttonPaddingHorizontal:t,buttonPaddingVertical:0,buttonIconOnlyFontSize:n})},ZU=e=>{var t,n,i,s,d,f;const o=(t=e.contentFontSize)!==null&&t!==void 0?t:e.fontSize,y=(n=e.contentFontSizeSM)!==null&&n!==void 0?n:e.fontSize,b=(i=e.contentFontSizeLG)!==null&&i!==void 0?i:e.fontSizeLG,C=(s=e.contentLineHeight)!==null&&s!==void 0?s:mS(o),P=(d=e.contentLineHeightSM)!==null&&d!==void 0?d:mS(y),A=(f=e.contentLineHeightLG)!==null&&f!==void 0?f:mS(b),D=Xne(new aR(e.colorBgSolid),"#fff")?"#000":"#fff",k=qp.reduce((B,N)=>Object.assign(Object.assign({},B),{[`${N}ShadowColor`]:`0 ${dt(e.controlOutlineWidth)} 0 ${T0(e[`${N}1`],e.colorBgContainer)}`}),{});return Object.assign(Object.assign({},k),{fontWeight:400,iconGap:e.marginXS,defaultShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`,primaryShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`,dangerShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`,primaryColor:e.colorTextLightSolid,dangerColor:e.colorTextLightSolid,borderColorDisabled:e.colorBorder,defaultGhostColor:e.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:e.colorBgContainer,paddingInline:e.paddingContentHorizontal-e.lineWidth,paddingInlineLG:e.paddingContentHorizontal-e.lineWidth,paddingInlineSM:8-e.lineWidth,onlyIconSize:"inherit",onlyIconSizeSM:"inherit",onlyIconSizeLG:"inherit",groupBorderColor:e.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:e.colorText,textTextHoverColor:e.colorText,textTextActiveColor:e.colorText,textHoverBg:e.colorFillTertiary,defaultColor:e.colorText,defaultBg:e.colorBgContainer,defaultBorderColor:e.colorBorder,defaultBorderColorDisabled:e.colorBorder,defaultHoverBg:e.colorBgContainer,defaultHoverColor:e.colorPrimaryHover,defaultHoverBorderColor:e.colorPrimaryHover,defaultActiveBg:e.colorBgContainer,defaultActiveColor:e.colorPrimaryActive,defaultActiveBorderColor:e.colorPrimaryActive,solidTextColor:D,contentFontSize:o,contentFontSizeSM:y,contentFontSizeLG:b,contentLineHeight:C,contentLineHeightSM:P,contentLineHeightLG:A,paddingBlock:Math.max((e.controlHeight-o*C)/2-e.lineWidth,0),paddingBlockSM:Math.max((e.controlHeightSM-y*P)/2-e.lineWidth,0),paddingBlockLG:Math.max((e.controlHeightLG-b*A)/2-e.lineWidth,0)})},Zne=e=>{const{componentCls:t,iconCls:n,fontWeight:i,opacityLoading:s,motionDurationSlow:d,motionEaseInOut:f,iconGap:o,calc:y}=e;return{[t]:{outline:"none",position:"relative",display:"inline-flex",gap:o,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${dt(e.lineWidth)} ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:e.colorText,"&:disabled > *":{pointerEvents:"none"},[`${t}-icon > svg`]:nb(),"> a":{color:"currentColor"},"&:not(:disabled)":hf(e),[`&${t}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${t}-two-chinese-chars > *:not(${n})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},[`&${t}-icon-only`]:{paddingInline:0,[`&${t}-compact-item`]:{flex:"none"}},[`&${t}-loading`]:{opacity:s,cursor:"default"},[`${t}-loading-icon`]:{transition:["width","opacity","margin"].map(b=>`${b} ${d} ${f}`).join(",")},[`&:not(${t}-icon-end)`]:{[`${t}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineEnd:y(o).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineEnd:0},"&-leave-start":{marginInlineEnd:0},"&-leave-active":{marginInlineEnd:y(o).mul(-1).equal()}}},"&-icon-end":{flexDirection:"row-reverse",[`${t}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineStart:y(o).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineStart:0},"&-leave-start":{marginInlineStart:0},"&-leave-active":{marginInlineStart:y(o).mul(-1).equal()}}}}}},YU=(e,t,n)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":t,"&:active":n}}),Yne=e=>({minWidth:e.controlHeight,paddingInline:0,borderRadius:"50%"}),Jne=e=>({cursor:"not-allowed",borderColor:e.borderColorDisabled,color:e.colorTextDisabled,background:e.colorBgContainerDisabled,boxShadow:"none"}),mE=(e,t,n,i,s,d,f,o)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,background:t,borderColor:i||void 0,boxShadow:"none"},YU(e,Object.assign({background:t},f),Object.assign({background:t},o))),{"&:disabled":{cursor:"not-allowed",color:s||void 0,borderColor:d||void 0}})}),Qne=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},Jne(e))}),ere=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),gE=(e,t,n,i)=>{const d=i&&["link","text"].includes(i)?ere:Qne;return Object.assign(Object.assign({},d(e)),YU(e.componentCls,t,n))},vE=(e,t,n,i,s)=>({[`&${e.componentCls}-variant-solid`]:Object.assign({color:t,background:n},gE(e,i,s))}),_E=(e,t,n,i,s)=>({[`&${e.componentCls}-variant-outlined, &${e.componentCls}-variant-dashed`]:Object.assign({borderColor:t,background:n},gE(e,i,s))}),yE=e=>({[`&${e.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),xE=(e,t,n,i)=>({[`&${e.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:t},gE(e,n,i))}),$u=(e,t,n,i,s)=>({[`&${e.componentCls}-variant-${n}`]:Object.assign({color:t,boxShadow:"none"},gE(e,i,s,n))}),tre=e=>{const{componentCls:t}=e;return qp.reduce((n,i)=>{const s=e[`${i}6`],d=e[`${i}1`],f=e[`${i}5`],o=e[`${i}2`],y=e[`${i}3`],b=e[`${i}7`];return Object.assign(Object.assign({},n),{[`&${t}-color-${i}`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:s,boxShadow:e[`${i}ShadowColor`]},vE(e,e.colorTextLightSolid,s,{background:f},{background:b})),_E(e,s,e.colorBgContainer,{color:f,borderColor:f,background:e.colorBgContainer},{color:b,borderColor:b,background:e.colorBgContainer})),yE(e)),xE(e,d,{color:s,background:o},{color:s,background:y})),$u(e,s,"link",{color:f},{color:b})),$u(e,s,"text",{color:f,background:d},{color:b,background:y}))})},{})},nre=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.defaultColor,boxShadow:e.defaultShadow},vE(e,e.solidTextColor,e.colorBgSolid,{color:e.solidTextColor,background:e.colorBgSolidHover},{color:e.solidTextColor,background:e.colorBgSolidActive})),yE(e)),xE(e,e.colorFillTertiary,{color:e.defaultColor,background:e.colorFillSecondary},{color:e.defaultColor,background:e.colorFill})),mE(e.componentCls,e.ghostBg,e.defaultGhostColor,e.defaultGhostBorderColor,e.colorTextDisabled,e.colorBorder)),$u(e,e.textTextColor,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),rre=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorPrimary,boxShadow:e.primaryShadow},_E(e,e.colorPrimary,e.colorBgContainer,{color:e.colorPrimaryTextHover,borderColor:e.colorPrimaryHover,background:e.colorBgContainer},{color:e.colorPrimaryTextActive,borderColor:e.colorPrimaryActive,background:e.colorBgContainer})),yE(e)),xE(e,e.colorPrimaryBg,{color:e.colorPrimary,background:e.colorPrimaryBgHover},{color:e.colorPrimary,background:e.colorPrimaryBorder})),$u(e,e.colorPrimaryText,"text",{color:e.colorPrimaryTextHover,background:e.colorPrimaryBg},{color:e.colorPrimaryTextActive,background:e.colorPrimaryBorder})),$u(e,e.colorPrimaryText,"link",{color:e.colorPrimaryTextHover,background:e.linkHoverBg},{color:e.colorPrimaryTextActive})),mE(e.componentCls,e.ghostBg,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),ire=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorError,boxShadow:e.dangerShadow},vE(e,e.dangerColor,e.colorError,{background:e.colorErrorHover},{background:e.colorErrorActive})),_E(e,e.colorError,e.colorBgContainer,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),yE(e)),xE(e,e.colorErrorBg,{color:e.colorError,background:e.colorErrorBgFilledHover},{color:e.colorError,background:e.colorErrorBgActive})),$u(e,e.colorError,"text",{color:e.colorErrorHover,background:e.colorErrorBg},{color:e.colorErrorHover,background:e.colorErrorBgActive})),$u(e,e.colorError,"link",{color:e.colorErrorHover},{color:e.colorErrorActive})),mE(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),ore=e=>Object.assign(Object.assign({},$u(e,e.colorLink,"link",{color:e.colorLinkHover},{color:e.colorLinkActive})),mE(e.componentCls,e.ghostBg,e.colorInfo,e.colorInfo,e.colorTextDisabled,e.colorBorder,{color:e.colorInfoHover,borderColor:e.colorInfoHover},{color:e.colorInfoActive,borderColor:e.colorInfoActive})),are=e=>{const{componentCls:t}=e;return Object.assign({[`${t}-color-default`]:nre(e),[`${t}-color-primary`]:rre(e),[`${t}-color-dangerous`]:ire(e),[`${t}-color-link`]:ore(e)},tre(e))},sre=e=>Object.assign(Object.assign(Object.assign(Object.assign({},_E(e,e.defaultBorderColor,e.defaultBg,{color:e.defaultHoverColor,borderColor:e.defaultHoverBorderColor,background:e.defaultHoverBg},{color:e.defaultActiveColor,borderColor:e.defaultActiveBorderColor,background:e.defaultActiveBg})),$u(e,e.textTextColor,"text",{color:e.textTextHoverColor,background:e.textHoverBg},{color:e.textTextActiveColor,background:e.colorBgTextActive})),vE(e,e.primaryColor,e.colorPrimary,{background:e.colorPrimaryHover,color:e.primaryColor},{background:e.colorPrimaryActive,color:e.primaryColor})),$u(e,e.colorLink,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),LO=(e,t="")=>{const{componentCls:n,controlHeight:i,fontSize:s,borderRadius:d,buttonPaddingHorizontal:f,iconCls:o,buttonPaddingVertical:y,buttonIconOnlyFontSize:b}=e;return[{[t]:{fontSize:s,height:i,padding:`${dt(y)} ${dt(f)}`,borderRadius:d,[`&${n}-icon-only`]:{width:i,[o]:{fontSize:b}}}},{[`${n}${n}-circle${t}`]:Yne(e)},{[`${n}${n}-round${t}`]:{borderRadius:e.controlHeight,[`&:not(${n}-icon-only)`]:{paddingInline:e.buttonPaddingHorizontal}}}]},lre=e=>{const t=xo(e,{fontSize:e.contentFontSize});return LO(t,e.componentCls)},cre=e=>{const t=xo(e,{controlHeight:e.controlHeightSM,fontSize:e.contentFontSizeSM,padding:e.paddingXS,buttonPaddingHorizontal:e.paddingInlineSM,buttonPaddingVertical:0,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.onlyIconSizeSM});return LO(t,`${e.componentCls}-sm`)},ure=e=>{const t=xo(e,{controlHeight:e.controlHeightLG,fontSize:e.contentFontSizeLG,buttonPaddingHorizontal:e.paddingInlineLG,buttonPaddingVertical:0,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.onlyIconSizeLG});return LO(t,`${e.componentCls}-lg`)},dre=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}},hre=za("Button",e=>{const t=XU(e);return[Zne(t),lre(t),cre(t),ure(t),dre(t),are(t),sre(t),hne(t)]},ZU,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function fre(e,t,n,i){const{focusElCls:s,focus:d,borderElCls:f}=n,o=f?"> *":"",y=["hover",d?"focus":null,"active"].filter(Boolean).map(b=>`&:${b} ${o}`).join(",");return{[`&-item:not(${t}-last-item)`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal()},[`&-item:not(${i}-status-success)`]:{zIndex:2},"&-item":Object.assign(Object.assign({[y]:{zIndex:3}},s?{[`&${s}`]:{zIndex:3}}:{}),{[`&[disabled] ${o}`]:{zIndex:0}})}}function pre(e,t,n){const{borderElCls:i}=n,s=i?`> ${i}`:"";return{[`&-item:not(${t}-first-item):not(${t}-last-item) ${s}`]:{borderRadius:0},[`&-item:not(${t}-last-item)${t}-first-item`]:{[`& ${s}, &${e}-sm ${s}, &${e}-lg ${s}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${t}-first-item)${t}-last-item`]:{[`& ${s}, &${e}-sm ${s}, &${e}-lg ${s}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function zO(e,t={focus:!0}){const{componentCls:n}=e,i=`${n}-compact`;return{[i]:Object.assign(Object.assign({},fre(e,i,t,n)),pre(n,i,t))}}function mre(e,t,n){return{[`&-item:not(${t}-last-item)`]:{marginBottom:e.calc(e.lineWidth).mul(-1).equal()},[`&-item:not(${n}-status-success)`]:{zIndex:2},"&-item":{"&:hover,&:focus,&:active":{zIndex:3},"&[disabled]":{zIndex:0}}}}function gre(e,t){return{[`&-item:not(${t}-first-item):not(${t}-last-item)`]:{borderRadius:0},[`&-item${t}-first-item:not(${t}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${t}-last-item:not(${t}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function vre(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:Object.assign(Object.assign({},mre(e,t,e.componentCls)),gre(e.componentCls,t))}}const _re=e=>{const{componentCls:t,colorPrimaryHover:n,lineWidth:i,calc:s}=e,d=s(i).mul(-1).equal(),f=o=>{const y=`${t}-compact${o?"-vertical":""}-item${t}-primary:not([disabled])`;return{[`${y} + ${y}::before`]:{position:"absolute",top:o?d:0,insetInlineStart:o?0:d,backgroundColor:n,content:'""',width:o?"100%":i,height:o?i:"100%"}}};return Object.assign(Object.assign({},f()),f(!0))},yre=sE(["Button","compact"],e=>{const t=XU(e);return[zO(t),vre(t),_re(t)]},ZU);var xre=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function bre(e){if(typeof e=="object"&&e){let t=e==null?void 0:e.delay;return t=!Number.isNaN(t)&&typeof t=="number"?t:0,{loading:t<=0,delay:t}}return{loading:!!e,delay:0}}const wre={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["link","link"],text:["default","text"]},Sre=Wt.forwardRef((e,t)=>{var n,i;const{loading:s=!1,prefixCls:d,color:f,variant:o,type:y,danger:b=!1,shape:C,size:P,styles:A,disabled:D,className:k,rootClassName:B,children:N,icon:j,iconPosition:V="start",ghost:K=!1,block:Y=!1,htmlType:Z="button",classNames:te,style:ne={},autoInsertSpace:se,autoFocus:ee}=e,de=xre(e,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),fe=y||"default",{button:ye}=Wt.useContext(ji),ge=C||(ye==null?void 0:ye.shape)||"default",[we,Se]=I.useMemo(()=>{if(f&&o)return[f,o];if(y||b){const tr=wre[fe]||[];return b?["danger",tr[1]]:tr}return ye!=null&&ye.color&&(ye!=null&&ye.variant)?[ye.color,ye.variant]:["default","outlined"]},[y,f,o,b,ye==null?void 0:ye.variant,ye==null?void 0:ye.color]),Te=we==="danger"?"dangerous":we,{getPrefixCls:ze,direction:Ue,autoInsertSpace:We,className:Be,style:Xe,classNames:qe,styles:at}=Gu("button"),Ke=(n=se??We)!==null&&n!==void 0?n:!0,tt=ze("btn",d),[vt,Pt,ft]=hre(tt),Nt=I.useContext(Fd),Rt=D??Nt,pt=I.useContext(qU),yt=I.useMemo(()=>bre(s),[s]),[xt,bt]=I.useState(yt.loading),[Ct,tn]=I.useState(!1),Zt=I.useRef(null),In=bf(t,Zt),Cn=I.Children.count(N)===1&&!j&&!VI(Se),Mt=I.useRef(!0);Wt.useEffect(()=>(Mt.current=!1,()=>{Mt.current=!0}),[]),yo(()=>{let tr=null;yt.delay>0?tr=setTimeout(()=>{tr=null,bt(!0)},yt.delay):bt(yt.loading);function Jn(){tr&&(clearTimeout(tr),tr=null)}return Jn},[yt.delay,yt.loading]),I.useEffect(()=>{if(!Zt.current||!Ke)return;const tr=Zt.current.textContent||"";Cn&&iR(tr)?Ct||tn(!0):Ct&&tn(!1)}),I.useEffect(()=>{ee&&Zt.current&&Zt.current.focus()},[]);const hn=Wt.useCallback(tr=>{var Jn;if(xt||Rt){tr.preventDefault();return}(Jn=e.onClick)===null||Jn===void 0||Jn.call(e,("href"in e,tr))},[e.onClick,xt,Rt]),{compactSize:Jt,compactItemClassnames:Ut}=pE(tt,Ue),Tn={large:"lg",small:"sm",middle:void 0},On=Bd(tr=>{var Jn,Ir;return(Ir=(Jn=P??Jt)!==null&&Jn!==void 0?Jn:pt)!==null&&Ir!==void 0?Ir:tr}),Kn=On&&(i=Tn[On])!==null&&i!==void 0?i:"",Un=xt?"loading":j,Pn=as(de,["navigate"]),Qn=St(tt,Pt,ft,{[`${tt}-${ge}`]:ge!=="default"&&ge,[`${tt}-${fe}`]:fe,[`${tt}-dangerous`]:b,[`${tt}-color-${Te}`]:Te,[`${tt}-variant-${Se}`]:Se,[`${tt}-${Kn}`]:Kn,[`${tt}-icon-only`]:!N&&N!==0&&!!Un,[`${tt}-background-ghost`]:K&&!VI(Se),[`${tt}-loading`]:xt,[`${tt}-two-chinese-chars`]:Ct&&Ke&&!xt,[`${tt}-block`]:Y,[`${tt}-rtl`]:Ue==="rtl",[`${tt}-icon-end`]:V==="end"},Ut,k,B,Be),un=Object.assign(Object.assign({},Xe),ne),nn=St(te==null?void 0:te.icon,qe.icon),$n=Object.assign(Object.assign({},(A==null?void 0:A.icon)||{}),at.icon||{}),Ln=j&&!xt?Wt.createElement(oR,{prefixCls:tt,className:nn,style:$n},j):s&&typeof s=="object"&&s.icon?Wt.createElement(oR,{prefixCls:tt,className:nn,style:$n},s.icon):Wt.createElement(dne,{existIcon:!!j,prefixCls:tt,loading:xt,mount:Mt.current}),qn=N||N===0?une(N,Cn&&Ke):null;if(Pn.href!==void 0)return vt(Wt.createElement("a",Object.assign({},Pn,{className:St(Qn,{[`${tt}-disabled`]:Rt}),href:Rt?void 0:Pn.href,style:un,onClick:hn,ref:In,tabIndex:Rt?-1:0,"aria-disabled":Rt}),Ln,qn));let er=Wt.createElement("button",Object.assign({},de,{type:Z,className:Qn,style:un,onClick:hn,disabled:Rt,ref:In}),Ln,qn,Ut&&Wt.createElement(yre,{prefixCls:tt}));return VI(Se)||(er=Wt.createElement(hE,{component:"Button",disabled:xt},er)),vt(er)}),Uc=Sre;Uc.Group=lne;Uc.__ANT_BUTTON=!0;var JU=I.createContext(null),iB=[];function Cre(e,t){var n=I.useState(function(){if(!Bs())return null;var k=document.createElement("div");return k}),i=It(n,1),s=i[0],d=I.useRef(!1),f=I.useContext(JU),o=I.useState(iB),y=It(o,2),b=y[0],C=y[1],P=f||(d.current?void 0:function(k){C(function(B){var N=[k].concat(zn(B));return N})});function A(){s.parentElement||document.body.appendChild(s),d.current=!0}function D(){var k;(k=s.parentElement)===null||k===void 0||k.removeChild(s),d.current=!1}return yo(function(){return e?f?f(A):A():D(),D},[e]),yo(function(){b.length&&(b.forEach(function(k){return k()}),C(iB))},[b]),[s,P]}var WI;function QU(e){var t="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),n=document.createElement("div");n.id=t;var i=n.style;i.position="absolute",i.left="0",i.top="0",i.width="100px",i.height="100px",i.overflow="scroll";var s,d;if(e){var f=getComputedStyle(e);i.scrollbarColor=f.scrollbarColor,i.scrollbarWidth=f.scrollbarWidth;var o=getComputedStyle(e,"::-webkit-scrollbar"),y=parseInt(o.width,10),b=parseInt(o.height,10);try{var C=y?"width: ".concat(o.width,";"):"",P=b?"height: ".concat(o.height,";"):"";Od(`
#`.concat(t,`::-webkit-scrollbar {
`).concat(C,`
`).concat(P,`
}`),t)}catch(k){console.error(k),s=y,d=b}}document.body.appendChild(n);var A=e&&s&&!isNaN(s)?s:n.offsetWidth-n.clientWidth,D=e&&d&&!isNaN(d)?d:n.offsetHeight-n.clientHeight;return document.body.removeChild(n),Ex(t),{width:A,height:D}}function oB(e){return typeof document>"u"?0:(WI===void 0&&(WI=QU()),WI.width)}function lR(e){return typeof document>"u"||!e||!(e instanceof Element)?{width:0,height:0}:QU(e)}function Ere(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var Tre="rc-util-locker-".concat(Date.now()),aB=0;function Ire(e){var t=!!e,n=I.useState(function(){return aB+=1,"".concat(Tre,"_").concat(aB)}),i=It(n,1),s=i[0];yo(function(){if(t){var d=lR(document.body).width,f=Ere();Od(`
html body {
  overflow-y: hidden;
  `.concat(f?"width: calc(100% - ".concat(d,"px);"):"",`
}`),s)}else Ex(s);return function(){Ex(s)}},[t,s])}var Pre=!1;function Mre(e){return Pre}var sB=function(t){return t===!1?!1:!Bs()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},eH=I.forwardRef(function(e,t){var n=e.open,i=e.autoLock,s=e.getContainer;e.debug;var d=e.autoDestroy,f=d===void 0?!0:d,o=e.children,y=I.useState(n),b=It(y,2),C=b[0],P=b[1],A=C||n;I.useEffect(function(){(f||n)&&P(n)},[n,f]);var D=I.useState(function(){return sB(s)}),k=It(D,2),B=k[0],N=k[1];I.useEffect(function(){var fe=sB(s);N(fe??null)});var j=Cre(A&&!B),V=It(j,2),K=V[0],Y=V[1],Z=B??K;Ire(i&&n&&Bs()&&(Z===K||Z===document.body));var te=null;if(o&&Fu(o)&&t){var ne=o;te=ne.ref}var se=bf(te,t);if(!A||!Bs()||B===void 0)return null;var ee=Z===!1||Mre(),de=o;return t&&(de=I.cloneElement(o,{ref:se})),I.createElement(JU.Provider,{value:Y},ee?de:ku.createPortal(de,Z))});function Rre(){var e=Je({},qx);return e.useId}var lB=0,cB=Rre();const kO=cB?function(t){var n=cB();return t||n}:function(t){var n=I.useState("ssr-id"),i=It(n,2),s=i[0],d=i[1];return I.useEffect(function(){var f=lB;lB+=1,d("rc_unique_".concat(f))},[]),t||s};var Lp="RC_FORM_INTERNAL_HOOKS",Wo=function(){oa(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Lv=I.createContext({getFieldValue:Wo,getFieldsValue:Wo,getFieldError:Wo,getFieldWarning:Wo,getFieldsError:Wo,isFieldsTouched:Wo,isFieldTouched:Wo,isFieldValidating:Wo,isFieldsValidating:Wo,resetFields:Wo,setFields:Wo,setFieldValue:Wo,setFieldsValue:Wo,validateFields:Wo,submit:Wo,getInternalHooks:function(){return Wo(),{dispatch:Wo,initEntityValue:Wo,registerField:Wo,useSubscribe:Wo,setInitialValues:Wo,destroyForm:Wo,setCallbacks:Wo,registerWatch:Wo,getFields:Wo,setValidateMessages:Wo,setPreserve:Wo,getInitialValue:Wo}}}),lC=I.createContext(null);function cR(e){return e==null?[]:Array.isArray(e)?e:[e]}function Are(e){return e&&!!e._init}function uR(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var dR=uR();function Ore(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function Dre(e,t,n){if(dO())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var s=new(e.bind.apply(e,i));return n&&wx(s,n.prototype),s}function hR(e){var t=typeof Map=="function"?new Map:void 0;return hR=function(i){if(i===null||!Ore(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(i))return t.get(i);t.set(i,s)}function s(){return Dre(i,arguments,Sx(this).constructor)}return s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),wx(s,i)},hR(e)}var Lre=/%[sdj%]/g,zre=function(){};function fR(e){if(!e||!e.length)return null;var t={};return e.forEach(function(n){var i=n.field;t[i]=t[i]||[],t[i].push(n)}),t}function Hl(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var s=0,d=n.length;if(typeof e=="function")return e.apply(null,n);if(typeof e=="string"){var f=e.replace(Lre,function(o){if(o==="%%")return"%";if(s>=d)return o;switch(o){case"%s":return String(n[s++]);case"%d":return Number(n[s++]);case"%j":try{return JSON.stringify(n[s++])}catch{return"[Circular]"}break;default:return o}});return f}return e}function kre(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function os(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||kre(t)&&typeof e=="string"&&!e)}function Fre(e,t,n){var i=[],s=0,d=e.length;function f(o){i.push.apply(i,zn(o||[])),s++,s===d&&n(i)}e.forEach(function(o){t(o,f)})}function uB(e,t,n){var i=0,s=e.length;function d(f){if(f&&f.length){n(f);return}var o=i;i=i+1,o<s?t(e[o],d):n([])}d([])}function Nre(e){var t=[];return Object.keys(e).forEach(function(n){t.push.apply(t,zn(e[n]||[]))}),t}var dB=function(e){Uu(n,e);var t=Hu(n);function n(i,s){var d;return ja(this,n),d=t.call(this,"Async Validation Error"),ke(Mr(d),"errors",void 0),ke(Mr(d),"fields",void 0),d.errors=i,d.fields=s,d}return Va(n)}(hR(Error));function Bre(e,t,n,i,s){if(t.first){var d=new Promise(function(A,D){var k=function(j){return i(j),j.length?D(new dB(j,fR(j))):A(s)},B=Nre(e);uB(B,n,k)});return d.catch(function(A){return A}),d}var f=t.firstFields===!0?Object.keys(e):t.firstFields||[],o=Object.keys(e),y=o.length,b=0,C=[],P=new Promise(function(A,D){var k=function(N){if(C.push.apply(C,N),b++,b===y)return i(C),C.length?D(new dB(C,fR(C))):A(s)};o.length||(i(C),A(s)),o.forEach(function(B){var N=e[B];f.indexOf(B)!==-1?uB(N,n,k):Fre(N,n,k)})});return P.catch(function(A){return A}),P}function $re(e){return!!(e&&e.message!==void 0)}function jre(e,t){for(var n=e,i=0;i<t.length;i++){if(n==null)return n;n=n[t[i]]}return n}function hB(e,t){return function(n){var i;return e.fullFields?i=jre(t,e.fullFields):i=t[n.field||e.fullField],$re(n)?(n.field=n.field||e.fullField,n.fieldValue=i,n):{message:typeof n=="function"?n():n,fieldValue:i,field:n.field||e.fullField}}}function fB(e,t){if(t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];Nr(i)==="object"&&Nr(e[n])==="object"?e[n]=Je(Je({},e[n]),i):e[n]=i}}return e}var zg="enum",Vre=function(t,n,i,s,d){t[zg]=Array.isArray(t[zg])?t[zg]:[],t[zg].indexOf(n)===-1&&s.push(Hl(d.messages[zg],t.fullField,t[zg].join(", ")))},Ure=function(t,n,i,s,d){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(n)||s.push(Hl(d.messages.pattern.mismatch,t.fullField,n,t.pattern));else if(typeof t.pattern=="string"){var f=new RegExp(t.pattern);f.test(n)||s.push(Hl(d.messages.pattern.mismatch,t.fullField,n,t.pattern))}}},Hre=function(t,n,i,s,d){var f=typeof t.len=="number",o=typeof t.min=="number",y=typeof t.max=="number",b=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,C=n,P=null,A=typeof n=="number",D=typeof n=="string",k=Array.isArray(n);if(A?P="number":D?P="string":k&&(P="array"),!P)return!1;k&&(C=n.length),D&&(C=n.replace(b,"_").length),f?C!==t.len&&s.push(Hl(d.messages[P].len,t.fullField,t.len)):o&&!y&&C<t.min?s.push(Hl(d.messages[P].min,t.fullField,t.min)):y&&!o&&C>t.max?s.push(Hl(d.messages[P].max,t.fullField,t.max)):o&&y&&(C<t.min||C>t.max)&&s.push(Hl(d.messages[P].range,t.fullField,t.min,t.max))},tH=function(t,n,i,s,d,f){t.required&&(!i.hasOwnProperty(t.field)||os(n,f||t.type))&&s.push(Hl(d.messages.required,t.fullField))},Mw;const Gre=function(){if(Mw)return Mw;var e="[a-fA-F\\d:]",t=function(te){return te&&te.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(e,")|(?<=").concat(e,")(?=\\s|$))"):""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",s=["(?:".concat(i,":){7}(?:").concat(i,"|:)"),"(?:".concat(i,":){6}(?:").concat(n,"|:").concat(i,"|:)"),"(?:".concat(i,":){5}(?::").concat(n,"|(?::").concat(i,"){1,2}|:)"),"(?:".concat(i,":){4}(?:(?::").concat(i,"){0,1}:").concat(n,"|(?::").concat(i,"){1,3}|:)"),"(?:".concat(i,":){3}(?:(?::").concat(i,"){0,2}:").concat(n,"|(?::").concat(i,"){1,4}|:)"),"(?:".concat(i,":){2}(?:(?::").concat(i,"){0,3}:").concat(n,"|(?::").concat(i,"){1,5}|:)"),"(?:".concat(i,":){1}(?:(?::").concat(i,"){0,4}:").concat(n,"|(?::").concat(i,"){1,6}|:)"),"(?::(?:(?::".concat(i,"){0,5}:").concat(n,"|(?::").concat(i,"){1,7}|:))")],d="(?:%[0-9a-zA-Z]{1,})?",f="(?:".concat(s.join("|"),")").concat(d),o=new RegExp("(?:^".concat(n,"$)|(?:^").concat(f,"$)")),y=new RegExp("^".concat(n,"$")),b=new RegExp("^".concat(f,"$")),C=function(te){return te&&te.exact?o:new RegExp("(?:".concat(t(te)).concat(n).concat(t(te),")|(?:").concat(t(te)).concat(f).concat(t(te),")"),"g")};C.v4=function(Z){return Z&&Z.exact?y:new RegExp("".concat(t(Z)).concat(n).concat(t(Z)),"g")},C.v6=function(Z){return Z&&Z.exact?b:new RegExp("".concat(t(Z)).concat(f).concat(t(Z)),"g")};var P="(?:(?:[a-z]+:)?//)",A="(?:\\S+(?::\\S*)?@)?",D=C.v4().source,k=C.v6().source,B="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",N="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",j="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",V="(?::\\d{2,5})?",K='(?:[/?#][^\\s"]*)?',Y="(?:".concat(P,"|www\\.)").concat(A,"(?:localhost|").concat(D,"|").concat(k,"|").concat(B).concat(N).concat(j,")").concat(V).concat(K);return Mw=new RegExp("(?:^".concat(Y,"$)"),"i"),Mw};var pB={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},I0={integer:function(t){return I0.number(t)&&parseInt(t,10)===t},float:function(t){return I0.number(t)&&!I0.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return Nr(t)==="object"&&!I0.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(pB.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(Gre())},hex:function(t){return typeof t=="string"&&!!t.match(pB.hex)}},Wre=function(t,n,i,s,d){if(t.required&&n===void 0){tH(t,n,i,s,d);return}var f=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=t.type;f.indexOf(o)>-1?I0[o](n)||s.push(Hl(d.messages.types[o],t.fullField,t.type)):o&&Nr(n)!==t.type&&s.push(Hl(d.messages.types[o],t.fullField,t.type))},qre=function(t,n,i,s,d){(/^\s+$/.test(n)||n==="")&&s.push(Hl(d.messages.whitespace,t.fullField))};const co={required:tH,whitespace:qre,type:Wre,range:Hre,enum:Vre,pattern:Ure};var Kre=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d)}i(f)},Xre=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(n==null&&!t.required)return i();co.required(t,n,s,f,d,"array"),n!=null&&(co.type(t,n,s,f,d),co.range(t,n,s,f,d))}i(f)},Zre=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&co.type(t,n,s,f,d)}i(f)},Yre=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n,"date")&&!t.required)return i();if(co.required(t,n,s,f,d),!os(n,"date")){var y;n instanceof Date?y=n:y=new Date(n),co.type(t,y,s,f,d),y&&co.range(t,y.getTime(),s,f,d)}}i(f)},Jre="enum",Qre=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&co[Jre](t,n,s,f,d)}i(f)},eie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&(co.type(t,n,s,f,d),co.range(t,n,s,f,d))}i(f)},tie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&(co.type(t,n,s,f,d),co.range(t,n,s,f,d))}i(f)},nie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&co.type(t,n,s,f,d)}i(f)},rie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(n===""&&(n=void 0),os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&(co.type(t,n,s,f,d),co.range(t,n,s,f,d))}i(f)},iie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),n!==void 0&&co.type(t,n,s,f,d)}i(f)},oie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n,"string")&&!t.required)return i();co.required(t,n,s,f,d),os(n,"string")||co.pattern(t,n,s,f,d)}i(f)},aie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n)&&!t.required)return i();co.required(t,n,s,f,d),os(n)||co.type(t,n,s,f,d)}i(f)},sie=function(t,n,i,s,d){var f=[],o=Array.isArray(n)?"array":Nr(n);co.required(t,n,s,f,d,o),i(f)},lie=function(t,n,i,s,d){var f=[],o=t.required||!t.required&&s.hasOwnProperty(t.field);if(o){if(os(n,"string")&&!t.required)return i();co.required(t,n,s,f,d,"string"),os(n,"string")||(co.type(t,n,s,f,d),co.range(t,n,s,f,d),co.pattern(t,n,s,f,d),t.whitespace===!0&&co.whitespace(t,n,s,f,d))}i(f)},qI=function(t,n,i,s,d){var f=t.type,o=[],y=t.required||!t.required&&s.hasOwnProperty(t.field);if(y){if(os(n,f)&&!t.required)return i();co.required(t,n,s,o,d,f),os(n,f)||co.type(t,n,s,o,d)}i(o)};const W0={string:lie,method:nie,number:rie,boolean:Zre,regexp:aie,integer:tie,float:eie,array:Xre,object:iie,enum:Qre,pattern:oie,date:Yre,url:qI,hex:qI,email:qI,required:sie,any:Kre};var ib=function(){function e(t){ja(this,e),ke(this,"rules",null),ke(this,"_messages",dR),this.define(t)}return Va(e,[{key:"define",value:function(n){var i=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(Nr(n)!=="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(s){var d=n[s];i.rules[s]=Array.isArray(d)?d:[d]})}},{key:"messages",value:function(n){return n&&(this._messages=fB(uR(),n)),this._messages}},{key:"validate",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},f=n,o=s,y=d;if(typeof o=="function"&&(y=o,o={}),!this.rules||Object.keys(this.rules).length===0)return y&&y(null,f),Promise.resolve(f);function b(k){var B=[],N={};function j(K){if(Array.isArray(K)){var Y;B=(Y=B).concat.apply(Y,zn(K))}else B.push(K)}for(var V=0;V<k.length;V++)j(k[V]);B.length?(N=fR(B),y(B,N)):y(null,f)}if(o.messages){var C=this.messages();C===dR&&(C=uR()),fB(C,o.messages),o.messages=C}else o.messages=this.messages();var P={},A=o.keys||Object.keys(this.rules);A.forEach(function(k){var B=i.rules[k],N=f[k];B.forEach(function(j){var V=j;typeof V.transform=="function"&&(f===n&&(f=Je({},f)),N=f[k]=V.transform(N),N!=null&&(V.type=V.type||(Array.isArray(N)?"array":Nr(N)))),typeof V=="function"?V={validator:V}:V=Je({},V),V.validator=i.getValidationMethod(V),V.validator&&(V.field=k,V.fullField=V.fullField||k,V.type=i.getType(V),P[k]=P[k]||[],P[k].push({rule:V,value:N,source:f,field:k}))})});var D={};return Bre(P,o,function(k,B){var N=k.rule,j=(N.type==="object"||N.type==="array")&&(Nr(N.fields)==="object"||Nr(N.defaultField)==="object");j=j&&(N.required||!N.required&&k.value),N.field=k.field;function V(ne,se){return Je(Je({},se),{},{fullField:"".concat(N.fullField,".").concat(ne),fullFields:N.fullFields?[].concat(zn(N.fullFields),[ne]):[ne]})}function K(){var ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],se=Array.isArray(ne)?ne:[ne];!o.suppressWarning&&se.length&&e.warning("async-validator:",se),se.length&&N.message!==void 0&&(se=[].concat(N.message));var ee=se.map(hB(N,f));if(o.first&&ee.length)return D[N.field]=1,B(ee);if(!j)B(ee);else{if(N.required&&!k.value)return N.message!==void 0?ee=[].concat(N.message).map(hB(N,f)):o.error&&(ee=[o.error(N,Hl(o.messages.required,N.field))]),B(ee);var de={};N.defaultField&&Object.keys(k.value).map(function(ge){de[ge]=N.defaultField}),de=Je(Je({},de),k.rule.fields);var fe={};Object.keys(de).forEach(function(ge){var we=de[ge],Se=Array.isArray(we)?we:[we];fe[ge]=Se.map(V.bind(null,ge))});var ye=new e(fe);ye.messages(o.messages),k.rule.options&&(k.rule.options.messages=o.messages,k.rule.options.error=o.error),ye.validate(k.value,k.rule.options||o,function(ge){var we=[];ee&&ee.length&&we.push.apply(we,zn(ee)),ge&&ge.length&&we.push.apply(we,zn(ge)),B(we.length?we:null)})}}var Y;if(N.asyncValidator)Y=N.asyncValidator(N,k.value,K,k.source,o);else if(N.validator){try{Y=N.validator(N,k.value,K,k.source,o)}catch(ne){var Z,te;(Z=(te=console).error)===null||Z===void 0||Z.call(te,ne),o.suppressValidatorError||setTimeout(function(){throw ne},0),K(ne.message)}Y===!0?K():Y===!1?K(typeof N.message=="function"?N.message(N.fullField||N.field):N.message||"".concat(N.fullField||N.field," fails")):Y instanceof Array?K(Y):Y instanceof Error&&K(Y.message)}Y&&Y.then&&Y.then(function(){return K()},function(ne){return K(ne)})},function(k){b(k)},f)}},{key:"getType",value:function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!W0.hasOwnProperty(n.type))throw new Error(Hl("Unknown rule type %s",n.type));return n.type||"string"}},{key:"getValidationMethod",value:function(n){if(typeof n.validator=="function")return n.validator;var i=Object.keys(n),s=i.indexOf("message");return s!==-1&&i.splice(s,1),i.length===1&&i[0]==="required"?W0.required:W0[this.getType(n)]||void 0}}]),e}();ke(ib,"register",function(t,n){if(typeof n!="function")throw new Error("Cannot register a validator by type, validator is not a function");W0[t]=n});ke(ib,"warning",zre);ke(ib,"messages",dR);ke(ib,"validators",W0);var Bl="'${name}' is not a valid ${type}",nH={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Bl,method:Bl,array:Bl,object:Bl,number:Bl,date:Bl,boolean:Bl,integer:Bl,float:Bl,regexp:Bl,email:Bl,url:Bl,hex:Bl},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},mB=ib;function cie(e,t){return e.replace(/\\?\$\{\w+\}/g,function(n){if(n.startsWith("\\"))return n.slice(1);var i=n.slice(2,-1);return t[i]})}var gB="CODE_LOGIC_ERROR";function pR(e,t,n,i,s){return mR.apply(this,arguments)}function mR(){return mR=om($s().mark(function e(t,n,i,s,d){var f,o,y,b,C,P,A,D,k;return $s().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return f=Je({},i),delete f.ruleIndex,mB.warning=function(){},f.validator&&(o=f.validator,f.validator=function(){try{return o.apply(void 0,arguments)}catch(j){return console.error(j),Promise.reject(gB)}}),y=null,f&&f.type==="array"&&f.defaultField&&(y=f.defaultField,delete f.defaultField),b=new mB(ke({},t,[f])),C=av(nH,s.validateMessages),b.messages(C),P=[],N.prev=10,N.next=13,Promise.resolve(b.validate(ke({},t,n),Je({},s)));case 13:N.next=18;break;case 15:N.prev=15,N.t0=N.catch(10),N.t0.errors&&(P=N.t0.errors.map(function(j,V){var K=j.message,Y=K===gB?C.default:K;return I.isValidElement(Y)?I.cloneElement(Y,{key:"error_".concat(V)}):Y}));case 18:if(!(!P.length&&y)){N.next=23;break}return N.next=21,Promise.all(n.map(function(j,V){return pR("".concat(t,".").concat(V),j,y,s,d)}));case 21:return A=N.sent,N.abrupt("return",A.reduce(function(j,V){return[].concat(zn(j),zn(V))},[]));case 23:return D=Je(Je({},i),{},{name:t,enum:(i.enum||[]).join(", ")},d),k=P.map(function(j){return typeof j=="string"?cie(j,D):j}),N.abrupt("return",k);case 26:case"end":return N.stop()}},e,null,[[10,15]])})),mR.apply(this,arguments)}function uie(e,t,n,i,s,d){var f=e.join("."),o=n.map(function(C,P){var A=C.validator,D=Je(Je({},C),{},{ruleIndex:P});return A&&(D.validator=function(k,B,N){var j=!1,V=function(){for(var Z=arguments.length,te=new Array(Z),ne=0;ne<Z;ne++)te[ne]=arguments[ne];Promise.resolve().then(function(){oa(!j,"Your validator function has already return a promise. `callback` will be ignored."),j||N.apply(void 0,te)})},K=A(k,B,V);j=K&&typeof K.then=="function"&&typeof K.catch=="function",oa(j,"`callback` is deprecated. Please return a promise instead."),j&&K.then(function(){N()}).catch(function(Y){N(Y||" ")})}),D}).sort(function(C,P){var A=C.warningOnly,D=C.ruleIndex,k=P.warningOnly,B=P.ruleIndex;return!!A==!!k?D-B:A?1:-1}),y;if(s===!0)y=new Promise(function(){var C=om($s().mark(function P(A,D){var k,B,N;return $s().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:k=0;case 1:if(!(k<o.length)){V.next=12;break}return B=o[k],V.next=5,pR(f,t,B,i,d);case 5:if(N=V.sent,!N.length){V.next=9;break}return D([{errors:N,rule:B}]),V.abrupt("return");case 9:k+=1,V.next=1;break;case 12:A([]);case 13:case"end":return V.stop()}},P)}));return function(P,A){return C.apply(this,arguments)}}());else{var b=o.map(function(C){return pR(f,t,C,i,d).then(function(P){return{errors:P,rule:C}})});y=(s?hie(b):die(b)).then(function(C){return Promise.reject(C)})}return y.catch(function(C){return C}),y}function die(e){return gR.apply(this,arguments)}function gR(){return gR=om($s().mark(function e(t){return $s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.all(t).then(function(s){var d,f=(d=[]).concat.apply(d,zn(s));return f}));case 1:case"end":return i.stop()}},e)})),gR.apply(this,arguments)}function hie(e){return vR.apply(this,arguments)}function vR(){return vR=om($s().mark(function e(t){var n;return $s().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=0,s.abrupt("return",new Promise(function(d){t.forEach(function(f){f.then(function(o){o.errors.length&&d([o]),n+=1,n===t.length&&d([])})})}));case 2:case"end":return s.stop()}},e)})),vR.apply(this,arguments)}function Na(e){return cR(e)}function vB(e,t){var n={};return t.forEach(function(i){var s=Ul(e,i);n=$c(n,i,s)}),n}function vv(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e&&e.some(function(i){return rH(t,i,n)})}function rH(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!e||!t||!n&&e.length!==t.length?!1:t.every(function(i,s){return e[s]===i})}function fie(e,t){if(e===t)return!0;if(!e&&t||e&&!t||!e||!t||Nr(e)!=="object"||Nr(t)!=="object")return!1;var n=Object.keys(e),i=Object.keys(t),s=new Set([].concat(n,i));return zn(s).every(function(d){var f=e[d],o=t[d];return typeof f=="function"&&typeof o=="function"?!0:f===o})}function pie(e){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&Nr(t.target)==="object"&&e in t.target?t.target[e]:t}function _B(e,t,n){var i=e.length;if(t<0||t>=i||n<0||n>=i)return e;var s=e[t],d=t-n;return d>0?[].concat(zn(e.slice(0,n)),[s],zn(e.slice(n,t)),zn(e.slice(t+1,i))):d<0?[].concat(zn(e.slice(0,t)),zn(e.slice(t+1,n+1)),[s],zn(e.slice(n+1,i))):e}var mie=["name"],ac=[];function KI(e,t,n,i,s,d){return typeof e=="function"?e(t,n,"source"in d?{source:d.source}:{}):i!==s}var FO=function(e){Uu(n,e);var t=Hu(n);function n(i){var s;if(ja(this,n),s=t.call(this,i),ke(Mr(s),"state",{resetCount:0}),ke(Mr(s),"cancelRegisterFunc",null),ke(Mr(s),"mounted",!1),ke(Mr(s),"touched",!1),ke(Mr(s),"dirty",!1),ke(Mr(s),"validatePromise",void 0),ke(Mr(s),"prevValidating",void 0),ke(Mr(s),"errors",ac),ke(Mr(s),"warnings",ac),ke(Mr(s),"cancelRegister",function(){var y=s.props,b=y.preserve,C=y.isListField,P=y.name;s.cancelRegisterFunc&&s.cancelRegisterFunc(C,b,Na(P)),s.cancelRegisterFunc=null}),ke(Mr(s),"getNamePath",function(){var y=s.props,b=y.name,C=y.fieldContext,P=C.prefixName,A=P===void 0?[]:P;return b!==void 0?[].concat(zn(A),zn(b)):[]}),ke(Mr(s),"getRules",function(){var y=s.props,b=y.rules,C=b===void 0?[]:b,P=y.fieldContext;return C.map(function(A){return typeof A=="function"?A(P):A})}),ke(Mr(s),"refresh",function(){s.mounted&&s.setState(function(y){var b=y.resetCount;return{resetCount:b+1}})}),ke(Mr(s),"metaCache",null),ke(Mr(s),"triggerMetaEvent",function(y){var b=s.props.onMetaChange;if(b){var C=Je(Je({},s.getMeta()),{},{destroy:y});Yc(s.metaCache,C)||b(C),s.metaCache=C}else s.metaCache=null}),ke(Mr(s),"onStoreChange",function(y,b,C){var P=s.props,A=P.shouldUpdate,D=P.dependencies,k=D===void 0?[]:D,B=P.onReset,N=C.store,j=s.getNamePath(),V=s.getValue(y),K=s.getValue(N),Y=b&&vv(b,j);switch(C.type==="valueUpdate"&&C.source==="external"&&!Yc(V,K)&&(s.touched=!0,s.dirty=!0,s.validatePromise=null,s.errors=ac,s.warnings=ac,s.triggerMetaEvent()),C.type){case"reset":if(!b||Y){s.touched=!1,s.dirty=!1,s.validatePromise=void 0,s.errors=ac,s.warnings=ac,s.triggerMetaEvent(),B==null||B(),s.refresh();return}break;case"remove":{if(A&&KI(A,y,N,V,K,C)){s.reRender();return}break}case"setField":{var Z=C.data;if(Y){"touched"in Z&&(s.touched=Z.touched),"validating"in Z&&!("originRCField"in Z)&&(s.validatePromise=Z.validating?Promise.resolve([]):null),"errors"in Z&&(s.errors=Z.errors||ac),"warnings"in Z&&(s.warnings=Z.warnings||ac),s.dirty=!0,s.triggerMetaEvent(),s.reRender();return}else if("value"in Z&&vv(b,j,!0)){s.reRender();return}if(A&&!j.length&&KI(A,y,N,V,K,C)){s.reRender();return}break}case"dependenciesUpdate":{var te=k.map(Na);if(te.some(function(ne){return vv(C.relatedFields,ne)})){s.reRender();return}break}default:if(Y||(!k.length||j.length||A)&&KI(A,y,N,V,K,C)){s.reRender();return}break}A===!0&&s.reRender()}),ke(Mr(s),"validateRules",function(y){var b=s.getNamePath(),C=s.getValue(),P=y||{},A=P.triggerName,D=P.validateOnly,k=D===void 0?!1:D,B=Promise.resolve().then(om($s().mark(function N(){var j,V,K,Y,Z,te,ne;return $s().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(s.mounted){ee.next=2;break}return ee.abrupt("return",[]);case 2:if(j=s.props,V=j.validateFirst,K=V===void 0?!1:V,Y=j.messageVariables,Z=j.validateDebounce,te=s.getRules(),A&&(te=te.filter(function(de){return de}).filter(function(de){var fe=de.validateTrigger;if(!fe)return!0;var ye=cR(fe);return ye.includes(A)})),!(Z&&A)){ee.next=10;break}return ee.next=8,new Promise(function(de){setTimeout(de,Z)});case 8:if(s.validatePromise===B){ee.next=10;break}return ee.abrupt("return",[]);case 10:return ne=uie(b,C,te,y,K,Y),ne.catch(function(de){return de}).then(function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ac;if(s.validatePromise===B){var fe;s.validatePromise=null;var ye=[],ge=[];(fe=de.forEach)===null||fe===void 0||fe.call(de,function(we){var Se=we.rule.warningOnly,xe=we.errors,Te=xe===void 0?ac:xe;Se?ge.push.apply(ge,zn(Te)):ye.push.apply(ye,zn(Te))}),s.errors=ye,s.warnings=ge,s.triggerMetaEvent(),s.reRender()}}),ee.abrupt("return",ne);case 13:case"end":return ee.stop()}},N)})));return k||(s.validatePromise=B,s.dirty=!0,s.errors=ac,s.warnings=ac,s.triggerMetaEvent(),s.reRender()),B}),ke(Mr(s),"isFieldValidating",function(){return!!s.validatePromise}),ke(Mr(s),"isFieldTouched",function(){return s.touched}),ke(Mr(s),"isFieldDirty",function(){if(s.dirty||s.props.initialValue!==void 0)return!0;var y=s.props.fieldContext,b=y.getInternalHooks(Lp),C=b.getInitialValue;return C(s.getNamePath())!==void 0}),ke(Mr(s),"getErrors",function(){return s.errors}),ke(Mr(s),"getWarnings",function(){return s.warnings}),ke(Mr(s),"isListField",function(){return s.props.isListField}),ke(Mr(s),"isList",function(){return s.props.isList}),ke(Mr(s),"isPreserve",function(){return s.props.preserve}),ke(Mr(s),"getMeta",function(){s.prevValidating=s.isFieldValidating();var y={touched:s.isFieldTouched(),validating:s.prevValidating,errors:s.errors,warnings:s.warnings,name:s.getNamePath(),validated:s.validatePromise===null};return y}),ke(Mr(s),"getOnlyChild",function(y){if(typeof y=="function"){var b=s.getMeta();return Je(Je({},s.getOnlyChild(y(s.getControlled(),b,s.props.fieldContext))),{},{isFunction:!0})}var C=vc(y);return C.length!==1||!I.isValidElement(C[0])?{child:C,isFunction:!1}:{child:C[0],isFunction:!1}}),ke(Mr(s),"getValue",function(y){var b=s.props.fieldContext.getFieldsValue,C=s.getNamePath();return Ul(y||b(!0),C)}),ke(Mr(s),"getControlled",function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=s.props,C=b.name,P=b.trigger,A=b.validateTrigger,D=b.getValueFromEvent,k=b.normalize,B=b.valuePropName,N=b.getValueProps,j=b.fieldContext,V=A!==void 0?A:j.validateTrigger,K=s.getNamePath(),Y=j.getInternalHooks,Z=j.getFieldsValue,te=Y(Lp),ne=te.dispatch,se=s.getValue(),ee=N||function(we){return ke({},B,we)},de=y[P],fe=C!==void 0?ee(se):{},ye=Je(Je({},y),fe);ye[P]=function(){s.touched=!0,s.dirty=!0,s.triggerMetaEvent();for(var we,Se=arguments.length,xe=new Array(Se),Te=0;Te<Se;Te++)xe[Te]=arguments[Te];D?we=D.apply(void 0,xe):we=pie.apply(void 0,[B].concat(xe)),k&&(we=k(we,se,Z(!0))),we!==se&&ne({type:"updateValue",namePath:K,value:we}),de&&de.apply(void 0,xe)};var ge=cR(V||[]);return ge.forEach(function(we){var Se=ye[we];ye[we]=function(){Se&&Se.apply(void 0,arguments);var xe=s.props.rules;xe&&xe.length&&ne({type:"validateField",namePath:K,triggerName:we})}}),ye}),i.fieldContext){var d=i.fieldContext.getInternalHooks,f=d(Lp),o=f.initEntityValue;o(Mr(s))}return s}return Va(n,[{key:"componentDidMount",value:function(){var s=this.props,d=s.shouldUpdate,f=s.fieldContext;if(this.mounted=!0,f){var o=f.getInternalHooks,y=o(Lp),b=y.registerField;this.cancelRegisterFunc=b(this)}d===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var s=this.state.resetCount,d=this.props.children,f=this.getOnlyChild(d),o=f.child,y=f.isFunction,b;return y?b=o:I.isValidElement(o)?b=I.cloneElement(o,this.getControlled(o.props)):(oa(!o,"`children` of Field is not validate ReactElement."),b=o),I.createElement(I.Fragment,{key:s},b)}}]),n}(I.Component);ke(FO,"contextType",Lv);ke(FO,"defaultProps",{trigger:"onChange",valuePropName:"value"});function iH(e){var t,n=e.name,i=ri(e,mie),s=I.useContext(Lv),d=I.useContext(lC),f=n!==void 0?Na(n):void 0,o=(t=i.isListField)!==null&&t!==void 0?t:!!d,y="keep";return o||(y="_".concat((f||[]).join("_"))),I.createElement(FO,kn({key:y,name:f,isListField:o},i,{fieldContext:s}))}function gie(e){var t=e.name,n=e.initialValue,i=e.children,s=e.rules,d=e.validateTrigger,f=e.isListField,o=I.useContext(Lv),y=I.useContext(lC),b=I.useRef({keys:[],id:0}),C=b.current,P=I.useMemo(function(){var B=Na(o.prefixName)||[];return[].concat(zn(B),zn(Na(t)))},[o.prefixName,t]),A=I.useMemo(function(){return Je(Je({},o),{},{prefixName:P})},[o,P]),D=I.useMemo(function(){return{getKey:function(N){var j=P.length,V=N[j];return[C.keys[V],N.slice(j+1)]}}},[P]);if(typeof i!="function")return oa(!1,"Form.List only accepts function as children."),null;var k=function(N,j,V){var K=V.source;return K==="internal"?!1:N!==j};return I.createElement(lC.Provider,{value:D},I.createElement(Lv.Provider,{value:A},I.createElement(iH,{name:[],shouldUpdate:k,rules:s,validateTrigger:d,initialValue:n,isList:!0,isListField:f??!!y},function(B,N){var j=B.value,V=j===void 0?[]:j,K=B.onChange,Y=o.getFieldValue,Z=function(){var ee=Y(P||[]);return ee||[]},te={add:function(ee,de){var fe=Z();de>=0&&de<=fe.length?(C.keys=[].concat(zn(C.keys.slice(0,de)),[C.id],zn(C.keys.slice(de))),K([].concat(zn(fe.slice(0,de)),[ee],zn(fe.slice(de))))):(C.keys=[].concat(zn(C.keys),[C.id]),K([].concat(zn(fe),[ee]))),C.id+=1},remove:function(ee){var de=Z(),fe=new Set(Array.isArray(ee)?ee:[ee]);fe.size<=0||(C.keys=C.keys.filter(function(ye,ge){return!fe.has(ge)}),K(de.filter(function(ye,ge){return!fe.has(ge)})))},move:function(ee,de){if(ee!==de){var fe=Z();ee<0||ee>=fe.length||de<0||de>=fe.length||(C.keys=_B(C.keys,ee,de),K(_B(fe,ee,de)))}}},ne=V||[];return Array.isArray(ne)||(ne=[]),i(ne.map(function(se,ee){var de=C.keys[ee];return de===void 0&&(C.keys[ee]=C.id,de=C.keys[ee],C.id+=1),{name:ee,key:de,isListField:!0}}),te,N)})))}function vie(e){var t=!1,n=e.length,i=[];return e.length?new Promise(function(s,d){e.forEach(function(f,o){f.catch(function(y){return t=!0,y}).then(function(y){n-=1,i[o]=y,!(n>0)&&(t&&d(i),s(i))})})}):Promise.resolve([])}var oH="__@field_split__";function XI(e){return e.map(function(t){return"".concat(Nr(t),":").concat(t)}).join(oH)}var kg=function(){function e(){ja(this,e),ke(this,"kvs",new Map)}return Va(e,[{key:"set",value:function(n,i){this.kvs.set(XI(n),i)}},{key:"get",value:function(n){return this.kvs.get(XI(n))}},{key:"update",value:function(n,i){var s=this.get(n),d=i(s);d?this.set(n,d):this.delete(n)}},{key:"delete",value:function(n){this.kvs.delete(XI(n))}},{key:"map",value:function(n){return zn(this.kvs.entries()).map(function(i){var s=It(i,2),d=s[0],f=s[1],o=d.split(oH);return n({key:o.map(function(y){var b=y.match(/^([^:]*):(.*)$/),C=It(b,3),P=C[1],A=C[2];return P==="number"?Number(A):A}),value:f})})}},{key:"toJSON",value:function(){var n={};return this.map(function(i){var s=i.key,d=i.value;return n[s.join(".")]=d,null}),n}}]),e}(),_ie=["name"],yie=Va(function e(t){var n=this;ja(this,e),ke(this,"formHooked",!1),ke(this,"forceRootUpdate",void 0),ke(this,"subscribable",!0),ke(this,"store",{}),ke(this,"fieldEntities",[]),ke(this,"initialValues",{}),ke(this,"callbacks",{}),ke(this,"validateMessages",null),ke(this,"preserve",null),ke(this,"lastValidatePromise",null),ke(this,"getForm",function(){return{getFieldValue:n.getFieldValue,getFieldsValue:n.getFieldsValue,getFieldError:n.getFieldError,getFieldWarning:n.getFieldWarning,getFieldsError:n.getFieldsError,isFieldsTouched:n.isFieldsTouched,isFieldTouched:n.isFieldTouched,isFieldValidating:n.isFieldValidating,isFieldsValidating:n.isFieldsValidating,resetFields:n.resetFields,setFields:n.setFields,setFieldValue:n.setFieldValue,setFieldsValue:n.setFieldsValue,validateFields:n.validateFields,submit:n.submit,_init:!0,getInternalHooks:n.getInternalHooks}}),ke(this,"getInternalHooks",function(i){return i===Lp?(n.formHooked=!0,{dispatch:n.dispatch,initEntityValue:n.initEntityValue,registerField:n.registerField,useSubscribe:n.useSubscribe,setInitialValues:n.setInitialValues,destroyForm:n.destroyForm,setCallbacks:n.setCallbacks,setValidateMessages:n.setValidateMessages,getFields:n.getFields,setPreserve:n.setPreserve,getInitialValue:n.getInitialValue,registerWatch:n.registerWatch}):(oa(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),ke(this,"useSubscribe",function(i){n.subscribable=i}),ke(this,"prevWithoutPreserves",null),ke(this,"setInitialValues",function(i,s){if(n.initialValues=i||{},s){var d,f=av(i,n.store);(d=n.prevWithoutPreserves)===null||d===void 0||d.map(function(o){var y=o.key;f=$c(f,y,Ul(i,y))}),n.prevWithoutPreserves=null,n.updateStore(f)}}),ke(this,"destroyForm",function(i){if(i)n.updateStore({});else{var s=new kg;n.getFieldEntities(!0).forEach(function(d){n.isMergedPreserve(d.isPreserve())||s.set(d.getNamePath(),!0)}),n.prevWithoutPreserves=s}}),ke(this,"getInitialValue",function(i){var s=Ul(n.initialValues,i);return i.length?av(s):s}),ke(this,"setCallbacks",function(i){n.callbacks=i}),ke(this,"setValidateMessages",function(i){n.validateMessages=i}),ke(this,"setPreserve",function(i){n.preserve=i}),ke(this,"watchList",[]),ke(this,"registerWatch",function(i){return n.watchList.push(i),function(){n.watchList=n.watchList.filter(function(s){return s!==i})}}),ke(this,"notifyWatch",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(n.watchList.length){var s=n.getFieldsValue(),d=n.getFieldsValue(!0);n.watchList.forEach(function(f){f(s,d,i)})}}),ke(this,"timeoutId",null),ke(this,"warningUnhooked",function(){}),ke(this,"updateStore",function(i){n.store=i}),ke(this,"getFieldEntities",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return i?n.fieldEntities.filter(function(s){return s.getNamePath().length}):n.fieldEntities}),ke(this,"getFieldsMap",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=new kg;return n.getFieldEntities(i).forEach(function(d){var f=d.getNamePath();s.set(f,d)}),s}),ke(this,"getFieldEntitiesForNamePathList",function(i){if(!i)return n.getFieldEntities(!0);var s=n.getFieldsMap(!0);return i.map(function(d){var f=Na(d);return s.get(f)||{INVALIDATE_NAME_PATH:Na(d)}})}),ke(this,"getFieldsValue",function(i,s){n.warningUnhooked();var d,f,o;if(i===!0||Array.isArray(i)?(d=i,f=s):i&&Nr(i)==="object"&&(o=i.strict,f=i.filter),d===!0&&!f)return n.store;var y=n.getFieldEntitiesForNamePathList(Array.isArray(d)?d:null),b=[];return y.forEach(function(C){var P,A,D="INVALIDATE_NAME_PATH"in C?C.INVALIDATE_NAME_PATH:C.getNamePath();if(o){var k,B;if((k=(B=C).isList)!==null&&k!==void 0&&k.call(B))return}else if(!d&&(P=(A=C).isListField)!==null&&P!==void 0&&P.call(A))return;if(!f)b.push(D);else{var N="getMeta"in C?C.getMeta():null;f(N)&&b.push(D)}}),vB(n.store,b.map(Na))}),ke(this,"getFieldValue",function(i){n.warningUnhooked();var s=Na(i);return Ul(n.store,s)}),ke(this,"getFieldsError",function(i){n.warningUnhooked();var s=n.getFieldEntitiesForNamePathList(i);return s.map(function(d,f){return d&&!("INVALIDATE_NAME_PATH"in d)?{name:d.getNamePath(),errors:d.getErrors(),warnings:d.getWarnings()}:{name:Na(i[f]),errors:[],warnings:[]}})}),ke(this,"getFieldError",function(i){n.warningUnhooked();var s=Na(i),d=n.getFieldsError([s])[0];return d.errors}),ke(this,"getFieldWarning",function(i){n.warningUnhooked();var s=Na(i),d=n.getFieldsError([s])[0];return d.warnings}),ke(this,"isFieldsTouched",function(){n.warningUnhooked();for(var i=arguments.length,s=new Array(i),d=0;d<i;d++)s[d]=arguments[d];var f=s[0],o=s[1],y,b=!1;s.length===0?y=null:s.length===1?Array.isArray(f)?(y=f.map(Na),b=!1):(y=null,b=f):(y=f.map(Na),b=o);var C=n.getFieldEntities(!0),P=function(N){return N.isFieldTouched()};if(!y)return b?C.every(function(B){return P(B)||B.isList()}):C.some(P);var A=new kg;y.forEach(function(B){A.set(B,[])}),C.forEach(function(B){var N=B.getNamePath();y.forEach(function(j){j.every(function(V,K){return N[K]===V})&&A.update(j,function(V){return[].concat(zn(V),[B])})})});var D=function(N){return N.some(P)},k=A.map(function(B){var N=B.value;return N});return b?k.every(D):k.some(D)}),ke(this,"isFieldTouched",function(i){return n.warningUnhooked(),n.isFieldsTouched([i])}),ke(this,"isFieldsValidating",function(i){n.warningUnhooked();var s=n.getFieldEntities();if(!i)return s.some(function(f){return f.isFieldValidating()});var d=i.map(Na);return s.some(function(f){var o=f.getNamePath();return vv(d,o)&&f.isFieldValidating()})}),ke(this,"isFieldValidating",function(i){return n.warningUnhooked(),n.isFieldsValidating([i])}),ke(this,"resetWithFieldInitialValue",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=new kg,d=n.getFieldEntities(!0);d.forEach(function(y){var b=y.props.initialValue,C=y.getNamePath();if(b!==void 0){var P=s.get(C)||new Set;P.add({entity:y,value:b}),s.set(C,P)}});var f=function(b){b.forEach(function(C){var P=C.props.initialValue;if(P!==void 0){var A=C.getNamePath(),D=n.getInitialValue(A);if(D!==void 0)oa(!1,"Form already set 'initialValues' with path '".concat(A.join("."),"'. Field can not overwrite it."));else{var k=s.get(A);if(k&&k.size>1)oa(!1,"Multiple Field with path '".concat(A.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(k){var B=n.getFieldValue(A),N=C.isListField();!N&&(!i.skipExist||B===void 0)&&n.updateStore($c(n.store,A,zn(k)[0].value))}}}})},o;i.entities?o=i.entities:i.namePathList?(o=[],i.namePathList.forEach(function(y){var b=s.get(y);if(b){var C;(C=o).push.apply(C,zn(zn(b).map(function(P){return P.entity})))}})):o=d,f(o)}),ke(this,"resetFields",function(i){n.warningUnhooked();var s=n.store;if(!i){n.updateStore(av(n.initialValues)),n.resetWithFieldInitialValue(),n.notifyObservers(s,null,{type:"reset"}),n.notifyWatch();return}var d=i.map(Na);d.forEach(function(f){var o=n.getInitialValue(f);n.updateStore($c(n.store,f,o))}),n.resetWithFieldInitialValue({namePathList:d}),n.notifyObservers(s,d,{type:"reset"}),n.notifyWatch(d)}),ke(this,"setFields",function(i){n.warningUnhooked();var s=n.store,d=[];i.forEach(function(f){var o=f.name,y=ri(f,_ie),b=Na(o);d.push(b),"value"in y&&n.updateStore($c(n.store,b,y.value)),n.notifyObservers(s,[b],{type:"setField",data:f})}),n.notifyWatch(d)}),ke(this,"getFields",function(){var i=n.getFieldEntities(!0),s=i.map(function(d){var f=d.getNamePath(),o=d.getMeta(),y=Je(Je({},o),{},{name:f,value:n.getFieldValue(f)});return Object.defineProperty(y,"originRCField",{value:!0}),y});return s}),ke(this,"initEntityValue",function(i){var s=i.props.initialValue;if(s!==void 0){var d=i.getNamePath(),f=Ul(n.store,d);f===void 0&&n.updateStore($c(n.store,d,s))}}),ke(this,"isMergedPreserve",function(i){var s=i!==void 0?i:n.preserve;return s??!0}),ke(this,"registerField",function(i){n.fieldEntities.push(i);var s=i.getNamePath();if(n.notifyWatch([s]),i.props.initialValue!==void 0){var d=n.store;n.resetWithFieldInitialValue({entities:[i],skipExist:!0}),n.notifyObservers(d,[i.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(f,o){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n.fieldEntities=n.fieldEntities.filter(function(P){return P!==i}),!n.isMergedPreserve(o)&&(!f||y.length>1)){var b=f?void 0:n.getInitialValue(s);if(s.length&&n.getFieldValue(s)!==b&&n.fieldEntities.every(function(P){return!rH(P.getNamePath(),s)})){var C=n.store;n.updateStore($c(C,s,b,!0)),n.notifyObservers(C,[s],{type:"remove"}),n.triggerDependenciesUpdate(C,s)}}n.notifyWatch([s])}}),ke(this,"dispatch",function(i){switch(i.type){case"updateValue":{var s=i.namePath,d=i.value;n.updateValue(s,d);break}case"validateField":{var f=i.namePath,o=i.triggerName;n.validateFields([f],{triggerName:o});break}}}),ke(this,"notifyObservers",function(i,s,d){if(n.subscribable){var f=Je(Je({},d),{},{store:n.getFieldsValue(!0)});n.getFieldEntities().forEach(function(o){var y=o.onStoreChange;y(i,s,f)})}else n.forceRootUpdate()}),ke(this,"triggerDependenciesUpdate",function(i,s){var d=n.getDependencyChildrenFields(s);return d.length&&n.validateFields(d),n.notifyObservers(i,d,{type:"dependenciesUpdate",relatedFields:[s].concat(zn(d))}),d}),ke(this,"updateValue",function(i,s){var d=Na(i),f=n.store;n.updateStore($c(n.store,d,s)),n.notifyObservers(f,[d],{type:"valueUpdate",source:"internal"}),n.notifyWatch([d]);var o=n.triggerDependenciesUpdate(f,d),y=n.callbacks.onValuesChange;if(y){var b=vB(n.store,[d]);y(b,n.getFieldsValue())}n.triggerOnFieldsChange([d].concat(zn(o)))}),ke(this,"setFieldsValue",function(i){n.warningUnhooked();var s=n.store;if(i){var d=av(n.store,i);n.updateStore(d)}n.notifyObservers(s,null,{type:"valueUpdate",source:"external"}),n.notifyWatch()}),ke(this,"setFieldValue",function(i,s){n.setFields([{name:i,value:s,errors:[],warnings:[]}])}),ke(this,"getDependencyChildrenFields",function(i){var s=new Set,d=[],f=new kg;n.getFieldEntities().forEach(function(y){var b=y.props.dependencies;(b||[]).forEach(function(C){var P=Na(C);f.update(P,function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return A.add(y),A})})});var o=function y(b){var C=f.get(b)||new Set;C.forEach(function(P){if(!s.has(P)){s.add(P);var A=P.getNamePath();P.isFieldDirty()&&A.length&&(d.push(A),y(A))}})};return o(i),d}),ke(this,"triggerOnFieldsChange",function(i,s){var d=n.callbacks.onFieldsChange;if(d){var f=n.getFields();if(s){var o=new kg;s.forEach(function(b){var C=b.name,P=b.errors;o.set(C,P)}),f.forEach(function(b){b.errors=o.get(b.name)||b.errors})}var y=f.filter(function(b){var C=b.name;return vv(i,C)});y.length&&d(y,f)}}),ke(this,"validateFields",function(i,s){n.warningUnhooked();var d,f;Array.isArray(i)||typeof i=="string"||typeof s=="string"?(d=i,f=s):f=i;var o=!!d,y=o?d.map(Na):[],b=[],C=String(Date.now()),P=new Set,A=f||{},D=A.recursive,k=A.dirty;n.getFieldEntities(!0).forEach(function(V){if(o||y.push(V.getNamePath()),!(!V.props.rules||!V.props.rules.length)&&!(k&&!V.isFieldDirty())){var K=V.getNamePath();if(P.add(K.join(C)),!o||vv(y,K,D)){var Y=V.validateRules(Je({validateMessages:Je(Je({},nH),n.validateMessages)},f));b.push(Y.then(function(){return{name:K,errors:[],warnings:[]}}).catch(function(Z){var te,ne=[],se=[];return(te=Z.forEach)===null||te===void 0||te.call(Z,function(ee){var de=ee.rule.warningOnly,fe=ee.errors;de?se.push.apply(se,zn(fe)):ne.push.apply(ne,zn(fe))}),ne.length?Promise.reject({name:K,errors:ne,warnings:se}):{name:K,errors:ne,warnings:se}}))}}});var B=vie(b);n.lastValidatePromise=B,B.catch(function(V){return V}).then(function(V){var K=V.map(function(Y){var Z=Y.name;return Z});n.notifyObservers(n.store,K,{type:"validateFinish"}),n.triggerOnFieldsChange(K,V)});var N=B.then(function(){return n.lastValidatePromise===B?Promise.resolve(n.getFieldsValue(y)):Promise.reject([])}).catch(function(V){var K=V.filter(function(Y){return Y&&Y.errors.length});return Promise.reject({values:n.getFieldsValue(y),errorFields:K,outOfDate:n.lastValidatePromise!==B})});N.catch(function(V){return V});var j=y.filter(function(V){return P.has(V.join(C))});return n.triggerOnFieldsChange(j),N}),ke(this,"submit",function(){n.warningUnhooked(),n.validateFields().then(function(i){var s=n.callbacks.onFinish;if(s)try{s(i)}catch(d){console.error(d)}}).catch(function(i){var s=n.callbacks.onFinishFailed;s&&s(i)})}),this.forceRootUpdate=t});function aH(e){var t=I.useRef(),n=I.useState({}),i=It(n,2),s=i[1];if(!t.current)if(e)t.current=e;else{var d=function(){s({})},f=new yie(d);t.current=f.getForm()}return[t.current]}var _R=I.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),xie=function(t){var n=t.validateMessages,i=t.onFormChange,s=t.onFormFinish,d=t.children,f=I.useContext(_R),o=I.useRef({});return I.createElement(_R.Provider,{value:Je(Je({},f),{},{validateMessages:Je(Je({},f.validateMessages),n),triggerFormChange:function(b,C){i&&i(b,{changedFields:C,forms:o.current}),f.triggerFormChange(b,C)},triggerFormFinish:function(b,C){s&&s(b,{values:C,forms:o.current}),f.triggerFormFinish(b,C)},registerForm:function(b,C){b&&(o.current=Je(Je({},o.current),{},ke({},b,C))),f.registerForm(b,C)},unregisterForm:function(b){var C=Je({},o.current);delete C[b],o.current=C,f.unregisterForm(b)}})},d)},bie=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],wie=function(t,n){var i=t.name,s=t.initialValues,d=t.fields,f=t.form,o=t.preserve,y=t.children,b=t.component,C=b===void 0?"form":b,P=t.validateMessages,A=t.validateTrigger,D=A===void 0?"onChange":A,k=t.onValuesChange,B=t.onFieldsChange,N=t.onFinish,j=t.onFinishFailed,V=t.clearOnDestroy,K=ri(t,bie),Y=I.useRef(null),Z=I.useContext(_R),te=aH(f),ne=It(te,1),se=ne[0],ee=se.getInternalHooks(Lp),de=ee.useSubscribe,fe=ee.setInitialValues,ye=ee.setCallbacks,ge=ee.setValidateMessages,we=ee.setPreserve,Se=ee.destroyForm;I.useImperativeHandle(n,function(){return Je(Je({},se),{},{nativeElement:Y.current})}),I.useEffect(function(){return Z.registerForm(i,se),function(){Z.unregisterForm(i)}},[Z,se,i]),ge(Je(Je({},Z.validateMessages),P)),ye({onValuesChange:k,onFieldsChange:function(at){if(Z.triggerFormChange(i,at),B){for(var Ke=arguments.length,tt=new Array(Ke>1?Ke-1:0),vt=1;vt<Ke;vt++)tt[vt-1]=arguments[vt];B.apply(void 0,[at].concat(tt))}},onFinish:function(at){Z.triggerFormFinish(i,at),N&&N(at)},onFinishFailed:j}),we(o);var xe=I.useRef(null);fe(s,!xe.current),xe.current||(xe.current=!0),I.useEffect(function(){return function(){return Se(V)}},[]);var Te,ze=typeof y=="function";if(ze){var Ue=se.getFieldsValue(!0);Te=y(Ue,se)}else Te=y;de(!ze);var We=I.useRef();I.useEffect(function(){fie(We.current||[],d||[])||se.setFields(d||[]),We.current=d},[d,se]);var Be=I.useMemo(function(){return Je(Je({},se),{},{validateTrigger:D})},[se,D]),Xe=I.createElement(lC.Provider,{value:null},I.createElement(Lv.Provider,{value:Be},Te));return C===!1?Xe:I.createElement(C,kn({},K,{ref:Y,onSubmit:function(at){at.preventDefault(),at.stopPropagation(),se.submit()},onReset:function(at){var Ke;at.preventDefault(),se.resetFields(),(Ke=K.onReset)===null||Ke===void 0||Ke.call(K,at)}}),Xe)};function yB(e){try{return JSON.stringify(e)}catch{return Math.random()}}function Sie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],s=t[1],d=s===void 0?{}:s,f=Are(d)?{form:d}:d,o=f.form,y=I.useState(),b=It(y,2),C=b[0],P=b[1],A=I.useMemo(function(){return yB(C)},[C]),D=I.useRef(A);D.current=A;var k=I.useContext(Lv),B=o||k,N=B&&B._init,j=Na(i),V=I.useRef(j);return V.current=j,I.useEffect(function(){if(N){var K=B.getFieldsValue,Y=B.getInternalHooks,Z=Y(Lp),te=Z.registerWatch,ne=function(fe,ye){var ge=f.preserve?ye:fe;return typeof i=="function"?i(ge):Ul(ge,V.current)},se=te(function(de,fe){var ye=ne(de,fe),ge=yB(ye);D.current!==ge&&(D.current=ge,P(ye))}),ee=ne(K(),K(!0));return C!==ee&&P(ee),se}},[N]),C}var Cie=I.forwardRef(wie),ob=Cie;ob.FormProvider=xie;ob.Field=iH;ob.List=gie;ob.useForm=aH;ob.useWatch=Sie;const Xp=I.createContext({}),Eie=({children:e,status:t,override:n})=>{const i=I.useContext(Xp),s=I.useMemo(()=>{const d=Object.assign({},i);return n&&delete d.isFormItemInput,t&&(delete d.status,delete d.hasFeedback,delete d.feedbackIcon),d},[t,n,i]);return I.createElement(Xp.Provider,{value:s},e)},Tie=I.createContext(void 0),Ox=e=>{const{space:t,form:n,children:i}=e;if(i==null)return null;let s=i;return n&&(s=Wt.createElement(Eie,{override:!0,status:!0},s)),t&&(s=Wt.createElement(ine,null,s)),s};function cC(...e){const t={};return e.forEach(n=>{n&&Object.keys(n).forEach(i=>{n[i]!==void 0&&(t[i]=n[i])})}),t}function xB(e){if(!e)return;const{closable:t,closeIcon:n}=e;return{closable:t,closeIcon:n}}function bB(e){const{closable:t,closeIcon:n}=e||{};return Wt.useMemo(()=>{if(!t&&(t===!1||n===!1||n===null))return!1;if(t===void 0&&n===void 0)return null;let i={closeIcon:typeof n!="boolean"&&n!==null?n:void 0};return t&&typeof t=="object"&&(i=Object.assign(Object.assign({},i),t)),i},[t,n])}const Iie={};function Pie(e,t,n=Iie){const i=bB(e),s=bB(t),[d]=tb("global",uf.global),f=typeof i!="boolean"?!!(i!=null&&i.disabled):!1,o=Wt.useMemo(()=>Object.assign({closeIcon:Wt.createElement(SO,null)},n),[n]),y=Wt.useMemo(()=>i===!1?!1:i?cC(o,s,i):s===!1?!1:s?cC(o,s):o.closable?o:!1,[i,s,o]);return Wt.useMemo(()=>{var b,C;if(y===!1)return[!1,null,f,{}];const{closeIconRender:P}=o,{closeIcon:A}=y;let D=A;const k=Jc(y,!0);return D!=null&&(P&&(D=P(A)),D=Wt.isValidElement(D)?Wt.cloneElement(D,Object.assign(Object.assign(Object.assign({},D.props),{"aria-label":(C=(b=D.props)===null||b===void 0?void 0:b["aria-label"])!==null&&C!==void 0?C:d.close}),k)):Wt.createElement("span",Object.assign({"aria-label":d.close},k),D)),[!0,D,f,k]},[f,d.close,y,o])}var sH=function(t){if(Bs()&&window.document.documentElement){var n=Array.isArray(t)?t:[t],i=window.document.documentElement;return n.some(function(s){return s in i.style})}return!1},Mie=function(t,n){if(!sH(t))return!1;var i=document.createElement("div"),s=i.style[t];return i.style[t]=n,i.style[t]!==s};function Rie(e,t){return!Array.isArray(e)&&t!==void 0?Mie(e,t):sH(e)}const bE=e=>{const{prefixCls:t,className:n,style:i,size:s,shape:d}=e,f=St({[`${t}-lg`]:s==="large",[`${t}-sm`]:s==="small"}),o=St({[`${t}-circle`]:d==="circle",[`${t}-square`]:d==="square",[`${t}-round`]:d==="round"}),y=I.useMemo(()=>typeof s=="number"?{width:s,height:s,lineHeight:`${s}px`}:{},[s]);return I.createElement("span",{className:St(t,f,o,n),style:Object.assign(Object.assign({},y),i)})},Aie=new Mo("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),wE=e=>({height:e,lineHeight:dt(e)}),_v=e=>Object.assign({width:e},wE(e)),Oie=e=>({background:e.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:Aie,animationDuration:e.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),ZI=(e,t)=>Object.assign({width:t(e).mul(5).equal(),minWidth:t(e).mul(5).equal()},wE(e)),Die=e=>{const{skeletonAvatarCls:t,gradientFromColor:n,controlHeight:i,controlHeightLG:s,controlHeightSM:d}=e;return{[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:n},_v(i)),[`${t}${t}-circle`]:{borderRadius:"50%"},[`${t}${t}-lg`]:Object.assign({},_v(s)),[`${t}${t}-sm`]:Object.assign({},_v(d))}},Lie=e=>{const{controlHeight:t,borderRadiusSM:n,skeletonInputCls:i,controlHeightLG:s,controlHeightSM:d,gradientFromColor:f,calc:o}=e;return{[i]:Object.assign({display:"inline-block",verticalAlign:"top",background:f,borderRadius:n},ZI(t,o)),[`${i}-lg`]:Object.assign({},ZI(s,o)),[`${i}-sm`]:Object.assign({},ZI(d,o))}},wB=e=>Object.assign({width:e},wE(e)),zie=e=>{const{skeletonImageCls:t,imageSizeBase:n,gradientFromColor:i,borderRadiusSM:s,calc:d}=e;return{[t]:Object.assign(Object.assign({display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle",background:i,borderRadius:s},wB(d(n).mul(2).equal())),{[`${t}-path`]:{fill:"#bfbfbf"},[`${t}-svg`]:Object.assign(Object.assign({},wB(n)),{maxWidth:d(n).mul(4).equal(),maxHeight:d(n).mul(4).equal()}),[`${t}-svg${t}-svg-circle`]:{borderRadius:"50%"}}),[`${t}${t}-circle`]:{borderRadius:"50%"}}},YI=(e,t,n)=>{const{skeletonButtonCls:i}=e;return{[`${n}${i}-circle`]:{width:t,minWidth:t,borderRadius:"50%"},[`${n}${i}-round`]:{borderRadius:t}}},JI=(e,t)=>Object.assign({width:t(e).mul(2).equal(),minWidth:t(e).mul(2).equal()},wE(e)),kie=e=>{const{borderRadiusSM:t,skeletonButtonCls:n,controlHeight:i,controlHeightLG:s,controlHeightSM:d,gradientFromColor:f,calc:o}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:f,borderRadius:t,width:o(i).mul(2).equal(),minWidth:o(i).mul(2).equal()},JI(i,o))},YI(e,i,n)),{[`${n}-lg`]:Object.assign({},JI(s,o))}),YI(e,s,`${n}-lg`)),{[`${n}-sm`]:Object.assign({},JI(d,o))}),YI(e,d,`${n}-sm`))},Fie=e=>{const{componentCls:t,skeletonAvatarCls:n,skeletonTitleCls:i,skeletonParagraphCls:s,skeletonButtonCls:d,skeletonInputCls:f,skeletonImageCls:o,controlHeight:y,controlHeightLG:b,controlHeightSM:C,gradientFromColor:P,padding:A,marginSM:D,borderRadius:k,titleHeight:B,blockRadius:N,paragraphLiHeight:j,controlHeightXS:V,paragraphMarginTop:K}=e;return{[t]:{display:"table",width:"100%",[`${t}-header`]:{display:"table-cell",paddingInlineEnd:A,verticalAlign:"top",[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:P},_v(y)),[`${n}-circle`]:{borderRadius:"50%"},[`${n}-lg`]:Object.assign({},_v(b)),[`${n}-sm`]:Object.assign({},_v(C))},[`${t}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[i]:{width:"100%",height:B,background:P,borderRadius:N,[`+ ${s}`]:{marginBlockStart:C}},[s]:{padding:0,"> li":{width:"100%",height:j,listStyle:"none",background:P,borderRadius:N,"+ li":{marginBlockStart:V}}},[`${s}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${t}-content`]:{[`${i}, ${s} > li`]:{borderRadius:k}}},[`${t}-with-avatar ${t}-content`]:{[i]:{marginBlockStart:D,[`+ ${s}`]:{marginBlockStart:K}}},[`${t}${t}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},kie(e)),Die(e)),Lie(e)),zie(e)),[`${t}${t}-block`]:{width:"100%",[d]:{width:"100%"},[f]:{width:"100%"}},[`${t}${t}-active`]:{[`
        ${i},
        ${s} > li,
        ${n},
        ${d},
        ${f},
        ${o}
      `]:Object.assign({},Oie(e))}}},Nie=e=>{const{colorFillContent:t,colorFill:n}=e,i=t,s=n;return{color:i,colorGradientEnd:s,gradientFromColor:i,gradientToColor:s,titleHeight:e.controlHeight/2,blockRadius:e.borderRadiusSM,paragraphMarginTop:e.marginLG+e.marginXXS,paragraphLiHeight:e.controlHeight/2}},Xv=za("Skeleton",e=>{const{componentCls:t,calc:n}=e,i=xo(e,{skeletonAvatarCls:`${t}-avatar`,skeletonTitleCls:`${t}-title`,skeletonParagraphCls:`${t}-paragraph`,skeletonButtonCls:`${t}-button`,skeletonInputCls:`${t}-input`,skeletonImageCls:`${t}-image`,imageSizeBase:n(e.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${e.gradientFromColor} 25%, ${e.gradientToColor} 37%, ${e.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return Fie(i)},Nie,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),Bie=e=>{const{prefixCls:t,className:n,rootClassName:i,active:s,shape:d="circle",size:f="default"}=e,{getPrefixCls:o}=I.useContext(ji),y=o("skeleton",t),[b,C,P]=Xv(y),A=as(e,["prefixCls","className"]),D=St(y,`${y}-element`,{[`${y}-active`]:s},n,i,C,P);return b(I.createElement("div",{className:D},I.createElement(bE,Object.assign({prefixCls:`${y}-avatar`,shape:d,size:f},A))))},$ie=e=>{const{prefixCls:t,className:n,rootClassName:i,active:s,block:d=!1,size:f="default"}=e,{getPrefixCls:o}=I.useContext(ji),y=o("skeleton",t),[b,C,P]=Xv(y),A=as(e,["prefixCls"]),D=St(y,`${y}-element`,{[`${y}-active`]:s,[`${y}-block`]:d},n,i,C,P);return b(I.createElement("div",{className:D},I.createElement(bE,Object.assign({prefixCls:`${y}-button`,size:f},A))))},jie="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",Vie=e=>{const{prefixCls:t,className:n,rootClassName:i,style:s,active:d}=e,{getPrefixCls:f}=I.useContext(ji),o=f("skeleton",t),[y,b,C]=Xv(o),P=St(o,`${o}-element`,{[`${o}-active`]:d},n,i,b,C);return y(I.createElement("div",{className:P},I.createElement("div",{className:St(`${o}-image`,n),style:s},I.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${o}-image-svg`},I.createElement("title",null,"Image placeholder"),I.createElement("path",{d:jie,className:`${o}-image-path`})))))},Uie=e=>{const{prefixCls:t,className:n,rootClassName:i,active:s,block:d,size:f="default"}=e,{getPrefixCls:o}=I.useContext(ji),y=o("skeleton",t),[b,C,P]=Xv(y),A=as(e,["prefixCls"]),D=St(y,`${y}-element`,{[`${y}-active`]:s,[`${y}-block`]:d},n,i,C,P);return b(I.createElement("div",{className:D},I.createElement(bE,Object.assign({prefixCls:`${y}-input`,size:f},A))))},Hie=e=>{const{prefixCls:t,className:n,rootClassName:i,style:s,active:d,children:f}=e,{getPrefixCls:o}=I.useContext(ji),y=o("skeleton",t),[b,C,P]=Xv(y),A=St(y,`${y}-element`,{[`${y}-active`]:d},C,n,i,P);return b(I.createElement("div",{className:A},I.createElement("div",{className:St(`${y}-image`,n),style:s},f)))},Gie=(e,t)=>{const{width:n,rows:i=2}=t;if(Array.isArray(n))return n[e];if(i-1===e)return n},Wie=e=>{const{prefixCls:t,className:n,style:i,rows:s=0}=e,d=Array.from({length:s}).map((f,o)=>I.createElement("li",{key:o,style:{width:Gie(o,e)}}));return I.createElement("ul",{className:St(t,n),style:i},d)},qie=({prefixCls:e,className:t,width:n,style:i})=>I.createElement("h3",{className:St(e,t),style:Object.assign({width:n},i)});function QI(e){return e&&typeof e=="object"?e:{}}function Kie(e,t){return e&&!t?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Xie(e,t){return!e&&t?{width:"38%"}:e&&t?{width:"50%"}:{}}function Zie(e,t){const n={};return(!e||!t)&&(n.width="61%"),!e&&t?n.rows=3:n.rows=2,n}const Zv=e=>{const{prefixCls:t,loading:n,className:i,rootClassName:s,style:d,children:f,avatar:o=!1,title:y=!0,paragraph:b=!0,active:C,round:P}=e,{getPrefixCls:A,direction:D,className:k,style:B}=Gu("skeleton"),N=A("skeleton",t),[j,V,K]=Xv(N);if(n||!("loading"in e)){const Y=!!o,Z=!!y,te=!!b;let ne;if(Y){const de=Object.assign(Object.assign({prefixCls:`${N}-avatar`},Kie(Z,te)),QI(o));ne=I.createElement("div",{className:`${N}-header`},I.createElement(bE,Object.assign({},de)))}let se;if(Z||te){let de;if(Z){const ye=Object.assign(Object.assign({prefixCls:`${N}-title`},Xie(Y,te)),QI(y));de=I.createElement(qie,Object.assign({},ye))}let fe;if(te){const ye=Object.assign(Object.assign({prefixCls:`${N}-paragraph`},Zie(Y,Z)),QI(b));fe=I.createElement(Wie,Object.assign({},ye))}se=I.createElement("div",{className:`${N}-content`},de,fe)}const ee=St(N,{[`${N}-with-avatar`]:Y,[`${N}-active`]:C,[`${N}-rtl`]:D==="rtl",[`${N}-round`]:P},k,i,s,V,K);return j(I.createElement("div",{className:ee,style:Object.assign(Object.assign({},B),d)},ne,se))}return f??null};Zv.Button=$ie;Zv.Avatar=Bie;Zv.Input=Uie;Zv.Image=Vie;Zv.Node=Hie;const Yie=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},Jie=e=>{const{componentCls:t}=e;return{[t]:{position:"relative",maxWidth:"100%",minHeight:1}}},Qie=(e,t)=>{const{prefixCls:n,componentCls:i,gridColumns:s}=e,d={};for(let f=s;f>=0;f--)f===0?(d[`${i}${t}-${f}`]={display:"none"},d[`${i}-push-${f}`]={insetInlineStart:"auto"},d[`${i}-pull-${f}`]={insetInlineEnd:"auto"},d[`${i}${t}-push-${f}`]={insetInlineStart:"auto"},d[`${i}${t}-pull-${f}`]={insetInlineEnd:"auto"},d[`${i}${t}-offset-${f}`]={marginInlineStart:0},d[`${i}${t}-order-${f}`]={order:0}):(d[`${i}${t}-${f}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${f/s*100}%`,maxWidth:`${f/s*100}%`}],d[`${i}${t}-push-${f}`]={insetInlineStart:`${f/s*100}%`},d[`${i}${t}-pull-${f}`]={insetInlineEnd:`${f/s*100}%`},d[`${i}${t}-offset-${f}`]={marginInlineStart:`${f/s*100}%`},d[`${i}${t}-order-${f}`]={order:f});return d[`${i}${t}-flex`]={flex:`var(--${n}${t}-flex)`},d},yR=(e,t)=>Qie(e,t),eoe=(e,t,n)=>({[`@media (min-width: ${dt(t)})`]:Object.assign({},yR(e,n))}),toe=()=>({}),noe=()=>({}),roe=za("Grid",Yie,toe),ioe=e=>({xs:e.screenXSMin,sm:e.screenSMMin,md:e.screenMDMin,lg:e.screenLGMin,xl:e.screenXLMin,xxl:e.screenXXLMin}),ooe=za("Grid",e=>{const t=xo(e,{gridColumns:24}),n=ioe(t);return delete n.xs,[Jie(t),yR(t,""),yR(t,"-xs"),Object.keys(n).map(i=>eoe(t,n[i],`-${i}`)).reduce((i,s)=>Object.assign(Object.assign({},i),s),{})]},noe);function aoe(e){return t=>I.createElement(im,{theme:{token:{motion:!1,zIndexPopupBase:0}}},I.createElement(e,Object.assign({},t)))}const lH=(e,t,n,i,s)=>aoe(f=>{const{prefixCls:o,style:y}=f,b=I.useRef(null),[C,P]=I.useState(0),[A,D]=I.useState(0),[k,B]=is(!1,{value:f.open}),{getPrefixCls:N}=I.useContext(ji),j=N(i||"select",o);I.useEffect(()=>{if(B(!0),typeof ResizeObserver<"u"){const Y=new ResizeObserver(te=>{const ne=te[0].target;P(ne.offsetHeight+8),D(ne.offsetWidth)}),Z=setInterval(()=>{var te;const ne=s?`.${s(j)}`:`.${j}-dropdown`,se=(te=b.current)===null||te===void 0?void 0:te.querySelector(ne);se&&(clearInterval(Z),Y.observe(se))},10);return()=>{clearInterval(Z),Y.disconnect()}}},[]);let V=Object.assign(Object.assign({},f),{style:Object.assign(Object.assign({},y),{margin:0}),open:k,visible:k,getPopupContainer:()=>b.current});t&&Object.assign(V,{[t]:{overflow:{adjustX:!1,adjustY:!1}}});const K={paddingBottom:C,position:"relative",minWidth:A};return I.createElement("div",{ref:b,style:K},I.createElement(e,Object.assign({},V)))}),NO=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};var SE=function(t){var n=t.className,i=t.customizeIcon,s=t.customizeIconProps,d=t.children,f=t.onMouseDown,o=t.onClick,y=typeof i=="function"?i(s):i;return I.createElement("span",{className:n,onMouseDown:function(C){C.preventDefault(),f==null||f(C)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:o,"aria-hidden":!0},y!==void 0?y:I.createElement("span",{className:St(n.split(/\s+/).map(function(b){return"".concat(b,"-icon")}))},d))},soe=function(t,n,i,s,d){var f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=arguments.length>6?arguments[6]:void 0,y=arguments.length>7?arguments[7]:void 0,b=Wt.useMemo(function(){if(Nr(s)==="object")return s.clearIcon;if(d)return d},[s,d]),C=Wt.useMemo(function(){return!!(!f&&s&&(i.length||o)&&!(y==="combobox"&&o===""))},[s,f,i.length,o,y]);return{allowClear:C,clearIcon:Wt.createElement(SE,{className:"".concat(t,"-clear"),onMouseDown:n,customizeIcon:b},"")}},cH=I.createContext(null);function loe(){return I.useContext(cH)}function coe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,t=I.useState(!1),n=It(t,2),i=n[0],s=n[1],d=I.useRef(null),f=function(){window.clearTimeout(d.current)};I.useEffect(function(){return f},[]);var o=function(b,C){f(),d.current=window.setTimeout(function(){s(b),C&&C()},e)};return[i,o,f]}function uH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,t=I.useRef(null),n=I.useRef(null);I.useEffect(function(){return function(){window.clearTimeout(n.current)}},[]);function i(s){(s||t.current===null)&&(t.current=s),window.clearTimeout(n.current),n.current=window.setTimeout(function(){t.current=null},e)}return[function(){return t.current},i]}function uoe(e,t,n,i){var s=I.useRef(null);s.current={open:t,triggerOpen:n,customizedTrigger:i},I.useEffect(function(){function d(f){var o;if(!((o=s.current)!==null&&o!==void 0&&o.customizedTrigger)){var y=f.target;y.shadowRoot&&f.composed&&(y=f.composedPath()[0]||y),s.current.open&&e().filter(function(b){return b}).every(function(b){return!b.contains(y)&&b!==y})&&s.current.triggerOpen(!1)}}return window.addEventListener("mousedown",d),function(){return window.removeEventListener("mousedown",d)}},[])}function doe(e){return e&&![ir.ESC,ir.SHIFT,ir.BACKSPACE,ir.TAB,ir.WIN_KEY,ir.ALT,ir.META,ir.WIN_KEY_RIGHT,ir.CTRL,ir.SEMICOLON,ir.EQUALS,ir.CAPS_LOCK,ir.CONTEXT_MENU,ir.F1,ir.F2,ir.F3,ir.F4,ir.F5,ir.F6,ir.F7,ir.F8,ir.F9,ir.F10,ir.F11,ir.F12].includes(e)}var hoe=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Fg=void 0;function foe(e,t){var n=e.prefixCls,i=e.invalidate,s=e.item,d=e.renderItem,f=e.responsive,o=e.responsiveDisabled,y=e.registerSize,b=e.itemKey,C=e.className,P=e.style,A=e.children,D=e.display,k=e.order,B=e.component,N=B===void 0?"div":B,j=ri(e,hoe),V=f&&!D;function K(se){y(b,se)}I.useEffect(function(){return function(){K(null)}},[]);var Y=d&&s!==Fg?d(s,{index:k}):A,Z;i||(Z={opacity:V?0:1,height:V?0:Fg,overflowY:V?"hidden":Fg,order:f?k:Fg,pointerEvents:V?"none":Fg,position:V?"absolute":Fg});var te={};V&&(te["aria-hidden"]=!0);var ne=I.createElement(N,kn({className:St(!i&&n,C),style:Je(Je({},Z),P)},te,j,{ref:t}),Y);return f&&(ne=I.createElement(Wl,{onResize:function(ee){var de=ee.offsetWidth;K(de)},disabled:o},ne)),ne}var cv=I.forwardRef(foe);cv.displayName="Item";function poe(e){if(typeof MessageChannel>"u")Qi(e);else{var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(void 0)}}function moe(){var e=I.useRef(null),t=function(i){e.current||(e.current=[],poe(function(){ku.unstable_batchedUpdates(function(){e.current.forEach(function(s){s()}),e.current=null})})),e.current.push(i)};return t}function Ng(e,t){var n=I.useState(t),i=It(n,2),s=i[0],d=i[1],f=Io(function(o){e(function(){d(o)})});return[s,f]}var uC=Wt.createContext(null),goe=["component"],voe=["className"],_oe=["className"],yoe=function(t,n){var i=I.useContext(uC);if(!i){var s=t.component,d=s===void 0?"div":s,f=ri(t,goe);return I.createElement(d,kn({},f,{ref:n}))}var o=i.className,y=ri(i,voe),b=t.className,C=ri(t,_oe);return I.createElement(uC.Provider,{value:null},I.createElement(cv,kn({ref:n,className:St(o,b)},y,C)))},dH=I.forwardRef(yoe);dH.displayName="RawItem";var xoe=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","prefix","suffix","component","itemComponent","onVisibleChange"],hH="responsive",fH="invalidate";function boe(e){return"+ ".concat(e.length," ...")}function woe(e,t){var n=e.prefixCls,i=n===void 0?"rc-overflow":n,s=e.data,d=s===void 0?[]:s,f=e.renderItem,o=e.renderRawItem,y=e.itemKey,b=e.itemWidth,C=b===void 0?10:b,P=e.ssr,A=e.style,D=e.className,k=e.maxCount,B=e.renderRest,N=e.renderRawRest,j=e.prefix,V=e.suffix,K=e.component,Y=K===void 0?"div":K,Z=e.itemComponent,te=e.onVisibleChange,ne=ri(e,xoe),se=P==="full",ee=moe(),de=Ng(ee,null),fe=It(de,2),ye=fe[0],ge=fe[1],we=ye||0,Se=Ng(ee,new Map),xe=It(Se,2),Te=xe[0],ze=xe[1],Ue=Ng(ee,0),We=It(Ue,2),Be=We[0],Xe=We[1],qe=Ng(ee,0),at=It(qe,2),Ke=at[0],tt=at[1],vt=Ng(ee,0),Pt=It(vt,2),ft=Pt[0],Nt=Pt[1],Rt=Ng(ee,0),pt=It(Rt,2),yt=pt[0],xt=pt[1],bt=I.useState(null),Ct=It(bt,2),tn=Ct[0],Zt=Ct[1],In=I.useState(null),Cn=It(In,2),Mt=Cn[0],hn=Cn[1],Jt=I.useMemo(function(){return Mt===null&&se?Number.MAX_SAFE_INTEGER:Mt||0},[Mt,ye]),Ut=I.useState(!1),Tn=It(Ut,2),On=Tn[0],Kn=Tn[1],Un="".concat(i,"-item"),Pn=Math.max(Be,Ke),Qn=k===hH,un=d.length&&Qn,nn=k===fH,$n=un||typeof k=="number"&&d.length>k,Ln=I.useMemo(function(){var Gt=d;return un?ye===null&&se?Gt=d:Gt=d.slice(0,Math.min(d.length,we/C)):typeof k=="number"&&(Gt=d.slice(0,k)),Gt},[d,C,ye,k,un]),qn=I.useMemo(function(){return un?d.slice(Jt+1):d.slice(Ln.length)},[d,Ln,un,Jt]),er=I.useCallback(function(Gt,mn){var Xn;return typeof y=="function"?y(Gt):(Xn=y&&(Gt==null?void 0:Gt[y]))!==null&&Xn!==void 0?Xn:mn},[y]),tr=I.useCallback(f||function(Gt){return Gt},[f]);function Jn(Gt,mn,Xn){Mt===Gt&&(mn===void 0||mn===tn)||(hn(Gt),Xn||(Kn(Gt<d.length-1),te==null||te(Gt)),mn!==void 0&&Zt(mn))}function Ir(Gt,mn){ge(mn.clientWidth)}function _r(Gt,mn){ze(function(Xn){var gr=new Map(Xn);return mn===null?gr.delete(Gt):gr.set(Gt,mn),gr})}function $r(Gt,mn){tt(mn),Xe(Ke)}function mr(Gt,mn){Nt(mn)}function yi(Gt,mn){xt(mn)}function Vr(Gt){return Te.get(er(Ln[Gt],Gt))}yo(function(){if(we&&typeof Pn=="number"&&Ln){var Gt=ft+yt,mn=Ln.length,Xn=mn-1;if(!mn){Jn(0,null);return}for(var gr=0;gr<mn;gr+=1){var je=Vr(gr);if(se&&(je=je||0),je===void 0){Jn(gr-1,void 0,!0);break}if(Gt+=je,Xn===0&&Gt<=we||gr===Xn-1&&Gt+Vr(Xn)<=we){Jn(Xn,null);break}else if(Gt+Pn>we){Jn(gr-1,Gt-je-yt+Ke);break}}V&&Vr(0)+yt>we&&Zt(null)}},[we,Te,Ke,ft,yt,er,Ln]);var Kr=On&&!!qn.length,Rr={};tn!==null&&un&&(Rr={position:"absolute",left:tn,top:0});var ii={prefixCls:Un,responsive:un,component:Z,invalidate:nn},Hr=o?function(Gt,mn){var Xn=er(Gt,mn);return I.createElement(uC.Provider,{key:Xn,value:Je(Je({},ii),{},{order:mn,item:Gt,itemKey:Xn,registerSize:_r,display:mn<=Jt})},o(Gt,mn))}:function(Gt,mn){var Xn=er(Gt,mn);return I.createElement(cv,kn({},ii,{order:mn,key:Xn,item:Gt,renderItem:tr,itemKey:Xn,registerSize:_r,display:mn<=Jt}))},ut={order:Kr?Jt:Number.MAX_SAFE_INTEGER,className:"".concat(Un,"-rest"),registerSize:$r,display:Kr},ur=B||boe,fr=N?I.createElement(uC.Provider,{value:Je(Je({},ii),ut)},N(qn)):I.createElement(cv,kn({},ii,ut),typeof ur=="function"?ur(qn):ur),Fn=I.createElement(Y,kn({className:St(!nn&&i,D),style:A,ref:t},ne),j&&I.createElement(cv,kn({},ii,{responsive:Qn,responsiveDisabled:!un,order:-1,className:"".concat(Un,"-prefix"),registerSize:mr,display:!0}),j),Ln.map(Hr),$n?fr:null,V&&I.createElement(cv,kn({},ii,{responsive:Qn,responsiveDisabled:!un,order:Jt,className:"".concat(Un,"-suffix"),registerSize:yi,display:!0,style:Rr}),V));return Qn?I.createElement(Wl,{onResize:Ir,disabled:!un},Fn):Fn}var Lu=I.forwardRef(woe);Lu.displayName="Overflow";Lu.Item=dH;Lu.RESPONSIVE=hH;Lu.INVALIDATE=fH;function Soe(e,t,n){var i=Je(Je({},e),t);return Object.keys(t).forEach(function(s){var d=t[s];typeof d=="function"&&(i[s]=function(){for(var f,o=arguments.length,y=new Array(o),b=0;b<o;b++)y[b]=arguments[b];return d.apply(void 0,y),(f=e[s])===null||f===void 0?void 0:f.call.apply(f,[e].concat(y))})}),i}var Coe=["prefixCls","id","inputElement","autoFocus","autoComplete","editable","activeDescendantId","value","open","attrs"],Eoe=function(t,n){var i=t.prefixCls,s=t.id,d=t.inputElement,f=t.autoFocus,o=t.autoComplete,y=t.editable,b=t.activeDescendantId,C=t.value,P=t.open,A=t.attrs,D=ri(t,Coe),k=d||I.createElement("input",null),B=k,N=B.ref,j=B.props;return"maxLength"in k.props,k=I.cloneElement(k,Je(Je(Je({type:"search"},Soe(D,j)),{},{id:s,ref:ru(n,N),autoComplete:o||"off",autoFocus:f,className:St("".concat(i,"-selection-search-input"),j==null?void 0:j.className),role:"combobox","aria-expanded":P||!1,"aria-haspopup":"listbox","aria-owns":"".concat(s,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(s,"_list"),"aria-activedescendant":P?b:void 0},A),{},{value:y?C:"",readOnly:!y,unselectable:y?null:"on",style:Je(Je({},j.style),{},{opacity:y?null:0})})),k},pH=I.forwardRef(Eoe);function mH(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}var Toe=typeof window<"u"&&window.document&&window.document.documentElement,Ioe=Toe;function Poe(e){return e!=null}function Moe(e){return!e&&e!==0}function SB(e){return["string","number"].includes(Nr(e))}function gH(e){var t=void 0;return e&&(SB(e.title)?t=e.title.toString():SB(e.label)&&(t=e.label.toString())),t}function Roe(e,t){Ioe?I.useLayoutEffect(e,t):I.useEffect(e,t)}function Aoe(e){var t;return(t=e.key)!==null&&t!==void 0?t:e.value}var CB=function(t){t.preventDefault(),t.stopPropagation()},Ooe=function(t){var n=t.id,i=t.prefixCls,s=t.values,d=t.open,f=t.searchValue,o=t.autoClearSearchValue,y=t.inputRef,b=t.placeholder,C=t.disabled,P=t.mode,A=t.showSearch,D=t.autoFocus,k=t.autoComplete,B=t.activeDescendantId,N=t.tabIndex,j=t.removeIcon,V=t.maxTagCount,K=t.maxTagTextLength,Y=t.maxTagPlaceholder,Z=Y===void 0?function(xt){return"+ ".concat(xt.length," ...")}:Y,te=t.tagRender,ne=t.onToggleOpen,se=t.onRemove,ee=t.onInputChange,de=t.onInputPaste,fe=t.onInputKeyDown,ye=t.onInputMouseDown,ge=t.onInputCompositionStart,we=t.onInputCompositionEnd,Se=t.onInputBlur,xe=I.useRef(null),Te=I.useState(0),ze=It(Te,2),Ue=ze[0],We=ze[1],Be=I.useState(!1),Xe=It(Be,2),qe=Xe[0],at=Xe[1],Ke="".concat(i,"-selection"),tt=d||P==="multiple"&&o===!1||P==="tags"?f:"",vt=P==="tags"||P==="multiple"&&o===!1||A&&(d||qe);Roe(function(){We(xe.current.scrollWidth)},[tt]);var Pt=function(bt,Ct,tn,Zt,In){return I.createElement("span",{title:gH(bt),className:St("".concat(Ke,"-item"),ke({},"".concat(Ke,"-item-disabled"),tn))},I.createElement("span",{className:"".concat(Ke,"-item-content")},Ct),Zt&&I.createElement(SE,{className:"".concat(Ke,"-item-remove"),onMouseDown:CB,onClick:In,customizeIcon:j},""))},ft=function(bt,Ct,tn,Zt,In,Cn){var Mt=function(Jt){CB(Jt),ne(!d)};return I.createElement("span",{onMouseDown:Mt},te({label:Ct,value:bt,disabled:tn,closable:Zt,onClose:In,isMaxTag:!!Cn}))},Nt=function(bt){var Ct=bt.disabled,tn=bt.label,Zt=bt.value,In=!C&&!Ct,Cn=tn;if(typeof K=="number"&&(typeof tn=="string"||typeof tn=="number")){var Mt=String(Cn);Mt.length>K&&(Cn="".concat(Mt.slice(0,K),"..."))}var hn=function(Ut){Ut&&Ut.stopPropagation(),se(bt)};return typeof te=="function"?ft(Zt,Cn,Ct,In,hn):Pt(bt,Cn,Ct,In,hn)},Rt=function(bt){if(!s.length)return null;var Ct=typeof Z=="function"?Z(bt):Z;return typeof te=="function"?ft(void 0,Ct,!1,!1,void 0,!0):Pt({title:Ct},Ct,!1)},pt=I.createElement("div",{className:"".concat(Ke,"-search"),style:{width:Ue},onFocus:function(){at(!0)},onBlur:function(){at(!1)}},I.createElement(pH,{ref:y,open:d,prefixCls:i,id:n,inputElement:null,disabled:C,autoFocus:D,autoComplete:k,editable:vt,activeDescendantId:B,value:tt,onKeyDown:fe,onMouseDown:ye,onChange:ee,onPaste:de,onCompositionStart:ge,onCompositionEnd:we,onBlur:Se,tabIndex:N,attrs:Jc(t,!0)}),I.createElement("span",{ref:xe,className:"".concat(Ke,"-search-mirror"),"aria-hidden":!0},tt,"")),yt=I.createElement(Lu,{prefixCls:"".concat(Ke,"-overflow"),data:s,renderItem:Nt,renderRest:Rt,suffix:pt,itemKey:Aoe,maxCount:V});return I.createElement("span",{className:"".concat(Ke,"-wrap")},yt,!s.length&&!tt&&I.createElement("span",{className:"".concat(Ke,"-placeholder")},b))},Doe=function(t){var n=t.inputElement,i=t.prefixCls,s=t.id,d=t.inputRef,f=t.disabled,o=t.autoFocus,y=t.autoComplete,b=t.activeDescendantId,C=t.mode,P=t.open,A=t.values,D=t.placeholder,k=t.tabIndex,B=t.showSearch,N=t.searchValue,j=t.activeValue,V=t.maxLength,K=t.onInputKeyDown,Y=t.onInputMouseDown,Z=t.onInputChange,te=t.onInputPaste,ne=t.onInputCompositionStart,se=t.onInputCompositionEnd,ee=t.onInputBlur,de=t.title,fe=I.useState(!1),ye=It(fe,2),ge=ye[0],we=ye[1],Se=C==="combobox",xe=Se||B,Te=A[0],ze=N||"";Se&&j&&!ge&&(ze=j),I.useEffect(function(){Se&&we(!1)},[Se,j]);var Ue=C!=="combobox"&&!P&&!B?!1:!!ze,We=de===void 0?gH(Te):de,Be=I.useMemo(function(){return Te?null:I.createElement("span",{className:"".concat(i,"-selection-placeholder"),style:Ue?{visibility:"hidden"}:void 0},D)},[Te,Ue,D,i]);return I.createElement("span",{className:"".concat(i,"-selection-wrap")},I.createElement("span",{className:"".concat(i,"-selection-search")},I.createElement(pH,{ref:d,prefixCls:i,id:s,open:P,inputElement:n,disabled:f,autoFocus:o,autoComplete:y,editable:xe,activeDescendantId:b,value:ze,onKeyDown:K,onMouseDown:Y,onChange:function(qe){we(!0),Z(qe)},onPaste:te,onCompositionStart:ne,onCompositionEnd:se,onBlur:ee,tabIndex:k,attrs:Jc(t,!0),maxLength:Se?V:void 0})),!Se&&Te?I.createElement("span",{className:"".concat(i,"-selection-item"),title:We,style:Ue?{visibility:"hidden"}:void 0},Te.label):null,Be)},Loe=function(t,n){var i=I.useRef(null),s=I.useRef(!1),d=t.prefixCls,f=t.open,o=t.mode,y=t.showSearch,b=t.tokenWithEnter,C=t.disabled,P=t.prefix,A=t.autoClearSearchValue,D=t.onSearch,k=t.onSearchSubmit,B=t.onToggleOpen,N=t.onInputKeyDown,j=t.onInputBlur,V=t.domRef;I.useImperativeHandle(n,function(){return{focus:function(We){i.current.focus(We)},blur:function(){i.current.blur()}}});var K=uH(0),Y=It(K,2),Z=Y[0],te=Y[1],ne=function(We){var Be=We.which,Xe=i.current instanceof HTMLTextAreaElement;!Xe&&f&&(Be===ir.UP||Be===ir.DOWN)&&We.preventDefault(),N&&N(We),Be===ir.ENTER&&o==="tags"&&!s.current&&!f&&(k==null||k(We.target.value)),!(Xe&&!f&&~[ir.UP,ir.DOWN,ir.LEFT,ir.RIGHT].indexOf(Be))&&doe(Be)&&B(!0)},se=function(){te(!0)},ee=I.useRef(null),de=function(We){D(We,!0,s.current)!==!1&&B(!0)},fe=function(){s.current=!0},ye=function(We){s.current=!1,o!=="combobox"&&de(We.target.value)},ge=function(We){var Be=We.target.value;if(b&&ee.current&&/[\r\n]/.test(ee.current)){var Xe=ee.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");Be=Be.replace(Xe,ee.current)}ee.current=null,de(Be)},we=function(We){var Be=We.clipboardData,Xe=Be==null?void 0:Be.getData("text");ee.current=Xe||""},Se=function(We){var Be=We.target;if(Be!==i.current){var Xe=document.body.style.msTouchAction!==void 0;Xe?setTimeout(function(){i.current.focus()}):i.current.focus()}},xe=function(We){var Be=Z();We.target!==i.current&&!Be&&!(o==="combobox"&&C)&&We.preventDefault(),(o!=="combobox"&&(!y||!Be)||!f)&&(f&&A!==!1&&D("",!0,!1),B())},Te={inputRef:i,onInputKeyDown:ne,onInputMouseDown:se,onInputChange:ge,onInputPaste:we,onInputCompositionStart:fe,onInputCompositionEnd:ye,onInputBlur:j},ze=o==="multiple"||o==="tags"?I.createElement(Ooe,kn({},t,Te)):I.createElement(Doe,kn({},t,Te));return I.createElement("div",{ref:V,className:"".concat(d,"-selector"),onClick:Se,onMouseDown:xe},P&&I.createElement("div",{className:"".concat(d,"-prefix")},P),ze)},zoe=I.forwardRef(Loe);function koe(e){var t=e.prefixCls,n=e.align,i=e.arrow,s=e.arrowPos,d=i||{},f=d.className,o=d.content,y=s.x,b=y===void 0?0:y,C=s.y,P=C===void 0?0:C,A=I.useRef();if(!n||!n.points)return null;var D={position:"absolute"};if(n.autoArrow!==!1){var k=n.points[0],B=n.points[1],N=k[0],j=k[1],V=B[0],K=B[1];N===V||!["t","b"].includes(N)?D.top=P:N==="t"?D.top=0:D.bottom=0,j===K||!["l","r"].includes(j)?D.left=b:j==="l"?D.left=0:D.right=0}return I.createElement("div",{ref:A,className:St("".concat(t,"-arrow"),f),style:D},o)}function Foe(e){var t=e.prefixCls,n=e.open,i=e.zIndex,s=e.mask,d=e.motion;return s?I.createElement(wf,kn({},d,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(f){var o=f.className;return I.createElement("div",{style:{zIndex:i},className:St("".concat(t,"-mask"),o)})}):null}var Noe=I.memo(function(e){var t=e.children;return t},function(e,t){return t.cache}),Boe=I.forwardRef(function(e,t){var n=e.popup,i=e.className,s=e.prefixCls,d=e.style,f=e.target,o=e.onVisibleChanged,y=e.open,b=e.keepDom,C=e.fresh,P=e.onClick,A=e.mask,D=e.arrow,k=e.arrowPos,B=e.align,N=e.motion,j=e.maskMotion,V=e.forceRender,K=e.getPopupContainer,Y=e.autoDestroy,Z=e.portal,te=e.zIndex,ne=e.onMouseEnter,se=e.onMouseLeave,ee=e.onPointerEnter,de=e.onPointerDownCapture,fe=e.ready,ye=e.offsetX,ge=e.offsetY,we=e.offsetR,Se=e.offsetB,xe=e.onAlign,Te=e.onPrepare,ze=e.stretch,Ue=e.targetWidth,We=e.targetHeight,Be=typeof n=="function"?n():n,Xe=y||b,qe=(K==null?void 0:K.length)>0,at=I.useState(!K||!qe),Ke=It(at,2),tt=Ke[0],vt=Ke[1];if(yo(function(){!tt&&qe&&f&&vt(!0)},[tt,qe,f]),!tt)return null;var Pt="auto",ft={left:"-1000vw",top:"-1000vh",right:Pt,bottom:Pt};if(fe||!y){var Nt,Rt=B.points,pt=B.dynamicInset||((Nt=B._experimental)===null||Nt===void 0?void 0:Nt.dynamicInset),yt=pt&&Rt[0][1]==="r",xt=pt&&Rt[0][0]==="b";yt?(ft.right=we,ft.left=Pt):(ft.left=ye,ft.right=Pt),xt?(ft.bottom=Se,ft.top=Pt):(ft.top=ge,ft.bottom=Pt)}var bt={};return ze&&(ze.includes("height")&&We?bt.height=We:ze.includes("minHeight")&&We&&(bt.minHeight=We),ze.includes("width")&&Ue?bt.width=Ue:ze.includes("minWidth")&&Ue&&(bt.minWidth=Ue)),y||(bt.pointerEvents="none"),I.createElement(Z,{open:V||Xe,getContainer:K&&function(){return K(f)},autoDestroy:Y},I.createElement(Foe,{prefixCls:s,open:y,zIndex:te,mask:A,motion:j}),I.createElement(Wl,{onResize:xe,disabled:!y},function(Ct){return I.createElement(wf,kn({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:V,leavedClassName:"".concat(s,"-hidden")},N,{onAppearPrepare:Te,onEnterPrepare:Te,visible:y,onVisibleChanged:function(Zt){var In;N==null||(In=N.onVisibleChanged)===null||In===void 0||In.call(N,Zt),o(Zt)}}),function(tn,Zt){var In=tn.className,Cn=tn.style,Mt=St(s,In,i);return I.createElement("div",{ref:ru(Ct,t,Zt),className:Mt,style:Je(Je(Je(Je({"--arrow-x":"".concat(k.x||0,"px"),"--arrow-y":"".concat(k.y||0,"px")},ft),bt),Cn),{},{boxSizing:"border-box",zIndex:te},d),onMouseEnter:ne,onMouseLeave:se,onPointerEnter:ee,onClick:P,onPointerDownCapture:de},D&&I.createElement(koe,{prefixCls:s,arrow:D,arrowPos:k,align:B}),I.createElement(Noe,{cache:!y&&!C},Be))})}))}),$oe=I.forwardRef(function(e,t){var n=e.children,i=e.getTriggerDOMNode,s=Fu(n),d=I.useCallback(function(o){bx(t,i?i(o):o)},[i]),f=bf(d,rm(n));return s?I.cloneElement(n,{ref:f}):n}),EB=I.createContext(null);function TB(e){return e?Array.isArray(e)?e:[e]:[]}function joe(e,t,n,i){return I.useMemo(function(){var s=TB(n??t),d=TB(i??t),f=new Set(s),o=new Set(d);return e&&(f.has("hover")&&(f.delete("hover"),f.add("click")),o.has("hover")&&(o.delete("hover"),o.add("click"))),[f,o]},[e,t,n,i])}function Voe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function Uoe(e,t,n,i){for(var s=n.points,d=Object.keys(e),f=0;f<d.length;f+=1){var o,y=d[f];if(Voe((o=e[y])===null||o===void 0?void 0:o.points,s,i))return"".concat(t,"-placement-").concat(y)}return""}function IB(e,t,n,i){return t||(n?{motionName:"".concat(e,"-").concat(n)}:i?{motionName:i}:null)}function ab(e){return e.ownerDocument.defaultView}function xR(e){for(var t=[],n=e==null?void 0:e.parentElement,i=["hidden","scroll","clip","auto"];n;){var s=ab(n).getComputedStyle(n),d=s.overflowX,f=s.overflowY,o=s.overflow;[d,f,o].some(function(y){return i.includes(y)})&&t.push(n),n=n.parentElement}return t}function Dx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?t:e}function h0(e){return Dx(parseFloat(e),0)}function PB(e,t){var n=Je({},e);return(t||[]).forEach(function(i){if(!(i instanceof HTMLBodyElement||i instanceof HTMLHtmlElement)){var s=ab(i).getComputedStyle(i),d=s.overflow,f=s.overflowClipMargin,o=s.borderTopWidth,y=s.borderBottomWidth,b=s.borderLeftWidth,C=s.borderRightWidth,P=i.getBoundingClientRect(),A=i.offsetHeight,D=i.clientHeight,k=i.offsetWidth,B=i.clientWidth,N=h0(o),j=h0(y),V=h0(b),K=h0(C),Y=Dx(Math.round(P.width/k*1e3)/1e3),Z=Dx(Math.round(P.height/A*1e3)/1e3),te=(k-B-V-K)*Y,ne=(A-D-N-j)*Z,se=N*Z,ee=j*Z,de=V*Y,fe=K*Y,ye=0,ge=0;if(d==="clip"){var we=h0(f);ye=we*Y,ge=we*Z}var Se=P.x+de-ye,xe=P.y+se-ge,Te=Se+P.width+2*ye-de-fe-te,ze=xe+P.height+2*ge-se-ee-ne;n.left=Math.max(n.left,Se),n.top=Math.max(n.top,xe),n.right=Math.min(n.right,Te),n.bottom=Math.min(n.bottom,ze)}}),n}function MB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(t),i=n.match(/^(.*)\%$/);return i?e*(parseFloat(i[1])/100):parseFloat(n)}function RB(e,t){var n=t||[],i=It(n,2),s=i[0],d=i[1];return[MB(e.width,s),MB(e.height,d)]}function AB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function Bg(e,t){var n=t[0],i=t[1],s,d;return n==="t"?d=e.y:n==="b"?d=e.y+e.height:d=e.y+e.height/2,i==="l"?s=e.x:i==="r"?s=e.x+e.width:s=e.x+e.width/2,{x:s,y:d}}function Oh(e,t){var n={t:"b",b:"t",l:"r",r:"l"};return e.map(function(i,s){return s===t?n[i]||"c":i}).join("")}function Hoe(e,t,n,i,s,d,f){var o=I.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:s[i]||{}}),y=It(o,2),b=y[0],C=y[1],P=I.useRef(0),A=I.useMemo(function(){return t?xR(t):[]},[t]),D=I.useRef({}),k=function(){D.current={}};e||k();var B=Io(function(){if(t&&n&&e){let Go=function(Ko,sa){var Ss=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tn,Ku=Xe.x+Ko,Ja=Xe.y+sa,Xu=Ku+xt,Dr=Ja+yt,ti=Math.max(Ku,Ss.left),Do=Math.max(Ja,Ss.top),No=Math.min(Xu,Ss.right),bo=Math.min(Dr,Ss.bottom);return Math.max(0,(No-ti)*(bo-Do))},Ia=function(){Ge=Xe.y+ur,ot=Ge+yt,Ye=Xe.x+ut,rt=Ye+xt};var qo=Go,Eo=Ia,V,K,Y,Z,te=t,ne=te.ownerDocument,se=ab(te),ee=se.getComputedStyle(te),de=ee.position,fe=te.style.left,ye=te.style.top,ge=te.style.right,we=te.style.bottom,Se=te.style.overflow,xe=Je(Je({},s[i]),d),Te=ne.createElement("div");(V=te.parentElement)===null||V===void 0||V.appendChild(Te),Te.style.left="".concat(te.offsetLeft,"px"),Te.style.top="".concat(te.offsetTop,"px"),Te.style.position=de,Te.style.height="".concat(te.offsetHeight,"px"),Te.style.width="".concat(te.offsetWidth,"px"),te.style.left="0",te.style.top="0",te.style.right="auto",te.style.bottom="auto",te.style.overflow="hidden";var ze;if(Array.isArray(n))ze={x:n[0],y:n[1],width:0,height:0};else{var Ue,We,Be=n.getBoundingClientRect();Be.x=(Ue=Be.x)!==null&&Ue!==void 0?Ue:Be.left,Be.y=(We=Be.y)!==null&&We!==void 0?We:Be.top,ze={x:Be.x,y:Be.y,width:Be.width,height:Be.height}}var Xe=te.getBoundingClientRect(),qe=se.getComputedStyle(te),at=qe.height,Ke=qe.width;Xe.x=(K=Xe.x)!==null&&K!==void 0?K:Xe.left,Xe.y=(Y=Xe.y)!==null&&Y!==void 0?Y:Xe.top;var tt=ne.documentElement,vt=tt.clientWidth,Pt=tt.clientHeight,ft=tt.scrollWidth,Nt=tt.scrollHeight,Rt=tt.scrollTop,pt=tt.scrollLeft,yt=Xe.height,xt=Xe.width,bt=ze.height,Ct=ze.width,tn={left:0,top:0,right:vt,bottom:Pt},Zt={left:-pt,top:-Rt,right:ft-pt,bottom:Nt-Rt},In=xe.htmlRegion,Cn="visible",Mt="visibleFirst";In!=="scroll"&&In!==Mt&&(In=Cn);var hn=In===Mt,Jt=PB(Zt,A),Ut=PB(tn,A),Tn=In===Cn?Ut:Jt,On=hn?Ut:Tn;te.style.left="auto",te.style.top="auto",te.style.right="0",te.style.bottom="0";var Kn=te.getBoundingClientRect();te.style.left=fe,te.style.top=ye,te.style.right=ge,te.style.bottom=we,te.style.overflow=Se,(Z=te.parentElement)===null||Z===void 0||Z.removeChild(Te);var Un=Dx(Math.round(xt/parseFloat(Ke)*1e3)/1e3),Pn=Dx(Math.round(yt/parseFloat(at)*1e3)/1e3);if(Un===0||Pn===0||xx(n)&&!uE(n))return;var Qn=xe.offset,un=xe.targetOffset,nn=RB(Xe,Qn),$n=It(nn,2),Ln=$n[0],qn=$n[1],er=RB(ze,un),tr=It(er,2),Jn=tr[0],Ir=tr[1];ze.x-=Jn,ze.y-=Ir;var _r=xe.points||[],$r=It(_r,2),mr=$r[0],yi=$r[1],Vr=AB(yi),Kr=AB(mr),Rr=Bg(ze,Vr),ii=Bg(Xe,Kr),Hr=Je({},xe),ut=Rr.x-ii.x+Ln,ur=Rr.y-ii.y+qn,fr=Go(ut,ur),Fn=Go(ut,ur,Ut),Gt=Bg(ze,["t","l"]),mn=Bg(Xe,["t","l"]),Xn=Bg(ze,["b","r"]),gr=Bg(Xe,["b","r"]),je=xe.overflow||{},re=je.adjustX,ie=je.adjustY,_e=je.shiftX,Re=je.shiftY,De=function(sa){return typeof sa=="boolean"?sa:sa>=0},Ge,ot,Ye,rt;Ia();var zt=De(ie),it=Kr[0]===Vr[0];if(zt&&Kr[0]==="t"&&(ot>On.bottom||D.current.bt)){var $t=ur;it?$t-=yt-bt:$t=Gt.y-gr.y-qn;var Qt=Go(ut,$t),Ft=Go(ut,$t,Ut);Qt>fr||Qt===fr&&(!hn||Ft>=Fn)?(D.current.bt=!0,ur=$t,qn=-qn,Hr.points=[Oh(Kr,0),Oh(Vr,0)]):D.current.bt=!1}if(zt&&Kr[0]==="b"&&(Ge<On.top||D.current.tb)){var jt=ur;it?jt+=yt-bt:jt=Xn.y-mn.y-qn;var rn=Go(ut,jt),yn=Go(ut,jt,Ut);rn>fr||rn===fr&&(!hn||yn>=Fn)?(D.current.tb=!0,ur=jt,qn=-qn,Hr.points=[Oh(Kr,0),Oh(Vr,0)]):D.current.tb=!1}var rr=De(re),En=Kr[1]===Vr[1];if(rr&&Kr[1]==="l"&&(rt>On.right||D.current.rl)){var Zn=ut;En?Zn-=xt-Ct:Zn=Gt.x-gr.x-Ln;var ar=Go(Zn,ur),qr=Go(Zn,ur,Ut);ar>fr||ar===fr&&(!hn||qr>=Fn)?(D.current.rl=!0,ut=Zn,Ln=-Ln,Hr.points=[Oh(Kr,1),Oh(Vr,1)]):D.current.rl=!1}if(rr&&Kr[1]==="r"&&(Ye<On.left||D.current.lr)){var Ar=ut;En?Ar+=xt-Ct:Ar=Xn.x-mn.x-Ln;var yr=Go(Ar,ur),Jr=Go(Ar,ur,Ut);yr>fr||yr===fr&&(!hn||Jr>=Fn)?(D.current.lr=!0,ut=Ar,Ln=-Ln,Hr.points=[Oh(Kr,1),Oh(Vr,1)]):D.current.lr=!1}Ia();var ni=_e===!0?0:_e;typeof ni=="number"&&(Ye<Ut.left&&(ut-=Ye-Ut.left-Ln,ze.x+Ct<Ut.left+ni&&(ut+=ze.x-Ut.left+Ct-ni)),rt>Ut.right&&(ut-=rt-Ut.right-Ln,ze.x>Ut.right-ni&&(ut+=ze.x-Ut.right+ni)));var Qr=Re===!0?0:Re;typeof Qr=="number"&&(Ge<Ut.top&&(ur-=Ge-Ut.top-qn,ze.y+bt<Ut.top+Qr&&(ur+=ze.y-Ut.top+bt-Qr)),ot>Ut.bottom&&(ur-=ot-Ut.bottom-qn,ze.y>Ut.bottom-Qr&&(ur+=ze.y-Ut.bottom+Qr)));var li=Xe.x+ut,Ui=li+xt,oo=Xe.y+ur,Ti=oo+yt,wr=ze.x,nr=wr+Ct,xi=ze.y,oi=xi+bt,Li=Math.max(li,wr),ki=Math.min(Ui,nr),ho=(Li+ki)/2,Uo=ho-li,Qo=Math.max(oo,xi),Ho=Math.min(Ti,oi),ea=(Qo+Ho)/2,Oo=ea-oo;f==null||f(t,Hr);var Br=Kn.right-Xe.x-(ut+Xe.width),Xr=Kn.bottom-Xe.y-(ur+Xe.height);Un===1&&(ut=Math.round(ut),Br=Math.round(Br)),Pn===1&&(ur=Math.round(ur),Xr=Math.round(Xr));var eo={ready:!0,offsetX:ut/Un,offsetY:ur/Pn,offsetR:Br/Un,offsetB:Xr/Pn,arrowX:Uo/Un,arrowY:Oo/Pn,scaleX:Un,scaleY:Pn,align:Hr};C(eo)}}),N=function(){P.current+=1;var K=P.current;Promise.resolve().then(function(){P.current===K&&B()})},j=function(){C(function(K){return Je(Je({},K),{},{ready:!1})})};return yo(j,[i]),yo(function(){e||j()},[e]),[b.ready,b.offsetX,b.offsetY,b.offsetR,b.offsetB,b.arrowX,b.arrowY,b.scaleX,b.scaleY,b.align,N]}function Goe(e,t,n,i,s){yo(function(){if(e&&t&&n){let A=function(){i(),s()};var P=A,d=t,f=n,o=xR(d),y=xR(f),b=ab(f),C=new Set([b].concat(zn(o),zn(y)));return C.forEach(function(D){D.addEventListener("scroll",A,{passive:!0})}),b.addEventListener("resize",A,{passive:!0}),i(),function(){C.forEach(function(D){D.removeEventListener("scroll",A),b.removeEventListener("resize",A)})}}},[e,t,n])}function Woe(e,t,n,i,s,d,f,o){var y=I.useRef(e);y.current=e;var b=I.useRef(!1);I.useEffect(function(){if(t&&i&&(!s||d)){var P=function(){b.current=!1},A=function(N){var j;y.current&&!f(((j=N.composedPath)===null||j===void 0||(j=j.call(N))===null||j===void 0?void 0:j[0])||N.target)&&!b.current&&o(!1)},D=ab(i);D.addEventListener("pointerdown",P,!0),D.addEventListener("mousedown",A,!0),D.addEventListener("contextmenu",A,!0);var k=iC(n);return k&&(k.addEventListener("mousedown",A,!0),k.addEventListener("contextmenu",A,!0)),function(){D.removeEventListener("pointerdown",P,!0),D.removeEventListener("mousedown",A,!0),D.removeEventListener("contextmenu",A,!0),k&&(k.removeEventListener("mousedown",A,!0),k.removeEventListener("contextmenu",A,!0))}}},[t,n,i,s,d]);function C(){b.current=!0}return C}var qoe=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function Koe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eH,t=I.forwardRef(function(n,i){var s=n.prefixCls,d=s===void 0?"rc-trigger-popup":s,f=n.children,o=n.action,y=o===void 0?"hover":o,b=n.showAction,C=n.hideAction,P=n.popupVisible,A=n.defaultPopupVisible,D=n.onPopupVisibleChange,k=n.afterPopupVisibleChange,B=n.mouseEnterDelay,N=n.mouseLeaveDelay,j=N===void 0?.1:N,V=n.focusDelay,K=n.blurDelay,Y=n.mask,Z=n.maskClosable,te=Z===void 0?!0:Z,ne=n.getPopupContainer,se=n.forceRender,ee=n.autoDestroy,de=n.destroyPopupOnHide,fe=n.popup,ye=n.popupClassName,ge=n.popupStyle,we=n.popupPlacement,Se=n.builtinPlacements,xe=Se===void 0?{}:Se,Te=n.popupAlign,ze=n.zIndex,Ue=n.stretch,We=n.getPopupClassNameFromAlign,Be=n.fresh,Xe=n.alignPoint,qe=n.onPopupClick,at=n.onPopupAlign,Ke=n.arrow,tt=n.popupMotion,vt=n.maskMotion,Pt=n.popupTransitionName,ft=n.popupAnimation,Nt=n.maskTransitionName,Rt=n.maskAnimation,pt=n.className,yt=n.getTriggerDOMNode,xt=ri(n,qoe),bt=ee||de||!1,Ct=I.useState(!1),tn=It(Ct,2),Zt=tn[0],In=tn[1];yo(function(){In(NO())},[]);var Cn=I.useRef({}),Mt=I.useContext(EB),hn=I.useMemo(function(){return{registerSubPopup:function(ti,Do){Cn.current[ti]=Do,Mt==null||Mt.registerSubPopup(ti,Do)}}},[Mt]),Jt=kO(),Ut=I.useState(null),Tn=It(Ut,2),On=Tn[0],Kn=Tn[1],Un=I.useRef(null),Pn=Io(function(Dr){Un.current=Dr,xx(Dr)&&On!==Dr&&Kn(Dr),Mt==null||Mt.registerSubPopup(Jt,Dr)}),Qn=I.useState(null),un=It(Qn,2),nn=un[0],$n=un[1],Ln=I.useRef(null),qn=Io(function(Dr){xx(Dr)&&nn!==Dr&&($n(Dr),Ln.current=Dr)}),er=I.Children.only(f),tr=(er==null?void 0:er.props)||{},Jn={},Ir=Io(function(Dr){var ti,Do,No=nn;return(No==null?void 0:No.contains(Dr))||((ti=iC(No))===null||ti===void 0?void 0:ti.host)===Dr||Dr===No||(On==null?void 0:On.contains(Dr))||((Do=iC(On))===null||Do===void 0?void 0:Do.host)===Dr||Dr===On||Object.values(Cn.current).some(function(bo){return(bo==null?void 0:bo.contains(Dr))||Dr===bo})}),_r=IB(d,tt,ft,Pt),$r=IB(d,vt,Rt,Nt),mr=I.useState(A||!1),yi=It(mr,2),Vr=yi[0],Kr=yi[1],Rr=P??Vr,ii=Io(function(Dr){P===void 0&&Kr(Dr)});yo(function(){Kr(P||!1)},[P]);var Hr=I.useRef(Rr);Hr.current=Rr;var ut=I.useRef([]);ut.current=[];var ur=Io(function(Dr){var ti;ii(Dr),((ti=ut.current[ut.current.length-1])!==null&&ti!==void 0?ti:Rr)!==Dr&&(ut.current.push(Dr),D==null||D(Dr))}),fr=I.useRef(),Fn=function(){clearTimeout(fr.current)},Gt=function(ti){var Do=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Fn(),Do===0?ur(ti):fr.current=setTimeout(function(){ur(ti)},Do*1e3)};I.useEffect(function(){return Fn},[]);var mn=I.useState(!1),Xn=It(mn,2),gr=Xn[0],je=Xn[1];yo(function(Dr){(!Dr||Rr)&&je(!0)},[Rr]);var re=I.useState(null),ie=It(re,2),_e=ie[0],Re=ie[1],De=I.useState(null),Ge=It(De,2),ot=Ge[0],Ye=Ge[1],rt=function(ti){Ye([ti.clientX,ti.clientY])},zt=Hoe(Rr,On,Xe&&ot!==null?ot:nn,we,xe,Te,at),it=It(zt,11),$t=it[0],Qt=it[1],Ft=it[2],jt=it[3],rn=it[4],yn=it[5],rr=it[6],En=it[7],Zn=it[8],ar=it[9],qr=it[10],Ar=joe(Zt,y,b,C),yr=It(Ar,2),Jr=yr[0],ni=yr[1],Qr=Jr.has("click"),li=ni.has("click")||ni.has("contextMenu"),Ui=Io(function(){gr||qr()}),oo=function(){Hr.current&&Xe&&li&&Gt(!1)};Goe(Rr,nn,On,Ui,oo),yo(function(){Ui()},[ot,we]),yo(function(){Rr&&!(xe!=null&&xe[we])&&Ui()},[JSON.stringify(Te)]);var Ti=I.useMemo(function(){var Dr=Uoe(xe,d,ar,Xe);return St(Dr,We==null?void 0:We(ar))},[ar,We,xe,d,Xe]);I.useImperativeHandle(i,function(){return{nativeElement:Ln.current,popupElement:Un.current,forceAlign:Ui}});var wr=I.useState(0),nr=It(wr,2),xi=nr[0],oi=nr[1],Li=I.useState(0),ki=It(Li,2),ho=ki[0],Uo=ki[1],Qo=function(){if(Ue&&nn){var ti=nn.getBoundingClientRect();oi(ti.width),Uo(ti.height)}},Ho=function(){Qo(),Ui()},ea=function(ti){je(!1),qr(),k==null||k(ti)},Oo=function(){return new Promise(function(ti){Qo(),Re(function(){return ti})})};yo(function(){_e&&(qr(),_e(),Re(null))},[_e]);function Br(Dr,ti,Do,No){Jn[Dr]=function(bo){var ci;No==null||No(bo),Gt(ti,Do);for(var Zu=arguments.length,iu=new Array(Zu>1?Zu-1:0),Yl=1;Yl<Zu;Yl++)iu[Yl-1]=arguments[Yl];(ci=tr[Dr])===null||ci===void 0||ci.call.apply(ci,[tr,bo].concat(iu))}}(Qr||li)&&(Jn.onClick=function(Dr){var ti;Hr.current&&li?Gt(!1):!Hr.current&&Qr&&(rt(Dr),Gt(!0));for(var Do=arguments.length,No=new Array(Do>1?Do-1:0),bo=1;bo<Do;bo++)No[bo-1]=arguments[bo];(ti=tr.onClick)===null||ti===void 0||ti.call.apply(ti,[tr,Dr].concat(No))});var Xr=Woe(Rr,li,nn,On,Y,te,Ir,Gt),eo=Jr.has("hover"),qo=ni.has("hover"),Eo,Go;eo&&(Br("onMouseEnter",!0,B,function(Dr){rt(Dr)}),Br("onPointerEnter",!0,B,function(Dr){rt(Dr)}),Eo=function(ti){(Rr||gr)&&On!==null&&On!==void 0&&On.contains(ti.target)&&Gt(!0,B)},Xe&&(Jn.onMouseMove=function(Dr){var ti;(ti=tr.onMouseMove)===null||ti===void 0||ti.call(tr,Dr)})),qo&&(Br("onMouseLeave",!1,j),Br("onPointerLeave",!1,j),Go=function(){Gt(!1,j)}),Jr.has("focus")&&Br("onFocus",!0,V),ni.has("focus")&&Br("onBlur",!1,K),Jr.has("contextMenu")&&(Jn.onContextMenu=function(Dr){var ti;Hr.current&&ni.has("contextMenu")?Gt(!1):(rt(Dr),Gt(!0)),Dr.preventDefault();for(var Do=arguments.length,No=new Array(Do>1?Do-1:0),bo=1;bo<Do;bo++)No[bo-1]=arguments[bo];(ti=tr.onContextMenu)===null||ti===void 0||ti.call.apply(ti,[tr,Dr].concat(No))}),pt&&(Jn.className=St(tr.className,pt));var Ia=I.useRef(!1);Ia.current||(Ia.current=se||Rr||gr);var Ko=Je(Je({},tr),Jn),sa={},Ss=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Ss.forEach(function(Dr){xt[Dr]&&(sa[Dr]=function(){for(var ti,Do=arguments.length,No=new Array(Do),bo=0;bo<Do;bo++)No[bo]=arguments[bo];(ti=Ko[Dr])===null||ti===void 0||ti.call.apply(ti,[Ko].concat(No)),xt[Dr].apply(xt,No)})});var Ku=I.cloneElement(er,Je(Je({},Ko),sa)),Ja={x:yn,y:rr},Xu=Ke?Je({},Ke!==!0?Ke:{}):null;return I.createElement(I.Fragment,null,I.createElement(Wl,{disabled:!Rr,ref:qn,onResize:Ho},I.createElement($oe,{getTriggerDOMNode:yt},Ku)),Ia.current&&I.createElement(EB.Provider,{value:hn},I.createElement(Boe,{portal:e,ref:Pn,prefixCls:d,popup:fe,className:St(ye,Ti),style:ge,target:nn,onMouseEnter:Eo,onMouseLeave:Go,onPointerEnter:Eo,zIndex:ze,open:Rr,keepDom:gr,fresh:Be,onClick:qe,onPointerDownCapture:Xr,mask:Y,motion:_r,maskMotion:$r,onVisibleChanged:ea,onPrepare:Oo,forceRender:se,autoDestroy:bt,getPopupContainer:ne,align:ar,arrow:Xu,arrowPos:Ja,ready:$t,offsetX:Qt,offsetY:Ft,offsetR:jt,offsetB:rn,onAlign:Ui,stretch:Ue,targetWidth:xi/En,targetHeight:ho/Zn})))});return t}const CE=Koe(eH);var Xoe=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],Zoe=function(t){var n=t===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"}}},Yoe=function(t,n){var i=t.prefixCls;t.disabled;var s=t.visible,d=t.children,f=t.popupElement,o=t.animation,y=t.transitionName,b=t.dropdownStyle,C=t.dropdownClassName,P=t.direction,A=P===void 0?"ltr":P,D=t.placement,k=t.builtinPlacements,B=t.dropdownMatchSelectWidth,N=t.dropdownRender,j=t.dropdownAlign,V=t.getPopupContainer,K=t.empty,Y=t.getTriggerDOMNode,Z=t.onPopupVisibleChange,te=t.onPopupMouseEnter,ne=ri(t,Xoe),se="".concat(i,"-dropdown"),ee=f;N&&(ee=N(f));var de=I.useMemo(function(){return k||Zoe(B)},[k,B]),fe=o?"".concat(se,"-").concat(o):y,ye=typeof B=="number",ge=I.useMemo(function(){return ye?null:B===!1?"minWidth":"width"},[B,ye]),we=b;ye&&(we=Je(Je({},we),{},{width:B}));var Se=I.useRef(null);return I.useImperativeHandle(n,function(){return{getPopupElement:function(){var Te;return(Te=Se.current)===null||Te===void 0?void 0:Te.popupElement}}}),I.createElement(CE,kn({},ne,{showAction:Z?["click"]:[],hideAction:Z?["click"]:[],popupPlacement:D||(A==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:de,prefixCls:se,popupTransitionName:fe,popup:I.createElement("div",{onMouseEnter:te},ee),ref:Se,stretch:ge,popupAlign:j,popupVisible:s,getPopupContainer:V,popupClassName:St(C,ke({},"".concat(se,"-empty"),K)),popupStyle:we,getTriggerDOMNode:Y,onPopupVisibleChange:Z}),d)},Joe=I.forwardRef(Yoe);function OB(e,t){var n=e.key,i;return"value"in e&&(i=e.value),n??(i!==void 0?i:"rc-index-key-".concat(t))}function bR(e){return typeof e<"u"&&!Number.isNaN(e)}function vH(e,t){var n=e||{},i=n.label,s=n.value,d=n.options,f=n.groupLabel,o=i||(t?"children":"label");return{label:o,value:s||"value",options:d||"options",groupLabel:f||o}}function Qoe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.fieldNames,i=t.childrenAsData,s=[],d=vH(n,!1),f=d.label,o=d.value,y=d.options,b=d.groupLabel;function C(P,A){Array.isArray(P)&&P.forEach(function(D){if(A||!(y in D)){var k=D[o];s.push({key:OB(D,s.length),groupOption:A,data:D,label:D[f],value:k})}else{var B=D[b];B===void 0&&i&&(B=D.label),s.push({key:OB(D,s.length),group:!0,data:D,label:B}),C(D[y],!0)}})}return C(e,!1),s}function wR(e){var t=Je({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return oa(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),t}}),t}var eae=function(t,n,i){if(!n||!n.length)return null;var s=!1,d=function o(y,b){var C=aU(b),P=C[0],A=C.slice(1);if(!P)return[y];var D=y.split(P);return s=s||D.length>1,D.reduce(function(k,B){return[].concat(zn(k),zn(o(B,A)))},[]).filter(Boolean)},f=d(t,n);return s?typeof i<"u"?f.slice(0,i):f:null},BO=I.createContext(null);function tae(e){var t=e.visible,n=e.values;if(!t)return null;var i=50;return I.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"".concat(n.slice(0,i).map(function(s){var d=s.label,f=s.value;return["number","string"].includes(Nr(d))?d:f}).join(", ")),n.length>i?", ...":null)}var nae=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","prefix","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],rae=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"],SR=function(t){return t==="tags"||t==="multiple"},iae=I.forwardRef(function(e,t){var n,i=e.id,s=e.prefixCls,d=e.className,f=e.showSearch,o=e.tagRender,y=e.direction,b=e.omitDomProps,C=e.displayValues,P=e.onDisplayValuesChange,A=e.emptyOptions,D=e.notFoundContent,k=D===void 0?"Not Found":D,B=e.onClear,N=e.mode,j=e.disabled,V=e.loading,K=e.getInputElement,Y=e.getRawInputElement,Z=e.open,te=e.defaultOpen,ne=e.onDropdownVisibleChange,se=e.activeValue,ee=e.onActiveValueChange,de=e.activeDescendantId,fe=e.searchValue,ye=e.autoClearSearchValue,ge=e.onSearch,we=e.onSearchSplit,Se=e.tokenSeparators,xe=e.allowClear,Te=e.prefix,ze=e.suffixIcon,Ue=e.clearIcon,We=e.OptionList,Be=e.animation,Xe=e.transitionName,qe=e.dropdownStyle,at=e.dropdownClassName,Ke=e.dropdownMatchSelectWidth,tt=e.dropdownRender,vt=e.dropdownAlign,Pt=e.placement,ft=e.builtinPlacements,Nt=e.getPopupContainer,Rt=e.showAction,pt=Rt===void 0?[]:Rt,yt=e.onFocus,xt=e.onBlur,bt=e.onKeyUp,Ct=e.onKeyDown,tn=e.onMouseDown,Zt=ri(e,nae),In=SR(N),Cn=(f!==void 0?f:In)||N==="combobox",Mt=Je({},Zt);rae.forEach(function(wr){delete Mt[wr]}),b==null||b.forEach(function(wr){delete Mt[wr]});var hn=I.useState(!1),Jt=It(hn,2),Ut=Jt[0],Tn=Jt[1];I.useEffect(function(){Tn(NO())},[]);var On=I.useRef(null),Kn=I.useRef(null),Un=I.useRef(null),Pn=I.useRef(null),Qn=I.useRef(null),un=I.useRef(!1),nn=coe(),$n=It(nn,3),Ln=$n[0],qn=$n[1],er=$n[2];I.useImperativeHandle(t,function(){var wr,nr;return{focus:(wr=Pn.current)===null||wr===void 0?void 0:wr.focus,blur:(nr=Pn.current)===null||nr===void 0?void 0:nr.blur,scrollTo:function(oi){var Li;return(Li=Qn.current)===null||Li===void 0?void 0:Li.scrollTo(oi)},nativeElement:On.current||Kn.current}});var tr=I.useMemo(function(){var wr;if(N!=="combobox")return fe;var nr=(wr=C[0])===null||wr===void 0?void 0:wr.value;return typeof nr=="string"||typeof nr=="number"?String(nr):""},[fe,N,C]),Jn=N==="combobox"&&typeof K=="function"&&K()||null,Ir=typeof Y=="function"&&Y(),_r=bf(Kn,Ir==null||(n=Ir.props)===null||n===void 0?void 0:n.ref),$r=I.useState(!1),mr=It($r,2),yi=mr[0],Vr=mr[1];yo(function(){Vr(!0)},[]);var Kr=is(!1,{defaultValue:te,value:Z}),Rr=It(Kr,2),ii=Rr[0],Hr=Rr[1],ut=yi?ii:!1,ur=!k&&A;(j||ur&&ut&&N==="combobox")&&(ut=!1);var fr=ur?!1:ut,Fn=I.useCallback(function(wr){var nr=wr!==void 0?wr:!ut;j||(Hr(nr),ut!==nr&&(ne==null||ne(nr)))},[j,ut,Hr,ne]),Gt=I.useMemo(function(){return(Se||[]).some(function(wr){return[`
`,`\r
`].includes(wr)})},[Se]),mn=I.useContext(BO)||{},Xn=mn.maxCount,gr=mn.rawValues,je=function(nr,xi,oi){if(!(In&&bR(Xn)&&(gr==null?void 0:gr.size)>=Xn)){var Li=!0,ki=nr;ee==null||ee(null);var ho=eae(nr,Se,bR(Xn)?Xn-gr.size:void 0),Uo=oi?null:ho;return N!=="combobox"&&Uo&&(ki="",we==null||we(Uo),Fn(!1),Li=!1),ge&&tr!==ki&&ge(ki,{source:xi?"typing":"effect"}),Li}},re=function(nr){!nr||!nr.trim()||ge(nr,{source:"submit"})};I.useEffect(function(){!ut&&!In&&N!=="combobox"&&je("",!1,!1)},[ut]),I.useEffect(function(){ii&&j&&Hr(!1),j&&!un.current&&qn(!1)},[j]);var ie=uH(),_e=It(ie,2),Re=_e[0],De=_e[1],Ge=I.useRef(!1),ot=function(nr){var xi=Re(),oi=nr.key,Li=oi==="Enter";if(Li&&(N!=="combobox"&&nr.preventDefault(),ut||Fn(!0)),De(!!tr),oi==="Backspace"&&!xi&&In&&!tr&&C.length){for(var ki=zn(C),ho=null,Uo=ki.length-1;Uo>=0;Uo-=1){var Qo=ki[Uo];if(!Qo.disabled){ki.splice(Uo,1),ho=Qo;break}}ho&&P(ki,{type:"remove",values:[ho]})}for(var Ho=arguments.length,ea=new Array(Ho>1?Ho-1:0),Oo=1;Oo<Ho;Oo++)ea[Oo-1]=arguments[Oo];if(ut&&(!Li||!Ge.current)){var Br;Li&&(Ge.current=!0),(Br=Qn.current)===null||Br===void 0||Br.onKeyDown.apply(Br,[nr].concat(ea))}Ct==null||Ct.apply(void 0,[nr].concat(ea))},Ye=function(nr){for(var xi=arguments.length,oi=new Array(xi>1?xi-1:0),Li=1;Li<xi;Li++)oi[Li-1]=arguments[Li];if(ut){var ki;(ki=Qn.current)===null||ki===void 0||ki.onKeyUp.apply(ki,[nr].concat(oi))}nr.key==="Enter"&&(Ge.current=!1),bt==null||bt.apply(void 0,[nr].concat(oi))},rt=function(nr){var xi=C.filter(function(oi){return oi!==nr});P(xi,{type:"remove",values:[nr]})},zt=function(){Ge.current=!1},it=I.useRef(!1),$t=function(){qn(!0),j||(yt&&!it.current&&yt.apply(void 0,arguments),pt.includes("focus")&&Fn(!0)),it.current=!0},Qt=function(){un.current=!0,qn(!1,function(){it.current=!1,un.current=!1,Fn(!1)}),!j&&(tr&&(N==="tags"?ge(tr,{source:"submit"}):N==="multiple"&&ge("",{source:"blur"})),xt&&xt.apply(void 0,arguments))},Ft=[];I.useEffect(function(){return function(){Ft.forEach(function(wr){return clearTimeout(wr)}),Ft.splice(0,Ft.length)}},[]);var jt=function(nr){var xi,oi=nr.target,Li=(xi=Un.current)===null||xi===void 0?void 0:xi.getPopupElement();if(Li&&Li.contains(oi)){var ki=setTimeout(function(){var Ho=Ft.indexOf(ki);if(Ho!==-1&&Ft.splice(Ho,1),er(),!Ut&&!Li.contains(document.activeElement)){var ea;(ea=Pn.current)===null||ea===void 0||ea.focus()}});Ft.push(ki)}for(var ho=arguments.length,Uo=new Array(ho>1?ho-1:0),Qo=1;Qo<ho;Qo++)Uo[Qo-1]=arguments[Qo];tn==null||tn.apply(void 0,[nr].concat(Uo))},rn=I.useState({}),yn=It(rn,2),rr=yn[1];function En(){rr({})}var Zn;Ir&&(Zn=function(nr){Fn(nr)}),uoe(function(){var wr;return[On.current,(wr=Un.current)===null||wr===void 0?void 0:wr.getPopupElement()]},fr,Fn,!!Ir);var ar=I.useMemo(function(){return Je(Je({},e),{},{notFoundContent:k,open:ut,triggerOpen:fr,id:i,showSearch:Cn,multiple:In,toggleOpen:Fn})},[e,k,fr,ut,i,Cn,In,Fn]),qr=!!ze||V,Ar;qr&&(Ar=I.createElement(SE,{className:St("".concat(s,"-arrow"),ke({},"".concat(s,"-arrow-loading"),V)),customizeIcon:ze,customizeIconProps:{loading:V,searchValue:tr,open:ut,focused:Ln,showSearch:Cn}}));var yr=function(){var nr;B==null||B(),(nr=Pn.current)===null||nr===void 0||nr.focus(),P([],{type:"clear",values:C}),je("",!1,!1)},Jr=soe(s,yr,C,xe,Ue,j,tr,N),ni=Jr.allowClear,Qr=Jr.clearIcon,li=I.createElement(We,{ref:Qn}),Ui=St(s,d,ke(ke(ke(ke(ke(ke(ke(ke(ke(ke({},"".concat(s,"-focused"),Ln),"".concat(s,"-multiple"),In),"".concat(s,"-single"),!In),"".concat(s,"-allow-clear"),xe),"".concat(s,"-show-arrow"),qr),"".concat(s,"-disabled"),j),"".concat(s,"-loading"),V),"".concat(s,"-open"),ut),"".concat(s,"-customize-input"),Jn),"".concat(s,"-show-search"),Cn)),oo=I.createElement(Joe,{ref:Un,disabled:j,prefixCls:s,visible:fr,popupElement:li,animation:Be,transitionName:Xe,dropdownStyle:qe,dropdownClassName:at,direction:y,dropdownMatchSelectWidth:Ke,dropdownRender:tt,dropdownAlign:vt,placement:Pt,builtinPlacements:ft,getPopupContainer:Nt,empty:A,getTriggerDOMNode:function(nr){return Kn.current||nr},onPopupVisibleChange:Zn,onPopupMouseEnter:En},Ir?I.cloneElement(Ir,{ref:_r}):I.createElement(zoe,kn({},e,{domRef:Kn,prefixCls:s,inputElement:Jn,ref:Pn,id:i,prefix:Te,showSearch:Cn,autoClearSearchValue:ye,mode:N,activeDescendantId:de,tagRender:o,values:C,open:ut,onToggleOpen:Fn,activeValue:se,searchValue:tr,onSearch:je,onSearchSubmit:re,onRemove:rt,tokenWithEnter:Gt,onInputBlur:zt}))),Ti;return Ir?Ti=oo:Ti=I.createElement("div",kn({className:Ui},Mt,{ref:On,onMouseDown:jt,onKeyDown:ot,onKeyUp:Ye,onFocus:$t,onBlur:Qt}),I.createElement(tae,{visible:Ln&&!ut,values:C}),oo,Ar,ni&&Qr),I.createElement(cH.Provider,{value:ar},Ti)}),$O=function(){return null};$O.isSelectOptGroup=!0;var jO=function(){return null};jO.isSelectOption=!0;var _H=I.forwardRef(function(e,t){var n=e.height,i=e.offsetY,s=e.offsetX,d=e.children,f=e.prefixCls,o=e.onInnerResize,y=e.innerProps,b=e.rtl,C=e.extra,P={},A={display:"flex",flexDirection:"column"};return i!==void 0&&(P={height:n,position:"relative",overflow:"hidden"},A=Je(Je({},A),{},ke(ke(ke(ke(ke({transform:"translateY(".concat(i,"px)")},b?"marginRight":"marginLeft",-s),"position","absolute"),"left",0),"right",0),"top",0))),I.createElement("div",{style:P},I.createElement(Wl,{onResize:function(k){var B=k.offsetHeight;B&&o&&o()}},I.createElement("div",kn({style:A,className:St(ke({},"".concat(f,"-holder-inner"),f)),ref:t},y),d,C)))});_H.displayName="Filler";function oae(e){var t=e.children,n=e.setRef,i=I.useCallback(function(s){n(s)},[]);return I.cloneElement(t,{ref:i})}function aae(e,t,n,i,s,d,f,o){var y=o.getKey;return e.slice(t,n+1).map(function(b,C){var P=t+C,A=f(b,P,{style:{width:i},offsetX:s}),D=y(b);return I.createElement(oae,{key:D,setRef:function(B){return d(b,B)}},A)})}function sae(e,t,n){var i=e.length,s=t.length,d,f;if(i===0&&s===0)return null;i<s?(d=e,f=t):(d=t,f=e);var o={__EMPTY_ITEM__:!0};function y(k){return k!==void 0?n(k):o}for(var b=null,C=Math.abs(i-s)!==1,P=0;P<f.length;P+=1){var A=y(d[P]),D=y(f[P]);if(A!==D){b=P,C=C||A!==y(f[P+1]);break}}return b===null?null:{index:b,multiple:C}}function lae(e,t,n){var i=I.useState(e),s=It(i,2),d=s[0],f=s[1],o=I.useState(null),y=It(o,2),b=y[0],C=y[1];return I.useEffect(function(){var P=sae(d||[],e||[],t);(P==null?void 0:P.index)!==void 0&&C(e[P.index]),f(e)},[e]),[b]}var DB=(typeof navigator>"u"?"undefined":Nr(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const yH=function(e,t,n,i){var s=I.useRef(!1),d=I.useRef(null);function f(){clearTimeout(d.current),s.current=!0,d.current=setTimeout(function(){s.current=!1},50)}var o=I.useRef({top:e,bottom:t,left:n,right:i});return o.current.top=e,o.current.bottom=t,o.current.left=n,o.current.right=i,function(y,b){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=y?b<0&&o.current.left||b>0&&o.current.right:b<0&&o.current.top||b>0&&o.current.bottom;return C&&P?(clearTimeout(d.current),s.current=!1):(!P||s.current)&&f(),!s.current&&P}};function cae(e,t,n,i,s,d,f){var o=I.useRef(0),y=I.useRef(null),b=I.useRef(null),C=I.useRef(!1),P=yH(t,n,i,s);function A(V,K){if(Qi.cancel(y.current),!P(!1,K)){var Y=V;if(!Y._virtualHandled)Y._virtualHandled=!0;else return;o.current+=K,b.current=K,DB||Y.preventDefault(),y.current=Qi(function(){var Z=C.current?10:1;f(o.current*Z,!1),o.current=0})}}function D(V,K){f(K,!0),DB||V.preventDefault()}var k=I.useRef(null),B=I.useRef(null);function N(V){if(e){Qi.cancel(B.current),B.current=Qi(function(){k.current=null},2);var K=V.deltaX,Y=V.deltaY,Z=V.shiftKey,te=K,ne=Y;(k.current==="sx"||!k.current&&Z&&Y&&!K)&&(te=Y,ne=0,k.current="sx");var se=Math.abs(te),ee=Math.abs(ne);k.current===null&&(k.current=d&&se>ee?"x":"y"),k.current==="y"?A(V,ne):D(V,te)}}function j(V){e&&(C.current=V.detail===b.current)}return[N,j]}function uae(e,t,n,i){var s=I.useMemo(function(){return[new Map,[]]},[e,n.id,i]),d=It(s,2),f=d[0],o=d[1],y=function(C){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,A=f.get(C),D=f.get(P);if(A===void 0||D===void 0)for(var k=e.length,B=o.length;B<k;B+=1){var N,j=e[B],V=t(j);f.set(V,B);var K=(N=n.get(V))!==null&&N!==void 0?N:i;if(o[B]=(o[B-1]||0)+K,V===C&&(A=B),V===P&&(D=B),A!==void 0&&D!==void 0)break}return{top:o[A-1]||0,bottom:o[D]}};return y}var dae=function(){function e(){ja(this,e),ke(this,"maps",void 0),ke(this,"id",0),ke(this,"diffRecords",new Map),this.maps=Object.create(null)}return Va(e,[{key:"set",value:function(n,i){this.diffRecords.set(n,this.maps[n]),this.maps[n]=i,this.id+=1}},{key:"get",value:function(n){return this.maps[n]}},{key:"resetRecord",value:function(){this.diffRecords.clear()}},{key:"getRecord",value:function(){return this.diffRecords}}]),e}();function LB(e){var t=parseFloat(e);return isNaN(t)?0:t}function hae(e,t,n){var i=I.useState(0),s=It(i,2),d=s[0],f=s[1],o=I.useRef(new Map),y=I.useRef(new dae),b=I.useRef(0);function C(){b.current+=1}function P(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;C();var k=function(){var j=!1;o.current.forEach(function(V,K){if(V&&V.offsetParent){var Y=V.offsetHeight,Z=getComputedStyle(V),te=Z.marginTop,ne=Z.marginBottom,se=LB(te),ee=LB(ne),de=Y+se+ee;y.current.get(K)!==de&&(y.current.set(K,de),j=!0)}}),j&&f(function(V){return V+1})};if(D)k();else{b.current+=1;var B=b.current;Promise.resolve().then(function(){B===b.current&&k()})}}function A(D,k){var B=e(D);o.current.get(B),k?(o.current.set(B,k),P()):o.current.delete(B)}return I.useEffect(function(){return C},[]),[A,P,y.current,d]}var zB=14/15;function fae(e,t,n){var i=I.useRef(!1),s=I.useRef(0),d=I.useRef(0),f=I.useRef(null),o=I.useRef(null),y,b=function(D){if(i.current){var k=Math.ceil(D.touches[0].pageX),B=Math.ceil(D.touches[0].pageY),N=s.current-k,j=d.current-B,V=Math.abs(N)>Math.abs(j);V?s.current=k:d.current=B;var K=n(V,V?N:j,!1,D);K&&D.preventDefault(),clearInterval(o.current),K&&(o.current=setInterval(function(){V?N*=zB:j*=zB;var Y=Math.floor(V?N:j);(!n(V,Y,!0)||Math.abs(Y)<=.1)&&clearInterval(o.current)},16))}},C=function(){i.current=!1,y()},P=function(D){y(),D.touches.length===1&&!i.current&&(i.current=!0,s.current=Math.ceil(D.touches[0].pageX),d.current=Math.ceil(D.touches[0].pageY),f.current=D.target,f.current.addEventListener("touchmove",b,{passive:!1}),f.current.addEventListener("touchend",C,{passive:!0}))};y=function(){f.current&&(f.current.removeEventListener("touchmove",b),f.current.removeEventListener("touchend",C))},yo(function(){return e&&t.current.addEventListener("touchstart",P,{passive:!0}),function(){var A;(A=t.current)===null||A===void 0||A.removeEventListener("touchstart",P),y(),clearInterval(o.current)}},[e])}function kB(e){return Math.floor(Math.pow(e,.5))}function CR(e,t){var n="touches"in e?e.touches[0]:e;return n[t?"pageX":"pageY"]-window[t?"scrollX":"scrollY"]}function pae(e,t,n){I.useEffect(function(){var i=t.current;if(e&&i){var s=!1,d,f,o=function(){Qi.cancel(d)},y=function A(){o(),d=Qi(function(){n(f),A()})},b=function(){s=!1,o()},C=function(D){if(!(D.target.draggable||D.button!==0)){var k=D;k._virtualHandled||(k._virtualHandled=!0,s=!0)}},P=function(D){if(s){var k=CR(D,!1),B=i.getBoundingClientRect(),N=B.top,j=B.bottom;if(k<=N){var V=N-k;f=-kB(V),y()}else if(k>=j){var K=k-j;f=kB(K),y()}else o()}};return i.addEventListener("mousedown",C),i.ownerDocument.addEventListener("mouseup",b),i.ownerDocument.addEventListener("mousemove",P),i.ownerDocument.addEventListener("dragend",b),function(){i.removeEventListener("mousedown",C),i.ownerDocument.removeEventListener("mouseup",b),i.ownerDocument.removeEventListener("mousemove",P),i.ownerDocument.removeEventListener("dragend",b),o()}}},[e])}var mae=10;function gae(e,t,n,i,s,d,f,o){var y=I.useRef(),b=I.useState(null),C=It(b,2),P=C[0],A=C[1];return yo(function(){if(P&&P.times<mae){if(!e.current){A(function(Ue){return Je({},Ue)});return}d();var D=P.targetAlign,k=P.originAlign,B=P.index,N=P.offset,j=e.current.clientHeight,V=!1,K=D,Y=null;if(j){for(var Z=D||k,te=0,ne=0,se=0,ee=Math.min(t.length-1,B),de=0;de<=ee;de+=1){var fe=s(t[de]);ne=te;var ye=n.get(fe);se=ne+(ye===void 0?i:ye),te=se}for(var ge=Z==="top"?N:j-N,we=ee;we>=0;we-=1){var Se=s(t[we]),xe=n.get(Se);if(xe===void 0){V=!0;break}if(ge-=xe,ge<=0)break}switch(Z){case"top":Y=ne-N;break;case"bottom":Y=se-j+N;break;default:{var Te=e.current.scrollTop,ze=Te+j;ne<Te?K="top":se>ze&&(K="bottom")}}Y!==null&&f(Y),Y!==P.lastTop&&(V=!0)}V&&A(Je(Je({},P),{},{times:P.times+1,targetAlign:K,lastTop:Y}))}},[P,e.current]),function(D){if(D==null){o();return}if(Qi.cancel(y.current),typeof D=="number")f(D);else if(D&&Nr(D)==="object"){var k,B=D.align;"index"in D?k=D.index:k=t.findIndex(function(V){return s(V)===D.key});var N=D.offset,j=N===void 0?0:N;A({times:0,index:k,offset:j,originAlign:B})}}}var FB=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.rtl,s=e.scrollOffset,d=e.scrollRange,f=e.onStartMove,o=e.onStopMove,y=e.onScroll,b=e.horizontal,C=e.spinSize,P=e.containerSize,A=e.style,D=e.thumbStyle,k=e.showScrollBar,B=I.useState(!1),N=It(B,2),j=N[0],V=N[1],K=I.useState(null),Y=It(K,2),Z=Y[0],te=Y[1],ne=I.useState(null),se=It(ne,2),ee=se[0],de=se[1],fe=!i,ye=I.useRef(),ge=I.useRef(),we=I.useState(k),Se=It(we,2),xe=Se[0],Te=Se[1],ze=I.useRef(),Ue=function(){k===!0||k===!1||(clearTimeout(ze.current),Te(!0),ze.current=setTimeout(function(){Te(!1)},3e3))},We=d-P||0,Be=P-C||0,Xe=I.useMemo(function(){if(s===0||We===0)return 0;var Rt=s/We;return Rt*Be},[s,We,Be]),qe=function(pt){pt.stopPropagation(),pt.preventDefault()},at=I.useRef({top:Xe,dragging:j,pageY:Z,startTop:ee});at.current={top:Xe,dragging:j,pageY:Z,startTop:ee};var Ke=function(pt){V(!0),te(CR(pt,b)),de(at.current.top),f(),pt.stopPropagation(),pt.preventDefault()};I.useEffect(function(){var Rt=function(bt){bt.preventDefault()},pt=ye.current,yt=ge.current;return pt.addEventListener("touchstart",Rt,{passive:!1}),yt.addEventListener("touchstart",Ke,{passive:!1}),function(){pt.removeEventListener("touchstart",Rt),yt.removeEventListener("touchstart",Ke)}},[]);var tt=I.useRef();tt.current=We;var vt=I.useRef();vt.current=Be,I.useEffect(function(){if(j){var Rt,pt=function(bt){var Ct=at.current,tn=Ct.dragging,Zt=Ct.pageY,In=Ct.startTop;Qi.cancel(Rt);var Cn=ye.current.getBoundingClientRect(),Mt=P/(b?Cn.width:Cn.height);if(tn){var hn=(CR(bt,b)-Zt)*Mt,Jt=In;!fe&&b?Jt-=hn:Jt+=hn;var Ut=tt.current,Tn=vt.current,On=Tn?Jt/Tn:0,Kn=Math.ceil(On*Ut);Kn=Math.max(Kn,0),Kn=Math.min(Kn,Ut),Rt=Qi(function(){y(Kn,b)})}},yt=function(){V(!1),o()};return window.addEventListener("mousemove",pt,{passive:!0}),window.addEventListener("touchmove",pt,{passive:!0}),window.addEventListener("mouseup",yt,{passive:!0}),window.addEventListener("touchend",yt,{passive:!0}),function(){window.removeEventListener("mousemove",pt),window.removeEventListener("touchmove",pt),window.removeEventListener("mouseup",yt),window.removeEventListener("touchend",yt),Qi.cancel(Rt)}}},[j]),I.useEffect(function(){return Ue(),function(){clearTimeout(ze.current)}},[s]),I.useImperativeHandle(t,function(){return{delayHidden:Ue}});var Pt="".concat(n,"-scrollbar"),ft={position:"absolute",visibility:xe?null:"hidden"},Nt={position:"absolute",borderRadius:99,background:"var(--rc-virtual-list-scrollbar-bg, rgba(0, 0, 0, 0.5))",cursor:"pointer",userSelect:"none"};return b?(Object.assign(ft,{height:8,left:0,right:0,bottom:0}),Object.assign(Nt,ke({height:"100%",width:C},fe?"left":"right",Xe))):(Object.assign(ft,ke({width:8,top:0,bottom:0},fe?"right":"left",0)),Object.assign(Nt,{width:"100%",height:C,top:Xe})),I.createElement("div",{ref:ye,className:St(Pt,ke(ke(ke({},"".concat(Pt,"-horizontal"),b),"".concat(Pt,"-vertical"),!b),"".concat(Pt,"-visible"),xe)),style:Je(Je({},ft),A),onMouseDown:qe,onMouseMove:Ue},I.createElement("div",{ref:ge,className:St("".concat(Pt,"-thumb"),ke({},"".concat(Pt,"-thumb-moving"),j)),style:Je(Je({},Nt),D),onMouseDown:Ke}))}),vae=20;function NB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=e/t*e;return isNaN(n)&&(n=0),n=Math.max(n,vae),Math.floor(n)}var _ae=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles","showScrollBar"],yae=[],xae={overflowY:"auto",overflowAnchor:"none"};function bae(e,t){var n=e.prefixCls,i=n===void 0?"rc-virtual-list":n,s=e.className,d=e.height,f=e.itemHeight,o=e.fullHeight,y=o===void 0?!0:o,b=e.style,C=e.data,P=e.children,A=e.itemKey,D=e.virtual,k=e.direction,B=e.scrollWidth,N=e.component,j=N===void 0?"div":N,V=e.onScroll,K=e.onVirtualScroll,Y=e.onVisibleChange,Z=e.innerProps,te=e.extraRender,ne=e.styles,se=e.showScrollBar,ee=se===void 0?"optional":se,de=ri(e,_ae),fe=I.useCallback(function(it){return typeof A=="function"?A(it):it==null?void 0:it[A]},[A]),ye=hae(fe),ge=It(ye,4),we=ge[0],Se=ge[1],xe=ge[2],Te=ge[3],ze=!!(D!==!1&&d&&f),Ue=I.useMemo(function(){return Object.values(xe.maps).reduce(function(it,$t){return it+$t},0)},[xe.id,xe.maps]),We=ze&&C&&(Math.max(f*C.length,Ue)>d||!!B),Be=k==="rtl",Xe=St(i,ke({},"".concat(i,"-rtl"),Be),s),qe=C||yae,at=I.useRef(),Ke=I.useRef(),tt=I.useRef(),vt=I.useState(0),Pt=It(vt,2),ft=Pt[0],Nt=Pt[1],Rt=I.useState(0),pt=It(Rt,2),yt=pt[0],xt=pt[1],bt=I.useState(!1),Ct=It(bt,2),tn=Ct[0],Zt=Ct[1],In=function(){Zt(!0)},Cn=function(){Zt(!1)},Mt={getKey:fe};function hn(it){Nt(function($t){var Qt;typeof it=="function"?Qt=it($t):Qt=it;var Ft=Vr(Qt);return at.current.scrollTop=Ft,Ft})}var Jt=I.useRef({start:0,end:qe.length}),Ut=I.useRef(),Tn=lae(qe,fe),On=It(Tn,1),Kn=On[0];Ut.current=Kn;var Un=I.useMemo(function(){if(!ze)return{scrollHeight:void 0,start:0,end:qe.length-1,offset:void 0};if(!We){var it;return{scrollHeight:((it=Ke.current)===null||it===void 0?void 0:it.offsetHeight)||0,start:0,end:qe.length-1,offset:void 0}}for(var $t=0,Qt,Ft,jt,rn=qe.length,yn=0;yn<rn;yn+=1){var rr=qe[yn],En=fe(rr),Zn=xe.get(En),ar=$t+(Zn===void 0?f:Zn);ar>=ft&&Qt===void 0&&(Qt=yn,Ft=$t),ar>ft+d&&jt===void 0&&(jt=yn),$t=ar}return Qt===void 0&&(Qt=0,Ft=0,jt=Math.ceil(d/f)),jt===void 0&&(jt=qe.length-1),jt=Math.min(jt+1,qe.length-1),{scrollHeight:$t,start:Qt,end:jt,offset:Ft}},[We,ze,ft,qe,Te,d]),Pn=Un.scrollHeight,Qn=Un.start,un=Un.end,nn=Un.offset;Jt.current.start=Qn,Jt.current.end=un,I.useLayoutEffect(function(){var it=xe.getRecord();if(it.size===1){var $t=Array.from(it.keys())[0],Qt=it.get($t),Ft=qe[Qn];if(Ft&&Qt===void 0){var jt=fe(Ft);if(jt===$t){var rn=xe.get($t),yn=rn-f;hn(function(rr){return rr+yn})}}}xe.resetRecord()},[Pn]);var $n=I.useState({width:0,height:d}),Ln=It($n,2),qn=Ln[0],er=Ln[1],tr=function($t){er({width:$t.offsetWidth,height:$t.offsetHeight})},Jn=I.useRef(),Ir=I.useRef(),_r=I.useMemo(function(){return NB(qn.width,B)},[qn.width,B]),$r=I.useMemo(function(){return NB(qn.height,Pn)},[qn.height,Pn]),mr=Pn-d,yi=I.useRef(mr);yi.current=mr;function Vr(it){var $t=it;return Number.isNaN(yi.current)||($t=Math.min($t,yi.current)),$t=Math.max($t,0),$t}var Kr=ft<=0,Rr=ft>=mr,ii=yt<=0,Hr=yt>=B,ut=yH(Kr,Rr,ii,Hr),ur=function(){return{x:Be?-yt:yt,y:ft}},fr=I.useRef(ur()),Fn=Io(function(it){if(K){var $t=Je(Je({},ur()),it);(fr.current.x!==$t.x||fr.current.y!==$t.y)&&(K($t),fr.current=$t)}});function Gt(it,$t){var Qt=it;$t?(ku.flushSync(function(){xt(Qt)}),Fn()):hn(Qt)}function mn(it){var $t=it.currentTarget.scrollTop;$t!==ft&&hn($t),V==null||V(it),Fn()}var Xn=function($t){var Qt=$t,Ft=B?B-qn.width:0;return Qt=Math.max(Qt,0),Qt=Math.min(Qt,Ft),Qt},gr=Io(function(it,$t){$t?(ku.flushSync(function(){xt(function(Qt){var Ft=Qt+(Be?-it:it);return Xn(Ft)})}),Fn()):hn(function(Qt){var Ft=Qt+it;return Ft})}),je=cae(ze,Kr,Rr,ii,Hr,!!B,gr),re=It(je,2),ie=re[0],_e=re[1];fae(ze,at,function(it,$t,Qt,Ft){var jt=Ft;return ut(it,$t,Qt)?!1:!jt||!jt._virtualHandled?(jt&&(jt._virtualHandled=!0),ie({preventDefault:function(){},deltaX:it?$t:0,deltaY:it?0:$t}),!0):!1}),pae(We,at,function(it){hn(function($t){return $t+it})}),yo(function(){function it(Qt){var Ft=Kr&&Qt.detail<0,jt=Rr&&Qt.detail>0;ze&&!Ft&&!jt&&Qt.preventDefault()}var $t=at.current;return $t.addEventListener("wheel",ie,{passive:!1}),$t.addEventListener("DOMMouseScroll",_e,{passive:!0}),$t.addEventListener("MozMousePixelScroll",it,{passive:!1}),function(){$t.removeEventListener("wheel",ie),$t.removeEventListener("DOMMouseScroll",_e),$t.removeEventListener("MozMousePixelScroll",it)}},[ze,Kr,Rr]),yo(function(){if(B){var it=Xn(yt);xt(it),Fn({x:it})}},[qn.width,B]);var Re=function(){var $t,Qt;($t=Jn.current)===null||$t===void 0||$t.delayHidden(),(Qt=Ir.current)===null||Qt===void 0||Qt.delayHidden()},De=gae(at,qe,xe,f,fe,function(){return Se(!0)},hn,Re);I.useImperativeHandle(t,function(){return{nativeElement:tt.current,getScrollInfo:ur,scrollTo:function($t){function Qt(Ft){return Ft&&Nr(Ft)==="object"&&("left"in Ft||"top"in Ft)}Qt($t)?($t.left!==void 0&&xt(Xn($t.left)),De($t.top)):De($t)}}}),yo(function(){if(Y){var it=qe.slice(Qn,un+1);Y(it,qe)}},[Qn,un,qe]);var Ge=uae(qe,fe,xe,f),ot=te==null?void 0:te({start:Qn,end:un,virtual:We,offsetX:yt,offsetY:nn,rtl:Be,getSize:Ge}),Ye=aae(qe,Qn,un,B,yt,we,P,Mt),rt=null;d&&(rt=Je(ke({},y?"height":"maxHeight",d),xae),ze&&(rt.overflowY="hidden",B&&(rt.overflowX="hidden"),tn&&(rt.pointerEvents="none")));var zt={};return Be&&(zt.dir="rtl"),I.createElement("div",kn({ref:tt,style:Je(Je({},b),{},{position:"relative"}),className:Xe},zt,de),I.createElement(Wl,{onResize:tr},I.createElement(j,{className:"".concat(i,"-holder"),style:rt,ref:at,onScroll:mn,onMouseEnter:Re},I.createElement(_H,{prefixCls:i,height:Pn,offsetX:yt,offsetY:nn,scrollWidth:B,onInnerResize:Se,ref:Ke,innerProps:Z,rtl:Be,extra:ot},Ye))),We&&Pn>d&&I.createElement(FB,{ref:Jn,prefixCls:i,scrollOffset:ft,scrollRange:Pn,rtl:Be,onScroll:Gt,onStartMove:In,onStopMove:Cn,spinSize:$r,containerSize:qn.height,style:ne==null?void 0:ne.verticalScrollBar,thumbStyle:ne==null?void 0:ne.verticalScrollBarThumb,showScrollBar:ee}),We&&B>qn.width&&I.createElement(FB,{ref:Ir,prefixCls:i,scrollOffset:yt,scrollRange:B,rtl:Be,onScroll:Gt,onStartMove:In,onStopMove:Cn,spinSize:_r,containerSize:qn.width,horizontal:!0,style:ne==null?void 0:ne.horizontalScrollBar,thumbStyle:ne==null?void 0:ne.horizontalScrollBarThumb,showScrollBar:ee}))}var EE=I.forwardRef(bae);EE.displayName="List";function wae(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var Sae=["disabled","title","children","style","className"];function BB(e){return typeof e=="string"||typeof e=="number"}var Cae=function(t,n){var i=loe(),s=i.prefixCls,d=i.id,f=i.open,o=i.multiple,y=i.mode,b=i.searchValue,C=i.toggleOpen,P=i.notFoundContent,A=i.onPopupScroll,D=I.useContext(BO),k=D.maxCount,B=D.flattenOptions,N=D.onActiveValue,j=D.defaultActiveFirstOption,V=D.onSelect,K=D.menuItemSelectedIcon,Y=D.rawValues,Z=D.fieldNames,te=D.virtual,ne=D.direction,se=D.listHeight,ee=D.listItemHeight,de=D.optionRender,fe="".concat(s,"-item"),ye=nm(function(){return B},[f,B],function(Rt,pt){return pt[0]&&Rt[1]!==pt[1]}),ge=I.useRef(null),we=I.useMemo(function(){return o&&bR(k)&&(Y==null?void 0:Y.size)>=k},[o,k,Y==null?void 0:Y.size]),Se=function(pt){pt.preventDefault()},xe=function(pt){var yt;(yt=ge.current)===null||yt===void 0||yt.scrollTo(typeof pt=="number"?{index:pt}:pt)},Te=I.useCallback(function(Rt){return y==="combobox"?!1:Y.has(Rt)},[y,zn(Y).toString(),Y.size]),ze=function(pt){for(var yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,xt=ye.length,bt=0;bt<xt;bt+=1){var Ct=(pt+bt*yt+xt)%xt,tn=ye[Ct]||{},Zt=tn.group,In=tn.data;if(!Zt&&!(In!=null&&In.disabled)&&(Te(In.value)||!we))return Ct}return-1},Ue=I.useState(function(){return ze(0)}),We=It(Ue,2),Be=We[0],Xe=We[1],qe=function(pt){var yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;Xe(pt);var xt={source:yt?"keyboard":"mouse"},bt=ye[pt];if(!bt){N(null,-1,xt);return}N(bt.value,pt,xt)};I.useEffect(function(){qe(j!==!1?ze(0):-1)},[ye.length,b]);var at=I.useCallback(function(Rt){return y==="combobox"?String(Rt).toLowerCase()===b.toLowerCase():Y.has(Rt)},[y,b,zn(Y).toString(),Y.size]);I.useEffect(function(){var Rt=setTimeout(function(){if(!o&&f&&Y.size===1){var yt=Array.from(Y)[0],xt=ye.findIndex(function(bt){var Ct=bt.data;return b?String(Ct.value).startsWith(b):Ct.value===yt});xt!==-1&&(qe(xt),xe(xt))}});if(f){var pt;(pt=ge.current)===null||pt===void 0||pt.scrollTo(void 0)}return function(){return clearTimeout(Rt)}},[f,b]);var Ke=function(pt){pt!==void 0&&V(pt,{selected:!Y.has(pt)}),o||C(!1)};if(I.useImperativeHandle(n,function(){return{onKeyDown:function(pt){var yt=pt.which,xt=pt.ctrlKey;switch(yt){case ir.N:case ir.P:case ir.UP:case ir.DOWN:{var bt=0;if(yt===ir.UP?bt=-1:yt===ir.DOWN?bt=1:wae()&&xt&&(yt===ir.N?bt=1:yt===ir.P&&(bt=-1)),bt!==0){var Ct=ze(Be+bt,bt);xe(Ct),qe(Ct,!0)}break}case ir.TAB:case ir.ENTER:{var tn,Zt=ye[Be];Zt&&!(Zt!=null&&(tn=Zt.data)!==null&&tn!==void 0&&tn.disabled)&&!we?Ke(Zt.value):Ke(void 0),f&&pt.preventDefault();break}case ir.ESC:C(!1),f&&pt.stopPropagation()}},onKeyUp:function(){},scrollTo:function(pt){xe(pt)}}}),ye.length===0)return I.createElement("div",{role:"listbox",id:"".concat(d,"_list"),className:"".concat(fe,"-empty"),onMouseDown:Se},P);var tt=Object.keys(Z).map(function(Rt){return Z[Rt]}),vt=function(pt){return pt.label};function Pt(Rt,pt){var yt=Rt.group;return{role:yt?"presentation":"option",id:"".concat(d,"_list_").concat(pt)}}var ft=function(pt){var yt=ye[pt];if(!yt)return null;var xt=yt.data||{},bt=xt.value,Ct=yt.group,tn=Jc(xt,!0),Zt=vt(yt);return yt?I.createElement("div",kn({"aria-label":typeof Zt=="string"&&!Ct?Zt:null},tn,{key:pt},Pt(yt,pt),{"aria-selected":at(bt)}),bt):null},Nt={role:"listbox",id:"".concat(d,"_list")};return I.createElement(I.Fragment,null,te&&I.createElement("div",kn({},Nt,{style:{height:0,width:0,overflow:"hidden"}}),ft(Be-1),ft(Be),ft(Be+1)),I.createElement(EE,{itemKey:"key",ref:ge,data:ye,height:se,itemHeight:ee,fullHeight:!1,onMouseDown:Se,onScroll:A,virtual:te,direction:ne,innerProps:te?null:Nt},function(Rt,pt){var yt=Rt.group,xt=Rt.groupOption,bt=Rt.data,Ct=Rt.label,tn=Rt.value,Zt=bt.key;if(yt){var In,Cn=(In=bt.title)!==null&&In!==void 0?In:BB(Ct)?Ct.toString():void 0;return I.createElement("div",{className:St(fe,"".concat(fe,"-group"),bt.className),title:Cn},Ct!==void 0?Ct:Zt)}var Mt=bt.disabled,hn=bt.title;bt.children;var Jt=bt.style,Ut=bt.className,Tn=ri(bt,Sae),On=as(Tn,tt),Kn=Te(tn),Un=Mt||!Kn&&we,Pn="".concat(fe,"-option"),Qn=St(fe,Pn,Ut,ke(ke(ke(ke({},"".concat(Pn,"-grouped"),xt),"".concat(Pn,"-active"),Be===pt&&!Un),"".concat(Pn,"-disabled"),Un),"".concat(Pn,"-selected"),Kn)),un=vt(Rt),nn=!K||typeof K=="function"||Kn,$n=typeof un=="number"?un:un||tn,Ln=BB($n)?$n.toString():void 0;return hn!==void 0&&(Ln=hn),I.createElement("div",kn({},Jc(On),te?{}:Pt(Rt,pt),{"aria-selected":at(tn),className:Qn,title:Ln,onMouseMove:function(){Be===pt||Un||qe(pt)},onClick:function(){Un||Ke(tn)},style:Jt}),I.createElement("div",{className:"".concat(Pn,"-content")},typeof de=="function"?de(Rt,{index:pt}):$n),I.isValidElement(K)||Kn,nn&&I.createElement(SE,{className:"".concat(fe,"-option-state"),customizeIcon:K,customizeIconProps:{value:tn,disabled:Un,isSelected:Kn}},Kn?"":null))}))},Eae=I.forwardRef(Cae);const Tae=function(e,t){var n=I.useRef({values:new Map,options:new Map}),i=I.useMemo(function(){var d=n.current,f=d.values,o=d.options,y=e.map(function(P){if(P.label===void 0){var A;return Je(Je({},P),{},{label:(A=f.get(P.value))===null||A===void 0?void 0:A.label})}return P}),b=new Map,C=new Map;return y.forEach(function(P){b.set(P.value,P),C.set(P.value,t.get(P.value)||o.get(P.value))}),n.current.values=b,n.current.options=C,y},[e,t]),s=I.useCallback(function(d){return t.get(d)||n.current.options.get(d)},[t]);return[i,s]};function eP(e,t){return mH(e).join("").toUpperCase().includes(t)}const Iae=function(e,t,n,i,s){return I.useMemo(function(){if(!n||i===!1)return e;var d=t.options,f=t.label,o=t.value,y=[],b=typeof i=="function",C=n.toUpperCase(),P=b?i:function(D,k){return s?eP(k[s],C):k[d]?eP(k[f!=="children"?f:"label"],C):eP(k[o],C)},A=b?function(D){return wR(D)}:function(D){return D};return e.forEach(function(D){if(D[d]){var k=P(n,A(D));if(k)y.push(D);else{var B=D[d].filter(function(N){return P(n,A(N))});B.length&&y.push(Je(Je({},D),{},ke({},d,B)))}return}P(n,A(D))&&y.push(D)}),y},[e,i,s,n,t])};var $B=0,Pae=Bs();function Mae(){var e;return Pae?(e=$B,$B+=1):e="TEST_OR_SSR",e}function Rae(e){var t=I.useState(),n=It(t,2),i=n[0],s=n[1];return I.useEffect(function(){s("rc_select_".concat(Mae()))},[]),e||i}var Aae=["children","value"],Oae=["children"];function Dae(e){var t=e,n=t.key,i=t.props,s=i.children,d=i.value,f=ri(i,Aae);return Je({key:n,value:d!==void 0?d:n,children:s},f)}function xH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return vc(e).map(function(n,i){if(!I.isValidElement(n)||!n.type)return null;var s=n,d=s.type.isSelectOptGroup,f=s.key,o=s.props,y=o.children,b=ri(o,Oae);return t||!d?Dae(n):Je(Je({key:"__RC_SELECT_GRP__".concat(f===null?i:f,"__"),label:f},b),{},{options:xH(y)})}).filter(function(n){return n})}var Lae=function(t,n,i,s,d){return I.useMemo(function(){var f=t,o=!t;o&&(f=xH(n));var y=new Map,b=new Map,C=function(D,k,B){B&&typeof B=="string"&&D.set(k[B],k)},P=function A(D){for(var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,B=0;B<D.length;B+=1){var N=D[B];!N[i.options]||k?(y.set(N[i.value],N),C(b,N,i.label),C(b,N,s),C(b,N,d)):A(N[i.options],!0)}};return P(f),{options:f,valueOptions:y,labelOptions:b}},[t,n,i,s,d])};function jB(e){var t=I.useRef();t.current=e;var n=I.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}var zae=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","labelRender","value","defaultValue","labelInValue","onChange","maxCount"],kae=["inputValue"];function Fae(e){return!e||Nr(e)!=="object"}var Nae=I.forwardRef(function(e,t){var n=e.id,i=e.mode,s=e.prefixCls,d=s===void 0?"rc-select":s,f=e.backfill,o=e.fieldNames,y=e.inputValue,b=e.searchValue,C=e.onSearch,P=e.autoClearSearchValue,A=P===void 0?!0:P,D=e.onSelect,k=e.onDeselect,B=e.dropdownMatchSelectWidth,N=B===void 0?!0:B,j=e.filterOption,V=e.filterSort,K=e.optionFilterProp,Y=e.optionLabelProp,Z=e.options,te=e.optionRender,ne=e.children,se=e.defaultActiveFirstOption,ee=e.menuItemSelectedIcon,de=e.virtual,fe=e.direction,ye=e.listHeight,ge=ye===void 0?200:ye,we=e.listItemHeight,Se=we===void 0?20:we,xe=e.labelRender,Te=e.value,ze=e.defaultValue,Ue=e.labelInValue,We=e.onChange,Be=e.maxCount,Xe=ri(e,zae),qe=Rae(n),at=SR(i),Ke=!!(!Z&&ne),tt=I.useMemo(function(){return j===void 0&&i==="combobox"?!1:j},[j,i]),vt=I.useMemo(function(){return vH(o,Ke)},[JSON.stringify(o),Ke]),Pt=is("",{value:b!==void 0?b:y,postState:function(Gt){return Gt||""}}),ft=It(Pt,2),Nt=ft[0],Rt=ft[1],pt=Lae(Z,ne,vt,K,Y),yt=pt.valueOptions,xt=pt.labelOptions,bt=pt.options,Ct=I.useCallback(function(Fn){var Gt=mH(Fn);return Gt.map(function(mn){var Xn,gr,je,re,ie;if(Fae(mn))Xn=mn;else{var _e;je=mn.key,gr=mn.label,Xn=(_e=mn.value)!==null&&_e!==void 0?_e:je}var Re=yt.get(Xn);if(Re){var De;gr===void 0&&(gr=Re==null?void 0:Re[Y||vt.label]),je===void 0&&(je=(De=Re==null?void 0:Re.key)!==null&&De!==void 0?De:Xn),re=Re==null?void 0:Re.disabled,ie=Re==null?void 0:Re.title}return{label:gr,value:Xn,key:je,disabled:re,title:ie}})},[vt,Y,yt]),tn=is(ze,{value:Te}),Zt=It(tn,2),In=Zt[0],Cn=Zt[1],Mt=I.useMemo(function(){var Fn,Gt=at&&In===null?[]:In,mn=Ct(Gt);return i==="combobox"&&Moe((Fn=mn[0])===null||Fn===void 0?void 0:Fn.value)?[]:mn},[In,Ct,i,at]),hn=Tae(Mt,yt),Jt=It(hn,2),Ut=Jt[0],Tn=Jt[1],On=I.useMemo(function(){if(!i&&Ut.length===1){var Fn=Ut[0];if(Fn.value===null&&(Fn.label===null||Fn.label===void 0))return[]}return Ut.map(function(Gt){var mn;return Je(Je({},Gt),{},{label:(mn=typeof xe=="function"?xe(Gt):Gt.label)!==null&&mn!==void 0?mn:Gt.value})})},[i,Ut,xe]),Kn=I.useMemo(function(){return new Set(Ut.map(function(Fn){return Fn.value}))},[Ut]);I.useEffect(function(){if(i==="combobox"){var Fn,Gt=(Fn=Ut[0])===null||Fn===void 0?void 0:Fn.value;Rt(Poe(Gt)?String(Gt):"")}},[Ut]);var Un=jB(function(Fn,Gt){var mn=Gt??Fn;return ke(ke({},vt.value,Fn),vt.label,mn)}),Pn=I.useMemo(function(){if(i!=="tags")return bt;var Fn=zn(bt),Gt=function(Xn){return yt.has(Xn)};return zn(Ut).sort(function(mn,Xn){return mn.value<Xn.value?-1:1}).forEach(function(mn){var Xn=mn.value;Gt(Xn)||Fn.push(Un(Xn,mn.label))}),Fn},[Un,bt,yt,Ut,i]),Qn=Iae(Pn,vt,Nt,tt,K),un=I.useMemo(function(){return i!=="tags"||!Nt||Qn.some(function(Fn){return Fn[K||"value"]===Nt})||Qn.some(function(Fn){return Fn[vt.value]===Nt})?Qn:[Un(Nt)].concat(zn(Qn))},[Un,K,i,Qn,Nt,vt]),nn=function Fn(Gt){var mn=zn(Gt).sort(function(Xn,gr){return V(Xn,gr,{searchValue:Nt})});return mn.map(function(Xn){return Array.isArray(Xn.options)?Je(Je({},Xn),{},{options:Xn.options.length>0?Fn(Xn.options):Xn.options}):Xn})},$n=I.useMemo(function(){return V?nn(un):un},[un,V,Nt]),Ln=I.useMemo(function(){return Qoe($n,{fieldNames:vt,childrenAsData:Ke})},[$n,vt,Ke]),qn=function(Gt){var mn=Ct(Gt);if(Cn(mn),We&&(mn.length!==Ut.length||mn.some(function(je,re){var ie;return((ie=Ut[re])===null||ie===void 0?void 0:ie.value)!==(je==null?void 0:je.value)}))){var Xn=Ue?mn:mn.map(function(je){return je.value}),gr=mn.map(function(je){return wR(Tn(je.value))});We(at?Xn:Xn[0],at?gr:gr[0])}},er=I.useState(null),tr=It(er,2),Jn=tr[0],Ir=tr[1],_r=I.useState(0),$r=It(_r,2),mr=$r[0],yi=$r[1],Vr=se!==void 0?se:i!=="combobox",Kr=I.useCallback(function(Fn,Gt){var mn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Xn=mn.source,gr=Xn===void 0?"keyboard":Xn;yi(Gt),f&&i==="combobox"&&Fn!==null&&gr==="keyboard"&&Ir(String(Fn))},[f,i]),Rr=function(Gt,mn,Xn){var gr=function(){var rt,zt=Tn(Gt);return[Ue?{label:zt==null?void 0:zt[vt.label],value:Gt,key:(rt=zt==null?void 0:zt.key)!==null&&rt!==void 0?rt:Gt}:Gt,wR(zt)]};if(mn&&D){var je=gr(),re=It(je,2),ie=re[0],_e=re[1];D(ie,_e)}else if(!mn&&k&&Xn!=="clear"){var Re=gr(),De=It(Re,2),Ge=De[0],ot=De[1];k(Ge,ot)}},ii=jB(function(Fn,Gt){var mn,Xn=at?Gt.selected:!0;Xn?mn=at?[].concat(zn(Ut),[Fn]):[Fn]:mn=Ut.filter(function(gr){return gr.value!==Fn}),qn(mn),Rr(Fn,Xn),i==="combobox"?Ir(""):(!SR||A)&&(Rt(""),Ir(""))}),Hr=function(Gt,mn){qn(Gt);var Xn=mn.type,gr=mn.values;(Xn==="remove"||Xn==="clear")&&gr.forEach(function(je){Rr(je.value,!1,Xn)})},ut=function(Gt,mn){if(Rt(Gt),Ir(null),mn.source==="submit"){var Xn=(Gt||"").trim();if(Xn){var gr=Array.from(new Set([].concat(zn(Kn),[Xn])));qn(gr),Rr(Xn,!0),Rt("")}return}mn.source!=="blur"&&(i==="combobox"&&qn(Gt),C==null||C(Gt))},ur=function(Gt){var mn=Gt;i!=="tags"&&(mn=Gt.map(function(gr){var je=xt.get(gr);return je==null?void 0:je.value}).filter(function(gr){return gr!==void 0}));var Xn=Array.from(new Set([].concat(zn(Kn),zn(mn))));qn(Xn),Xn.forEach(function(gr){Rr(gr,!0)})},fr=I.useMemo(function(){var Fn=de!==!1&&N!==!1;return Je(Je({},pt),{},{flattenOptions:Ln,onActiveValue:Kr,defaultActiveFirstOption:Vr,onSelect:ii,menuItemSelectedIcon:ee,rawValues:Kn,fieldNames:vt,virtual:Fn,direction:fe,listHeight:ge,listItemHeight:Se,childrenAsData:Ke,maxCount:Be,optionRender:te})},[Be,pt,Ln,Kr,Vr,ii,ee,Kn,vt,de,N,fe,ge,Se,Ke,te]);return I.createElement(BO.Provider,{value:fr},I.createElement(iae,kn({},Xe,{id:qe,prefixCls:d,ref:t,omitDomProps:kae,mode:i,displayValues:On,onDisplayValuesChange:Hr,direction:fe,searchValue:Nt,onSearch:ut,autoClearSearchValue:A,onSearchSplit:ur,dropdownMatchSelectWidth:N,OptionList:Eae,emptyOptions:!Ln.length,activeValue:Jn,activeDescendantId:"".concat(qe,"_list_").concat(mr)})))}),VO=Nae;VO.Option=jO;VO.OptGroup=$O;function ER(e,t,n){return St({[`${e}-status-success`]:t==="success",[`${e}-status-warning`]:t==="warning",[`${e}-status-error`]:t==="error",[`${e}-status-validating`]:t==="validating",[`${e}-has-feedback`]:n})}const bH=(e,t)=>t||e,Bae=()=>{const[,e]=Vs(),[t]=tb("Empty"),i=new no(e.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return I.createElement("svg",{style:i,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},I.createElement("title",null,(t==null?void 0:t.description)||"Empty"),I.createElement("g",{fill:"none",fillRule:"evenodd"},I.createElement("g",{transform:"translate(24 31.67)"},I.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),I.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),I.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),I.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),I.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),I.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),I.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},I.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),I.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},$ae=()=>{const[,e]=Vs(),[t]=tb("Empty"),{colorFill:n,colorFillTertiary:i,colorFillQuaternary:s,colorBgContainer:d}=e,{borderColor:f,shadowColor:o,contentColor:y}=I.useMemo(()=>({borderColor:new no(n).onBackground(d).toHexString(),shadowColor:new no(i).onBackground(d).toHexString(),contentColor:new no(s).onBackground(d).toHexString()}),[n,i,s,d]);return I.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},I.createElement("title",null,(t==null?void 0:t.description)||"Empty"),I.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},I.createElement("ellipse",{fill:o,cx:"32",cy:"33",rx:"32",ry:"7"}),I.createElement("g",{fillRule:"nonzero",stroke:f},I.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),I.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:y}))))},jae=e=>{const{componentCls:t,margin:n,marginXS:i,marginXL:s,fontSize:d,lineHeight:f}=e;return{[t]:{marginInline:i,fontSize:d,lineHeight:f,textAlign:"center",[`${t}-image`]:{height:e.emptyImgHeight,marginBottom:i,opacity:e.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${t}-description`]:{color:e.colorTextDescription},[`${t}-footer`]:{marginTop:n},"&-normal":{marginBlock:s,color:e.colorTextDescription,[`${t}-description`]:{color:e.colorTextDescription},[`${t}-image`]:{height:e.emptyImgHeightMD}},"&-small":{marginBlock:i,color:e.colorTextDescription,[`${t}-image`]:{height:e.emptyImgHeightSM}}}}},Vae=za("Empty",e=>{const{componentCls:t,controlHeightLG:n,calc:i}=e,s=xo(e,{emptyImgCls:`${t}-img`,emptyImgHeight:i(n).mul(2.5).equal(),emptyImgHeightMD:n,emptyImgHeightSM:i(n).mul(.875).equal()});return jae(s)});var Uae=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const wH=I.createElement(Bae,null),SH=I.createElement($ae,null),Ed=e=>{var t;const{className:n,rootClassName:i,prefixCls:s,image:d,description:f,children:o,imageStyle:y,style:b,classNames:C,styles:P}=e,A=Uae(e,["className","rootClassName","prefixCls","image","description","children","imageStyle","style","classNames","styles"]),{getPrefixCls:D,direction:k,className:B,style:N,classNames:j,styles:V,image:K}=Gu("empty"),Y=D("empty",s),[Z,te,ne]=Vae(Y),[se]=tb("Empty"),ee=typeof f<"u"?f:se==null?void 0:se.description,de=typeof ee=="string"?ee:"empty",fe=(t=d??K)!==null&&t!==void 0?t:wH;let ye=null;return typeof fe=="string"?ye=I.createElement("img",{draggable:!1,alt:de,src:fe}):ye=fe,Z(I.createElement("div",Object.assign({className:St(te,ne,Y,B,{[`${Y}-normal`]:fe===SH,[`${Y}-rtl`]:k==="rtl"},n,i,j.root,C==null?void 0:C.root),style:Object.assign(Object.assign(Object.assign(Object.assign({},V.root),N),P==null?void 0:P.root),b)},A),I.createElement("div",{className:St(`${Y}-image`,j.image,C==null?void 0:C.image),style:Object.assign(Object.assign(Object.assign({},y),V.image),P==null?void 0:P.image)},ye),ee&&I.createElement("div",{className:St(`${Y}-description`,j.description,C==null?void 0:C.description),style:Object.assign(Object.assign({},V.description),P==null?void 0:P.description)},ee),o&&I.createElement("div",{className:St(`${Y}-footer`,j.footer,C==null?void 0:C.footer),style:Object.assign(Object.assign({},V.footer),P==null?void 0:P.footer)},o)))};Ed.PRESENTED_IMAGE_DEFAULT=wH;Ed.PRESENTED_IMAGE_SIMPLE=SH;const CH=e=>{const{componentName:t}=e,{getPrefixCls:n}=I.useContext(ji),i=n("empty");switch(t){case"Table":case"List":return Wt.createElement(Ed,{image:Ed.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return Wt.createElement(Ed,{image:Ed.PRESENTED_IMAGE_SIMPLE,className:`${i}-small`});case"Table.filter":return null;default:return Wt.createElement(Ed,null)}},UO=(e,t,n=void 0)=>{var i,s;const{variant:d,[e]:f}=I.useContext(ji),o=I.useContext(Tie),y=f==null?void 0:f.variant;let b;typeof t<"u"?b=t:n===!1?b="borderless":b=(s=(i=o??y)!==null&&i!==void 0?i:d)!==null&&s!==void 0?s:"outlined";const C=QQ.includes(b);return[b,C]},Hae=e=>{const n={overflow:{adjustX:!0,adjustY:!0,shiftY:!0},htmlRegion:e==="scroll"?"scroll":"visible",dynamicInset:!0};return{bottomLeft:Object.assign(Object.assign({},n),{points:["tl","bl"],offset:[0,4]}),bottomRight:Object.assign(Object.assign({},n),{points:["tr","br"],offset:[0,4]}),topLeft:Object.assign(Object.assign({},n),{points:["bl","tl"],offset:[0,-4]}),topRight:Object.assign(Object.assign({},n),{points:["br","tr"],offset:[0,-4]})}};function Gae(e,t){return e||Hae(t)}const VB=e=>{const{optionHeight:t,optionFontSize:n,optionLineHeight:i,optionPadding:s}=e;return{position:"relative",display:"block",minHeight:t,padding:s,color:e.colorText,fontWeight:"normal",fontSize:n,lineHeight:i,boxSizing:"border-box"}},Wae=e=>{const{antCls:t,componentCls:n}=e,i=`${n}-item`,s=`&${t}-slide-up-enter${t}-slide-up-enter-active`,d=`&${t}-slide-up-appear${t}-slide-up-appear-active`,f=`&${t}-slide-up-leave${t}-slide-up-leave-active`,o=`${n}-dropdown-placement-`,y=`${i}-option-selected`;return[{[`${n}-dropdown`]:Object.assign(Object.assign({},ya(e)),{position:"absolute",top:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",padding:e.paddingXXS,overflow:"hidden",fontSize:e.fontSize,fontVariant:"initial",backgroundColor:e.colorBgElevated,borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary,[`
          ${s}${o}bottomLeft,
          ${d}${o}bottomLeft
        `]:{animationName:MO},[`
          ${s}${o}topLeft,
          ${d}${o}topLeft,
          ${s}${o}topRight,
          ${d}${o}topRight
        `]:{animationName:AO},[`${f}${o}bottomLeft`]:{animationName:RO},[`
          ${f}${o}topLeft,
          ${f}${o}topRight
        `]:{animationName:OO},"&-hidden":{display:"none"},[i]:Object.assign(Object.assign({},VB(e)),{cursor:"pointer",transition:`background ${e.motionDurationSlow} ease`,borderRadius:e.borderRadiusSM,"&-group":{color:e.colorTextDescription,fontSize:e.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},df),"&-state":{flex:"none",display:"flex",alignItems:"center"},[`&-active:not(${i}-option-disabled)`]:{backgroundColor:e.optionActiveBg},[`&-selected:not(${i}-option-disabled)`]:{color:e.optionSelectedColor,fontWeight:e.optionSelectedFontWeight,backgroundColor:e.optionSelectedBg,[`${i}-option-state`]:{color:e.colorPrimary}},"&-disabled":{[`&${i}-option-selected`]:{backgroundColor:e.colorBgContainerDisabled},color:e.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:e.calc(e.controlPaddingHorizontal).mul(2).equal()}},"&-empty":Object.assign(Object.assign({},VB(e)),{color:e.colorTextDisabled})}),[`${y}:has(+ ${y})`]:{borderEndStartRadius:0,borderEndEndRadius:0,[`& + ${y}`]:{borderStartStartRadius:0,borderStartEndRadius:0}},"&-rtl":{direction:"rtl"}})},ff(e,"slide-up"),ff(e,"slide-down"),sC(e,"move-up"),sC(e,"move-down")]},qae=e=>{const{multipleSelectItemHeight:t,paddingXXS:n,lineWidth:i,INTERNAL_FIXED_ITEM_MARGIN:s}=e,d=e.max(e.calc(n).sub(i).equal(),0),f=e.max(e.calc(d).sub(s).equal(),0);return{basePadding:d,containerPadding:f,itemHeight:dt(t),itemLineHeight:dt(e.calc(t).sub(e.calc(e.lineWidth).mul(2)).equal())}},Kae=e=>{const{multipleSelectItemHeight:t,selectHeight:n,lineWidth:i}=e;return e.calc(n).sub(t).div(2).sub(i).equal()},Xae=e=>{const{componentCls:t,iconCls:n,borderRadiusSM:i,motionDurationSlow:s,paddingXS:d,multipleItemColorDisabled:f,multipleItemBorderColorDisabled:o,colorIcon:y,colorIconHover:b,INTERNAL_FIXED_ITEM_MARGIN:C}=e;return{[`${t}-selection-overflow`]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"calc(100% - 4px)",display:"inline-flex"},[`${t}-selection-item`]:{display:"flex",alignSelf:"center",flex:"none",boxSizing:"border-box",maxWidth:"100%",marginBlock:C,borderRadius:i,cursor:"default",transition:`font-size ${s}, line-height ${s}, height ${s}`,marginInlineEnd:e.calc(C).mul(2).equal(),paddingInlineStart:d,paddingInlineEnd:e.calc(d).div(2).equal(),[`${t}-disabled&`]:{color:f,borderColor:o,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:e.calc(d).div(2).equal(),overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},nb()),{display:"inline-flex",alignItems:"center",color:y,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${n}`]:{verticalAlign:"-0.2em"},"&:hover":{color:b}})}}}},Zae=(e,t)=>{const{componentCls:n,INTERNAL_FIXED_ITEM_MARGIN:i}=e,s=`${n}-selection-overflow`,d=e.multipleSelectItemHeight,f=Kae(e),o=t?`${n}-${t}`:"",y=qae(e);return{[`${n}-multiple${o}`]:Object.assign(Object.assign({},Xae(e)),{[`${n}-selector`]:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingInline:y.basePadding,paddingBlock:y.containerPadding,borderRadius:e.borderRadius,[`${n}-disabled&`]:{background:e.multipleSelectorBgDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${dt(i)} 0`,lineHeight:dt(d),visibility:"hidden",content:'"\\a0"'}},[`${n}-selection-item`]:{height:y.itemHeight,lineHeight:dt(y.itemLineHeight)},[`${n}-selection-wrap`]:{alignSelf:"flex-start","&:after":{lineHeight:dt(d),marginBlock:i}},[`${n}-prefix`]:{marginInlineStart:e.calc(e.inputPaddingHorizontalBase).sub(y.basePadding).equal()},[`${s}-item + ${s}-item,
        ${n}-prefix + ${n}-selection-wrap
      `]:{[`${n}-selection-search`]:{marginInlineStart:0},[`${n}-selection-placeholder`]:{insetInlineStart:0}},[`${s}-item-suffix`]:{minHeight:y.itemHeight,marginBlock:i},[`${n}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:e.calc(e.inputPaddingHorizontalBase).sub(f).equal(),"\n          &-input,\n          &-mirror\n        ":{height:d,fontFamily:e.fontFamily,lineHeight:dt(d),transition:`all ${e.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${n}-selection-placeholder`]:{position:"absolute",top:"50%",insetInlineStart:e.calc(e.inputPaddingHorizontalBase).sub(y.basePadding).equal(),insetInlineEnd:e.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${e.motionDurationSlow}`}})}};function tP(e,t){const{componentCls:n}=e,i=t?`${n}-${t}`:"",s={[`${n}-multiple${i}`]:{fontSize:e.fontSize,[`${n}-selector`]:{[`${n}-show-search&`]:{cursor:"text"}},[`
        &${n}-show-arrow ${n}-selector,
        &${n}-allow-clear ${n}-selector
      `]:{paddingInlineEnd:e.calc(e.fontSizeIcon).add(e.controlPaddingHorizontal).equal()}}};return[Zae(e,t),s]}const Yae=e=>{const{componentCls:t}=e,n=xo(e,{selectHeight:e.controlHeightSM,multipleSelectItemHeight:e.multipleItemHeightSM,borderRadius:e.borderRadiusSM,borderRadiusSM:e.borderRadiusXS}),i=xo(e,{fontSize:e.fontSizeLG,selectHeight:e.controlHeightLG,multipleSelectItemHeight:e.multipleItemHeightLG,borderRadius:e.borderRadiusLG,borderRadiusSM:e.borderRadius});return[tP(e),tP(n,"sm"),{[`${t}-multiple${t}-sm`]:{[`${t}-selection-placeholder`]:{insetInline:e.calc(e.controlPaddingHorizontalSM).sub(e.lineWidth).equal()},[`${t}-selection-search`]:{marginInlineStart:2}}},tP(i,"lg")]};function nP(e,t){const{componentCls:n,inputPaddingHorizontalBase:i,borderRadius:s}=e,d=e.calc(e.controlHeight).sub(e.calc(e.lineWidth).mul(2)).equal(),f=t?`${n}-${t}`:"";return{[`${n}-single${f}`]:{fontSize:e.fontSize,height:e.controlHeight,[`${n}-selector`]:Object.assign(Object.assign({},ya(e,!0)),{display:"flex",borderRadius:s,flex:"1 1 auto",[`${n}-selection-wrap:after`]:{lineHeight:dt(d)},[`${n}-selection-search`]:{position:"absolute",inset:0,width:"100%","&-input":{width:"100%",WebkitAppearance:"textfield"}},[`
          ${n}-selection-item,
          ${n}-selection-placeholder
        `]:{display:"block",padding:0,lineHeight:dt(d),transition:`all ${e.motionDurationSlow}, visibility 0s`,alignSelf:"center"},[`${n}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${n}-selection-item:empty:after`,`${n}-selection-placeholder:empty:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${n}-show-arrow ${n}-selection-item,
        &${n}-show-arrow ${n}-selection-search,
        &${n}-show-arrow ${n}-selection-placeholder
      `]:{paddingInlineEnd:e.showArrowPaddingInlineEnd},[`&${n}-open ${n}-selection-item`]:{color:e.colorTextPlaceholder},[`&:not(${n}-customize-input)`]:{[`${n}-selector`]:{width:"100%",height:"100%",alignItems:"center",padding:`0 ${dt(i)}`,[`${n}-selection-search-input`]:{height:d,fontSize:e.fontSize},"&:after":{lineHeight:dt(d)}}},[`&${n}-customize-input`]:{[`${n}-selector`]:{"&:after":{display:"none"},[`${n}-selection-search`]:{position:"static",width:"100%"},[`${n}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${dt(i)}`,"&:after":{display:"none"}}}}}}}function Jae(e){const{componentCls:t}=e,n=e.calc(e.controlPaddingHorizontalSM).sub(e.lineWidth).equal();return[nP(e),nP(xo(e,{controlHeight:e.controlHeightSM,borderRadius:e.borderRadiusSM}),"sm"),{[`${t}-single${t}-sm`]:{[`&:not(${t}-customize-input)`]:{[`${t}-selector`]:{padding:`0 ${dt(n)}`},[`&${t}-show-arrow ${t}-selection-search`]:{insetInlineEnd:e.calc(n).add(e.calc(e.fontSize).mul(1.5)).equal()},[`
            &${t}-show-arrow ${t}-selection-item,
            &${t}-show-arrow ${t}-selection-placeholder
          `]:{paddingInlineEnd:e.calc(e.fontSize).mul(1.5).equal()}}}},nP(xo(e,{controlHeight:e.singleItemHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG}),"lg")]}const Qae=e=>{const{fontSize:t,lineHeight:n,lineWidth:i,controlHeight:s,controlHeightSM:d,controlHeightLG:f,paddingXXS:o,controlPaddingHorizontal:y,zIndexPopupBase:b,colorText:C,fontWeightStrong:P,controlItemBgActive:A,controlItemBgHover:D,colorBgContainer:k,colorFillSecondary:B,colorBgContainerDisabled:N,colorTextDisabled:j,colorPrimaryHover:V,colorPrimary:K,controlOutline:Y}=e,Z=o*2,te=i*2,ne=Math.min(s-Z,s-te),se=Math.min(d-Z,d-te),ee=Math.min(f-Z,f-te);return{INTERNAL_FIXED_ITEM_MARGIN:Math.floor(o/2),zIndexPopup:b+50,optionSelectedColor:C,optionSelectedFontWeight:P,optionSelectedBg:A,optionActiveBg:D,optionPadding:`${(s-t*n)/2}px ${y}px`,optionFontSize:t,optionLineHeight:n,optionHeight:s,selectorBg:k,clearBg:k,singleItemHeightLG:f,multipleItemBg:B,multipleItemBorderColor:"transparent",multipleItemHeight:ne,multipleItemHeightSM:se,multipleItemHeightLG:ee,multipleSelectorBgDisabled:N,multipleItemColorDisabled:j,multipleItemBorderColorDisabled:"transparent",showArrowPaddingInlineEnd:Math.ceil(e.fontSize*1.25),hoverBorderColor:V,activeBorderColor:K,activeOutlineColor:Y,selectAffixPadding:o}},EH=(e,t)=>{const{componentCls:n,antCls:i,controlOutlineWidth:s}=e;return{[`&:not(${n}-customize-input) ${n}-selector`]:{border:`${dt(e.lineWidth)} ${e.lineType} ${t.borderColor}`,background:e.selectorBg},[`&:not(${n}-disabled):not(${n}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${n}-selector`]:{borderColor:t.hoverBorderHover},[`${n}-focused& ${n}-selector`]:{borderColor:t.activeBorderColor,boxShadow:`0 0 0 ${dt(s)} ${t.activeOutlineColor}`,outline:0},[`${n}-prefix`]:{color:t.color}}}},UB=(e,t)=>({[`&${e.componentCls}-status-${t.status}`]:Object.assign({},EH(e,t))}),ese=e=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign({},EH(e,{borderColor:e.colorBorder,hoverBorderHover:e.hoverBorderColor,activeBorderColor:e.activeBorderColor,activeOutlineColor:e.activeOutlineColor,color:e.colorText})),UB(e,{status:"error",borderColor:e.colorError,hoverBorderHover:e.colorErrorHover,activeBorderColor:e.colorError,activeOutlineColor:e.colorErrorOutline,color:e.colorError})),UB(e,{status:"warning",borderColor:e.colorWarning,hoverBorderHover:e.colorWarningHover,activeBorderColor:e.colorWarning,activeOutlineColor:e.colorWarningOutline,color:e.colorWarning})),{[`&${e.componentCls}-disabled`]:{[`&:not(${e.componentCls}-customize-input) ${e.componentCls}-selector`]:{background:e.colorBgContainerDisabled,color:e.colorTextDisabled}},[`&${e.componentCls}-multiple ${e.componentCls}-selection-item`]:{background:e.multipleItemBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.multipleItemBorderColor}`}})}),TH=(e,t)=>{const{componentCls:n,antCls:i}=e;return{[`&:not(${n}-customize-input) ${n}-selector`]:{background:t.bg,border:`${dt(e.lineWidth)} ${e.lineType} transparent`,color:t.color},[`&:not(${n}-disabled):not(${n}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${n}-selector`]:{background:t.hoverBg},[`${n}-focused& ${n}-selector`]:{background:e.selectorBg,borderColor:t.activeBorderColor,outline:0}}}},HB=(e,t)=>({[`&${e.componentCls}-status-${t.status}`]:Object.assign({},TH(e,t))}),tse=e=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign({},TH(e,{bg:e.colorFillTertiary,hoverBg:e.colorFillSecondary,activeBorderColor:e.activeBorderColor,color:e.colorText})),HB(e,{status:"error",bg:e.colorErrorBg,hoverBg:e.colorErrorBgHover,activeBorderColor:e.colorError,color:e.colorError})),HB(e,{status:"warning",bg:e.colorWarningBg,hoverBg:e.colorWarningBgHover,activeBorderColor:e.colorWarning,color:e.colorWarning})),{[`&${e.componentCls}-disabled`]:{[`&:not(${e.componentCls}-customize-input) ${e.componentCls}-selector`]:{borderColor:e.colorBorder,background:e.colorBgContainerDisabled,color:e.colorTextDisabled}},[`&${e.componentCls}-multiple ${e.componentCls}-selection-item`]:{background:e.colorBgContainer,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorSplit}`}})}),nse=e=>({"&-borderless":{[`${e.componentCls}-selector`]:{background:"transparent",border:`${dt(e.lineWidth)} ${e.lineType} transparent`},[`&${e.componentCls}-disabled`]:{[`&:not(${e.componentCls}-customize-input) ${e.componentCls}-selector`]:{color:e.colorTextDisabled}},[`&${e.componentCls}-multiple ${e.componentCls}-selection-item`]:{background:e.multipleItemBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.multipleItemBorderColor}`},[`&${e.componentCls}-status-error`]:{[`${e.componentCls}-prefix, ${e.componentCls}-selection-item`]:{color:e.colorError}},[`&${e.componentCls}-status-warning`]:{[`${e.componentCls}-prefix, ${e.componentCls}-selection-item`]:{color:e.colorWarning}}}}),IH=(e,t)=>{const{componentCls:n,antCls:i}=e;return{[`&:not(${n}-customize-input) ${n}-selector`]:{borderWidth:`0 0 ${dt(e.lineWidth)} 0`,borderStyle:`none none ${e.lineType} none`,borderColor:t.borderColor,background:e.selectorBg,borderRadius:0},[`&:not(${n}-disabled):not(${n}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${n}-selector`]:{borderColor:t.hoverBorderHover},[`${n}-focused& ${n}-selector`]:{borderColor:t.activeBorderColor,outline:0},[`${n}-prefix`]:{color:t.color}}}},GB=(e,t)=>({[`&${e.componentCls}-status-${t.status}`]:Object.assign({},IH(e,t))}),rse=e=>({"&-underlined":Object.assign(Object.assign(Object.assign(Object.assign({},IH(e,{borderColor:e.colorBorder,hoverBorderHover:e.hoverBorderColor,activeBorderColor:e.activeBorderColor,activeOutlineColor:e.activeOutlineColor,color:e.colorText})),GB(e,{status:"error",borderColor:e.colorError,hoverBorderHover:e.colorErrorHover,activeBorderColor:e.colorError,activeOutlineColor:e.colorErrorOutline,color:e.colorError})),GB(e,{status:"warning",borderColor:e.colorWarning,hoverBorderHover:e.colorWarningHover,activeBorderColor:e.colorWarning,activeOutlineColor:e.colorWarningOutline,color:e.colorWarning})),{[`&${e.componentCls}-disabled`]:{[`&:not(${e.componentCls}-customize-input) ${e.componentCls}-selector`]:{color:e.colorTextDisabled}},[`&${e.componentCls}-multiple ${e.componentCls}-selection-item`]:{background:e.multipleItemBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.multipleItemBorderColor}`}})}),ise=e=>({[e.componentCls]:Object.assign(Object.assign(Object.assign(Object.assign({},ese(e)),tse(e)),nse(e)),rse(e))}),ose=e=>{const{componentCls:t}=e;return{position:"relative",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,input:{cursor:"pointer"},[`${t}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit",height:"100%"}},[`${t}-disabled&`]:{cursor:"not-allowed",input:{cursor:"not-allowed"}}}},ase=e=>{const{componentCls:t}=e;return{[`${t}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none",fontFamily:"inherit","&::-webkit-search-cancel-button":{display:"none",appearance:"none"}}}},sse=e=>{const{antCls:t,componentCls:n,inputPaddingHorizontalBase:i,iconCls:s}=e,d={[`${n}-clear`]:{opacity:1,background:e.colorBgBase,borderRadius:"50%"}};return{[n]:Object.assign(Object.assign({},ya(e)),{position:"relative",display:"inline-flex",cursor:"pointer",[`&:not(${n}-customize-input) ${n}-selector`]:Object.assign(Object.assign({},ose(e)),ase(e)),[`${n}-selection-item`]:Object.assign(Object.assign({flex:1,fontWeight:"normal",position:"relative",userSelect:"none"},df),{[`> ${t}-typography`]:{display:"inline"}}),[`${n}-selection-placeholder`]:Object.assign(Object.assign({},df),{flex:1,color:e.colorTextPlaceholder,pointerEvents:"none"}),[`${n}-arrow`]:Object.assign(Object.assign({},nb()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,height:e.fontSizeIcon,marginTop:e.calc(e.fontSizeIcon).mul(-1).div(2).equal(),color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",transition:`opacity ${e.motionDurationSlow} ease`,[s]:{verticalAlign:"top",transition:`transform ${e.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${n}-suffix)`]:{pointerEvents:"auto"}},[`${n}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${n}-selection-wrap`]:{display:"flex",width:"100%",position:"relative",minWidth:0,"&:after":{content:'"\\a0"',width:0,overflow:"hidden"}},[`${n}-prefix`]:{flex:"none",marginInlineEnd:e.selectAffixPadding},[`${n}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,zIndex:1,display:"inline-block",width:e.fontSizeIcon,height:e.fontSizeIcon,marginTop:e.calc(e.fontSizeIcon).mul(-1).div(2).equal(),color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",cursor:"pointer",opacity:0,transition:`color ${e.motionDurationMid} ease, opacity ${e.motionDurationSlow} ease`,textRendering:"auto",transform:"translateZ(0)","&:before":{display:"block"},"&:hover":{color:e.colorIcon}},"@media(hover:none)":d,"&:hover":d}),[`${n}-status`]:{"&-error, &-warning, &-success, &-validating":{[`&${n}-has-feedback`]:{[`${n}-clear`]:{insetInlineEnd:e.calc(i).add(e.fontSize).add(e.paddingXS).equal()}}}}}},lse=e=>{const{componentCls:t}=e;return[{[t]:{[`&${t}-in-form-item`]:{width:"100%"}}},sse(e),Jae(e),Yae(e),Wae(e),{[`${t}-rtl`]:{direction:"rtl"}},zO(e,{borderElCls:`${t}-selector`,focusElCls:`${t}-focused`})]},cse=za("Select",(e,{rootPrefixCls:t})=>{const n=xo(e,{rootPrefixCls:t,inputPaddingHorizontalBase:e.calc(e.paddingSM).sub(1).equal(),multipleSelectItemHeight:e.multipleItemHeight,selectHeight:e.controlHeight});return[lse(n),ise(n)]},Qae,{unitless:{optionLineHeight:!0,optionSelectedFontWeight:!0}});var use={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},dse=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:use}))},hse=I.forwardRef(dse),fse={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},pse=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:fse}))},PH=I.forwardRef(pse),mse={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},gse=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:mse}))},MH=I.forwardRef(gse);function vse({suffixIcon:e,clearIcon:t,menuItemSelectedIcon:n,removeIcon:i,loading:s,multiple:d,hasFeedback:f,prefixCls:o,showSuffixIcon:y,feedbackIcon:b,showArrow:C,componentName:P}){const A=t??I.createElement(NU,null),D=j=>e===null&&!f&&!C?null:I.createElement(I.Fragment,null,y!==!1&&j,f&&b);let k=null;if(e!==void 0)k=D(e);else if(s)k=D(I.createElement(CO,{spin:!0}));else{const j=`${o}-suffix`;k=({open:V,showSearch:K})=>D(V&&K?I.createElement(MH,{className:j}):I.createElement(PH,{className:j}))}let B=null;n!==void 0?B=n:d?B=I.createElement(hse,null):B=null;let N=null;return i!==void 0?N=i:N=I.createElement(SO,null),{clearIcon:A,suffixIcon:k,itemIcon:B,removeIcon:N}}function _se(e){return Wt.useMemo(()=>{if(e)return(...t)=>Wt.createElement(Ox,{space:!0},e.apply(void 0,t))},[e])}function yse(e,t){return t!==void 0?t:e!==null}var xse=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const RH="SECRET_COMBOBOX_MODE_DO_NOT_USE",bse=(e,t)=>{var n,i,s,d,f;const{prefixCls:o,bordered:y,className:b,rootClassName:C,getPopupContainer:P,popupClassName:A,dropdownClassName:D,listHeight:k=256,placement:B,listItemHeight:N,size:j,disabled:V,notFoundContent:K,status:Y,builtinPlacements:Z,dropdownMatchSelectWidth:te,popupMatchSelectWidth:ne,direction:se,style:ee,allowClear:de,variant:fe,dropdownStyle:ye,transitionName:ge,tagRender:we,maxCount:Se,prefix:xe,dropdownRender:Te,popupRender:ze,onDropdownVisibleChange:Ue,onOpenChange:We,styles:Be,classNames:Xe}=e,qe=xse(e,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount","prefix","dropdownRender","popupRender","onDropdownVisibleChange","onOpenChange","styles","classNames"]),{getPopupContainer:at,getPrefixCls:Ke,renderEmpty:tt,direction:vt,virtual:Pt,popupMatchSelectWidth:ft,popupOverflow:Nt}=I.useContext(ji),{showSearch:Rt,style:pt,styles:yt,className:xt,classNames:bt}=Gu("select"),[,Ct]=Vs(),tn=N??(Ct==null?void 0:Ct.controlHeight),Zt=Ke("select",o),In=Ke(),Cn=se??vt,{compactSize:Mt,compactItemClassnames:hn}=pE(Zt,Cn),[Jt,Ut]=UO("select",fe,y),Tn=Wu(Zt),[On,Kn,Un]=cse(Zt,Tn),Pn=I.useMemo(()=>{const{mode:Xn}=e;if(Xn!=="combobox")return Xn===RH?"combobox":Xn},[e.mode]),Qn=Pn==="multiple"||Pn==="tags",un=yse(e.suffixIcon,e.showArrow),nn=(n=ne??te)!==null&&n!==void 0?n:ft,$n=((i=Be==null?void 0:Be.popup)===null||i===void 0?void 0:i.root)||((s=yt.popup)===null||s===void 0?void 0:s.root)||ye,Ln=_se(ze||Te),qn=We||Ue,{status:er,hasFeedback:tr,isFormItemInput:Jn,feedbackIcon:Ir}=I.useContext(Xp),_r=bH(er,Y);let $r;K!==void 0?$r=K:Pn==="combobox"?$r=null:$r=(tt==null?void 0:tt("Select"))||I.createElement(CH,{componentName:"Select"});const{suffixIcon:mr,itemIcon:yi,removeIcon:Vr,clearIcon:Kr}=vse(Object.assign(Object.assign({},qe),{multiple:Qn,hasFeedback:tr,feedbackIcon:Ir,showSuffixIcon:un,prefixCls:Zt,componentName:"Select"})),Rr=de===!0?{clearIcon:Kr}:de,ii=as(qe,["suffixIcon","itemIcon"]),Hr=St(((d=Xe==null?void 0:Xe.popup)===null||d===void 0?void 0:d.root)||((f=bt==null?void 0:bt.popup)===null||f===void 0?void 0:f.root)||A||D,{[`${Zt}-dropdown-${Cn}`]:Cn==="rtl"},C,bt.root,Xe==null?void 0:Xe.root,Un,Tn,Kn),ut=Bd(Xn=>{var gr;return(gr=j??Mt)!==null&&gr!==void 0?gr:Xn}),ur=I.useContext(Fd),fr=V??ur,Fn=St({[`${Zt}-lg`]:ut==="large",[`${Zt}-sm`]:ut==="small",[`${Zt}-rtl`]:Cn==="rtl",[`${Zt}-${Jt}`]:Ut,[`${Zt}-in-form-item`]:Jn},ER(Zt,_r,tr),hn,xt,b,bt.root,Xe==null?void 0:Xe.root,C,Un,Tn,Kn),Gt=I.useMemo(()=>B!==void 0?B:Cn==="rtl"?"bottomRight":"bottomLeft",[B,Cn]),[mn]=lE("SelectLike",$n==null?void 0:$n.zIndex);return On(I.createElement(VO,Object.assign({ref:t,virtual:Pt,showSearch:Rt},ii,{style:Object.assign(Object.assign(Object.assign(Object.assign({},yt.root),Be==null?void 0:Be.root),pt),ee),dropdownMatchSelectWidth:nn,transitionName:IO(In,"slide-up",ge),builtinPlacements:Gae(Z,Nt),listHeight:k,listItemHeight:tn,mode:Pn,prefixCls:Zt,placement:Gt,direction:Cn,prefix:xe,suffixIcon:mr,menuItemSelectedIcon:yi,removeIcon:Vr,allowClear:Rr,notFoundContent:$r,className:Fn,getPopupContainer:P||at,dropdownClassName:Hr,disabled:fr,dropdownStyle:Object.assign(Object.assign({},$n),{zIndex:mn}),maxCount:Qn?Se:void 0,tagRender:Qn?we:void 0,dropdownRender:Ln,onDropdownVisibleChange:qn})))},Yv=I.forwardRef(bse),wse=lH(Yv,"dropdownAlign");Yv.SECRET_COMBOBOX_MODE_DO_NOT_USE=RH;Yv.Option=jO;Yv.OptGroup=$O;Yv._InternalPanelDoNotUseOrYouWillBeFired=wse;const Sse=(e,t)=>{typeof(e==null?void 0:e.addEventListener)<"u"?e.addEventListener("change",t):typeof(e==null?void 0:e.addListener)<"u"&&e.addListener(t)},Cse=(e,t)=>{typeof(e==null?void 0:e.removeEventListener)<"u"?e.removeEventListener("change",t):typeof(e==null?void 0:e.removeListener)<"u"&&e.removeListener(t)},Lx=["xxl","xl","lg","md","sm","xs"],Ese=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`}),Tse=e=>{const t=e,n=[].concat(Lx).reverse();return n.forEach((i,s)=>{const d=i.toUpperCase(),f=`screen${d}Min`,o=`screen${d}`;if(!(t[f]<=t[o]))throw new Error(`${f}<=${o} fails : !(${t[f]}<=${t[o]})`);if(s<n.length-1){const y=`screen${d}Max`;if(!(t[o]<=t[y]))throw new Error(`${o}<=${y} fails : !(${t[o]}<=${t[y]})`);const C=`screen${n[s+1].toUpperCase()}Min`;if(!(t[y]<=t[C]))throw new Error(`${y}<=${C} fails : !(${t[y]}<=${t[C]})`)}}),e},Ise=()=>{const[,e]=Vs(),t=Ese(Tse(e));return Wt.useMemo(()=>{const n=new Map;let i=-1,s={};return{responsiveMap:t,matchHandlers:{},dispatch(d){return s=d,n.forEach(f=>f(s)),n.size>=1},subscribe(d){return n.size||this.register(),i+=1,n.set(i,d),d(s),i},unsubscribe(d){n.delete(d),n.size||this.unregister()},register(){Object.entries(t).forEach(([d,f])=>{const o=({matches:b})=>{this.dispatch(Object.assign(Object.assign({},s),{[d]:b}))},y=window.matchMedia(f);Sse(y,o),this.matchHandlers[f]={mql:y,listener:o},o(y)})},unregister(){Object.values(t).forEach(d=>{const f=this.matchHandlers[d];Cse(f==null?void 0:f.mql,f==null?void 0:f.listener)}),n.clear()}}},[e])};function AH(){const[,e]=I.useReducer(t=>t+1,0);return e}function HO(e=!0,t={}){const n=I.useRef(t),i=AH(),s=Ise();return yo(()=>{const d=s.subscribe(f=>{n.current=f,e&&i()});return()=>s.unsubscribe(d)},[]),n.current}function OH(e){var t=e.children,n=e.prefixCls,i=e.id,s=e.overlayInnerStyle,d=e.bodyClassName,f=e.className,o=e.style;return I.createElement("div",{className:St("".concat(n,"-content"),f),style:o},I.createElement("div",{className:St("".concat(n,"-inner"),d),id:i,role:"tooltip",style:s},typeof t=="function"?t():t))}var $g={shiftX:64,adjustY:1},jg={adjustX:1,shiftY:!0},sc=[0,0],Pse={left:{points:["cr","cl"],overflow:jg,offset:[-4,0],targetOffset:sc},right:{points:["cl","cr"],overflow:jg,offset:[4,0],targetOffset:sc},top:{points:["bc","tc"],overflow:$g,offset:[0,-4],targetOffset:sc},bottom:{points:["tc","bc"],overflow:$g,offset:[0,4],targetOffset:sc},topLeft:{points:["bl","tl"],overflow:$g,offset:[0,-4],targetOffset:sc},leftTop:{points:["tr","tl"],overflow:jg,offset:[-4,0],targetOffset:sc},topRight:{points:["br","tr"],overflow:$g,offset:[0,-4],targetOffset:sc},rightTop:{points:["tl","tr"],overflow:jg,offset:[4,0],targetOffset:sc},bottomRight:{points:["tr","br"],overflow:$g,offset:[0,4],targetOffset:sc},rightBottom:{points:["bl","br"],overflow:jg,offset:[4,0],targetOffset:sc},bottomLeft:{points:["tl","bl"],overflow:$g,offset:[0,4],targetOffset:sc},leftBottom:{points:["br","bl"],overflow:jg,offset:[-4,0],targetOffset:sc}},Mse=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow","classNames","styles"],Rse=function(t,n){var i=t.overlayClassName,s=t.trigger,d=s===void 0?["hover"]:s,f=t.mouseEnterDelay,o=f===void 0?0:f,y=t.mouseLeaveDelay,b=y===void 0?.1:y,C=t.overlayStyle,P=t.prefixCls,A=P===void 0?"rc-tooltip":P,D=t.children,k=t.onVisibleChange,B=t.afterVisibleChange,N=t.transitionName,j=t.animation,V=t.motion,K=t.placement,Y=K===void 0?"right":K,Z=t.align,te=Z===void 0?{}:Z,ne=t.destroyTooltipOnHide,se=ne===void 0?!1:ne,ee=t.defaultVisible,de=t.getTooltipContainer,fe=t.overlayInnerStyle;t.arrowContent;var ye=t.overlay,ge=t.id,we=t.showArrow,Se=we===void 0?!0:we,xe=t.classNames,Te=t.styles,ze=ri(t,Mse),Ue=kO(ge),We=I.useRef(null);I.useImperativeHandle(n,function(){return We.current});var Be=Je({},ze);"visible"in t&&(Be.popupVisible=t.visible);var Xe=function(){return I.createElement(OH,{key:"content",prefixCls:A,id:Ue,bodyClassName:xe==null?void 0:xe.body,overlayInnerStyle:Je(Je({},fe),Te==null?void 0:Te.body)},ye)},qe=function(){var Ke=I.Children.only(D),tt=(Ke==null?void 0:Ke.props)||{},vt=Je(Je({},tt),{},{"aria-describedby":ye?Ue:null});return I.cloneElement(D,vt)};return I.createElement(CE,kn({popupClassName:St(i,xe==null?void 0:xe.root),prefixCls:A,popup:Xe,action:d,builtinPlacements:Pse,popupPlacement:Y,ref:We,popupAlign:te,getPopupContainer:de,onPopupVisibleChange:k,afterPopupVisibleChange:B,popupTransitionName:N,popupAnimation:j,popupMotion:V,defaultPopupVisible:ee,autoDestroy:se,mouseLeaveDelay:b,popupStyle:Je(Je({},C),Te==null?void 0:Te.root),mouseEnterDelay:o,arrow:Se},Be),qe())};const Ase=I.forwardRef(Rse);function DH(e){const{sizePopupArrow:t,borderRadiusXS:n,borderRadiusOuter:i}=e,s=t/2,d=0,f=s,o=i*1/Math.sqrt(2),y=s-i*(1-1/Math.sqrt(2)),b=s-n*(1/Math.sqrt(2)),C=i*(Math.sqrt(2)-1)+n*(1/Math.sqrt(2)),P=2*s-b,A=C,D=2*s-o,k=y,B=2*s-d,N=f,j=s*Math.sqrt(2)+i*(Math.sqrt(2)-2),V=i*(Math.sqrt(2)-1),K=`polygon(${V}px 100%, 50% ${V}px, ${2*s-V}px 100%, ${V}px 100%)`,Y=`path('M ${d} ${f} A ${i} ${i} 0 0 0 ${o} ${y} L ${b} ${C} A ${n} ${n} 0 0 1 ${P} ${A} L ${D} ${k} A ${i} ${i} 0 0 0 ${B} ${N} Z')`;return{arrowShadowWidth:j,arrowPath:Y,arrowPolygon:K}}const Ose=(e,t,n)=>{const{sizePopupArrow:i,arrowPolygon:s,arrowPath:d,arrowShadowWidth:f,borderRadiusXS:o,calc:y}=e;return{pointerEvents:"none",width:i,height:i,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:i,height:y(i).div(2).equal(),background:t,clipPath:{_multi_value_:!0,value:[s,d]},content:'""'},"&::after":{content:'""',position:"absolute",width:f,height:f,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${dt(o)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:n,zIndex:0,background:"transparent"}}},LH=8;function GO(e){const{contentRadius:t,limitVerticalRadius:n}=e,i=t>12?t+2:12;return{arrowOffsetHorizontal:i,arrowOffsetVertical:n?LH:i}}function Rw(e,t){return e?t:{}}function zH(e,t,n){const{componentCls:i,boxShadowPopoverArrow:s,arrowOffsetVertical:d,arrowOffsetHorizontal:f}=e,{arrowDistance:o=0,arrowPlacement:y={left:!0,right:!0,top:!0,bottom:!0}}=n||{};return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({[`${i}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},Ose(e,t,s)),{"&:before":{background:t}})]},Rw(!!y.top,{[[`&-placement-top > ${i}-arrow`,`&-placement-topLeft > ${i}-arrow`,`&-placement-topRight > ${i}-arrow`].join(",")]:{bottom:o,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":f,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:f}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${dt(f)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:f}}}})),Rw(!!y.bottom,{[[`&-placement-bottom > ${i}-arrow`,`&-placement-bottomLeft > ${i}-arrow`,`&-placement-bottomRight > ${i}-arrow`].join(",")]:{top:o,transform:"translateY(-100%)"},[`&-placement-bottom > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":f,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:f}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${dt(f)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:f}}}})),Rw(!!y.left,{[[`&-placement-left > ${i}-arrow`,`&-placement-leftTop > ${i}-arrow`,`&-placement-leftBottom > ${i}-arrow`].join(",")]:{right:{_skip_check_:!0,value:o},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${i}-arrow`]:{top:d},[`&-placement-leftBottom > ${i}-arrow`]:{bottom:d}})),Rw(!!y.right,{[[`&-placement-right > ${i}-arrow`,`&-placement-rightTop > ${i}-arrow`,`&-placement-rightBottom > ${i}-arrow`].join(",")]:{left:{_skip_check_:!0,value:o},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${i}-arrow`]:{top:d},[`&-placement-rightBottom > ${i}-arrow`]:{bottom:d}}))}}function Dse(e,t,n,i){if(i===!1)return{adjustX:!1,adjustY:!1};const s=i&&typeof i=="object"?i:{},d={};switch(e){case"top":case"bottom":d.shiftX=t.arrowOffsetHorizontal*2+n,d.shiftY=!0,d.adjustY=!0;break;case"left":case"right":d.shiftY=t.arrowOffsetVertical*2+n,d.shiftX=!0,d.adjustX=!0;break}const f=Object.assign(Object.assign({},d),s);return f.shiftX||(f.adjustX=!0),f.shiftY||(f.adjustY=!0),f}const WB={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},Lse={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},zse=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function kH(e){const{arrowWidth:t,autoAdjustOverflow:n,arrowPointAtCenter:i,offset:s,borderRadius:d,visibleFirst:f}=e,o=t/2,y={},b=GO({contentRadius:d,limitVerticalRadius:!0});return Object.keys(WB).forEach(C=>{const P=i&&Lse[C]||WB[C],A=Object.assign(Object.assign({},P),{offset:[0,0],dynamicInset:!0});switch(y[C]=A,zse.has(C)&&(A.autoArrow=!1),C){case"top":case"topLeft":case"topRight":A.offset[1]=-o-s;break;case"bottom":case"bottomLeft":case"bottomRight":A.offset[1]=o+s;break;case"left":case"leftTop":case"leftBottom":A.offset[0]=-o-s;break;case"right":case"rightTop":case"rightBottom":A.offset[0]=o+s;break}if(i)switch(C){case"topLeft":case"bottomLeft":A.offset[0]=-b.arrowOffsetHorizontal-o;break;case"topRight":case"bottomRight":A.offset[0]=b.arrowOffsetHorizontal+o;break;case"leftTop":case"rightTop":A.offset[1]=-b.arrowOffsetHorizontal*2+o;break;case"leftBottom":case"rightBottom":A.offset[1]=b.arrowOffsetHorizontal*2-o;break}A.overflow=Dse(C,b,t,n),f&&(A.htmlRegion="visibleFirst")}),y}const kse=e=>{const{calc:t,componentCls:n,tooltipMaxWidth:i,tooltipColor:s,tooltipBg:d,tooltipBorderRadius:f,zIndexPopup:o,controlHeight:y,boxShadowSecondary:b,paddingSM:C,paddingXS:P,arrowOffsetHorizontal:A,sizePopupArrow:D}=e,k=t(f).add(D).add(A).equal(),B=t(f).mul(2).add(D).equal();return[{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},ya(e)),{position:"absolute",zIndex:o,display:"block",width:"max-content",maxWidth:i,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":d,[`${n}-inner`]:{minWidth:B,minHeight:y,padding:`${dt(e.calc(C).div(2).equal())} ${dt(P)}`,color:`var(--ant-tooltip-color, ${s})`,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:d,borderRadius:f,boxShadow:b,boxSizing:"border-box"},[["&-placement-topLeft","&-placement-topRight","&-placement-bottomLeft","&-placement-bottomRight"].join(",")]:{minWidth:k},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${n}-inner`]:{borderRadius:e.min(f,LH)}},[`${n}-content`]:{position:"relative"}}),wU(e,(N,{darkColor:j})=>({[`&${n}-${N}`]:{[`${n}-inner`]:{backgroundColor:j},[`${n}-arrow`]:{"--antd-arrow-background-color":j}}}))),{"&-rtl":{direction:"rtl"}})},zH(e,"var(--antd-arrow-background-color)"),{[`${n}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},Fse=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+70},GO({contentRadius:e.borderRadius,limitVerticalRadius:!0})),DH(xo(e,{borderRadiusOuter:Math.min(e.borderRadiusOuter,4)}))),FH=(e,t=!0)=>za("Tooltip",i=>{const{borderRadius:s,colorTextLightSolid:d,colorBgSpotlight:f}=i,o=xo(i,{tooltipMaxWidth:250,tooltipColor:d,tooltipBorderRadius:s,tooltipBg:f});return[kse(o),DO(i,"zoom-big-fast")]},Fse,{resetStyle:!1,injectStyle:t})(e),Nse=qp.map(e=>`${e}-inverse`),Bse=["success","processing","error","default","warning"];function NH(e,t=!0){return t?[].concat(zn(Nse),zn(qp)).includes(e):qp.includes(e)}function $se(e){return Bse.includes(e)}function BH(e,t){const n=NH(t),i=St({[`${e}-${t}`]:t&&n}),s={},d={},f=Kne(t).toRgb(),y=(.299*f.r+.587*f.g+.114*f.b)/255<.5?"#FFF":"#000";return t&&!n&&(s.background=t,s["--ant-tooltip-color"]=y,d["--antd-arrow-background-color"]=t),{className:i,overlayStyle:s,arrowStyle:d}}const jse=e=>{const{prefixCls:t,className:n,placement:i="top",title:s,color:d,overlayInnerStyle:f}=e,{getPrefixCls:o}=I.useContext(ji),y=o("tooltip",t),[b,C,P]=FH(y),A=BH(y,d),D=A.arrowStyle,k=Object.assign(Object.assign({},f),A.overlayStyle),B=St(C,P,y,`${y}-pure`,`${y}-placement-${i}`,n,A.className);return b(I.createElement("div",{className:B,style:D},I.createElement("div",{className:`${y}-arrow`}),I.createElement(OH,Object.assign({},e,{className:C,prefixCls:y,overlayInnerStyle:k}),s)))};var Vse=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Use=I.forwardRef((e,t)=>{var n,i;const{prefixCls:s,openClassName:d,getTooltipContainer:f,color:o,overlayInnerStyle:y,children:b,afterOpenChange:C,afterVisibleChange:P,destroyTooltipOnHide:A,destroyOnHidden:D,arrow:k=!0,title:B,overlay:N,builtinPlacements:j,arrowPointAtCenter:V=!1,autoAdjustOverflow:K=!0,motion:Y,getPopupContainer:Z,placement:te="top",mouseEnterDelay:ne=.1,mouseLeaveDelay:se=.1,overlayStyle:ee,rootClassName:de,overlayClassName:fe,styles:ye,classNames:ge}=e,we=Vse(e,["prefixCls","openClassName","getTooltipContainer","color","overlayInnerStyle","children","afterOpenChange","afterVisibleChange","destroyTooltipOnHide","destroyOnHidden","arrow","title","overlay","builtinPlacements","arrowPointAtCenter","autoAdjustOverflow","motion","getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName","overlayClassName","styles","classNames"]),Se=!!k,[,xe]=Vs(),{getPopupContainer:Te,getPrefixCls:ze,direction:Ue,className:We,style:Be,classNames:Xe,styles:qe}=Gu("tooltip"),at=qv(),Ke=I.useRef(null),tt=()=>{var un;(un=Ke.current)===null||un===void 0||un.forceAlign()};I.useImperativeHandle(t,()=>{var un,nn;return{forceAlign:tt,forcePopupAlign:()=>{at.deprecated(!1,"forcePopupAlign","forceAlign"),tt()},nativeElement:(un=Ke.current)===null||un===void 0?void 0:un.nativeElement,popupElement:(nn=Ke.current)===null||nn===void 0?void 0:nn.popupElement}});const[vt,Pt]=is(!1,{value:(n=e.open)!==null&&n!==void 0?n:e.visible,defaultValue:(i=e.defaultOpen)!==null&&i!==void 0?i:e.defaultVisible}),ft=!B&&!N&&B!==0,Nt=un=>{var nn,$n;Pt(ft?!1:un),ft||((nn=e.onOpenChange)===null||nn===void 0||nn.call(e,un),($n=e.onVisibleChange)===null||$n===void 0||$n.call(e,un))},Rt=I.useMemo(()=>{var un,nn;let $n=V;return typeof k=="object"&&($n=(nn=(un=k.pointAtCenter)!==null&&un!==void 0?un:k.arrowPointAtCenter)!==null&&nn!==void 0?nn:V),j||kH({arrowPointAtCenter:$n,autoAdjustOverflow:K,arrowWidth:Se?xe.sizePopupArrow:0,borderRadius:xe.borderRadius,offset:xe.marginXXS,visibleFirst:!0})},[V,k,j,xe]),pt=I.useMemo(()=>B===0?B:N||B||"",[N,B]),yt=I.createElement(Ox,{space:!0},typeof pt=="function"?pt():pt),xt=ze("tooltip",s),bt=ze(),Ct=e["data-popover-inject"];let tn=vt;!("open"in e)&&!("visible"in e)&&ft&&(tn=!1);const Zt=I.isValidElement(b)&&!BU(b)?b:I.createElement("span",null,b),In=Zt.props,Cn=!In.className||typeof In.className=="string"?St(In.className,d||`${xt}-open`):In.className,[Mt,hn,Jt]=FH(xt,!Ct),Ut=BH(xt,o),Tn=Ut.arrowStyle,On=St(fe,{[`${xt}-rtl`]:Ue==="rtl"},Ut.className,de,hn,Jt,We,Xe.root,ge==null?void 0:ge.root),Kn=St(Xe.body,ge==null?void 0:ge.body),[Un,Pn]=lE("Tooltip",we.zIndex),Qn=I.createElement(Ase,Object.assign({},we,{zIndex:Un,showArrow:Se,placement:te,mouseEnterDelay:ne,mouseLeaveDelay:se,prefixCls:xt,classNames:{root:On,body:Kn},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tn),qe.root),Be),ee),ye==null?void 0:ye.root),body:Object.assign(Object.assign(Object.assign(Object.assign({},qe.body),y),ye==null?void 0:ye.body),Ut.overlayStyle)},getTooltipContainer:Z||f||Te,ref:Ke,builtinPlacements:Rt,overlay:yt,visible:tn,onVisibleChange:Nt,afterVisibleChange:C??P,arrowContent:I.createElement("span",{className:`${xt}-arrow-content`}),motion:{motionName:IO(bt,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:D??!!A}),tn?Bu(Zt,{className:Cn}):Zt);return Mt(I.createElement(EO.Provider,{value:Pn},Qn))}),zx=Use;zx._InternalPanelDoNotUseOrYouWillBeFired=jse;var Hse={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},Gse=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Hse}))},TR=I.forwardRef(Gse),Wse=ir.ESC,qse=ir.TAB;function Kse(e){var t=e.visible,n=e.triggerRef,i=e.onVisibleChange,s=e.autoFocus,d=e.overlayRef,f=I.useRef(!1),o=function(){if(t){var P,A;(P=n.current)===null||P===void 0||(A=P.focus)===null||A===void 0||A.call(P),i==null||i(!1)}},y=function(){var P;return(P=d.current)!==null&&P!==void 0&&P.focus?(d.current.focus(),f.current=!0,!0):!1},b=function(P){switch(P.keyCode){case Wse:o();break;case qse:{var A=!1;f.current||(A=y()),A?P.preventDefault():o();break}}};I.useEffect(function(){return t?(window.addEventListener("keydown",b),s&&Qi(y,3),function(){window.removeEventListener("keydown",b),f.current=!1}):function(){f.current=!1}},[t])}var Xse=I.forwardRef(function(e,t){var n=e.overlay,i=e.arrow,s=e.prefixCls,d=I.useMemo(function(){var o;return typeof n=="function"?o=n():o=n,o},[n]),f=ru(t,rm(d));return Wt.createElement(Wt.Fragment,null,i&&Wt.createElement("div",{className:"".concat(s,"-arrow")}),Wt.cloneElement(d,{ref:Fu(d)?f:void 0}))}),Vg={adjustX:1,adjustY:1},Ug=[0,0],Zse={topLeft:{points:["bl","tl"],overflow:Vg,offset:[0,-4],targetOffset:Ug},top:{points:["bc","tc"],overflow:Vg,offset:[0,-4],targetOffset:Ug},topRight:{points:["br","tr"],overflow:Vg,offset:[0,-4],targetOffset:Ug},bottomLeft:{points:["tl","bl"],overflow:Vg,offset:[0,4],targetOffset:Ug},bottom:{points:["tc","bc"],overflow:Vg,offset:[0,4],targetOffset:Ug},bottomRight:{points:["tr","br"],overflow:Vg,offset:[0,4],targetOffset:Ug}},Yse=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function Jse(e,t){var n,i=e.arrow,s=i===void 0?!1:i,d=e.prefixCls,f=d===void 0?"rc-dropdown":d,o=e.transitionName,y=e.animation,b=e.align,C=e.placement,P=C===void 0?"bottomLeft":C,A=e.placements,D=A===void 0?Zse:A,k=e.getPopupContainer,B=e.showAction,N=e.hideAction,j=e.overlayClassName,V=e.overlayStyle,K=e.visible,Y=e.trigger,Z=Y===void 0?["hover"]:Y,te=e.autoFocus,ne=e.overlay,se=e.children,ee=e.onVisibleChange,de=ri(e,Yse),fe=Wt.useState(),ye=It(fe,2),ge=ye[0],we=ye[1],Se="visible"in e?K:ge,xe=Wt.useRef(null),Te=Wt.useRef(null),ze=Wt.useRef(null);Wt.useImperativeHandle(t,function(){return xe.current});var Ue=function(Pt){we(Pt),ee==null||ee(Pt)};Kse({visible:Se,triggerRef:ze,onVisibleChange:Ue,autoFocus:te,overlayRef:Te});var We=function(Pt){var ft=e.onOverlayClick;we(!1),ft&&ft(Pt)},Be=function(){return Wt.createElement(Xse,{ref:Te,overlay:ne,prefixCls:f,arrow:s})},Xe=function(){return typeof ne=="function"?Be:Be()},qe=function(){var Pt=e.minOverlayWidthMatchTrigger,ft=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?Pt:!ft},at=function(){var Pt=e.openClassName;return Pt!==void 0?Pt:"".concat(f,"-open")},Ke=Wt.cloneElement(se,{className:St((n=se.props)===null||n===void 0?void 0:n.className,Se&&at()),ref:Fu(se)?ru(ze,rm(se)):void 0}),tt=N;return!tt&&Z.indexOf("contextMenu")!==-1&&(tt=["click"]),Wt.createElement(CE,kn({builtinPlacements:D},de,{prefixCls:f,ref:xe,popupClassName:St(j,ke({},"".concat(f,"-show-arrow"),s)),popupStyle:V,action:Z,showAction:B,hideAction:tt,popupPlacement:P,popupAlign:b,popupTransitionName:o,popupAnimation:y,popupVisible:Se,stretch:qe()?"minWidth":"",popup:Xe(),onPopupVisibleChange:Ue,onPopupClick:We,getPopupContainer:k}),Ke)}const $H=Wt.forwardRef(Jse),Qse=e=>typeof e!="object"&&typeof e!="function"||e===null;var jH=I.createContext(null);function VH(e,t){return e===void 0?null:"".concat(e,"-").concat(t)}function UH(e){var t=I.useContext(jH);return VH(t,e)}var ele=["children","locked"],Qc=I.createContext(null);function tle(e,t){var n=Je({},e);return Object.keys(t).forEach(function(i){var s=t[i];s!==void 0&&(n[i]=s)}),n}function kx(e){var t=e.children,n=e.locked,i=ri(e,ele),s=I.useContext(Qc),d=nm(function(){return tle(s,i)},[s,i],function(f,o){return!n&&(f[0]!==o[0]||!Yc(f[1],o[1],!0))});return I.createElement(Qc.Provider,{value:d},t)}var nle=[],HH=I.createContext(null);function TE(){return I.useContext(HH)}var GH=I.createContext(nle);function Jv(e){var t=I.useContext(GH);return I.useMemo(function(){return e!==void 0?[].concat(zn(t),[e]):t},[t,e])}var WH=I.createContext(null),WO=I.createContext({});function qB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(uE(e)){var n=e.nodeName.toLowerCase(),i=["input","select","textarea","button"].includes(n)||e.isContentEditable||n==="a"&&!!e.getAttribute("href"),s=e.getAttribute("tabindex"),d=Number(s),f=null;return s&&!Number.isNaN(d)?f=d:i&&f===null&&(f=0),i&&e.disabled&&(f=null),f!==null&&(f>=0||t&&f<0)}return!1}function rle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=zn(e.querySelectorAll("*")).filter(function(i){return qB(i,t)});return qB(e,t)&&n.unshift(e),n}var IR=ir.LEFT,PR=ir.RIGHT,MR=ir.UP,gS=ir.DOWN,vS=ir.ENTER,qH=ir.ESC,f0=ir.HOME,p0=ir.END,KB=[MR,gS,IR,PR];function ile(e,t,n,i){var s,d="prev",f="next",o="children",y="parent";if(e==="inline"&&i===vS)return{inlineTrigger:!0};var b=ke(ke({},MR,d),gS,f),C=ke(ke(ke(ke({},IR,n?f:d),PR,n?d:f),gS,o),vS,o),P=ke(ke(ke(ke(ke(ke({},MR,d),gS,f),vS,o),qH,y),IR,n?o:y),PR,n?y:o),A={inline:b,horizontal:C,vertical:P,inlineSub:b,horizontalSub:P,verticalSub:P},D=(s=A["".concat(e).concat(t?"":"Sub")])===null||s===void 0?void 0:s[i];switch(D){case d:return{offset:-1,sibling:!0};case f:return{offset:1,sibling:!0};case y:return{offset:-1,sibling:!1};case o:return{offset:1,sibling:!1};default:return null}}function ole(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}function ale(e,t){for(var n=e||document.activeElement;n;){if(t.has(n))return n;n=n.parentElement}return null}function qO(e,t){var n=rle(e,!0);return n.filter(function(i){return t.has(i)})}function XB(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var s=qO(e,t),d=s.length,f=s.findIndex(function(o){return n===o});return i<0?f===-1?f=d-1:f-=1:i>0&&(f+=1),f=(f+d)%d,s[f]}var RR=function(t,n){var i=new Set,s=new Map,d=new Map;return t.forEach(function(f){var o=document.querySelector("[data-menu-id='".concat(VH(n,f),"']"));o&&(i.add(o),d.set(o,f),s.set(f,o))}),{elements:i,key2element:s,element2key:d}};function sle(e,t,n,i,s,d,f,o,y,b){var C=I.useRef(),P=I.useRef();P.current=t;var A=function(){Qi.cancel(C.current)};return I.useEffect(function(){return function(){A()}},[]),function(D){var k=D.which;if([].concat(KB,[vS,qH,f0,p0]).includes(k)){var B=d(),N=RR(B,i),j=N,V=j.elements,K=j.key2element,Y=j.element2key,Z=K.get(t),te=ale(Z,V),ne=Y.get(te),se=ile(e,f(ne,!0).length===1,n,k);if(!se&&k!==f0&&k!==p0)return;(KB.includes(k)||[f0,p0].includes(k))&&D.preventDefault();var ee=function(Te){if(Te){var ze=Te,Ue=Te.querySelector("a");Ue!=null&&Ue.getAttribute("href")&&(ze=Ue);var We=Y.get(Te);o(We),A(),C.current=Qi(function(){P.current===We&&ze.focus()})}};if([f0,p0].includes(k)||se.sibling||!te){var de;!te||e==="inline"?de=s.current:de=ole(te);var fe,ye=qO(de,V);k===f0?fe=ye[0]:k===p0?fe=ye[ye.length-1]:fe=XB(de,V,te,se.offset),ee(fe)}else if(se.inlineTrigger)y(ne);else if(se.offset>0)y(ne,!0),A(),C.current=Qi(function(){N=RR(B,i);var xe=te.getAttribute("aria-controls"),Te=document.getElementById(xe),ze=XB(Te,N.elements);ee(ze)},5);else if(se.offset<0){var ge=f(ne,!0),we=ge[ge.length-2],Se=K.get(we);y(we,!1),ee(Se)}}b==null||b(D)}}function lle(e){Promise.resolve().then(e)}var KO="__RC_UTIL_PATH_SPLIT__",ZB=function(t){return t.join(KO)},cle=function(t){return t.split(KO)},AR="rc-menu-more";function ule(){var e=I.useState({}),t=It(e,2),n=t[1],i=I.useRef(new Map),s=I.useRef(new Map),d=I.useState([]),f=It(d,2),o=f[0],y=f[1],b=I.useRef(0),C=I.useRef(!1),P=function(){C.current||n({})},A=I.useCallback(function(K,Y){var Z=ZB(Y);s.current.set(Z,K),i.current.set(K,Z),b.current+=1;var te=b.current;lle(function(){te===b.current&&P()})},[]),D=I.useCallback(function(K,Y){var Z=ZB(Y);s.current.delete(Z),i.current.delete(K)},[]),k=I.useCallback(function(K){y(K)},[]),B=I.useCallback(function(K,Y){var Z=i.current.get(K)||"",te=cle(Z);return Y&&o.includes(te[0])&&te.unshift(AR),te},[o]),N=I.useCallback(function(K,Y){return K.filter(function(Z){return Z!==void 0}).some(function(Z){var te=B(Z,!0);return te.includes(Y)})},[B]),j=function(){var Y=zn(i.current.keys());return o.length&&Y.push(AR),Y},V=I.useCallback(function(K){var Y="".concat(i.current.get(K)).concat(KO),Z=new Set;return zn(s.current.keys()).forEach(function(te){te.startsWith(Y)&&Z.add(s.current.get(te))}),Z},[]);return I.useEffect(function(){return function(){C.current=!0}},[]),{registerPath:A,unregisterPath:D,refreshOverflowKeys:k,isSubPathKey:N,getKeyPath:B,getKeys:j,getSubPathKeys:V}}function P0(e){var t=I.useRef(e);t.current=e;var n=I.useCallback(function(){for(var i,s=arguments.length,d=new Array(s),f=0;f<s;f++)d[f]=arguments[f];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(d))},[]);return e?n:void 0}var dle=Math.random().toFixed(5).toString().slice(2),YB=0;function hle(e){var t=is(e,{value:e}),n=It(t,2),i=n[0],s=n[1];return I.useEffect(function(){YB+=1;var d="".concat(dle,"-").concat(YB);s("rc-menu-uuid-".concat(d))},[]),i}function KH(e,t,n,i){var s=I.useContext(Qc),d=s.activeKey,f=s.onActive,o=s.onInactive,y={active:d===e};return t||(y.onMouseEnter=function(b){n==null||n({key:e,domEvent:b}),f(e)},y.onMouseLeave=function(b){i==null||i({key:e,domEvent:b}),o(e)}),y}function XH(e){var t=I.useContext(Qc),n=t.mode,i=t.rtl,s=t.inlineIndent;if(n!=="inline")return null;var d=e;return i?{paddingRight:d*s}:{paddingLeft:d*s}}function ZH(e){var t=e.icon,n=e.props,i=e.children,s;return t===null||t===!1?null:(typeof t=="function"?s=I.createElement(t,Je({},n)):typeof t!="boolean"&&(s=t),s||i||null)}var fle=["item"];function dC(e){var t=e.item,n=ri(e,fle);return Object.defineProperty(n,"item",{get:function(){return oa(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),n}var ple=["title","attribute","elementRef"],mle=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],gle=["active"],vle=function(e){Uu(n,e);var t=Hu(n);function n(){return ja(this,n),t.apply(this,arguments)}return Va(n,[{key:"render",value:function(){var s=this.props,d=s.title,f=s.attribute,o=s.elementRef,y=ri(s,ple),b=as(y,["eventKey","popupClassName","popupOffset","onTitleClick"]);return oa(!f,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),I.createElement(Lu.Item,kn({},f,{title:typeof d=="string"?d:void 0},b,{ref:o}))}}]),n}(I.Component),_le=I.forwardRef(function(e,t){var n=e.style,i=e.className,s=e.eventKey;e.warnKey;var d=e.disabled,f=e.itemIcon,o=e.children,y=e.role,b=e.onMouseEnter,C=e.onMouseLeave,P=e.onClick,A=e.onKeyDown,D=e.onFocus,k=ri(e,mle),B=UH(s),N=I.useContext(Qc),j=N.prefixCls,V=N.onItemClick,K=N.disabled,Y=N.overflowDisabled,Z=N.itemIcon,te=N.selectedKeys,ne=N.onActive,se=I.useContext(WO),ee=se._internalRenderMenuItem,de="".concat(j,"-item"),fe=I.useRef(),ye=I.useRef(),ge=K||d,we=bf(t,ye),Se=Jv(s),xe=function(ft){return{key:s,keyPath:zn(Se).reverse(),item:fe.current,domEvent:ft}},Te=f||Z,ze=KH(s,ge,b,C),Ue=ze.active,We=ri(ze,gle),Be=te.includes(s),Xe=XH(Se.length),qe=function(ft){if(!ge){var Nt=xe(ft);P==null||P(dC(Nt)),V(Nt)}},at=function(ft){if(A==null||A(ft),ft.which===ir.ENTER){var Nt=xe(ft);P==null||P(dC(Nt)),V(Nt)}},Ke=function(ft){ne(s),D==null||D(ft)},tt={};e.role==="option"&&(tt["aria-selected"]=Be);var vt=I.createElement(vle,kn({ref:fe,elementRef:we,role:y===null?"none":y||"menuitem",tabIndex:d?null:-1,"data-menu-id":Y&&B?null:B},as(k,["extra"]),We,tt,{component:"li","aria-disabled":d,style:Je(Je({},Xe),n),className:St(de,ke(ke(ke({},"".concat(de,"-active"),Ue),"".concat(de,"-selected"),Be),"".concat(de,"-disabled"),ge),i),onClick:qe,onKeyDown:at,onFocus:Ke}),o,I.createElement(ZH,{props:Je(Je({},e),{},{isSelected:Be}),icon:Te}));return ee&&(vt=ee(vt,e,{selected:Be})),vt});function yle(e,t){var n=e.eventKey,i=TE(),s=Jv(n);return I.useEffect(function(){if(i)return i.registerPath(n,s),function(){i.unregisterPath(n,s)}},[s]),i?null:I.createElement(_le,kn({},e,{ref:t}))}const sb=I.forwardRef(yle);var xle=["className","children"],ble=function(t,n){var i=t.className,s=t.children,d=ri(t,xle),f=I.useContext(Qc),o=f.prefixCls,y=f.mode,b=f.rtl;return I.createElement("ul",kn({className:St(o,b&&"".concat(o,"-rtl"),"".concat(o,"-sub"),"".concat(o,"-").concat(y==="inline"?"inline":"vertical"),i),role:"menu"},d,{"data-menu-list":!0,ref:n}),s)},XO=I.forwardRef(ble);XO.displayName="SubMenuList";function ZO(e,t){return vc(e).map(function(n,i){if(I.isValidElement(n)){var s,d,f=n.key,o=(s=(d=n.props)===null||d===void 0?void 0:d.eventKey)!==null&&s!==void 0?s:f,y=o==null;y&&(o="tmp_key-".concat([].concat(zn(t),[i]).join("-")));var b={key:o,eventKey:o};return I.cloneElement(n,b)}return n})}var Ds={adjustX:1,adjustY:1},wle={topLeft:{points:["bl","tl"],overflow:Ds},topRight:{points:["br","tr"],overflow:Ds},bottomLeft:{points:["tl","bl"],overflow:Ds},bottomRight:{points:["tr","br"],overflow:Ds},leftTop:{points:["tr","tl"],overflow:Ds},leftBottom:{points:["br","bl"],overflow:Ds},rightTop:{points:["tl","tr"],overflow:Ds},rightBottom:{points:["bl","br"],overflow:Ds}},Sle={topLeft:{points:["bl","tl"],overflow:Ds},topRight:{points:["br","tr"],overflow:Ds},bottomLeft:{points:["tl","bl"],overflow:Ds},bottomRight:{points:["tr","br"],overflow:Ds},rightTop:{points:["tr","tl"],overflow:Ds},rightBottom:{points:["br","bl"],overflow:Ds},leftTop:{points:["tl","tr"],overflow:Ds},leftBottom:{points:["bl","br"],overflow:Ds}};function YH(e,t,n){if(t)return t;if(n)return n[e]||n.other}var Cle={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function Ele(e){var t=e.prefixCls,n=e.visible,i=e.children,s=e.popup,d=e.popupStyle,f=e.popupClassName,o=e.popupOffset,y=e.disabled,b=e.mode,C=e.onVisibleChange,P=I.useContext(Qc),A=P.getPopupContainer,D=P.rtl,k=P.subMenuOpenDelay,B=P.subMenuCloseDelay,N=P.builtinPlacements,j=P.triggerSubMenuAction,V=P.forceSubMenuRender,K=P.rootClassName,Y=P.motion,Z=P.defaultMotions,te=I.useState(!1),ne=It(te,2),se=ne[0],ee=ne[1],de=Je(D?Je({},Sle):Je({},wle),N),fe=Cle[b],ye=YH(b,Y,Z),ge=I.useRef(ye);b!=="inline"&&(ge.current=ye);var we=Je(Je({},ge.current),{},{leavedClassName:"".concat(t,"-hidden"),removeOnLeave:!1,motionAppear:!0}),Se=I.useRef();return I.useEffect(function(){return Se.current=Qi(function(){ee(n)}),function(){Qi.cancel(Se.current)}},[n]),I.createElement(CE,{prefixCls:t,popupClassName:St("".concat(t,"-popup"),ke({},"".concat(t,"-rtl"),D),f,K),stretch:b==="horizontal"?"minWidth":null,getPopupContainer:A,builtinPlacements:de,popupPlacement:fe,popupVisible:se,popup:s,popupStyle:d,popupAlign:o&&{offset:o},action:y?[]:[j],mouseEnterDelay:k,mouseLeaveDelay:B,onPopupVisibleChange:C,forceRender:V,popupMotion:we,fresh:!0},i)}function Tle(e){var t=e.id,n=e.open,i=e.keyPath,s=e.children,d="inline",f=I.useContext(Qc),o=f.prefixCls,y=f.forceSubMenuRender,b=f.motion,C=f.defaultMotions,P=f.mode,A=I.useRef(!1);A.current=P===d;var D=I.useState(!A.current),k=It(D,2),B=k[0],N=k[1],j=A.current?n:!1;I.useEffect(function(){A.current&&N(!1)},[P]);var V=Je({},YH(d,b,C));i.length>1&&(V.motionAppear=!1);var K=V.onVisibleChanged;return V.onVisibleChanged=function(Y){return!A.current&&!Y&&N(!0),K==null?void 0:K(Y)},B?null:I.createElement(kx,{mode:d,locked:!A.current},I.createElement(wf,kn({visible:j},V,{forceRender:y,removeOnLeave:!1,leavedClassName:"".concat(o,"-hidden")}),function(Y){var Z=Y.className,te=Y.style;return I.createElement(XO,{id:t,className:Z,style:te},s)}))}var Ile=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],Ple=["active"],Mle=I.forwardRef(function(e,t){var n=e.style,i=e.className,s=e.title,d=e.eventKey;e.warnKey;var f=e.disabled,o=e.internalPopupClose,y=e.children,b=e.itemIcon,C=e.expandIcon,P=e.popupClassName,A=e.popupOffset,D=e.popupStyle,k=e.onClick,B=e.onMouseEnter,N=e.onMouseLeave,j=e.onTitleClick,V=e.onTitleMouseEnter,K=e.onTitleMouseLeave,Y=ri(e,Ile),Z=UH(d),te=I.useContext(Qc),ne=te.prefixCls,se=te.mode,ee=te.openKeys,de=te.disabled,fe=te.overflowDisabled,ye=te.activeKey,ge=te.selectedKeys,we=te.itemIcon,Se=te.expandIcon,xe=te.onItemClick,Te=te.onOpenChange,ze=te.onActive,Ue=I.useContext(WO),We=Ue._internalRenderSubMenuItem,Be=I.useContext(WH),Xe=Be.isSubPathKey,qe=Jv(),at="".concat(ne,"-submenu"),Ke=de||f,tt=I.useRef(),vt=I.useRef(),Pt=b??we,ft=C??Se,Nt=ee.includes(d),Rt=!fe&&Nt,pt=Xe(ge,d),yt=KH(d,Ke,V,K),xt=yt.active,bt=ri(yt,Ple),Ct=I.useState(!1),tn=It(Ct,2),Zt=tn[0],In=tn[1],Cn=function(er){Ke||In(er)},Mt=function(er){Cn(!0),B==null||B({key:d,domEvent:er})},hn=function(er){Cn(!1),N==null||N({key:d,domEvent:er})},Jt=I.useMemo(function(){return xt||(se!=="inline"?Zt||Xe([ye],d):!1)},[se,xt,ye,Zt,d,Xe]),Ut=XH(qe.length),Tn=function(er){Ke||(j==null||j({key:d,domEvent:er}),se==="inline"&&Te(d,!Nt))},On=P0(function(qn){k==null||k(dC(qn)),xe(qn)}),Kn=function(er){se!=="inline"&&Te(d,er)},Un=function(){ze(d)},Pn=Z&&"".concat(Z,"-popup"),Qn=I.useMemo(function(){return I.createElement(ZH,{icon:se!=="horizontal"?ft:void 0,props:Je(Je({},e),{},{isOpen:Rt,isSubMenu:!0})},I.createElement("i",{className:"".concat(at,"-arrow")}))},[se,ft,e,Rt,at]),un=I.createElement("div",kn({role:"menuitem",style:Ut,className:"".concat(at,"-title"),tabIndex:Ke?null:-1,ref:tt,title:typeof s=="string"?s:null,"data-menu-id":fe&&Z?null:Z,"aria-expanded":Rt,"aria-haspopup":!0,"aria-controls":Pn,"aria-disabled":Ke,onClick:Tn,onFocus:Un},bt),s,Qn),nn=I.useRef(se);if(se!=="inline"&&qe.length>1?nn.current="vertical":nn.current=se,!fe){var $n=nn.current;un=I.createElement(Ele,{mode:$n,prefixCls:at,visible:!o&&Rt&&se!=="inline",popupClassName:P,popupOffset:A,popupStyle:D,popup:I.createElement(kx,{mode:$n==="horizontal"?"vertical":$n},I.createElement(XO,{id:Pn,ref:vt},y)),disabled:Ke,onVisibleChange:Kn},un)}var Ln=I.createElement(Lu.Item,kn({ref:t,role:"none"},Y,{component:"li",style:n,className:St(at,"".concat(at,"-").concat(se),i,ke(ke(ke(ke({},"".concat(at,"-open"),Rt),"".concat(at,"-active"),Jt),"".concat(at,"-selected"),pt),"".concat(at,"-disabled"),Ke)),onMouseEnter:Mt,onMouseLeave:hn}),un,!fe&&I.createElement(Tle,{id:Pn,open:Rt,keyPath:qe},y));return We&&(Ln=We(Ln,e,{selected:pt,active:Jt,open:Rt,disabled:Ke})),I.createElement(kx,{onItemClick:On,mode:se==="horizontal"?"vertical":se,itemIcon:Pt,expandIcon:ft},Ln)}),IE=I.forwardRef(function(e,t){var n=e.eventKey,i=e.children,s=Jv(n),d=ZO(i,s),f=TE();I.useEffect(function(){if(f)return f.registerPath(n,s),function(){f.unregisterPath(n,s)}},[s]);var o;return f?o=d:o=I.createElement(Mle,kn({ref:t},e),d),I.createElement(GH.Provider,{value:s},o)});function YO(e){var t=e.className,n=e.style,i=I.useContext(Qc),s=i.prefixCls,d=TE();return d?null:I.createElement("li",{role:"separator",className:St("".concat(s,"-item-divider"),t),style:n})}var Rle=["className","title","eventKey","children"],Ale=I.forwardRef(function(e,t){var n=e.className,i=e.title;e.eventKey;var s=e.children,d=ri(e,Rle),f=I.useContext(Qc),o=f.prefixCls,y="".concat(o,"-item-group");return I.createElement("li",kn({ref:t,role:"presentation"},d,{onClick:function(C){return C.stopPropagation()},className:St(y,n)}),I.createElement("div",{role:"presentation",className:"".concat(y,"-title"),title:typeof i=="string"?i:void 0},i),I.createElement("ul",{role:"group",className:"".concat(y,"-list")},s))}),JO=I.forwardRef(function(e,t){var n=e.eventKey,i=e.children,s=Jv(n),d=ZO(i,s),f=TE();return f?d:I.createElement(Ale,kn({ref:t},as(e,["warnKey"])),d)}),Ole=["label","children","key","type","extra"];function OR(e,t,n){var i=t.item,s=t.group,d=t.submenu,f=t.divider;return(e||[]).map(function(o,y){if(o&&Nr(o)==="object"){var b=o,C=b.label,P=b.children,A=b.key,D=b.type,k=b.extra,B=ri(b,Ole),N=A??"tmp-".concat(y);return P||D==="group"?D==="group"?I.createElement(s,kn({key:N},B,{title:C}),OR(P,t,n)):I.createElement(d,kn({key:N},B,{title:C}),OR(P,t,n)):D==="divider"?I.createElement(f,kn({key:N},B)):I.createElement(i,kn({key:N},B,{extra:k}),C,(!!k||k===0)&&I.createElement("span",{className:"".concat(n,"-item-extra")},k))}return null}).filter(function(o){return o})}function JB(e,t,n,i,s){var d=e,f=Je({divider:YO,item:sb,group:JO,submenu:IE},i);return t&&(d=OR(t,f,s)),ZO(d,n)}var Dle=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem","_internalComponents"],_p=[],Lle=I.forwardRef(function(e,t){var n,i=e,s=i.prefixCls,d=s===void 0?"rc-menu":s,f=i.rootClassName,o=i.style,y=i.className,b=i.tabIndex,C=b===void 0?0:b,P=i.items,A=i.children,D=i.direction,k=i.id,B=i.mode,N=B===void 0?"vertical":B,j=i.inlineCollapsed,V=i.disabled,K=i.disabledOverflow,Y=i.subMenuOpenDelay,Z=Y===void 0?.1:Y,te=i.subMenuCloseDelay,ne=te===void 0?.1:te,se=i.forceSubMenuRender,ee=i.defaultOpenKeys,de=i.openKeys,fe=i.activeKey,ye=i.defaultActiveFirst,ge=i.selectable,we=ge===void 0?!0:ge,Se=i.multiple,xe=Se===void 0?!1:Se,Te=i.defaultSelectedKeys,ze=i.selectedKeys,Ue=i.onSelect,We=i.onDeselect,Be=i.inlineIndent,Xe=Be===void 0?24:Be,qe=i.motion,at=i.defaultMotions,Ke=i.triggerSubMenuAction,tt=Ke===void 0?"hover":Ke,vt=i.builtinPlacements,Pt=i.itemIcon,ft=i.expandIcon,Nt=i.overflowedIndicator,Rt=Nt===void 0?"...":Nt,pt=i.overflowedIndicatorPopupClassName,yt=i.getPopupContainer,xt=i.onClick,bt=i.onOpenChange,Ct=i.onKeyDown;i.openAnimation,i.openTransitionName;var tn=i._internalRenderMenuItem,Zt=i._internalRenderSubMenuItem,In=i._internalComponents,Cn=ri(i,Dle),Mt=I.useMemo(function(){return[JB(A,P,_p,In,d),JB(A,P,_p,{},d)]},[A,P,In]),hn=It(Mt,2),Jt=hn[0],Ut=hn[1],Tn=I.useState(!1),On=It(Tn,2),Kn=On[0],Un=On[1],Pn=I.useRef(),Qn=hle(k),un=D==="rtl",nn=is(ee,{value:de,postState:function(wr){return wr||_p}}),$n=It(nn,2),Ln=$n[0],qn=$n[1],er=function(wr){var nr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function xi(){qn(wr),bt==null||bt(wr)}nr?ku.flushSync(xi):xi()},tr=I.useState(Ln),Jn=It(tr,2),Ir=Jn[0],_r=Jn[1],$r=I.useRef(!1),mr=I.useMemo(function(){return(N==="inline"||N==="vertical")&&j?["vertical",j]:[N,!1]},[N,j]),yi=It(mr,2),Vr=yi[0],Kr=yi[1],Rr=Vr==="inline",ii=I.useState(Vr),Hr=It(ii,2),ut=Hr[0],ur=Hr[1],fr=I.useState(Kr),Fn=It(fr,2),Gt=Fn[0],mn=Fn[1];I.useEffect(function(){ur(Vr),mn(Kr),$r.current&&(Rr?qn(Ir):er(_p))},[Vr,Kr]);var Xn=I.useState(0),gr=It(Xn,2),je=gr[0],re=gr[1],ie=je>=Jt.length-1||ut!=="horizontal"||K;I.useEffect(function(){Rr&&_r(Ln)},[Ln]),I.useEffect(function(){return $r.current=!0,function(){$r.current=!1}},[]);var _e=ule(),Re=_e.registerPath,De=_e.unregisterPath,Ge=_e.refreshOverflowKeys,ot=_e.isSubPathKey,Ye=_e.getKeyPath,rt=_e.getKeys,zt=_e.getSubPathKeys,it=I.useMemo(function(){return{registerPath:Re,unregisterPath:De}},[Re,De]),$t=I.useMemo(function(){return{isSubPathKey:ot}},[ot]);I.useEffect(function(){Ge(ie?_p:Jt.slice(je+1).map(function(Ti){return Ti.key}))},[je,ie]);var Qt=is(fe||ye&&((n=Jt[0])===null||n===void 0?void 0:n.key),{value:fe}),Ft=It(Qt,2),jt=Ft[0],rn=Ft[1],yn=P0(function(Ti){rn(Ti)}),rr=P0(function(){rn(void 0)});I.useImperativeHandle(t,function(){return{list:Pn.current,focus:function(wr){var nr,xi=rt(),oi=RR(xi,Qn),Li=oi.elements,ki=oi.key2element,ho=oi.element2key,Uo=qO(Pn.current,Li),Qo=jt??(Uo[0]?ho.get(Uo[0]):(nr=Jt.find(function(Oo){return!Oo.props.disabled}))===null||nr===void 0?void 0:nr.key),Ho=ki.get(Qo);if(Qo&&Ho){var ea;Ho==null||(ea=Ho.focus)===null||ea===void 0||ea.call(Ho,wr)}}}});var En=is(Te||[],{value:ze,postState:function(wr){return Array.isArray(wr)?wr:wr==null?_p:[wr]}}),Zn=It(En,2),ar=Zn[0],qr=Zn[1],Ar=function(wr){if(we){var nr=wr.key,xi=ar.includes(nr),oi;xe?xi?oi=ar.filter(function(ki){return ki!==nr}):oi=[].concat(zn(ar),[nr]):oi=[nr],qr(oi);var Li=Je(Je({},wr),{},{selectedKeys:oi});xi?We==null||We(Li):Ue==null||Ue(Li)}!xe&&Ln.length&&ut!=="inline"&&er(_p)},yr=P0(function(Ti){xt==null||xt(dC(Ti)),Ar(Ti)}),Jr=P0(function(Ti,wr){var nr=Ln.filter(function(oi){return oi!==Ti});if(wr)nr.push(Ti);else if(ut!=="inline"){var xi=zt(Ti);nr=nr.filter(function(oi){return!xi.has(oi)})}Yc(Ln,nr,!0)||er(nr,!0)}),ni=function(wr,nr){var xi=nr??!Ln.includes(wr);Jr(wr,xi)},Qr=sle(ut,jt,un,Qn,Pn,rt,Ye,rn,ni,Ct);I.useEffect(function(){Un(!0)},[]);var li=I.useMemo(function(){return{_internalRenderMenuItem:tn,_internalRenderSubMenuItem:Zt}},[tn,Zt]),Ui=ut!=="horizontal"||K?Jt:Jt.map(function(Ti,wr){return I.createElement(kx,{key:Ti.key,overflowDisabled:wr>je},Ti)}),oo=I.createElement(Lu,kn({id:k,ref:Pn,prefixCls:"".concat(d,"-overflow"),component:"ul",itemComponent:sb,className:St(d,"".concat(d,"-root"),"".concat(d,"-").concat(ut),y,ke(ke({},"".concat(d,"-inline-collapsed"),Gt),"".concat(d,"-rtl"),un),f),dir:D,style:o,role:"menu",tabIndex:C,data:Ui,renderRawItem:function(wr){return wr},renderRawRest:function(wr){var nr=wr.length,xi=nr?Jt.slice(-nr):null;return I.createElement(IE,{eventKey:AR,title:Rt,disabled:ie,internalPopupClose:nr===0,popupClassName:pt},xi)},maxCount:ut!=="horizontal"||K?Lu.INVALIDATE:Lu.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(wr){re(wr)},onKeyDown:Qr},Cn));return I.createElement(WO.Provider,{value:li},I.createElement(jH.Provider,{value:Qn},I.createElement(kx,{prefixCls:d,rootClassName:f,mode:ut,openKeys:Ln,rtl:un,disabled:V,motion:Kn?qe:null,defaultMotions:Kn?at:null,activeKey:jt,onActive:yn,onInactive:rr,selectedKeys:ar,inlineIndent:Xe,subMenuOpenDelay:Z,subMenuCloseDelay:ne,forceSubMenuRender:se,builtinPlacements:vt,triggerSubMenuAction:tt,getPopupContainer:yt,itemIcon:Pt,expandIcon:ft,onItemClick:yr,onOpenChange:Jr},I.createElement(WH.Provider,{value:$t},oo),I.createElement("div",{style:{display:"none"},"aria-hidden":!0},I.createElement(HH.Provider,{value:it},Ut)))))}),Qv=Lle;Qv.Item=sb;Qv.SubMenu=IE;Qv.ItemGroup=JO;Qv.Divider=YO;const JH=I.createContext({});var zle={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},kle=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:zle}))},QO=I.forwardRef(kle);const hC=I.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1});var Fle=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const QH=e=>{const{prefixCls:t,className:n,dashed:i}=e,s=Fle(e,["prefixCls","className","dashed"]),{getPrefixCls:d}=I.useContext(ji),f=d("menu",t),o=St({[`${f}-item-divider-dashed`]:!!i},n);return I.createElement(YO,Object.assign({className:o},s))},e8=e=>{var t;const{className:n,children:i,icon:s,title:d,danger:f,extra:o}=e,{prefixCls:y,firstLevel:b,direction:C,disableMenuItemTitleTooltip:P,inlineCollapsed:A}=I.useContext(hC),D=K=>{const Y=i==null?void 0:i[0],Z=I.createElement("span",{className:St(`${y}-title-content`,{[`${y}-title-content-with-extra`]:!!o||o===0})},i);return(!s||I.isValidElement(i)&&i.type==="span")&&i&&K&&b&&typeof Y=="string"?I.createElement("div",{className:`${y}-inline-collapsed-noicon`},Y.charAt(0)):Z},{siderCollapsed:k}=I.useContext(JH);let B=d;typeof d>"u"?B=b?i:"":d===!1&&(B="");const N={title:B};!k&&!A&&(N.title=null,N.open=!1);const j=vc(i).length;let V=I.createElement(sb,Object.assign({},as(e,["title","icon","danger"]),{className:St({[`${y}-item-danger`]:f,[`${y}-item-only-child`]:(s?j+1:j)===1},n),title:typeof d=="string"?d:void 0}),Bu(s,{className:St(I.isValidElement(s)?(t=s.props)===null||t===void 0?void 0:t.className:void 0,`${y}-item-icon`)}),D(A));return P||(V=I.createElement(zx,Object.assign({},N,{placement:C==="rtl"?"left":"right",classNames:{root:`${y}-inline-collapsed-tooltip`}}),V)),V};var Nle=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const fC=I.createContext(null),t8=I.forwardRef((e,t)=>{const{children:n}=e,i=Nle(e,["children"]),s=I.useContext(fC),d=I.useMemo(()=>Object.assign(Object.assign({},s),i),[s,i.prefixCls,i.mode,i.selectable,i.rootClassName]),f=KY(n),o=bf(t,f?rm(n):null);return I.createElement(fC.Provider,{value:d},I.createElement(Ox,{space:!0},f?I.cloneElement(n,{ref:o}):n))}),Ble=e=>{const{componentCls:t,motionDurationSlow:n,horizontalLineHeight:i,colorSplit:s,lineWidth:d,lineType:f,itemPaddingInline:o}=e;return{[`${t}-horizontal`]:{lineHeight:i,border:0,borderBottom:`${dt(d)} ${f} ${s}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${t}-item, ${t}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:o},[`> ${t}-item:hover,
        > ${t}-item-active,
        > ${t}-submenu ${t}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${t}-item, ${t}-submenu-title`]:{transition:[`border-color ${n}`,`background ${n}`].join(",")},[`${t}-submenu-arrow`]:{display:"none"}}}},$le=({componentCls:e,menuArrowOffset:t,calc:n})=>({[`${e}-rtl`]:{direction:"rtl"},[`${e}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${e}-rtl${e}-vertical,
    ${e}-submenu-rtl ${e}-vertical`]:{[`${e}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(${dt(n(t).mul(-1).equal())})`},"&::after":{transform:`rotate(45deg) translateY(${dt(t)})`}}}}),QB=e=>Nu(e),e$=(e,t)=>{const{componentCls:n,itemColor:i,itemSelectedColor:s,subMenuItemSelectedColor:d,groupTitleColor:f,itemBg:o,subMenuItemBg:y,itemSelectedBg:b,activeBarHeight:C,activeBarWidth:P,activeBarBorderWidth:A,motionDurationSlow:D,motionEaseInOut:k,motionEaseOut:B,itemPaddingInline:N,motionDurationMid:j,itemHoverColor:V,lineType:K,colorSplit:Y,itemDisabledColor:Z,dangerItemColor:te,dangerItemHoverColor:ne,dangerItemSelectedColor:se,dangerItemActiveBg:ee,dangerItemSelectedBg:de,popupBg:fe,itemHoverBg:ye,itemActiveBg:ge,menuSubMenuBg:we,horizontalItemSelectedColor:Se,horizontalItemSelectedBg:xe,horizontalItemBorderRadius:Te,horizontalItemHoverBg:ze}=e;return{[`${n}-${t}, ${n}-${t} > ${n}`]:{color:i,background:o,[`&${n}-root:focus-visible`]:Object.assign({},QB(e)),[`${n}-item`]:{"&-group-title, &-extra":{color:f}},[`${n}-submenu-selected > ${n}-submenu-title`]:{color:d},[`${n}-item, ${n}-submenu-title`]:{color:i,[`&:not(${n}-item-disabled):focus-visible`]:Object.assign({},QB(e))},[`${n}-item-disabled, ${n}-submenu-disabled`]:{color:`${Z} !important`},[`${n}-item:not(${n}-item-selected):not(${n}-submenu-selected)`]:{[`&:hover, > ${n}-submenu-title:hover`]:{color:V}},[`&:not(${n}-horizontal)`]:{[`${n}-item:not(${n}-item-selected)`]:{"&:hover":{backgroundColor:ye},"&:active":{backgroundColor:ge}},[`${n}-submenu-title`]:{"&:hover":{backgroundColor:ye},"&:active":{backgroundColor:ge}}},[`${n}-item-danger`]:{color:te,[`&${n}-item:hover`]:{[`&:not(${n}-item-selected):not(${n}-submenu-selected)`]:{color:ne}},[`&${n}-item:active`]:{background:ee}},[`${n}-item a`]:{"&, &:hover":{color:"inherit"}},[`${n}-item-selected`]:{color:s,[`&${n}-item-danger`]:{color:se},"a, a:hover":{color:"inherit"}},[`& ${n}-item-selected`]:{backgroundColor:b,[`&${n}-item-danger`]:{backgroundColor:de}},[`&${n}-submenu > ${n}`]:{backgroundColor:we},[`&${n}-popup > ${n}`]:{backgroundColor:fe},[`&${n}-submenu-popup > ${n}`]:{backgroundColor:fe},[`&${n}-horizontal`]:Object.assign(Object.assign({},t==="dark"?{borderBottom:0}:{}),{[`> ${n}-item, > ${n}-submenu`]:{top:A,marginTop:e.calc(A).mul(-1).equal(),marginBottom:0,borderRadius:Te,"&::after":{position:"absolute",insetInline:N,bottom:0,borderBottom:`${dt(C)} solid transparent`,transition:`border-color ${D} ${k}`,content:'""'},"&:hover, &-active, &-open":{background:ze,"&::after":{borderBottomWidth:C,borderBottomColor:Se}},"&-selected":{color:Se,backgroundColor:xe,"&:hover":{backgroundColor:xe},"&::after":{borderBottomWidth:C,borderBottomColor:Se}}}}),[`&${n}-root`]:{[`&${n}-inline, &${n}-vertical`]:{borderInlineEnd:`${dt(A)} ${K} ${Y}`}},[`&${n}-inline`]:{[`${n}-sub${n}-inline`]:{background:y},[`${n}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${dt(P)} solid ${s}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${j} ${B}`,`opacity ${j} ${B}`].join(","),content:'""'},[`&${n}-item-danger`]:{"&::after":{borderInlineEndColor:se}}},[`${n}-selected, ${n}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${j} ${k}`,`opacity ${j} ${k}`].join(",")}}}}}},t$=e=>{const{componentCls:t,itemHeight:n,itemMarginInline:i,padding:s,menuArrowSize:d,marginXS:f,itemMarginBlock:o,itemWidth:y,itemPaddingInline:b}=e,C=e.calc(d).add(s).add(f).equal();return{[`${t}-item`]:{position:"relative",overflow:"hidden"},[`${t}-item, ${t}-submenu-title`]:{height:n,lineHeight:dt(n),paddingInline:b,overflow:"hidden",textOverflow:"ellipsis",marginInline:i,marginBlock:o,width:y},[`> ${t}-item,
            > ${t}-submenu > ${t}-submenu-title`]:{height:n,lineHeight:dt(n)},[`${t}-item-group-list ${t}-submenu-title,
            ${t}-submenu-title`]:{paddingInlineEnd:C}}},jle=e=>{const{componentCls:t,iconCls:n,itemHeight:i,colorTextLightSolid:s,dropdownWidth:d,controlHeightLG:f,motionEaseOut:o,paddingXL:y,itemMarginInline:b,fontSizeLG:C,motionDurationFast:P,motionDurationSlow:A,paddingXS:D,boxShadowSecondary:k,collapsedWidth:B,collapsedIconSize:N}=e,j={height:i,lineHeight:dt(i),listStylePosition:"inside",listStyleType:"disc"};return[{[t]:{"&-inline, &-vertical":Object.assign({[`&${t}-root`]:{boxShadow:"none"}},t$(e))},[`${t}-submenu-popup`]:{[`${t}-vertical`]:Object.assign(Object.assign({},t$(e)),{boxShadow:k})}},{[`${t}-submenu-popup ${t}-vertical${t}-sub`]:{minWidth:d,maxHeight:`calc(100vh - ${dt(e.calc(f).mul(2.5).equal())})`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${t}-inline`]:{width:"100%",[`&${t}-root`]:{[`${t}-item, ${t}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${A}`,`background ${A}`,`padding ${P} ${o}`].join(","),[`> ${t}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${t}-sub${t}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${t}-submenu > ${t}-submenu-title`]:j,[`& ${t}-item-group-title`]:{paddingInlineStart:y}},[`${t}-item`]:j}},{[`${t}-inline-collapsed`]:{width:B,[`&${t}-root`]:{[`${t}-item, ${t}-submenu ${t}-submenu-title`]:{[`> ${t}-inline-collapsed-noicon`]:{fontSize:C,textAlign:"center"}}},[`> ${t}-item,
          > ${t}-item-group > ${t}-item-group-list > ${t}-item,
          > ${t}-item-group > ${t}-item-group-list > ${t}-submenu > ${t}-submenu-title,
          > ${t}-submenu > ${t}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${dt(e.calc(N).div(2).equal())} - ${dt(b)})`,textOverflow:"clip",[`
            ${t}-submenu-arrow,
            ${t}-submenu-expand-icon
          `]:{opacity:0},[`${t}-item-icon, ${n}`]:{margin:0,fontSize:N,lineHeight:dt(i),"+ span":{display:"inline-block",opacity:0}}},[`${t}-item-icon, ${n}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${t}-item-icon, ${n}`]:{display:"none"},"a, a:hover":{color:s}},[`${t}-item-group-title`]:Object.assign(Object.assign({},df),{paddingInline:D})}}]},n$=e=>{const{componentCls:t,motionDurationSlow:n,motionDurationMid:i,motionEaseInOut:s,motionEaseOut:d,iconCls:f,iconSize:o,iconMarginInlineEnd:y}=e;return{[`${t}-item, ${t}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${n}`,`background ${n}`,`padding calc(${n} + 0.1s) ${s}`].join(","),[`${t}-item-icon, ${f}`]:{minWidth:o,fontSize:o,transition:[`font-size ${i} ${d}`,`margin ${n} ${s}`,`color ${n}`].join(","),"+ span":{marginInlineStart:y,opacity:1,transition:[`opacity ${n} ${s}`,`margin ${n}`,`color ${n}`].join(",")}},[`${t}-item-icon`]:Object.assign({},nb()),[`&${t}-item-only-child`]:{[`> ${f}, > ${t}-item-icon`]:{marginInlineEnd:0}}},[`${t}-item-disabled, ${t}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important",cursor:"not-allowed",pointerEvents:"none"},[`> ${t}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},r$=e=>{const{componentCls:t,motionDurationSlow:n,motionEaseInOut:i,borderRadius:s,menuArrowSize:d,menuArrowOffset:f}=e;return{[`${t}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:e.margin,width:d,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${n} ${i}, opacity ${n}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:e.calc(d).mul(.6).equal(),height:e.calc(d).mul(.15).equal(),backgroundColor:"currentcolor",borderRadius:s,transition:[`background ${n} ${i}`,`transform ${n} ${i}`,`top ${n} ${i}`,`color ${n} ${i}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(${dt(e.calc(f).mul(-1).equal())})`},"&::after":{transform:`rotate(-45deg) translateY(${dt(f)})`}}}}},Vle=e=>{const{antCls:t,componentCls:n,fontSize:i,motionDurationSlow:s,motionDurationMid:d,motionEaseInOut:f,paddingXS:o,padding:y,colorSplit:b,lineWidth:C,zIndexPopup:P,borderRadiusLG:A,subMenuItemBorderRadius:D,menuArrowSize:k,menuArrowOffset:B,lineType:N,groupTitleLineHeight:j,groupTitleFontSize:V}=e;return[{"":{[n]:Object.assign(Object.assign({},Kp()),{"&-hidden":{display:"none"}})},[`${n}-submenu-hidden`]:{display:"none"}},{[n]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ya(e)),Kp()),{marginBottom:0,paddingInlineStart:0,fontSize:i,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${s} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${n}-item`]:{flex:"none"}},[`${n}-item, ${n}-submenu, ${n}-submenu-title`]:{borderRadius:e.itemBorderRadius},[`${n}-item-group-title`]:{padding:`${dt(o)} ${dt(y)}`,fontSize:V,lineHeight:j,transition:`all ${s}`},[`&-horizontal ${n}-submenu`]:{transition:[`border-color ${s} ${f}`,`background ${s} ${f}`].join(",")},[`${n}-submenu, ${n}-submenu-inline`]:{transition:[`border-color ${s} ${f}`,`background ${s} ${f}`,`padding ${d} ${f}`].join(",")},[`${n}-submenu ${n}-sub`]:{cursor:"initial",transition:[`background ${s} ${f}`,`padding ${s} ${f}`].join(",")},[`${n}-title-content`]:{transition:`color ${s}`,"&-with-extra":{display:"inline-flex",alignItems:"center",width:"100%"},[`> ${t}-typography-ellipsis-single-line`]:{display:"inline",verticalAlign:"unset"},[`${n}-item-extra`]:{marginInlineStart:"auto",paddingInlineStart:e.padding}},[`${n}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${n}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:b,borderStyle:N,borderWidth:0,borderTopWidth:C,marginBlock:C,padding:0,"&-dashed":{borderStyle:"dashed"}}}),n$(e)),{[`${n}-item-group`]:{[`${n}-item-group-list`]:{margin:0,padding:0,[`${n}-item, ${n}-submenu-title`]:{paddingInline:`${dt(e.calc(i).mul(2).equal())} ${dt(y)}`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:P,borderRadius:A,boxShadow:"none",transformOrigin:"0 0",[`&${n}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:0,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'},[`> ${n}`]:Object.assign(Object.assign(Object.assign({borderRadius:A},n$(e)),r$(e)),{[`${n}-item, ${n}-submenu > ${n}-submenu-title`]:{borderRadius:D},[`${n}-submenu-title::after`]:{transition:`transform ${s} ${f}`}})},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:e.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:e.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:e.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:e.paddingXS}}}),r$(e)),{[`&-inline-collapsed ${n}-submenu-arrow,
        &-inline ${n}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${dt(B)})`},"&::after":{transform:`rotate(45deg) translateX(${dt(e.calc(B).mul(-1).equal())})`}},[`${n}-submenu-open${n}-submenu-inline > ${n}-submenu-title > ${n}-submenu-arrow`]:{transform:`translateY(${dt(e.calc(k).mul(.2).mul(-1).equal())})`,"&::after":{transform:`rotate(-45deg) translateX(${dt(e.calc(B).mul(-1).equal())})`},"&::before":{transform:`rotate(45deg) translateX(${dt(B)})`}}})},{[`${t}-layout-header`]:{[n]:{lineHeight:"inherit"}}}]},Ule=e=>{var t,n,i;const{colorPrimary:s,colorError:d,colorTextDisabled:f,colorErrorBg:o,colorText:y,colorTextDescription:b,colorBgContainer:C,colorFillAlter:P,colorFillContent:A,lineWidth:D,lineWidthBold:k,controlItemBgActive:B,colorBgTextHover:N,controlHeightLG:j,lineHeight:V,colorBgElevated:K,marginXXS:Y,padding:Z,fontSize:te,controlHeightSM:ne,fontSizeLG:se,colorTextLightSolid:ee,colorErrorHover:de}=e,fe=(t=e.activeBarWidth)!==null&&t!==void 0?t:0,ye=(n=e.activeBarBorderWidth)!==null&&n!==void 0?n:D,ge=(i=e.itemMarginInline)!==null&&i!==void 0?i:e.marginXXS,we=new no(ee).setA(.65).toRgbString();return{dropdownWidth:160,zIndexPopup:e.zIndexPopupBase+50,radiusItem:e.borderRadiusLG,itemBorderRadius:e.borderRadiusLG,radiusSubMenuItem:e.borderRadiusSM,subMenuItemBorderRadius:e.borderRadiusSM,colorItemText:y,itemColor:y,colorItemTextHover:y,itemHoverColor:y,colorItemTextHoverHorizontal:s,horizontalItemHoverColor:s,colorGroupTitle:b,groupTitleColor:b,colorItemTextSelected:s,itemSelectedColor:s,subMenuItemSelectedColor:s,colorItemTextSelectedHorizontal:s,horizontalItemSelectedColor:s,colorItemBg:C,itemBg:C,colorItemBgHover:N,itemHoverBg:N,colorItemBgActive:A,itemActiveBg:B,colorSubItemBg:P,subMenuItemBg:P,colorItemBgSelected:B,itemSelectedBg:B,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:fe,colorActiveBarHeight:k,activeBarHeight:k,colorActiveBarBorderSize:D,activeBarBorderWidth:ye,colorItemTextDisabled:f,itemDisabledColor:f,colorDangerItemText:d,dangerItemColor:d,colorDangerItemTextHover:d,dangerItemHoverColor:d,colorDangerItemTextSelected:d,dangerItemSelectedColor:d,colorDangerItemBgActive:o,dangerItemActiveBg:o,colorDangerItemBgSelected:o,dangerItemSelectedBg:o,itemMarginInline:ge,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent",itemHeight:j,groupTitleLineHeight:V,collapsedWidth:j*2,popupBg:K,itemMarginBlock:Y,itemPaddingInline:Z,horizontalLineHeight:`${j*1.15}px`,iconSize:te,iconMarginInlineEnd:ne-te,collapsedIconSize:se,groupTitleFontSize:te,darkItemDisabledColor:new no(ee).setA(.25).toRgbString(),darkItemColor:we,darkDangerItemColor:d,darkItemBg:"#001529",darkPopupBg:"#001529",darkSubMenuItemBg:"#000c17",darkItemSelectedColor:ee,darkItemSelectedBg:s,darkDangerItemSelectedBg:d,darkItemHoverBg:"transparent",darkGroupTitleColor:we,darkItemHoverColor:ee,darkDangerItemHoverColor:de,darkDangerItemSelectedColor:ee,darkDangerItemActiveBg:d,itemWidth:fe?`calc(100% + ${ye}px)`:`calc(100% - ${ge*2}px)`}},Hle=(e,t=e,n=!0)=>za("Menu",s=>{const{colorBgElevated:d,controlHeightLG:f,fontSize:o,darkItemColor:y,darkDangerItemColor:b,darkItemBg:C,darkSubMenuItemBg:P,darkItemSelectedColor:A,darkItemSelectedBg:D,darkDangerItemSelectedBg:k,darkItemHoverBg:B,darkGroupTitleColor:N,darkItemHoverColor:j,darkItemDisabledColor:V,darkDangerItemHoverColor:K,darkDangerItemSelectedColor:Y,darkDangerItemActiveBg:Z,popupBg:te,darkPopupBg:ne}=s,se=s.calc(o).div(7).mul(5).equal(),ee=xo(s,{menuArrowSize:se,menuHorizontalHeight:s.calc(f).mul(1.15).equal(),menuArrowOffset:s.calc(se).mul(.25).equal(),menuSubMenuBg:d,calc:s.calc,popupBg:te}),de=xo(ee,{itemColor:y,itemHoverColor:j,groupTitleColor:N,itemSelectedColor:A,subMenuItemSelectedColor:A,itemBg:C,popupBg:ne,subMenuItemBg:P,itemActiveBg:"transparent",itemSelectedBg:D,activeBarHeight:0,activeBarBorderWidth:0,itemHoverBg:B,itemDisabledColor:V,dangerItemColor:b,dangerItemHoverColor:K,dangerItemSelectedColor:Y,dangerItemActiveBg:Z,dangerItemSelectedBg:k,menuSubMenuBg:P,horizontalItemSelectedColor:A,horizontalItemSelectedBg:D});return[Vle(ee),Ble(ee),jle(ee),e$(ee,"light"),e$(de,"dark"),$le(ee),KU(ee),ff(ee,"slide-up"),ff(ee,"slide-down"),DO(ee,"zoom-big")]},Ule,{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"],["colorItemBgSelected","itemSelectedBg"]],injectStyle:n,unitless:{groupTitleLineHeight:!0}})(e,t),n8=e=>{var t;const{popupClassName:n,icon:i,title:s,theme:d}=e,f=I.useContext(hC),{prefixCls:o,inlineCollapsed:y,theme:b}=f,C=Jv();let P;if(!i)P=y&&!C.length&&s&&typeof s=="string"?I.createElement("div",{className:`${o}-inline-collapsed-noicon`},s.charAt(0)):I.createElement("span",{className:`${o}-title-content`},s);else{const k=I.isValidElement(s)&&s.type==="span";P=I.createElement(I.Fragment,null,Bu(i,{className:St(I.isValidElement(i)?(t=i.props)===null||t===void 0?void 0:t.className:void 0,`${o}-item-icon`)}),k?s:I.createElement("span",{className:`${o}-title-content`},s))}const A=I.useMemo(()=>Object.assign(Object.assign({},f),{firstLevel:!1}),[f]),[D]=lE("Menu");return I.createElement(hC.Provider,{value:A},I.createElement(IE,Object.assign({},as(e,["icon"]),{title:P,popupClassName:St(o,n,`${o}-${d||b}`),popupStyle:Object.assign({zIndex:D},e.popupStyle)})))};var Gle=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function rP(e){return e===null||e===!1}const Wle={item:e8,submenu:n8,divider:QH},qle=I.forwardRef((e,t)=>{var n;const i=I.useContext(fC),s=i||{},{getPrefixCls:d,getPopupContainer:f,direction:o,menu:y}=I.useContext(ji),b=d(),{prefixCls:C,className:P,style:A,theme:D="light",expandIcon:k,_internalDisableMenuItemTitleTooltip:B,inlineCollapsed:N,siderCollapsed:j,rootClassName:V,mode:K,selectable:Y,onClick:Z,overflowedIndicatorPopupClassName:te}=e,ne=Gle(e,["prefixCls","className","style","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),se=as(ne,["collapsedWidth"]);(n=s.validator)===null||n===void 0||n.call(s,{mode:K});const ee=Io((...Xe)=>{var qe;Z==null||Z.apply(void 0,Xe),(qe=s.onClick)===null||qe===void 0||qe.call(s)}),de=s.mode||K,fe=Y??s.selectable,ye=N??j,ge={horizontal:{motionName:`${b}-slide-up`},inline:HU(b),other:{motionName:`${b}-zoom-big`}},we=d("menu",C||s.prefixCls),Se=Wu(we),[xe,Te,ze]=Hle(we,Se,!i),Ue=St(`${we}-${D}`,y==null?void 0:y.className,P),We=I.useMemo(()=>{var Xe,qe;if(typeof k=="function"||rP(k))return k||null;if(typeof s.expandIcon=="function"||rP(s.expandIcon))return s.expandIcon||null;if(typeof(y==null?void 0:y.expandIcon)=="function"||rP(y==null?void 0:y.expandIcon))return(y==null?void 0:y.expandIcon)||null;const at=(Xe=k??(s==null?void 0:s.expandIcon))!==null&&Xe!==void 0?Xe:y==null?void 0:y.expandIcon;return Bu(at,{className:St(`${we}-submenu-expand-icon`,I.isValidElement(at)?(qe=at.props)===null||qe===void 0?void 0:qe.className:void 0)})},[k,s==null?void 0:s.expandIcon,y==null?void 0:y.expandIcon,we]),Be=I.useMemo(()=>({prefixCls:we,inlineCollapsed:ye||!1,direction:o,firstLevel:!0,theme:D,mode:de,disableMenuItemTitleTooltip:B}),[we,ye,o,B,D]);return xe(I.createElement(fC.Provider,{value:null},I.createElement(hC.Provider,{value:Be},I.createElement(Qv,Object.assign({getPopupContainer:f,overflowedIndicator:I.createElement(QO,null),overflowedIndicatorPopupClassName:St(we,`${we}-${D}`,te),mode:de,selectable:fe,onClick:ee},se,{inlineCollapsed:ye,style:Object.assign(Object.assign({},y==null?void 0:y.style),A),className:Ue,prefixCls:we,direction:o,defaultMotions:ge,expandIcon:We,ref:t,rootClassName:St(V,Te,s.rootClassName,ze,Se),_internalComponents:Wle})))))}),pf=I.forwardRef((e,t)=>{const n=I.useRef(null),i=I.useContext(JH);return I.useImperativeHandle(t,()=>({menu:n.current,focus:s=>{var d;(d=n.current)===null||d===void 0||d.focus(s)}})),I.createElement(qle,Object.assign({ref:n},e,i))});pf.Item=e8;pf.SubMenu=n8;pf.Divider=QH;pf.ItemGroup=JO;const Kle=e=>{const{componentCls:t,menuCls:n,colorError:i,colorTextLightSolid:s}=e,d=`${n}-item`;return{[`${t}, ${t}-menu-submenu`]:{[`${n} ${d}`]:{[`&${d}-danger:not(${d}-disabled)`]:{color:i,"&:hover":{color:s,backgroundColor:i}}}}}},Xle=e=>{const{componentCls:t,menuCls:n,zIndexPopup:i,dropdownArrowDistance:s,sizePopupArrow:d,antCls:f,iconCls:o,motionDurationMid:y,paddingBlock:b,fontSize:C,dropdownEdgeChildPadding:P,colorTextDisabled:A,fontSizeIcon:D,controlPaddingHorizontal:k,colorBgElevated:B}=e;return[{[t]:{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:i,display:"block","&::before":{position:"absolute",insetBlock:e.calc(d).div(2).sub(s).equal(),zIndex:-9999,opacity:1e-4,content:'""'},"&-menu-vertical":{maxHeight:"100vh",overflowY:"auto"},[`&-trigger${f}-btn`]:{[`& > ${o}-down, & > ${f}-btn-icon > ${o}-down`]:{fontSize:D}},[`${t}-wrap`]:{position:"relative",[`${f}-btn > ${o}-down`]:{fontSize:D},[`${o}-down::before`]:{transition:`transform ${y}`}},[`${t}-wrap-open`]:{[`${o}-down::before`]:{transform:"rotate(180deg)"}},"\n        &-hidden,\n        &-menu-hidden,\n        &-menu-submenu-hidden\n      ":{display:"none"},[`&${f}-slide-down-enter${f}-slide-down-enter-active${t}-placement-bottomLeft,
          &${f}-slide-down-appear${f}-slide-down-appear-active${t}-placement-bottomLeft,
          &${f}-slide-down-enter${f}-slide-down-enter-active${t}-placement-bottom,
          &${f}-slide-down-appear${f}-slide-down-appear-active${t}-placement-bottom,
          &${f}-slide-down-enter${f}-slide-down-enter-active${t}-placement-bottomRight,
          &${f}-slide-down-appear${f}-slide-down-appear-active${t}-placement-bottomRight`]:{animationName:MO},[`&${f}-slide-up-enter${f}-slide-up-enter-active${t}-placement-topLeft,
          &${f}-slide-up-appear${f}-slide-up-appear-active${t}-placement-topLeft,
          &${f}-slide-up-enter${f}-slide-up-enter-active${t}-placement-top,
          &${f}-slide-up-appear${f}-slide-up-appear-active${t}-placement-top,
          &${f}-slide-up-enter${f}-slide-up-enter-active${t}-placement-topRight,
          &${f}-slide-up-appear${f}-slide-up-appear-active${t}-placement-topRight`]:{animationName:AO},[`&${f}-slide-down-leave${f}-slide-down-leave-active${t}-placement-bottomLeft,
          &${f}-slide-down-leave${f}-slide-down-leave-active${t}-placement-bottom,
          &${f}-slide-down-leave${f}-slide-down-leave-active${t}-placement-bottomRight`]:{animationName:RO},[`&${f}-slide-up-leave${f}-slide-up-leave-active${t}-placement-topLeft,
          &${f}-slide-up-leave${f}-slide-up-leave-active${t}-placement-top,
          &${f}-slide-up-leave${f}-slide-up-leave-active${t}-placement-topRight`]:{animationName:OO}}},zH(e,B,{arrowPlacement:{top:!0,bottom:!0}}),{[`${t} ${n}`]:{position:"relative",margin:0},[`${n}-submenu-popup`]:{position:"absolute",zIndex:i,background:"transparent",boxShadow:"none",transformOrigin:"0 0","ul, li":{listStyle:"none",margin:0}},[`${t}, ${t}-menu-submenu`]:Object.assign(Object.assign({},ya(e)),{[n]:Object.assign(Object.assign({padding:P,listStyleType:"none",backgroundColor:B,backgroundClip:"padding-box",borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary},hf(e)),{"&:empty":{padding:0,boxShadow:"none"},[`${n}-item-group-title`]:{padding:`${dt(b)} ${dt(k)}`,color:e.colorTextDescription,transition:`all ${y}`},[`${n}-item`]:{position:"relative",display:"flex",alignItems:"center"},[`${n}-item-icon`]:{minWidth:C,marginInlineEnd:e.marginXS,fontSize:e.fontSizeSM},[`${n}-title-content`]:{flex:"auto","&-with-extra":{display:"inline-flex",alignItems:"center",width:"100%"},"> a":{color:"inherit",transition:`all ${y}`,"&:hover":{color:"inherit"},"&::after":{position:"absolute",inset:0,content:'""'}},[`${n}-item-extra`]:{paddingInlineStart:e.padding,marginInlineStart:"auto",fontSize:e.fontSizeSM,color:e.colorTextDescription}},[`${n}-item, ${n}-submenu-title`]:Object.assign(Object.assign({display:"flex",margin:0,padding:`${dt(b)} ${dt(k)}`,color:e.colorText,fontWeight:"normal",fontSize:C,lineHeight:e.lineHeight,cursor:"pointer",transition:`all ${y}`,borderRadius:e.borderRadiusSM,"&:hover, &-active":{backgroundColor:e.controlItemBgHover}},hf(e)),{"&-selected":{color:e.colorPrimary,backgroundColor:e.controlItemBgActive,"&:hover, &-active":{backgroundColor:e.controlItemBgActiveHover}},"&-disabled":{color:A,cursor:"not-allowed","&:hover":{color:A,backgroundColor:B,cursor:"not-allowed"},a:{pointerEvents:"none"}},"&-divider":{height:1,margin:`${dt(e.marginXXS)} 0`,overflow:"hidden",lineHeight:0,backgroundColor:e.colorSplit},[`${t}-menu-submenu-expand-icon`]:{position:"absolute",insetInlineEnd:e.paddingXS,[`${t}-menu-submenu-arrow-icon`]:{marginInlineEnd:"0 !important",color:e.colorIcon,fontSize:D,fontStyle:"normal"}}}),[`${n}-item-group-list`]:{margin:`0 ${dt(e.marginXS)}`,padding:0,listStyle:"none"},[`${n}-submenu-title`]:{paddingInlineEnd:e.calc(k).add(e.fontSizeSM).equal()},[`${n}-submenu-vertical`]:{position:"relative"},[`${n}-submenu${n}-submenu-disabled ${t}-menu-submenu-title`]:{[`&, ${t}-menu-submenu-arrow-icon`]:{color:A,backgroundColor:B,cursor:"not-allowed"}},[`${n}-submenu-selected ${t}-menu-submenu-title`]:{color:e.colorPrimary}})})},[ff(e,"slide-up"),ff(e,"slide-down"),sC(e,"move-up"),sC(e,"move-down"),DO(e,"zoom-big")]]},Zle=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+50,paddingBlock:(e.controlHeight-e.fontSize*e.lineHeight)/2},GO({contentRadius:e.borderRadiusLG,limitVerticalRadius:!0})),DH(e)),Yle=za("Dropdown",e=>{const{marginXXS:t,sizePopupArrow:n,paddingXXS:i,componentCls:s}=e,d=xo(e,{menuCls:`${s}-menu`,dropdownArrowDistance:e.calc(n).div(2).add(t).equal(),dropdownEdgeChildPadding:i});return[Xle(d),Kle(d)]},Zle,{resetStyle:!1}),PE=e=>{var t;const{menu:n,arrow:i,prefixCls:s,children:d,trigger:f,disabled:o,dropdownRender:y,popupRender:b,getPopupContainer:C,overlayClassName:P,rootClassName:A,overlayStyle:D,open:k,onOpenChange:B,visible:N,onVisibleChange:j,mouseEnterDelay:V=.15,mouseLeaveDelay:K=.1,autoAdjustOverflow:Y=!0,placement:Z="",overlay:te,transitionName:ne,destroyOnHidden:se,destroyPopupOnHide:ee}=e,{getPopupContainer:de,getPrefixCls:fe,direction:ye,dropdown:ge}=I.useContext(ji),we=b||y;qv();const Se=I.useMemo(()=>{const tn=fe();return ne!==void 0?ne:Z.includes("top")?`${tn}-slide-down`:`${tn}-slide-up`},[fe,Z,ne]),xe=I.useMemo(()=>Z?Z.includes("Center")?Z.slice(0,Z.indexOf("Center")):Z:ye==="rtl"?"bottomRight":"bottomLeft",[Z,ye]),Te=fe("dropdown",s),ze=Wu(Te),[Ue,We,Be]=Yle(Te,ze),[,Xe]=Vs(),qe=I.Children.only(Qse(d)?I.createElement("span",null,d):d),at=Bu(qe,{className:St(`${Te}-trigger`,{[`${Te}-rtl`]:ye==="rtl"},qe.props.className),disabled:(t=qe.props.disabled)!==null&&t!==void 0?t:o}),Ke=o?[]:f,tt=!!(Ke!=null&&Ke.includes("contextMenu")),[vt,Pt]=is(!1,{value:k??N}),ft=Io(tn=>{B==null||B(tn,{source:"trigger"}),j==null||j(tn),Pt(tn)}),Nt=St(P,A,We,Be,ze,ge==null?void 0:ge.className,{[`${Te}-rtl`]:ye==="rtl"}),Rt=kH({arrowPointAtCenter:typeof i=="object"&&i.pointAtCenter,autoAdjustOverflow:Y,offset:Xe.marginXXS,arrowWidth:i?Xe.sizePopupArrow:0,borderRadius:Xe.borderRadius}),pt=Io(()=>{n!=null&&n.selectable&&(n!=null&&n.multiple)||(B==null||B(!1,{source:"menu"}),Pt(!1))}),yt=()=>{let tn;return n!=null&&n.items?tn=I.createElement(pf,Object.assign({},n)):typeof te=="function"?tn=te():tn=te,we&&(tn=we(tn)),tn=I.Children.only(typeof tn=="string"?I.createElement("span",null,tn):tn),I.createElement(t8,{prefixCls:`${Te}-menu`,rootClassName:St(Be,ze),expandIcon:I.createElement("span",{className:`${Te}-menu-submenu-arrow`},ye==="rtl"?I.createElement(TR,{className:`${Te}-menu-submenu-arrow-icon`}):I.createElement(sR,{className:`${Te}-menu-submenu-arrow-icon`})),mode:"vertical",selectable:!1,onClick:pt,validator:({mode:Zt})=>{}},tn)},[xt,bt]=lE("Dropdown",D==null?void 0:D.zIndex);let Ct=I.createElement($H,Object.assign({alignPoint:tt},as(e,["rootClassName"]),{mouseEnterDelay:V,mouseLeaveDelay:K,visible:vt,builtinPlacements:Rt,arrow:!!i,overlayClassName:Nt,prefixCls:Te,getPopupContainer:C||de,transitionName:Se,trigger:Ke,overlay:yt,placement:xe,onVisibleChange:ft,overlayStyle:Object.assign(Object.assign(Object.assign({},ge==null?void 0:ge.style),D),{zIndex:xt}),autoDestroy:se??ee}),at);return xt&&(Ct=I.createElement(EO.Provider,{value:bt},Ct)),Ue(Ct)},Jle=lH(PE,"align",void 0,"dropdown",e=>e),Qle=e=>I.createElement(Jle,Object.assign({},e),I.createElement("span",null));PE._InternalPanelDoNotUseOrYouWillBeFired=Qle;const r8=I.createContext(null),ece=r8.Provider,i8=I.createContext(null),tce=i8.Provider;var nce=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],o8=I.forwardRef(function(e,t){var n=e.prefixCls,i=n===void 0?"rc-checkbox":n,s=e.className,d=e.style,f=e.checked,o=e.disabled,y=e.defaultChecked,b=y===void 0?!1:y,C=e.type,P=C===void 0?"checkbox":C,A=e.title,D=e.onChange,k=ri(e,nce),B=I.useRef(null),N=I.useRef(null),j=is(b,{value:f}),V=It(j,2),K=V[0],Y=V[1];I.useImperativeHandle(t,function(){return{focus:function(se){var ee;(ee=B.current)===null||ee===void 0||ee.focus(se)},blur:function(){var se;(se=B.current)===null||se===void 0||se.blur()},input:B.current,nativeElement:N.current}});var Z=St(i,s,ke(ke({},"".concat(i,"-checked"),K),"".concat(i,"-disabled"),o)),te=function(se){o||("checked"in e||Y(se.target.checked),D==null||D({target:Je(Je({},e),{},{type:P,checked:se.target.checked}),stopPropagation:function(){se.stopPropagation()},preventDefault:function(){se.preventDefault()},nativeEvent:se.nativeEvent}))};return I.createElement("span",{className:Z,title:A,style:d,ref:N},I.createElement("input",kn({},k,{className:"".concat(i,"-input"),ref:B,onChange:te,disabled:o,checked:!!K,type:P})),I.createElement("span",{className:"".concat(i,"-inner")}))});function a8(e){const t=Wt.useRef(null),n=()=>{Qi.cancel(t.current),t.current=null};return[()=>{n(),t.current=Qi(()=>{t.current=null})},d=>{t.current&&(d.stopPropagation(),n()),e==null||e(d)}]}const rce=e=>{const{componentCls:t,antCls:n}=e,i=`${t}-group`;return{[i]:Object.assign(Object.assign({},ya(e)),{display:"inline-block",fontSize:0,[`&${i}-rtl`]:{direction:"rtl"},[`&${i}-block`]:{display:"flex"},[`${n}-badge ${n}-badge-count`]:{zIndex:1},[`> ${n}-badge:not(:first-child) > ${n}-button-wrapper`]:{borderInlineStart:"none"}})}},ice=e=>{const{componentCls:t,wrapperMarginInlineEnd:n,colorPrimary:i,radioSize:s,motionDurationSlow:d,motionDurationMid:f,motionEaseInOutCirc:o,colorBgContainer:y,colorBorder:b,lineWidth:C,colorBgContainerDisabled:P,colorTextDisabled:A,paddingXS:D,dotColorDisabled:k,lineType:B,radioColor:N,radioBgColor:j,calc:V}=e,K=`${t}-inner`,Z=V(s).sub(V(4).mul(2)),te=V(1).mul(s).equal({unit:!0});return{[`${t}-wrapper`]:Object.assign(Object.assign({},ya(e)),{display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:n,cursor:"pointer","&:last-child":{marginInlineEnd:0},[`&${t}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:e.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},"&-block":{flex:1,justifyContent:"center"},[`${t}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${dt(C)} ${B} ${i}`,borderRadius:"50%",visibility:"hidden",opacity:0,content:'""'},[t]:Object.assign(Object.assign({},ya(e)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center",borderRadius:"50%"}),[`${t}-wrapper:hover &,
        &:hover ${K}`]:{borderColor:i},[`${t}-input:focus-visible + ${K}`]:Nu(e),[`${t}:hover::after, ${t}-wrapper:hover &::after`]:{visibility:"visible"},[`${t}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:te,height:te,marginBlockStart:V(1).mul(s).div(-2).equal({unit:!0}),marginInlineStart:V(1).mul(s).div(-2).equal({unit:!0}),backgroundColor:N,borderBlockStart:0,borderInlineStart:0,borderRadius:te,transform:"scale(0)",opacity:0,transition:`all ${d} ${o}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:te,height:te,backgroundColor:y,borderColor:b,borderStyle:"solid",borderWidth:C,borderRadius:"50%",transition:`all ${f}`},[`${t}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0},[`${t}-checked`]:{[K]:{borderColor:i,backgroundColor:j,"&::after":{transform:`scale(${e.calc(e.dotSize).div(s).equal()})`,opacity:1,transition:`all ${d} ${o}`}}},[`${t}-disabled`]:{cursor:"not-allowed",[K]:{backgroundColor:P,borderColor:b,cursor:"not-allowed","&::after":{backgroundColor:k}},[`${t}-input`]:{cursor:"not-allowed"},[`${t}-disabled + span`]:{color:A,cursor:"not-allowed"},[`&${t}-checked`]:{[K]:{"&::after":{transform:`scale(${V(Z).div(s).equal()})`}}}},[`span${t} + *`]:{paddingInlineStart:D,paddingInlineEnd:D}})}},oce=e=>{const{buttonColor:t,controlHeight:n,componentCls:i,lineWidth:s,lineType:d,colorBorder:f,motionDurationMid:o,buttonPaddingInline:y,fontSize:b,buttonBg:C,fontSizeLG:P,controlHeightLG:A,controlHeightSM:D,paddingXS:k,borderRadius:B,borderRadiusSM:N,borderRadiusLG:j,buttonCheckedBg:V,buttonSolidCheckedColor:K,colorTextDisabled:Y,colorBgContainerDisabled:Z,buttonCheckedBgDisabled:te,buttonCheckedColorDisabled:ne,colorPrimary:se,colorPrimaryHover:ee,colorPrimaryActive:de,buttonSolidCheckedBg:fe,buttonSolidCheckedHoverBg:ye,buttonSolidCheckedActiveBg:ge,calc:we}=e;return{[`${i}-button-wrapper`]:{position:"relative",display:"inline-block",height:n,margin:0,paddingInline:y,paddingBlock:0,color:t,fontSize:b,lineHeight:dt(we(n).sub(we(s).mul(2)).equal()),background:C,border:`${dt(s)} ${d} ${f}`,borderBlockStartWidth:we(s).add(.02).equal(),borderInlineEndWidth:s,cursor:"pointer",transition:[`color ${o}`,`background ${o}`,`box-shadow ${o}`].join(","),a:{color:t},[`> ${i}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:last-child)":{marginInlineEnd:we(s).mul(-1).equal()},"&:first-child":{borderInlineStart:`${dt(s)} ${d} ${f}`,borderStartStartRadius:B,borderEndStartRadius:B},"&:last-child":{borderStartEndRadius:B,borderEndEndRadius:B},"&:first-child:last-child":{borderRadius:B},[`${i}-group-large &`]:{height:A,fontSize:P,lineHeight:dt(we(A).sub(we(s).mul(2)).equal()),"&:first-child":{borderStartStartRadius:j,borderEndStartRadius:j},"&:last-child":{borderStartEndRadius:j,borderEndEndRadius:j}},[`${i}-group-small &`]:{height:D,paddingInline:we(k).sub(s).equal(),paddingBlock:0,lineHeight:dt(we(D).sub(we(s).mul(2)).equal()),"&:first-child":{borderStartStartRadius:N,borderEndStartRadius:N},"&:last-child":{borderStartEndRadius:N,borderEndEndRadius:N}},"&:hover":{position:"relative",color:se},"&:has(:focus-visible)":Nu(e),[`${i}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${i}-button-wrapper-disabled)`]:{zIndex:1,color:se,background:V,borderColor:se,"&::before":{backgroundColor:se},"&:first-child":{borderColor:se},"&:hover":{color:ee,borderColor:ee,"&::before":{backgroundColor:ee}},"&:active":{color:de,borderColor:de,"&::before":{backgroundColor:de}}},[`${i}-group-solid &-checked:not(${i}-button-wrapper-disabled)`]:{color:K,background:fe,borderColor:fe,"&:hover":{color:K,background:ye,borderColor:ye},"&:active":{color:K,background:ge,borderColor:ge}},"&-disabled":{color:Y,backgroundColor:Z,borderColor:f,cursor:"not-allowed","&:first-child, &:hover":{color:Y,backgroundColor:Z,borderColor:f}},[`&-disabled${i}-button-wrapper-checked`]:{color:ne,backgroundColor:te,borderColor:f,boxShadow:"none"},"&-block":{flex:1,textAlign:"center"}}}},ace=e=>{const{wireframe:t,padding:n,marginXS:i,lineWidth:s,fontSizeLG:d,colorText:f,colorBgContainer:o,colorTextDisabled:y,controlItemBgActiveDisabled:b,colorTextLightSolid:C,colorPrimary:P,colorPrimaryHover:A,colorPrimaryActive:D,colorWhite:k}=e,B=4,N=d,j=t?N-B*2:N-(B+s)*2;return{radioSize:N,dotSize:j,dotColorDisabled:y,buttonSolidCheckedColor:C,buttonSolidCheckedBg:P,buttonSolidCheckedHoverBg:A,buttonSolidCheckedActiveBg:D,buttonBg:o,buttonCheckedBg:o,buttonColor:f,buttonCheckedBgDisabled:b,buttonCheckedColorDisabled:y,buttonPaddingInline:n-s,wrapperMarginInlineEnd:i,radioColor:t?P:k,radioBgColor:t?o:P}},s8=za("Radio",e=>{const{controlOutline:t,controlOutlineWidth:n}=e,i=`0 0 0 ${dt(n)} ${t}`,d=xo(e,{radioFocusShadow:i,radioButtonFocusShadow:i});return[rce(d),ice(d),oce(d)]},ace,{unitless:{radioSize:!0,dotSize:!0}});var sce=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const lce=(e,t)=>{var n,i;const s=I.useContext(r8),d=I.useContext(i8),{getPrefixCls:f,direction:o,radio:y}=I.useContext(ji),b=I.useRef(null),C=ru(t,b),{isFormItemInput:P}=I.useContext(Xp),A=xe=>{var Te,ze;(Te=e.onChange)===null||Te===void 0||Te.call(e,xe),(ze=s==null?void 0:s.onChange)===null||ze===void 0||ze.call(s,xe)},{prefixCls:D,className:k,rootClassName:B,children:N,style:j,title:V}=e,K=sce(e,["prefixCls","className","rootClassName","children","style","title"]),Y=f("radio",D),Z=((s==null?void 0:s.optionType)||d)==="button",te=Z?`${Y}-button`:Y,ne=Wu(Y),[se,ee,de]=s8(Y,ne),fe=Object.assign({},K),ye=I.useContext(Fd);s&&(fe.name=s.name,fe.onChange=A,fe.checked=e.value===s.value,fe.disabled=(n=fe.disabled)!==null&&n!==void 0?n:s.disabled),fe.disabled=(i=fe.disabled)!==null&&i!==void 0?i:ye;const ge=St(`${te}-wrapper`,{[`${te}-wrapper-checked`]:fe.checked,[`${te}-wrapper-disabled`]:fe.disabled,[`${te}-wrapper-rtl`]:o==="rtl",[`${te}-wrapper-in-form-item`]:P,[`${te}-wrapper-block`]:!!(s!=null&&s.block)},y==null?void 0:y.className,k,B,ee,de,ne),[we,Se]=a8(fe.onClick);return se(I.createElement(hE,{component:"Radio",disabled:fe.disabled},I.createElement("label",{className:ge,style:Object.assign(Object.assign({},y==null?void 0:y.style),j),onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,title:V,onClick:we},I.createElement(o8,Object.assign({},fe,{className:St(fe.className,{[dE]:!Z}),type:"radio",prefixCls:te,ref:C,onClick:Se})),N!==void 0?I.createElement("span",{className:`${te}-label`},N):null)))},pC=I.forwardRef(lce);function cce(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function uce(e){return cce(e).join("_")}const dce=I.forwardRef((e,t)=>{const{getPrefixCls:n,direction:i}=I.useContext(ji),{name:s}=I.useContext(Xp),d=kO(uce(s)),{prefixCls:f,className:o,rootClassName:y,options:b,buttonStyle:C="outline",disabled:P,children:A,size:D,style:k,id:B,optionType:N,name:j=d,defaultValue:V,value:K,block:Y=!1,onChange:Z,onMouseEnter:te,onMouseLeave:ne,onFocus:se,onBlur:ee}=e,[de,fe]=is(V,{value:K}),ye=I.useCallback(qe=>{const at=de,Ke=qe.target.value;"value"in e||fe(Ke),Ke!==at&&(Z==null||Z(qe))},[de,fe,Z]),ge=n("radio",f),we=`${ge}-group`,Se=Wu(ge),[xe,Te,ze]=s8(ge,Se);let Ue=A;b&&b.length>0&&(Ue=b.map(qe=>typeof qe=="string"||typeof qe=="number"?I.createElement(pC,{key:qe.toString(),prefixCls:ge,disabled:P,value:qe,checked:de===qe},qe):I.createElement(pC,{key:`radio-group-value-options-${qe.value}`,prefixCls:ge,disabled:qe.disabled||P,value:qe.value,checked:de===qe.value,title:qe.title,style:qe.style,className:qe.className,id:qe.id,required:qe.required},qe.label)));const We=Bd(D),Be=St(we,`${we}-${C}`,{[`${we}-${We}`]:We,[`${we}-rtl`]:i==="rtl",[`${we}-block`]:Y},o,y,Te,ze,Se),Xe=I.useMemo(()=>({onChange:ye,value:de,disabled:P,name:j,optionType:N,block:Y}),[ye,de,P,j,N,Y]);return xe(I.createElement("div",Object.assign({},Jc(e,{aria:!0,data:!0}),{className:Be,style:k,onMouseEnter:te,onMouseLeave:ne,onFocus:se,onBlur:ee,id:B,ref:t}),I.createElement(ece,{value:Xe},Ue)))}),hce=I.memo(dce);var fce=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const pce=(e,t)=>{const{getPrefixCls:n}=I.useContext(ji),{prefixCls:i}=e,s=fce(e,["prefixCls"]),d=n("radio",i);return I.createElement(tce,{value:"button"},I.createElement(pC,Object.assign({prefixCls:d},s,{type:"radio",ref:t})))},mce=I.forwardRef(pce),lb=pC;lb.Button=mce;lb.Group=hce;lb.__ANT_RADIO=!0;function eD(e){return xo(e,{inputAffixPadding:e.paddingXXS})}const tD=e=>{const{controlHeight:t,fontSize:n,lineHeight:i,lineWidth:s,controlHeightSM:d,controlHeightLG:f,fontSizeLG:o,lineHeightLG:y,paddingSM:b,controlPaddingHorizontalSM:C,controlPaddingHorizontal:P,colorFillAlter:A,colorPrimaryHover:D,colorPrimary:k,controlOutlineWidth:B,controlOutline:N,colorErrorOutline:j,colorWarningOutline:V,colorBgContainer:K,inputFontSize:Y,inputFontSizeLG:Z,inputFontSizeSM:te}=e,ne=Y||n,se=te||ne,ee=Z||o,de=Math.round((t-ne*i)/2*10)/10-s,fe=Math.round((d-se*i)/2*10)/10-s,ye=Math.ceil((f-ee*y)/2*10)/10-s;return{paddingBlock:Math.max(de,0),paddingBlockSM:Math.max(fe,0),paddingBlockLG:Math.max(ye,0),paddingInline:b-s,paddingInlineSM:C-s,paddingInlineLG:P-s,addonBg:A,activeBorderColor:k,hoverBorderColor:D,activeShadow:`0 0 0 ${B}px ${N}`,errorActiveShadow:`0 0 0 ${B}px ${j}`,warningActiveShadow:`0 0 0 ${B}px ${V}`,hoverBg:K,activeBg:K,inputFontSize:ne,inputFontSizeLG:ee,inputFontSizeSM:se}},gce=e=>({borderColor:e.hoverBorderColor,backgroundColor:e.hoverBg}),ME=e=>({color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},gce(xo(e,{hoverBorderColor:e.colorBorder,hoverBg:e.colorBgContainerDisabled})))}),nD=(e,t)=>({background:e.colorBgContainer,borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:t.borderColor,"&:hover":{borderColor:t.hoverBorderColor,backgroundColor:e.hoverBg},"&:focus, &:focus-within":{borderColor:t.activeBorderColor,boxShadow:t.activeShadow,outline:0,backgroundColor:e.activeBg}}),i$=(e,t)=>({[`&${e.componentCls}-status-${t.status}:not(${e.componentCls}-disabled)`]:Object.assign(Object.assign({},nD(e,t)),{[`${e.componentCls}-prefix, ${e.componentCls}-suffix`]:{color:t.affixColor}}),[`&${e.componentCls}-status-${t.status}${e.componentCls}-disabled`]:{borderColor:t.borderColor}}),vce=(e,t)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},nD(e,{borderColor:e.colorBorder,hoverBorderColor:e.hoverBorderColor,activeBorderColor:e.activeBorderColor,activeShadow:e.activeShadow})),{[`&${e.componentCls}-disabled, &[disabled]`]:Object.assign({},ME(e))}),i$(e,{status:"error",borderColor:e.colorError,hoverBorderColor:e.colorErrorBorderHover,activeBorderColor:e.colorError,activeShadow:e.errorActiveShadow,affixColor:e.colorError})),i$(e,{status:"warning",borderColor:e.colorWarning,hoverBorderColor:e.colorWarningBorderHover,activeBorderColor:e.colorWarning,activeShadow:e.warningActiveShadow,affixColor:e.colorWarning})),t)}),o$=(e,t)=>({[`&${e.componentCls}-group-wrapper-status-${t.status}`]:{[`${e.componentCls}-group-addon`]:{borderColor:t.addonBorderColor,color:t.addonColor}}}),_ce=e=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${e.componentCls}-group`]:{"&-addon":{background:e.addonBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},o$(e,{status:"error",addonBorderColor:e.colorError,addonColor:e.colorErrorText})),o$(e,{status:"warning",addonBorderColor:e.colorWarning,addonColor:e.colorWarningText})),{[`&${e.componentCls}-group-wrapper-disabled`]:{[`${e.componentCls}-group-addon`]:Object.assign({},ME(e))}})}),yce=(e,t)=>{const{componentCls:n}=e;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${n}-disabled, &[disabled]`]:{color:e.colorTextDisabled,cursor:"not-allowed"},[`&${n}-status-error`]:{"&, & input, & textarea":{color:e.colorError}},[`&${n}-status-warning`]:{"&, & input, & textarea":{color:e.colorWarning}}},t)}},l8=(e,t)=>{var n;return{background:t.bg,borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:(n=t==null?void 0:t.inputColor)!==null&&n!==void 0?n:"unset"},"&:hover":{background:t.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:t.activeBorderColor,backgroundColor:e.activeBg}}},a$=(e,t)=>({[`&${e.componentCls}-status-${t.status}:not(${e.componentCls}-disabled)`]:Object.assign(Object.assign({},l8(e,t)),{[`${e.componentCls}-prefix, ${e.componentCls}-suffix`]:{color:t.affixColor}})}),xce=(e,t)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l8(e,{bg:e.colorFillTertiary,hoverBg:e.colorFillSecondary,activeBorderColor:e.activeBorderColor})),{[`&${e.componentCls}-disabled, &[disabled]`]:Object.assign({},ME(e))}),a$(e,{status:"error",bg:e.colorErrorBg,hoverBg:e.colorErrorBgHover,activeBorderColor:e.colorError,inputColor:e.colorErrorText,affixColor:e.colorError})),a$(e,{status:"warning",bg:e.colorWarningBg,hoverBg:e.colorWarningBgHover,activeBorderColor:e.colorWarning,inputColor:e.colorWarningText,affixColor:e.colorWarning})),t)}),s$=(e,t)=>({[`&${e.componentCls}-group-wrapper-status-${t.status}`]:{[`${e.componentCls}-group-addon`]:{background:t.addonBg,color:t.addonColor}}}),bce=e=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${e.componentCls}-group-addon`]:{background:e.colorFillTertiary,"&:last-child":{position:"static"}}},s$(e,{status:"error",addonBg:e.colorErrorBg,addonColor:e.colorErrorText})),s$(e,{status:"warning",addonBg:e.colorWarningBg,addonColor:e.colorWarningText})),{[`&${e.componentCls}-group-wrapper-disabled`]:{[`${e.componentCls}-group`]:{"&-addon":{background:e.colorFillTertiary,color:e.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderTop:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderBottom:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderTop:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderBottom:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`}}}})}),c8=(e,t)=>({background:e.colorBgContainer,borderWidth:`${dt(e.lineWidth)} 0`,borderStyle:`${e.lineType} none`,borderColor:`transparent transparent ${t.borderColor} transparent`,borderRadius:0,"&:hover":{borderColor:`transparent transparent ${t.borderColor} transparent`,backgroundColor:e.hoverBg},"&:focus, &:focus-within":{borderColor:`transparent transparent ${t.activeBorderColor} transparent`,outline:0,backgroundColor:e.activeBg}}),l$=(e,t)=>({[`&${e.componentCls}-status-${t.status}:not(${e.componentCls}-disabled)`]:Object.assign(Object.assign({},c8(e,t)),{[`${e.componentCls}-prefix, ${e.componentCls}-suffix`]:{color:t.affixColor}}),[`&${e.componentCls}-status-${t.status}${e.componentCls}-disabled`]:{borderColor:`transparent transparent ${t.borderColor} transparent`}}),wce=(e,t)=>({"&-underlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c8(e,{borderColor:e.colorBorder,hoverBorderColor:e.hoverBorderColor,activeBorderColor:e.activeBorderColor,activeShadow:e.activeShadow})),{[`&${e.componentCls}-disabled, &[disabled]`]:{color:e.colorTextDisabled,boxShadow:"none",cursor:"not-allowed","&:hover":{borderColor:`transparent transparent ${e.colorBorder} transparent`}},"input[disabled], textarea[disabled]":{cursor:"not-allowed"}}),l$(e,{status:"error",borderColor:e.colorError,hoverBorderColor:e.colorErrorBorderHover,activeBorderColor:e.colorError,activeShadow:e.errorActiveShadow,affixColor:e.colorError})),l$(e,{status:"warning",borderColor:e.colorWarning,hoverBorderColor:e.colorWarningBorderHover,activeBorderColor:e.colorWarning,activeShadow:e.warningActiveShadow,affixColor:e.colorWarning})),t)}),Sce=e=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:e,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),u8=e=>{const{paddingBlockLG:t,lineHeightLG:n,borderRadiusLG:i,paddingInlineLG:s}=e;return{padding:`${dt(t)} ${dt(s)}`,fontSize:e.inputFontSizeLG,lineHeight:n,borderRadius:i}},rD=e=>({padding:`${dt(e.paddingBlockSM)} ${dt(e.paddingInlineSM)}`,fontSize:e.inputFontSizeSM,borderRadius:e.borderRadiusSM}),iD=e=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${dt(e.paddingBlock)} ${dt(e.paddingInline)}`,color:e.colorText,fontSize:e.inputFontSize,lineHeight:e.lineHeight,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid}`},Sce(e.colorTextPlaceholder)),{"&-lg":Object.assign({},u8(e)),"&-sm":Object.assign({},rD(e)),"&-rtl, &-textarea-rtl":{direction:"rtl"}}),Cce=e=>{const{componentCls:t,antCls:n}=e;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:e.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${t}, &-lg > ${t}-group-addon`]:Object.assign({},u8(e)),[`&-sm ${t}, &-sm > ${t}-group-addon`]:Object.assign({},rD(e)),[`&-lg ${n}-select-single ${n}-select-selector`]:{height:e.controlHeightLG},[`&-sm ${n}-select-single ${n}-select-selector`]:{height:e.controlHeightSM},[`> ${t}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${t}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${dt(e.paddingInline)}`,color:e.colorText,fontWeight:"normal",fontSize:e.inputFontSize,textAlign:"center",borderRadius:e.borderRadius,transition:`all ${e.motionDurationSlow}`,lineHeight:1,[`${n}-select`]:{margin:`${dt(e.calc(e.paddingBlock).add(1).mul(-1).equal())} ${dt(e.calc(e.paddingInline).mul(-1).equal())}`,[`&${n}-select-single:not(${n}-select-customize-input):not(${n}-pagination-size-changer)`]:{[`${n}-select-selector`]:{backgroundColor:"inherit",border:`${dt(e.lineWidth)} ${e.lineType} transparent`,boxShadow:"none"}}},[`${n}-cascader-picker`]:{margin:`-9px ${dt(e.calc(e.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${n}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[t]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${t}-search-with-button &`]:{zIndex:0}}},[`> ${t}:first-child, ${t}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${n}-select ${n}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}-affix-wrapper`]:{[`&:not(:first-child) ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}:last-child, ${t}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${n}-select ${n}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${t}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-search &`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius}},[`&:not(:first-child), ${t}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${t}-group-compact`]:Object.assign(Object.assign({display:"block"},Kp()),{[`${t}-group-addon, ${t}-group-wrap, > ${t}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:e.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${t}-affix-wrapper,
        & > ${t}-number-affix-wrapper,
        & > ${n}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal(),borderInlineEndWidth:e.lineWidth},[t]:{float:"none"},[`& > ${n}-select > ${n}-select-selector,
      & > ${n}-select-auto-complete ${t},
      & > ${n}-cascader-picker ${t},
      & > ${t}-group-wrapper ${t}`]:{borderInlineEndWidth:e.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${n}-select-focused`]:{zIndex:1},[`& > ${n}-select > ${n}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${n}-select:first-child > ${n}-select-selector,
      & > ${n}-select-auto-complete:first-child ${t},
      & > ${n}-cascader-picker:first-child ${t}`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius},[`& > *:last-child,
      & > ${n}-select:last-child > ${n}-select-selector,
      & > ${n}-cascader-picker:last-child ${t},
      & > ${n}-cascader-picker-focused:last-child ${t}`]:{borderInlineEndWidth:e.lineWidth,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius},[`& > ${n}-select-auto-complete ${t}`]:{verticalAlign:"top"},[`${t}-group-wrapper + ${t}-group-wrapper`]:{marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),[`${t}-affix-wrapper`]:{borderRadius:0}},[`${t}-group-wrapper:not(:last-child)`]:{[`&${t}-search > ${t}-group`]:{[`& > ${t}-group-addon > ${t}-search-button`]:{borderRadius:0},[`& > ${t}`]:{borderStartStartRadius:e.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:e.borderRadius}}}})}},Ece=e=>{const{componentCls:t,controlHeightSM:n,lineWidth:i,calc:s}=e,f=s(n).sub(s(i).mul(2)).sub(16).div(2).equal();return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ya(e)),iD(e)),vce(e)),xce(e)),yce(e)),wce(e)),{'&[type="color"]':{height:e.controlHeight,[`&${t}-lg`]:{height:e.controlHeightLG},[`&${t}-sm`]:{height:n,paddingTop:f,paddingBottom:f}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{appearance:"none"}})}},Tce=e=>{const{componentCls:t}=e;return{[`${t}-clear-icon`]:{margin:0,padding:0,lineHeight:0,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${e.motionDurationSlow}`,border:"none",outline:"none",backgroundColor:"transparent","&:hover":{color:e.colorIcon},"&:active":{color:e.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${dt(e.inputAffixPadding)}`}}}},Ice=e=>{const{componentCls:t,inputAffixPadding:n,colorTextDescription:i,motionDurationSlow:s,colorIcon:d,colorIconHover:f,iconCls:o}=e,y=`${t}-affix-wrapper`,b=`${t}-affix-wrapper-disabled`;return{[y]:Object.assign(Object.assign(Object.assign(Object.assign({},iD(e)),{display:"inline-flex",[`&:not(${t}-disabled):hover`]:{zIndex:1,[`${t}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${t}`]:{padding:0},[`> input${t}, > textarea${t}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[t]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:e.paddingXS}},"&-show-count-suffix":{color:i,direction:"ltr"},"&-show-count-has-suffix":{marginInlineEnd:e.paddingXXS},"&-prefix":{marginInlineEnd:n},"&-suffix":{marginInlineStart:n}}}),Tce(e)),{[`${o}${t}-password-icon`]:{color:d,cursor:"pointer",transition:`all ${s}`,"&:hover":{color:f}}}),[`${t}-underlined`]:{borderRadius:0},[b]:{[`${o}${t}-password-icon`]:{color:d,cursor:"not-allowed","&:hover":{color:d}}}}},Pce=e=>{const{componentCls:t,borderRadiusLG:n,borderRadiusSM:i}=e;return{[`${t}-group`]:Object.assign(Object.assign(Object.assign({},ya(e)),Cce(e)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${t}-group-addon`]:{borderRadius:n,fontSize:e.inputFontSizeLG}},"&-sm":{[`${t}-group-addon`]:{borderRadius:i}}},_ce(e)),bce(e)),{[`&:not(${t}-compact-first-item):not(${t}-compact-last-item)${t}-compact-item`]:{[`${t}, ${t}-group-addon`]:{borderRadius:0}},[`&:not(${t}-compact-last-item)${t}-compact-first-item`]:{[`${t}, ${t}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${t}-compact-first-item)${t}-compact-last-item`]:{[`${t}, ${t}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${t}-compact-last-item)${t}-compact-item`]:{[`${t}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${t}-compact-first-item)${t}-compact-item`]:{[`${t}-affix-wrapper`]:{borderStartStartRadius:0,borderEndStartRadius:0}}})})}},Mce=e=>{const{componentCls:t,antCls:n}=e,i=`${t}-search`;return{[i]:{[t]:{"&:not([disabled]):hover, &:not([disabled]):focus":{[`+ ${t}-group-addon ${i}-button:not(${n}-btn-color-primary):not(${n}-btn-variant-text)`]:{borderInlineStartColor:e.colorPrimaryHover}}},[`${t}-affix-wrapper`]:{height:e.controlHeight,borderRadius:0},[`${t}-lg`]:{lineHeight:e.calc(e.lineHeightLG).sub(2e-4).equal()},[`> ${t}-group`]:{[`> ${t}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${i}-button`]:{marginInlineEnd:-1,borderStartStartRadius:0,borderEndStartRadius:0,boxShadow:"none"},[`${i}-button:not(${n}-btn-color-primary)`]:{color:e.colorTextDescription,"&:not([disabled]):hover":{color:e.colorPrimaryHover},"&:active":{color:e.colorPrimaryActive},[`&${n}-btn-loading::before`]:{inset:0}}}},[`${i}-button`]:{height:e.controlHeight,"&:hover, &:focus":{zIndex:1}},"&-large":{[`${t}-affix-wrapper, ${i}-button`]:{height:e.controlHeightLG}},"&-small":{[`${t}-affix-wrapper, ${i}-button`]:{height:e.controlHeightSM}},"&-rtl":{direction:"rtl"},[`&${t}-compact-item`]:{[`&:not(${t}-compact-last-item)`]:{[`${t}-group-addon`]:{[`${t}-search-button`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${t}-compact-first-item)`]:{[`${t},${t}-affix-wrapper`]:{borderRadius:0}},[`> ${t}-group-addon ${t}-search-button,
        > ${t},
        ${t}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${t}-affix-wrapper-focused`]:{zIndex:2}}}}},Rce=e=>{const{componentCls:t}=e;return{[`${t}-out-of-range`]:{[`&, & input, & textarea, ${t}-show-count-suffix, ${t}-data-count`]:{color:e.colorError}}}},Ace=za(["Input","Shared"],e=>{const t=xo(e,eD(e));return[Ece(t),Ice(t)]},tD,{resetFont:!1}),Oce=za(["Input","Component"],e=>{const t=xo(e,eD(e));return[Pce(t),Mce(t),Rce(t),zO(t)]},tD,{resetFont:!1});var Dce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},Lce=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Dce}))},zce=I.forwardRef(Lce);const RE=I.createContext(null);var kce=function(t){var n=t.activeTabOffset,i=t.horizontal,s=t.rtl,d=t.indicator,f=d===void 0?{}:d,o=f.size,y=f.align,b=y===void 0?"center":y,C=I.useState(),P=It(C,2),A=P[0],D=P[1],k=I.useRef(),B=Wt.useCallback(function(j){return typeof o=="function"?o(j):typeof o=="number"?o:j},[o]);function N(){Qi.cancel(k.current)}return I.useEffect(function(){var j={};if(n)if(i){j.width=B(n.width);var V=s?"right":"left";b==="start"&&(j[V]=n[V]),b==="center"&&(j[V]=n[V]+n.width/2,j.transform=s?"translateX(50%)":"translateX(-50%)"),b==="end"&&(j[V]=n[V]+n.width,j.transform="translateX(-100%)")}else j.height=B(n.height),b==="start"&&(j.top=n.top),b==="center"&&(j.top=n.top+n.height/2,j.transform="translateY(-50%)"),b==="end"&&(j.top=n.top+n.height,j.transform="translateY(-100%)");return N(),k.current=Qi(function(){var K=A&&j&&Object.keys(j).every(function(Y){var Z=j[Y],te=A[Y];return typeof Z=="number"&&typeof te=="number"?Math.round(Z)===Math.round(te):Z===te});K||D(j)}),N},[JSON.stringify(n),i,s,b,B]),{style:A}},c$={width:0,height:0,left:0,top:0};function Fce(e,t,n){return I.useMemo(function(){for(var i,s=new Map,d=t.get((i=e[0])===null||i===void 0?void 0:i.key)||c$,f=d.left+d.width,o=0;o<e.length;o+=1){var y=e[o].key,b=t.get(y);if(!b){var C;b=t.get((C=e[o-1])===null||C===void 0?void 0:C.key)||c$}var P=s.get(y)||Je({},b);P.right=f-P.left-P.width,s.set(y,P)}return s},[e.map(function(i){return i.key}).join("_"),t,n])}function u$(e,t){var n=I.useRef(e),i=I.useState({}),s=It(i,2),d=s[1];function f(o){var y=typeof o=="function"?o(n.current):o;y!==n.current&&t(y,n.current),n.current=y,d({})}return[n.current,f]}var Nce=.1,d$=.01,_S=20,h$=Math.pow(.995,_S);function Bce(e,t){var n=I.useState(),i=It(n,2),s=i[0],d=i[1],f=I.useState(0),o=It(f,2),y=o[0],b=o[1],C=I.useState(0),P=It(C,2),A=P[0],D=P[1],k=I.useState(),B=It(k,2),N=B[0],j=B[1],V=I.useRef();function K(ee){var de=ee.touches[0],fe=de.screenX,ye=de.screenY;d({x:fe,y:ye}),window.clearInterval(V.current)}function Y(ee){if(s){var de=ee.touches[0],fe=de.screenX,ye=de.screenY;d({x:fe,y:ye});var ge=fe-s.x,we=ye-s.y;t(ge,we);var Se=Date.now();b(Se),D(Se-y),j({x:ge,y:we})}}function Z(){if(s&&(d(null),j(null),N)){var ee=N.x/A,de=N.y/A,fe=Math.abs(ee),ye=Math.abs(de);if(Math.max(fe,ye)<Nce)return;var ge=ee,we=de;V.current=window.setInterval(function(){if(Math.abs(ge)<d$&&Math.abs(we)<d$){window.clearInterval(V.current);return}ge*=h$,we*=h$,t(ge*_S,we*_S)},_S)}}var te=I.useRef();function ne(ee){var de=ee.deltaX,fe=ee.deltaY,ye=0,ge=Math.abs(de),we=Math.abs(fe);ge===we?ye=te.current==="x"?de:fe:ge>we?(ye=de,te.current="x"):(ye=fe,te.current="y"),t(-ye,-ye)&&ee.preventDefault()}var se=I.useRef(null);se.current={onTouchStart:K,onTouchMove:Y,onTouchEnd:Z,onWheel:ne},I.useEffect(function(){function ee(ge){se.current.onTouchStart(ge)}function de(ge){se.current.onTouchMove(ge)}function fe(ge){se.current.onTouchEnd(ge)}function ye(ge){se.current.onWheel(ge)}return document.addEventListener("touchmove",de,{passive:!1}),document.addEventListener("touchend",fe,{passive:!0}),e.current.addEventListener("touchstart",ee,{passive:!0}),e.current.addEventListener("wheel",ye,{passive:!1}),function(){document.removeEventListener("touchmove",de),document.removeEventListener("touchend",fe)}},[])}function d8(e){var t=I.useState(0),n=It(t,2),i=n[0],s=n[1],d=I.useRef(0),f=I.useRef();return f.current=e,OM(function(){var o;(o=f.current)===null||o===void 0||o.call(f)},[i]),function(){d.current===i&&(d.current+=1,s(d.current))}}function $ce(e){var t=I.useRef([]),n=I.useState({}),i=It(n,2),s=i[1],d=I.useRef(typeof e=="function"?e():e),f=d8(function(){var y=d.current;t.current.forEach(function(b){y=b(y)}),t.current=[],d.current=y,s({})});function o(y){t.current.push(y),f()}return[d.current,o]}var f$={width:0,height:0,left:0,top:0,right:0};function jce(e,t,n,i,s,d,f){var o=f.tabs,y=f.tabPosition,b=f.rtl,C,P,A;return["top","bottom"].includes(y)?(C="width",P=b?"right":"left",A=Math.abs(n)):(C="height",P="top",A=-n),I.useMemo(function(){if(!o.length)return[0,0];for(var D=o.length,k=D,B=0;B<D;B+=1){var N=e.get(o[B].key)||f$;if(Math.floor(N[P]+N[C])>Math.floor(A+t)){k=B-1;break}}for(var j=0,V=D-1;V>=0;V-=1){var K=e.get(o[V].key)||f$;if(K[P]<A){j=V+1;break}}return j>k?[0,-1]:[j,k]},[e,t,i,s,d,A,y,o.map(function(D){return D.key}).join("_"),b])}function p$(e){var t;return e instanceof Map?(t={},e.forEach(function(n,i){t[i]=n})):t=e,JSON.stringify(t)}var Vce="TABS_DQ";function h8(e){return String(e).replace(/"/g,Vce)}function oD(e,t,n,i){return!(!n||i||e===!1||e===void 0&&(t===!1||t===null))}var f8=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.editable,s=e.locale,d=e.style;return!i||i.showAdd===!1?null:I.createElement("button",{ref:t,type:"button",className:"".concat(n,"-nav-add"),style:d,"aria-label":(s==null?void 0:s.addAriaLabel)||"Add tab",onClick:function(o){i.onEdit("add",{event:o})}},i.addIcon||"+")}),m$=I.forwardRef(function(e,t){var n=e.position,i=e.prefixCls,s=e.extra;if(!s)return null;var d,f={};return Nr(s)==="object"&&!I.isValidElement(s)?f=s:f.right=s,n==="right"&&(d=f.right),n==="left"&&(d=f.left),d?I.createElement("div",{className:"".concat(i,"-extra-content"),ref:t},d):null}),Uce=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.id,s=e.tabs,d=e.locale,f=e.mobile,o=e.more,y=o===void 0?{}:o,b=e.style,C=e.className,P=e.editable,A=e.tabBarGutter,D=e.rtl,k=e.removeAriaLabel,B=e.onTabClick,N=e.getPopupContainer,j=e.popupClassName,V=I.useState(!1),K=It(V,2),Y=K[0],Z=K[1],te=I.useState(null),ne=It(te,2),se=ne[0],ee=ne[1],de=y.icon,fe=de===void 0?"More":de,ye="".concat(i,"-more-popup"),ge="".concat(n,"-dropdown"),we=se!==null?"".concat(ye,"-").concat(se):null,Se=d==null?void 0:d.dropdownAriaLabel;function xe(qe,at){qe.preventDefault(),qe.stopPropagation(),P.onEdit("remove",{key:at,event:qe})}var Te=I.createElement(Qv,{onClick:function(at){var Ke=at.key,tt=at.domEvent;B(Ke,tt),Z(!1)},prefixCls:"".concat(ge,"-menu"),id:ye,tabIndex:-1,role:"listbox","aria-activedescendant":we,selectedKeys:[se],"aria-label":Se!==void 0?Se:"expanded dropdown"},s.map(function(qe){var at=qe.closable,Ke=qe.disabled,tt=qe.closeIcon,vt=qe.key,Pt=qe.label,ft=oD(at,tt,P,Ke);return I.createElement(sb,{key:vt,id:"".concat(ye,"-").concat(vt),role:"option","aria-controls":i&&"".concat(i,"-panel-").concat(vt),disabled:Ke},I.createElement("span",null,Pt),ft&&I.createElement("button",{type:"button","aria-label":k||"remove",tabIndex:0,className:"".concat(ge,"-menu-item-remove"),onClick:function(Rt){Rt.stopPropagation(),xe(Rt,vt)}},tt||P.removeIcon||""))}));function ze(qe){for(var at=s.filter(function(ft){return!ft.disabled}),Ke=at.findIndex(function(ft){return ft.key===se})||0,tt=at.length,vt=0;vt<tt;vt+=1){Ke=(Ke+qe+tt)%tt;var Pt=at[Ke];if(!Pt.disabled){ee(Pt.key);return}}}function Ue(qe){var at=qe.which;if(!Y){[ir.DOWN,ir.SPACE,ir.ENTER].includes(at)&&(Z(!0),qe.preventDefault());return}switch(at){case ir.UP:ze(-1),qe.preventDefault();break;case ir.DOWN:ze(1),qe.preventDefault();break;case ir.ESC:Z(!1);break;case ir.SPACE:case ir.ENTER:se!==null&&B(se,qe);break}}I.useEffect(function(){var qe=document.getElementById(we);qe&&qe.scrollIntoView&&qe.scrollIntoView(!1)},[se]),I.useEffect(function(){Y||ee(null)},[Y]);var We=ke({},D?"marginRight":"marginLeft",A);s.length||(We.visibility="hidden",We.order=1);var Be=St(ke({},"".concat(ge,"-rtl"),D)),Xe=f?null:I.createElement($H,kn({prefixCls:ge,overlay:Te,visible:s.length?Y:!1,onVisibleChange:Z,overlayClassName:St(Be,j),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:N},y),I.createElement("button",{type:"button",className:"".concat(n,"-nav-more"),style:We,"aria-haspopup":"listbox","aria-controls":ye,id:"".concat(i,"-more"),"aria-expanded":Y,onKeyDown:Ue},fe));return I.createElement("div",{className:St("".concat(n,"-nav-operations"),C),style:b,ref:t},Xe,I.createElement(f8,{prefixCls:n,locale:d,editable:P}))});const Hce=I.memo(Uce,function(e,t){return t.tabMoving});var Gce=function(t){var n=t.prefixCls,i=t.id,s=t.active,d=t.focus,f=t.tab,o=f.key,y=f.label,b=f.disabled,C=f.closeIcon,P=f.icon,A=t.closable,D=t.renderWrapper,k=t.removeAriaLabel,B=t.editable,N=t.onClick,j=t.onFocus,V=t.onBlur,K=t.onKeyDown,Y=t.onMouseDown,Z=t.onMouseUp,te=t.style,ne=t.tabCount,se=t.currentPosition,ee="".concat(n,"-tab"),de=oD(A,C,B,b);function fe(xe){b||N(xe)}function ye(xe){xe.preventDefault(),xe.stopPropagation(),B.onEdit("remove",{key:o,event:xe})}var ge=I.useMemo(function(){return P&&typeof y=="string"?I.createElement("span",null,y):y},[y,P]),we=I.useRef(null);I.useEffect(function(){d&&we.current&&we.current.focus()},[d]);var Se=I.createElement("div",{key:o,"data-node-key":h8(o),className:St(ee,ke(ke(ke(ke({},"".concat(ee,"-with-remove"),de),"".concat(ee,"-active"),s),"".concat(ee,"-disabled"),b),"".concat(ee,"-focus"),d)),style:te,onClick:fe},I.createElement("div",{ref:we,role:"tab","aria-selected":s,id:i&&"".concat(i,"-tab-").concat(o),className:"".concat(ee,"-btn"),"aria-controls":i&&"".concat(i,"-panel-").concat(o),"aria-disabled":b,tabIndex:b?null:s?0:-1,onClick:function(Te){Te.stopPropagation(),fe(Te)},onKeyDown:K,onMouseDown:Y,onMouseUp:Z,onFocus:j,onBlur:V},d&&I.createElement("div",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"Tab ".concat(se," of ").concat(ne)),P&&I.createElement("span",{className:"".concat(ee,"-icon")},P),y&&ge),de&&I.createElement("button",{type:"button",role:"tab","aria-label":k||"remove",tabIndex:s?0:-1,className:"".concat(ee,"-remove"),onClick:function(Te){Te.stopPropagation(),ye(Te)}},C||B.removeIcon||""));return D?D(Se):Se},Wce=function(t,n){var i=t.offsetWidth,s=t.offsetHeight,d=t.offsetTop,f=t.offsetLeft,o=t.getBoundingClientRect(),y=o.width,b=o.height,C=o.left,P=o.top;return Math.abs(y-i)<1?[y,b,C-n.left,P-n.top]:[i,s,f,d]},Hg=function(t){var n=t.current||{},i=n.offsetWidth,s=i===void 0?0:i,d=n.offsetHeight,f=d===void 0?0:d;if(t.current){var o=t.current.getBoundingClientRect(),y=o.width,b=o.height;if(Math.abs(y-s)<1)return[y,b]}return[s,f]},Aw=function(t,n){return t[n?0:1]},g$=I.forwardRef(function(e,t){var n=e.className,i=e.style,s=e.id,d=e.animated,f=e.activeKey,o=e.rtl,y=e.extra,b=e.editable,C=e.locale,P=e.tabPosition,A=e.tabBarGutter,D=e.children,k=e.onTabClick,B=e.onTabScroll,N=e.indicator,j=I.useContext(RE),V=j.prefixCls,K=j.tabs,Y=I.useRef(null),Z=I.useRef(null),te=I.useRef(null),ne=I.useRef(null),se=I.useRef(null),ee=I.useRef(null),de=I.useRef(null),fe=P==="top"||P==="bottom",ye=u$(0,function(jt,rn){fe&&B&&B({direction:jt>rn?"left":"right"})}),ge=It(ye,2),we=ge[0],Se=ge[1],xe=u$(0,function(jt,rn){!fe&&B&&B({direction:jt>rn?"top":"bottom"})}),Te=It(xe,2),ze=Te[0],Ue=Te[1],We=I.useState([0,0]),Be=It(We,2),Xe=Be[0],qe=Be[1],at=I.useState([0,0]),Ke=It(at,2),tt=Ke[0],vt=Ke[1],Pt=I.useState([0,0]),ft=It(Pt,2),Nt=ft[0],Rt=ft[1],pt=I.useState([0,0]),yt=It(pt,2),xt=yt[0],bt=yt[1],Ct=$ce(new Map),tn=It(Ct,2),Zt=tn[0],In=tn[1],Cn=Fce(K,Zt,tt[0]),Mt=Aw(Xe,fe),hn=Aw(tt,fe),Jt=Aw(Nt,fe),Ut=Aw(xt,fe),Tn=Math.floor(Mt)<Math.floor(hn+Jt),On=Tn?Mt-Ut:Mt-Jt,Kn="".concat(V,"-nav-operations-hidden"),Un=0,Pn=0;fe&&o?(Un=0,Pn=Math.max(0,hn-On)):(Un=Math.min(0,On-hn),Pn=0);function Qn(jt){return jt<Un?Un:jt>Pn?Pn:jt}var un=I.useRef(null),nn=I.useState(),$n=It(nn,2),Ln=$n[0],qn=$n[1];function er(){qn(Date.now())}function tr(){un.current&&clearTimeout(un.current)}Bce(ne,function(jt,rn){function yn(rr,En){rr(function(Zn){var ar=Qn(Zn+En);return ar})}return Tn?(fe?yn(Se,jt):yn(Ue,rn),tr(),er(),!0):!1}),I.useEffect(function(){return tr(),Ln&&(un.current=setTimeout(function(){qn(0)},100)),tr},[Ln]);var Jn=jce(Cn,On,fe?we:ze,hn,Jt,Ut,Je(Je({},e),{},{tabs:K})),Ir=It(Jn,2),_r=Ir[0],$r=Ir[1],mr=Io(function(){var jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,rn=Cn.get(jt)||{width:0,height:0,left:0,right:0,top:0};if(fe){var yn=we;o?rn.right<we?yn=rn.right:rn.right+rn.width>we+On&&(yn=rn.right+rn.width-On):rn.left<-we?yn=-rn.left:rn.left+rn.width>-we+On&&(yn=-(rn.left+rn.width-On)),Ue(0),Se(Qn(yn))}else{var rr=ze;rn.top<-ze?rr=-rn.top:rn.top+rn.height>-ze+On&&(rr=-(rn.top+rn.height-On)),Se(0),Ue(Qn(rr))}}),yi=I.useState(),Vr=It(yi,2),Kr=Vr[0],Rr=Vr[1],ii=I.useState(!1),Hr=It(ii,2),ut=Hr[0],ur=Hr[1],fr=K.filter(function(jt){return!jt.disabled}).map(function(jt){return jt.key}),Fn=function(rn){var yn=fr.indexOf(Kr||f),rr=fr.length,En=(yn+rn+rr)%rr,Zn=fr[En];Rr(Zn)},Gt=function(rn,yn){var rr=fr.indexOf(rn),En=K.find(function(ar){return ar.key===rn}),Zn=oD(En==null?void 0:En.closable,En==null?void 0:En.closeIcon,b,En==null?void 0:En.disabled);Zn&&(yn.preventDefault(),yn.stopPropagation(),b.onEdit("remove",{key:rn,event:yn}),rr===fr.length-1?Fn(-1):Fn(1))},mn=function(rn,yn){ur(!0),yn.button===1&&Gt(rn,yn)},Xn=function(rn){var yn=rn.code,rr=o&&fe,En=fr[0],Zn=fr[fr.length-1];switch(yn){case"ArrowLeft":{fe&&Fn(rr?1:-1);break}case"ArrowRight":{fe&&Fn(rr?-1:1);break}case"ArrowUp":{rn.preventDefault(),fe||Fn(-1);break}case"ArrowDown":{rn.preventDefault(),fe||Fn(1);break}case"Home":{rn.preventDefault(),Rr(En);break}case"End":{rn.preventDefault(),Rr(Zn);break}case"Enter":case"Space":{rn.preventDefault(),k(Kr??f,rn);break}case"Backspace":case"Delete":{Gt(Kr,rn);break}}},gr={};fe?gr[o?"marginRight":"marginLeft"]=A:gr.marginTop=A;var je=K.map(function(jt,rn){var yn=jt.key;return I.createElement(Gce,{id:s,prefixCls:V,key:yn,tab:jt,style:rn===0?void 0:gr,closable:jt.closable,editable:b,active:yn===f,focus:yn===Kr,renderWrapper:D,removeAriaLabel:C==null?void 0:C.removeAriaLabel,tabCount:fr.length,currentPosition:rn+1,onClick:function(En){k(yn,En)},onKeyDown:Xn,onFocus:function(){ut||Rr(yn),mr(yn),er(),ne.current&&(o||(ne.current.scrollLeft=0),ne.current.scrollTop=0)},onBlur:function(){Rr(void 0)},onMouseDown:function(En){return mn(yn,En)},onMouseUp:function(){ur(!1)}})}),re=function(){return In(function(){var rn,yn=new Map,rr=(rn=se.current)===null||rn===void 0?void 0:rn.getBoundingClientRect();return K.forEach(function(En){var Zn,ar=En.key,qr=(Zn=se.current)===null||Zn===void 0?void 0:Zn.querySelector('[data-node-key="'.concat(h8(ar),'"]'));if(qr){var Ar=Wce(qr,rr),yr=It(Ar,4),Jr=yr[0],ni=yr[1],Qr=yr[2],li=yr[3];yn.set(ar,{width:Jr,height:ni,left:Qr,top:li})}}),yn})};I.useEffect(function(){re()},[K.map(function(jt){return jt.key}).join("_")]);var ie=d8(function(){var jt=Hg(Y),rn=Hg(Z),yn=Hg(te);qe([jt[0]-rn[0]-yn[0],jt[1]-rn[1]-yn[1]]);var rr=Hg(de);Rt(rr);var En=Hg(ee);bt(En);var Zn=Hg(se);vt([Zn[0]-rr[0],Zn[1]-rr[1]]),re()}),_e=K.slice(0,_r),Re=K.slice($r+1),De=[].concat(zn(_e),zn(Re)),Ge=Cn.get(f),ot=kce({activeTabOffset:Ge,horizontal:fe,indicator:N,rtl:o}),Ye=ot.style;I.useEffect(function(){mr()},[f,Un,Pn,p$(Ge),p$(Cn),fe]),I.useEffect(function(){ie()},[o]);var rt=!!De.length,zt="".concat(V,"-nav-wrap"),it,$t,Qt,Ft;return fe?o?($t=we>0,it=we!==Pn):(it=we<0,$t=we!==Un):(Qt=ze<0,Ft=ze!==Un),I.createElement(Wl,{onResize:ie},I.createElement("div",{ref:bf(t,Y),role:"tablist","aria-orientation":fe?"horizontal":"vertical",className:St("".concat(V,"-nav"),n),style:i,onKeyDown:function(){er()}},I.createElement(m$,{ref:Z,position:"left",extra:y,prefixCls:V}),I.createElement(Wl,{onResize:ie},I.createElement("div",{className:St(zt,ke(ke(ke(ke({},"".concat(zt,"-ping-left"),it),"".concat(zt,"-ping-right"),$t),"".concat(zt,"-ping-top"),Qt),"".concat(zt,"-ping-bottom"),Ft)),ref:ne},I.createElement(Wl,{onResize:ie},I.createElement("div",{ref:se,className:"".concat(V,"-nav-list"),style:{transform:"translate(".concat(we,"px, ").concat(ze,"px)"),transition:Ln?"none":void 0}},je,I.createElement(f8,{ref:de,prefixCls:V,locale:C,editable:b,style:Je(Je({},je.length===0?void 0:gr),{},{visibility:rt?"hidden":null})}),I.createElement("div",{className:St("".concat(V,"-ink-bar"),ke({},"".concat(V,"-ink-bar-animated"),d.inkBar)),style:Ye}))))),I.createElement(Hce,kn({},e,{removeAriaLabel:C==null?void 0:C.removeAriaLabel,ref:ee,prefixCls:V,tabs:De,className:!rt&&Kn,tabMoving:!!Ln})),I.createElement(m$,{ref:te,position:"right",extra:y,prefixCls:V})))}),p8=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.className,s=e.style,d=e.id,f=e.active,o=e.tabKey,y=e.children;return I.createElement("div",{id:d&&"".concat(d,"-panel-").concat(o),role:"tabpanel",tabIndex:f?0:-1,"aria-labelledby":d&&"".concat(d,"-tab-").concat(o),"aria-hidden":!f,style:s,className:St(n,f&&"".concat(n,"-active"),i),ref:t},y)}),qce=["renderTabBar"],Kce=["label","key"],Xce=function(t){var n=t.renderTabBar,i=ri(t,qce),s=I.useContext(RE),d=s.tabs;if(n){var f=Je(Je({},i),{},{panes:d.map(function(o){var y=o.label,b=o.key,C=ri(o,Kce);return I.createElement(p8,kn({tab:y,key:b,tabKey:b},C))})});return n(f,g$)}return I.createElement(g$,i)},Zce=["key","forceRender","style","className","destroyInactiveTabPane"],Yce=function(t){var n=t.id,i=t.activeKey,s=t.animated,d=t.tabPosition,f=t.destroyInactiveTabPane,o=I.useContext(RE),y=o.prefixCls,b=o.tabs,C=s.tabPane,P="".concat(y,"-tabpane");return I.createElement("div",{className:St("".concat(y,"-content-holder"))},I.createElement("div",{className:St("".concat(y,"-content"),"".concat(y,"-content-").concat(d),ke({},"".concat(y,"-content-animated"),C))},b.map(function(A){var D=A.key,k=A.forceRender,B=A.style,N=A.className,j=A.destroyInactiveTabPane,V=ri(A,Zce),K=D===i;return I.createElement(wf,kn({key:D,visible:K,forceRender:k,removeOnLeave:!!(f||j),leavedClassName:"".concat(P,"-hidden")},s.tabPaneMotion),function(Y,Z){var te=Y.style,ne=Y.className;return I.createElement(p8,kn({},V,{prefixCls:P,id:n,tabKey:D,animated:C,active:K,style:Je(Je({},B),te),className:St(N,ne),ref:Z}))})})))};function Jce(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},t;return e===!1?t={inkBar:!1,tabPane:!1}:e===!0?t={inkBar:!0,tabPane:!1}:t=Je({inkBar:!0},Nr(e)==="object"?e:{}),t.tabPaneMotion&&t.tabPane===void 0&&(t.tabPane=!0),!t.tabPaneMotion&&t.tabPane&&(t.tabPane=!1),t}var Qce=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","more","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicator"],v$=0,eue=I.forwardRef(function(e,t){var n=e.id,i=e.prefixCls,s=i===void 0?"rc-tabs":i,d=e.className,f=e.items,o=e.direction,y=e.activeKey,b=e.defaultActiveKey,C=e.editable,P=e.animated,A=e.tabPosition,D=A===void 0?"top":A,k=e.tabBarGutter,B=e.tabBarStyle,N=e.tabBarExtraContent,j=e.locale,V=e.more,K=e.destroyInactiveTabPane,Y=e.renderTabBar,Z=e.onChange,te=e.onTabClick,ne=e.onTabScroll,se=e.getPopupContainer,ee=e.popupClassName,de=e.indicator,fe=ri(e,Qce),ye=I.useMemo(function(){return(f||[]).filter(function(xt){return xt&&Nr(xt)==="object"&&"key"in xt})},[f]),ge=o==="rtl",we=Jce(P),Se=I.useState(!1),xe=It(Se,2),Te=xe[0],ze=xe[1];I.useEffect(function(){ze(NO())},[]);var Ue=is(function(){var xt;return(xt=ye[0])===null||xt===void 0?void 0:xt.key},{value:y,defaultValue:b}),We=It(Ue,2),Be=We[0],Xe=We[1],qe=I.useState(function(){return ye.findIndex(function(xt){return xt.key===Be})}),at=It(qe,2),Ke=at[0],tt=at[1];I.useEffect(function(){var xt=ye.findIndex(function(Ct){return Ct.key===Be});if(xt===-1){var bt;xt=Math.max(0,Math.min(Ke,ye.length-1)),Xe((bt=ye[xt])===null||bt===void 0?void 0:bt.key)}tt(xt)},[ye.map(function(xt){return xt.key}).join("_"),Be,Ke]);var vt=is(null,{value:n}),Pt=It(vt,2),ft=Pt[0],Nt=Pt[1];I.useEffect(function(){n||(Nt("rc-tabs-".concat(v$)),v$+=1)},[]);function Rt(xt,bt){te==null||te(xt,bt);var Ct=xt!==Be;Xe(xt),Ct&&(Z==null||Z(xt))}var pt={id:ft,activeKey:Be,animated:we,tabPosition:D,rtl:ge,mobile:Te},yt=Je(Je({},pt),{},{editable:C,locale:j,more:V,tabBarGutter:k,onTabClick:Rt,onTabScroll:ne,extra:N,style:B,panes:null,getPopupContainer:se,popupClassName:ee,indicator:de});return I.createElement(RE.Provider,{value:{tabs:ye,prefixCls:s}},I.createElement("div",kn({ref:t,id:n,className:St(s,"".concat(s,"-").concat(D),ke(ke(ke({},"".concat(s,"-mobile"),Te),"".concat(s,"-editable"),C),"".concat(s,"-rtl"),ge),d)},fe),I.createElement(Xce,kn({},yt,{renderTabBar:Y})),I.createElement(Yce,kn({destroyInactiveTabPane:K},pt,{animated:we}))))});const tue={motionAppear:!1,motionEnter:!0,motionLeave:!0};function nue(e,t={inkBar:!0,tabPane:!1}){let n;return t===!1?n={inkBar:!1,tabPane:!1}:t===!0?n={inkBar:!0,tabPane:!0}:n=Object.assign({inkBar:!0},typeof t=="object"?t:{}),n.tabPane&&(n.tabPaneMotion=Object.assign(Object.assign({},tue),{motionName:IO(e,"switch")})),n}var rue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function iue(e){return e.filter(t=>t)}function oue(e,t){if(e)return e.map(i=>{var s;const d=(s=i.destroyOnHidden)!==null&&s!==void 0?s:i.destroyInactiveTabPane;return Object.assign(Object.assign({},i),{destroyInactiveTabPane:d})});const n=vc(t).map(i=>{if(I.isValidElement(i)){const{key:s,props:d}=i,f=d||{},{tab:o}=f,y=rue(f,["tab"]);return Object.assign(Object.assign({key:String(s)},y),{label:o})}return null});return iue(n)}const aue=e=>{const{componentCls:t,motionDurationSlow:n}=e;return[{[t]:{[`${t}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${n}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${n}`}}}}},[ff(e,"slide-up"),ff(e,"slide-down")]]},sue=e=>{const{componentCls:t,tabsCardPadding:n,cardBg:i,cardGutter:s,colorBorderSecondary:d,itemSelectedColor:f}=e;return{[`${t}-card`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{margin:0,padding:n,background:i,border:`${dt(e.lineWidth)} ${e.lineType} ${d}`,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOut}`},[`${t}-tab-active`]:{color:f,background:e.colorBgContainer},[`${t}-tab-focus:has(${t}-tab-btn:focus-visible)`]:Nu(e,-3),[`& ${t}-tab${t}-tab-focus ${t}-tab-btn:focus-visible`]:{outline:"none"},[`${t}-ink-bar`]:{visibility:"hidden"}},[`&${t}-top, &${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginLeft:{_skip_check_:!0,value:dt(s)}}}},[`&${t}-top`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:`${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0 0`},[`${t}-tab-active`]:{borderBottomColor:e.colorBgContainer}}},[`&${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:`0 0 ${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)}`},[`${t}-tab-active`]:{borderTopColor:e.colorBgContainer}}},[`&${t}-left, &${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginTop:dt(s)}}},[`&${t}-left`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`${dt(e.borderRadiusLG)} 0 0 ${dt(e.borderRadiusLG)}`}},[`${t}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:e.colorBgContainer}}}},[`&${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0`}},[`${t}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:e.colorBgContainer}}}}}}},lue=e=>{const{componentCls:t,itemHoverColor:n,dropdownEdgeChildVerticalPadding:i}=e;return{[`${t}-dropdown`]:Object.assign(Object.assign({},ya(e)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:e.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.tabsDropdownHeight,margin:0,padding:`${dt(i)} 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:e.colorBgContainer,backgroundClip:"padding-box",borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary,"&-item":Object.assign(Object.assign({},df),{display:"flex",alignItems:"center",minWidth:e.tabsDropdownWidth,margin:0,padding:`${dt(e.paddingXXS)} ${dt(e.paddingSM)}`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer",transition:`all ${e.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:e.marginSM},color:e.colorIcon,fontSize:e.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:n}},"&:hover":{background:e.controlItemBgHover},"&-disabled":{"&, &:hover":{color:e.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},cue=e=>{const{componentCls:t,margin:n,colorBorderSecondary:i,horizontalMargin:s,verticalItemPadding:d,verticalItemMargin:f,calc:o}=e;return{[`${t}-top, ${t}-bottom`]:{flexDirection:"column",[`> ${t}-nav, > div > ${t}-nav`]:{margin:s,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${dt(e.lineWidth)} ${e.lineType} ${i}`,content:"''"},[`${t}-ink-bar`]:{height:e.lineWidthBold,"&-animated":{transition:`width ${e.motionDurationSlow}, left ${e.motionDurationSlow},
            right ${e.motionDurationSlow}`}},[`${t}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:e.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:e.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:e.boxShadowTabsOverflowRight},[`&${t}-nav-wrap-ping-left::before`]:{opacity:1},[`&${t}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${t}-top`]:{[`> ${t}-nav,
        > div > ${t}-nav`]:{"&::before":{bottom:0},[`${t}-ink-bar`]:{bottom:0}}},[`${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{order:1,marginTop:n,marginBottom:0,"&::before":{top:0},[`${t}-ink-bar`]:{top:0}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{order:0}},[`${t}-left, ${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{flexDirection:"column",minWidth:o(e.controlHeight).mul(1.25).equal(),[`${t}-tab`]:{padding:d,textAlign:"center"},[`${t}-tab + ${t}-tab`]:{margin:f},[`${t}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:e.controlHeight},"&::before":{top:0,boxShadow:e.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:e.boxShadowTabsOverflowBottom},[`&${t}-nav-wrap-ping-top::before`]:{opacity:1},[`&${t}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${t}-ink-bar`]:{width:e.lineWidthBold,"&-animated":{transition:`height ${e.motionDurationSlow}, top ${e.motionDurationSlow}`}},[`${t}-nav-list, ${t}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${t}-left`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{marginLeft:{_skip_check_:!0,value:dt(o(e.lineWidth).mul(-1).equal())},borderLeft:{_skip_check_:!0,value:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},[`> ${t}-content > ${t}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:e.paddingLG}}}},[`${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{order:1,[`${t}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:o(e.lineWidth).mul(-1).equal()},borderRight:{_skip_check_:!0,value:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},[`> ${t}-content > ${t}-tabpane`]:{paddingRight:{_skip_check_:!0,value:e.paddingLG}}}}}},uue=e=>{const{componentCls:t,cardPaddingSM:n,cardPaddingLG:i,cardHeightSM:s,cardHeightLG:d,horizontalItemPaddingSM:f,horizontalItemPaddingLG:o}=e;return{[t]:{"&-small":{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:f,fontSize:e.titleFontSizeSM}}},"&-large":{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:o,fontSize:e.titleFontSizeLG,lineHeight:e.lineHeightLG}}}},[`${t}-card`]:{[`&${t}-small`]:{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:n},[`${t}-nav-add`]:{minWidth:s,minHeight:s}},[`&${t}-bottom`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:`0 0 ${dt(e.borderRadius)} ${dt(e.borderRadius)}`}},[`&${t}-top`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:`${dt(e.borderRadius)} ${dt(e.borderRadius)} 0 0`}},[`&${t}-right`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${dt(e.borderRadius)} ${dt(e.borderRadius)} 0`}}},[`&${t}-left`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`${dt(e.borderRadius)} 0 0 ${dt(e.borderRadius)}`}}}},[`&${t}-large`]:{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:i},[`${t}-nav-add`]:{minWidth:d,minHeight:d}}}}}},due=e=>{const{componentCls:t,itemActiveColor:n,itemHoverColor:i,iconCls:s,tabsHorizontalItemMargin:d,horizontalItemPadding:f,itemSelectedColor:o,itemColor:y}=e,b=`${t}-tab`;return{[b]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:f,fontSize:e.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:y,"&-btn, &-remove":{"&:focus:not(:focus-visible), &:active":{color:n}},"&-btn":{outline:"none",transition:`all ${e.motionDurationSlow}`,[`${b}-icon:not(:last-child)`]:{marginInlineEnd:e.marginSM}},"&-remove":Object.assign({flex:"none",lineHeight:1,marginRight:{_skip_check_:!0,value:e.calc(e.marginXXS).mul(-1).equal()},marginLeft:{_skip_check_:!0,value:e.marginXS},color:e.colorIcon,fontSize:e.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextHeading}},hf(e)),"&:hover":{color:i},[`&${b}-active ${b}-btn`]:{color:o,textShadow:e.tabsActiveTextShadow},[`&${b}-focus ${b}-btn:focus-visible`]:Nu(e),[`&${b}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed"},[`&${b}-disabled ${b}-btn, &${b}-disabled ${t}-remove`]:{"&:focus, &:active":{color:e.colorTextDisabled}},[`& ${b}-remove ${s}`]:{margin:0,verticalAlign:"middle"},[`${s}:not(:last-child)`]:{marginRight:{_skip_check_:!0,value:e.marginSM}}},[`${b} + ${b}`]:{margin:{_skip_check_:!0,value:d}}}},hue=e=>{const{componentCls:t,tabsHorizontalItemMarginRTL:n,iconCls:i,cardGutter:s,calc:d}=e;return{[`${t}-rtl`]:{direction:"rtl",[`${t}-nav`]:{[`${t}-tab`]:{margin:{_skip_check_:!0,value:n},[`${t}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[i]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:dt(e.marginSM)}},[`${t}-tab-remove`]:{marginRight:{_skip_check_:!0,value:dt(e.marginXS)},marginLeft:{_skip_check_:!0,value:dt(d(e.marginXXS).mul(-1).equal())},[i]:{margin:0}}}},[`&${t}-left`]:{[`> ${t}-nav`]:{order:1},[`> ${t}-content-holder`]:{order:0}},[`&${t}-right`]:{[`> ${t}-nav`]:{order:0},[`> ${t}-content-holder`]:{order:1}},[`&${t}-card${t}-top, &${t}-card${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginRight:{_skip_check_:!0,value:s},marginLeft:{_skip_check_:!0,value:0}}}}},[`${t}-dropdown-rtl`]:{direction:"rtl"},[`${t}-menu-item`]:{[`${t}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},fue=e=>{const{componentCls:t,tabsCardPadding:n,cardHeight:i,cardGutter:s,itemHoverColor:d,itemActiveColor:f,colorBorderSecondary:o}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},ya(e)),{display:"flex",[`> ${t}-nav, > div > ${t}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${t}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${e.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${t}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${e.motionDurationSlow}`},[`${t}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${t}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${t}-nav-more`]:{position:"relative",padding:n,background:"transparent",border:0,color:e.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:e.calc(e.controlHeightLG).div(8).equal(),transform:"translateY(100%)",content:"''"}},[`${t}-nav-add`]:Object.assign({minWidth:i,minHeight:i,marginLeft:{_skip_check_:!0,value:s},background:"transparent",border:`${dt(e.lineWidth)} ${e.lineType} ${o}`,borderRadius:`${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0 0`,outline:"none",cursor:"pointer",color:e.colorText,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&:hover":{color:d},"&:active, &:focus:not(:focus-visible)":{color:f}},hf(e,-3))},[`${t}-extra-content`]:{flex:"none"},[`${t}-ink-bar`]:{position:"absolute",background:e.inkBarColor,pointerEvents:"none"}}),due(e)),{[`${t}-content`]:{position:"relative",width:"100%"},[`${t}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${t}-tabpane`]:Object.assign(Object.assign({},hf(e)),{"&-hidden":{display:"none"}})}),[`${t}-centered`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-nav-wrap`]:{[`&:not([class*='${t}-nav-wrap-ping']) > ${t}-nav-list`]:{margin:"auto"}}}}}},pue=e=>{const{cardHeight:t,cardHeightSM:n,cardHeightLG:i,controlHeight:s,controlHeightLG:d}=e,f=t||d,o=n||s,y=i||d+8;return{zIndexPopup:e.zIndexPopupBase+50,cardBg:e.colorFillAlter,cardHeight:f,cardHeightSM:o,cardHeightLG:y,cardPadding:`${(f-e.fontHeight)/2-e.lineWidth}px ${e.padding}px`,cardPaddingSM:`${(o-e.fontHeight)/2-e.lineWidth}px ${e.paddingXS}px`,cardPaddingLG:`${(y-e.fontHeightLG)/2-e.lineWidth}px ${e.padding}px`,titleFontSize:e.fontSize,titleFontSizeLG:e.fontSizeLG,titleFontSizeSM:e.fontSize,inkBarColor:e.colorPrimary,horizontalMargin:`0 0 ${e.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${e.paddingSM}px 0`,horizontalItemPaddingSM:`${e.paddingXS}px 0`,horizontalItemPaddingLG:`${e.padding}px 0`,verticalItemPadding:`${e.paddingXS}px ${e.paddingLG}px`,verticalItemMargin:`${e.margin}px 0 0 0`,itemColor:e.colorText,itemSelectedColor:e.colorPrimary,itemHoverColor:e.colorPrimaryHover,itemActiveColor:e.colorPrimaryActive,cardGutter:e.marginXXS/2}},mue=za("Tabs",e=>{const t=xo(e,{tabsCardPadding:e.cardPadding,dropdownEdgeChildVerticalPadding:e.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${dt(e.horizontalItemGutter)}`,tabsHorizontalItemMarginRTL:`0 0 0 ${dt(e.horizontalItemGutter)}`});return[uue(t),hue(t),cue(t),lue(t),sue(t),fue(t),aue(t)]},pue),gue=()=>null;var vue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const _ue=I.forwardRef((e,t)=>{var n,i,s,d,f,o,y,b,C,P,A;const{type:D,className:k,rootClassName:B,size:N,onEdit:j,hideAdd:V,centered:K,addIcon:Y,removeIcon:Z,moreIcon:te,more:ne,popupClassName:se,children:ee,items:de,animated:fe,style:ye,indicatorSize:ge,indicator:we,destroyInactiveTabPane:Se,destroyOnHidden:xe}=e,Te=vue(e,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","removeIcon","moreIcon","more","popupClassName","children","items","animated","style","indicatorSize","indicator","destroyInactiveTabPane","destroyOnHidden"]),{prefixCls:ze}=Te,{direction:Ue,tabs:We,getPrefixCls:Be,getPopupContainer:Xe}=I.useContext(ji),qe=Be("tabs",ze),at=Wu(qe),[Ke,tt,vt]=mue(qe,at),Pt=I.useRef(null);I.useImperativeHandle(t,()=>({nativeElement:Pt.current}));let ft;D==="editable-card"&&(ft={onEdit:(Ct,{key:tn,event:Zt})=>{j==null||j(Ct==="add"?Zt:tn,Ct)},removeIcon:(n=Z??(We==null?void 0:We.removeIcon))!==null&&n!==void 0?n:I.createElement(SO,null),addIcon:(Y??(We==null?void 0:We.addIcon))||I.createElement(zce,null),showAdd:V!==!0});const Nt=Be(),Rt=Bd(N),pt=oue(de,ee),yt=nue(qe,fe),xt=Object.assign(Object.assign({},We==null?void 0:We.style),ye),bt={align:(i=we==null?void 0:we.align)!==null&&i!==void 0?i:(s=We==null?void 0:We.indicator)===null||s===void 0?void 0:s.align,size:(y=(f=(d=we==null?void 0:we.size)!==null&&d!==void 0?d:ge)!==null&&f!==void 0?f:(o=We==null?void 0:We.indicator)===null||o===void 0?void 0:o.size)!==null&&y!==void 0?y:We==null?void 0:We.indicatorSize};return Ke(I.createElement(eue,Object.assign({ref:Pt,direction:Ue,getPopupContainer:Xe},Te,{items:pt,className:St({[`${qe}-${Rt}`]:Rt,[`${qe}-card`]:["card","editable-card"].includes(D),[`${qe}-editable-card`]:D==="editable-card",[`${qe}-centered`]:K},We==null?void 0:We.className,k,B,tt,vt,at),popupClassName:St(se,tt,vt,at),style:xt,editable:ft,more:Object.assign({icon:(A=(P=(C=(b=We==null?void 0:We.more)===null||b===void 0?void 0:b.icon)!==null&&C!==void 0?C:We==null?void 0:We.moreIcon)!==null&&P!==void 0?P:te)!==null&&A!==void 0?A:I.createElement(QO,null),transitionName:`${Nt}-slide-up`},ne),prefixCls:qe,animated:yt,indicator:bt,destroyInactiveTabPane:xe??Se})))}),m8=_ue;m8.TabPane=gue;var yue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const g8=e=>{var{prefixCls:t,className:n,hoverable:i=!0}=e,s=yue(e,["prefixCls","className","hoverable"]);const{getPrefixCls:d}=I.useContext(ji),f=d("card",t),o=St(`${f}-grid`,n,{[`${f}-grid-hoverable`]:i});return I.createElement("div",Object.assign({},s,{className:o}))},xue=e=>{const{antCls:t,componentCls:n,headerHeight:i,headerPadding:s,tabsMarginBottom:d}=e;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:i,marginBottom:-1,padding:`0 ${dt(s)}`,color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.headerFontSize,background:e.headerBg,borderBottom:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`,borderRadius:`${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0 0`},Kp()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},df),{[`
          > ${n}-typography,
          > ${n}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${t}-tabs-top`]:{clear:"both",marginBottom:d,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,"&-bar":{borderBottom:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`}}})},bue=e=>{const{cardPaddingBase:t,colorBorderSecondary:n,cardShadow:i,lineWidth:s}=e;return{width:"33.33%",padding:t,border:0,borderRadius:0,boxShadow:`
      ${dt(s)} 0 0 0 ${n},
      0 ${dt(s)} 0 0 ${n},
      ${dt(s)} ${dt(s)} 0 0 ${n},
      ${dt(s)} 0 0 0 ${n} inset,
      0 ${dt(s)} 0 0 ${n} inset;
    `,transition:`all ${e.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:i}}},wue=e=>{const{componentCls:t,iconCls:n,actionsLiMargin:i,cardActionsIconSize:s,colorBorderSecondary:d,actionsBg:f}=e;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:f,borderTop:`${dt(e.lineWidth)} ${e.lineType} ${d}`,display:"flex",borderRadius:`0 0 ${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)}`},Kp()),{"& > li":{margin:i,color:e.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:e.calc(e.cardActionsIconSize).mul(2).equal(),fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer","&:hover":{color:e.colorPrimary,transition:`color ${e.motionDurationMid}`},[`a:not(${t}-btn), > ${n}`]:{display:"inline-block",width:"100%",color:e.colorIcon,lineHeight:dt(e.fontHeight),transition:`color ${e.motionDurationMid}`,"&:hover":{color:e.colorPrimary}},[`> ${n}`]:{fontSize:s,lineHeight:dt(e.calc(s).mul(e.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${dt(e.lineWidth)} ${e.lineType} ${d}`}}})},Sue=e=>Object.assign(Object.assign({margin:`${dt(e.calc(e.marginXXS).mul(-1).equal())} 0`,display:"flex"},Kp()),{"&-avatar":{paddingInlineEnd:e.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:e.marginXS}},"&-title":Object.assign({color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG},df),"&-description":{color:e.colorTextDescription}}),Cue=e=>{const{componentCls:t,colorFillAlter:n,headerPadding:i,bodyPadding:s}=e;return{[`${t}-head`]:{padding:`0 ${dt(i)}`,background:n,"&-title":{fontSize:e.fontSize}},[`${t}-body`]:{padding:`${dt(e.padding)} ${dt(s)}`}}},Eue=e=>{const{componentCls:t}=e;return{overflow:"hidden",[`${t}-body`]:{userSelect:"none"}}},Tue=e=>{const{componentCls:t,cardShadow:n,cardHeadPadding:i,colorBorderSecondary:s,boxShadowTertiary:d,bodyPadding:f,extraColor:o}=e;return{[t]:Object.assign(Object.assign({},ya(e)),{position:"relative",background:e.colorBgContainer,borderRadius:e.borderRadiusLG,[`&:not(${t}-bordered)`]:{boxShadow:d},[`${t}-head`]:xue(e),[`${t}-extra`]:{marginInlineStart:"auto",color:o,fontWeight:"normal",fontSize:e.fontSize},[`${t}-body`]:{padding:f,borderRadius:`0 0 ${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)}`},[`${t}-grid`]:bue(e),[`${t}-cover`]:{"> *":{display:"block",width:"100%",borderRadius:`${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0 0`}},[`${t}-actions`]:wue(e),[`${t}-meta`]:Sue(e)}),[`${t}-bordered`]:{border:`${dt(e.lineWidth)} ${e.lineType} ${s}`,[`${t}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${t}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${e.motionDurationMid}, border-color ${e.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:n}},[`${t}-contain-grid`]:{borderRadius:`${dt(e.borderRadiusLG)} ${dt(e.borderRadiusLG)} 0 0 `,[`${t}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${t}-loading) ${t}-body`]:{marginBlockStart:e.calc(e.lineWidth).mul(-1).equal(),marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),padding:0}},[`${t}-contain-tabs`]:{[`> div${t}-head`]:{minHeight:0,[`${t}-head-title, ${t}-extra`]:{paddingTop:i}}},[`${t}-type-inner`]:Cue(e),[`${t}-loading`]:Eue(e),[`${t}-rtl`]:{direction:"rtl"}}},Iue=e=>{const{componentCls:t,bodyPaddingSM:n,headerPaddingSM:i,headerHeightSM:s,headerFontSizeSM:d}=e;return{[`${t}-small`]:{[`> ${t}-head`]:{minHeight:s,padding:`0 ${dt(i)}`,fontSize:d,[`> ${t}-head-wrapper`]:{[`> ${t}-extra`]:{fontSize:e.fontSize}}},[`> ${t}-body`]:{padding:n}},[`${t}-small${t}-contain-tabs`]:{[`> ${t}-head`]:{[`${t}-head-title, ${t}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},Pue=e=>{var t,n;return{headerBg:"transparent",headerFontSize:e.fontSizeLG,headerFontSizeSM:e.fontSize,headerHeight:e.fontSizeLG*e.lineHeightLG+e.padding*2,headerHeightSM:e.fontSize*e.lineHeight+e.paddingXS*2,actionsBg:e.colorBgContainer,actionsLiMargin:`${e.paddingSM}px 0`,tabsMarginBottom:-e.padding-e.lineWidth,extraColor:e.colorText,bodyPaddingSM:12,headerPaddingSM:12,bodyPadding:(t=e.bodyPadding)!==null&&t!==void 0?t:e.paddingLG,headerPadding:(n=e.headerPadding)!==null&&n!==void 0?n:e.paddingLG}},Mue=za("Card",e=>{const t=xo(e,{cardShadow:e.boxShadowCard,cardHeadPadding:e.padding,cardPaddingBase:e.paddingLG,cardActionsIconSize:e.fontSize});return[Tue(t),Iue(t)]},Pue);var _$=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Rue=e=>{const{actionClasses:t,actions:n=[],actionStyle:i}=e;return I.createElement("ul",{className:t,style:i},n.map((s,d)=>{const f=`action-${d}`;return I.createElement("li",{style:{width:`${100/n.length}%`},key:f},I.createElement("span",null,s))}))},Aue=I.forwardRef((e,t)=>{const{prefixCls:n,className:i,rootClassName:s,style:d,extra:f,headStyle:o={},bodyStyle:y={},title:b,loading:C,bordered:P,variant:A,size:D,type:k,cover:B,actions:N,tabList:j,children:V,activeTabKey:K,defaultActiveTabKey:Y,tabBarExtraContent:Z,hoverable:te,tabProps:ne={},classNames:se,styles:ee}=e,de=_$(e,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","variant","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:fe,direction:ye,card:ge}=I.useContext(ji),[we]=UO("card",A,P),Se=Cn=>{var Mt;(Mt=e.onTabChange)===null||Mt===void 0||Mt.call(e,Cn)},xe=Cn=>{var Mt;return St((Mt=ge==null?void 0:ge.classNames)===null||Mt===void 0?void 0:Mt[Cn],se==null?void 0:se[Cn])},Te=Cn=>{var Mt;return Object.assign(Object.assign({},(Mt=ge==null?void 0:ge.styles)===null||Mt===void 0?void 0:Mt[Cn]),ee==null?void 0:ee[Cn])},ze=I.useMemo(()=>{let Cn=!1;return I.Children.forEach(V,Mt=>{(Mt==null?void 0:Mt.type)===g8&&(Cn=!0)}),Cn},[V]),Ue=fe("card",n),[We,Be,Xe]=Mue(Ue),qe=I.createElement(Zv,{loading:!0,active:!0,paragraph:{rows:4},title:!1},V),at=K!==void 0,Ke=Object.assign(Object.assign({},ne),{[at?"activeKey":"defaultActiveKey"]:at?K:Y,tabBarExtraContent:Z});let tt;const vt=Bd(D),Pt=!vt||vt==="default"?"large":vt,ft=j?I.createElement(m8,Object.assign({size:Pt},Ke,{className:`${Ue}-head-tabs`,onChange:Se,items:j.map(Cn=>{var{tab:Mt}=Cn,hn=_$(Cn,["tab"]);return Object.assign({label:Mt},hn)})})):null;if(b||f||ft){const Cn=St(`${Ue}-head`,xe("header")),Mt=St(`${Ue}-head-title`,xe("title")),hn=St(`${Ue}-extra`,xe("extra")),Jt=Object.assign(Object.assign({},o),Te("header"));tt=I.createElement("div",{className:Cn,style:Jt},I.createElement("div",{className:`${Ue}-head-wrapper`},b&&I.createElement("div",{className:Mt,style:Te("title")},b),f&&I.createElement("div",{className:hn,style:Te("extra")},f)),ft)}const Nt=St(`${Ue}-cover`,xe("cover")),Rt=B?I.createElement("div",{className:Nt,style:Te("cover")},B):null,pt=St(`${Ue}-body`,xe("body")),yt=Object.assign(Object.assign({},y),Te("body")),xt=I.createElement("div",{className:pt,style:yt},C?qe:V),bt=St(`${Ue}-actions`,xe("actions")),Ct=N!=null&&N.length?I.createElement(Rue,{actionClasses:bt,actionStyle:Te("actions"),actions:N}):null,tn=as(de,["onTabChange"]),Zt=St(Ue,ge==null?void 0:ge.className,{[`${Ue}-loading`]:C,[`${Ue}-bordered`]:we!=="borderless",[`${Ue}-hoverable`]:te,[`${Ue}-contain-grid`]:ze,[`${Ue}-contain-tabs`]:j==null?void 0:j.length,[`${Ue}-${vt}`]:vt,[`${Ue}-type-${k}`]:!!k,[`${Ue}-rtl`]:ye==="rtl"},i,s,Be,Xe),In=Object.assign(Object.assign({},ge==null?void 0:ge.style),d);return We(I.createElement("div",Object.assign({ref:t},tn,{className:Zt,style:In}),tt,Rt,xt,Ct))});var Oue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Due=e=>{const{prefixCls:t,className:n,avatar:i,title:s,description:d}=e,f=Oue(e,["prefixCls","className","avatar","title","description"]),{getPrefixCls:o}=I.useContext(ji),y=o("card",t),b=St(`${y}-meta`,n),C=i?I.createElement("div",{className:`${y}-meta-avatar`},i):null,P=s?I.createElement("div",{className:`${y}-meta-title`},s):null,A=d?I.createElement("div",{className:`${y}-meta-description`},d):null,D=P||A?I.createElement("div",{className:`${y}-meta-detail`},P,A):null;return I.createElement("div",Object.assign({},f,{className:b}),C,D)},Sl=Aue;Sl.Grid=g8;Sl.Meta=Due;function Lue(e,t,n){var i=n||{},s=i.noTrailing,d=s===void 0?!1:s,f=i.noLeading,o=f===void 0?!1:f,y=i.debounceMode,b=y===void 0?void 0:y,C,P=!1,A=0;function D(){C&&clearTimeout(C)}function k(N){var j=N||{},V=j.upcomingOnly,K=V===void 0?!1:V;D(),P=!K}function B(){for(var N=arguments.length,j=new Array(N),V=0;V<N;V++)j[V]=arguments[V];var K=this,Y=Date.now()-A;if(P)return;function Z(){A=Date.now(),t.apply(K,j)}function te(){C=void 0}!o&&b&&!C&&Z(),D(),b===void 0&&Y>e?o?(A=Date.now(),d||(C=setTimeout(b?te:Z,e))):Z():d!==!0&&(C=setTimeout(b?te:Z,b===void 0?e-Y:e))}return B.cancel=k,B}function zue(e,t,n){var i={},s=i.atBegin,d=s===void 0?!1:s;return Lue(e,t,{debounceMode:d!==!1})}function Il(e,t){return e[t]}var kue=["children"];function v8(e,t){return"".concat(e,"-").concat(t)}function Fue(e){return e&&e.type&&e.type.isTreeNode}function cb(e,t){return e??t}function zv(e){var t=e||{},n=t.title,i=t._title,s=t.key,d=t.children,f=n||"title";return{title:f,_title:i||[f],key:s||"key",children:d||"children"}}function _8(e){function t(n){var i=vc(n);return i.map(function(s){if(!Fue(s))return oa(!s,"Tree/TreeNode can only accept TreeNode as children."),null;var d=s.key,f=s.props,o=f.children,y=ri(f,kue),b=Je({key:d},y),C=t(o);return C.length&&(b.children=C),b}).filter(function(s){return s})}return t(e)}function iP(e,t,n){var i=zv(n),s=i._title,d=i.key,f=i.children,o=new Set(t===!0?[]:t),y=[];function b(C){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return C.map(function(A,D){for(var k=v8(P?P.pos:"0",D),B=cb(A[d],k),N,j=0;j<s.length;j+=1){var V=s[j];if(A[V]!==void 0){N=A[V];break}}var K=Object.assign(as(A,[].concat(zn(s),[d,f])),{title:N,key:B,parent:P,pos:k,children:null,data:A,isStart:[].concat(zn(P?P.isStart:[]),[D===0]),isEnd:[].concat(zn(P?P.isEnd:[]),[D===C.length-1])});return y.push(K),t===!0||o.has(B)?K.children=b(A[f]||[],K):K.children=[],K})}return b(e),y}function Nue(e,t,n){var i={};Nr(n)==="object"?i=n:i={externalGetKey:n},i=i||{};var s=i,d=s.childrenPropName,f=s.externalGetKey,o=s.fieldNames,y=zv(o),b=y.key,C=y.children,P=d||C,A;f?typeof f=="string"?A=function(B){return B[f]}:typeof f=="function"&&(A=function(B){return f(B)}):A=function(B,N){return cb(B[b],N)};function D(k,B,N,j){var V=k?k[P]:e,K=k?v8(N.pos,B):"0",Y=k?[].concat(zn(j),[k]):[];if(k){var Z=A(k,K),te={node:k,index:B,pos:K,key:Z,parentPos:N.node?N.pos:null,level:N.level+1,nodes:Y};t(te)}V&&V.forEach(function(ne,se){D(ne,se,{node:k,pos:K,level:N?N.level+1:-1},Y)})}D(null)}function aD(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.initWrapper,i=t.processEntity,s=t.onProcessFinished,d=t.externalGetKey,f=t.childrenPropName,o=t.fieldNames,y=arguments.length>2?arguments[2]:void 0,b=d||y,C={},P={},A={posEntities:C,keyEntities:P};return n&&(A=n(A)||A),Nue(e,function(D){var k=D.node,B=D.index,N=D.pos,j=D.key,V=D.parentPos,K=D.level,Y=D.nodes,Z={node:k,nodes:Y,index:B,key:j,pos:N,level:K},te=cb(j,N);C[N]=Z,P[te]=Z,Z.parent=C[V],Z.parent&&(Z.parent.children=Z.parent.children||[],Z.parent.children.push(Z)),i&&i(Z,A)},{externalGetKey:b,childrenPropName:f,fieldNames:o}),s&&s(A),A}function q0(e,t){var n=t.expandedKeys,i=t.selectedKeys,s=t.loadedKeys,d=t.loadingKeys,f=t.checkedKeys,o=t.halfCheckedKeys,y=t.dragOverNodeKey,b=t.dropPosition,C=t.keyEntities,P=Il(C,e),A={eventKey:e,expanded:n.indexOf(e)!==-1,selected:i.indexOf(e)!==-1,loaded:s.indexOf(e)!==-1,loading:d.indexOf(e)!==-1,checked:f.indexOf(e)!==-1,halfChecked:o.indexOf(e)!==-1,pos:String(P?P.pos:""),dragOver:y===e&&b===0,dragOverGapTop:y===e&&b===-1,dragOverGapBottom:y===e&&b===1};return A}function Ka(e){var t=e.data,n=e.expanded,i=e.selected,s=e.checked,d=e.loaded,f=e.loading,o=e.halfChecked,y=e.dragOver,b=e.dragOverGapTop,C=e.dragOverGapBottom,P=e.pos,A=e.active,D=e.eventKey,k=Je(Je({},t),{},{expanded:n,selected:i,checked:s,loaded:d,loading:f,halfChecked:o,dragOver:y,dragOverGapTop:b,dragOverGapBottom:C,pos:P,active:A,key:D});return"props"in k||Object.defineProperty(k,"props",{get:function(){return oa(!1,"Second param return from event is node data instead of TreeNode instance. Please read value directly instead of reading from `props`."),e}}),k}function y8(e,t){var n=new Set;return e.forEach(function(i){t.has(i)||n.add(i)}),n}function Bue(e){var t=e||{},n=t.disabled,i=t.disableCheckbox,s=t.checkable;return!!(n||i)||s===!1}function $ue(e,t,n,i){for(var s=new Set(e),d=new Set,f=0;f<=n;f+=1){var o=t.get(f)||new Set;o.forEach(function(P){var A=P.key,D=P.node,k=P.children,B=k===void 0?[]:k;s.has(A)&&!i(D)&&B.filter(function(N){return!i(N.node)}).forEach(function(N){s.add(N.key)})})}for(var y=new Set,b=n;b>=0;b-=1){var C=t.get(b)||new Set;C.forEach(function(P){var A=P.parent,D=P.node;if(!(i(D)||!P.parent||y.has(P.parent.key))){if(i(P.parent.node)){y.add(A.key);return}var k=!0,B=!1;(A.children||[]).filter(function(N){return!i(N.node)}).forEach(function(N){var j=N.key,V=s.has(j);k&&!V&&(k=!1),!B&&(V||d.has(j))&&(B=!0)}),k&&s.add(A.key),B&&d.add(A.key),y.add(A.key)}})}return{checkedKeys:Array.from(s),halfCheckedKeys:Array.from(y8(d,s))}}function jue(e,t,n,i,s){for(var d=new Set(e),f=new Set(t),o=0;o<=i;o+=1){var y=n.get(o)||new Set;y.forEach(function(A){var D=A.key,k=A.node,B=A.children,N=B===void 0?[]:B;!d.has(D)&&!f.has(D)&&!s(k)&&N.filter(function(j){return!s(j.node)}).forEach(function(j){d.delete(j.key)})})}f=new Set;for(var b=new Set,C=i;C>=0;C-=1){var P=n.get(C)||new Set;P.forEach(function(A){var D=A.parent,k=A.node;if(!(s(k)||!A.parent||b.has(A.parent.key))){if(s(A.parent.node)){b.add(D.key);return}var B=!0,N=!1;(D.children||[]).filter(function(j){return!s(j.node)}).forEach(function(j){var V=j.key,K=d.has(V);B&&!K&&(B=!1),!N&&(K||f.has(V))&&(N=!0)}),B||d.delete(D.key),N&&f.add(D.key),b.add(D.key)}})}return{checkedKeys:Array.from(d),halfCheckedKeys:Array.from(y8(f,d))}}function yv(e,t,n,i){var s=[],d;i?d=i:d=Bue;var f=new Set(e.filter(function(C){var P=!!Il(n,C);return P||s.push(C),P})),o=new Map,y=0;Object.keys(n).forEach(function(C){var P=n[C],A=P.level,D=o.get(A);D||(D=new Set,o.set(A,D)),D.add(P),y=Math.max(y,A)}),oa(!s.length,"Tree missing follow keys: ".concat(s.slice(0,100).map(function(C){return"'".concat(C,"'")}).join(", ")));var b;return t===!0?b=$ue(f,o,y,d):b=jue(f,t.halfCheckedKeys,o,y,d),b}const Vue=e=>{const{checkboxCls:t}=e,n=`${t}-wrapper`;return[{[`${t}-group`]:Object.assign(Object.assign({},ya(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[n]:Object.assign(Object.assign({},ya(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${n}`]:{marginInlineStart:0},[`&${n}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[t]:Object.assign(Object.assign({},ya(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${t}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${t}-inner`]:Nu(e)},[`${t}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${dt(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`
        ${n}:not(${n}-disabled),
        ${t}:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{borderColor:e.colorPrimary}},[`${n}:not(${n}-disabled)`]:{[`&:hover ${t}-checked:not(${t}-disabled) ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${t}-checked:not(${t}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${t}-checked`]:{[`${t}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`
        ${n}-checked:not(${n}-disabled),
        ${t}-checked:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[t]:{"&-indeterminate":{"&":{[`${t}-inner`]:{backgroundColor:`${e.colorBgContainer}`,borderColor:`${e.colorBorder}`,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${t}-inner`]:{backgroundColor:`${e.colorBgContainer}`,borderColor:`${e.colorPrimary}`}}}}},{[`${n}-disabled`]:{cursor:"not-allowed"},[`${t}-disabled`]:{[`&, ${t}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${t}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${t}-indeterminate ${t}-inner::after`]:{background:e.colorTextDisabled}}}]};function x8(e,t){const n=xo(t,{checkboxCls:`.${e}`,checkboxSize:t.controlInteractiveSize});return Vue(n)}const b8=za("Checkbox",(e,{prefixCls:t})=>[x8(t,e)]),w8=Wt.createContext(null);var Uue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Hue=(e,t)=>{var n;const{prefixCls:i,className:s,rootClassName:d,children:f,indeterminate:o=!1,style:y,onMouseEnter:b,onMouseLeave:C,skipGroup:P=!1,disabled:A}=e,D=Uue(e,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:k,direction:B,checkbox:N}=I.useContext(ji),j=I.useContext(w8),{isFormItemInput:V}=I.useContext(Xp),K=I.useContext(Fd),Y=(n=(j==null?void 0:j.disabled)||A)!==null&&n!==void 0?n:K,Z=I.useRef(D.value),te=I.useRef(null),ne=ru(t,te);I.useEffect(()=>{j==null||j.registerValue(D.value)},[]),I.useEffect(()=>{if(!P)return D.value!==Z.current&&(j==null||j.cancelValue(Z.current),j==null||j.registerValue(D.value),Z.current=D.value),()=>j==null?void 0:j.cancelValue(D.value)},[D.value]),I.useEffect(()=>{var ze;!((ze=te.current)===null||ze===void 0)&&ze.input&&(te.current.input.indeterminate=o)},[o]);const se=k("checkbox",i),ee=Wu(se),[de,fe,ye]=b8(se,ee),ge=Object.assign({},D);j&&!P&&(ge.onChange=(...ze)=>{D.onChange&&D.onChange.apply(D,ze),j.toggleOption&&j.toggleOption({label:f,value:D.value})},ge.name=j.name,ge.checked=j.value.includes(D.value));const we=St(`${se}-wrapper`,{[`${se}-rtl`]:B==="rtl",[`${se}-wrapper-checked`]:ge.checked,[`${se}-wrapper-disabled`]:Y,[`${se}-wrapper-in-form-item`]:V},N==null?void 0:N.className,s,d,ye,ee,fe),Se=St({[`${se}-indeterminate`]:o},dE,fe),[xe,Te]=a8(ge.onClick);return de(I.createElement(hE,{component:"Checkbox",disabled:Y},I.createElement("label",{className:we,style:Object.assign(Object.assign({},N==null?void 0:N.style),y),onMouseEnter:b,onMouseLeave:C,onClick:xe},I.createElement(o8,Object.assign({},ge,{onClick:Te,prefixCls:se,className:Se,disabled:Y,ref:ne})),f!=null&&I.createElement("span",{className:`${se}-label`},f))))},S8=I.forwardRef(Hue);var Gue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Wue=I.forwardRef((e,t)=>{const{defaultValue:n,children:i,options:s=[],prefixCls:d,className:f,rootClassName:o,style:y,onChange:b}=e,C=Gue(e,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:P,direction:A}=I.useContext(ji),[D,k]=I.useState(C.value||n||[]),[B,N]=I.useState([]);I.useEffect(()=>{"value"in C&&k(C.value||[])},[C.value]);const j=I.useMemo(()=>s.map(Se=>typeof Se=="string"||typeof Se=="number"?{label:Se,value:Se}:Se),[s]),V=Se=>{N(xe=>xe.filter(Te=>Te!==Se))},K=Se=>{N(xe=>[].concat(zn(xe),[Se]))},Y=Se=>{const xe=D.indexOf(Se.value),Te=zn(D);xe===-1?Te.push(Se.value):Te.splice(xe,1),"value"in C||k(Te),b==null||b(Te.filter(ze=>B.includes(ze)).sort((ze,Ue)=>{const We=j.findIndex(Xe=>Xe.value===ze),Be=j.findIndex(Xe=>Xe.value===Ue);return We-Be}))},Z=P("checkbox",d),te=`${Z}-group`,ne=Wu(Z),[se,ee,de]=b8(Z,ne),fe=as(C,["value","disabled"]),ye=s.length?j.map(Se=>I.createElement(S8,{prefixCls:Z,key:Se.value.toString(),disabled:"disabled"in Se?Se.disabled:C.disabled,value:Se.value,checked:D.includes(Se.value),onChange:Se.onChange,className:St(`${te}-item`,Se.className),style:Se.style,title:Se.title,id:Se.id,required:Se.required},Se.label)):i,ge=I.useMemo(()=>({toggleOption:Y,value:D,disabled:C.disabled,name:C.name,registerValue:K,cancelValue:V}),[Y,D,C.disabled,C.name,K,V]),we=St(te,{[`${te}-rtl`]:A==="rtl"},f,o,de,ne,ee);return se(I.createElement("div",Object.assign({className:we,style:y},fe,{ref:t}),I.createElement(w8.Provider,{value:ge},ye)))}),Au=S8;Au.Group=Wue;Au.__ANT_CHECKBOX=!0;const C8=I.createContext({});var que=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function y$(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const Kue=["xs","sm","md","lg","xl","xxl"],x$=I.forwardRef((e,t)=>{const{getPrefixCls:n,direction:i}=I.useContext(ji),{gutter:s,wrap:d}=I.useContext(C8),{prefixCls:f,span:o,order:y,offset:b,push:C,pull:P,className:A,children:D,flex:k,style:B}=e,N=que(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),j=n("col",f),[V,K,Y]=ooe(j),Z={};let te={};Kue.forEach(ee=>{let de={};const fe=e[ee];typeof fe=="number"?de.span=fe:typeof fe=="object"&&(de=fe||{}),delete N[ee],te=Object.assign(Object.assign({},te),{[`${j}-${ee}-${de.span}`]:de.span!==void 0,[`${j}-${ee}-order-${de.order}`]:de.order||de.order===0,[`${j}-${ee}-offset-${de.offset}`]:de.offset||de.offset===0,[`${j}-${ee}-push-${de.push}`]:de.push||de.push===0,[`${j}-${ee}-pull-${de.pull}`]:de.pull||de.pull===0,[`${j}-rtl`]:i==="rtl"}),de.flex&&(te[`${j}-${ee}-flex`]=!0,Z[`--${j}-${ee}-flex`]=y$(de.flex))});const ne=St(j,{[`${j}-${o}`]:o!==void 0,[`${j}-order-${y}`]:y,[`${j}-offset-${b}`]:b,[`${j}-push-${C}`]:C,[`${j}-pull-${P}`]:P},A,te,K,Y),se={};if(s&&s[0]>0){const ee=s[0]/2;se.paddingLeft=ee,se.paddingRight=ee}return k&&(se.flex=y$(k),d===!1&&!se.minWidth&&(se.minWidth=0)),V(I.createElement("div",Object.assign({},N,{style:Object.assign(Object.assign(Object.assign({},se),B),Z),className:ne,ref:t}),D))});function Xue(e,t){const n=[void 0,void 0],i=Array.isArray(e)?e:[e,void 0],s=t||{xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0};return i.forEach((d,f)=>{if(typeof d=="object"&&d!==null)for(let o=0;o<Lx.length;o++){const y=Lx[o];if(s[y]&&d[y]!==void 0){n[f]=d[y];break}}else n[f]=d}),n}var Zue=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function b$(e,t){const[n,i]=I.useState(typeof e=="string"?e:""),s=()=>{if(typeof e=="string"&&i(e),typeof e=="object")for(let d=0;d<Lx.length;d++){const f=Lx[d];if(!t||!t[f])continue;const o=e[f];if(o!==void 0){i(o);return}}};return I.useEffect(()=>{s()},[JSON.stringify(e),t]),n}const Yue=I.forwardRef((e,t)=>{const{prefixCls:n,justify:i,align:s,className:d,style:f,children:o,gutter:y=0,wrap:b}=e,C=Zue(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:P,direction:A}=I.useContext(ji),D=HO(!0,null),k=b$(s,D),B=b$(i,D),N=P("row",n),[j,V,K]=roe(N),Y=Xue(y,D),Z=St(N,{[`${N}-no-wrap`]:b===!1,[`${N}-${B}`]:B,[`${N}-${k}`]:k,[`${N}-rtl`]:A==="rtl"},d,V,K),te={},ne=Y[0]!=null&&Y[0]>0?Y[0]/-2:void 0;ne&&(te.marginLeft=ne,te.marginRight=ne);const[se,ee]=Y;te.rowGap=ee;const de=I.useMemo(()=>({gutter:[se,ee],wrap:b}),[se,ee,b]);return j(I.createElement(C8.Provider,{value:de},I.createElement("div",Object.assign({},C,{className:Z,style:Object.assign(Object.assign({},te),f),ref:t}),o)))});function Jue(e){return!!(e.addonBefore||e.addonAfter)}function Que(e){return!!(e.prefix||e.suffix||e.allowClear)}function w$(e,t,n){var i=t.cloneNode(!0),s=Object.create(e,{target:{value:i},currentTarget:{value:i}});return i.value=n,typeof t.selectionStart=="number"&&typeof t.selectionEnd=="number"&&(i.selectionStart=t.selectionStart,i.selectionEnd=t.selectionEnd),i.setSelectionRange=function(){t.setSelectionRange.apply(t,arguments)},s}function S$(e,t,n,i){if(n){var s=t;if(t.type==="click"){s=w$(t,e,""),n(s);return}if(e.type!=="file"&&i!==void 0){s=w$(t,e,i),n(s);return}n(s)}}function ede(e,t){if(e){e.focus(t);var n=t||{},i=n.cursor;if(i){var s=e.value.length;switch(i){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(s,s);break;default:e.setSelectionRange(0,s)}}}}var tde=Wt.forwardRef(function(e,t){var n,i,s,d=e.inputElement,f=e.children,o=e.prefixCls,y=e.prefix,b=e.suffix,C=e.addonBefore,P=e.addonAfter,A=e.className,D=e.style,k=e.disabled,B=e.readOnly,N=e.focused,j=e.triggerFocus,V=e.allowClear,K=e.value,Y=e.handleReset,Z=e.hidden,te=e.classes,ne=e.classNames,se=e.dataAttrs,ee=e.styles,de=e.components,fe=e.onClear,ye=f??d,ge=(de==null?void 0:de.affixWrapper)||"span",we=(de==null?void 0:de.groupWrapper)||"span",Se=(de==null?void 0:de.wrapper)||"span",xe=(de==null?void 0:de.groupAddon)||"span",Te=I.useRef(null),ze=function(bt){var Ct;(Ct=Te.current)!==null&&Ct!==void 0&&Ct.contains(bt.target)&&(j==null||j())},Ue=Que(e),We=I.cloneElement(ye,{value:K,className:St((n=ye.props)===null||n===void 0?void 0:n.className,!Ue&&(ne==null?void 0:ne.variant))||null}),Be=I.useRef(null);if(Wt.useImperativeHandle(t,function(){return{nativeElement:Be.current||Te.current}}),Ue){var Xe=null;if(V){var qe=!k&&!B&&K,at="".concat(o,"-clear-icon"),Ke=Nr(V)==="object"&&V!==null&&V!==void 0&&V.clearIcon?V.clearIcon:"";Xe=Wt.createElement("button",{type:"button",tabIndex:-1,onClick:function(bt){Y==null||Y(bt),fe==null||fe()},onMouseDown:function(bt){return bt.preventDefault()},className:St(at,ke(ke({},"".concat(at,"-hidden"),!qe),"".concat(at,"-has-suffix"),!!b))},Ke)}var tt="".concat(o,"-affix-wrapper"),vt=St(tt,ke(ke(ke(ke(ke({},"".concat(o,"-disabled"),k),"".concat(tt,"-disabled"),k),"".concat(tt,"-focused"),N),"".concat(tt,"-readonly"),B),"".concat(tt,"-input-with-clear-btn"),b&&V&&K),te==null?void 0:te.affixWrapper,ne==null?void 0:ne.affixWrapper,ne==null?void 0:ne.variant),Pt=(b||V)&&Wt.createElement("span",{className:St("".concat(o,"-suffix"),ne==null?void 0:ne.suffix),style:ee==null?void 0:ee.suffix},Xe,b);We=Wt.createElement(ge,kn({className:vt,style:ee==null?void 0:ee.affixWrapper,onClick:ze},se==null?void 0:se.affixWrapper,{ref:Te}),y&&Wt.createElement("span",{className:St("".concat(o,"-prefix"),ne==null?void 0:ne.prefix),style:ee==null?void 0:ee.prefix},y),We,Pt)}if(Jue(e)){var ft="".concat(o,"-group"),Nt="".concat(ft,"-addon"),Rt="".concat(ft,"-wrapper"),pt=St("".concat(o,"-wrapper"),ft,te==null?void 0:te.wrapper,ne==null?void 0:ne.wrapper),yt=St(Rt,ke({},"".concat(Rt,"-disabled"),k),te==null?void 0:te.group,ne==null?void 0:ne.groupWrapper);We=Wt.createElement(we,{className:yt,ref:Be},Wt.createElement(Se,{className:pt},C&&Wt.createElement(xe,{className:Nt},C),We,P&&Wt.createElement(xe,{className:Nt},P)))}return Wt.cloneElement(We,{className:St((i=We.props)===null||i===void 0?void 0:i.className,A)||null,style:Je(Je({},(s=We.props)===null||s===void 0?void 0:s.style),D),hidden:Z})}),nde=["show"];function rde(e,t){return I.useMemo(function(){var n={};t&&(n.show=Nr(t)==="object"&&t.formatter?t.formatter:!!t),n=Je(Je({},n),e);var i=n,s=i.show,d=ri(i,nde);return Je(Je({},d),{},{show:!!s,showFormatter:typeof s=="function"?s:void 0,strategy:d.strategy||function(f){return f.length}})},[e,t])}var ide=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],ode=I.forwardRef(function(e,t){var n=e.autoComplete,i=e.onChange,s=e.onFocus,d=e.onBlur,f=e.onPressEnter,o=e.onKeyDown,y=e.onKeyUp,b=e.prefixCls,C=b===void 0?"rc-input":b,P=e.disabled,A=e.htmlSize,D=e.className,k=e.maxLength,B=e.suffix,N=e.showCount,j=e.count,V=e.type,K=V===void 0?"text":V,Y=e.classes,Z=e.classNames,te=e.styles,ne=e.onCompositionStart,se=e.onCompositionEnd,ee=ri(e,ide),de=I.useState(!1),fe=It(de,2),ye=fe[0],ge=fe[1],we=I.useRef(!1),Se=I.useRef(!1),xe=I.useRef(null),Te=I.useRef(null),ze=function(Ut){xe.current&&ede(xe.current,Ut)},Ue=is(e.defaultValue,{value:e.value}),We=It(Ue,2),Be=We[0],Xe=We[1],qe=Be==null?"":String(Be),at=I.useState(null),Ke=It(at,2),tt=Ke[0],vt=Ke[1],Pt=rde(j,N),ft=Pt.max||k,Nt=Pt.strategy(qe),Rt=!!ft&&Nt>ft;I.useImperativeHandle(t,function(){var Jt;return{focus:ze,blur:function(){var Tn;(Tn=xe.current)===null||Tn===void 0||Tn.blur()},setSelectionRange:function(Tn,On,Kn){var Un;(Un=xe.current)===null||Un===void 0||Un.setSelectionRange(Tn,On,Kn)},select:function(){var Tn;(Tn=xe.current)===null||Tn===void 0||Tn.select()},input:xe.current,nativeElement:((Jt=Te.current)===null||Jt===void 0?void 0:Jt.nativeElement)||xe.current}}),I.useEffect(function(){Se.current&&(Se.current=!1),ge(function(Jt){return Jt&&P?!1:Jt})},[P]);var pt=function(Ut,Tn,On){var Kn=Tn;if(!we.current&&Pt.exceedFormatter&&Pt.max&&Pt.strategy(Tn)>Pt.max){if(Kn=Pt.exceedFormatter(Tn,{max:Pt.max}),Tn!==Kn){var Un,Pn;vt([((Un=xe.current)===null||Un===void 0?void 0:Un.selectionStart)||0,((Pn=xe.current)===null||Pn===void 0?void 0:Pn.selectionEnd)||0])}}else if(On.source==="compositionEnd")return;Xe(Kn),xe.current&&S$(xe.current,Ut,i,Kn)};I.useEffect(function(){if(tt){var Jt;(Jt=xe.current)===null||Jt===void 0||Jt.setSelectionRange.apply(Jt,zn(tt))}},[tt]);var yt=function(Ut){pt(Ut,Ut.target.value,{source:"change"})},xt=function(Ut){we.current=!1,pt(Ut,Ut.currentTarget.value,{source:"compositionEnd"}),se==null||se(Ut)},bt=function(Ut){f&&Ut.key==="Enter"&&!Se.current&&(Se.current=!0,f(Ut)),o==null||o(Ut)},Ct=function(Ut){Ut.key==="Enter"&&(Se.current=!1),y==null||y(Ut)},tn=function(Ut){ge(!0),s==null||s(Ut)},Zt=function(Ut){Se.current&&(Se.current=!1),ge(!1),d==null||d(Ut)},In=function(Ut){Xe(""),ze(),xe.current&&S$(xe.current,Ut,i)},Cn=Rt&&"".concat(C,"-out-of-range"),Mt=function(){var Ut=as(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return Wt.createElement("input",kn({autoComplete:n},Ut,{onChange:yt,onFocus:tn,onBlur:Zt,onKeyDown:bt,onKeyUp:Ct,className:St(C,ke({},"".concat(C,"-disabled"),P),Z==null?void 0:Z.input),style:te==null?void 0:te.input,ref:xe,size:A,type:K,onCompositionStart:function(On){we.current=!0,ne==null||ne(On)},onCompositionEnd:xt}))},hn=function(){var Ut=Number(ft)>0;if(B||Pt.show){var Tn=Pt.showFormatter?Pt.showFormatter({value:qe,count:Nt,maxLength:ft}):"".concat(Nt).concat(Ut?" / ".concat(ft):"");return Wt.createElement(Wt.Fragment,null,Pt.show&&Wt.createElement("span",{className:St("".concat(C,"-show-count-suffix"),ke({},"".concat(C,"-show-count-has-suffix"),!!B),Z==null?void 0:Z.count),style:Je({},te==null?void 0:te.count)},Tn),B)}return null};return Wt.createElement(tde,kn({},ee,{prefixCls:C,className:St(D,Cn),handleReset:In,value:qe,focused:ye,triggerFocus:ze,suffix:hn(),disabled:P,classes:Y,classNames:Z,styles:te,ref:Te}),Mt())});const ade=e=>{let t;return typeof e=="object"&&(e!=null&&e.clearIcon)?t=e:e&&(t={clearIcon:Wt.createElement(NU,null)}),t};function sde(e,t){const n=I.useRef([]),i=()=>{n.current.push(setTimeout(()=>{var s,d,f,o;!((s=e.current)===null||s===void 0)&&s.input&&((d=e.current)===null||d===void 0?void 0:d.input.getAttribute("type"))==="password"&&(!((f=e.current)===null||f===void 0)&&f.input.hasAttribute("value"))&&((o=e.current)===null||o===void 0||o.input.removeAttribute("value"))}))};return I.useEffect(()=>(i(),()=>n.current.forEach(s=>{s&&clearTimeout(s)})),[]),i}function lde(e){return!!(e.prefix||e.suffix||e.allowClear||e.showCount)}var cde=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const ude=I.forwardRef((e,t)=>{const{prefixCls:n,bordered:i=!0,status:s,size:d,disabled:f,onBlur:o,onFocus:y,suffix:b,allowClear:C,addonAfter:P,addonBefore:A,className:D,style:k,styles:B,rootClassName:N,onChange:j,classNames:V,variant:K}=e,Y=cde(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:Z,direction:te,allowClear:ne,autoComplete:se,className:ee,style:de,classNames:fe,styles:ye}=Gu("input"),ge=Z("input",n),we=I.useRef(null),Se=Wu(ge),[xe,Te,ze]=Ace(ge,N),[Ue]=Oce(ge,Se),{compactSize:We,compactItemClassnames:Be}=pE(ge,te),Xe=Bd(Zt=>{var In;return(In=d??We)!==null&&In!==void 0?In:Zt}),qe=Wt.useContext(Fd),at=f??qe,{status:Ke,hasFeedback:tt,feedbackIcon:vt}=I.useContext(Xp),Pt=bH(Ke,s),ft=lde(e)||!!tt;I.useRef(ft);const Nt=sde(we),Rt=Zt=>{Nt(),o==null||o(Zt)},pt=Zt=>{Nt(),y==null||y(Zt)},yt=Zt=>{Nt(),j==null||j(Zt)},xt=(tt||b)&&Wt.createElement(Wt.Fragment,null,b,tt&&vt),bt=ade(C??ne),[Ct,tn]=UO("input",K,i);return xe(Ue(Wt.createElement(ode,Object.assign({ref:ru(t,we),prefixCls:ge,autoComplete:se},Y,{disabled:at,onBlur:Rt,onFocus:pt,style:Object.assign(Object.assign({},de),k),styles:Object.assign(Object.assign({},ye),B),suffix:xt,allowClear:bt,className:St(D,N,ze,Se,Be,ee),onChange:yt,addonBefore:A&&Wt.createElement(Ox,{form:!0,space:!0},A),addonAfter:P&&Wt.createElement(Ox,{form:!0,space:!0},P),classNames:Object.assign(Object.assign(Object.assign({},V),fe),{input:St({[`${ge}-sm`]:Xe==="small",[`${ge}-lg`]:Xe==="large",[`${ge}-rtl`]:te==="rtl"},V==null?void 0:V.input,fe.input,Te),variant:St({[`${ge}-${Ct}`]:tn},ER(ge,Pt)),affixWrapper:St({[`${ge}-affix-wrapper-sm`]:Xe==="small",[`${ge}-affix-wrapper-lg`]:Xe==="large",[`${ge}-affix-wrapper-rtl`]:te==="rtl"},Te),wrapper:St({[`${ge}-group-rtl`]:te==="rtl"},Te),groupWrapper:St({[`${ge}-group-wrapper-sm`]:Xe==="small",[`${ge}-group-wrapper-lg`]:Xe==="large",[`${ge}-group-wrapper-rtl`]:te==="rtl",[`${ge}-group-wrapper-${Ct}`]:tn},ER(`${ge}-group-wrapper`,Pt,tt),Te)})}))))});function DR(e,t,n){return(e-t)/(n-t)}function sD(e,t,n,i){var s=DR(t,n,i),d={};switch(e){case"rtl":d.right="".concat(s*100,"%"),d.transform="translateX(50%)";break;case"btt":d.bottom="".concat(s*100,"%"),d.transform="translateY(50%)";break;case"ttb":d.top="".concat(s*100,"%"),d.transform="translateY(-50%)";break;default:d.left="".concat(s*100,"%"),d.transform="translateX(-50%)";break}return d}function Rp(e,t){return Array.isArray(e)?e[t]:e}var am=I.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),dde=I.createContext({}),hde=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],C$=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.value,s=e.valueIndex,d=e.onStartMove,f=e.onDelete,o=e.style,y=e.render,b=e.dragging,C=e.draggingDelete,P=e.onOffsetChange,A=e.onChangeComplete,D=e.onFocus,k=e.onMouseEnter,B=ri(e,hde),N=I.useContext(am),j=N.min,V=N.max,K=N.direction,Y=N.disabled,Z=N.keyboard,te=N.range,ne=N.tabIndex,se=N.ariaLabelForHandle,ee=N.ariaLabelledByForHandle,de=N.ariaRequired,fe=N.ariaValueTextFormatterForHandle,ye=N.styles,ge=N.classNames,we="".concat(n,"-handle"),Se=function(Ke){Y||d(Ke,s)},xe=function(Ke){D==null||D(Ke,s)},Te=function(Ke){k(Ke,s)},ze=function(Ke){if(!Y&&Z){var tt=null;switch(Ke.which||Ke.keyCode){case ir.LEFT:tt=K==="ltr"||K==="btt"?-1:1;break;case ir.RIGHT:tt=K==="ltr"||K==="btt"?1:-1;break;case ir.UP:tt=K!=="ttb"?1:-1;break;case ir.DOWN:tt=K!=="ttb"?-1:1;break;case ir.HOME:tt="min";break;case ir.END:tt="max";break;case ir.PAGE_UP:tt=2;break;case ir.PAGE_DOWN:tt=-2;break;case ir.BACKSPACE:case ir.DELETE:f==null||f(s);break}tt!==null&&(Ke.preventDefault(),P(tt,s))}},Ue=function(Ke){switch(Ke.which||Ke.keyCode){case ir.LEFT:case ir.RIGHT:case ir.UP:case ir.DOWN:case ir.HOME:case ir.END:case ir.PAGE_UP:case ir.PAGE_DOWN:A==null||A();break}},We=sD(K,i,j,V),Be={};if(s!==null){var Xe;Be={tabIndex:Y?null:Rp(ne,s),role:"slider","aria-valuemin":j,"aria-valuemax":V,"aria-valuenow":i,"aria-disabled":Y,"aria-label":Rp(se,s),"aria-labelledby":Rp(ee,s),"aria-required":Rp(de,s),"aria-valuetext":(Xe=Rp(fe,s))===null||Xe===void 0?void 0:Xe(i),"aria-orientation":K==="ltr"||K==="rtl"?"horizontal":"vertical",onMouseDown:Se,onTouchStart:Se,onFocus:xe,onMouseEnter:Te,onKeyDown:ze,onKeyUp:Ue}}var qe=I.createElement("div",kn({ref:t,className:St(we,ke(ke(ke({},"".concat(we,"-").concat(s+1),s!==null&&te),"".concat(we,"-dragging"),b),"".concat(we,"-dragging-delete"),C),ge.handle),style:Je(Je(Je({},We),o),ye.handle)},Be,B));return y&&(qe=y(qe,{index:s,prefixCls:n,value:i,dragging:b,draggingDelete:C})),qe}),fde=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],pde=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.style,s=e.onStartMove,d=e.onOffsetChange,f=e.values,o=e.handleRender,y=e.activeHandleRender,b=e.draggingIndex,C=e.draggingDelete,P=e.onFocus,A=ri(e,fde),D=I.useRef({}),k=I.useState(!1),B=It(k,2),N=B[0],j=B[1],V=I.useState(-1),K=It(V,2),Y=K[0],Z=K[1],te=function(fe){Z(fe),j(!0)},ne=function(fe,ye){te(ye),P==null||P(fe)},se=function(fe,ye){te(ye)};I.useImperativeHandle(t,function(){return{focus:function(fe){var ye;(ye=D.current[fe])===null||ye===void 0||ye.focus()},hideHelp:function(){ku.flushSync(function(){j(!1)})}}});var ee=Je({prefixCls:n,onStartMove:s,onOffsetChange:d,render:o,onFocus:ne,onMouseEnter:se},A);return I.createElement(I.Fragment,null,f.map(function(de,fe){var ye=b===fe;return I.createElement(C$,kn({ref:function(we){we?D.current[fe]=we:delete D.current[fe]},dragging:ye,draggingDelete:ye&&C,style:Rp(i,fe),key:fe,value:de,valueIndex:fe},ee))}),y&&N&&I.createElement(C$,kn({key:"a11y"},ee,{value:f[Y],valueIndex:null,dragging:b!==-1,draggingDelete:C,render:y,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),mde=function(t){var n=t.prefixCls,i=t.style,s=t.children,d=t.value,f=t.onClick,o=I.useContext(am),y=o.min,b=o.max,C=o.direction,P=o.includedStart,A=o.includedEnd,D=o.included,k="".concat(n,"-text"),B=sD(C,d,y,b);return I.createElement("span",{className:St(k,ke({},"".concat(k,"-active"),D&&P<=d&&d<=A)),style:Je(Je({},B),i),onMouseDown:function(j){j.stopPropagation()},onClick:function(){f(d)}},s)},gde=function(t){var n=t.prefixCls,i=t.marks,s=t.onClick,d="".concat(n,"-mark");return i.length?I.createElement("div",{className:d},i.map(function(f){var o=f.value,y=f.style,b=f.label;return I.createElement(mde,{key:o,prefixCls:d,style:y,value:o,onClick:s},b)})):null},vde=function(t){var n=t.prefixCls,i=t.value,s=t.style,d=t.activeStyle,f=I.useContext(am),o=f.min,y=f.max,b=f.direction,C=f.included,P=f.includedStart,A=f.includedEnd,D="".concat(n,"-dot"),k=C&&P<=i&&i<=A,B=Je(Je({},sD(b,i,o,y)),typeof s=="function"?s(i):s);return k&&(B=Je(Je({},B),typeof d=="function"?d(i):d)),I.createElement("span",{className:St(D,ke({},"".concat(D,"-active"),k)),style:B})},_de=function(t){var n=t.prefixCls,i=t.marks,s=t.dots,d=t.style,f=t.activeStyle,o=I.useContext(am),y=o.min,b=o.max,C=o.step,P=I.useMemo(function(){var A=new Set;if(i.forEach(function(k){A.add(k.value)}),s&&C!==null)for(var D=y;D<=b;)A.add(D),D+=C;return Array.from(A)},[y,b,C,s,i]);return I.createElement("div",{className:"".concat(n,"-step")},P.map(function(A){return I.createElement(vde,{prefixCls:n,key:A,value:A,style:d,activeStyle:f})}))},E$=function(t){var n=t.prefixCls,i=t.style,s=t.start,d=t.end,f=t.index,o=t.onStartMove,y=t.replaceCls,b=I.useContext(am),C=b.direction,P=b.min,A=b.max,D=b.disabled,k=b.range,B=b.classNames,N="".concat(n,"-track"),j=DR(s,P,A),V=DR(d,P,A),K=function(ne){!D&&o&&o(ne,-1)},Y={};switch(C){case"rtl":Y.right="".concat(j*100,"%"),Y.width="".concat(V*100-j*100,"%");break;case"btt":Y.bottom="".concat(j*100,"%"),Y.height="".concat(V*100-j*100,"%");break;case"ttb":Y.top="".concat(j*100,"%"),Y.height="".concat(V*100-j*100,"%");break;default:Y.left="".concat(j*100,"%"),Y.width="".concat(V*100-j*100,"%")}var Z=y||St(N,ke(ke({},"".concat(N,"-").concat(f+1),f!==null&&k),"".concat(n,"-track-draggable"),o),B.track);return I.createElement("div",{className:Z,style:Je(Je({},Y),i),onMouseDown:K,onTouchStart:K})},yde=function(t){var n=t.prefixCls,i=t.style,s=t.values,d=t.startPoint,f=t.onStartMove,o=I.useContext(am),y=o.included,b=o.range,C=o.min,P=o.styles,A=o.classNames,D=I.useMemo(function(){if(!b){if(s.length===0)return[];var B=d??C,N=s[0];return[{start:Math.min(B,N),end:Math.max(B,N)}]}for(var j=[],V=0;V<s.length-1;V+=1)j.push({start:s[V],end:s[V+1]});return j},[s,b,d,C]);if(!y)return null;var k=D!=null&&D.length&&(A.tracks||P.tracks)?I.createElement(E$,{index:null,prefixCls:n,start:D[0].start,end:D[D.length-1].end,replaceCls:St(A.tracks,"".concat(n,"-tracks")),style:P.tracks}):null;return I.createElement(I.Fragment,null,k,D.map(function(B,N){var j=B.start,V=B.end;return I.createElement(E$,{index:N,prefixCls:n,style:Je(Je({},Rp(i,N)),P.track),start:j,end:V,key:N,onStartMove:f})}))},xde=130;function T$(e){var t="targetTouches"in e?e.targetTouches[0]:e;return{pageX:t.pageX,pageY:t.pageY}}function bde(e,t,n,i,s,d,f,o,y,b,C){var P=I.useState(null),A=It(P,2),D=A[0],k=A[1],B=I.useState(-1),N=It(B,2),j=N[0],V=N[1],K=I.useState(!1),Y=It(K,2),Z=Y[0],te=Y[1],ne=I.useState(n),se=It(ne,2),ee=se[0],de=se[1],fe=I.useState(n),ye=It(fe,2),ge=ye[0],we=ye[1],Se=I.useRef(null),xe=I.useRef(null),Te=I.useRef(null),ze=I.useContext(dde),Ue=ze.onDragStart,We=ze.onDragChange;yo(function(){j===-1&&de(n)},[n,j]),I.useEffect(function(){return function(){document.removeEventListener("mousemove",Se.current),document.removeEventListener("mouseup",xe.current),Te.current&&(Te.current.removeEventListener("touchmove",Se.current),Te.current.removeEventListener("touchend",xe.current))}},[]);var Be=function(tt,vt,Pt){vt!==void 0&&k(vt),de(tt);var ft=tt;Pt&&(ft=tt.filter(function(Nt,Rt){return Rt!==j})),f(ft),We&&We({rawValues:tt,deleteIndex:Pt?j:-1,draggingIndex:j,draggingValue:vt})},Xe=Io(function(Ke,tt,vt){if(Ke===-1){var Pt=ge[0],ft=ge[ge.length-1],Nt=i-Pt,Rt=s-ft,pt=tt*(s-i);pt=Math.max(pt,Nt),pt=Math.min(pt,Rt);var yt=d(Pt+pt);pt=yt-Pt;var xt=ge.map(function(Zt){return Zt+pt});Be(xt)}else{var bt=(s-i)*tt,Ct=zn(ee);Ct[Ke]=ge[Ke];var tn=y(Ct,bt,Ke,"dist");Be(tn.values,tn.value,vt)}}),qe=function(tt,vt,Pt){tt.stopPropagation();var ft=Pt||n,Nt=ft[vt];V(vt),k(Nt),we(ft),de(ft),te(!1);var Rt=T$(tt),pt=Rt.pageX,yt=Rt.pageY,xt=!1;Ue&&Ue({rawValues:ft,draggingIndex:vt,draggingValue:Nt});var bt=function(Zt){Zt.preventDefault();var In=T$(Zt),Cn=In.pageX,Mt=In.pageY,hn=Cn-pt,Jt=Mt-yt,Ut=e.current.getBoundingClientRect(),Tn=Ut.width,On=Ut.height,Kn,Un;switch(t){case"btt":Kn=-Jt/On,Un=hn;break;case"ttb":Kn=Jt/On,Un=hn;break;case"rtl":Kn=-hn/Tn,Un=Jt;break;default:Kn=hn/Tn,Un=Jt}xt=b?Math.abs(Un)>xde&&C<ee.length:!1,te(xt),Xe(vt,Kn,xt)},Ct=function tn(Zt){Zt.preventDefault(),document.removeEventListener("mouseup",tn),document.removeEventListener("mousemove",bt),Te.current&&(Te.current.removeEventListener("touchmove",Se.current),Te.current.removeEventListener("touchend",xe.current)),Se.current=null,xe.current=null,Te.current=null,o(xt),V(-1),te(!1)};document.addEventListener("mouseup",Ct),document.addEventListener("mousemove",bt),tt.currentTarget.addEventListener("touchend",Ct),tt.currentTarget.addEventListener("touchmove",bt),Se.current=bt,xe.current=Ct,Te.current=tt.currentTarget},at=I.useMemo(function(){var Ke=zn(n).sort(function(Nt,Rt){return Nt-Rt}),tt=zn(ee).sort(function(Nt,Rt){return Nt-Rt}),vt={};tt.forEach(function(Nt){vt[Nt]=(vt[Nt]||0)+1}),Ke.forEach(function(Nt){vt[Nt]=(vt[Nt]||0)-1});var Pt=b?1:0,ft=Object.values(vt).reduce(function(Nt,Rt){return Nt+Math.abs(Rt)},0);return ft<=Pt?ee:n},[n,ee,b]);return[j,D,Z,at,qe]}function wde(e,t,n,i,s,d){var f=I.useCallback(function(D){return Math.max(e,Math.min(t,D))},[e,t]),o=I.useCallback(function(D){if(n!==null){var k=e+Math.round((f(D)-e)/n)*n,B=function(K){return(String(K).split(".")[1]||"").length},N=Math.max(B(n),B(t),B(e)),j=Number(k.toFixed(N));return e<=j&&j<=t?j:null}return null},[n,e,t,f]),y=I.useCallback(function(D){var k=f(D),B=i.map(function(V){return V.value});n!==null&&B.push(o(D)),B.push(e,t);var N=B[0],j=t-e;return B.forEach(function(V){var K=Math.abs(k-V);K<=j&&(N=V,j=K)}),N},[e,t,i,n,f,o]),b=function D(k,B,N){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof B=="number"){var V,K=k[N],Y=K+B,Z=[];i.forEach(function(de){Z.push(de.value)}),Z.push(e,t),Z.push(o(K));var te=B>0?1:-1;j==="unit"?Z.push(o(K+te*n)):Z.push(o(Y)),Z=Z.filter(function(de){return de!==null}).filter(function(de){return B<0?de<=K:de>=K}),j==="unit"&&(Z=Z.filter(function(de){return de!==K}));var ne=j==="unit"?K:Y;V=Z[0];var se=Math.abs(V-ne);if(Z.forEach(function(de){var fe=Math.abs(de-ne);fe<se&&(V=de,se=fe)}),V===void 0)return B<0?e:t;if(j==="dist")return V;if(Math.abs(B)>1){var ee=zn(k);return ee[N]=V,D(ee,B-te,N,j)}return V}else{if(B==="min")return e;if(B==="max")return t}},C=function(k,B,N){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",V=k[N],K=b(k,B,N,j);return{value:K,changed:K!==V}},P=function(k){return d===null&&k===0||typeof d=="number"&&k<d},A=function(k,B,N){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",V=k.map(y),K=V[N],Y=b(V,B,N,j);if(V[N]=Y,s===!1){var Z=d||0;N>0&&V[N-1]!==K&&(V[N]=Math.max(V[N],V[N-1]+Z)),N<V.length-1&&V[N+1]!==K&&(V[N]=Math.min(V[N],V[N+1]-Z))}else if(typeof d=="number"||d===null){for(var te=N+1;te<V.length;te+=1)for(var ne=!0;P(V[te]-V[te-1])&&ne;){var se=C(V,1,te);V[te]=se.value,ne=se.changed}for(var ee=N;ee>0;ee-=1)for(var de=!0;P(V[ee]-V[ee-1])&&de;){var fe=C(V,-1,ee-1);V[ee-1]=fe.value,de=fe.changed}for(var ye=V.length-1;ye>0;ye-=1)for(var ge=!0;P(V[ye]-V[ye-1])&&ge;){var we=C(V,-1,ye-1);V[ye-1]=we.value,ge=we.changed}for(var Se=0;Se<V.length-1;Se+=1)for(var xe=!0;P(V[Se+1]-V[Se])&&xe;){var Te=C(V,1,Se+1);V[Se+1]=Te.value,xe=Te.changed}}return{value:V[N],values:V}};return[y,A]}function Sde(e){return I.useMemo(function(){if(e===!0||!e)return[!!e,!1,!1,0];var t=e.editable,n=e.draggableTrack,i=e.minCount,s=e.maxCount;return[!0,t,!t&&n,i||0,s]},[e])}var Cde=I.forwardRef(function(e,t){var n=e.prefixCls,i=n===void 0?"rc-slider":n,s=e.className,d=e.style,f=e.classNames,o=e.styles,y=e.id,b=e.disabled,C=b===void 0?!1:b,P=e.keyboard,A=P===void 0?!0:P,D=e.autoFocus,k=e.onFocus,B=e.onBlur,N=e.min,j=N===void 0?0:N,V=e.max,K=V===void 0?100:V,Y=e.step,Z=Y===void 0?1:Y,te=e.value,ne=e.defaultValue,se=e.range,ee=e.count,de=e.onChange,fe=e.onBeforeChange,ye=e.onAfterChange,ge=e.onChangeComplete,we=e.allowCross,Se=we===void 0?!0:we,xe=e.pushable,Te=xe===void 0?!1:xe,ze=e.reverse,Ue=e.vertical,We=e.included,Be=We===void 0?!0:We,Xe=e.startPoint,qe=e.trackStyle,at=e.handleStyle,Ke=e.railStyle,tt=e.dotStyle,vt=e.activeDotStyle,Pt=e.marks,ft=e.dots,Nt=e.handleRender,Rt=e.activeHandleRender,pt=e.track,yt=e.tabIndex,xt=yt===void 0?0:yt,bt=e.ariaLabelForHandle,Ct=e.ariaLabelledByForHandle,tn=e.ariaRequired,Zt=e.ariaValueTextFormatterForHandle,In=I.useRef(null),Cn=I.useRef(null),Mt=I.useMemo(function(){return Ue?ze?"ttb":"btt":ze?"rtl":"ltr"},[ze,Ue]),hn=Sde(se),Jt=It(hn,5),Ut=Jt[0],Tn=Jt[1],On=Jt[2],Kn=Jt[3],Un=Jt[4],Pn=I.useMemo(function(){return isFinite(j)?j:0},[j]),Qn=I.useMemo(function(){return isFinite(K)?K:100},[K]),un=I.useMemo(function(){return Z!==null&&Z<=0?1:Z},[Z]),nn=I.useMemo(function(){return typeof Te=="boolean"?Te?un:!1:Te>=0?Te:!1},[Te,un]),$n=I.useMemo(function(){return Object.keys(Pt||{}).map(function(Qt){var Ft=Pt[Qt],jt={value:Number(Qt)};return Ft&&Nr(Ft)==="object"&&!I.isValidElement(Ft)&&("label"in Ft||"style"in Ft)?(jt.style=Ft.style,jt.label=Ft.label):jt.label=Ft,jt}).filter(function(Qt){var Ft=Qt.label;return Ft||typeof Ft=="number"}).sort(function(Qt,Ft){return Qt.value-Ft.value})},[Pt]),Ln=wde(Pn,Qn,un,$n,Se,nn),qn=It(Ln,2),er=qn[0],tr=qn[1],Jn=is(ne,{value:te}),Ir=It(Jn,2),_r=Ir[0],$r=Ir[1],mr=I.useMemo(function(){var Qt=_r==null?[]:Array.isArray(_r)?_r:[_r],Ft=It(Qt,1),jt=Ft[0],rn=jt===void 0?Pn:jt,yn=_r===null?[]:[rn];if(Ut){if(yn=zn(Qt),ee||_r===void 0){var rr=ee>=0?ee+1:2;for(yn=yn.slice(0,rr);yn.length<rr;){var En;yn.push((En=yn[yn.length-1])!==null&&En!==void 0?En:Pn)}}yn.sort(function(Zn,ar){return Zn-ar})}return yn.forEach(function(Zn,ar){yn[ar]=er(Zn)}),yn},[_r,Ut,Pn,ee,er]),yi=function(Ft){return Ut?Ft:Ft[0]},Vr=Io(function(Qt){var Ft=zn(Qt).sort(function(jt,rn){return jt-rn});de&&!Yc(Ft,mr,!0)&&de(yi(Ft)),$r(Ft)}),Kr=Io(function(Qt){Qt&&In.current.hideHelp();var Ft=yi(mr);ye==null||ye(Ft),oa(!ye,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),ge==null||ge(Ft)}),Rr=function(Ft){if(!(C||!Tn||mr.length<=Kn)){var jt=zn(mr);jt.splice(Ft,1),fe==null||fe(yi(jt)),Vr(jt);var rn=Math.max(0,Ft-1);In.current.hideHelp(),In.current.focus(rn)}},ii=bde(Cn,Mt,mr,Pn,Qn,er,Vr,Kr,tr,Tn,Kn),Hr=It(ii,5),ut=Hr[0],ur=Hr[1],fr=Hr[2],Fn=Hr[3],Gt=Hr[4],mn=function(Ft,jt){if(!C){var rn=zn(mr),yn=0,rr=0,En=Qn-Pn;mr.forEach(function(yr,Jr){var ni=Math.abs(Ft-yr);ni<=En&&(En=ni,yn=Jr),yr<Ft&&(rr=Jr)});var Zn=yn;Tn&&En!==0&&(!Un||mr.length<Un)?(rn.splice(rr+1,0,Ft),Zn=rr+1):rn[yn]=Ft,Ut&&!mr.length&&ee===void 0&&rn.push(Ft);var ar=yi(rn);if(fe==null||fe(ar),Vr(rn),jt){var qr,Ar;(qr=document.activeElement)===null||qr===void 0||(Ar=qr.blur)===null||Ar===void 0||Ar.call(qr),In.current.focus(Zn),Gt(jt,Zn,rn)}else ye==null||ye(ar),oa(!ye,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),ge==null||ge(ar)}},Xn=function(Ft){Ft.preventDefault();var jt=Cn.current.getBoundingClientRect(),rn=jt.width,yn=jt.height,rr=jt.left,En=jt.top,Zn=jt.bottom,ar=jt.right,qr=Ft.clientX,Ar=Ft.clientY,yr;switch(Mt){case"btt":yr=(Zn-Ar)/yn;break;case"ttb":yr=(Ar-En)/yn;break;case"rtl":yr=(ar-qr)/rn;break;default:yr=(qr-rr)/rn}var Jr=Pn+yr*(Qn-Pn);mn(er(Jr),Ft)},gr=I.useState(null),je=It(gr,2),re=je[0],ie=je[1],_e=function(Ft,jt){if(!C){var rn=tr(mr,Ft,jt);fe==null||fe(yi(mr)),Vr(rn.values),ie(rn.value)}};I.useEffect(function(){if(re!==null){var Qt=mr.indexOf(re);Qt>=0&&In.current.focus(Qt)}ie(null)},[re]);var Re=I.useMemo(function(){return On&&un===null?!1:On},[On,un]),De=Io(function(Qt,Ft){Gt(Qt,Ft),fe==null||fe(yi(mr))}),Ge=ut!==-1;I.useEffect(function(){if(!Ge){var Qt=mr.lastIndexOf(ur);In.current.focus(Qt)}},[Ge]);var ot=I.useMemo(function(){return zn(Fn).sort(function(Qt,Ft){return Qt-Ft})},[Fn]),Ye=I.useMemo(function(){return Ut?[ot[0],ot[ot.length-1]]:[Pn,ot[0]]},[ot,Ut,Pn]),rt=It(Ye,2),zt=rt[0],it=rt[1];I.useImperativeHandle(t,function(){return{focus:function(){In.current.focus(0)},blur:function(){var Ft,jt=document,rn=jt.activeElement;(Ft=Cn.current)!==null&&Ft!==void 0&&Ft.contains(rn)&&(rn==null||rn.blur())}}}),I.useEffect(function(){D&&In.current.focus(0)},[]);var $t=I.useMemo(function(){return{min:Pn,max:Qn,direction:Mt,disabled:C,keyboard:A,step:un,included:Be,includedStart:zt,includedEnd:it,range:Ut,tabIndex:xt,ariaLabelForHandle:bt,ariaLabelledByForHandle:Ct,ariaRequired:tn,ariaValueTextFormatterForHandle:Zt,styles:o||{},classNames:f||{}}},[Pn,Qn,Mt,C,A,un,Be,zt,it,Ut,xt,bt,Ct,tn,Zt,o,f]);return I.createElement(am.Provider,{value:$t},I.createElement("div",{ref:Cn,className:St(i,s,ke(ke(ke(ke({},"".concat(i,"-disabled"),C),"".concat(i,"-vertical"),Ue),"".concat(i,"-horizontal"),!Ue),"".concat(i,"-with-marks"),$n.length)),style:d,onMouseDown:Xn,id:y},I.createElement("div",{className:St("".concat(i,"-rail"),f==null?void 0:f.rail),style:Je(Je({},Ke),o==null?void 0:o.rail)}),pt!==!1&&I.createElement(yde,{prefixCls:i,style:qe,values:mr,startPoint:Xe,onStartMove:Re?De:void 0}),I.createElement(_de,{prefixCls:i,marks:$n,dots:ft,style:tt,activeStyle:vt}),I.createElement(pde,{ref:In,prefixCls:i,style:at,values:Fn,draggingIndex:ut,draggingDelete:fr,onStartMove:De,onOffsetChange:_e,onFocus:k,onBlur:B,handleRender:Nt,activeHandleRender:Rt,onChangeComplete:Kr,onDelete:Tn?Rr:void 0}),I.createElement(gde,{prefixCls:i,marks:$n,onClick:mn})))});const Ede=I.createContext({}),I$=I.forwardRef((e,t)=>{const{open:n,draggingDelete:i,value:s}=e,d=I.useRef(null),f=n&&!i,o=I.useRef(null);function y(){Qi.cancel(o.current),o.current=null}function b(){o.current=Qi(()=>{var C;(C=d.current)===null||C===void 0||C.forceAlign(),o.current=null})}return I.useEffect(()=>(f?b():y(),y),[f,e.title,s]),I.createElement(zx,Object.assign({ref:ru(d,t)},e,{open:f}))}),Tde=e=>{const{componentCls:t,antCls:n,controlSize:i,dotSize:s,marginFull:d,marginPart:f,colorFillContentHover:o,handleColorDisabled:y,calc:b,handleSize:C,handleSizeHover:P,handleActiveColor:A,handleActiveOutlineColor:D,handleLineWidth:k,handleLineWidthHover:B,motionDurationMid:N}=e;return{[t]:Object.assign(Object.assign({},ya(e)),{position:"relative",height:i,margin:`${dt(f)} ${dt(d)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${dt(d)} ${dt(f)}`},[`${t}-rail`]:{position:"absolute",backgroundColor:e.railBg,borderRadius:e.borderRadiusXS,transition:`background-color ${N}`},[`${t}-track,${t}-tracks`]:{position:"absolute",transition:`background-color ${N}`},[`${t}-track`]:{backgroundColor:e.trackBg,borderRadius:e.borderRadiusXS},[`${t}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${t}-rail`]:{backgroundColor:e.railHoverBg},[`${t}-track`]:{backgroundColor:e.trackHoverBg},[`${t}-dot`]:{borderColor:o},[`${t}-handle::after`]:{boxShadow:`0 0 0 ${dt(k)} ${e.colorPrimaryBorderHover}`},[`${t}-dot-active`]:{borderColor:e.dotActiveBorderColor}},[`${t}-handle`]:{position:"absolute",width:C,height:C,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:b(k).mul(-1).equal(),insetBlockStart:b(k).mul(-1).equal(),width:b(C).add(b(k).mul(2)).equal(),height:b(C).add(b(k).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:C,height:C,backgroundColor:e.colorBgElevated,boxShadow:`0 0 0 ${dt(k)} ${e.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${N},
            inset-block-start ${N},
            width ${N},
            height ${N},
            box-shadow ${N},
            outline ${N}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:b(P).sub(C).div(2).add(B).mul(-1).equal(),insetBlockStart:b(P).sub(C).div(2).add(B).mul(-1).equal(),width:b(P).add(b(B).mul(2)).equal(),height:b(P).add(b(B).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${dt(B)} ${A}`,outline:`6px solid ${D}`,width:P,height:P,insetInlineStart:e.calc(C).sub(P).div(2).equal(),insetBlockStart:e.calc(C).sub(P).div(2).equal()}}},[`&-lock ${t}-handle`]:{"&::before, &::after":{transition:"none"}},[`${t}-mark`]:{position:"absolute",fontSize:e.fontSize},[`${t}-mark-text`]:{position:"absolute",display:"inline-block",color:e.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:e.colorText}},[`${t}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${t}-dot`]:{position:"absolute",width:s,height:s,backgroundColor:e.colorBgElevated,border:`${dt(k)} solid ${e.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:e.dotActiveBorderColor}},[`&${t}-disabled`]:{cursor:"not-allowed",[`${t}-rail`]:{backgroundColor:`${e.railBg} !important`},[`${t}-track`]:{backgroundColor:`${e.trackBgDisabled} !important`},[`
          ${t}-dot
        `]:{backgroundColor:e.colorBgElevated,borderColor:e.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${t}-handle::after`]:{backgroundColor:e.colorBgElevated,cursor:"not-allowed",width:C,height:C,boxShadow:`0 0 0 ${dt(k)} ${y}`,insetInlineStart:0,insetBlockStart:0},[`
          ${t}-mark-text,
          ${t}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${n}-tooltip-inner`]:{minWidth:"unset"}})}},E8=(e,t)=>{const{componentCls:n,railSize:i,handleSize:s,dotSize:d,marginFull:f,calc:o}=e,y=t?"paddingBlock":"paddingInline",b=t?"width":"height",C=t?"height":"width",P=t?"insetBlockStart":"insetInlineStart",A=t?"top":"insetInlineStart",D=o(i).mul(3).sub(s).div(2).equal(),k=o(s).sub(i).div(2).equal(),B=t?{borderWidth:`${dt(k)} 0`,transform:`translateY(${dt(o(k).mul(-1).equal())})`}:{borderWidth:`0 ${dt(k)}`,transform:`translateX(${dt(e.calc(k).mul(-1).equal())})`};return{[y]:i,[C]:o(i).mul(3).equal(),[`${n}-rail`]:{[b]:"100%",[C]:i},[`${n}-track,${n}-tracks`]:{[C]:i},[`${n}-track-draggable`]:Object.assign({},B),[`${n}-handle`]:{[P]:D},[`${n}-mark`]:{insetInlineStart:0,top:0,[A]:o(i).mul(3).add(t?0:f).equal(),[b]:"100%"},[`${n}-step`]:{insetInlineStart:0,top:0,[A]:i,[b]:"100%",[C]:i},[`${n}-dot`]:{position:"absolute",[P]:o(i).sub(d).div(2).equal()}}},Ide=e=>{const{componentCls:t,marginPartWithMark:n}=e;return{[`${t}-horizontal`]:Object.assign(Object.assign({},E8(e,!0)),{[`&${t}-with-marks`]:{marginBottom:n}})}},Pde=e=>{const{componentCls:t}=e;return{[`${t}-vertical`]:Object.assign(Object.assign({},E8(e,!1)),{height:"100%"})}},Mde=e=>{const n=e.controlHeightLG/4,i=e.controlHeightSM/2,s=e.lineWidth+1,d=e.lineWidth+1*1.5,f=e.colorPrimary,o=new no(f).setA(.2).toRgbString();return{controlSize:n,railSize:4,handleSize:n,handleSizeHover:i,dotSize:8,handleLineWidth:s,handleLineWidthHover:d,railBg:e.colorFillTertiary,railHoverBg:e.colorFillSecondary,trackBg:e.colorPrimaryBorder,trackHoverBg:e.colorPrimaryBorderHover,handleColor:e.colorPrimaryBorder,handleActiveColor:f,handleActiveOutlineColor:o,handleColorDisabled:new no(e.colorTextDisabled).onBackground(e.colorBgContainer).toHexString(),dotBorderColor:e.colorBorderSecondary,dotActiveBorderColor:e.colorPrimaryBorder,trackBgDisabled:e.colorBgContainerDisabled}},Rde=za("Slider",e=>{const t=xo(e,{marginPart:e.calc(e.controlHeight).sub(e.controlSize).div(2).equal(),marginFull:e.calc(e.controlSize).div(2).equal(),marginPartWithMark:e.calc(e.controlHeightLG).sub(e.controlSize).equal()});return[Tde(t),Ide(t),Pde(t)]},Mde);function oP(){const[e,t]=I.useState(!1),n=I.useRef(null),i=()=>{Qi.cancel(n.current)},s=d=>{i(),d?t(d):n.current=Qi(()=>{t(d)})};return I.useEffect(()=>i,[]),[e,s]}var Ade=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function Ode(e,t){return e||e===null?e:t||t===null?t:n=>typeof n=="number"?n.toString():""}const Dde=Wt.forwardRef((e,t)=>{const{prefixCls:n,range:i,className:s,rootClassName:d,style:f,disabled:o,tooltipPrefixCls:y,tipFormatter:b,tooltipVisible:C,getTooltipPopupContainer:P,tooltipPlacement:A,tooltip:D={},onChangeComplete:k,classNames:B,styles:N}=e,j=Ade(e,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:V}=e,{getPrefixCls:K,direction:Y,className:Z,style:te,classNames:ne,styles:se,getPopupContainer:ee}=Gu("slider"),de=Wt.useContext(Fd),fe=o??de,{handleRender:ye,direction:ge}=Wt.useContext(Ede),Se=(ge||Y)==="rtl",[xe,Te]=oP(),[ze,Ue]=oP(),We=Object.assign({},D),{open:Be,placement:Xe,getPopupContainer:qe,prefixCls:at,formatter:Ke}=We,tt=Be??C,vt=(xe||ze)&&tt!==!1,Pt=Ode(Ke,b),[ft,Nt]=oP(),Rt=Ut=>{k==null||k(Ut),Nt(!1)},pt=(Ut,Tn)=>Ut||(Tn?Se?"left":"right":"top"),yt=K("slider",n),[xt,bt,Ct]=Rde(yt),tn=St(s,Z,ne.root,B==null?void 0:B.root,d,{[`${yt}-rtl`]:Se,[`${yt}-lock`]:ft},bt,Ct);Se&&!j.vertical&&(j.reverse=!j.reverse),Wt.useEffect(()=>{const Ut=()=>{Qi(()=>{Ue(!1)},1)};return document.addEventListener("mouseup",Ut),()=>{document.removeEventListener("mouseup",Ut)}},[]);const Zt=i&&!tt,In=ye||((Ut,Tn)=>{const{index:On}=Tn,Kn=Ut.props;function Un(nn,$n,Ln){var qn,er,tr,Jn;Ln&&((er=(qn=j)[nn])===null||er===void 0||er.call(qn,$n)),(Jn=(tr=Kn)[nn])===null||Jn===void 0||Jn.call(tr,$n)}const Pn=Object.assign(Object.assign({},Kn),{onMouseEnter:nn=>{Te(!0),Un("onMouseEnter",nn)},onMouseLeave:nn=>{Te(!1),Un("onMouseLeave",nn)},onMouseDown:nn=>{Ue(!0),Nt(!0),Un("onMouseDown",nn)},onFocus:nn=>{var $n;Ue(!0),($n=j.onFocus)===null||$n===void 0||$n.call(j,nn),Un("onFocus",nn,!0)},onBlur:nn=>{var $n;Ue(!1),($n=j.onBlur)===null||$n===void 0||$n.call(j,nn),Un("onBlur",nn,!0)}}),Qn=Wt.cloneElement(Ut,Pn),un=(!!tt||vt)&&Pt!==null;return Zt?Qn:Wt.createElement(I$,Object.assign({},We,{prefixCls:K("tooltip",at??y),title:Pt?Pt(Tn.value):"",value:Tn.value,open:un,placement:pt(Xe??A,V),key:On,classNames:{root:`${yt}-tooltip`},getPopupContainer:qe||P||ee}),Qn)}),Cn=Zt?(Ut,Tn)=>{const On=Wt.cloneElement(Ut,{style:Object.assign(Object.assign({},Ut.props.style),{visibility:"hidden"})});return Wt.createElement(I$,Object.assign({},We,{prefixCls:K("tooltip",at??y),title:Pt?Pt(Tn.value):"",open:Pt!==null&&vt,placement:pt(Xe??A,V),key:"tooltip",classNames:{root:`${yt}-tooltip`},getPopupContainer:qe||P||ee,draggingDelete:Tn.draggingDelete}),On)}:void 0,Mt=Object.assign(Object.assign(Object.assign(Object.assign({},se.root),te),N==null?void 0:N.root),f),hn=Object.assign(Object.assign({},se.tracks),N==null?void 0:N.tracks),Jt=St(ne.tracks,B==null?void 0:B.tracks);return xt(Wt.createElement(Cde,Object.assign({},j,{classNames:Object.assign({handle:St(ne.handle,B==null?void 0:B.handle),rail:St(ne.rail,B==null?void 0:B.rail),track:St(ne.track,B==null?void 0:B.track)},Jt?{tracks:Jt}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},se.handle),N==null?void 0:N.handle),rail:Object.assign(Object.assign({},se.rail),N==null?void 0:N.rail),track:Object.assign(Object.assign({},se.track),N==null?void 0:N.track)},Object.keys(hn).length?{tracks:hn}:{}),step:j.step,range:i,className:tn,style:Mt,disabled:fe,ref:t,prefixCls:yt,handleRender:In,activeHandleRender:Cn,onChangeComplete:Rt})))});function P$(e){return["small","middle","large"].includes(e)}function M$(e){return e?typeof e=="number"&&!Number.isNaN(e):!1}const T8=Wt.createContext({latestIndex:0}),Lde=T8.Provider,zde=({className:e,index:t,children:n,split:i,style:s})=>{const{latestIndex:d}=I.useContext(T8);return n==null?null:I.createElement(I.Fragment,null,I.createElement("div",{className:e,style:s},n),t<d&&i&&I.createElement("span",{className:`${e}-split`},i))};var kde=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Fde=I.forwardRef((e,t)=>{var n;const{getPrefixCls:i,direction:s,size:d,className:f,style:o,classNames:y,styles:b}=Gu("space"),{size:C=d??"small",align:P,className:A,rootClassName:D,children:k,direction:B="horizontal",prefixCls:N,split:j,style:V,wrap:K=!1,classNames:Y,styles:Z}=e,te=kde(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[ne,se]=Array.isArray(C)?C:[C,C],ee=P$(se),de=P$(ne),fe=M$(se),ye=M$(ne),ge=vc(k,{keepEmpty:!0}),we=P===void 0&&B==="horizontal"?"center":P,Se=i("space",N),[xe,Te,ze]=GU(Se),Ue=St(Se,f,Te,`${Se}-${B}`,{[`${Se}-rtl`]:s==="rtl",[`${Se}-align-${we}`]:we,[`${Se}-gap-row-${se}`]:ee,[`${Se}-gap-col-${ne}`]:de},A,D,ze),We=St(`${Se}-item`,(n=Y==null?void 0:Y.item)!==null&&n!==void 0?n:y.item);let Be=0;const Xe=ge.map((Ke,tt)=>{var vt;Ke!=null&&(Be=tt);const Pt=(Ke==null?void 0:Ke.key)||`${We}-${tt}`;return I.createElement(zde,{className:We,key:Pt,index:tt,split:j,style:(vt=Z==null?void 0:Z.item)!==null&&vt!==void 0?vt:b.item},Ke)}),qe=I.useMemo(()=>({latestIndex:Be}),[Be]);if(ge.length===0)return null;const at={};return K&&(at.flexWrap="wrap"),!de&&ye&&(at.columnGap=ne),!ee&&fe&&(at.rowGap=se),xe(I.createElement("div",Object.assign({ref:t,className:Ue,style:Object.assign(Object.assign(Object.assign({},at),o),V)},te),I.createElement(Lde,{value:qe},Xe)))}),mC=Fde;mC.Compact=ane;var Nde=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const I8=e=>{const{getPopupContainer:t,getPrefixCls:n,direction:i}=I.useContext(ji),{prefixCls:s,type:d="default",danger:f,disabled:o,loading:y,onClick:b,htmlType:C,children:P,className:A,menu:D,arrow:k,autoFocus:B,overlay:N,trigger:j,align:V,open:K,onOpenChange:Y,placement:Z,getPopupContainer:te,href:ne,icon:se=I.createElement(QO,null),title:ee,buttonsRender:de=Rt=>Rt,mouseEnterDelay:fe,mouseLeaveDelay:ye,overlayClassName:ge,overlayStyle:we,destroyOnHidden:Se,destroyPopupOnHide:xe,dropdownRender:Te,popupRender:ze}=e,Ue=Nde(e,["prefixCls","type","danger","disabled","loading","onClick","htmlType","children","className","menu","arrow","autoFocus","overlay","trigger","align","open","onOpenChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyOnHidden","destroyPopupOnHide","dropdownRender","popupRender"]),We=n("dropdown",s),Be=`${We}-button`,qe={menu:D,arrow:k,autoFocus:B,align:V,disabled:o,trigger:o?[]:j,onOpenChange:Y,getPopupContainer:te||t,mouseEnterDelay:fe,mouseLeaveDelay:ye,overlayClassName:ge,overlayStyle:we,destroyOnHidden:Se,popupRender:ze||Te},{compactSize:at,compactItemClassnames:Ke}=pE(We,i),tt=St(Be,Ke,A);"destroyPopupOnHide"in e&&(qe.destroyPopupOnHide=xe),"overlay"in e&&(qe.overlay=N),"open"in e&&(qe.open=K),"placement"in e?qe.placement=Z:qe.placement=i==="rtl"?"bottomLeft":"bottomRight";const vt=I.createElement(Uc,{type:d,danger:f,disabled:o,loading:y,onClick:b,htmlType:C,href:ne,title:ee},P),Pt=I.createElement(Uc,{type:d,danger:f,icon:se}),[ft,Nt]=de([vt,Pt]);return I.createElement(mC.Compact,Object.assign({className:tt,size:at,block:!0},Ue),ft,I.createElement(PE,Object.assign({},qe),Nt))};I8.__ANT_BUTTON=!0;const AE=PE;AE.Button=I8;function R$(e,t,n,i){var s=vx.unstable_batchedUpdates?function(f){vx.unstable_batchedUpdates(n,f)}:n;return e!=null&&e.addEventListener&&e.addEventListener(t,s,i),{remove:function(){e!=null&&e.removeEventListener&&e.removeEventListener(t,s,i)}}}var Bde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"}}]},name:"double-left",theme:"outlined"},$de=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Bde}))},A$=I.forwardRef($de),jde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}}]},name:"double-right",theme:"outlined"},Vde=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:jde}))},O$=I.forwardRef(Vde),Ude={items_per_page:"/",jump_to:"",jump_to_confirm:"",page:"",prev_page:"",next_page:"",prev_5:" 5 ",next_5:" 5 ",prev_3:" 3 ",next_3:" 3 ",page_size:""},Hde=[10,20,50,100],Gde=function(t){var n=t.pageSizeOptions,i=n===void 0?Hde:n,s=t.locale,d=t.changeSize,f=t.pageSize,o=t.goButton,y=t.quickGo,b=t.rootPrefixCls,C=t.disabled,P=t.buildOptionText,A=t.showSizeChanger,D=t.sizeChangerRender,k=Wt.useState(""),B=It(k,2),N=B[0],j=B[1],V=function(){return!N||Number.isNaN(N)?void 0:Number(N)},K=typeof P=="function"?P:function(ye){return"".concat(ye," ").concat(s.items_per_page)},Y=function(ge){j(ge.target.value)},Z=function(ge){o||N===""||(j(""),!(ge.relatedTarget&&(ge.relatedTarget.className.indexOf("".concat(b,"-item-link"))>=0||ge.relatedTarget.className.indexOf("".concat(b,"-item"))>=0))&&(y==null||y(V())))},te=function(ge){N!==""&&(ge.keyCode===ir.ENTER||ge.type==="click")&&(j(""),y==null||y(V()))},ne=function(){return i.some(function(ge){return ge.toString()===f.toString()})?i:i.concat([f]).sort(function(ge,we){var Se=Number.isNaN(Number(ge))?0:Number(ge),xe=Number.isNaN(Number(we))?0:Number(we);return Se-xe})},se="".concat(b,"-options");if(!A&&!y)return null;var ee=null,de=null,fe=null;return A&&D&&(ee=D({disabled:C,size:f,onSizeChange:function(ge){d==null||d(Number(ge))},"aria-label":s.page_size,className:"".concat(se,"-size-changer"),options:ne().map(function(ye){return{label:K(ye),value:ye}})})),y&&(o&&(fe=typeof o=="boolean"?Wt.createElement("button",{type:"button",onClick:te,onKeyUp:te,disabled:C,className:"".concat(se,"-quick-jumper-button")},s.jump_to_confirm):Wt.createElement("span",{onClick:te,onKeyUp:te},o)),de=Wt.createElement("div",{className:"".concat(se,"-quick-jumper")},s.jump_to,Wt.createElement("input",{disabled:C,type:"text",value:N,onChange:Y,onKeyUp:te,onBlur:Z,"aria-label":s.page}),s.page,fe)),Wt.createElement("li",{className:se},ee,de)},m0=function(t){var n=t.rootPrefixCls,i=t.page,s=t.active,d=t.className,f=t.showTitle,o=t.onClick,y=t.onKeyPress,b=t.itemRender,C="".concat(n,"-item"),P=St(C,"".concat(C,"-").concat(i),ke(ke({},"".concat(C,"-active"),s),"".concat(C,"-disabled"),!i),d),A=function(){o(i)},D=function(N){y(N,o,i)},k=b(i,"page",Wt.createElement("a",{rel:"nofollow"},i));return k?Wt.createElement("li",{title:f?String(i):null,className:P,onClick:A,onKeyDown:D,tabIndex:0},k):null},Wde=function(t,n,i){return i};function D$(){}function L$(e){var t=Number(e);return typeof t=="number"&&!Number.isNaN(t)&&isFinite(t)&&Math.floor(t)===t}function yp(e,t,n){var i=typeof e>"u"?t:e;return Math.floor((n-1)/i)+1}var qde=function(t){var n=t.prefixCls,i=n===void 0?"rc-pagination":n,s=t.selectPrefixCls,d=s===void 0?"rc-select":s,f=t.className,o=t.current,y=t.defaultCurrent,b=y===void 0?1:y,C=t.total,P=C===void 0?0:C,A=t.pageSize,D=t.defaultPageSize,k=D===void 0?10:D,B=t.onChange,N=B===void 0?D$:B,j=t.hideOnSinglePage,V=t.align,K=t.showPrevNextJumpers,Y=K===void 0?!0:K,Z=t.showQuickJumper,te=t.showLessItems,ne=t.showTitle,se=ne===void 0?!0:ne,ee=t.onShowSizeChange,de=ee===void 0?D$:ee,fe=t.locale,ye=fe===void 0?Ude:fe,ge=t.style,we=t.totalBoundaryShowSizeChanger,Se=we===void 0?50:we,xe=t.disabled,Te=t.simple,ze=t.showTotal,Ue=t.showSizeChanger,We=Ue===void 0?P>Se:Ue,Be=t.sizeChangerRender,Xe=t.pageSizeOptions,qe=t.itemRender,at=qe===void 0?Wde:qe,Ke=t.jumpPrevIcon,tt=t.jumpNextIcon,vt=t.prevIcon,Pt=t.nextIcon,ft=Wt.useRef(null),Nt=is(10,{value:A,defaultValue:k}),Rt=It(Nt,2),pt=Rt[0],yt=Rt[1],xt=is(1,{value:o,defaultValue:b,postState:function(Zn){return Math.max(1,Math.min(Zn,yp(void 0,pt,P)))}}),bt=It(xt,2),Ct=bt[0],tn=bt[1],Zt=Wt.useState(Ct),In=It(Zt,2),Cn=In[0],Mt=In[1];I.useEffect(function(){Mt(Ct)},[Ct]);var hn=Math.max(1,Ct-(te?3:5)),Jt=Math.min(yp(void 0,pt,P),Ct+(te?3:5));function Ut(En,Zn){var ar=En||Wt.createElement("button",{type:"button","aria-label":Zn,className:"".concat(i,"-item-link")});return typeof En=="function"&&(ar=Wt.createElement(En,Je({},t))),ar}function Tn(En){var Zn=En.target.value,ar=yp(void 0,pt,P),qr;return Zn===""?qr=Zn:Number.isNaN(Number(Zn))?qr=Cn:Zn>=ar?qr=ar:qr=Number(Zn),qr}function On(En){return L$(En)&&En!==Ct&&L$(P)&&P>0}var Kn=P>pt?Z:!1;function Un(En){(En.keyCode===ir.UP||En.keyCode===ir.DOWN)&&En.preventDefault()}function Pn(En){var Zn=Tn(En);switch(Zn!==Cn&&Mt(Zn),En.keyCode){case ir.ENTER:nn(Zn);break;case ir.UP:nn(Zn-1);break;case ir.DOWN:nn(Zn+1);break}}function Qn(En){nn(Tn(En))}function un(En){var Zn=yp(En,pt,P),ar=Ct>Zn&&Zn!==0?Zn:Ct;yt(En),Mt(ar),de==null||de(Ct,En),tn(ar),N==null||N(ar,En)}function nn(En){if(On(En)&&!xe){var Zn=yp(void 0,pt,P),ar=En;return En>Zn?ar=Zn:En<1&&(ar=1),ar!==Cn&&Mt(ar),tn(ar),N==null||N(ar,pt),ar}return Ct}var $n=Ct>1,Ln=Ct<yp(void 0,pt,P);function qn(){$n&&nn(Ct-1)}function er(){Ln&&nn(Ct+1)}function tr(){nn(hn)}function Jn(){nn(Jt)}function Ir(En,Zn){if(En.key==="Enter"||En.charCode===ir.ENTER||En.keyCode===ir.ENTER){for(var ar=arguments.length,qr=new Array(ar>2?ar-2:0),Ar=2;Ar<ar;Ar++)qr[Ar-2]=arguments[Ar];Zn.apply(void 0,qr)}}function _r(En){Ir(En,qn)}function $r(En){Ir(En,er)}function mr(En){Ir(En,tr)}function yi(En){Ir(En,Jn)}function Vr(En){var Zn=at(En,"prev",Ut(vt,"prev page"));return Wt.isValidElement(Zn)?Wt.cloneElement(Zn,{disabled:!$n}):Zn}function Kr(En){var Zn=at(En,"next",Ut(Pt,"next page"));return Wt.isValidElement(Zn)?Wt.cloneElement(Zn,{disabled:!Ln}):Zn}function Rr(En){(En.type==="click"||En.keyCode===ir.ENTER)&&nn(Cn)}var ii=null,Hr=Jc(t,{aria:!0,data:!0}),ut=ze&&Wt.createElement("li",{className:"".concat(i,"-total-text")},ze(P,[P===0?0:(Ct-1)*pt+1,Ct*pt>P?P:Ct*pt])),ur=null,fr=yp(void 0,pt,P);if(j&&P<=pt)return null;var Fn=[],Gt={rootPrefixCls:i,onClick:nn,onKeyPress:Ir,showTitle:se,itemRender:at,page:-1},mn=Ct-1>0?Ct-1:0,Xn=Ct+1<fr?Ct+1:fr,gr=Z&&Z.goButton,je=Nr(Te)==="object"?Te.readOnly:!Te,re=gr,ie=null;Te&&(gr&&(typeof gr=="boolean"?re=Wt.createElement("button",{type:"button",onClick:Rr,onKeyUp:Rr},ye.jump_to_confirm):re=Wt.createElement("span",{onClick:Rr,onKeyUp:Rr},gr),re=Wt.createElement("li",{title:se?"".concat(ye.jump_to).concat(Ct,"/").concat(fr):null,className:"".concat(i,"-simple-pager")},re)),ie=Wt.createElement("li",{title:se?"".concat(Ct,"/").concat(fr):null,className:"".concat(i,"-simple-pager")},je?Cn:Wt.createElement("input",{type:"text","aria-label":ye.jump_to,value:Cn,disabled:xe,onKeyDown:Un,onKeyUp:Pn,onChange:Pn,onBlur:Qn,size:3}),Wt.createElement("span",{className:"".concat(i,"-slash")},"/"),fr));var _e=te?1:2;if(fr<=3+_e*2){fr||Fn.push(Wt.createElement(m0,kn({},Gt,{key:"noPager",page:1,className:"".concat(i,"-item-disabled")})));for(var Re=1;Re<=fr;Re+=1)Fn.push(Wt.createElement(m0,kn({},Gt,{key:Re,page:Re,active:Ct===Re})))}else{var De=te?ye.prev_3:ye.prev_5,Ge=te?ye.next_3:ye.next_5,ot=at(hn,"jump-prev",Ut(Ke,"prev page")),Ye=at(Jt,"jump-next",Ut(tt,"next page"));Y&&(ii=ot?Wt.createElement("li",{title:se?De:null,key:"prev",onClick:tr,tabIndex:0,onKeyDown:mr,className:St("".concat(i,"-jump-prev"),ke({},"".concat(i,"-jump-prev-custom-icon"),!!Ke))},ot):null,ur=Ye?Wt.createElement("li",{title:se?Ge:null,key:"next",onClick:Jn,tabIndex:0,onKeyDown:yi,className:St("".concat(i,"-jump-next"),ke({},"".concat(i,"-jump-next-custom-icon"),!!tt))},Ye):null);var rt=Math.max(1,Ct-_e),zt=Math.min(Ct+_e,fr);Ct-1<=_e&&(zt=1+_e*2),fr-Ct<=_e&&(rt=fr-_e*2);for(var it=rt;it<=zt;it+=1)Fn.push(Wt.createElement(m0,kn({},Gt,{key:it,page:it,active:Ct===it})));if(Ct-1>=_e*2&&Ct!==3&&(Fn[0]=Wt.cloneElement(Fn[0],{className:St("".concat(i,"-item-after-jump-prev"),Fn[0].props.className)}),Fn.unshift(ii)),fr-Ct>=_e*2&&Ct!==fr-2){var $t=Fn[Fn.length-1];Fn[Fn.length-1]=Wt.cloneElement($t,{className:St("".concat(i,"-item-before-jump-next"),$t.props.className)}),Fn.push(ur)}rt!==1&&Fn.unshift(Wt.createElement(m0,kn({},Gt,{key:1,page:1}))),zt!==fr&&Fn.push(Wt.createElement(m0,kn({},Gt,{key:fr,page:fr})))}var Qt=Vr(mn);if(Qt){var Ft=!$n||!fr;Qt=Wt.createElement("li",{title:se?ye.prev_page:null,onClick:qn,tabIndex:Ft?null:0,onKeyDown:_r,className:St("".concat(i,"-prev"),ke({},"".concat(i,"-disabled"),Ft)),"aria-disabled":Ft},Qt)}var jt=Kr(Xn);if(jt){var rn,yn;Te?(rn=!Ln,yn=$n?0:null):(rn=!Ln||!fr,yn=rn?null:0),jt=Wt.createElement("li",{title:se?ye.next_page:null,onClick:er,tabIndex:yn,onKeyDown:$r,className:St("".concat(i,"-next"),ke({},"".concat(i,"-disabled"),rn)),"aria-disabled":rn},jt)}var rr=St(i,f,ke(ke(ke(ke(ke({},"".concat(i,"-start"),V==="start"),"".concat(i,"-center"),V==="center"),"".concat(i,"-end"),V==="end"),"".concat(i,"-simple"),Te),"".concat(i,"-disabled"),xe));return Wt.createElement("ul",kn({className:rr,style:ge,ref:ft},Hr),ut,Qt,Te?ie:Fn,jt,Wt.createElement(Gde,{locale:ye,rootPrefixCls:i,disabled:xe,selectPrefixCls:d,changeSize:un,pageSize:pt,pageSizeOptions:Xe,quickGo:Kn?nn:null,goButton:re,showSizeChanger:We,sizeChangerRender:Be}))};const Kde=e=>{const{componentCls:t}=e;return{[`${t}-disabled`]:{"&, &:hover":{cursor:"not-allowed",[`${t}-item-link`]:{color:e.colorTextDisabled,cursor:"not-allowed"}},"&:focus-visible":{cursor:"not-allowed",[`${t}-item-link`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}},[`&${t}-disabled`]:{cursor:"not-allowed",[`${t}-item`]:{cursor:"not-allowed",backgroundColor:"transparent","&:hover, &:active":{backgroundColor:"transparent"},a:{color:e.colorTextDisabled,backgroundColor:"transparent",border:"none",cursor:"not-allowed"},"&-active":{borderColor:e.colorBorder,backgroundColor:e.itemActiveBgDisabled,"&:hover, &:active":{backgroundColor:e.itemActiveBgDisabled},a:{color:e.itemActiveColorDisabled}}},[`${t}-item-link`]:{color:e.colorTextDisabled,cursor:"not-allowed","&:hover, &:active":{backgroundColor:"transparent"},[`${t}-simple&`]:{backgroundColor:"transparent","&:hover, &:active":{backgroundColor:"transparent"}}},[`${t}-simple-pager`]:{color:e.colorTextDisabled},[`${t}-jump-prev, ${t}-jump-next`]:{[`${t}-item-link-icon`]:{opacity:0},[`${t}-item-ellipsis`]:{opacity:1}}}}},Xde=e=>{const{componentCls:t}=e;return{[`&${t}-mini ${t}-total-text, &${t}-mini ${t}-simple-pager`]:{height:e.itemSizeSM,lineHeight:dt(e.itemSizeSM)},[`&${t}-mini ${t}-item`]:{minWidth:e.itemSizeSM,height:e.itemSizeSM,margin:0,lineHeight:dt(e.calc(e.itemSizeSM).sub(2).equal())},[`&${t}-mini ${t}-prev, &${t}-mini ${t}-next`]:{minWidth:e.itemSizeSM,height:e.itemSizeSM,margin:0,lineHeight:dt(e.itemSizeSM)},[`&${t}-mini:not(${t}-disabled)`]:{[`${t}-prev, ${t}-next`]:{[`&:hover ${t}-item-link`]:{backgroundColor:e.colorBgTextHover},[`&:active ${t}-item-link`]:{backgroundColor:e.colorBgTextActive},[`&${t}-disabled:hover ${t}-item-link`]:{backgroundColor:"transparent"}}},[`
    &${t}-mini ${t}-prev ${t}-item-link,
    &${t}-mini ${t}-next ${t}-item-link
    `]:{backgroundColor:"transparent",borderColor:"transparent","&::after":{height:e.itemSizeSM,lineHeight:dt(e.itemSizeSM)}},[`&${t}-mini ${t}-jump-prev, &${t}-mini ${t}-jump-next`]:{height:e.itemSizeSM,marginInlineEnd:0,lineHeight:dt(e.itemSizeSM)},[`&${t}-mini ${t}-options`]:{marginInlineStart:e.paginationMiniOptionsMarginInlineStart,"&-size-changer":{top:e.miniOptionsSizeChangerTop},"&-quick-jumper":{height:e.itemSizeSM,lineHeight:dt(e.itemSizeSM),input:Object.assign(Object.assign({},rD(e)),{width:e.paginationMiniQuickJumperInputWidth,height:e.controlHeightSM})}}}},Zde=e=>{const{componentCls:t}=e;return{[`&${t}-simple`]:{[`${t}-prev, ${t}-next`]:{height:e.itemSize,lineHeight:dt(e.itemSize),verticalAlign:"top",[`${t}-item-link`]:{height:e.itemSize,backgroundColor:"transparent",border:0,"&:hover":{backgroundColor:e.colorBgTextHover},"&:active":{backgroundColor:e.colorBgTextActive},"&::after":{height:e.itemSize,lineHeight:dt(e.itemSize)}}},[`${t}-simple-pager`]:{display:"inline-flex",alignItems:"center",height:e.itemSize,marginInlineEnd:e.marginXS,input:{boxSizing:"border-box",height:"100%",width:e.quickJumperInputWidth,padding:`0 ${dt(e.paginationItemPaddingInline)}`,textAlign:"center",backgroundColor:e.itemInputBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadius,outline:"none",transition:`border-color ${e.motionDurationMid}`,color:"inherit","&:hover":{borderColor:e.colorPrimary},"&:focus":{borderColor:e.colorPrimaryHover,boxShadow:`${dt(e.inputOutlineOffset)} 0 ${dt(e.controlOutlineWidth)} ${e.controlOutline}`},"&[disabled]":{color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,cursor:"not-allowed"}}},[`&${t}-disabled`]:{[`${t}-prev, ${t}-next`]:{[`${t}-item-link`]:{"&:hover, &:active":{backgroundColor:"transparent"}}}},[`&${t}-mini`]:{[`${t}-prev, ${t}-next`]:{height:e.itemSizeSM,lineHeight:dt(e.itemSizeSM),[`${t}-item-link`]:{height:e.itemSizeSM,"&::after":{height:e.itemSizeSM,lineHeight:dt(e.itemSizeSM)}}},[`${t}-simple-pager`]:{height:e.itemSizeSM,input:{width:e.paginationMiniQuickJumperInputWidth}}}}}},Yde=e=>{const{componentCls:t}=e;return{[`${t}-jump-prev, ${t}-jump-next`]:{outline:0,[`${t}-item-container`]:{position:"relative",[`${t}-item-link-icon`]:{color:e.colorPrimary,fontSize:e.fontSizeSM,opacity:0,transition:`all ${e.motionDurationMid}`,"&-svg":{top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,margin:"auto"}},[`${t}-item-ellipsis`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,display:"block",margin:"auto",color:e.colorTextDisabled,letterSpacing:e.paginationEllipsisLetterSpacing,textAlign:"center",textIndent:e.paginationEllipsisTextIndent,opacity:1,transition:`all ${e.motionDurationMid}`}},"&:hover":{[`${t}-item-link-icon`]:{opacity:1},[`${t}-item-ellipsis`]:{opacity:0}}},[`
    ${t}-prev,
    ${t}-jump-prev,
    ${t}-jump-next
    `]:{marginInlineEnd:e.marginXS},[`
    ${t}-prev,
    ${t}-next,
    ${t}-jump-prev,
    ${t}-jump-next
    `]:{display:"inline-block",minWidth:e.itemSize,height:e.itemSize,color:e.colorText,fontFamily:e.fontFamily,lineHeight:dt(e.itemSize),textAlign:"center",verticalAlign:"middle",listStyle:"none",borderRadius:e.borderRadius,cursor:"pointer",transition:`all ${e.motionDurationMid}`},[`${t}-prev, ${t}-next`]:{outline:0,button:{color:e.colorText,cursor:"pointer",userSelect:"none"},[`${t}-item-link`]:{display:"block",width:"100%",height:"100%",padding:0,fontSize:e.fontSizeSM,textAlign:"center",backgroundColor:"transparent",border:`${dt(e.lineWidth)} ${e.lineType} transparent`,borderRadius:e.borderRadius,outline:"none",transition:`all ${e.motionDurationMid}`},[`&:hover ${t}-item-link`]:{backgroundColor:e.colorBgTextHover},[`&:active ${t}-item-link`]:{backgroundColor:e.colorBgTextActive},[`&${t}-disabled:hover`]:{[`${t}-item-link`]:{backgroundColor:"transparent"}}},[`${t}-slash`]:{marginInlineEnd:e.paginationSlashMarginInlineEnd,marginInlineStart:e.paginationSlashMarginInlineStart},[`${t}-options`]:{display:"inline-block",marginInlineStart:e.margin,verticalAlign:"middle","&-size-changer":{display:"inline-block",width:"auto"},"&-quick-jumper":{display:"inline-block",height:e.controlHeight,marginInlineStart:e.marginXS,lineHeight:dt(e.controlHeight),verticalAlign:"top",input:Object.assign(Object.assign(Object.assign({},iD(e)),nD(e,{borderColor:e.colorBorder,hoverBorderColor:e.colorPrimaryHover,activeBorderColor:e.colorPrimary,activeShadow:e.activeShadow})),{"&[disabled]":Object.assign({},ME(e)),width:e.quickJumperInputWidth,height:e.controlHeight,boxSizing:"border-box",margin:0,marginInlineStart:e.marginXS,marginInlineEnd:e.marginXS})}}}},Jde=e=>{const{componentCls:t}=e;return{[`${t}-item`]:{display:"inline-block",minWidth:e.itemSize,height:e.itemSize,marginInlineEnd:e.marginXS,fontFamily:e.fontFamily,lineHeight:dt(e.calc(e.itemSize).sub(2).equal()),textAlign:"center",verticalAlign:"middle",listStyle:"none",backgroundColor:e.itemBg,border:`${dt(e.lineWidth)} ${e.lineType} transparent`,borderRadius:e.borderRadius,outline:0,cursor:"pointer",userSelect:"none",a:{display:"block",padding:`0 ${dt(e.paginationItemPaddingInline)}`,color:e.colorText,"&:hover":{textDecoration:"none"}},[`&:not(${t}-item-active)`]:{"&:hover":{transition:`all ${e.motionDurationMid}`,backgroundColor:e.colorBgTextHover},"&:active":{backgroundColor:e.colorBgTextActive}},"&-active":{fontWeight:e.fontWeightStrong,backgroundColor:e.itemActiveBg,borderColor:e.colorPrimary,a:{color:e.colorPrimary},"&:hover":{borderColor:e.colorPrimaryHover},"&:hover a":{color:e.colorPrimaryHover}}}}},Qde=e=>{const{componentCls:t}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ya(e)),{display:"flex",flexWrap:"wrap",rowGap:e.paddingXS,"&-start":{justifyContent:"start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"end"},"ul, ol":{margin:0,padding:0,listStyle:"none"},"&::after":{display:"block",clear:"both",height:0,overflow:"hidden",visibility:"hidden",content:'""'},[`${t}-total-text`]:{display:"inline-block",height:e.itemSize,marginInlineEnd:e.marginXS,lineHeight:dt(e.calc(e.itemSize).sub(2).equal()),verticalAlign:"middle"}}),Jde(e)),Yde(e)),Zde(e)),Xde(e)),Kde(e)),{[`@media only screen and (max-width: ${e.screenLG}px)`]:{[`${t}-item`]:{"&-after-jump-prev, &-before-jump-next":{display:"none"}}},[`@media only screen and (max-width: ${e.screenSM}px)`]:{[`${t}-options`]:{display:"none"}}}),[`&${e.componentCls}-rtl`]:{direction:"rtl"}}},ehe=e=>{const{componentCls:t}=e;return{[`${t}:not(${t}-disabled)`]:{[`${t}-item`]:Object.assign({},hf(e)),[`${t}-jump-prev, ${t}-jump-next`]:{"&:focus-visible":Object.assign({[`${t}-item-link-icon`]:{opacity:1},[`${t}-item-ellipsis`]:{opacity:0}},Nu(e))},[`${t}-prev, ${t}-next`]:{[`&:focus-visible ${t}-item-link`]:Nu(e)}}}},P8=e=>Object.assign({itemBg:e.colorBgContainer,itemSize:e.controlHeight,itemSizeSM:e.controlHeightSM,itemActiveBg:e.colorBgContainer,itemLinkBg:e.colorBgContainer,itemActiveColorDisabled:e.colorTextDisabled,itemActiveBgDisabled:e.controlItemBgActiveDisabled,itemInputBg:e.colorBgContainer,miniOptionsSizeChangerTop:0},tD(e)),M8=e=>xo(e,{inputOutlineOffset:0,quickJumperInputWidth:e.calc(e.controlHeightLG).mul(1.25).equal(),paginationMiniOptionsMarginInlineStart:e.calc(e.marginXXS).div(2).equal(),paginationMiniQuickJumperInputWidth:e.calc(e.controlHeightLG).mul(1.1).equal(),paginationItemPaddingInline:e.calc(e.marginXXS).mul(1.5).equal(),paginationEllipsisLetterSpacing:e.calc(e.marginXXS).div(2).equal(),paginationSlashMarginInlineStart:e.marginSM,paginationSlashMarginInlineEnd:e.marginSM,paginationEllipsisTextIndent:"0.13em"},eD(e)),the=za("Pagination",e=>{const t=M8(e);return[Qde(t),ehe(t)]},P8),nhe=e=>{const{componentCls:t}=e;return{[`${t}${t}-bordered${t}-disabled:not(${t}-mini)`]:{"&, &:hover":{[`${t}-item-link`]:{borderColor:e.colorBorder}},"&:focus-visible":{[`${t}-item-link`]:{borderColor:e.colorBorder}},[`${t}-item, ${t}-item-link`]:{backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,[`&:hover:not(${t}-item-active)`]:{backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,a:{color:e.colorTextDisabled}},[`&${t}-item-active`]:{backgroundColor:e.itemActiveBgDisabled}},[`${t}-prev, ${t}-next`]:{"&:hover button":{backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,color:e.colorTextDisabled},[`${t}-item-link`]:{backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder}}},[`${t}${t}-bordered:not(${t}-mini)`]:{[`${t}-prev, ${t}-next`]:{"&:hover button":{borderColor:e.colorPrimaryHover,backgroundColor:e.itemBg},[`${t}-item-link`]:{backgroundColor:e.itemLinkBg,borderColor:e.colorBorder},[`&:hover ${t}-item-link`]:{borderColor:e.colorPrimary,backgroundColor:e.itemBg,color:e.colorPrimary},[`&${t}-disabled`]:{[`${t}-item-link`]:{borderColor:e.colorBorder,color:e.colorTextDisabled}}},[`${t}-item`]:{backgroundColor:e.itemBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,[`&:hover:not(${t}-item-active)`]:{borderColor:e.colorPrimary,backgroundColor:e.itemBg,a:{color:e.colorPrimary}},"&-active":{borderColor:e.colorPrimary}}}}},rhe=sE(["Pagination","bordered"],e=>{const t=M8(e);return nhe(t)},P8);function z$(e){return I.useMemo(()=>typeof e=="boolean"?[e,{}]:e&&typeof e=="object"?[!0,e]:[void 0,void 0],[e])}var ihe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const ohe=e=>{const{align:t,prefixCls:n,selectPrefixCls:i,className:s,rootClassName:d,style:f,size:o,locale:y,responsive:b,showSizeChanger:C,selectComponentClass:P,pageSizeOptions:A}=e,D=ihe(e,["align","prefixCls","selectPrefixCls","className","rootClassName","style","size","locale","responsive","showSizeChanger","selectComponentClass","pageSizeOptions"]),{xs:k}=HO(b),[,B]=Vs(),{getPrefixCls:N,direction:j,showSizeChanger:V,className:K,style:Y}=Gu("pagination"),Z=N("pagination",n),[te,ne,se]=the(Z),ee=Bd(o),de=ee==="small"||!!(k&&!ee&&b),[fe]=tb("Pagination",lU),ye=Object.assign(Object.assign({},fe),y),[ge,we]=z$(C),[Se,xe]=z$(V),Te=ge??Se,ze=we??xe,Ue=P||Yv,We=I.useMemo(()=>A?A.map(tt=>Number(tt)):void 0,[A]),Be=tt=>{var vt;const{disabled:Pt,size:ft,onSizeChange:Nt,"aria-label":Rt,className:pt,options:yt}=tt,{className:xt,onChange:bt}=ze||{},Ct=(vt=yt.find(tn=>String(tn.value)===String(ft)))===null||vt===void 0?void 0:vt.value;return I.createElement(Ue,Object.assign({disabled:Pt,showSearch:!0,popupMatchSelectWidth:!1,getPopupContainer:tn=>tn.parentNode,"aria-label":Rt,options:yt},ze,{value:Ct,onChange:(tn,Zt)=>{Nt==null||Nt(tn),bt==null||bt(tn,Zt)},size:de?"small":"middle",className:St(pt,xt)}))},Xe=I.useMemo(()=>{const tt=I.createElement("span",{className:`${Z}-item-ellipsis`},""),vt=I.createElement("button",{className:`${Z}-item-link`,type:"button",tabIndex:-1},j==="rtl"?I.createElement(sR,null):I.createElement(TR,null)),Pt=I.createElement("button",{className:`${Z}-item-link`,type:"button",tabIndex:-1},j==="rtl"?I.createElement(TR,null):I.createElement(sR,null)),ft=I.createElement("a",{className:`${Z}-item-link`},I.createElement("div",{className:`${Z}-item-container`},j==="rtl"?I.createElement(O$,{className:`${Z}-item-link-icon`}):I.createElement(A$,{className:`${Z}-item-link-icon`}),tt)),Nt=I.createElement("a",{className:`${Z}-item-link`},I.createElement("div",{className:`${Z}-item-container`},j==="rtl"?I.createElement(A$,{className:`${Z}-item-link-icon`}):I.createElement(O$,{className:`${Z}-item-link-icon`}),tt));return{prevIcon:vt,nextIcon:Pt,jumpPrevIcon:ft,jumpNextIcon:Nt}},[j,Z]),qe=N("select",i),at=St({[`${Z}-${t}`]:!!t,[`${Z}-mini`]:de,[`${Z}-rtl`]:j==="rtl",[`${Z}-bordered`]:B.wireframe},K,s,d,ne,se),Ke=Object.assign(Object.assign({},Y),f);return te(I.createElement(I.Fragment,null,B.wireframe&&I.createElement(rhe,{prefixCls:Z}),I.createElement(qde,Object.assign({},Xe,D,{style:Ke,prefixCls:Z,selectPrefixCls:qe,className:at,locale:ye,pageSizeOptions:We,showSizeChanger:Te,sizeChangerRender:Be}))))},gC=100,R8=gC/5,A8=gC/2-R8/2,aP=A8*2*Math.PI,k$=50,F$=e=>{const{dotClassName:t,style:n,hasCircleCls:i}=e;return I.createElement("circle",{className:St(`${t}-circle`,{[`${t}-circle-bg`]:i}),r:A8,cx:k$,cy:k$,strokeWidth:R8,style:n})},ahe=({percent:e,prefixCls:t})=>{const n=`${t}-dot`,i=`${n}-holder`,s=`${i}-hidden`,[d,f]=I.useState(!1);yo(()=>{e!==0&&f(!0)},[e!==0]);const o=Math.max(Math.min(e,100),0);if(!d)return null;const y={strokeDashoffset:`${aP/4}`,strokeDasharray:`${aP*o/100} ${aP*(100-o)/100}`};return I.createElement("span",{className:St(i,`${n}-progress`,o<=0&&s)},I.createElement("svg",{viewBox:`0 0 ${gC} ${gC}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o},I.createElement(F$,{dotClassName:n,hasCircleCls:!0}),I.createElement(F$,{dotClassName:n,style:y})))};function she(e){const{prefixCls:t,percent:n=0}=e,i=`${t}-dot`,s=`${i}-holder`,d=`${s}-hidden`;return I.createElement(I.Fragment,null,I.createElement("span",{className:St(s,n>0&&d)},I.createElement("span",{className:St(i,`${t}-dot-spin`)},[1,2,3,4].map(f=>I.createElement("i",{className:`${t}-dot-item`,key:f})))),I.createElement(ahe,{prefixCls:t,percent:n}))}function lhe(e){var t;const{prefixCls:n,indicator:i,percent:s}=e,d=`${n}-dot`;return i&&I.isValidElement(i)?Bu(i,{className:St((t=i.props)===null||t===void 0?void 0:t.className,d),percent:s}):I.createElement(she,{prefixCls:n,percent:s})}const che=new Mo("antSpinMove",{to:{opacity:1}}),uhe=new Mo("antRotate",{to:{transform:"rotate(405deg)"}}),dhe=e=>{const{componentCls:t,calc:n}=e;return{[t]:Object.assign(Object.assign({},ya(e)),{position:"absolute",display:"none",color:e.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${t}-text`]:{fontSize:e.fontSize,paddingTop:n(n(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[t]:{[`${t}-dot-holder`]:{color:e.colorWhite},[`${t}-text`]:{color:e.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${t}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:e.contentHeight,[`${t}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:n(e.dotSize).mul(-1).div(2).equal()},[`${t}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${t}-dot`]:{margin:n(e.dotSizeSM).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${t}-dot`]:{margin:n(e.dotSizeLG).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${t}-container`]:{position:"relative",transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${t}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:e.spinDotDefault},[`${t}-dot-holder`]:{width:"1em",height:"1em",fontSize:e.dotSize,display:"inline-block",transition:`transform ${e.motionDurationSlow} ease, opacity ${e.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:e.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${t}-dot-progress`]:{position:"absolute",inset:0},[`${t}-dot`]:{position:"relative",display:"inline-block",fontSize:e.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),height:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:che,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:uhe,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(i=>`${i} ${e.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:e.colorFillSecondary}},[`&-sm ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeSM}},[`&-sm ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal(),height:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeLG}},[`&-lg ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${t}-show-text ${t}-text`]:{display:"block"}})}},hhe=e=>{const{controlHeightLG:t,controlHeight:n}=e;return{contentHeight:400,dotSize:t/2,dotSizeSM:t*.35,dotSizeLG:n}},fhe=za("Spin",e=>{const t=xo(e,{spinDotDefault:e.colorTextDescription});return dhe(t)},hhe),phe=200,N$=[[30,.05],[70,.03],[96,.01]];function mhe(e,t){const[n,i]=I.useState(0),s=I.useRef(null),d=t==="auto";return I.useEffect(()=>(d&&e&&(i(0),s.current=setInterval(()=>{i(f=>{const o=100-f;for(let y=0;y<N$.length;y+=1){const[b,C]=N$[y];if(f<=b)return f+o*C}return f})},phe)),()=>{s.current&&(clearInterval(s.current),s.current=null)}),[d,e]),d?n:t}var ghe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};let O8;function vhe(e,t){return!!e&&!!t&&!Number.isNaN(Number(t))}const D8=e=>{var t;const{prefixCls:n,spinning:i=!0,delay:s=0,className:d,rootClassName:f,size:o="default",tip:y,wrapperClassName:b,style:C,children:P,fullscreen:A=!1,indicator:D,percent:k}=e,B=ghe(e,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:N,direction:j,className:V,style:K,indicator:Y}=Gu("spin"),Z=N("spin",n),[te,ne,se]=fhe(Z),[ee,de]=I.useState(()=>i&&!vhe(i,s)),fe=mhe(ee,k);I.useEffect(()=>{if(i){const ze=zue(s,()=>{de(!0)});return ze(),()=>{var Ue;(Ue=ze==null?void 0:ze.cancel)===null||Ue===void 0||Ue.call(ze)}}de(!1)},[s,i]);const ye=I.useMemo(()=>typeof P<"u"&&!A,[P,A]),ge=St(Z,V,{[`${Z}-sm`]:o==="small",[`${Z}-lg`]:o==="large",[`${Z}-spinning`]:ee,[`${Z}-show-text`]:!!y,[`${Z}-rtl`]:j==="rtl"},d,!A&&f,ne,se),we=St(`${Z}-container`,{[`${Z}-blur`]:ee}),Se=(t=D??Y)!==null&&t!==void 0?t:O8,xe=Object.assign(Object.assign({},K),C),Te=I.createElement("div",Object.assign({},B,{style:xe,className:ge,"aria-live":"polite","aria-busy":ee}),I.createElement(lhe,{prefixCls:Z,indicator:Se,percent:fe}),y&&(ye||A)?I.createElement("div",{className:`${Z}-text`},y):null);return te(ye?I.createElement("div",Object.assign({},B,{className:St(`${Z}-nested-loading`,b,ne,se)}),ee&&I.createElement("div",{key:"loading"},Te),I.createElement("div",{className:we,key:"container"},P)):A?I.createElement("div",{className:St(`${Z}-fullscreen`,{[`${Z}-fullscreen-show`]:ee},f,ne,se)},Te):Te)};D8.setDefaultIndicator=e=>{O8=e};var Fh={},ub="rc-table-internal-hook";function lD(e){var t=I.createContext(void 0),n=function(s){var d=s.value,f=s.children,o=I.useRef(d);o.current=d;var y=I.useState(function(){return{getValue:function(){return o.current},listeners:new Set}}),b=It(y,1),C=b[0];return yo(function(){ku.unstable_batchedUpdates(function(){C.listeners.forEach(function(P){P(d)})})},[d]),I.createElement(t.Provider,{value:C},f)};return{Context:t,Provider:n,defaultValue:e}}function ms(e,t){var n=Io(typeof t=="function"?t:function(P){if(t===void 0)return P;if(!Array.isArray(t))return P[t];var A={};return t.forEach(function(D){A[D]=P[D]}),A}),i=I.useContext(e==null?void 0:e.Context),s=i||{},d=s.listeners,f=s.getValue,o=I.useRef();o.current=n(i?f():e==null?void 0:e.defaultValue);var y=I.useState({}),b=It(y,2),C=b[1];return yo(function(){if(!i)return;function P(A){var D=n(A);Yc(o.current,D,!0)||C({})}return d.add(P),function(){d.delete(P)}},[i]),o.current}function _he(){var e=I.createContext(null);function t(){return I.useContext(e)}function n(s,d){var f=Fu(s),o=function(b,C){var P=f?{ref:C}:{},A=I.useRef(0),D=I.useRef(b),k=t();return k!==null?I.createElement(s,kn({},b,P)):((!d||d(D.current,b))&&(A.current+=1),D.current=b,I.createElement(e.Provider,{value:A.current},I.createElement(s,kn({},b,P))))};return f?I.forwardRef(o):o}function i(s,d){var f=Fu(s),o=function(b,C){var P=f?{ref:C}:{};return t(),I.createElement(s,kn({},b,P))};return f?I.memo(I.forwardRef(o),d):I.memo(o,d)}return{makeImmutable:n,responseImmutable:i,useImmutableMark:t}}var cD=_he(),L8=cD.makeImmutable,e_=cD.responseImmutable,yhe=cD.useImmutableMark,Us=lD(),z8=I.createContext({renderWithProps:!1}),xhe="RC_TABLE_KEY";function bhe(e){return e==null?[]:Array.isArray(e)?e:[e]}function OE(e){var t=[],n={};return e.forEach(function(i){for(var s=i||{},d=s.key,f=s.dataIndex,o=d||bhe(f).join("-")||xhe;n[o];)o="".concat(o,"_next");n[o]=!0,t.push(o)}),t}function LR(e){return e!=null}function whe(e){return typeof e=="number"&&!Number.isNaN(e)}function She(e){return e&&Nr(e)==="object"&&!Array.isArray(e)&&!I.isValidElement(e)}function Che(e,t,n,i,s,d){var f=I.useContext(z8),o=yhe(),y=nm(function(){if(LR(i))return[i];var b=t==null||t===""?[]:Array.isArray(t)?t:[t],C=Ul(e,b),P=C,A=void 0;if(s){var D=s(C,e,n);She(D)?(P=D.children,A=D.props,f.renderWithProps=!0):P=D}return[P,A]},[o,e,i,t,s,n],function(b,C){if(d){var P=It(b,2),A=P[1],D=It(C,2),k=D[1];return d(k,A)}return f.renderWithProps?!0:!Yc(b,C,!0)});return y}function Ehe(e,t,n,i){var s=e+t-1;return e<=i&&s>=n}function The(e,t){return ms(Us,function(n){var i=Ehe(e,t||1,n.hoverStartRow,n.hoverEndRow);return[i,n.onHover]})}var Ihe=function(t){var n=t.ellipsis,i=t.rowType,s=t.children,d,f=n===!0?{showTitle:!0}:n;return f&&(f.showTitle||i==="header")&&(typeof s=="string"||typeof s=="number"?d=s.toString():I.isValidElement(s)&&typeof s.props.children=="string"&&(d=s.props.children)),d};function Phe(e){var t,n,i,s,d,f,o,y,b=e.component,C=e.children,P=e.ellipsis,A=e.scope,D=e.prefixCls,k=e.className,B=e.align,N=e.record,j=e.render,V=e.dataIndex,K=e.renderIndex,Y=e.shouldCellUpdate,Z=e.index,te=e.rowType,ne=e.colSpan,se=e.rowSpan,ee=e.fixLeft,de=e.fixRight,fe=e.firstFixLeft,ye=e.lastFixLeft,ge=e.firstFixRight,we=e.lastFixRight,Se=e.appendNode,xe=e.additionalProps,Te=xe===void 0?{}:xe,ze=e.isSticky,Ue="".concat(D,"-cell"),We=ms(Us,["supportSticky","allColumnsFixedLeft","rowHoverable"]),Be=We.supportSticky,Xe=We.allColumnsFixedLeft,qe=We.rowHoverable,at=Che(N,V,K,C,j,Y),Ke=It(at,2),tt=Ke[0],vt=Ke[1],Pt={},ft=typeof ee=="number"&&Be,Nt=typeof de=="number"&&Be;ft&&(Pt.position="sticky",Pt.left=ee),Nt&&(Pt.position="sticky",Pt.right=de);var Rt=(t=(n=(i=vt==null?void 0:vt.colSpan)!==null&&i!==void 0?i:Te.colSpan)!==null&&n!==void 0?n:ne)!==null&&t!==void 0?t:1,pt=(s=(d=(f=vt==null?void 0:vt.rowSpan)!==null&&f!==void 0?f:Te.rowSpan)!==null&&d!==void 0?d:se)!==null&&s!==void 0?s:1,yt=The(Z,pt),xt=It(yt,2),bt=xt[0],Ct=xt[1],tn=Io(function(Ut){var Tn;N&&Ct(Z,Z+pt-1),Te==null||(Tn=Te.onMouseEnter)===null||Tn===void 0||Tn.call(Te,Ut)}),Zt=Io(function(Ut){var Tn;N&&Ct(-1,-1),Te==null||(Tn=Te.onMouseLeave)===null||Tn===void 0||Tn.call(Te,Ut)});if(Rt===0||pt===0)return null;var In=(o=Te.title)!==null&&o!==void 0?o:Ihe({rowType:te,ellipsis:P,children:tt}),Cn=St(Ue,k,(y={},ke(ke(ke(ke(ke(ke(ke(ke(ke(ke(y,"".concat(Ue,"-fix-left"),ft&&Be),"".concat(Ue,"-fix-left-first"),fe&&Be),"".concat(Ue,"-fix-left-last"),ye&&Be),"".concat(Ue,"-fix-left-all"),ye&&Xe&&Be),"".concat(Ue,"-fix-right"),Nt&&Be),"".concat(Ue,"-fix-right-first"),ge&&Be),"".concat(Ue,"-fix-right-last"),we&&Be),"".concat(Ue,"-ellipsis"),P),"".concat(Ue,"-with-append"),Se),"".concat(Ue,"-fix-sticky"),(ft||Nt)&&ze&&Be),ke(y,"".concat(Ue,"-row-hover"),!vt&&bt)),Te.className,vt==null?void 0:vt.className),Mt={};B&&(Mt.textAlign=B);var hn=Je(Je(Je(Je({},vt==null?void 0:vt.style),Pt),Mt),Te.style),Jt=tt;return Nr(Jt)==="object"&&!Array.isArray(Jt)&&!I.isValidElement(Jt)&&(Jt=null),P&&(ye||ge)&&(Jt=I.createElement("span",{className:"".concat(Ue,"-content")},Jt)),I.createElement(b,kn({},vt,Te,{className:Cn,style:hn,title:In,scope:A,onMouseEnter:qe?tn:void 0,onMouseLeave:qe?Zt:void 0,colSpan:Rt!==1?Rt:null,rowSpan:pt!==1?pt:null}),Se,Jt)}const t_=I.memo(Phe);function uD(e,t,n,i,s){var d=n[e]||{},f=n[t]||{},o,y;d.fixed==="left"?o=i.left[s==="rtl"?t:e]:f.fixed==="right"&&(y=i.right[s==="rtl"?e:t]);var b=!1,C=!1,P=!1,A=!1,D=n[t+1],k=n[e-1],B=D&&!D.fixed||k&&!k.fixed||n.every(function(Y){return Y.fixed==="left"});if(s==="rtl"){if(o!==void 0){var N=k&&k.fixed==="left";A=!N&&B}else if(y!==void 0){var j=D&&D.fixed==="right";P=!j&&B}}else if(o!==void 0){var V=D&&D.fixed==="left";b=!V&&B}else if(y!==void 0){var K=k&&k.fixed==="right";C=!K&&B}return{fixLeft:o,fixRight:y,lastFixLeft:b,firstFixRight:C,lastFixRight:P,firstFixLeft:A,isSticky:i.isSticky}}var k8=I.createContext({});function Mhe(e){var t=e.className,n=e.index,i=e.children,s=e.colSpan,d=s===void 0?1:s,f=e.rowSpan,o=e.align,y=ms(Us,["prefixCls","direction"]),b=y.prefixCls,C=y.direction,P=I.useContext(k8),A=P.scrollColumnIndex,D=P.stickyOffsets,k=P.flattenColumns,B=n+d-1,N=B+1===A?d+1:d,j=uD(n,n+N-1,k,D,C);return I.createElement(t_,kn({className:t,index:n,component:"td",prefixCls:b,record:null,dataIndex:null,align:o,colSpan:N,rowSpan:f,render:function(){return i}},j))}var Rhe=["children"];function Ahe(e){var t=e.children,n=ri(e,Rhe);return I.createElement("tr",n,t)}function DE(e){var t=e.children;return t}DE.Row=Ahe;DE.Cell=Mhe;function Ohe(e){var t=e.children,n=e.stickyOffsets,i=e.flattenColumns,s=ms(Us,"prefixCls"),d=i.length-1,f=i[d],o=I.useMemo(function(){return{stickyOffsets:n,flattenColumns:i,scrollColumnIndex:f!=null&&f.scrollbar?d:null}},[f,i,d,n]);return I.createElement(k8.Provider,{value:o},I.createElement("tfoot",{className:"".concat(s,"-summary")},t))}const Ow=e_(Ohe);var F8=DE;function Dhe(e){return null}function Lhe(e){return null}function N8(e,t,n,i,s,d,f){var o=d(t,f);e.push({record:t,indent:n,index:f,rowKey:o});var y=s==null?void 0:s.has(o);if(t&&Array.isArray(t[i])&&y)for(var b=0;b<t[i].length;b+=1)N8(e,t[i][b],n+1,i,s,d,b)}function B8(e,t,n,i){var s=I.useMemo(function(){if(n!=null&&n.size){for(var d=[],f=0;f<(e==null?void 0:e.length);f+=1){var o=e[f];N8(d,o,0,t,n,i,f)}return d}return e==null?void 0:e.map(function(y,b){return{record:y,indent:0,index:b,rowKey:i(y,b)}})},[e,t,n,i]);return s}function $8(e,t,n,i){var s=ms(Us,["prefixCls","fixedInfoList","flattenColumns","expandableType","expandRowByClick","onTriggerExpand","rowClassName","expandedRowClassName","indentSize","expandIcon","expandedRowRender","expandIconColumnIndex","expandedKeys","childrenColumnName","rowExpandable","onRow"]),d=s.flattenColumns,f=s.expandableType,o=s.expandedKeys,y=s.childrenColumnName,b=s.onTriggerExpand,C=s.rowExpandable,P=s.onRow,A=s.expandRowByClick,D=s.rowClassName,k=f==="nest",B=f==="row"&&(!C||C(e)),N=B||k,j=o&&o.has(t),V=y&&e&&e[y],K=Io(b),Y=P==null?void 0:P(e,n),Z=Y==null?void 0:Y.onClick,te=function(de){A&&N&&b(e,de);for(var fe=arguments.length,ye=new Array(fe>1?fe-1:0),ge=1;ge<fe;ge++)ye[ge-1]=arguments[ge];Z==null||Z.apply(void 0,[de].concat(ye))},ne;typeof D=="string"?ne=D:typeof D=="function"&&(ne=D(e,n,i));var se=OE(d);return Je(Je({},s),{},{columnsKey:se,nestExpandable:k,expanded:j,hasNestChildren:V,record:e,onTriggerExpand:K,rowSupportExpand:B,expandable:N,rowProps:Je(Je({},Y),{},{className:St(ne,Y==null?void 0:Y.className),onClick:te})})}function j8(e){var t=e.prefixCls,n=e.children,i=e.component,s=e.cellComponent,d=e.className,f=e.expanded,o=e.colSpan,y=e.isEmpty,b=e.stickyOffset,C=b===void 0?0:b,P=ms(Us,["scrollbarSize","fixHeader","fixColumn","componentWidth","horizonScroll"]),A=P.scrollbarSize,D=P.fixHeader,k=P.fixColumn,B=P.componentWidth,N=P.horizonScroll,j=n;return(y?N&&B:k)&&(j=I.createElement("div",{style:{width:B-C-(D&&!y?A:0),position:"sticky",left:C,overflow:"hidden"},className:"".concat(t,"-expanded-row-fixed")},j)),I.createElement(i,{className:d,style:{display:f?null:"none"}},I.createElement(t_,{component:s,prefixCls:t,colSpan:o},j))}function zhe(e){var t=e.prefixCls,n=e.record,i=e.onExpand,s=e.expanded,d=e.expandable,f="".concat(t,"-row-expand-icon");if(!d)return I.createElement("span",{className:St(f,"".concat(t,"-row-spaced"))});var o=function(b){i(n,b),b.stopPropagation()};return I.createElement("span",{className:St(f,ke(ke({},"".concat(t,"-row-expanded"),s),"".concat(t,"-row-collapsed"),!s)),onClick:o})}function khe(e,t,n){var i=[];function s(d){(d||[]).forEach(function(f,o){i.push(t(f,o)),s(f[n])})}return s(e),i}function V8(e,t,n,i){return typeof e=="string"?e:typeof e=="function"?e(t,n,i):""}function U8(e,t,n,i,s){var d,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,y=e.record,b=e.prefixCls,C=e.columnsKey,P=e.fixedInfoList,A=e.expandIconColumnIndex,D=e.nestExpandable,k=e.indentSize,B=e.expandIcon,N=e.expanded,j=e.hasNestChildren,V=e.onTriggerExpand,K=e.expandable,Y=e.expandedKeys,Z=C[n],te=P[n],ne;n===(A||0)&&D&&(ne=I.createElement(I.Fragment,null,I.createElement("span",{style:{paddingLeft:"".concat(k*i,"px")},className:"".concat(b,"-row-indent indent-level-").concat(i)}),B({prefixCls:b,expanded:N,expandable:j,record:y,onExpand:V})));var se=((d=t.onCell)===null||d===void 0?void 0:d.call(t,y,s))||{};if(o){var ee=se.rowSpan,de=ee===void 0?1:ee;if(K&&de&&n<o){for(var fe=de,ye=s;ye<s+de;ye+=1){var ge=f[ye];Y.has(ge)&&(fe+=1)}se.rowSpan=fe}}return{key:Z,fixedInfo:te,appendCellNode:ne,additionalCellProps:se}}function Fhe(e){var t=e.className,n=e.style,i=e.record,s=e.index,d=e.renderIndex,f=e.rowKey,o=e.rowKeys,y=e.indent,b=y===void 0?0:y,C=e.rowComponent,P=e.cellComponent,A=e.scopeCellComponent,D=e.expandedRowInfo,k=$8(i,f,s,b),B=k.prefixCls,N=k.flattenColumns,j=k.expandedRowClassName,V=k.expandedRowRender,K=k.rowProps,Y=k.expanded,Z=k.rowSupportExpand,te=I.useRef(!1);te.current||(te.current=Y);var ne=V8(j,i,s,b),se=I.createElement(C,kn({},K,{"data-row-key":f,className:St(t,"".concat(B,"-row"),"".concat(B,"-row-level-").concat(b),K==null?void 0:K.className,ke({},ne,b>=1)),style:Je(Je({},n),K==null?void 0:K.style)}),N.map(function(fe,ye){var ge=fe.render,we=fe.dataIndex,Se=fe.className,xe=U8(k,fe,ye,b,s,o,D==null?void 0:D.offset),Te=xe.key,ze=xe.fixedInfo,Ue=xe.appendCellNode,We=xe.additionalCellProps;return I.createElement(t_,kn({className:Se,ellipsis:fe.ellipsis,align:fe.align,scope:fe.rowScope,component:fe.rowScope?A:P,prefixCls:B,key:Te,record:i,index:s,renderIndex:d,dataIndex:we,render:ge,shouldCellUpdate:fe.shouldCellUpdate},ze,{appendNode:Ue,additionalProps:We}))})),ee;if(Z&&(te.current||Y)){var de=V(i,s,b+1,Y);ee=I.createElement(j8,{expanded:Y,className:St("".concat(B,"-expanded-row"),"".concat(B,"-expanded-row-level-").concat(b+1),ne),prefixCls:B,component:C,cellComponent:P,colSpan:D?D.colSpan:N.length,stickyOffset:D==null?void 0:D.sticky,isEmpty:!1},de)}return I.createElement(I.Fragment,null,se,ee)}const Nhe=e_(Fhe);function Bhe(e){var t=e.columnKey,n=e.onColumnResize,i=e.prefixCls,s=e.title,d=I.useRef();return yo(function(){d.current&&n(t,d.current.offsetWidth)},[]),I.createElement(Wl,{data:t},I.createElement("th",{ref:d,className:"".concat(i,"-measure-cell")},I.createElement("div",{className:"".concat(i,"-measure-cell-content")},s||"")))}function $he(e){var t=e.prefixCls,n=e.columnsKey,i=e.onColumnResize,s=e.columns,d=I.useRef(null),f=ms(Us,["measureRowRender"]),o=f.measureRowRender,y=I.createElement("tr",{"aria-hidden":"true",className:"".concat(t,"-measure-row"),ref:d,tabIndex:-1},I.createElement(Wl.Collection,{onBatchResize:function(C){uE(d.current)&&C.forEach(function(P){var A=P.data,D=P.size;i(A,D.offsetWidth)})}},n.map(function(b){var C=s.find(function(D){return D.key===b}),P=C==null?void 0:C.title,A=I.isValidElement(P)?I.cloneElement(P,{ref:null}):P;return I.createElement(Bhe,{prefixCls:t,key:b,columnKey:b,onColumnResize:i,title:A})})));return o?o(y):y}function jhe(e){var t=e.data,n=e.measureColumnWidth,i=ms(Us,["prefixCls","getComponent","onColumnResize","flattenColumns","getRowKey","expandedKeys","childrenColumnName","emptyNode","expandedRowOffset","fixedInfoList","colWidths"]),s=i.prefixCls,d=i.getComponent,f=i.onColumnResize,o=i.flattenColumns,y=i.getRowKey,b=i.expandedKeys,C=i.childrenColumnName,P=i.emptyNode,A=i.expandedRowOffset,D=A===void 0?0:A,k=i.colWidths,B=B8(t,C,b,y),N=I.useMemo(function(){return B.map(function(ee){return ee.rowKey})},[B]),j=I.useRef({renderWithProps:!1}),V=I.useMemo(function(){for(var ee=o.length-D,de=0,fe=0;fe<D;fe+=1)de+=k[fe]||0;return{offset:D,colSpan:ee,sticky:de}},[o.length,D,k]),K=d(["body","wrapper"],"tbody"),Y=d(["body","row"],"tr"),Z=d(["body","cell"],"td"),te=d(["body","cell"],"th"),ne;t.length?ne=B.map(function(ee,de){var fe=ee.record,ye=ee.indent,ge=ee.index,we=ee.rowKey;return I.createElement(Nhe,{key:we,rowKey:we,rowKeys:N,record:fe,index:de,renderIndex:ge,rowComponent:Y,cellComponent:Z,scopeCellComponent:te,indent:ye,expandedRowInfo:V})}):ne=I.createElement(j8,{expanded:!0,className:"".concat(s,"-placeholder"),prefixCls:s,component:Y,cellComponent:Z,colSpan:o.length,isEmpty:!0},P);var se=OE(o);return I.createElement(z8.Provider,{value:j.current},I.createElement(K,{className:"".concat(s,"-tbody")},n&&I.createElement($he,{prefixCls:s,columnsKey:se,onColumnResize:f,columns:o}),ne))}const Vhe=e_(jhe);var Uhe=["expandable"],K0="RC_TABLE_INTERNAL_COL_DEFINE";function Hhe(e){var t=e.expandable,n=ri(e,Uhe),i;return"expandable"in e?i=Je(Je({},n),t):i=n,i.showExpandColumn===!1&&(i.expandIconColumnIndex=-1),i}var Ghe=["columnType"];function H8(e){for(var t=e.colWidths,n=e.columns,i=e.columCount,s=ms(Us,["tableLayout"]),d=s.tableLayout,f=[],o=i||n.length,y=!1,b=o-1;b>=0;b-=1){var C=t[b],P=n&&n[b],A=void 0,D=void 0;if(P&&(A=P[K0],d==="auto"&&(D=P.minWidth)),C||D||A||y){var k=A||{};k.columnType;var B=ri(k,Ghe);f.unshift(I.createElement("col",kn({key:b,style:{width:C,minWidth:D}},B))),y=!0}}return f.length>0?I.createElement("colgroup",null,f):null}var Whe=["className","noData","columns","flattenColumns","colWidths","colGroup","columCount","stickyOffsets","direction","fixHeader","stickyTopOffset","stickyBottomOffset","stickyClassName","scrollX","tableLayout","onScroll","children"];function qhe(e,t){return I.useMemo(function(){for(var n=[],i=0;i<t;i+=1){var s=e[i];if(s!==void 0)n[i]=s;else return null}return n},[e.join("_"),t])}var Khe=I.forwardRef(function(e,t){var n=e.className,i=e.noData,s=e.columns,d=e.flattenColumns,f=e.colWidths,o=e.colGroup,y=e.columCount,b=e.stickyOffsets,C=e.direction,P=e.fixHeader,A=e.stickyTopOffset,D=e.stickyBottomOffset,k=e.stickyClassName,B=e.scrollX,N=e.tableLayout,j=N===void 0?"fixed":N,V=e.onScroll,K=e.children,Y=ri(e,Whe),Z=ms(Us,["prefixCls","scrollbarSize","isSticky","getComponent"]),te=Z.prefixCls,ne=Z.scrollbarSize,se=Z.isSticky,ee=Z.getComponent,de=ee(["header","table"],"table"),fe=se&&!P?0:ne,ye=I.useRef(null),ge=I.useCallback(function(Be){bx(t,Be),bx(ye,Be)},[]);I.useEffect(function(){function Be(qe){var at=qe,Ke=at.currentTarget,tt=at.deltaX;tt&&(V({currentTarget:Ke,scrollLeft:Ke.scrollLeft+tt}),qe.preventDefault())}var Xe=ye.current;return Xe==null||Xe.addEventListener("wheel",Be,{passive:!1}),function(){Xe==null||Xe.removeEventListener("wheel",Be)}},[]);var we=d[d.length-1],Se={fixed:we?we.fixed:null,scrollbar:!0,onHeaderCell:function(){return{className:"".concat(te,"-cell-scrollbar")}}},xe=I.useMemo(function(){return fe?[].concat(zn(s),[Se]):s},[fe,s]),Te=I.useMemo(function(){return fe?[].concat(zn(d),[Se]):d},[fe,d]),ze=I.useMemo(function(){var Be=b.right,Xe=b.left;return Je(Je({},b),{},{left:C==="rtl"?[].concat(zn(Xe.map(function(qe){return qe+fe})),[0]):Xe,right:C==="rtl"?Be:[].concat(zn(Be.map(function(qe){return qe+fe})),[0]),isSticky:se})},[fe,b,se]),Ue=qhe(f,y),We=I.useMemo(function(){var Be=!Ue||!Ue.length||Ue.every(function(Xe){return!Xe});return i||Be},[i,Ue]);return I.createElement("div",{style:Je({overflow:"hidden"},se?{top:A,bottom:D}:{}),ref:ge,className:St(n,ke({},k,!!k))},I.createElement(de,{style:{tableLayout:j,minWidth:"100%",width:B}},We?o:I.createElement(H8,{colWidths:[].concat(zn(Ue),[fe]),columCount:y+1,columns:Te}),K(Je(Je({},Y),{},{stickyOffsets:ze,columns:xe,flattenColumns:Te}))))});const B$=I.memo(Khe);var Xhe=function(t){var n=t.cells,i=t.stickyOffsets,s=t.flattenColumns,d=t.rowComponent,f=t.cellComponent,o=t.onHeaderRow,y=t.index,b=ms(Us,["prefixCls","direction"]),C=b.prefixCls,P=b.direction,A;o&&(A=o(n.map(function(k){return k.column}),y));var D=OE(n.map(function(k){return k.column}));return I.createElement(d,A,n.map(function(k,B){var N=k.column,j=uD(k.colStart,k.colEnd,s,i,P),V;return N&&N.onHeaderCell&&(V=k.column.onHeaderCell(N)),I.createElement(t_,kn({},k,{scope:N.title?k.colSpan>1?"colgroup":"col":null,ellipsis:N.ellipsis,align:N.align,component:f,prefixCls:C,key:D[B]},j,{additionalProps:V,rowType:"header"}))}))};function Zhe(e){var t=[];function n(f,o){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;t[y]=t[y]||[];var b=o,C=f.filter(Boolean).map(function(P){var A={key:P.key,className:P.className||"",children:P.title,column:P,colStart:b},D=1,k=P.children;return k&&k.length>0&&(D=n(k,b,y+1).reduce(function(B,N){return B+N},0),A.hasSubColumns=!0),"colSpan"in P&&(D=P.colSpan),"rowSpan"in P&&(A.rowSpan=P.rowSpan),A.colSpan=D,A.colEnd=A.colStart+D-1,t[y].push(A),b+=D,D});return C}n(e,0);for(var i=t.length,s=function(o){t[o].forEach(function(y){!("rowSpan"in y)&&!y.hasSubColumns&&(y.rowSpan=i-o)})},d=0;d<i;d+=1)s(d);return t}var Yhe=function(t){var n=t.stickyOffsets,i=t.columns,s=t.flattenColumns,d=t.onHeaderRow,f=ms(Us,["prefixCls","getComponent"]),o=f.prefixCls,y=f.getComponent,b=I.useMemo(function(){return Zhe(i)},[i]),C=y(["header","wrapper"],"thead"),P=y(["header","row"],"tr"),A=y(["header","cell"],"th");return I.createElement(C,{className:"".concat(o,"-thead")},b.map(function(D,k){var B=I.createElement(Xhe,{key:k,flattenColumns:s,cells:D,stickyOffsets:n,rowComponent:P,cellComponent:A,onHeaderRow:d,index:k});return B}))};const $$=e_(Yhe);function j$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return typeof t=="number"?t:t.endsWith("%")?e*parseFloat(t)/100:null}function Jhe(e,t,n){return I.useMemo(function(){if(t&&t>0){var i=0,s=0;e.forEach(function(A){var D=j$(t,A.width);D?i+=D:s+=1});var d=Math.max(t,n),f=Math.max(d-i,s),o=s,y=f/s,b=0,C=e.map(function(A){var D=Je({},A),k=j$(t,D.width);if(k)D.width=k;else{var B=Math.floor(y);D.width=o===1?f:B,f-=B,o-=1}return b+=D.width,D});if(b<d){var P=d/b;f=d,C.forEach(function(A,D){var k=Math.floor(A.width*P);A.width=D===C.length-1?f:k,f-=k})}return[C,Math.max(b,d)]}return[e,t]},[e,t,n])}var Qhe=["children"],efe=["fixed"];function dD(e){return vc(e).filter(function(t){return I.isValidElement(t)}).map(function(t){var n=t.key,i=t.props,s=i.children,d=ri(i,Qhe),f=Je({key:n},d);return s&&(f.children=dD(s)),f})}function G8(e){return e.filter(function(t){return t&&Nr(t)==="object"&&!t.hidden}).map(function(t){var n=t.children;return n&&n.length>0?Je(Je({},t),{},{children:G8(n)}):t})}function zR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key";return e.filter(function(n){return n&&Nr(n)==="object"}).reduce(function(n,i,s){var d=i.fixed,f=d===!0?"left":d,o="".concat(t,"-").concat(s),y=i.children;return y&&y.length>0?[].concat(zn(n),zn(zR(y,o).map(function(b){var C;return Je(Je({},b),{},{fixed:(C=b.fixed)!==null&&C!==void 0?C:f})}))):[].concat(zn(n),[Je(Je({key:o},i),{},{fixed:f})])},[])}function tfe(e){return e.map(function(t){var n=t.fixed,i=ri(t,efe),s=n;return n==="left"?s="right":n==="right"&&(s="left"),Je({fixed:s},i)})}function nfe(e,t){var n=e.prefixCls,i=e.columns,s=e.children,d=e.expandable,f=e.expandedKeys,o=e.columnTitle,y=e.getRowKey,b=e.onTriggerExpand,C=e.expandIcon,P=e.rowExpandable,A=e.expandIconColumnIndex,D=e.expandedRowOffset,k=D===void 0?0:D,B=e.direction,N=e.expandRowByClick,j=e.columnWidth,V=e.fixed,K=e.scrollWidth,Y=e.clientWidth,Z=I.useMemo(function(){var we=i||dD(s)||[];return G8(we.slice())},[i,s]),te=I.useMemo(function(){if(d){var we=Z.slice();if(!we.includes(Fh)){var Se=A||0,xe=Se===0&&V==="right"?Z.length:Se;xe>=0&&we.splice(xe,0,Fh)}var Te=we.indexOf(Fh);we=we.filter(function(Be,Xe){return Be!==Fh||Xe===Te});var ze=Z[Te],Ue;V?Ue=V:Ue=ze?ze.fixed:null;var We=ke(ke(ke(ke(ke(ke({},K0,{className:"".concat(n,"-expand-icon-col"),columnType:"EXPAND_COLUMN"}),"title",o),"fixed",Ue),"className","".concat(n,"-row-expand-icon-cell")),"width",j),"render",function(Xe,qe,at){var Ke=y(qe,at),tt=f.has(Ke),vt=P?P(qe):!0,Pt=C({prefixCls:n,expanded:tt,expandable:vt,record:qe,onExpand:b});return N?I.createElement("span",{onClick:function(Nt){return Nt.stopPropagation()}},Pt):Pt});return we.map(function(Be,Xe){var qe=Be===Fh?We:Be;return Xe<k?Je(Je({},qe),{},{fixed:qe.fixed||"left"}):qe})}return Z.filter(function(Be){return Be!==Fh})},[d,Z,y,f,C,B,k]),ne=I.useMemo(function(){var we=te;return t&&(we=t(we)),we.length||(we=[{render:function(){return null}}]),we},[t,te,B]),se=I.useMemo(function(){return B==="rtl"?tfe(zR(ne)):zR(ne)},[ne,B,K]),ee=I.useMemo(function(){for(var we=-1,Se=se.length-1;Se>=0;Se-=1){var xe=se[Se].fixed;if(xe==="left"||xe===!0){we=Se;break}}if(we>=0)for(var Te=0;Te<=we;Te+=1){var ze=se[Te].fixed;if(ze!=="left"&&ze!==!0)return!0}var Ue=se.findIndex(function(Xe){var qe=Xe.fixed;return qe==="right"});if(Ue>=0)for(var We=Ue;We<se.length;We+=1){var Be=se[We].fixed;if(Be!=="right")return!0}return!1},[se]),de=Jhe(se,K,Y),fe=It(de,2),ye=fe[0],ge=fe[1];return[ne,ye,ge,ee]}function rfe(e,t,n){var i=Hhe(e),s=i.expandIcon,d=i.expandedRowKeys,f=i.defaultExpandedRowKeys,o=i.defaultExpandAllRows,y=i.expandedRowRender,b=i.onExpand,C=i.onExpandedRowsChange,P=i.childrenColumnName,A=s||zhe,D=P||"children",k=I.useMemo(function(){return y?"row":e.expandable&&e.internalHooks===ub&&e.expandable.__PARENT_RENDER_ICON__||t.some(function(Z){return Z&&Nr(Z)==="object"&&Z[D]})?"nest":!1},[!!y,t]),B=I.useState(function(){return f||(o?khe(t,n,D):[])}),N=It(B,2),j=N[0],V=N[1],K=I.useMemo(function(){return new Set(d||j||[])},[d,j]),Y=I.useCallback(function(Z){var te=n(Z,t.indexOf(Z)),ne,se=K.has(te);se?(K.delete(te),ne=zn(K)):ne=[].concat(zn(K),[te]),V(ne),b&&b(!se,Z),C&&C(ne)},[n,K,t,b,C]);return[i,k,K,A,D,Y]}function ife(e,t,n){var i=e.map(function(s,d){return uD(d,d,e,t,n)});return nm(function(){return i},[i],function(s,d){return!Yc(s,d)})}function ofe(e){var t=I.useRef(e),n=I.useState({}),i=It(n,2),s=i[1],d=I.useRef(null),f=I.useRef([]);function o(y){f.current.push(y);var b=Promise.resolve();d.current=b,b.then(function(){if(d.current===b){var C=f.current,P=t.current;f.current=[],C.forEach(function(A){t.current=A(t.current)}),d.current=null,P!==t.current&&s({})}})}return I.useEffect(function(){return function(){d.current=null}},[]),[t.current,o]}function afe(e){var t=I.useRef(null),n=I.useRef();function i(){window.clearTimeout(n.current)}function s(f){t.current=f,i(),n.current=window.setTimeout(function(){t.current=null,n.current=void 0},100)}function d(){return t.current}return I.useEffect(function(){return i},[]),[s,d]}function sfe(){var e=I.useState(-1),t=It(e,2),n=t[0],i=t[1],s=I.useState(-1),d=It(s,2),f=d[0],o=d[1],y=I.useCallback(function(b,C){i(b),o(C)},[]);return[n,f,y]}var V$=Bs()?window:null;function lfe(e,t){var n=Nr(e)==="object"?e:{},i=n.offsetHeader,s=i===void 0?0:i,d=n.offsetSummary,f=d===void 0?0:d,o=n.offsetScroll,y=o===void 0?0:o,b=n.getContainer,C=b===void 0?function(){return V$}:b,P=C()||V$,A=!!e;return I.useMemo(function(){return{isSticky:A,stickyClassName:A?"".concat(t,"-sticky-holder"):"",offsetHeader:s,offsetSummary:f,offsetScroll:y,container:P}},[A,y,s,f,t,P])}function cfe(e,t,n){var i=I.useMemo(function(){var s=t.length,d=function(b,C,P){for(var A=[],D=0,k=b;k!==C;k+=P)A.push(D),t[k].fixed&&(D+=e[k]||0);return A},f=d(0,s,1),o=d(s-1,-1,-1).reverse();return n==="rtl"?{left:o,right:f}:{left:f,right:o}},[e,t,n]);return i}function U$(e){var t=e.className,n=e.children;return I.createElement("div",{className:t},n)}function H$(e){var t=WC(e),n=t.getBoundingClientRect(),i=document.documentElement;return{left:n.left+(window.pageXOffset||i.scrollLeft)-(i.clientLeft||document.body.clientLeft||0),top:n.top+(window.pageYOffset||i.scrollTop)-(i.clientTop||document.body.clientTop||0)}}var ufe=function(t,n){var i,s,d=t.scrollBodyRef,f=t.onScroll,o=t.offsetScroll,y=t.container,b=t.direction,C=ms(Us,"prefixCls"),P=((i=d.current)===null||i===void 0?void 0:i.scrollWidth)||0,A=((s=d.current)===null||s===void 0?void 0:s.clientWidth)||0,D=P&&A*(A/P),k=I.useRef(),B=ofe({scrollLeft:0,isHiddenScrollBar:!0}),N=It(B,2),j=N[0],V=N[1],K=I.useRef({delta:0,x:0}),Y=I.useState(!1),Z=It(Y,2),te=Z[0],ne=Z[1],se=I.useRef(null);I.useEffect(function(){return function(){Qi.cancel(se.current)}},[]);var ee=function(){ne(!1)},de=function(Se){Se.persist(),K.current.delta=Se.pageX-j.scrollLeft,K.current.x=0,ne(!0),Se.preventDefault()},fe=function(Se){var xe,Te=Se||((xe=window)===null||xe===void 0?void 0:xe.event),ze=Te.buttons;if(!te||ze===0){te&&ne(!1);return}var Ue=K.current.x+Se.pageX-K.current.x-K.current.delta,We=b==="rtl";Ue=Math.max(We?D-A:0,Math.min(We?0:A-D,Ue));var Be=!We||Math.abs(Ue)+Math.abs(D)<A;Be&&(f({scrollLeft:Ue/A*(P+2)}),K.current.x=Se.pageX)},ye=function(){Qi.cancel(se.current),se.current=Qi(function(){if(d.current){var Se=H$(d.current).top,xe=Se+d.current.offsetHeight,Te=y===window?document.documentElement.scrollTop+window.innerHeight:H$(y).top+y.clientHeight;V(function(ze){return Je(Je({},ze),{},{isHiddenScrollBar:xe-oB()<=Te||Se>=Te-o})})}})},ge=function(Se){V(function(xe){return Je(Je({},xe),{},{scrollLeft:P?Se/P*A:0})})};return I.useImperativeHandle(n,function(){return{setScrollLeft:ge,checkScrollBarVisible:ye}}),I.useEffect(function(){var we=R$(document.body,"mouseup",ee,!1),Se=R$(document.body,"mousemove",fe,!1);return ye(),function(){we.remove(),Se.remove()}},[D,te]),I.useEffect(function(){if(d.current){for(var we=[],Se=WC(d.current);Se;)we.push(Se),Se=Se.parentElement;return we.forEach(function(xe){return xe.addEventListener("scroll",ye,!1)}),window.addEventListener("resize",ye,!1),window.addEventListener("scroll",ye,!1),y.addEventListener("scroll",ye,!1),function(){we.forEach(function(xe){return xe.removeEventListener("scroll",ye)}),window.removeEventListener("resize",ye),window.removeEventListener("scroll",ye),y.removeEventListener("scroll",ye)}}},[y]),I.useEffect(function(){j.isHiddenScrollBar||V(function(we){var Se=d.current;return Se?Je(Je({},we),{},{scrollLeft:Se.scrollLeft/Se.scrollWidth*Se.clientWidth}):we})},[j.isHiddenScrollBar]),P<=A||!D||j.isHiddenScrollBar?null:I.createElement("div",{style:{height:oB(),width:A,bottom:o},className:"".concat(C,"-sticky-scroll")},I.createElement("div",{onMouseDown:de,ref:k,className:St("".concat(C,"-sticky-scroll-bar"),ke({},"".concat(C,"-sticky-scroll-bar-active"),te)),style:{width:"".concat(D,"px"),transform:"translate3d(".concat(j.scrollLeft,"px, 0, 0)")}}))};const dfe=I.forwardRef(ufe);var W8="rc-table",hfe=[],ffe={};function pfe(){return"No Data"}function mfe(e,t){var n=Je({rowKey:"key",prefixCls:W8,emptyText:pfe},e),i=n.prefixCls,s=n.className,d=n.rowClassName,f=n.style,o=n.data,y=n.rowKey,b=n.scroll,C=n.tableLayout,P=n.direction,A=n.title,D=n.footer,k=n.summary,B=n.caption,N=n.id,j=n.showHeader,V=n.components,K=n.emptyText,Y=n.onRow,Z=n.onHeaderRow,te=n.measureRowRender,ne=n.onScroll,se=n.internalHooks,ee=n.transformColumns,de=n.internalRefs,fe=n.tailor,ye=n.getContainerWidth,ge=n.sticky,we=n.rowHoverable,Se=we===void 0?!0:we,xe=o||hfe,Te=!!xe.length,ze=se===ub,Ue=I.useCallback(function(Br,Xr){return Ul(V,Br)||Xr},[V]),We=I.useMemo(function(){return typeof y=="function"?y:function(Br){var Xr=Br&&Br[y];return Xr}},[y]),Be=Ue(["body"]),Xe=sfe(),qe=It(Xe,3),at=qe[0],Ke=qe[1],tt=qe[2],vt=rfe(n,xe,We),Pt=It(vt,6),ft=Pt[0],Nt=Pt[1],Rt=Pt[2],pt=Pt[3],yt=Pt[4],xt=Pt[5],bt=b==null?void 0:b.x,Ct=I.useState(0),tn=It(Ct,2),Zt=tn[0],In=tn[1],Cn=nfe(Je(Je(Je({},n),ft),{},{expandable:!!ft.expandedRowRender,columnTitle:ft.columnTitle,expandedKeys:Rt,getRowKey:We,onTriggerExpand:xt,expandIcon:pt,expandIconColumnIndex:ft.expandIconColumnIndex,direction:P,scrollWidth:ze&&fe&&typeof bt=="number"?bt:null,clientWidth:Zt}),ze?ee:null),Mt=It(Cn,4),hn=Mt[0],Jt=Mt[1],Ut=Mt[2],Tn=Mt[3],On=Ut??bt,Kn=I.useMemo(function(){return{columns:hn,flattenColumns:Jt}},[hn,Jt]),Un=I.useRef(),Pn=I.useRef(),Qn=I.useRef(),un=I.useRef();I.useImperativeHandle(t,function(){return{nativeElement:Un.current,scrollTo:function(Xr){var eo;if(Qn.current instanceof HTMLElement){var qo=Xr.index,Eo=Xr.top,Go=Xr.key;if(whe(Eo)){var Ia;(Ia=Qn.current)===null||Ia===void 0||Ia.scrollTo({top:Eo})}else{var Ko,sa=Go??We(xe[qo]);(Ko=Qn.current.querySelector('[data-row-key="'.concat(sa,'"]')))===null||Ko===void 0||Ko.scrollIntoView()}}else(eo=Qn.current)!==null&&eo!==void 0&&eo.scrollTo&&Qn.current.scrollTo(Xr)}}});var nn=I.useRef(),$n=I.useState(!1),Ln=It($n,2),qn=Ln[0],er=Ln[1],tr=I.useState(!1),Jn=It(tr,2),Ir=Jn[0],_r=Jn[1],$r=I.useState(new Map),mr=It($r,2),yi=mr[0],Vr=mr[1],Kr=OE(Jt),Rr=Kr.map(function(Br){return yi.get(Br)}),ii=I.useMemo(function(){return Rr},[Rr.join("_")]),Hr=cfe(ii,Jt,P),ut=b&&LR(b.y),ur=b&&LR(On)||!!ft.fixed,fr=ur&&Jt.some(function(Br){var Xr=Br.fixed;return Xr}),Fn=I.useRef(),Gt=lfe(ge,i),mn=Gt.isSticky,Xn=Gt.offsetHeader,gr=Gt.offsetSummary,je=Gt.offsetScroll,re=Gt.stickyClassName,ie=Gt.container,_e=I.useMemo(function(){return k==null?void 0:k(xe)},[k,xe]),Re=(ut||mn)&&I.isValidElement(_e)&&_e.type===DE&&_e.props.fixed,De,Ge,ot;ut&&(Ge={overflowY:Te?"scroll":"auto",maxHeight:b.y}),ur&&(De={overflowX:"auto"},ut||(Ge={overflowY:"hidden"}),ot={width:On===!0?"auto":On,minWidth:"100%"});var Ye=I.useCallback(function(Br,Xr){Vr(function(eo){if(eo.get(Br)!==Xr){var qo=new Map(eo);return qo.set(Br,Xr),qo}return eo})},[]),rt=afe(),zt=It(rt,2),it=zt[0],$t=zt[1];function Qt(Br,Xr){Xr&&(typeof Xr=="function"?Xr(Br):Xr.scrollLeft!==Br&&(Xr.scrollLeft=Br,Xr.scrollLeft!==Br&&setTimeout(function(){Xr.scrollLeft=Br},0)))}var Ft=Io(function(Br){var Xr=Br.currentTarget,eo=Br.scrollLeft,qo=P==="rtl",Eo=typeof eo=="number"?eo:Xr.scrollLeft,Go=Xr||ffe;if(!$t()||$t()===Go){var Ia;it(Go),Qt(Eo,Pn.current),Qt(Eo,Qn.current),Qt(Eo,nn.current),Qt(Eo,(Ia=Fn.current)===null||Ia===void 0?void 0:Ia.setScrollLeft)}var Ko=Xr||Pn.current;if(Ko){var sa=ze&&fe&&typeof On=="number"?On:Ko.scrollWidth,Ss=Ko.clientWidth;if(sa===Ss){er(!1),_r(!1);return}qo?(er(-Eo<sa-Ss),_r(-Eo>0)):(er(Eo>0),_r(Eo<sa-Ss))}}),jt=Io(function(Br){Ft(Br),ne==null||ne(Br)}),rn=function(){if(ur&&Qn.current){var Xr;Ft({currentTarget:WC(Qn.current),scrollLeft:(Xr=Qn.current)===null||Xr===void 0?void 0:Xr.scrollLeft})}else er(!1),_r(!1)},yn=function(Xr){var eo,qo=Xr.width;(eo=Fn.current)===null||eo===void 0||eo.checkScrollBarVisible();var Eo=Un.current?Un.current.offsetWidth:qo;ze&&ye&&Un.current&&(Eo=ye(Un.current,Eo)||Eo),Eo!==Zt&&(rn(),In(Eo))},rr=I.useRef(!1);I.useEffect(function(){rr.current&&rn()},[ur,o,hn.length]),I.useEffect(function(){rr.current=!0},[]);var En=I.useState(0),Zn=It(En,2),ar=Zn[0],qr=Zn[1],Ar=I.useState(!0),yr=It(Ar,2),Jr=yr[0],ni=yr[1];yo(function(){(!fe||!ze)&&(Qn.current instanceof Element?qr(lR(Qn.current).width):qr(lR(un.current).width)),ni(Rie("position","sticky"))},[]),I.useEffect(function(){ze&&de&&(de.body.current=Qn.current)});var Qr=I.useCallback(function(Br){return I.createElement(I.Fragment,null,I.createElement($$,Br),Re==="top"&&I.createElement(Ow,Br,_e))},[Re,_e]),li=I.useCallback(function(Br){return I.createElement(Ow,Br,_e)},[_e]),Ui=Ue(["table"],"table"),oo=I.useMemo(function(){return C||(fr?On==="max-content"?"auto":"fixed":ut||mn||Jt.some(function(Br){var Xr=Br.ellipsis;return Xr})?"fixed":"auto")},[ut,fr,Jt,C,mn]),Ti,wr={colWidths:ii,columCount:Jt.length,stickyOffsets:Hr,onHeaderRow:Z,fixHeader:ut,scroll:b},nr=I.useMemo(function(){return Te?null:typeof K=="function"?K():K},[Te,K]),xi=I.createElement(Vhe,{data:xe,measureColumnWidth:ut||ur||mn}),oi=I.createElement(H8,{colWidths:Jt.map(function(Br){var Xr=Br.width;return Xr}),columns:Jt}),Li=B!=null?I.createElement("caption",{className:"".concat(i,"-caption")},B):void 0,ki=Jc(n,{data:!0}),ho=Jc(n,{aria:!0});if(ut||mn){var Uo;typeof Be=="function"?(Uo=Be(xe,{scrollbarSize:ar,ref:Qn,onScroll:Ft}),wr.colWidths=Jt.map(function(Br,Xr){var eo=Br.width,qo=Xr===Jt.length-1?eo-ar:eo;return typeof qo=="number"&&!Number.isNaN(qo)?qo:0})):Uo=I.createElement("div",{style:Je(Je({},De),Ge),onScroll:jt,ref:Qn,className:St("".concat(i,"-body"))},I.createElement(Ui,kn({style:Je(Je({},ot),{},{tableLayout:oo})},ho),Li,oi,xi,!Re&&_e&&I.createElement(Ow,{stickyOffsets:Hr,flattenColumns:Jt},_e)));var Qo=Je(Je(Je({noData:!xe.length},wr),Kn),{},{direction:P,stickyClassName:re,scrollX:On,tableLayout:oo,onScroll:Ft});Ti=I.createElement(I.Fragment,null,j!==!1&&I.createElement(B$,kn({},Qo,{stickyTopOffset:Xn,className:"".concat(i,"-header"),ref:Pn,colGroup:oi}),Qr),Uo,Re&&Re!=="top"&&I.createElement(B$,kn({},Qo,{stickyBottomOffset:gr,className:"".concat(i,"-summary"),ref:nn,colGroup:oi}),li),mn&&Qn.current&&Qn.current instanceof Element&&I.createElement(dfe,{ref:Fn,offsetScroll:je,scrollBodyRef:Qn,onScroll:Ft,container:ie,direction:P}))}else Ti=I.createElement("div",{style:Je(Je({},De),Ge),className:St("".concat(i,"-content")),onScroll:Ft,ref:Qn},I.createElement(Ui,kn({style:Je(Je({},ot),{},{tableLayout:oo})},ho),Li,oi,j!==!1&&I.createElement($$,kn({},wr,Kn)),xi,_e&&I.createElement(Ow,{stickyOffsets:Hr,flattenColumns:Jt},_e)));var Ho=I.createElement("div",kn({className:St(i,s,ke(ke(ke(ke(ke(ke(ke(ke(ke(ke({},"".concat(i,"-rtl"),P==="rtl"),"".concat(i,"-ping-left"),qn),"".concat(i,"-ping-right"),Ir),"".concat(i,"-layout-fixed"),C==="fixed"),"".concat(i,"-fixed-header"),ut),"".concat(i,"-fixed-column"),fr),"".concat(i,"-fixed-column-gapped"),fr&&Tn),"".concat(i,"-scroll-horizontal"),ur),"".concat(i,"-has-fix-left"),Jt[0]&&Jt[0].fixed),"".concat(i,"-has-fix-right"),Jt[Jt.length-1]&&Jt[Jt.length-1].fixed==="right")),style:f,id:N,ref:Un},ki),A&&I.createElement(U$,{className:"".concat(i,"-title")},A(xe)),I.createElement("div",{ref:un,className:"".concat(i,"-container")},Ti),D&&I.createElement(U$,{className:"".concat(i,"-footer")},D(xe)));ur&&(Ho=I.createElement(Wl,{onResize:yn},Ho));var ea=ife(Jt,Hr,P),Oo=I.useMemo(function(){return{scrollX:On,prefixCls:i,getComponent:Ue,scrollbarSize:ar,direction:P,fixedInfoList:ea,isSticky:mn,supportSticky:Jr,componentWidth:Zt,fixHeader:ut,fixColumn:fr,horizonScroll:ur,tableLayout:oo,rowClassName:d,expandedRowClassName:ft.expandedRowClassName,expandIcon:pt,expandableType:Nt,expandRowByClick:ft.expandRowByClick,expandedRowRender:ft.expandedRowRender,expandedRowOffset:ft.expandedRowOffset,onTriggerExpand:xt,expandIconColumnIndex:ft.expandIconColumnIndex,indentSize:ft.indentSize,allColumnsFixedLeft:Jt.every(function(Br){return Br.fixed==="left"}),emptyNode:nr,columns:hn,flattenColumns:Jt,onColumnResize:Ye,colWidths:ii,hoverStartRow:at,hoverEndRow:Ke,onHover:tt,rowExpandable:ft.rowExpandable,onRow:Y,getRowKey:We,expandedKeys:Rt,childrenColumnName:yt,rowHoverable:Se,measureRowRender:te}},[On,i,Ue,ar,P,ea,mn,Jr,Zt,ut,fr,ur,oo,d,ft.expandedRowClassName,pt,Nt,ft.expandRowByClick,ft.expandedRowRender,ft.expandedRowOffset,xt,ft.expandIconColumnIndex,ft.indentSize,nr,hn,Jt,Ye,ii,at,Ke,tt,ft.rowExpandable,Y,We,Rt,yt,Se,te]);return I.createElement(Us.Provider,{value:Oo},Ho)}var gfe=I.forwardRef(mfe);function q8(e){return L8(gfe,e)}var n_=q8();n_.EXPAND_COLUMN=Fh;n_.INTERNAL_HOOKS=ub;n_.Column=Dhe;n_.ColumnGroup=Lhe;n_.Summary=F8;var hD=lD(null),K8=lD(null);function vfe(e,t,n){var i=t||1;return n[e+i]-(n[e]||0)}function _fe(e){var t=e.rowInfo,n=e.column,i=e.colIndex,s=e.indent,d=e.index,f=e.component,o=e.renderIndex,y=e.record,b=e.style,C=e.className,P=e.inverse,A=e.getHeight,D=n.render,k=n.dataIndex,B=n.className,N=n.width,j=ms(K8,["columnsOffset"]),V=j.columnsOffset,K=U8(t,n,i,s,d),Y=K.key,Z=K.fixedInfo,te=K.appendCellNode,ne=K.additionalCellProps,se=ne.style,ee=ne.colSpan,de=ee===void 0?1:ee,fe=ne.rowSpan,ye=fe===void 0?1:fe,ge=i-1,we=vfe(ge,de,V),Se=de>1?N-we:0,xe=Je(Je(Je({},se),b),{},{flex:"0 0 ".concat(we,"px"),width:"".concat(we,"px"),marginRight:Se,pointerEvents:"auto"}),Te=I.useMemo(function(){return P?ye<=1:de===0||ye===0||ye>1},[ye,de,P]);Te?xe.visibility="hidden":P&&(xe.height=A==null?void 0:A(ye));var ze=Te?function(){return null}:D,Ue={};return(ye===0||de===0)&&(Ue.rowSpan=1,Ue.colSpan=1),I.createElement(t_,kn({className:St(B,C),ellipsis:n.ellipsis,align:n.align,scope:n.rowScope,component:f,prefixCls:t.prefixCls,key:Y,record:y,index:d,renderIndex:o,dataIndex:k,render:ze,shouldCellUpdate:n.shouldCellUpdate},Z,{appendNode:te,additionalProps:Je(Je({},ne),{},{style:xe},Ue)}))}var yfe=["data","index","className","rowKey","style","extra","getHeight"],xfe=I.forwardRef(function(e,t){var n=e.data,i=e.index,s=e.className,d=e.rowKey,f=e.style,o=e.extra,y=e.getHeight,b=ri(e,yfe),C=n.record,P=n.indent,A=n.index,D=ms(Us,["prefixCls","flattenColumns","fixColumn","componentWidth","scrollX"]),k=D.scrollX,B=D.flattenColumns,N=D.prefixCls,j=D.fixColumn,V=D.componentWidth,K=ms(hD,["getComponent"]),Y=K.getComponent,Z=$8(C,d,i,P),te=Y(["body","row"],"div"),ne=Y(["body","cell"],"div"),se=Z.rowSupportExpand,ee=Z.expanded,de=Z.rowProps,fe=Z.expandedRowRender,ye=Z.expandedRowClassName,ge;if(se&&ee){var we=fe(C,i,P+1,ee),Se=V8(ye,C,i,P),xe={};j&&(xe={style:ke({},"--virtual-width","".concat(V,"px"))});var Te="".concat(N,"-expanded-row-cell");ge=I.createElement(te,{className:St("".concat(N,"-expanded-row"),"".concat(N,"-expanded-row-level-").concat(P+1),Se)},I.createElement(t_,{component:ne,prefixCls:N,className:St(Te,ke({},"".concat(Te,"-fixed"),j)),additionalProps:xe},we))}var ze=Je(Je({},f),{},{width:k});o&&(ze.position="absolute",ze.pointerEvents="none");var Ue=I.createElement(te,kn({},de,b,{"data-row-key":d,ref:se?null:t,className:St(s,"".concat(N,"-row"),de==null?void 0:de.className,ke({},"".concat(N,"-row-extra"),o)),style:Je(Je({},ze),de==null?void 0:de.style)}),B.map(function(We,Be){return I.createElement(_fe,{key:Be,component:ne,rowInfo:Z,column:We,colIndex:Be,indent:P,index:i,renderIndex:A,record:C,inverse:o,getHeight:y})}));return se?I.createElement("div",{ref:t},Ue,ge):Ue}),G$=e_(xfe),bfe=I.forwardRef(function(e,t){var n=e.data,i=e.onScroll,s=ms(Us,["flattenColumns","onColumnResize","getRowKey","prefixCls","expandedKeys","childrenColumnName","scrollX","direction"]),d=s.flattenColumns,f=s.onColumnResize,o=s.getRowKey,y=s.expandedKeys,b=s.prefixCls,C=s.childrenColumnName,P=s.scrollX,A=s.direction,D=ms(hD),k=D.sticky,B=D.scrollY,N=D.listItemHeight,j=D.getComponent,V=D.onScroll,K=I.useRef(),Y=B8(n,C,y,o),Z=I.useMemo(function(){var ge=0;return d.map(function(we){var Se=we.width,xe=we.minWidth,Te=we.key,ze=Math.max(Se||0,xe||0);return ge+=ze,[Te,ze,ge]})},[d]),te=I.useMemo(function(){return Z.map(function(ge){return ge[2]})},[Z]);I.useEffect(function(){Z.forEach(function(ge){var we=It(ge,2),Se=we[0],xe=we[1];f(Se,xe)})},[Z]),I.useImperativeHandle(t,function(){var ge,we={scrollTo:function(xe){var Te;(Te=K.current)===null||Te===void 0||Te.scrollTo(xe)},nativeElement:(ge=K.current)===null||ge===void 0?void 0:ge.nativeElement};return Object.defineProperty(we,"scrollLeft",{get:function(){var xe;return((xe=K.current)===null||xe===void 0?void 0:xe.getScrollInfo().x)||0},set:function(xe){var Te;(Te=K.current)===null||Te===void 0||Te.scrollTo({left:xe})}}),Object.defineProperty(we,"scrollTop",{get:function(){var xe;return((xe=K.current)===null||xe===void 0?void 0:xe.getScrollInfo().y)||0},set:function(xe){var Te;(Te=K.current)===null||Te===void 0||Te.scrollTo({top:xe})}}),we});var ne=function(we,Se){var xe,Te=(xe=Y[Se])===null||xe===void 0?void 0:xe.record,ze=we.onCell;if(ze){var Ue,We=ze(Te,Se);return(Ue=We==null?void 0:We.rowSpan)!==null&&Ue!==void 0?Ue:1}return 1},se=function(we){var Se=we.start,xe=we.end,Te=we.getSize,ze=we.offsetY;if(xe<0)return null;for(var Ue=d.filter(function(Rt){return ne(Rt,Se)===0}),We=Se,Be=function(pt){if(Ue=Ue.filter(function(yt){return ne(yt,pt)===0}),!Ue.length)return We=pt,1},Xe=Se;Xe>=0&&!Be(Xe);Xe-=1);for(var qe=d.filter(function(Rt){return ne(Rt,xe)!==1}),at=xe,Ke=function(pt){if(qe=qe.filter(function(yt){return ne(yt,pt)!==1}),!qe.length)return at=Math.max(pt-1,xe),1},tt=xe;tt<Y.length&&!Ke(tt);tt+=1);for(var vt=[],Pt=function(pt){var yt=Y[pt];if(!yt)return 1;d.some(function(xt){return ne(xt,pt)>1})&&vt.push(pt)},ft=We;ft<=at;ft+=1)Pt(ft);var Nt=vt.map(function(Rt){var pt=Y[Rt],yt=o(pt.record,Rt),xt=function(tn){var Zt=Rt+tn-1,In=o(Y[Zt].record,Zt),Cn=Te(yt,In);return Cn.bottom-Cn.top},bt=Te(yt);return I.createElement(G$,{key:Rt,data:pt,rowKey:yt,index:Rt,style:{top:-ze+bt.top},extra:!0,getHeight:xt})});return Nt},ee=I.useMemo(function(){return{columnsOffset:te}},[te]),de="".concat(b,"-tbody"),fe=j(["body","wrapper"]),ye={};return k&&(ye.position="sticky",ye.bottom=0,Nr(k)==="object"&&k.offsetScroll&&(ye.bottom=k.offsetScroll)),I.createElement(K8.Provider,{value:ee},I.createElement(EE,{fullHeight:!1,ref:K,prefixCls:"".concat(de,"-virtual"),styles:{horizontalScrollBar:ye},className:de,height:B,itemHeight:N||24,data:Y,itemKey:function(we){return o(we.record)},component:fe,scrollWidth:P,direction:A,onVirtualScroll:function(we){var Se,xe=we.x;i({currentTarget:(Se=K.current)===null||Se===void 0?void 0:Se.nativeElement,scrollLeft:xe})},onScroll:V,extraRender:se},function(ge,we,Se){var xe=o(ge.record,we);return I.createElement(G$,{data:ge,rowKey:xe,index:we,style:Se.style})}))}),wfe=e_(bfe),Sfe=function(t,n){var i=n.ref,s=n.onScroll;return I.createElement(wfe,{ref:i,data:t,onScroll:s})};function Cfe(e,t){var n=e.data,i=e.columns,s=e.scroll,d=e.sticky,f=e.prefixCls,o=f===void 0?W8:f,y=e.className,b=e.listItemHeight,C=e.components,P=e.onScroll,A=s||{},D=A.x,k=A.y;typeof D!="number"&&(D=1),typeof k!="number"&&(k=500);var B=Io(function(V,K){return Ul(C,V)||K}),N=Io(P),j=I.useMemo(function(){return{sticky:d,scrollY:k,listItemHeight:b,getComponent:B,onScroll:N}},[d,k,b,B,N]);return I.createElement(hD.Provider,{value:j},I.createElement(n_,kn({},e,{className:St(y,"".concat(o,"-virtual")),scroll:Je(Je({},s),{},{x:D}),components:Je(Je({},C),{},{body:n!=null&&n.length?Sfe:void 0}),columns:i,internalHooks:ub,tailor:!0,ref:t})))}var Efe=I.forwardRef(Cfe);function X8(e){return L8(Efe,e)}X8();const Tfe=e=>null,Ife=e=>null;var fD=I.createContext(null),Pfe=I.createContext({}),Mfe=function(t){for(var n=t.prefixCls,i=t.level,s=t.isStart,d=t.isEnd,f="".concat(n,"-indent-unit"),o=[],y=0;y<i;y+=1)o.push(I.createElement("span",{key:y,className:St(f,ke(ke({},"".concat(f,"-start"),s[y]),"".concat(f,"-end"),d[y]))}));return I.createElement("span",{"aria-hidden":"true",className:"".concat(n,"-indent")},o)};const Rfe=I.memo(Mfe);var Afe=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],W$="open",q$="close",Ofe="---",Fx=function(t){var n,i,s,d=t.eventKey,f=t.className,o=t.style,y=t.dragOver,b=t.dragOverGapTop,C=t.dragOverGapBottom,P=t.isLeaf,A=t.isStart,D=t.isEnd,k=t.expanded,B=t.selected,N=t.checked,j=t.halfChecked,V=t.loading,K=t.domRef,Y=t.active,Z=t.data,te=t.onMouseMove,ne=t.selectable,se=ri(t,Afe),ee=Wt.useContext(fD),de=Wt.useContext(Pfe),fe=Wt.useRef(null),ye=Wt.useState(!1),ge=It(ye,2),we=ge[0],Se=ge[1],xe=!!(ee.disabled||t.disabled||(n=de.nodeDisabled)!==null&&n!==void 0&&n.call(de,Z)),Te=Wt.useMemo(function(){return!ee.checkable||t.checkable===!1?!1:ee.checkable},[ee.checkable,t.checkable]),ze=function(nn){xe||ee.onNodeSelect(nn,Ka(t))},Ue=function(nn){xe||!Te||t.disableCheckbox||ee.onNodeCheck(nn,Ka(t),!N)},We=Wt.useMemo(function(){return typeof ne=="boolean"?ne:ee.selectable},[ne,ee.selectable]),Be=function(nn){ee.onNodeClick(nn,Ka(t)),We?ze(nn):Ue(nn)},Xe=function(nn){ee.onNodeDoubleClick(nn,Ka(t))},qe=function(nn){ee.onNodeMouseEnter(nn,Ka(t))},at=function(nn){ee.onNodeMouseLeave(nn,Ka(t))},Ke=function(nn){ee.onNodeContextMenu(nn,Ka(t))},tt=Wt.useMemo(function(){return!!(ee.draggable&&(!ee.draggable.nodeDraggable||ee.draggable.nodeDraggable(Z)))},[ee.draggable,Z]),vt=function(nn){nn.stopPropagation(),Se(!0),ee.onNodeDragStart(nn,t);try{nn.dataTransfer.setData("text/plain","")}catch{}},Pt=function(nn){nn.preventDefault(),nn.stopPropagation(),ee.onNodeDragEnter(nn,t)},ft=function(nn){nn.preventDefault(),nn.stopPropagation(),ee.onNodeDragOver(nn,t)},Nt=function(nn){nn.stopPropagation(),ee.onNodeDragLeave(nn,t)},Rt=function(nn){nn.stopPropagation(),Se(!1),ee.onNodeDragEnd(nn,t)},pt=function(nn){nn.preventDefault(),nn.stopPropagation(),Se(!1),ee.onNodeDrop(nn,t)},yt=function(nn){V||ee.onNodeExpand(nn,Ka(t))},xt=Wt.useMemo(function(){var un=Il(ee.keyEntities,d)||{},nn=un.children;return!!(nn||[]).length},[ee.keyEntities,d]),bt=Wt.useMemo(function(){return P===!1?!1:P||!ee.loadData&&!xt||ee.loadData&&t.loaded&&!xt},[P,ee.loadData,xt,t.loaded]);Wt.useEffect(function(){V||typeof ee.loadData=="function"&&k&&!bt&&!t.loaded&&ee.onNodeLoad(Ka(t))},[V,ee.loadData,ee.onNodeLoad,k,bt,t]);var Ct=Wt.useMemo(function(){var un;return(un=ee.draggable)!==null&&un!==void 0&&un.icon?Wt.createElement("span",{className:"".concat(ee.prefixCls,"-draggable-icon")},ee.draggable.icon):null},[ee.draggable]),tn=function(nn){var $n=t.switcherIcon||ee.switcherIcon;return typeof $n=="function"?$n(Je(Je({},t),{},{isLeaf:nn})):$n},Zt=function(){if(bt){var nn=tn(!0);return nn!==!1?Wt.createElement("span",{className:St("".concat(ee.prefixCls,"-switcher"),"".concat(ee.prefixCls,"-switcher-noop"))},nn):null}var $n=tn(!1);return $n!==!1?Wt.createElement("span",{onClick:yt,className:St("".concat(ee.prefixCls,"-switcher"),"".concat(ee.prefixCls,"-switcher_").concat(k?W$:q$))},$n):null},In=Wt.useMemo(function(){if(!Te)return null;var un=typeof Te!="boolean"?Te:null;return Wt.createElement("span",{className:St("".concat(ee.prefixCls,"-checkbox"),ke(ke(ke({},"".concat(ee.prefixCls,"-checkbox-checked"),N),"".concat(ee.prefixCls,"-checkbox-indeterminate"),!N&&j),"".concat(ee.prefixCls,"-checkbox-disabled"),xe||t.disableCheckbox)),onClick:Ue,role:"checkbox","aria-checked":j?"mixed":N,"aria-disabled":xe||t.disableCheckbox,"aria-label":"Select ".concat(typeof t.title=="string"?t.title:"tree node")},un)},[Te,N,j,xe,t.disableCheckbox,t.title]),Cn=Wt.useMemo(function(){return bt?null:k?W$:q$},[bt,k]),Mt=Wt.useMemo(function(){return Wt.createElement("span",{className:St("".concat(ee.prefixCls,"-iconEle"),"".concat(ee.prefixCls,"-icon__").concat(Cn||"docu"),ke({},"".concat(ee.prefixCls,"-icon_loading"),V))})},[ee.prefixCls,Cn,V]),hn=Wt.useMemo(function(){var un=!!ee.draggable,nn=!t.disabled&&un&&ee.dragOverNodeKey===d;return nn?ee.dropIndicatorRender({dropPosition:ee.dropPosition,dropLevelOffset:ee.dropLevelOffset,indent:ee.indent,prefixCls:ee.prefixCls,direction:ee.direction}):null},[ee.dropPosition,ee.dropLevelOffset,ee.indent,ee.prefixCls,ee.direction,ee.draggable,ee.dragOverNodeKey,ee.dropIndicatorRender]),Jt=Wt.useMemo(function(){var un=t.title,nn=un===void 0?Ofe:un,$n="".concat(ee.prefixCls,"-node-content-wrapper"),Ln;if(ee.showIcon){var qn=t.icon||ee.icon;Ln=qn?Wt.createElement("span",{className:St("".concat(ee.prefixCls,"-iconEle"),"".concat(ee.prefixCls,"-icon__customize"))},typeof qn=="function"?qn(t):qn):Mt}else ee.loadData&&V&&(Ln=Mt);var er;return typeof nn=="function"?er=nn(Z):ee.titleRender?er=ee.titleRender(Z):er=nn,Wt.createElement("span",{ref:fe,title:typeof nn=="string"?nn:"",className:St($n,"".concat($n,"-").concat(Cn||"normal"),ke({},"".concat(ee.prefixCls,"-node-selected"),!xe&&(B||we))),onMouseEnter:qe,onMouseLeave:at,onContextMenu:Ke,onClick:Be,onDoubleClick:Xe},Ln,Wt.createElement("span",{className:"".concat(ee.prefixCls,"-title")},er),hn)},[ee.prefixCls,ee.showIcon,t,ee.icon,Mt,ee.titleRender,Z,Cn,qe,at,Ke,Be,Xe]),Ut=Jc(se,{aria:!0,data:!0}),Tn=Il(ee.keyEntities,d)||{},On=Tn.level,Kn=D[D.length-1],Un=!xe&&tt,Pn=ee.draggingNodeKey===d,Qn=ne!==void 0?{"aria-selected":!!ne}:void 0;return Wt.createElement("div",kn({ref:K,role:"treeitem","aria-expanded":P?void 0:k,className:St(f,"".concat(ee.prefixCls,"-treenode"),(s={},ke(ke(ke(ke(ke(ke(ke(ke(ke(ke(s,"".concat(ee.prefixCls,"-treenode-disabled"),xe),"".concat(ee.prefixCls,"-treenode-switcher-").concat(k?"open":"close"),!P),"".concat(ee.prefixCls,"-treenode-checkbox-checked"),N),"".concat(ee.prefixCls,"-treenode-checkbox-indeterminate"),j),"".concat(ee.prefixCls,"-treenode-selected"),B),"".concat(ee.prefixCls,"-treenode-loading"),V),"".concat(ee.prefixCls,"-treenode-active"),Y),"".concat(ee.prefixCls,"-treenode-leaf-last"),Kn),"".concat(ee.prefixCls,"-treenode-draggable"),tt),"dragging",Pn),ke(ke(ke(ke(ke(ke(ke(s,"drop-target",ee.dropTargetKey===d),"drop-container",ee.dropContainerKey===d),"drag-over",!xe&&y),"drag-over-gap-top",!xe&&b),"drag-over-gap-bottom",!xe&&C),"filter-node",(i=ee.filterTreeNode)===null||i===void 0?void 0:i.call(ee,Ka(t))),"".concat(ee.prefixCls,"-treenode-leaf"),bt))),style:o,draggable:Un,onDragStart:Un?vt:void 0,onDragEnter:tt?Pt:void 0,onDragOver:tt?ft:void 0,onDragLeave:tt?Nt:void 0,onDrop:tt?pt:void 0,onDragEnd:tt?Rt:void 0,onMouseMove:te},Qn,Ut),Wt.createElement(Rfe,{prefixCls:ee.prefixCls,level:On,isStart:A,isEnd:D}),Ct,Zt(),In,Jt)};Fx.isTreeNode=1;function Cu(e,t){if(!e)return[];var n=e.slice(),i=n.indexOf(t);return i>=0&&n.splice(i,1),n}function yd(e,t){var n=(e||[]).slice();return n.indexOf(t)===-1&&n.push(t),n}function pD(e){return e.split("-")}function Dfe(e,t){var n=[],i=Il(t,e);function s(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];d.forEach(function(f){var o=f.key,y=f.children;n.push(o),s(y)})}return s(i.children),n}function Lfe(e){if(e.parent){var t=pD(e.pos);return Number(t[t.length-1])===e.parent.children.length-1}return!1}function zfe(e){var t=pD(e.pos);return Number(t[t.length-1])===0}function K$(e,t,n,i,s,d,f,o,y,b){var C,P=e.clientX,A=e.clientY,D=e.target.getBoundingClientRect(),k=D.top,B=D.height,N=(b==="rtl"?-1:1)*(((s==null?void 0:s.x)||0)-P),j=(N-12)/i,V=y.filter(function(xe){var Te;return(Te=o[xe])===null||Te===void 0||(Te=Te.children)===null||Te===void 0?void 0:Te.length}),K=Il(o,n.eventKey);if(A<k+B/2){var Y=f.findIndex(function(xe){return xe.key===K.key}),Z=Y<=0?0:Y-1,te=f[Z].key;K=Il(o,te)}var ne=K.key,se=K,ee=K.key,de=0,fe=0;if(!V.includes(ne))for(var ye=0;ye<j&&Lfe(K);ye+=1)K=K.parent,fe+=1;var ge=t.data,we=K.node,Se=!0;return zfe(K)&&K.level===0&&A<k+B/2&&d({dragNode:ge,dropNode:we,dropPosition:-1})&&K.key===n.eventKey?de=-1:(se.children||[]).length&&V.includes(ee)?d({dragNode:ge,dropNode:we,dropPosition:0})?de=0:Se=!1:fe===0?j>-1.5?d({dragNode:ge,dropNode:we,dropPosition:1})?de=1:Se=!1:d({dragNode:ge,dropNode:we,dropPosition:0})?de=0:d({dragNode:ge,dropNode:we,dropPosition:1})?de=1:Se=!1:d({dragNode:ge,dropNode:we,dropPosition:1})?de=1:Se=!1,{dropPosition:de,dropLevelOffset:fe,dropTargetKey:K.key,dropTargetPos:K.pos,dragOverNodeKey:ee,dropContainerKey:de===0?null:((C=K.parent)===null||C===void 0?void 0:C.key)||null,dropAllowed:Se}}function X$(e,t){if(e){var n=t.multiple;return n?e.slice():e.length?[e[0]]:e}}function sP(e){if(!e)return null;var t;if(Array.isArray(e))t={checkedKeys:e,halfCheckedKeys:void 0};else if(Nr(e)==="object")t={checkedKeys:e.checked||void 0,halfCheckedKeys:e.halfChecked||void 0};else return oa(!1,"`checkedKeys` is not an array or an object"),null;return t}function kR(e,t){var n=new Set;function i(s){if(!n.has(s)){var d=Il(t,s);if(d){n.add(s);var f=d.parent,o=d.node;o.disabled||f&&i(f.key)}}}return(e||[]).forEach(function(s){i(s)}),zn(n)}function kfe(e){const[t,n]=I.useState(null);return[I.useCallback((d,f,o)=>{const y=t??d,b=Math.min(y||0,d),C=Math.max(y||0,d),P=f.slice(b,C+1).map(k=>e(k)),A=P.some(k=>!o.has(k)),D=[];return P.forEach(k=>{A?(o.has(k)||D.push(k),o.add(k)):(o.delete(k),D.push(k))}),n(A?C:null),D},[t]),d=>{n(d)}]}const Lh={},FR="SELECT_ALL",NR="SELECT_INVERT",BR="SELECT_NONE",Z$=[],Z8=(e,t,n=[])=>((t||[]).forEach(i=>{n.push(i),i&&typeof i=="object"&&e in i&&Z8(e,i[e],n)}),n),Ffe=(e,t)=>{const{preserveSelectedRowKeys:n,selectedRowKeys:i,defaultSelectedRowKeys:s,getCheckboxProps:d,getTitleCheckboxProps:f,onChange:o,onSelect:y,onSelectAll:b,onSelectInvert:C,onSelectNone:P,onSelectMultiple:A,columnWidth:D,type:k,selections:B,fixed:N,renderCell:j,hideSelectAll:V,checkStrictly:K=!0}=t||{},{prefixCls:Y,data:Z,pageData:te,getRecordByKey:ne,getRowKey:se,expandType:ee,childrenColumnName:de,locale:fe,getPopupContainer:ye}=e,ge=qv(),[we,Se]=kfe(pt=>pt),[xe,Te]=is(i||s||Z$,{value:i}),ze=I.useRef(new Map),Ue=I.useCallback(pt=>{if(n){const yt=new Map;pt.forEach(xt=>{let bt=ne(xt);!bt&&ze.current.has(xt)&&(bt=ze.current.get(xt)),yt.set(xt,bt)}),ze.current=yt}},[ne,n]);I.useEffect(()=>{Ue(xe)},[xe]);const We=I.useMemo(()=>Z8(de,te),[de,te]),{keyEntities:Be}=I.useMemo(()=>{if(K)return{keyEntities:null};let pt=Z;if(n){const yt=new Set(We.map((bt,Ct)=>se(bt,Ct))),xt=Array.from(ze.current).reduce((bt,[Ct,tn])=>yt.has(Ct)?bt:bt.concat(tn),[]);pt=[].concat(zn(pt),zn(xt))}return aD(pt,{externalGetKey:se,childrenPropName:de})},[Z,se,K,de,n,We]),Xe=I.useMemo(()=>{const pt=new Map;return We.forEach((yt,xt)=>{const bt=se(yt,xt),Ct=(d?d(yt):null)||{};pt.set(bt,Ct)}),pt},[We,se,d]),qe=I.useCallback(pt=>{const yt=se(pt);let xt;return Xe.has(yt)?xt=Xe.get(se(pt)):xt=d?d(pt):void 0,!!(xt!=null&&xt.disabled)},[Xe,se]),[at,Ke]=I.useMemo(()=>{if(K)return[xe||[],[]];const{checkedKeys:pt,halfCheckedKeys:yt}=yv(xe,!0,Be,qe);return[pt||[],yt]},[xe,K,Be,qe]),tt=I.useMemo(()=>{const pt=k==="radio"?at.slice(0,1):at;return new Set(pt)},[at,k]),vt=I.useMemo(()=>k==="radio"?new Set:new Set(Ke),[Ke,k]);I.useEffect(()=>{t||Te(Z$)},[!!t]);const Pt=I.useCallback((pt,yt)=>{let xt,bt;Ue(pt),n?(xt=pt,bt=pt.map(Ct=>ze.current.get(Ct))):(xt=[],bt=[],pt.forEach(Ct=>{const tn=ne(Ct);tn!==void 0&&(xt.push(Ct),bt.push(tn))})),Te(xt),o==null||o(xt,bt,{type:yt})},[Te,ne,o,n]),ft=I.useCallback((pt,yt,xt,bt)=>{if(y){const Ct=xt.map(tn=>ne(tn));y(ne(pt),yt,Ct,bt)}Pt(xt,"single")},[y,ne,Pt]),Nt=I.useMemo(()=>!B||V?null:(B===!0?[FR,NR,BR]:B).map(yt=>yt===FR?{key:"all",text:fe.selectionAll,onSelect(){Pt(Z.map((xt,bt)=>se(xt,bt)).filter(xt=>{const bt=Xe.get(xt);return!(bt!=null&&bt.disabled)||tt.has(xt)}),"all")}}:yt===NR?{key:"invert",text:fe.selectInvert,onSelect(){const xt=new Set(tt);te.forEach((Ct,tn)=>{const Zt=se(Ct,tn),In=Xe.get(Zt);In!=null&&In.disabled||(xt.has(Zt)?xt.delete(Zt):xt.add(Zt))});const bt=Array.from(xt);C&&(ge.deprecated(!1,"onSelectInvert","onChange"),C(bt)),Pt(bt,"invert")}}:yt===BR?{key:"none",text:fe.selectNone,onSelect(){P==null||P(),Pt(Array.from(tt).filter(xt=>{const bt=Xe.get(xt);return bt==null?void 0:bt.disabled}),"none")}}:yt).map(yt=>Object.assign(Object.assign({},yt),{onSelect:(...xt)=>{var bt,Ct;(Ct=yt.onSelect)===null||Ct===void 0||(bt=Ct).call.apply(bt,[yt].concat(xt)),Se(null)}})),[B,tt,te,se,C,Pt]);return[I.useCallback(pt=>{var yt;if(!t)return pt.filter(un=>un!==Lh);let xt=zn(pt);const bt=new Set(tt),Ct=We.map(se).filter(un=>!Xe.get(un).disabled),tn=Ct.every(un=>bt.has(un)),Zt=Ct.some(un=>bt.has(un)),In=()=>{const un=[];tn?Ct.forEach($n=>{bt.delete($n),un.push($n)}):Ct.forEach($n=>{bt.has($n)||(bt.add($n),un.push($n))});const nn=Array.from(bt);b==null||b(!tn,nn.map($n=>ne($n)),un.map($n=>ne($n))),Pt(nn,"all"),Se(null)};let Cn,Mt;if(k!=="radio"){let un;if(Nt){const Ir={getPopupContainer:ye,items:Nt.map((_r,$r)=>{const{key:mr,text:yi,onSelect:Vr}=_r;return{key:mr??$r,onClick:()=>{Vr==null||Vr(Ct)},label:yi}})};un=I.createElement("div",{className:`${Y}-selection-extra`},I.createElement(AE,{menu:Ir,getPopupContainer:ye},I.createElement("span",null,I.createElement(PH,null))))}const nn=We.map((Ir,_r)=>{const $r=se(Ir,_r),mr=Xe.get($r)||{};return Object.assign({checked:bt.has($r)},mr)}).filter(({disabled:Ir})=>Ir),$n=!!nn.length&&nn.length===We.length,Ln=$n&&nn.every(({checked:Ir})=>Ir),qn=$n&&nn.some(({checked:Ir})=>Ir),er=(f==null?void 0:f())||{},{onChange:tr,disabled:Jn}=er;Mt=I.createElement(Au,Object.assign({"aria-label":un?"Custom selection":"Select all"},er,{checked:$n?Ln:!!We.length&&tn,indeterminate:$n?!Ln&&qn:!tn&&Zt,onChange:Ir=>{In(),tr==null||tr(Ir)},disabled:Jn??(We.length===0||$n),skipGroup:!0})),Cn=!V&&I.createElement("div",{className:`${Y}-selection`},Mt,un)}let hn;k==="radio"?hn=(un,nn,$n)=>{const Ln=se(nn,$n),qn=bt.has(Ln),er=Xe.get(Ln);return{node:I.createElement(lb,Object.assign({},er,{checked:qn,onClick:tr=>{var Jn;tr.stopPropagation(),(Jn=er==null?void 0:er.onClick)===null||Jn===void 0||Jn.call(er,tr)},onChange:tr=>{var Jn;bt.has(Ln)||ft(Ln,!0,[Ln],tr.nativeEvent),(Jn=er==null?void 0:er.onChange)===null||Jn===void 0||Jn.call(er,tr)}})),checked:qn}}:hn=(un,nn,$n)=>{var Ln;const qn=se(nn,$n),er=bt.has(qn),tr=vt.has(qn),Jn=Xe.get(qn);let Ir;return ee==="nest"?Ir=tr:Ir=(Ln=Jn==null?void 0:Jn.indeterminate)!==null&&Ln!==void 0?Ln:tr,{node:I.createElement(Au,Object.assign({},Jn,{indeterminate:Ir,checked:er,skipGroup:!0,onClick:_r=>{var $r;_r.stopPropagation(),($r=Jn==null?void 0:Jn.onClick)===null||$r===void 0||$r.call(Jn,_r)},onChange:_r=>{var $r;const{nativeEvent:mr}=_r,{shiftKey:yi}=mr,Vr=Ct.indexOf(qn),Kr=at.some(Rr=>Ct.includes(Rr));if(yi&&K&&Kr){const Rr=we(Vr,Ct,bt),ii=Array.from(bt);A==null||A(!er,ii.map(Hr=>ne(Hr)),Rr.map(Hr=>ne(Hr))),Pt(ii,"multiple")}else{const Rr=at;if(K){const ii=er?Cu(Rr,qn):yd(Rr,qn);ft(qn,!er,ii,mr)}else{const ii=yv([].concat(zn(Rr),[qn]),!0,Be,qe),{checkedKeys:Hr,halfCheckedKeys:ut}=ii;let ur=Hr;if(er){const fr=new Set(Hr);fr.delete(qn),ur=yv(Array.from(fr),{halfCheckedKeys:ut},Be,qe).checkedKeys}ft(qn,!er,ur,mr)}}Se(er?null:Vr),($r=Jn==null?void 0:Jn.onChange)===null||$r===void 0||$r.call(Jn,_r)}})),checked:er}};const Jt=(un,nn,$n)=>{const{node:Ln,checked:qn}=hn(un,nn,$n);return j?j(qn,nn,$n,Ln):Ln};if(!xt.includes(Lh))if(xt.findIndex(un=>{var nn;return((nn=un[K0])===null||nn===void 0?void 0:nn.columnType)==="EXPAND_COLUMN"})===0){const[un,...nn]=xt;xt=[un,Lh].concat(zn(nn))}else xt=[Lh].concat(zn(xt));const Ut=xt.indexOf(Lh);xt=xt.filter((un,nn)=>un!==Lh||nn===Ut);const Tn=xt[Ut-1],On=xt[Ut+1];let Kn=N;Kn===void 0&&((On==null?void 0:On.fixed)!==void 0?Kn=On.fixed:(Tn==null?void 0:Tn.fixed)!==void 0&&(Kn=Tn.fixed)),Kn&&Tn&&((yt=Tn[K0])===null||yt===void 0?void 0:yt.columnType)==="EXPAND_COLUMN"&&Tn.fixed===void 0&&(Tn.fixed=Kn);const Un=St(`${Y}-selection-col`,{[`${Y}-selection-col-with-dropdown`]:B&&k==="checkbox"}),Pn=()=>t!=null&&t.columnTitle?typeof t.columnTitle=="function"?t.columnTitle(Mt):t.columnTitle:Cn,Qn={fixed:Kn,width:D,className:`${Y}-selection-column`,title:Pn(),render:Jt,onCell:t.onCell,align:t.align,[K0]:{className:Un}};return xt.map(un=>un===Lh?Qn:un)},[se,We,t,at,tt,vt,D,Nt,ee,Xe,A,ft,qe]),tt]};function Nfe(e,t){return e._antProxy=e._antProxy||{},Object.keys(t).forEach(n=>{if(!(n in e._antProxy)){const i=e[n];e._antProxy[n]=i,e[n]=t[n]}}),e}function Bfe(e,t){return I.useImperativeHandle(e,()=>{const n=t(),{nativeElement:i}=n;return typeof Proxy<"u"?new Proxy(i,{get(s,d){return n[d]?n[d]:Reflect.get(s,d)}}):Nfe(i,n)})}function $fe(e){return t=>{const{prefixCls:n,onExpand:i,record:s,expanded:d,expandable:f}=t,o=`${n}-row-expand-icon`;return I.createElement("button",{type:"button",onClick:y=>{i(s,y),y.stopPropagation()},className:St(o,{[`${o}-spaced`]:!f,[`${o}-expanded`]:f&&d,[`${o}-collapsed`]:f&&!d}),"aria-label":d?e.collapse:e.expand,"aria-expanded":d})}}function jfe(e){return(n,i)=>{const s=n.querySelector(`.${e}-container`);let d=i;if(s){const f=getComputedStyle(s),o=Number.parseInt(f.borderLeftWidth,10),y=Number.parseInt(f.borderRightWidth,10);d=i-o-y}return d}}const mf=(e,t)=>"key"in e&&e.key!==void 0&&e.key!==null?e.key:e.dataIndex?Array.isArray(e.dataIndex)?e.dataIndex.join("."):e.dataIndex:t;function r_(e,t){return t?`${t}-${e}`:`${e}`}const LE=(e,t)=>typeof e=="function"?e(t):e,Vfe=(e,t)=>{const n=LE(e,t);return Object.prototype.toString.call(n)==="[object Object]"?"":n};var Ufe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z"}}]},name:"filter",theme:"filled"},Hfe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Ufe}))},Gfe=I.forwardRef(Hfe);function Wfe(e){const t=I.useRef(e),n=AH();return[()=>t.current,i=>{t.current=i,n()}]}var qfe=function(t){var n=t.dropPosition,i=t.dropLevelOffset,s=t.indent,d={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(n){case-1:d.top=0,d.left=-i*s;break;case 1:d.bottom=0,d.left=-i*s;break;case 0:d.bottom=0,d.left=s;break}return Wt.createElement("div",{style:d})};function Y8(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Kfe(e,t){var n=I.useState(!1),i=It(n,2),s=i[0],d=i[1];yo(function(){if(s)return e(),function(){t()}},[s]),yo(function(){return d(!0),function(){d(!1)}},[])}var Xfe=["className","style","motion","motionNodes","motionType","onMotionStart","onMotionEnd","active","treeNodeRequiredProps"],Zfe=I.forwardRef(function(e,t){var n=e.className,i=e.style,s=e.motion,d=e.motionNodes,f=e.motionType,o=e.onMotionStart,y=e.onMotionEnd,b=e.active,C=e.treeNodeRequiredProps,P=ri(e,Xfe),A=I.useState(!0),D=It(A,2),k=D[0],B=D[1],N=I.useContext(fD),j=N.prefixCls,V=d&&f!=="hide";yo(function(){d&&V!==k&&B(V)},[d]);var K=function(){d&&o()},Y=I.useRef(!1),Z=function(){d&&!Y.current&&(Y.current=!0,y())};Kfe(K,Z);var te=function(se){V===se&&Z()};return d?I.createElement(wf,kn({ref:t,visible:k},s,{motionAppear:f==="show",onVisibleChanged:te}),function(ne,se){var ee=ne.className,de=ne.style;return I.createElement("div",{ref:se,className:St("".concat(j,"-treenode-motion"),ee),style:de},d.map(function(fe){var ye=Object.assign({},(Y8(fe.data),fe.data)),ge=fe.title,we=fe.key,Se=fe.isStart,xe=fe.isEnd;delete ye.children;var Te=q0(we,C);return I.createElement(Fx,kn({},ye,Te,{title:ge,active:b,data:fe.data,key:we,isStart:Se,isEnd:xe}))}))}):I.createElement(Fx,kn({domRef:t,className:n,style:i},P,{active:b}))});function Yfe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=e.length,i=t.length;if(Math.abs(n-i)!==1)return{add:!1,key:null};function s(d,f){var o=new Map;d.forEach(function(b){o.set(b,!0)});var y=f.filter(function(b){return!o.has(b)});return y.length===1?y[0]:null}return n<i?{add:!0,key:s(e,t)}:{add:!1,key:s(t,e)}}function Y$(e,t,n){var i=e.findIndex(function(o){return o.key===n}),s=e[i+1],d=t.findIndex(function(o){return o.key===n});if(s){var f=t.findIndex(function(o){return o.key===s.key});return t.slice(d+1,f)}return t.slice(d+1)}var Jfe=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","scrollWidth","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],J$={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Qfe=function(){},Zp="RC_TREE_MOTION_".concat(Math.random()),$R={key:Zp},J8={key:Zp,level:0,index:0,pos:"0",node:$R,nodes:[$R]},Q$={parent:null,children:[],pos:J8.pos,data:$R,title:null,key:Zp,isStart:[],isEnd:[]};function e5(e,t,n,i){return t===!1||!n?e:e.slice(0,Math.ceil(n/i)+1)}function t5(e){var t=e.key,n=e.pos;return cb(t,n)}function epe(e){for(var t=String(e.data.key),n=e;n.parent;)n=n.parent,t="".concat(n.data.key," > ").concat(t);return t}var tpe=I.forwardRef(function(e,t){var n=e.prefixCls,i=e.data;e.selectable,e.checkable;var s=e.expandedKeys,d=e.selectedKeys,f=e.checkedKeys,o=e.loadedKeys,y=e.loadingKeys,b=e.halfCheckedKeys,C=e.keyEntities,P=e.disabled,A=e.dragging,D=e.dragOverNodeKey,k=e.dropPosition,B=e.motion,N=e.height,j=e.itemHeight,V=e.virtual,K=e.scrollWidth,Y=e.focusable,Z=e.activeItem,te=e.focused,ne=e.tabIndex,se=e.onKeyDown,ee=e.onFocus,de=e.onBlur,fe=e.onActiveChange,ye=e.onListChangeStart,ge=e.onListChangeEnd,we=ri(e,Jfe),Se=I.useRef(null),xe=I.useRef(null);I.useImperativeHandle(t,function(){return{scrollTo:function(hn){Se.current.scrollTo(hn)},getIndentWidth:function(){return xe.current.offsetWidth}}});var Te=I.useState(s),ze=It(Te,2),Ue=ze[0],We=ze[1],Be=I.useState(i),Xe=It(Be,2),qe=Xe[0],at=Xe[1],Ke=I.useState(i),tt=It(Ke,2),vt=tt[0],Pt=tt[1],ft=I.useState([]),Nt=It(ft,2),Rt=Nt[0],pt=Nt[1],yt=I.useState(null),xt=It(yt,2),bt=xt[0],Ct=xt[1],tn=I.useRef(i);tn.current=i;function Zt(){var Mt=tn.current;at(Mt),Pt(Mt),pt([]),Ct(null),ge()}yo(function(){We(s);var Mt=Yfe(Ue,s);if(Mt.key!==null)if(Mt.add){var hn=qe.findIndex(function(Un){var Pn=Un.key;return Pn===Mt.key}),Jt=e5(Y$(qe,i,Mt.key),V,N,j),Ut=qe.slice();Ut.splice(hn+1,0,Q$),Pt(Ut),pt(Jt),Ct("show")}else{var Tn=i.findIndex(function(Un){var Pn=Un.key;return Pn===Mt.key}),On=e5(Y$(i,qe,Mt.key),V,N,j),Kn=i.slice();Kn.splice(Tn+1,0,Q$),Pt(Kn),pt(On),Ct("hide")}else qe!==i&&(at(i),Pt(i))},[s,i]),I.useEffect(function(){A||Zt()},[A]);var In=B?vt:i,Cn={expandedKeys:s,selectedKeys:d,loadedKeys:o,loadingKeys:y,checkedKeys:f,halfCheckedKeys:b,dragOverNodeKey:D,dropPosition:k,keyEntities:C};return I.createElement(I.Fragment,null,te&&Z&&I.createElement("span",{style:J$,"aria-live":"assertive"},epe(Z)),I.createElement("div",null,I.createElement("input",{style:J$,disabled:Y===!1||P,tabIndex:Y!==!1?ne:null,onKeyDown:se,onFocus:ee,onBlur:de,value:"",onChange:Qfe,"aria-label":"for screen reader"})),I.createElement("div",{className:"".concat(n,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},I.createElement("div",{className:"".concat(n,"-indent")},I.createElement("div",{ref:xe,className:"".concat(n,"-indent-unit")}))),I.createElement(EE,kn({},we,{data:In,itemKey:t5,height:N,fullHeight:!1,virtual:V,itemHeight:j,scrollWidth:K,prefixCls:"".concat(n,"-list"),ref:Se,role:"tree",onVisibleChange:function(hn){hn.every(function(Jt){return t5(Jt)!==Zp})&&Zt()}}),function(Mt){var hn=Mt.pos,Jt=Object.assign({},(Y8(Mt.data),Mt.data)),Ut=Mt.title,Tn=Mt.key,On=Mt.isStart,Kn=Mt.isEnd,Un=cb(Tn,hn);delete Jt.key,delete Jt.children;var Pn=q0(Un,Cn);return I.createElement(Zfe,kn({},Jt,Pn,{title:Ut,active:!!Z&&Tn===Z.key,pos:hn,data:Mt.data,isStart:On,isEnd:Kn,motion:B,motionNodes:Tn===Zp?Rt:null,motionType:bt,onMotionStart:ye,onMotionEnd:Zt,treeNodeRequiredProps:Cn,onMouseMove:function(){fe(null)}}))}))}),npe=10,mD=function(e){Uu(n,e);var t=Hu(n);function n(){var i;ja(this,n);for(var s=arguments.length,d=new Array(s),f=0;f<s;f++)d[f]=arguments[f];return i=t.call.apply(t,[this].concat(d)),ke(Mr(i),"destroyed",!1),ke(Mr(i),"delayedDragEnterLogic",void 0),ke(Mr(i),"loadingRetryTimes",{}),ke(Mr(i),"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:zv()}),ke(Mr(i),"dragStartMousePosition",null),ke(Mr(i),"dragNodeProps",null),ke(Mr(i),"currentMouseOverDroppableNodeKey",null),ke(Mr(i),"listRef",I.createRef()),ke(Mr(i),"onNodeDragStart",function(o,y){var b=i.state,C=b.expandedKeys,P=b.keyEntities,A=i.props.onDragStart,D=y.eventKey;i.dragNodeProps=y,i.dragStartMousePosition={x:o.clientX,y:o.clientY};var k=Cu(C,D);i.setState({draggingNodeKey:D,dragChildrenKeys:Dfe(D,P),indent:i.listRef.current.getIndentWidth()}),i.setExpandedKeys(k),window.addEventListener("dragend",i.onWindowDragEnd),A==null||A({event:o,node:Ka(y)})}),ke(Mr(i),"onNodeDragEnter",function(o,y){var b=i.state,C=b.expandedKeys,P=b.keyEntities,A=b.dragChildrenKeys,D=b.flattenNodes,k=b.indent,B=i.props,N=B.onDragEnter,j=B.onExpand,V=B.allowDrop,K=B.direction,Y=y.pos,Z=y.eventKey;if(i.currentMouseOverDroppableNodeKey!==Z&&(i.currentMouseOverDroppableNodeKey=Z),!i.dragNodeProps){i.resetDragState();return}var te=K$(o,i.dragNodeProps,y,k,i.dragStartMousePosition,V,D,P,C,K),ne=te.dropPosition,se=te.dropLevelOffset,ee=te.dropTargetKey,de=te.dropContainerKey,fe=te.dropTargetPos,ye=te.dropAllowed,ge=te.dragOverNodeKey;if(A.includes(ee)||!ye){i.resetDragState();return}if(i.delayedDragEnterLogic||(i.delayedDragEnterLogic={}),Object.keys(i.delayedDragEnterLogic).forEach(function(we){clearTimeout(i.delayedDragEnterLogic[we])}),i.dragNodeProps.eventKey!==y.eventKey&&(o.persist(),i.delayedDragEnterLogic[Y]=window.setTimeout(function(){if(i.state.draggingNodeKey!==null){var we=zn(C),Se=Il(P,y.eventKey);Se&&(Se.children||[]).length&&(we=yd(C,y.eventKey)),i.props.hasOwnProperty("expandedKeys")||i.setExpandedKeys(we),j==null||j(we,{node:Ka(y),expanded:!0,nativeEvent:o.nativeEvent})}},800)),i.dragNodeProps.eventKey===ee&&se===0){i.resetDragState();return}i.setState({dragOverNodeKey:ge,dropPosition:ne,dropLevelOffset:se,dropTargetKey:ee,dropContainerKey:de,dropTargetPos:fe,dropAllowed:ye}),N==null||N({event:o,node:Ka(y),expandedKeys:C})}),ke(Mr(i),"onNodeDragOver",function(o,y){var b=i.state,C=b.dragChildrenKeys,P=b.flattenNodes,A=b.keyEntities,D=b.expandedKeys,k=b.indent,B=i.props,N=B.onDragOver,j=B.allowDrop,V=B.direction;if(i.dragNodeProps){var K=K$(o,i.dragNodeProps,y,k,i.dragStartMousePosition,j,P,A,D,V),Y=K.dropPosition,Z=K.dropLevelOffset,te=K.dropTargetKey,ne=K.dropContainerKey,se=K.dropTargetPos,ee=K.dropAllowed,de=K.dragOverNodeKey;C.includes(te)||!ee||(i.dragNodeProps.eventKey===te&&Z===0?i.state.dropPosition===null&&i.state.dropLevelOffset===null&&i.state.dropTargetKey===null&&i.state.dropContainerKey===null&&i.state.dropTargetPos===null&&i.state.dropAllowed===!1&&i.state.dragOverNodeKey===null||i.resetDragState():Y===i.state.dropPosition&&Z===i.state.dropLevelOffset&&te===i.state.dropTargetKey&&ne===i.state.dropContainerKey&&se===i.state.dropTargetPos&&ee===i.state.dropAllowed&&de===i.state.dragOverNodeKey||i.setState({dropPosition:Y,dropLevelOffset:Z,dropTargetKey:te,dropContainerKey:ne,dropTargetPos:se,dropAllowed:ee,dragOverNodeKey:de}),N==null||N({event:o,node:Ka(y)}))}}),ke(Mr(i),"onNodeDragLeave",function(o,y){i.currentMouseOverDroppableNodeKey===y.eventKey&&!o.currentTarget.contains(o.relatedTarget)&&(i.resetDragState(),i.currentMouseOverDroppableNodeKey=null);var b=i.props.onDragLeave;b==null||b({event:o,node:Ka(y)})}),ke(Mr(i),"onWindowDragEnd",function(o){i.onNodeDragEnd(o,null,!0),window.removeEventListener("dragend",i.onWindowDragEnd)}),ke(Mr(i),"onNodeDragEnd",function(o,y){var b=i.props.onDragEnd;i.setState({dragOverNodeKey:null}),i.cleanDragState(),b==null||b({event:o,node:Ka(y)}),i.dragNodeProps=null,window.removeEventListener("dragend",i.onWindowDragEnd)}),ke(Mr(i),"onNodeDrop",function(o,y){var b,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=i.state,A=P.dragChildrenKeys,D=P.dropPosition,k=P.dropTargetKey,B=P.dropTargetPos,N=P.dropAllowed;if(N){var j=i.props.onDrop;if(i.setState({dragOverNodeKey:null}),i.cleanDragState(),k!==null){var V=Je(Je({},q0(k,i.getTreeNodeRequiredProps())),{},{active:((b=i.getActiveItem())===null||b===void 0?void 0:b.key)===k,data:Il(i.state.keyEntities,k).node}),K=A.includes(k);oa(!K,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");var Y=pD(B),Z={event:o,node:Ka(V),dragNode:i.dragNodeProps?Ka(i.dragNodeProps):null,dragNodesKeys:[i.dragNodeProps.eventKey].concat(A),dropToGap:D!==0,dropPosition:D+Number(Y[Y.length-1])};C||j==null||j(Z),i.dragNodeProps=null}}}),ke(Mr(i),"cleanDragState",function(){var o=i.state.draggingNodeKey;o!==null&&i.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),i.dragStartMousePosition=null,i.currentMouseOverDroppableNodeKey=null}),ke(Mr(i),"triggerExpandActionExpand",function(o,y){var b=i.state,C=b.expandedKeys,P=b.flattenNodes,A=y.expanded,D=y.key,k=y.isLeaf;if(!(k||o.shiftKey||o.metaKey||o.ctrlKey)){var B=P.filter(function(j){return j.key===D})[0],N=Ka(Je(Je({},q0(D,i.getTreeNodeRequiredProps())),{},{data:B.data}));i.setExpandedKeys(A?Cu(C,D):yd(C,D)),i.onNodeExpand(o,N)}}),ke(Mr(i),"onNodeClick",function(o,y){var b=i.props,C=b.onClick,P=b.expandAction;P==="click"&&i.triggerExpandActionExpand(o,y),C==null||C(o,y)}),ke(Mr(i),"onNodeDoubleClick",function(o,y){var b=i.props,C=b.onDoubleClick,P=b.expandAction;P==="doubleClick"&&i.triggerExpandActionExpand(o,y),C==null||C(o,y)}),ke(Mr(i),"onNodeSelect",function(o,y){var b=i.state.selectedKeys,C=i.state,P=C.keyEntities,A=C.fieldNames,D=i.props,k=D.onSelect,B=D.multiple,N=y.selected,j=y[A.key],V=!N;V?B?b=yd(b,j):b=[j]:b=Cu(b,j);var K=b.map(function(Y){var Z=Il(P,Y);return Z?Z.node:null}).filter(Boolean);i.setUncontrolledState({selectedKeys:b}),k==null||k(b,{event:"select",selected:V,node:y,selectedNodes:K,nativeEvent:o.nativeEvent})}),ke(Mr(i),"onNodeCheck",function(o,y,b){var C=i.state,P=C.keyEntities,A=C.checkedKeys,D=C.halfCheckedKeys,k=i.props,B=k.checkStrictly,N=k.onCheck,j=y.key,V,K={event:"check",node:y,checked:b,nativeEvent:o.nativeEvent};if(B){var Y=b?yd(A,j):Cu(A,j),Z=Cu(D,j);V={checked:Y,halfChecked:Z},K.checkedNodes=Y.map(function(fe){return Il(P,fe)}).filter(Boolean).map(function(fe){return fe.node}),i.setUncontrolledState({checkedKeys:Y})}else{var te=yv([].concat(zn(A),[j]),!0,P),ne=te.checkedKeys,se=te.halfCheckedKeys;if(!b){var ee=new Set(ne);ee.delete(j);var de=yv(Array.from(ee),{halfCheckedKeys:se},P);ne=de.checkedKeys,se=de.halfCheckedKeys}V=ne,K.checkedNodes=[],K.checkedNodesPositions=[],K.halfCheckedKeys=se,ne.forEach(function(fe){var ye=Il(P,fe);if(ye){var ge=ye.node,we=ye.pos;K.checkedNodes.push(ge),K.checkedNodesPositions.push({node:ge,pos:we})}}),i.setUncontrolledState({checkedKeys:ne},!1,{halfCheckedKeys:se})}N==null||N(V,K)}),ke(Mr(i),"onNodeLoad",function(o){var y,b=o.key,C=i.state.keyEntities,P=Il(C,b);if(!(P!=null&&(y=P.children)!==null&&y!==void 0&&y.length)){var A=new Promise(function(D,k){i.setState(function(B){var N=B.loadedKeys,j=N===void 0?[]:N,V=B.loadingKeys,K=V===void 0?[]:V,Y=i.props,Z=Y.loadData,te=Y.onLoad;if(!Z||j.includes(b)||K.includes(b))return null;var ne=Z(o);return ne.then(function(){var se=i.state.loadedKeys,ee=yd(se,b);te==null||te(ee,{event:"load",node:o}),i.setUncontrolledState({loadedKeys:ee}),i.setState(function(de){return{loadingKeys:Cu(de.loadingKeys,b)}}),D()}).catch(function(se){if(i.setState(function(de){return{loadingKeys:Cu(de.loadingKeys,b)}}),i.loadingRetryTimes[b]=(i.loadingRetryTimes[b]||0)+1,i.loadingRetryTimes[b]>=npe){var ee=i.state.loadedKeys;oa(!1,"Retry for `loadData` many times but still failed. No more retry."),i.setUncontrolledState({loadedKeys:yd(ee,b)}),D()}k(se)}),{loadingKeys:yd(K,b)}})});return A.catch(function(){}),A}}),ke(Mr(i),"onNodeMouseEnter",function(o,y){var b=i.props.onMouseEnter;b==null||b({event:o,node:y})}),ke(Mr(i),"onNodeMouseLeave",function(o,y){var b=i.props.onMouseLeave;b==null||b({event:o,node:y})}),ke(Mr(i),"onNodeContextMenu",function(o,y){var b=i.props.onRightClick;b&&(o.preventDefault(),b({event:o,node:y}))}),ke(Mr(i),"onFocus",function(){var o=i.props.onFocus;i.setState({focused:!0});for(var y=arguments.length,b=new Array(y),C=0;C<y;C++)b[C]=arguments[C];o==null||o.apply(void 0,b)}),ke(Mr(i),"onBlur",function(){var o=i.props.onBlur;i.setState({focused:!1}),i.onActiveChange(null);for(var y=arguments.length,b=new Array(y),C=0;C<y;C++)b[C]=arguments[C];o==null||o.apply(void 0,b)}),ke(Mr(i),"getTreeNodeRequiredProps",function(){var o=i.state,y=o.expandedKeys,b=o.selectedKeys,C=o.loadedKeys,P=o.loadingKeys,A=o.checkedKeys,D=o.halfCheckedKeys,k=o.dragOverNodeKey,B=o.dropPosition,N=o.keyEntities;return{expandedKeys:y||[],selectedKeys:b||[],loadedKeys:C||[],loadingKeys:P||[],checkedKeys:A||[],halfCheckedKeys:D||[],dragOverNodeKey:k,dropPosition:B,keyEntities:N}}),ke(Mr(i),"setExpandedKeys",function(o){var y=i.state,b=y.treeData,C=y.fieldNames,P=iP(b,o,C);i.setUncontrolledState({expandedKeys:o,flattenNodes:P},!0)}),ke(Mr(i),"onNodeExpand",function(o,y){var b=i.state.expandedKeys,C=i.state,P=C.listChanging,A=C.fieldNames,D=i.props,k=D.onExpand,B=D.loadData,N=y.expanded,j=y[A.key];if(!P){var V=b.includes(j),K=!N;if(oa(N&&V||!N&&!V,"Expand state not sync with index check"),b=K?yd(b,j):Cu(b,j),i.setExpandedKeys(b),k==null||k(b,{node:y,expanded:K,nativeEvent:o.nativeEvent}),K&&B){var Y=i.onNodeLoad(y);Y&&Y.then(function(){var Z=iP(i.state.treeData,b,A);i.setUncontrolledState({flattenNodes:Z})}).catch(function(){var Z=i.state.expandedKeys,te=Cu(Z,j);i.setExpandedKeys(te)})}}}),ke(Mr(i),"onListChangeStart",function(){i.setUncontrolledState({listChanging:!0})}),ke(Mr(i),"onListChangeEnd",function(){setTimeout(function(){i.setUncontrolledState({listChanging:!1})})}),ke(Mr(i),"onActiveChange",function(o){var y=i.state.activeKey,b=i.props,C=b.onActiveChange,P=b.itemScrollOffset,A=P===void 0?0:P;y!==o&&(i.setState({activeKey:o}),o!==null&&i.scrollTo({key:o,offset:A}),C==null||C(o))}),ke(Mr(i),"getActiveItem",function(){var o=i.state,y=o.activeKey,b=o.flattenNodes;return y===null?null:b.find(function(C){var P=C.key;return P===y})||null}),ke(Mr(i),"offsetActiveKey",function(o){var y=i.state,b=y.flattenNodes,C=y.activeKey,P=b.findIndex(function(k){var B=k.key;return B===C});P===-1&&o<0&&(P=b.length),P=(P+o+b.length)%b.length;var A=b[P];if(A){var D=A.key;i.onActiveChange(D)}else i.onActiveChange(null)}),ke(Mr(i),"onKeyDown",function(o){var y=i.state,b=y.activeKey,C=y.expandedKeys,P=y.checkedKeys,A=y.fieldNames,D=i.props,k=D.onKeyDown,B=D.checkable,N=D.selectable;switch(o.which){case ir.UP:{i.offsetActiveKey(-1),o.preventDefault();break}case ir.DOWN:{i.offsetActiveKey(1),o.preventDefault();break}}var j=i.getActiveItem();if(j&&j.data){var V=i.getTreeNodeRequiredProps(),K=j.data.isLeaf===!1||!!(j.data[A.children]||[]).length,Y=Ka(Je(Je({},q0(b,V)),{},{data:j.data,active:!0}));switch(o.which){case ir.LEFT:{K&&C.includes(b)?i.onNodeExpand({},Y):j.parent&&i.onActiveChange(j.parent.key),o.preventDefault();break}case ir.RIGHT:{K&&!C.includes(b)?i.onNodeExpand({},Y):j.children&&j.children.length&&i.onActiveChange(j.children[0].key),o.preventDefault();break}case ir.ENTER:case ir.SPACE:{B&&!Y.disabled&&Y.checkable!==!1&&!Y.disableCheckbox?i.onNodeCheck({},Y,!P.includes(b)):!B&&N&&!Y.disabled&&Y.selectable!==!1&&i.onNodeSelect({},Y);break}}}k==null||k(o)}),ke(Mr(i),"setUncontrolledState",function(o){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!i.destroyed){var C=!1,P=!0,A={};Object.keys(o).forEach(function(D){if(i.props.hasOwnProperty(D)){P=!1;return}C=!0,A[D]=o[D]}),C&&(!y||P)&&i.setState(Je(Je({},A),b))}}),ke(Mr(i),"scrollTo",function(o){i.listRef.current.scrollTo(o)}),i}return Va(n,[{key:"componentDidMount",value:function(){this.destroyed=!1,this.onUpdated()}},{key:"componentDidUpdate",value:function(){this.onUpdated()}},{key:"onUpdated",value:function(){var s=this.props,d=s.activeKey,f=s.itemScrollOffset,o=f===void 0?0:f;d!==void 0&&d!==this.state.activeKey&&(this.setState({activeKey:d}),d!==null&&this.scrollTo({key:d,offset:o}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}},{key:"resetDragState",value:function(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}},{key:"render",value:function(){var s=this.state,d=s.focused,f=s.flattenNodes,o=s.keyEntities,y=s.draggingNodeKey,b=s.activeKey,C=s.dropLevelOffset,P=s.dropContainerKey,A=s.dropTargetKey,D=s.dropPosition,k=s.dragOverNodeKey,B=s.indent,N=this.props,j=N.prefixCls,V=N.className,K=N.style,Y=N.showLine,Z=N.focusable,te=N.tabIndex,ne=te===void 0?0:te,se=N.selectable,ee=N.showIcon,de=N.icon,fe=N.switcherIcon,ye=N.draggable,ge=N.checkable,we=N.checkStrictly,Se=N.disabled,xe=N.motion,Te=N.loadData,ze=N.filterTreeNode,Ue=N.height,We=N.itemHeight,Be=N.scrollWidth,Xe=N.virtual,qe=N.titleRender,at=N.dropIndicatorRender,Ke=N.onContextMenu,tt=N.onScroll,vt=N.direction,Pt=N.rootClassName,ft=N.rootStyle,Nt=Jc(this.props,{aria:!0,data:!0}),Rt;ye&&(Nr(ye)==="object"?Rt=ye:typeof ye=="function"?Rt={nodeDraggable:ye}:Rt={});var pt={prefixCls:j,selectable:se,showIcon:ee,icon:de,switcherIcon:fe,draggable:Rt,draggingNodeKey:y,checkable:ge,checkStrictly:we,disabled:Se,keyEntities:o,dropLevelOffset:C,dropContainerKey:P,dropTargetKey:A,dropPosition:D,dragOverNodeKey:k,indent:B,direction:vt,dropIndicatorRender:at,loadData:Te,filterTreeNode:ze,titleRender:qe,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop};return I.createElement(fD.Provider,{value:pt},I.createElement("div",{className:St(j,V,Pt,ke(ke(ke({},"".concat(j,"-show-line"),Y),"".concat(j,"-focused"),d),"".concat(j,"-active-focused"),b!==null)),style:ft},I.createElement(tpe,kn({ref:this.listRef,prefixCls:j,style:K,data:f,disabled:Se,selectable:se,checkable:!!ge,motion:xe,dragging:y!==null,height:Ue,itemHeight:We,virtual:Xe,focusable:Z,focused:d,tabIndex:ne,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:Ke,onScroll:tt,scrollWidth:Be},this.getTreeNodeRequiredProps(),Nt))))}}],[{key:"getDerivedStateFromProps",value:function(s,d){var f=d.prevProps,o={prevProps:s};function y(ne){return!f&&s.hasOwnProperty(ne)||f&&f[ne]!==s[ne]}var b,C=d.fieldNames;if(y("fieldNames")&&(C=zv(s.fieldNames),o.fieldNames=C),y("treeData")?b=s.treeData:y("children")&&(oa(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),b=_8(s.children)),b){o.treeData=b;var P=aD(b,{fieldNames:C});o.keyEntities=Je(ke({},Zp,J8),P.keyEntities)}var A=o.keyEntities||d.keyEntities;if(y("expandedKeys")||f&&y("autoExpandParent"))o.expandedKeys=s.autoExpandParent||!f&&s.defaultExpandParent?kR(s.expandedKeys,A):s.expandedKeys;else if(!f&&s.defaultExpandAll){var D=Je({},A);delete D[Zp];var k=[];Object.keys(D).forEach(function(ne){var se=D[ne];se.children&&se.children.length&&k.push(se.key)}),o.expandedKeys=k}else!f&&s.defaultExpandedKeys&&(o.expandedKeys=s.autoExpandParent||s.defaultExpandParent?kR(s.defaultExpandedKeys,A):s.defaultExpandedKeys);if(o.expandedKeys||delete o.expandedKeys,b||o.expandedKeys){var B=iP(b||d.treeData,o.expandedKeys||d.expandedKeys,C);o.flattenNodes=B}if(s.selectable&&(y("selectedKeys")?o.selectedKeys=X$(s.selectedKeys,s):!f&&s.defaultSelectedKeys&&(o.selectedKeys=X$(s.defaultSelectedKeys,s))),s.checkable){var N;if(y("checkedKeys")?N=sP(s.checkedKeys)||{}:!f&&s.defaultCheckedKeys?N=sP(s.defaultCheckedKeys)||{}:b&&(N=sP(s.checkedKeys)||{checkedKeys:d.checkedKeys,halfCheckedKeys:d.halfCheckedKeys}),N){var j=N,V=j.checkedKeys,K=V===void 0?[]:V,Y=j.halfCheckedKeys,Z=Y===void 0?[]:Y;if(!s.checkStrictly){var te=yv(K,!0,A);K=te.checkedKeys,Z=te.halfCheckedKeys}o.checkedKeys=K,o.halfCheckedKeys=Z}}return y("loadedKeys")&&(o.loadedKeys=s.loadedKeys),o}}]),n}(I.Component);ke(mD,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:qfe,allowDrop:function(){return!0},expandAction:!1});ke(mD,"TreeNode",Fx);var rpe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"},ipe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:rpe}))},Q8=I.forwardRef(ipe),ope={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"},ape=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:ope}))},spe=I.forwardRef(ape),lpe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder",theme:"outlined"},cpe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:lpe}))},upe=I.forwardRef(cpe),dpe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 276.5a56 56 0 1056-97 56 56 0 00-56 97zm0 284a56 56 0 1056-97 56 56 0 00-56 97zM640 228a56 56 0 10112 0 56 56 0 00-112 0zm0 284a56 56 0 10112 0 56 56 0 00-112 0zM300 844.5a56 56 0 1056-97 56 56 0 00-56 97zM640 796a56 56 0 10112 0 56 56 0 00-112 0z"}}]},name:"holder",theme:"outlined"},hpe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:dpe}))},fpe=I.forwardRef(hpe);const ppe=({treeCls:e,treeNodeCls:t,directoryNodeSelectedBg:n,directoryNodeSelectedColor:i,motionDurationMid:s,borderRadius:d,controlItemBgHover:f})=>({[`${e}${e}-directory ${t}`]:{[`${e}-node-content-wrapper`]:{position:"static",[`&:has(${e}-drop-indicator)`]:{position:"relative"},[`> *:not(${e}-drop-indicator)`]:{position:"relative"},"&:hover":{background:"transparent"},"&:before":{position:"absolute",inset:0,transition:`background-color ${s}`,content:'""',borderRadius:d},"&:hover:before":{background:f}},[`${e}-switcher, ${e}-checkbox, ${e}-draggable-icon`]:{zIndex:1},"&-selected":{background:n,borderRadius:d,[`${e}-switcher, ${e}-draggable-icon`]:{color:i},[`${e}-node-content-wrapper`]:{color:i,background:"transparent","&, &:hover":{color:i},"&:before, &:hover:before":{background:n}}}}}),mpe=new Mo("ant-tree-node-fx-do-not-use",{"0%":{opacity:0},"100%":{opacity:1}}),gpe=(e,t)=>({[`.${e}-switcher-icon`]:{display:"inline-block",fontSize:10,verticalAlign:"baseline",svg:{transition:`transform ${t.motionDurationSlow}`}}}),vpe=(e,t)=>({[`.${e}-drop-indicator`]:{position:"absolute",zIndex:1,height:2,backgroundColor:t.colorPrimary,borderRadius:1,pointerEvents:"none","&:after":{position:"absolute",top:-3,insetInlineStart:-6,width:8,height:8,backgroundColor:"transparent",border:`${dt(t.lineWidthBold)} solid ${t.colorPrimary}`,borderRadius:"50%",content:'""'}}}),_pe=(e,t)=>{const{treeCls:n,treeNodeCls:i,treeNodePadding:s,titleHeight:d,indentSize:f,nodeSelectedBg:o,nodeHoverBg:y,colorTextQuaternary:b,controlItemBgActiveDisabled:C}=t;return{[n]:Object.assign(Object.assign({},ya(t)),{"--rc-virtual-list-scrollbar-bg":t.colorSplit,background:t.colorBgContainer,borderRadius:t.borderRadius,transition:`background-color ${t.motionDurationSlow}`,"&-rtl":{direction:"rtl"},[`&${n}-rtl ${n}-switcher_close ${n}-switcher-icon svg`]:{transform:"rotate(90deg)"},[`&-focused:not(:hover):not(${n}-active-focused)`]:Nu(t),[`${n}-list-holder-inner`]:{alignItems:"flex-start"},[`&${n}-block-node`]:{[`${n}-list-holder-inner`]:{alignItems:"stretch",[`${n}-node-content-wrapper`]:{flex:"auto"},[`${i}.dragging:after`]:{position:"absolute",inset:0,border:`1px solid ${t.colorPrimary}`,opacity:0,animationName:mpe,animationDuration:t.motionDurationSlow,animationPlayState:"running",animationFillMode:"forwards",content:'""',pointerEvents:"none",borderRadius:t.borderRadius}}},[i]:{display:"flex",alignItems:"flex-start",marginBottom:s,lineHeight:dt(d),position:"relative","&:before":{content:'""',position:"absolute",zIndex:1,insetInlineStart:0,width:"100%",top:"100%",height:s},[`&-disabled ${n}-node-content-wrapper`]:{color:t.colorTextDisabled,cursor:"not-allowed","&:hover":{background:"transparent"}},[`${n}-checkbox-disabled + ${n}-node-selected,&${i}-disabled${i}-selected ${n}-node-content-wrapper`]:{backgroundColor:C},[`${n}-checkbox-disabled`]:{pointerEvents:"unset"},[`&:not(${i}-disabled)`]:{[`${n}-node-content-wrapper`]:{"&:hover":{color:t.nodeHoverColor}}},[`&-active ${n}-node-content-wrapper`]:{background:t.controlItemBgHover},[`&:not(${i}-disabled).filter-node ${n}-title`]:{color:t.colorPrimary,fontWeight:t.fontWeightStrong},"&-draggable":{cursor:"grab",[`${n}-draggable-icon`]:{flexShrink:0,width:d,textAlign:"center",visibility:"visible",color:b},[`&${i}-disabled ${n}-draggable-icon`]:{visibility:"hidden"}}},[`${n}-indent`]:{alignSelf:"stretch",whiteSpace:"nowrap",userSelect:"none","&-unit":{display:"inline-block",width:f}},[`${n}-draggable-icon`]:{visibility:"hidden"},[`${n}-switcher, ${n}-checkbox`]:{marginInlineEnd:t.calc(t.calc(d).sub(t.controlInteractiveSize)).div(2).equal()},[`${n}-switcher`]:Object.assign(Object.assign({},gpe(e,t)),{position:"relative",flex:"none",alignSelf:"stretch",width:d,textAlign:"center",cursor:"pointer",userSelect:"none",transition:`all ${t.motionDurationSlow}`,"&-noop":{cursor:"unset"},"&:before":{pointerEvents:"none",content:'""',width:d,height:d,position:"absolute",left:{_skip_check_:!0,value:0},top:0,borderRadius:t.borderRadius,transition:`all ${t.motionDurationSlow}`},[`&:not(${n}-switcher-noop):hover:before`]:{backgroundColor:t.colorBgTextHover},[`&_close ${n}-switcher-icon svg`]:{transform:"rotate(-90deg)"},"&-loading-icon":{color:t.colorPrimary},"&-leaf-line":{position:"relative",zIndex:1,display:"inline-block",width:"100%",height:"100%","&:before":{position:"absolute",top:0,insetInlineEnd:t.calc(d).div(2).equal(),bottom:t.calc(s).mul(-1).equal(),marginInlineStart:-1,borderInlineEnd:`1px solid ${t.colorBorder}`,content:'""'},"&:after":{position:"absolute",width:t.calc(t.calc(d).div(2).equal()).mul(.8).equal(),height:t.calc(d).div(2).equal(),borderBottom:`1px solid ${t.colorBorder}`,content:'""'}}}),[`${n}-node-content-wrapper`]:Object.assign(Object.assign({position:"relative",minHeight:d,paddingBlock:0,paddingInline:t.paddingXS,background:"transparent",borderRadius:t.borderRadius,cursor:"pointer",transition:`all ${t.motionDurationMid}, border 0s, line-height 0s, box-shadow 0s`},vpe(e,t)),{"&:hover":{backgroundColor:y},[`&${n}-node-selected`]:{color:t.nodeSelectedColor,backgroundColor:o},[`${n}-iconEle`]:{display:"inline-block",width:d,height:d,textAlign:"center",verticalAlign:"top","&:empty":{display:"none"}}}),[`${n}-unselectable ${n}-node-content-wrapper:hover`]:{backgroundColor:"transparent"},[`${i}.drop-container > [draggable]`]:{boxShadow:`0 0 0 2px ${t.colorPrimary}`},"&-show-line":{[`${n}-indent-unit`]:{position:"relative",height:"100%","&:before":{position:"absolute",top:0,insetInlineEnd:t.calc(d).div(2).equal(),bottom:t.calc(s).mul(-1).equal(),borderInlineEnd:`1px solid ${t.colorBorder}`,content:'""'},"&-end:before":{display:"none"}},[`${n}-switcher`]:{background:"transparent","&-line-icon":{verticalAlign:"-0.15em"}}},[`${i}-leaf-last ${n}-switcher-leaf-line:before`]:{top:"auto !important",bottom:"auto !important",height:`${dt(t.calc(d).div(2).equal())} !important`}})}},ype=(e,t,n=!0)=>{const i=`.${e}`,s=`${i}-treenode`,d=t.calc(t.paddingXS).div(2).equal(),f=xo(t,{treeCls:i,treeNodeCls:s,treeNodePadding:d});return[_pe(e,f),n&&ppe(f)].filter(Boolean)},xpe=e=>{const{controlHeightSM:t,controlItemBgHover:n,controlItemBgActive:i}=e,s=t;return{titleHeight:s,indentSize:s,nodeHoverBg:n,nodeHoverColor:e.colorText,nodeSelectedBg:i,nodeSelectedColor:e.colorText}},bpe=e=>{const{colorTextLightSolid:t,colorPrimary:n}=e;return Object.assign(Object.assign({},xpe(e)),{directoryNodeSelectedColor:t,directoryNodeSelectedBg:n})},wpe=za("Tree",(e,{prefixCls:t})=>[{[e.componentCls]:x8(`${t}-checkbox`,e)},ype(t,e),KU(e)],bpe),n5=4;function Spe(e){const{dropPosition:t,dropLevelOffset:n,prefixCls:i,indent:s,direction:d="ltr"}=e,f=d==="ltr"?"left":"right",o=d==="ltr"?"right":"left",y={[f]:-n*s+n5,[o]:0};switch(t){case-1:y.top=-3;break;case 1:y.bottom=-3;break;default:y.bottom=-3,y[f]=s+n5;break}return Wt.createElement("div",{style:y,className:`${i}-drop-indicator`})}var Cpe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"}}]},name:"caret-down",theme:"filled"},Epe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Cpe}))},Tpe=I.forwardRef(Epe),Ipe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"},Ppe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Ipe}))},Mpe=I.forwardRef(Ppe),Rpe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"},Ape=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Rpe}))},Ope=I.forwardRef(Ape);const Dpe=e=>{var t,n;const{prefixCls:i,switcherIcon:s,treeNodeProps:d,showLine:f,switcherLoadingIcon:o}=e,{isLeaf:y,expanded:b,loading:C}=d;if(C)return I.isValidElement(o)?o:I.createElement(CO,{className:`${i}-switcher-loading-icon`});let P;if(f&&typeof f=="object"&&(P=f.showLeafIcon),y){if(!f)return null;if(typeof P!="boolean"&&P){const k=typeof P=="function"?P(d):P,B=`${i}-switcher-line-custom-icon`;return I.isValidElement(k)?Bu(k,{className:St((t=k.props)===null||t===void 0?void 0:t.className,B)}):k}return P?I.createElement(Q8,{className:`${i}-switcher-line-icon`}):I.createElement("span",{className:`${i}-switcher-leaf-line`})}const A=`${i}-switcher-icon`,D=typeof s=="function"?s(d):s;return I.isValidElement(D)?Bu(D,{className:St((n=D.props)===null||n===void 0?void 0:n.className,A)}):D!==void 0?D:f?b?I.createElement(Mpe,{className:`${i}-switcher-line-icon`}):I.createElement(Ope,{className:`${i}-switcher-line-icon`}):I.createElement(Tpe,{className:A})},eG=Wt.forwardRef((e,t)=>{var n;const{getPrefixCls:i,direction:s,virtual:d,tree:f}=Wt.useContext(ji),{prefixCls:o,className:y,showIcon:b=!1,showLine:C,switcherIcon:P,switcherLoadingIcon:A,blockNode:D=!1,children:k,checkable:B=!1,selectable:N=!0,draggable:j,motion:V,style:K}=e,Y=i("tree",o),Z=i(),te=V??Object.assign(Object.assign({},HU(Z)),{motionAppear:!1}),ne=Object.assign(Object.assign({},e),{checkable:B,selectable:N,showIcon:b,motion:te,blockNode:D,showLine:!!C,dropIndicatorRender:Spe}),[se,ee,de]=wpe(Y),[,fe]=Vs(),ye=fe.paddingXS/2+(((n=fe.Tree)===null||n===void 0?void 0:n.titleHeight)||fe.controlHeightSM),ge=Wt.useMemo(()=>{if(!j)return!1;let Se={};switch(typeof j){case"function":Se.nodeDraggable=j;break;case"object":Se=Object.assign({},j);break}return Se.icon!==!1&&(Se.icon=Se.icon||Wt.createElement(fpe,null)),Se},[j]),we=Se=>Wt.createElement(Dpe,{prefixCls:Y,switcherIcon:P,switcherLoadingIcon:A,treeNodeProps:Se,showLine:C});return se(Wt.createElement(mD,Object.assign({itemHeight:ye,ref:t,virtual:d},ne,{style:Object.assign(Object.assign({},f==null?void 0:f.style),K),prefixCls:Y,className:St({[`${Y}-icon-hide`]:!b,[`${Y}-block-node`]:D,[`${Y}-unselectable`]:!N,[`${Y}-rtl`]:s==="rtl"},f==null?void 0:f.className,y,ee,de),direction:s,checkable:B&&Wt.createElement("span",{className:`${Y}-checkbox-inner`}),selectable:N,switcherIcon:we,draggable:ge}),k))}),r5=0,lP=1,i5=2;function gD(e,t,n){const{key:i,children:s}=n;function d(f){const o=f[i],y=f[s];t(o,f)!==!1&&gD(y||[],t,n)}e.forEach(d)}function Lpe({treeData:e,expandedKeys:t,startKey:n,endKey:i,fieldNames:s}){const d=[];let f=r5;if(n&&n===i)return[n];if(!n||!i)return[];function o(y){return y===n||y===i}return gD(e,y=>{if(f===i5)return!1;if(o(y)){if(d.push(y),f===r5)f=lP;else if(f===lP)return f=i5,!1}else f===lP&&d.push(y);return t.includes(y)},zv(s)),d}function cP(e,t,n){const i=zn(t),s=[];return gD(e,(d,f)=>{const o=i.indexOf(d);return o!==-1&&(s.push(f),i.splice(o,1)),!!i.length},zv(n)),s}var o5=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};function zpe(e){const{isLeaf:t,expanded:n}=e;return t?I.createElement(Q8,null):n?I.createElement(spe,null):I.createElement(upe,null)}function a5({treeData:e,children:t}){return e||_8(t)}const kpe=(e,t)=>{var{defaultExpandAll:n,defaultExpandParent:i,defaultExpandedKeys:s}=e,d=o5(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const f=I.useRef(null),o=I.useRef(null),y=()=>{const{keyEntities:se}=aD(a5(d));let ee;return n?ee=Object.keys(se):i?ee=kR(d.expandedKeys||s||[],se):ee=d.expandedKeys||s||[],ee},[b,C]=I.useState(d.selectedKeys||d.defaultSelectedKeys||[]),[P,A]=I.useState(()=>y());I.useEffect(()=>{"selectedKeys"in d&&C(d.selectedKeys)},[d.selectedKeys]),I.useEffect(()=>{"expandedKeys"in d&&A(d.expandedKeys)},[d.expandedKeys]);const D=(se,ee)=>{var de;return"expandedKeys"in d||A(se),(de=d.onExpand)===null||de===void 0?void 0:de.call(d,se,ee)},k=(se,ee)=>{var de;const{multiple:fe,fieldNames:ye}=d,{node:ge,nativeEvent:we}=ee,{key:Se=""}=ge,xe=a5(d),Te=Object.assign(Object.assign({},ee),{selected:!0}),ze=(we==null?void 0:we.ctrlKey)||(we==null?void 0:we.metaKey),Ue=we==null?void 0:we.shiftKey;let We;fe&&ze?(We=se,f.current=Se,o.current=We,Te.selectedNodes=cP(xe,We,ye)):fe&&Ue?(We=Array.from(new Set([].concat(zn(o.current||[]),zn(Lpe({treeData:xe,expandedKeys:P,startKey:Se,endKey:f.current,fieldNames:ye}))))),Te.selectedNodes=cP(xe,We,ye)):(We=[Se],f.current=Se,o.current=We,Te.selectedNodes=cP(xe,We,ye)),(de=d.onSelect)===null||de===void 0||de.call(d,We,Te),"selectedKeys"in d||C(We)},{getPrefixCls:B,direction:N}=I.useContext(ji),{prefixCls:j,className:V,showIcon:K=!0,expandAction:Y="click"}=d,Z=o5(d,["prefixCls","className","showIcon","expandAction"]),te=B("tree",j),ne=St(`${te}-directory`,{[`${te}-directory-rtl`]:N==="rtl"},V);return I.createElement(eG,Object.assign({icon:zpe,ref:t,blockNode:!0},Z,{showIcon:K,expandAction:Y,prefixCls:te,className:ne,expandedKeys:P,selectedKeys:b,onSelect:k,onExpand:D}))},Fpe=I.forwardRef(kpe),vD=eG;vD.DirectoryTree=Fpe;vD.TreeNode=Fx;const s5=e=>{const{value:t,filterSearch:n,tablePrefixCls:i,locale:s,onChange:d}=e;return n?I.createElement("div",{className:`${i}-filter-dropdown-search`},I.createElement(ude,{prefix:I.createElement(MH,null),placeholder:s.filterSearchPlaceholder,onChange:d,value:t,htmlSize:1,className:`${i}-filter-dropdown-search-input`})):null},Npe=e=>{const{keyCode:t}=e;t===ir.ENTER&&e.stopPropagation()},Bpe=I.forwardRef((e,t)=>I.createElement("div",{className:e.className,onClick:n=>n.stopPropagation(),onKeyDown:Npe,ref:t},e.children));function xv(e){let t=[];return(e||[]).forEach(({value:n,children:i})=>{t.push(n),i&&(t=[].concat(zn(t),zn(xv(i))))}),t}function $pe(e){return e.some(({children:t})=>t)}function tG(e,t){return typeof t=="string"||typeof t=="number"?t==null?void 0:t.toString().toLowerCase().includes(e.trim().toLowerCase()):!1}function nG({filters:e,prefixCls:t,filteredKeys:n,filterMultiple:i,searchValue:s,filterSearch:d}){return e.map((f,o)=>{const y=String(f.value);if(f.children)return{key:y||o,label:f.text,popupClassName:`${t}-dropdown-submenu`,children:nG({filters:f.children,prefixCls:t,filteredKeys:n,filterMultiple:i,searchValue:s,filterSearch:d})};const b=i?Au:lb,C={key:f.value!==void 0?y:o,label:I.createElement(I.Fragment,null,I.createElement(b,{checked:n.includes(y)}),I.createElement("span",null,f.text))};return s.trim()?typeof d=="function"?d(s,f)?C:null:tG(s,f.text)?C:null:C})}function uP(e){return e||[]}const jpe=e=>{var t,n,i,s;const{tablePrefixCls:d,prefixCls:f,column:o,dropdownPrefixCls:y,columnKey:b,filterOnClose:C,filterMultiple:P,filterMode:A="menu",filterSearch:D=!1,filterState:k,triggerFilter:B,locale:N,children:j,getPopupContainer:V,rootClassName:K}=e,{filterResetToDefaultFilteredValue:Y,defaultFilteredValue:Z,filterDropdownProps:te={},filterDropdownOpen:ne,filterDropdownVisible:se,onFilterDropdownVisibleChange:ee,onFilterDropdownOpenChange:de}=o,[fe,ye]=I.useState(!1),ge=!!(k&&(!((t=k.filteredKeys)===null||t===void 0)&&t.length||k.forceFiltered)),we=Mt=>{var hn;ye(Mt),(hn=te.onOpenChange)===null||hn===void 0||hn.call(te,Mt),de==null||de(Mt),ee==null||ee(Mt)},Se=(s=(i=(n=te.open)!==null&&n!==void 0?n:ne)!==null&&i!==void 0?i:se)!==null&&s!==void 0?s:fe,xe=k==null?void 0:k.filteredKeys,[Te,ze]=Wfe(uP(xe)),Ue=({selectedKeys:Mt})=>{ze(Mt)},We=(Mt,{node:hn,checked:Jt})=>{Ue(P?{selectedKeys:Mt}:{selectedKeys:Jt&&hn.key?[hn.key]:[]})};I.useEffect(()=>{fe&&Ue({selectedKeys:uP(xe)})},[xe]);const[Be,Xe]=I.useState([]),qe=Mt=>{Xe(Mt)},[at,Ke]=I.useState(""),tt=Mt=>{const{value:hn}=Mt.target;Ke(hn)};I.useEffect(()=>{fe||Ke("")},[fe]);const vt=Mt=>{const hn=Mt!=null&&Mt.length?Mt:null;if(hn===null&&(!k||!k.filteredKeys)||Yc(hn,k==null?void 0:k.filteredKeys,!0))return null;B({column:o,key:b,filteredKeys:hn})},Pt=()=>{we(!1),vt(Te())},ft=({confirm:Mt,closeDropdown:hn}={confirm:!1,closeDropdown:!1})=>{Mt&&vt([]),hn&&we(!1),Ke(""),ze(Y?(Z||[]).map(Jt=>String(Jt)):[])},Nt=({closeDropdown:Mt}={closeDropdown:!0})=>{Mt&&we(!1),vt(Te())},Rt=(Mt,hn)=>{hn.source==="trigger"&&(Mt&&xe!==void 0&&ze(uP(xe)),we(Mt),!Mt&&!o.filterDropdown&&C&&Pt())},pt=St({[`${y}-menu-without-submenu`]:!$pe(o.filters||[])}),yt=Mt=>{if(Mt.target.checked){const hn=xv(o==null?void 0:o.filters).map(Jt=>String(Jt));ze(hn)}else ze([])},xt=({filters:Mt})=>(Mt||[]).map((hn,Jt)=>{const Ut=String(hn.value),Tn={title:hn.text,key:hn.value!==void 0?Ut:String(Jt)};return hn.children&&(Tn.children=xt({filters:hn.children})),Tn}),bt=Mt=>{var hn;return Object.assign(Object.assign({},Mt),{text:Mt.title,value:Mt.key,children:((hn=Mt.children)===null||hn===void 0?void 0:hn.map(Jt=>bt(Jt)))||[]})};let Ct;const{direction:tn,renderEmpty:Zt}=I.useContext(ji);if(typeof o.filterDropdown=="function")Ct=o.filterDropdown({prefixCls:`${y}-custom`,setSelectedKeys:Mt=>Ue({selectedKeys:Mt}),selectedKeys:Te(),confirm:Nt,clearFilters:ft,filters:o.filters,visible:Se,close:()=>{we(!1)}});else if(o.filterDropdown)Ct=o.filterDropdown;else{const Mt=Te()||[],hn=()=>{var Ut,Tn;const On=(Ut=Zt==null?void 0:Zt("Table.filter"))!==null&&Ut!==void 0?Ut:I.createElement(Ed,{image:Ed.PRESENTED_IMAGE_SIMPLE,description:N.filterEmptyText,styles:{image:{height:24}},style:{margin:0,padding:"16px 0"}});if((o.filters||[]).length===0)return On;if(A==="tree")return I.createElement(I.Fragment,null,I.createElement(s5,{filterSearch:D,value:at,onChange:tt,tablePrefixCls:d,locale:N}),I.createElement("div",{className:`${d}-filter-dropdown-tree`},P?I.createElement(Au,{checked:Mt.length===xv(o.filters).length,indeterminate:Mt.length>0&&Mt.length<xv(o.filters).length,className:`${d}-filter-dropdown-checkall`,onChange:yt},(Tn=N==null?void 0:N.filterCheckall)!==null&&Tn!==void 0?Tn:N==null?void 0:N.filterCheckAll):null,I.createElement(vD,{checkable:!0,selectable:!1,blockNode:!0,multiple:P,checkStrictly:!P,className:`${y}-menu`,onCheck:We,checkedKeys:Mt,selectedKeys:Mt,showIcon:!1,treeData:xt({filters:o.filters}),autoExpandParent:!0,defaultExpandAll:!0,filterTreeNode:at.trim()?Pn=>typeof D=="function"?D(at,bt(Pn)):tG(at,Pn.title):void 0})));const Kn=nG({filters:o.filters||[],filterSearch:D,prefixCls:f,filteredKeys:Te(),filterMultiple:P,searchValue:at}),Un=Kn.every(Pn=>Pn===null);return I.createElement(I.Fragment,null,I.createElement(s5,{filterSearch:D,value:at,onChange:tt,tablePrefixCls:d,locale:N}),Un?On:I.createElement(pf,{selectable:!0,multiple:P,prefixCls:`${y}-menu`,className:pt,onSelect:Ue,onDeselect:Ue,selectedKeys:Mt,getPopupContainer:V,openKeys:Be,onOpenChange:qe,items:Kn}))},Jt=()=>Y?Yc((Z||[]).map(Ut=>String(Ut)),Mt,!0):Mt.length===0;Ct=I.createElement(I.Fragment,null,hn(),I.createElement("div",{className:`${f}-dropdown-btns`},I.createElement(Uc,{type:"link",size:"small",disabled:Jt(),onClick:()=>ft()},N.filterReset),I.createElement(Uc,{type:"primary",size:"small",onClick:Pt},N.filterConfirm)))}o.filterDropdown&&(Ct=I.createElement(t8,{selectable:void 0},Ct)),Ct=I.createElement(Bpe,{className:`${f}-dropdown`},Ct);const Cn=cC({trigger:["click"],placement:tn==="rtl"?"bottomLeft":"bottomRight",children:(()=>{let Mt;return typeof o.filterIcon=="function"?Mt=o.filterIcon(ge):o.filterIcon?Mt=o.filterIcon:Mt=I.createElement(Gfe,null),I.createElement("span",{role:"button",tabIndex:-1,className:St(`${f}-trigger`,{active:ge}),onClick:hn=>{hn.stopPropagation()}},Mt)})(),getPopupContainer:V},Object.assign(Object.assign({},te),{rootClassName:St(K,te.rootClassName),open:Se,onOpenChange:Rt,popupRender:()=>typeof(te==null?void 0:te.dropdownRender)=="function"?te.dropdownRender(Ct):Ct}));return I.createElement("div",{className:`${f}-column`},I.createElement("span",{className:`${d}-column-title`},j),I.createElement(AE,Object.assign({},Cn)))},jR=(e,t,n)=>{let i=[];return(e||[]).forEach((s,d)=>{var f;const o=r_(d,n),y=s.filterDropdown!==void 0;if(s.filters||y||"onFilter"in s)if("filteredValue"in s){let b=s.filteredValue;y||(b=(f=b==null?void 0:b.map(String))!==null&&f!==void 0?f:b),i.push({column:s,key:mf(s,o),filteredKeys:b,forceFiltered:s.filtered})}else i.push({column:s,key:mf(s,o),filteredKeys:t&&s.defaultFilteredValue?s.defaultFilteredValue:void 0,forceFiltered:s.filtered});"children"in s&&(i=[].concat(zn(i),zn(jR(s.children,t,o))))}),i};function rG(e,t,n,i,s,d,f,o,y){return n.map((b,C)=>{const P=r_(C,o),{filterOnClose:A=!0,filterMultiple:D=!0,filterMode:k,filterSearch:B}=b;let N=b;if(N.filters||N.filterDropdown){const j=mf(N,P),V=i.find(({key:K})=>j===K);N=Object.assign(Object.assign({},N),{title:K=>I.createElement(jpe,{tablePrefixCls:e,prefixCls:`${e}-filter`,dropdownPrefixCls:t,column:N,columnKey:j,filterState:V,filterOnClose:A,filterMultiple:D,filterMode:k,filterSearch:B,triggerFilter:d,locale:s,getPopupContainer:f,rootClassName:y},LE(b.title,K))})}return"children"in N&&(N=Object.assign(Object.assign({},N),{children:rG(e,t,N.children,i,s,d,f,P,y)})),N})}const l5=e=>{const t={};return e.forEach(({key:n,filteredKeys:i,column:s})=>{const d=n,{filters:f,filterDropdown:o}=s;if(o)t[d]=i||null;else if(Array.isArray(i)){const y=xv(f);t[d]=y.filter(b=>i.includes(String(b)))}else t[d]=null}),t},VR=(e,t,n)=>t.reduce((s,d)=>{const{column:{onFilter:f,filters:o},filteredKeys:y}=d;return f&&y&&y.length?s.map(b=>Object.assign({},b)).filter(b=>y.some(C=>{const P=xv(o),A=P.findIndex(k=>String(k)===String(C)),D=A!==-1?P[A]:C;return b[n]&&(b[n]=VR(b[n],t,n)),f(D,b)})):s},e),iG=e=>e.flatMap(t=>"children"in t?[t].concat(zn(iG(t.children||[]))):[t]),Vpe=e=>{const{prefixCls:t,dropdownPrefixCls:n,mergedColumns:i,onFilterChange:s,getPopupContainer:d,locale:f,rootClassName:o}=e;qv();const y=I.useMemo(()=>iG(i||[]),[i]),[b,C]=I.useState(()=>jR(y,!0)),P=I.useMemo(()=>{const B=jR(y,!1);if(B.length===0)return B;let N=!0;if(B.forEach(({filteredKeys:j})=>{j!==void 0&&(N=!1)}),N){const j=(y||[]).map((V,K)=>mf(V,r_(K)));return b.filter(({key:V})=>j.includes(V)).map(V=>{const K=y[j.indexOf(V.key)];return Object.assign(Object.assign({},V),{column:Object.assign(Object.assign({},V.column),K),forceFiltered:K.filtered})})}return B},[y,b]),A=I.useMemo(()=>l5(P),[P]),D=B=>{const N=P.filter(({key:j})=>j!==B.key);N.push(B),C(N),s(l5(N),N)};return[B=>rG(t,n,B,P,f,D,d,void 0,o),P,A]},Upe=(e,t,n)=>{const i=I.useRef({});function s(d){var f;if(!i.current||i.current.data!==e||i.current.childrenColumnName!==t||i.current.getRowKey!==n){let b=function(C){C.forEach((P,A)=>{const D=n(P,A);y.set(D,P),P&&typeof P=="object"&&t in P&&b(P[t]||[])})};var o=b;const y=new Map;b(e),i.current={data:e,childrenColumnName:t,kvMap:y,getRowKey:n}}return(f=i.current.kvMap)===null||f===void 0?void 0:f.get(d)}return[s]};var Hpe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const oG=10;function Gpe(e,t){const n={current:e.current,pageSize:e.pageSize};return Object.keys(t&&typeof t=="object"?t:{}).forEach(s=>{const d=e[s];typeof d!="function"&&(n[s]=d)}),n}function Wpe(e,t,n){const i=n&&typeof n=="object"?n:{},{total:s=0}=i,d=Hpe(i,["total"]),[f,o]=I.useState(()=>({current:"defaultCurrent"in d?d.defaultCurrent:1,pageSize:"defaultPageSize"in d?d.defaultPageSize:oG})),y=cC(f,d,{total:s>0?s:e}),b=Math.ceil((s||e)/y.pageSize);y.current>b&&(y.current=b||1);const C=(A,D)=>{o({current:A??1,pageSize:D||y.pageSize})},P=(A,D)=>{var k;n&&((k=n.onChange)===null||k===void 0||k.call(n,A,D)),C(A,D),t(A,D||(y==null?void 0:y.pageSize))};return n===!1?[{},()=>{}]:[Object.assign(Object.assign({},y),{onChange:P}),C]}var qpe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"}}]},name:"caret-down",theme:"outlined"},Kpe=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:qpe}))},Xpe=I.forwardRef(Kpe),Zpe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z"}}]},name:"caret-up",theme:"outlined"},Ype=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Zpe}))},Jpe=I.forwardRef(Ype);const yS="ascend",dP="descend",vC=e=>typeof e.sorter=="object"&&typeof e.sorter.multiple=="number"?e.sorter.multiple:!1,c5=e=>typeof e=="function"?e:e&&typeof e=="object"&&e.compare?e.compare:!1,Qpe=(e,t)=>t?e[e.indexOf(t)+1]:e[0],UR=(e,t,n)=>{let i=[];const s=(d,f)=>{i.push({column:d,key:mf(d,f),multiplePriority:vC(d),sortOrder:d.sortOrder})};return(e||[]).forEach((d,f)=>{const o=r_(f,n);d.children?("sortOrder"in d&&s(d,o),i=[].concat(zn(i),zn(UR(d.children,t,o)))):d.sorter&&("sortOrder"in d?s(d,o):t&&d.defaultSortOrder&&i.push({column:d,key:mf(d,o),multiplePriority:vC(d),sortOrder:d.defaultSortOrder}))}),i},aG=(e,t,n,i,s,d,f,o)=>(t||[]).map((b,C)=>{const P=r_(C,o);let A=b;if(A.sorter){const D=A.sortDirections||s,k=A.showSorterTooltip===void 0?f:A.showSorterTooltip,B=mf(A,P),N=n.find(({key:ee})=>ee===B),j=N?N.sortOrder:null,V=Qpe(D,j);let K;if(b.sortIcon)K=b.sortIcon({sortOrder:j});else{const ee=D.includes(yS)&&I.createElement(Jpe,{className:St(`${e}-column-sorter-up`,{active:j===yS})}),de=D.includes(dP)&&I.createElement(Xpe,{className:St(`${e}-column-sorter-down`,{active:j===dP})});K=I.createElement("span",{className:St(`${e}-column-sorter`,{[`${e}-column-sorter-full`]:!!(ee&&de)})},I.createElement("span",{className:`${e}-column-sorter-inner`,"aria-hidden":"true"},ee,de))}const{cancelSort:Y,triggerAsc:Z,triggerDesc:te}=d||{};let ne=Y;V===dP?ne=te:V===yS&&(ne=Z);const se=typeof k=="object"?Object.assign({title:ne},k):{title:ne};A=Object.assign(Object.assign({},A),{className:St(A.className,{[`${e}-column-sort`]:j}),title:ee=>{const de=`${e}-column-sorters`,fe=I.createElement("span",{className:`${e}-column-title`},LE(b.title,ee)),ye=I.createElement("div",{className:de},fe,K);return k?typeof k!="boolean"&&(k==null?void 0:k.target)==="sorter-icon"?I.createElement("div",{className:`${de} ${e}-column-sorters-tooltip-target-sorter`},fe,I.createElement(zx,Object.assign({},se),K)):I.createElement(zx,Object.assign({},se),ye):ye},onHeaderCell:ee=>{var de;const fe=((de=b.onHeaderCell)===null||de===void 0?void 0:de.call(b,ee))||{},ye=fe.onClick,ge=fe.onKeyDown;fe.onClick=xe=>{i({column:b,key:B,sortOrder:V,multiplePriority:vC(b)}),ye==null||ye(xe)},fe.onKeyDown=xe=>{xe.keyCode===ir.ENTER&&(i({column:b,key:B,sortOrder:V,multiplePriority:vC(b)}),ge==null||ge(xe))};const we=Vfe(b.title,{}),Se=we==null?void 0:we.toString();return j&&(fe["aria-sort"]=j==="ascend"?"ascending":"descending"),fe["aria-label"]=Se||"",fe.className=St(fe.className,`${e}-column-has-sorters`),fe.tabIndex=0,b.ellipsis&&(fe.title=(we??"").toString()),fe}})}return"children"in A&&(A=Object.assign(Object.assign({},A),{children:aG(e,A.children,n,i,s,d,f,P)})),A}),u5=e=>{const{column:t,sortOrder:n}=e;return{column:t,order:n,field:t.dataIndex,columnKey:t.key}},d5=e=>{const t=e.filter(({sortOrder:n})=>n).map(u5);if(t.length===0&&e.length){const n=e.length-1;return Object.assign(Object.assign({},u5(e[n])),{column:void 0,order:void 0,field:void 0,columnKey:void 0})}return t.length<=1?t[0]||{}:t},HR=(e,t,n)=>{const i=t.slice().sort((f,o)=>o.multiplePriority-f.multiplePriority),s=e.slice(),d=i.filter(({column:{sorter:f},sortOrder:o})=>c5(f)&&o);return d.length?s.sort((f,o)=>{for(let y=0;y<d.length;y+=1){const b=d[y],{column:{sorter:C},sortOrder:P}=b,A=c5(C);if(A&&P){const D=A(f,o,P);if(D!==0)return P===yS?D:-D}}return 0}).map(f=>{const o=f[n];return o?Object.assign(Object.assign({},f),{[n]:HR(o,t,n)}):f}):s},eme=e=>{const{prefixCls:t,mergedColumns:n,sortDirections:i,tableLocale:s,showSorterTooltip:d,onSorterChange:f}=e,[o,y]=I.useState(()=>UR(n,!0)),b=(B,N)=>{const j=[];return B.forEach((V,K)=>{const Y=r_(K,N);if(j.push(mf(V,Y)),Array.isArray(V.children)){const Z=b(V.children,Y);j.push.apply(j,zn(Z))}}),j},C=I.useMemo(()=>{let B=!0;const N=UR(n,!1);if(!N.length){const Y=b(n);return o.filter(({key:Z})=>Y.includes(Z))}const j=[];function V(Y){B?j.push(Y):j.push(Object.assign(Object.assign({},Y),{sortOrder:null}))}let K=null;return N.forEach(Y=>{K===null?(V(Y),Y.sortOrder&&(Y.multiplePriority===!1?B=!1:K=!0)):(K&&Y.multiplePriority!==!1||(B=!1),V(Y))}),j},[n,o]),P=I.useMemo(()=>{var B,N;const j=C.map(({column:V,sortOrder:K})=>({column:V,order:K}));return{sortColumns:j,sortColumn:(B=j[0])===null||B===void 0?void 0:B.column,sortOrder:(N=j[0])===null||N===void 0?void 0:N.order}},[C]),A=B=>{let N;B.multiplePriority===!1||!C.length||C[0].multiplePriority===!1?N=[B]:N=[].concat(zn(C.filter(({key:j})=>j!==B.key)),[B]),y(N),f(d5(N),N)};return[B=>aG(t,B,C,A,i,s,d),C,P,()=>d5(C)]},sG=(e,t)=>e.map(i=>{const s=Object.assign({},i);return s.title=LE(i.title,t),"children"in s&&(s.children=sG(s.children,t)),s}),tme=e=>[I.useCallback(n=>sG(n,e),[e])],nme=q8((e,t)=>{const{_renderTimes:n}=e,{_renderTimes:i}=t;return n!==i}),rme=X8((e,t)=>{const{_renderTimes:n}=e,{_renderTimes:i}=t;return n!==i}),ime=e=>{const{componentCls:t,lineWidth:n,lineType:i,tableBorderColor:s,tableHeaderBg:d,tablePaddingVertical:f,tablePaddingHorizontal:o,calc:y}=e,b=`${dt(n)} ${i} ${s}`,C=(P,A,D)=>({[`&${t}-${P}`]:{[`> ${t}-container`]:{[`> ${t}-content, > ${t}-body`]:{"\n            > table > tbody > tr > th,\n            > table > tbody > tr > td\n          ":{[`> ${t}-expanded-row-fixed`]:{margin:`${dt(y(A).mul(-1).equal())}
              ${dt(y(y(D).add(n)).mul(-1).equal())}`}}}}}});return{[`${t}-wrapper`]:{[`${t}${t}-bordered`]:Object.assign(Object.assign(Object.assign({[`> ${t}-title`]:{border:b,borderBottom:0},[`> ${t}-container`]:{borderInlineStart:b,borderTop:b,[`
            > ${t}-content,
            > ${t}-header,
            > ${t}-body,
            > ${t}-summary
          `]:{"> table":{"\n                > thead > tr > th,\n                > thead > tr > td,\n                > tbody > tr > th,\n                > tbody > tr > td,\n                > tfoot > tr > th,\n                > tfoot > tr > td\n              ":{borderInlineEnd:b},"> thead":{"> tr:not(:last-child) > th":{borderBottom:b},"> tr > th::before":{backgroundColor:"transparent !important"}},"\n                > thead > tr,\n                > tbody > tr,\n                > tfoot > tr\n              ":{[`> ${t}-cell-fix-right-first::after`]:{borderInlineEnd:b}},"\n                > tbody > tr > th,\n                > tbody > tr > td\n              ":{[`> ${t}-expanded-row-fixed`]:{margin:`${dt(y(f).mul(-1).equal())} ${dt(y(y(o).add(n)).mul(-1).equal())}`,"&::after":{position:"absolute",top:0,insetInlineEnd:n,bottom:0,borderInlineEnd:b,content:'""'}}}}}},[`&${t}-scroll-horizontal`]:{[`> ${t}-container > ${t}-body`]:{"> table > tbody":{[`
                > tr${t}-expanded-row,
                > tr${t}-placeholder
              `]:{"> th, > td":{borderInlineEnd:0}}}}}},C("middle",e.tablePaddingVerticalMiddle,e.tablePaddingHorizontalMiddle)),C("small",e.tablePaddingVerticalSmall,e.tablePaddingHorizontalSmall)),{[`> ${t}-footer`]:{border:b,borderTop:0}}),[`${t}-cell`]:{[`${t}-container:first-child`]:{borderTop:0},"&-scrollbar:not([rowspan])":{boxShadow:`0 ${dt(n)} 0 ${dt(n)} ${d}`}},[`${t}-bordered ${t}-cell-scrollbar`]:{borderInlineEnd:b}}}},ome=e=>{const{componentCls:t}=e;return{[`${t}-wrapper`]:{[`${t}-cell-ellipsis`]:Object.assign(Object.assign({},df),{wordBreak:"keep-all",[`
          &${t}-cell-fix-left-last,
          &${t}-cell-fix-right-first
        `]:{overflow:"visible",[`${t}-cell-content`]:{display:"block",overflow:"hidden",textOverflow:"ellipsis"}},[`${t}-column-title`]:{overflow:"hidden",textOverflow:"ellipsis",wordBreak:"keep-all"}})}}},ame=e=>{const{componentCls:t}=e;return{[`${t}-wrapper`]:{[`${t}-tbody > tr${t}-placeholder`]:{textAlign:"center",color:e.colorTextDisabled,"\n          &:hover > th,\n          &:hover > td,\n        ":{background:e.colorBgContainer}}}}},sme=e=>{const{componentCls:t,antCls:n,motionDurationSlow:i,lineWidth:s,paddingXS:d,lineType:f,tableBorderColor:o,tableExpandIconBg:y,tableExpandColumnWidth:b,borderRadius:C,tablePaddingVertical:P,tablePaddingHorizontal:A,tableExpandedRowBg:D,paddingXXS:k,expandIconMarginTop:B,expandIconSize:N,expandIconHalfInner:j,expandIconScale:V,calc:K}=e,Y=`${dt(s)} ${f} ${o}`,Z=K(k).sub(s).equal();return{[`${t}-wrapper`]:{[`${t}-expand-icon-col`]:{width:b},[`${t}-row-expand-icon-cell`]:{textAlign:"center",[`${t}-row-expand-icon`]:{display:"inline-flex",float:"none",verticalAlign:"sub"}},[`${t}-row-indent`]:{height:1,float:"left"},[`${t}-row-expand-icon`]:Object.assign(Object.assign({},Eee(e)),{position:"relative",float:"left",width:N,height:N,color:"inherit",lineHeight:dt(N),background:y,border:Y,borderRadius:C,transform:`scale(${V})`,"&:focus, &:hover, &:active":{borderColor:"currentcolor"},"&::before, &::after":{position:"absolute",background:"currentcolor",transition:`transform ${i} ease-out`,content:'""'},"&::before":{top:j,insetInlineEnd:Z,insetInlineStart:Z,height:s},"&::after":{top:Z,bottom:Z,insetInlineStart:j,width:s,transform:"rotate(90deg)"},"&-collapsed::before":{transform:"rotate(-180deg)"},"&-collapsed::after":{transform:"rotate(0deg)"},"&-spaced":{"&::before, &::after":{display:"none",content:"none"},background:"transparent",border:0,visibility:"hidden"}}),[`${t}-row-indent + ${t}-row-expand-icon`]:{marginTop:B,marginInlineEnd:d},[`tr${t}-expanded-row`]:{"&, &:hover":{"> th, > td":{background:D}},[`${n}-descriptions-view`]:{display:"flex",table:{flex:"auto",width:"100%"}}},[`${t}-expanded-row-fixed`]:{position:"relative",margin:`${dt(K(P).mul(-1).equal())} ${dt(K(A).mul(-1).equal())}`,padding:`${dt(P)} ${dt(A)}`}}}},lme=e=>{const{componentCls:t,antCls:n,iconCls:i,tableFilterDropdownWidth:s,tableFilterDropdownSearchWidth:d,paddingXXS:f,paddingXS:o,colorText:y,lineWidth:b,lineType:C,tableBorderColor:P,headerIconColor:A,fontSizeSM:D,tablePaddingHorizontal:k,borderRadius:B,motionDurationSlow:N,colorIcon:j,colorPrimary:V,tableHeaderFilterActiveBg:K,colorTextDisabled:Y,tableFilterDropdownBg:Z,tableFilterDropdownHeight:te,controlItemBgHover:ne,controlItemBgActive:se,boxShadowSecondary:ee,filterDropdownMenuBg:de,calc:fe}=e,ye=`${n}-dropdown`,ge=`${t}-filter-dropdown`,we=`${n}-tree`,Se=`${dt(b)} ${C} ${P}`;return[{[`${t}-wrapper`]:{[`${t}-filter-column`]:{display:"flex",justifyContent:"space-between"},[`${t}-filter-trigger`]:{position:"relative",display:"flex",alignItems:"center",marginBlock:fe(f).mul(-1).equal(),marginInline:`${dt(f)} ${dt(fe(k).div(2).mul(-1).equal())}`,padding:`0 ${dt(f)}`,color:A,fontSize:D,borderRadius:B,cursor:"pointer",transition:`all ${N}`,"&:hover":{color:j,background:K},"&.active":{color:V}}}},{[`${n}-dropdown`]:{[ge]:Object.assign(Object.assign({},ya(e)),{minWidth:s,backgroundColor:Z,borderRadius:B,boxShadow:ee,overflow:"hidden",[`${ye}-menu`]:{maxHeight:te,overflowX:"hidden",border:0,boxShadow:"none",borderRadius:"unset",backgroundColor:de,"&:empty::after":{display:"block",padding:`${dt(o)} 0`,color:Y,fontSize:D,textAlign:"center",content:'"Not Found"'}},[`${ge}-tree`]:{paddingBlock:`${dt(o)} 0`,paddingInline:o,[we]:{padding:0},[`${we}-treenode ${we}-node-content-wrapper:hover`]:{backgroundColor:ne},[`${we}-treenode-checkbox-checked ${we}-node-content-wrapper`]:{"&, &:hover":{backgroundColor:se}}},[`${ge}-search`]:{padding:o,borderBottom:Se,"&-input":{input:{minWidth:d},[i]:{color:Y}}},[`${ge}-checkall`]:{width:"100%",marginBottom:f,marginInlineStart:f},[`${ge}-btns`]:{display:"flex",justifyContent:"space-between",padding:`${dt(fe(o).sub(b).equal())} ${dt(o)}`,overflow:"hidden",borderTop:Se}})}},{[`${n}-dropdown ${ge}, ${ge}-submenu`]:{[`${n}-checkbox-wrapper + span`]:{paddingInlineStart:o,color:y},"> ul":{maxHeight:"calc(100vh - 130px)",overflowX:"hidden",overflowY:"auto"}}}]},cme=e=>{const{componentCls:t,lineWidth:n,colorSplit:i,motionDurationSlow:s,zIndexTableFixed:d,tableBg:f,zIndexTableSticky:o,calc:y}=e,b=i;return{[`${t}-wrapper`]:{[`
        ${t}-cell-fix-left,
        ${t}-cell-fix-right
      `]:{position:"sticky !important",zIndex:d,background:f},[`
        ${t}-cell-fix-left-first::after,
        ${t}-cell-fix-left-last::after
      `]:{position:"absolute",top:0,right:{_skip_check_:!0,value:0},bottom:y(n).mul(-1).equal(),width:30,transform:"translateX(100%)",transition:`box-shadow ${s}`,content:'""',pointerEvents:"none",willChange:"transform"},[`${t}-cell-fix-left-all::after`]:{display:"none"},[`
        ${t}-cell-fix-right-first::after,
        ${t}-cell-fix-right-last::after
      `]:{position:"absolute",top:0,bottom:y(n).mul(-1).equal(),left:{_skip_check_:!0,value:0},width:30,transform:"translateX(-100%)",transition:`box-shadow ${s}`,content:'""',pointerEvents:"none"},[`${t}-container`]:{position:"relative","&::before, &::after":{position:"absolute",top:0,bottom:0,zIndex:y(o).add(1).equal({unit:!1}),width:30,transition:`box-shadow ${s}`,content:'""',pointerEvents:"none"},"&::before":{insetInlineStart:0},"&::after":{insetInlineEnd:0}},[`${t}-ping-left`]:{[`&:not(${t}-has-fix-left) ${t}-container::before`]:{boxShadow:`inset 10px 0 8px -8px ${b}`},[`
          ${t}-cell-fix-left-first::after,
          ${t}-cell-fix-left-last::after
        `]:{boxShadow:`inset 10px 0 8px -8px ${b}`},[`${t}-cell-fix-left-last::before`]:{backgroundColor:"transparent !important"}},[`${t}-ping-right`]:{[`&:not(${t}-has-fix-right) ${t}-container::after`]:{boxShadow:`inset -10px 0 8px -8px ${b}`},[`
          ${t}-cell-fix-right-first::after,
          ${t}-cell-fix-right-last::after
        `]:{boxShadow:`inset -10px 0 8px -8px ${b}`}},[`${t}-fixed-column-gapped`]:{[`
        ${t}-cell-fix-left-first::after,
        ${t}-cell-fix-left-last::after,
        ${t}-cell-fix-right-first::after,
        ${t}-cell-fix-right-last::after
      `]:{boxShadow:"none"}}}}},ume=e=>{const{componentCls:t,antCls:n,margin:i}=e;return{[`${t}-wrapper ${t}-pagination${n}-pagination`]:{margin:`${dt(i)} 0`}}},dme=e=>{const{componentCls:t,tableRadius:n}=e;return{[`${t}-wrapper`]:{[t]:{[`${t}-title, ${t}-header`]:{borderRadius:`${dt(n)} ${dt(n)} 0 0`},[`${t}-title + ${t}-container`]:{borderStartStartRadius:0,borderStartEndRadius:0,[`${t}-header, table`]:{borderRadius:0},"table > thead > tr:first-child":{"th:first-child, th:last-child, td:first-child, td:last-child":{borderRadius:0}}},"&-container":{borderStartStartRadius:n,borderStartEndRadius:n,"table > thead > tr:first-child":{"> *:first-child":{borderStartStartRadius:n},"> *:last-child":{borderStartEndRadius:n}}},"&-footer":{borderRadius:`0 0 ${dt(n)} ${dt(n)}`}}}}},hme=e=>{const{componentCls:t}=e;return{[`${t}-wrapper-rtl`]:{direction:"rtl",table:{direction:"rtl"},[`${t}-pagination-left`]:{justifyContent:"flex-end"},[`${t}-pagination-right`]:{justifyContent:"flex-start"},[`${t}-row-expand-icon`]:{float:"right","&::after":{transform:"rotate(-90deg)"},"&-collapsed::before":{transform:"rotate(180deg)"},"&-collapsed::after":{transform:"rotate(0deg)"}},[`${t}-container`]:{"&::before":{insetInlineStart:"unset",insetInlineEnd:0},"&::after":{insetInlineStart:0,insetInlineEnd:"unset"},[`${t}-row-indent`]:{float:"right"}}}}},fme=e=>{const{componentCls:t,antCls:n,iconCls:i,fontSizeIcon:s,padding:d,paddingXS:f,headerIconColor:o,headerIconHoverColor:y,tableSelectionColumnWidth:b,tableSelectedRowBg:C,tableSelectedRowHoverBg:P,tableRowHoverBg:A,tablePaddingHorizontal:D,calc:k}=e;return{[`${t}-wrapper`]:{[`${t}-selection-col`]:{width:b,[`&${t}-selection-col-with-dropdown`]:{width:k(b).add(s).add(k(d).div(4)).equal()}},[`${t}-bordered ${t}-selection-col`]:{width:k(b).add(k(f).mul(2)).equal(),[`&${t}-selection-col-with-dropdown`]:{width:k(b).add(s).add(k(d).div(4)).add(k(f).mul(2)).equal()}},[`
        table tr th${t}-selection-column,
        table tr td${t}-selection-column,
        ${t}-selection-column
      `]:{paddingInlineEnd:e.paddingXS,paddingInlineStart:e.paddingXS,textAlign:"center",[`${n}-radio-wrapper`]:{marginInlineEnd:0}},[`table tr th${t}-selection-column${t}-cell-fix-left`]:{zIndex:k(e.zIndexTableFixed).add(1).equal({unit:!1})},[`table tr th${t}-selection-column::after`]:{backgroundColor:"transparent !important"},[`${t}-selection`]:{position:"relative",display:"inline-flex",flexDirection:"column"},[`${t}-selection-extra`]:{position:"absolute",top:0,zIndex:1,cursor:"pointer",transition:`all ${e.motionDurationSlow}`,marginInlineStart:"100%",paddingInlineStart:dt(k(D).div(4).equal()),[i]:{color:o,fontSize:s,verticalAlign:"baseline","&:hover":{color:y}}},[`${t}-tbody`]:{[`${t}-row`]:{[`&${t}-row-selected`]:{[`> ${t}-cell`]:{background:C,"&-row-hover":{background:P}}},[`> ${t}-cell-row-hover`]:{background:A}}}}}},pme=e=>{const{componentCls:t,tableExpandColumnWidth:n,calc:i}=e,s=(d,f,o,y)=>({[`${t}${t}-${d}`]:{fontSize:y,[`
        ${t}-title,
        ${t}-footer,
        ${t}-cell,
        ${t}-thead > tr > th,
        ${t}-tbody > tr > th,
        ${t}-tbody > tr > td,
        tfoot > tr > th,
        tfoot > tr > td
      `]:{padding:`${dt(f)} ${dt(o)}`},[`${t}-filter-trigger`]:{marginInlineEnd:dt(i(o).div(2).mul(-1).equal())},[`${t}-expanded-row-fixed`]:{margin:`${dt(i(f).mul(-1).equal())} ${dt(i(o).mul(-1).equal())}`},[`${t}-tbody`]:{[`${t}-wrapper:only-child ${t}`]:{marginBlock:dt(i(f).mul(-1).equal()),marginInline:`${dt(i(n).sub(o).equal())} ${dt(i(o).mul(-1).equal())}`}},[`${t}-selection-extra`]:{paddingInlineStart:dt(i(o).div(4).equal())}}});return{[`${t}-wrapper`]:Object.assign(Object.assign({},s("middle",e.tablePaddingVerticalMiddle,e.tablePaddingHorizontalMiddle,e.tableFontSizeMiddle)),s("small",e.tablePaddingVerticalSmall,e.tablePaddingHorizontalSmall,e.tableFontSizeSmall))}},mme=e=>{const{componentCls:t,marginXXS:n,fontSizeIcon:i,headerIconColor:s,headerIconHoverColor:d}=e;return{[`${t}-wrapper`]:{[`${t}-thead th${t}-column-has-sorters`]:{outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}, left 0s`,"&:hover":{background:e.tableHeaderSortHoverBg,"&::before":{backgroundColor:"transparent !important"}},"&:focus-visible":{color:e.colorPrimary},[`
          &${t}-cell-fix-left:hover,
          &${t}-cell-fix-right:hover
        `]:{background:e.tableFixedHeaderSortActiveBg}},[`${t}-thead th${t}-column-sort`]:{background:e.tableHeaderSortBg,"&::before":{backgroundColor:"transparent !important"}},[`td${t}-column-sort`]:{background:e.tableBodySortBg},[`${t}-column-title`]:{position:"relative",zIndex:1,flex:1,minWidth:0},[`${t}-column-sorters`]:{display:"flex",flex:"auto",alignItems:"center",justifyContent:"space-between","&::after":{position:"absolute",inset:0,width:"100%",height:"100%",content:'""'}},[`${t}-column-sorters-tooltip-target-sorter`]:{"&::after":{content:"none"}},[`${t}-column-sorter`]:{marginInlineStart:n,color:s,fontSize:0,transition:`color ${e.motionDurationSlow}`,"&-inner":{display:"inline-flex",flexDirection:"column",alignItems:"center"},"&-up, &-down":{fontSize:i,"&.active":{color:e.colorPrimary}},[`${t}-column-sorter-up + ${t}-column-sorter-down`]:{marginTop:"-0.3em"}},[`${t}-column-sorters:hover ${t}-column-sorter`]:{color:d}}}},gme=e=>{const{componentCls:t,opacityLoading:n,tableScrollThumbBg:i,tableScrollThumbBgHover:s,tableScrollThumbSize:d,tableScrollBg:f,zIndexTableSticky:o,stickyScrollBarBorderRadius:y,lineWidth:b,lineType:C,tableBorderColor:P}=e,A=`${dt(b)} ${C} ${P}`;return{[`${t}-wrapper`]:{[`${t}-sticky`]:{"&-holder":{position:"sticky",zIndex:o,background:e.colorBgContainer},"&-scroll":{position:"sticky",bottom:0,height:`${dt(d)} !important`,zIndex:o,display:"flex",alignItems:"center",background:f,borderTop:A,opacity:n,"&:hover":{transformOrigin:"center bottom"},"&-bar":{height:d,backgroundColor:i,borderRadius:y,transition:`all ${e.motionDurationSlow}, transform 0s`,position:"absolute",bottom:0,"&:hover, &-active":{backgroundColor:s}}}}}}},h5=e=>{const{componentCls:t,lineWidth:n,tableBorderColor:i,calc:s}=e,d=`${dt(n)} ${e.lineType} ${i}`;return{[`${t}-wrapper`]:{[`${t}-summary`]:{position:"relative",zIndex:e.zIndexTableFixed,background:e.tableBg,"> tr":{"> th, > td":{borderBottom:d}}},[`div${t}-summary`]:{boxShadow:`0 ${dt(s(n).mul(-1).equal())} 0 ${i}`}}}},vme=e=>{const{componentCls:t,motionDurationMid:n,lineWidth:i,lineType:s,tableBorderColor:d,calc:f}=e,o=`${dt(i)} ${s} ${d}`,y=`${t}-expanded-row-cell`;return{[`${t}-wrapper`]:{[`${t}-tbody-virtual`]:{[`${t}-tbody-virtual-holder-inner`]:{[`
            & > ${t}-row, 
            & > div:not(${t}-row) > ${t}-row
          `]:{display:"flex",boxSizing:"border-box",width:"100%"}},[`${t}-cell`]:{borderBottom:o,transition:`background ${n}`},[`${t}-expanded-row`]:{[`${y}${y}-fixed`]:{position:"sticky",insetInlineStart:0,overflow:"hidden",width:`calc(var(--virtual-width) - ${dt(i)})`,borderInlineEnd:"none"}}},[`${t}-bordered`]:{[`${t}-tbody-virtual`]:{"&:after":{content:'""',insetInline:0,bottom:0,borderBottom:o,position:"absolute"},[`${t}-cell`]:{borderInlineEnd:o,[`&${t}-cell-fix-right-first:before`]:{content:'""',position:"absolute",insetBlock:0,insetInlineStart:f(i).mul(-1).equal(),borderInlineStart:o}}},[`&${t}-virtual`]:{[`${t}-placeholder ${t}-cell`]:{borderInlineEnd:o,borderBottom:o}}}}}},_me=e=>{const{componentCls:t,fontWeightStrong:n,tablePaddingVertical:i,tablePaddingHorizontal:s,tableExpandColumnWidth:d,lineWidth:f,lineType:o,tableBorderColor:y,tableFontSize:b,tableBg:C,tableRadius:P,tableHeaderTextColor:A,motionDurationMid:D,tableHeaderBg:k,tableHeaderCellSplitColor:B,tableFooterTextColor:N,tableFooterBg:j,calc:V}=e,K=`${dt(f)} ${o} ${y}`;return{[`${t}-wrapper`]:Object.assign(Object.assign({clear:"both",maxWidth:"100%","--rc-virtual-list-scrollbar-bg":e.tableScrollBg},Kp()),{[t]:Object.assign(Object.assign({},ya(e)),{fontSize:b,background:C,borderRadius:`${dt(P)} ${dt(P)} 0 0`,scrollbarColor:`${e.tableScrollThumbBg} ${e.tableScrollBg}`}),table:{width:"100%",textAlign:"start",borderRadius:`${dt(P)} ${dt(P)} 0 0`,borderCollapse:"separate",borderSpacing:0},[`
          ${t}-cell,
          ${t}-thead > tr > th,
          ${t}-tbody > tr > th,
          ${t}-tbody > tr > td,
          tfoot > tr > th,
          tfoot > tr > td
        `]:{position:"relative",padding:`${dt(i)} ${dt(s)}`,overflowWrap:"break-word"},[`${t}-title`]:{padding:`${dt(i)} ${dt(s)}`},[`${t}-thead`]:{"\n          > tr > th,\n          > tr > td\n        ":{position:"relative",color:A,fontWeight:n,textAlign:"start",background:k,borderBottom:K,transition:`background ${D} ease`,"&[colspan]:not([colspan='1'])":{textAlign:"center"},[`&:not(:last-child):not(${t}-selection-column):not(${t}-row-expand-icon-cell):not([colspan])::before`]:{position:"absolute",top:"50%",insetInlineEnd:0,width:1,height:"1.6em",backgroundColor:B,transform:"translateY(-50%)",transition:`background-color ${D}`,content:'""'}},"> tr:not(:last-child) > th[colspan]":{borderBottom:0}},[`${t}-tbody`]:{"> tr":{"> th, > td":{transition:`background ${D}, border-color ${D}`,borderBottom:K,[`
              > ${t}-wrapper:only-child,
              > ${t}-expanded-row-fixed > ${t}-wrapper:only-child
            `]:{[t]:{marginBlock:dt(V(i).mul(-1).equal()),marginInline:`${dt(V(d).sub(s).equal())}
                ${dt(V(s).mul(-1).equal())}`,[`${t}-tbody > tr:last-child > td`]:{borderBottomWidth:0,"&:first-child, &:last-child":{borderRadius:0}}}}},"> th":{position:"relative",color:A,fontWeight:n,textAlign:"start",background:k,borderBottom:K,transition:`background ${D} ease`},[`& > ${t}-measure-cell`]:{paddingBlock:"0 !important",borderBlock:"0 !important",[`${t}-measure-cell-content`]:{height:0,overflow:"hidden",pointerEvents:"none"}}}},[`${t}-footer`]:{padding:`${dt(i)} ${dt(s)}`,color:N,background:j}})}},yme=e=>{const{colorFillAlter:t,colorBgContainer:n,colorTextHeading:i,colorFillSecondary:s,colorFillContent:d,controlItemBgActive:f,controlItemBgActiveHover:o,padding:y,paddingSM:b,paddingXS:C,colorBorderSecondary:P,borderRadiusLG:A,controlHeight:D,colorTextPlaceholder:k,fontSize:B,fontSizeSM:N,lineHeight:j,lineWidth:V,colorIcon:K,colorIconHover:Y,opacityLoading:Z,controlInteractiveSize:te}=e,ne=new no(s).onBackground(n).toHexString(),se=new no(d).onBackground(n).toHexString(),ee=new no(t).onBackground(n).toHexString(),de=new no(K),fe=new no(Y),ye=te/2-V,ge=ye*2+V*3;return{headerBg:ee,headerColor:i,headerSortActiveBg:ne,headerSortHoverBg:se,bodySortBg:ee,rowHoverBg:ee,rowSelectedBg:f,rowSelectedHoverBg:o,rowExpandedBg:t,cellPaddingBlock:y,cellPaddingInline:y,cellPaddingBlockMD:b,cellPaddingInlineMD:C,cellPaddingBlockSM:C,cellPaddingInlineSM:C,borderColor:P,headerBorderRadius:A,footerBg:ee,footerColor:i,cellFontSize:B,cellFontSizeMD:B,cellFontSizeSM:B,headerSplitColor:P,fixedHeaderSortActiveBg:ne,headerFilterHoverBg:d,filterDropdownMenuBg:n,filterDropdownBg:n,expandIconBg:n,selectionColumnWidth:D,stickyScrollBarBg:k,stickyScrollBarBorderRadius:100,expandIconMarginTop:(B*j-V*3)/2-Math.ceil((N*1.4-V*3)/2),headerIconColor:de.clone().setA(de.a*Z).toRgbString(),headerIconHoverColor:fe.clone().setA(fe.a*Z).toRgbString(),expandIconHalfInner:ye,expandIconSize:ge,expandIconScale:te/ge}},f5=2,xme=za("Table",e=>{const{colorTextHeading:t,colorSplit:n,colorBgContainer:i,controlInteractiveSize:s,headerBg:d,headerColor:f,headerSortActiveBg:o,headerSortHoverBg:y,bodySortBg:b,rowHoverBg:C,rowSelectedBg:P,rowSelectedHoverBg:A,rowExpandedBg:D,cellPaddingBlock:k,cellPaddingInline:B,cellPaddingBlockMD:N,cellPaddingInlineMD:j,cellPaddingBlockSM:V,cellPaddingInlineSM:K,borderColor:Y,footerBg:Z,footerColor:te,headerBorderRadius:ne,cellFontSize:se,cellFontSizeMD:ee,cellFontSizeSM:de,headerSplitColor:fe,fixedHeaderSortActiveBg:ye,headerFilterHoverBg:ge,filterDropdownBg:we,expandIconBg:Se,selectionColumnWidth:xe,stickyScrollBarBg:Te,calc:ze}=e,Ue=xo(e,{tableFontSize:se,tableBg:i,tableRadius:ne,tablePaddingVertical:k,tablePaddingHorizontal:B,tablePaddingVerticalMiddle:N,tablePaddingHorizontalMiddle:j,tablePaddingVerticalSmall:V,tablePaddingHorizontalSmall:K,tableBorderColor:Y,tableHeaderTextColor:f,tableHeaderBg:d,tableFooterTextColor:te,tableFooterBg:Z,tableHeaderCellSplitColor:fe,tableHeaderSortBg:o,tableHeaderSortHoverBg:y,tableBodySortBg:b,tableFixedHeaderSortActiveBg:ye,tableHeaderFilterActiveBg:ge,tableFilterDropdownBg:we,tableRowHoverBg:C,tableSelectedRowBg:P,tableSelectedRowHoverBg:A,zIndexTableFixed:f5,zIndexTableSticky:ze(f5).add(1).equal({unit:!1}),tableFontSizeMiddle:ee,tableFontSizeSmall:de,tableSelectionColumnWidth:xe,tableExpandIconBg:Se,tableExpandColumnWidth:ze(s).add(ze(e.padding).mul(2)).equal(),tableExpandedRowBg:D,tableFilterDropdownWidth:120,tableFilterDropdownHeight:264,tableFilterDropdownSearchWidth:140,tableScrollThumbSize:8,tableScrollThumbBg:Te,tableScrollThumbBgHover:t,tableScrollBg:n});return[_me(Ue),ume(Ue),h5(Ue),mme(Ue),lme(Ue),ime(Ue),dme(Ue),sme(Ue),h5(Ue),ame(Ue),fme(Ue),cme(Ue),gme(Ue),ome(Ue),pme(Ue),hme(Ue),vme(Ue)]},yme,{unitless:{expandIconScale:!0}}),p5=[],bme=(e,t)=>{var n,i;const{prefixCls:s,className:d,rootClassName:f,style:o,size:y,bordered:b,dropdownPrefixCls:C,dataSource:P,pagination:A,rowSelection:D,rowKey:k="key",rowClassName:B,columns:N,children:j,childrenColumnName:V,onChange:K,getPopupContainer:Y,loading:Z,expandIcon:te,expandable:ne,expandedRowRender:se,expandIconColumnIndex:ee,indentSize:de,scroll:fe,sortDirections:ye,locale:ge,showSorterTooltip:we={target:"full-header"},virtual:Se}=e;qv();const xe=I.useMemo(()=>N||dD(j),[N,j]),Te=I.useMemo(()=>xe.some(ie=>ie.responsive),[xe]),ze=HO(Te),Ue=I.useMemo(()=>{const ie=new Set(Object.keys(ze).filter(_e=>ze[_e]));return xe.filter(_e=>!_e.responsive||_e.responsive.some(Re=>ie.has(Re)))},[xe,ze]),We=as(e,["className","style","columns"]),{locale:Be=uf,direction:Xe,table:qe,renderEmpty:at,getPrefixCls:Ke,getPopupContainer:tt}=I.useContext(ji),vt=Bd(y),Pt=Object.assign(Object.assign({},Be.Table),ge),ft=P||p5,Nt=Ke("table",s),Rt=Ke("dropdown",C),[,pt]=Vs(),yt=Wu(Nt),[xt,bt,Ct]=xme(Nt,yt),tn=Object.assign(Object.assign({childrenColumnName:V,expandIconColumnIndex:ee},ne),{expandIcon:(n=ne==null?void 0:ne.expandIcon)!==null&&n!==void 0?n:(i=qe==null?void 0:qe.expandable)===null||i===void 0?void 0:i.expandIcon}),{childrenColumnName:Zt="children"}=tn,In=I.useMemo(()=>ft.some(ie=>ie==null?void 0:ie[Zt])?"nest":se||ne!=null&&ne.expandedRowRender?"row":null,[ft]),Cn={body:I.useRef(null)},Mt=jfe(Nt),hn=I.useRef(null),Jt=I.useRef(null);Bfe(t,()=>Object.assign(Object.assign({},Jt.current),{nativeElement:hn.current}));const Ut=I.useMemo(()=>typeof k=="function"?k:ie=>ie==null?void 0:ie[k],[k]),[Tn]=Upe(ft,Zt,Ut),On={},Kn=(ie,_e,Re=!1)=>{var De,Ge,ot,Ye;const rt=Object.assign(Object.assign({},On),ie);Re&&((De=On.resetPagination)===null||De===void 0||De.call(On),!((Ge=rt.pagination)===null||Ge===void 0)&&Ge.current&&(rt.pagination.current=1),A&&((ot=A.onChange)===null||ot===void 0||ot.call(A,1,(Ye=rt.pagination)===null||Ye===void 0?void 0:Ye.pageSize))),fe&&fe.scrollToFirstRowOnChange!==!1&&Cn.body.current&&Pte(0,{getContainer:()=>Cn.body.current}),K==null||K(rt.pagination,rt.filters,rt.sorter,{currentDataSource:VR(HR(ft,rt.sorterStates,Zt),rt.filterStates,Zt),action:_e})},Un=(ie,_e)=>{Kn({sorter:ie,sorterStates:_e},"sort",!1)},[Pn,Qn,un,nn]=eme({prefixCls:Nt,mergedColumns:Ue,onSorterChange:Un,sortDirections:ye||["ascend","descend"],tableLocale:Pt,showSorterTooltip:we}),$n=I.useMemo(()=>HR(ft,Qn,Zt),[ft,Qn]);On.sorter=nn(),On.sorterStates=Qn;const Ln=(ie,_e)=>{Kn({filters:ie,filterStates:_e},"filter",!0)},[qn,er,tr]=Vpe({prefixCls:Nt,locale:Pt,dropdownPrefixCls:Rt,mergedColumns:Ue,onFilterChange:Ln,getPopupContainer:Y||tt,rootClassName:St(f,yt)}),Jn=VR($n,er,Zt);On.filters=tr,On.filterStates=er;const Ir=I.useMemo(()=>{const ie={};return Object.keys(tr).forEach(_e=>{tr[_e]!==null&&(ie[_e]=tr[_e])}),Object.assign(Object.assign({},un),{filters:ie})},[un,tr]),[_r]=tme(Ir),$r=(ie,_e)=>{Kn({pagination:Object.assign(Object.assign({},On.pagination),{current:ie,pageSize:_e})},"paginate")},[mr,yi]=Wpe(Jn.length,$r,A);On.pagination=A===!1?{}:Gpe(mr,A),On.resetPagination=yi;const Vr=I.useMemo(()=>{if(A===!1||!mr.pageSize)return Jn;const{current:ie=1,total:_e,pageSize:Re=oG}=mr;return Jn.length<_e?Jn.length>Re?Jn.slice((ie-1)*Re,ie*Re):Jn:Jn.slice((ie-1)*Re,ie*Re)},[!!A,Jn,mr==null?void 0:mr.current,mr==null?void 0:mr.pageSize,mr==null?void 0:mr.total]),[Kr,Rr]=Ffe({prefixCls:Nt,data:Jn,pageData:Vr,getRowKey:Ut,getRecordByKey:Tn,expandType:In,childrenColumnName:Zt,locale:Pt,getPopupContainer:Y||tt},D),ii=(ie,_e,Re)=>{let De;return typeof B=="function"?De=St(B(ie,_e,Re)):De=St(B),St({[`${Nt}-row-selected`]:Rr.has(Ut(ie,_e))},De)};tn.__PARENT_RENDER_ICON__=tn.expandIcon,tn.expandIcon=tn.expandIcon||te||$fe(Pt),In==="nest"&&tn.expandIconColumnIndex===void 0?tn.expandIconColumnIndex=D?1:0:tn.expandIconColumnIndex>0&&D&&(tn.expandIconColumnIndex-=1),typeof tn.indentSize!="number"&&(tn.indentSize=typeof de=="number"?de:15);const Hr=I.useCallback(ie=>_r(Kr(qn(Pn(ie)))),[Pn,qn,Kr]),ut=()=>{if(A===!1||!(mr!=null&&mr.total))return{};const ie=()=>mr.size||(vt==="small"||vt==="middle"?"small":void 0),_e=Ft=>{const jt=Ft==="left"?"start":Ft==="right"?"end":Ft;return I.createElement(ohe,Object.assign({},mr,{align:mr.align||jt,className:St(`${Nt}-pagination`,mr.className),size:ie()}))},Re=Xe==="rtl"?"left":"right",De=mr.position;if(De===null||!Array.isArray(De))return{bottom:_e(Re)};const Ge=De.find(Ft=>typeof Ft=="string"&&Ft.toLowerCase().includes("top")),ot=De.find(Ft=>typeof Ft=="string"&&Ft.toLowerCase().includes("bottom")),Ye=De.every(Ft=>`${Ft}`=="none"),rt=Ge?Ge.toLowerCase().replace("top",""):"",zt=ot?ot.toLowerCase().replace("bottom",""):"",it=!Ge&&!ot&&!Ye,$t=()=>rt?_e(rt):void 0,Qt=()=>{if(zt)return _e(zt);if(it)return _e(Re)};return{top:$t(),bottom:Qt()}},ur=I.useMemo(()=>typeof Z=="boolean"?{spinning:Z}:typeof Z=="object"&&Z!==null?Object.assign({spinning:!0},Z):void 0,[Z]),fr=St(Ct,yt,`${Nt}-wrapper`,qe==null?void 0:qe.className,{[`${Nt}-wrapper-rtl`]:Xe==="rtl"},d,f,bt),Fn=Object.assign(Object.assign({},qe==null?void 0:qe.style),o),Gt=I.useMemo(()=>ur!=null&&ur.spinning&&ft===p5?null:typeof(ge==null?void 0:ge.emptyText)<"u"?ge.emptyText:(at==null?void 0:at("Table"))||I.createElement(CH,{componentName:"Table"}),[ur==null?void 0:ur.spinning,ft,ge==null?void 0:ge.emptyText,at]),mn=Se?rme:nme,Xn={},gr=I.useMemo(()=>{const{fontSize:ie,lineHeight:_e,lineWidth:Re,padding:De,paddingXS:Ge,paddingSM:ot}=pt,Ye=Math.floor(ie*_e);switch(vt){case"middle":return ot*2+Ye+Re;case"small":return Ge*2+Ye+Re;default:return De*2+Ye+Re}},[pt,vt]);Se&&(Xn.listItemHeight=gr);const{top:je,bottom:re}=ut();return xt(I.createElement("div",{ref:hn,className:fr,style:Fn},I.createElement(D8,Object.assign({spinning:!1},ur),je,I.createElement(mn,Object.assign({},Xn,We,{ref:Jt,columns:Ue,direction:Xe,expandable:tn,prefixCls:Nt,className:St({[`${Nt}-middle`]:vt==="middle",[`${Nt}-small`]:vt==="small",[`${Nt}-bordered`]:b,[`${Nt}-empty`]:ft.length===0},Ct,yt,bt),data:Vr,rowKey:Ut,rowClassName:ii,emptyText:Gt,internalHooks:ub,internalRefs:Cn,transformColumns:Hr,getContainerWidth:Mt,measureRowRender:ie=>I.createElement(im,{getPopupContainer:_e=>_e},ie)})),re)))},wme=I.forwardRef(bme),Sme=(e,t)=>{const n=I.useRef(0);return n.current+=1,I.createElement(wme,Object.assign({},e,{ref:t,_renderTimes:n.current}))},ju=I.forwardRef(Sme);ju.SELECTION_COLUMN=Lh;ju.EXPAND_COLUMN=Fh;ju.SELECTION_ALL=FR;ju.SELECTION_INVERT=NR;ju.SELECTION_NONE=BR;ju.Column=Tfe;ju.ColumnGroup=Ife;ju.Summary=F8;const Cme=e=>{const{paddingXXS:t,lineWidth:n,tagPaddingHorizontal:i,componentCls:s,calc:d}=e,f=d(i).sub(n).equal(),o=d(t).sub(n).equal();return{[s]:Object.assign(Object.assign({},ya(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:f,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${dt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${s}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${s}-close-icon`]:{marginInlineStart:o,fontSize:e.tagIconSize,color:e.colorIcon,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${s}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${s}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:f}}),[`${s}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},_D=e=>{const{lineWidth:t,fontSizeIcon:n,calc:i}=e,s=e.fontSizeSM;return xo(e,{tagFontSize:s,tagLineHeight:dt(i(e.lineHeightSM).mul(s).equal()),tagIconSize:i(n).sub(i(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},yD=e=>({defaultBg:new no(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),lG=za("Tag",e=>{const t=_D(e);return Cme(t)},yD);var Eme=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Tme=I.forwardRef((e,t)=>{const{prefixCls:n,style:i,className:s,checked:d,children:f,icon:o,onChange:y,onClick:b}=e,C=Eme(e,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:P,tag:A}=I.useContext(ji),D=K=>{y==null||y(!d),b==null||b(K)},k=P("tag",n),[B,N,j]=lG(k),V=St(k,`${k}-checkable`,{[`${k}-checkable-checked`]:d},A==null?void 0:A.className,s,N,j);return B(I.createElement("span",Object.assign({},C,{ref:t,style:Object.assign(Object.assign({},i),A==null?void 0:A.style),className:V,onClick:D}),o,I.createElement("span",null,f)))}),Ime=e=>wU(e,(t,{textColor:n,lightBorderColor:i,lightColor:s,darkColor:d})=>({[`${e.componentCls}${e.componentCls}-${t}`]:{color:n,background:s,borderColor:i,"&-inverse":{color:e.colorTextLightSolid,background:d,borderColor:d},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}})),Pme=sE(["Tag","preset"],e=>{const t=_D(e);return Ime(t)},yD);function Mme(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const Dw=(e,t,n)=>{const i=Mme(n);return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:e[`color${n}`],background:e[`color${i}Bg`],borderColor:e[`color${i}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Rme=sE(["Tag","status"],e=>{const t=_D(e);return[Dw(t,"success","Success"),Dw(t,"processing","Info"),Dw(t,"error","Error"),Dw(t,"warning","Warning")]},yD);var Ame=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n};const Ome=I.forwardRef((e,t)=>{const{prefixCls:n,className:i,rootClassName:s,style:d,children:f,icon:o,color:y,onClose:b,bordered:C=!0,visible:P}=e,A=Ame(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:D,direction:k,tag:B}=I.useContext(ji),[N,j]=I.useState(!0),V=as(A,["closeIcon","closable"]);I.useEffect(()=>{P!==void 0&&j(P)},[P]);const K=NH(y),Y=$se(y),Z=K||Y,te=Object.assign(Object.assign({backgroundColor:y&&!Z?y:void 0},B==null?void 0:B.style),d),ne=D("tag",n),[se,ee,de]=lG(ne),fe=St(ne,B==null?void 0:B.className,{[`${ne}-${y}`]:Z,[`${ne}-has-color`]:y&&!Z,[`${ne}-hidden`]:!N,[`${ne}-rtl`]:k==="rtl",[`${ne}-borderless`]:!C},i,s,ee,de),ye=ze=>{ze.stopPropagation(),b==null||b(ze),!ze.defaultPrevented&&j(!1)},[,ge]=Pie(xB(e),xB(B),{closable:!1,closeIconRender:ze=>{const Ue=I.createElement("span",{className:`${ne}-close-icon`,onClick:ye},ze);return $U(ze,Ue,We=>({onClick:Be=>{var Xe;(Xe=We==null?void 0:We.onClick)===null||Xe===void 0||Xe.call(We,Be),ye(Be)},className:St(We==null?void 0:We.className,`${ne}-close-icon`)}))}}),we=typeof A.onClick=="function"||f&&f.type==="a",Se=o||null,xe=Se?I.createElement(I.Fragment,null,Se,f&&I.createElement("span",null,f)):f,Te=I.createElement("span",Object.assign({},V,{ref:t,className:fe,style:te}),xe,ge,K&&I.createElement(Pme,{key:"preset",prefixCls:ne}),Y&&I.createElement(Rme,{key:"status",prefixCls:ne}));return se(we?I.createElement(hE,{component:"Tag"},Te):Te)}),cG=Ome;cG.CheckableTag=Tme;var Dme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},Lme=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Dme}))},zme=I.forwardRef(Lme),kme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},Fme=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:kme}))},m5=I.forwardRef(Fme),Nme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 289.1a362.49 362.49 0 00-79.9-115.7 370.83 370.83 0 00-118.2-77.8C610.7 76.6 562.1 67 512 67c-50.1 0-98.7 9.6-144.5 28.5-44.3 18.3-84 44.5-118.2 77.8A363.6 363.6 0 00169.4 289c-19.5 45-29.4 92.8-29.4 142 0 70.6 16.9 140.9 50.1 208.7 26.7 54.5 64 107.6 111 158.1 80.3 86.2 164.5 138.9 188.4 153a43.9 43.9 0 0022.4 6.1c7.8 0 15.5-2 22.4-6.1 23.9-14.1 108.1-66.8 188.4-153 47-50.4 84.3-103.6 111-158.1C867.1 572 884 501.8 884 431.1c0-49.2-9.9-97-29.4-142zM512 880.2c-65.9-41.9-300-207.8-300-449.1 0-77.9 31.1-151.1 87.6-206.3C356.3 169.5 431.7 139 512 139s155.7 30.5 212.4 85.9C780.9 280 812 353.2 812 431.1c0 241.3-234.1 407.2-300 449.1zm0-617.2c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 551c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 439c0-29.9 11.7-58 32.8-79.2C454 338.6 482.1 327 512 327c29.9 0 58 11.6 79.2 32.8C612.4 381 624 409.1 624 439c0 29.9-11.6 58-32.8 79.2z"}}]},name:"environment",theme:"outlined"},Bme=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Nme}))},$me=I.forwardRef(Bme),jme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"},Vme=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:jme}))},Ume=I.forwardRef(Vme),Hme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"},Gme=function(t,n){return I.createElement(Fo,kn({},t,{ref:n,icon:Hme}))},Wme=I.forwardRef(Gme);const GR=function(e,t){const n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},i={on(d,f,o){if(n[d]===void 0)throw new Error(`Invalid event type: ${d}`);n[d].push({selector:f,fn:o})},render(d){t.store.featureChanged(d)}},s=function(d,f){const o=n[d];let y=o.length;for(;y--;){const b=o[y];if(b.selector(f)){b.fn.call(i,f)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(i),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(d){s("drag",d)},click(d){s("click",d)},mousemove(d){s("mousemove",d)},mousedown(d){s("mousedown",d)},mouseup(d){s("mouseup",d)},mouseout(d){s("mouseout",d)},keydown(d){s("keydown",d)},keyup(d){s("keyup",d)},touchstart(d){s("touchstart",d)},touchmove(d){s("touchmove",d)},touchend(d){s("touchend",d)},tap(d){s("tap",d)}}};var xD={},zE={};zE.RADIUS=6378137;zE.FLATTENING=1/298.257223563;zE.POLAR_RADIUS=63567523142e-4;var g5=zE;xD.geometry=uG;xD.ring=WR;function uG(e){var t=0,n;switch(e.type){case"Polygon":return v5(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=v5(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=uG(e.geometries[n]);return t}}function v5(e){var t=0;if(e&&e.length>0){t+=Math.abs(WR(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(WR(e[n]))}return t}function WR(e){var t,n,i,s,d,f,o,y=0,b=e.length;if(b>2){for(o=0;o<b;o++)o===b-2?(s=b-2,d=b-1,f=0):o===b-1?(s=b-1,d=0,f=1):(s=o,d=o+1,f=o+2),t=e[s],n=e[d],i=e[f],y+=(hP(i[0])-hP(t[0]))*Math.sin(hP(n[1]));y=y*g5.RADIUS*g5.RADIUS/2}return y}function hP(e){return e*Math.PI/180}const Cl={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},dc={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},va={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},El={POLYGON:"polygon",LINE:"line_string",POINT:"point"},si={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},lo={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},cl={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},db={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},Fs={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},ps={ACTIVE:"true",INACTIVE:"false"},dG=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],qme=-90,qR=-85,Kme=90,KR=85,Xme=-270,Zme=270,hG=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:Kme,LAT_MIN:qme,LAT_RENDERED_MAX:KR,LAT_RENDERED_MIN:qR,LNG_MAX:Zme,LNG_MIN:Xme,activeStates:ps,classes:Cl,cursors:va,events:cl,geojsonTypes:si,interactions:dG,meta:Fs,modes:lo,sources:dc,types:El,updateActions:db},Symbol.toStringTag,{value:"Module"})),_5={Point:0,LineString:1,MultiLineString:1,Polygon:2};function Yme(e,t){const n=_5[e.geometry.type]-_5[t.geometry.type];return n===0&&e.geometry.type===si.POLYGON?e.area-t.area:n}function fG(e){return e.map(t=>(t.geometry.type===si.POLYGON&&(t.area=xD.geometry({type:si.FEATURE,property:{},geometry:t.geometry})),t)).sort(Yme).map(t=>(delete t.area,t))}function pG(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function pc(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,n=e.length;t<n;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}pc.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};pc.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};pc.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};pc.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,n)=>t.v-n.v).map(t=>t.k)};pc.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const Jme=[Fs.FEATURE,Fs.MIDPOINT,Fs.VERTEX],kv={click:Qme,touch:ege};function Qme(e,t,n){return mG(e,t,n,n.options.clickBuffer)}function ege(e,t,n){return mG(e,t,n,n.options.touchBuffer)}function mG(e,t,n,i){if(n.map===null)return[];const s=e?pG(e,i):t,d={};n.options.styles&&(d.layers=n.options.styles.map(b=>b.id).filter(b=>n.map.getLayer(b)!=null));const f=n.map.queryRenderedFeatures(s,d).filter(b=>Jme.indexOf(b.properties.meta)!==-1),o=new pc,y=[];return f.forEach(b=>{const C=b.properties.id;o.has(C)||(o.add(C),y.push(b))}),fG(y)}function xS(e,t){const n=kv.click(e,null,t),i={mouse:va.NONE};return n[0]&&(i.mouse=n[0].properties.active===ps.ACTIVE?va.MOVE:va.POINTER,i.feature=n[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(i.mouse=va.ADD),t.ui.queueMapClasses(i),t.ui.updateMapClasses(),n[0]}function bD(e,t){const n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)}const tge=4,nge=12,rge=500;function XR(e,t,n={}){const i=n.fineTolerance!=null?n.fineTolerance:tge,s=n.grossTolerance!=null?n.grossTolerance:nge,d=n.interval!=null?n.interval:rge;e.point=e.point||t.point,e.time=e.time||t.time;const f=bD(e.point,t.point);return f<i||f<s&&t.time-e.time<d}const ige=25,oge=250;function ZR(e,t,n={}){const i=n.tolerance!=null?n.tolerance:ige,s=n.interval!=null?n.interval:oge;return e.point=e.point||t.point,e.time=e.time||t.time,bD(e.point,t.point)<i&&t.time-e.time<s}let age=(e,t=21)=>(n=t)=>{let i="",s=n|0;for(;s--;)i+=e[Math.random()*e.length|0];return i};const sge=age("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function wD(){return sge()}const hl=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||wD(),this.type=t.geometry.type};hl.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};hl.prototype.incomingCoords=function(e){this.setCoordinates(e)};hl.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};hl.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};hl.prototype.setProperty=function(e,t){this.properties[e]=t};hl.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:si.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};hl.prototype.internal=function(e){const t={id:this.id,meta:Fs.FEATURE,"meta:type":this.type,active:ps.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const n in this.properties)t[`user_${n}`]=this.properties[n];return{type:si.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const Sf=function(e,t){hl.call(this,e,t)};Sf.prototype=Object.create(hl.prototype);Sf.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Sf.prototype.updateCoordinate=function(e,t,n){arguments.length===3?this.coordinates=[t,n]:this.coordinates=[e,t],this.changed()};Sf.prototype.getCoordinate=function(){return this.getCoordinates()};const qu=function(e,t){hl.call(this,e,t)};qu.prototype=Object.create(hl.prototype);qu.prototype.isValid=function(){return this.coordinates.length>1};qu.prototype.addCoordinate=function(e,t,n){this.changed();const i=parseInt(e,10);this.coordinates.splice(i,0,[t,n])};qu.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};qu.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};qu.prototype.updateCoordinate=function(e,t,n){const i=parseInt(e,10);this.coordinates[i]=[t,n],this.changed()};const Zl=function(e,t){hl.call(this,e,t),this.coordinates=this.coordinates.map(n=>n.slice(0,-1))};Zl.prototype=Object.create(hl.prototype);Zl.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};Zl.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};Zl.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Zl.prototype.addCoordinate=function(e,t,n){this.changed();const i=e.split(".").map(d=>parseInt(d,10));this.coordinates[i[0]].splice(i[1],0,[t,n])};Zl.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(i=>parseInt(i,10)),n=this.coordinates[t[0]];n&&(n.splice(t[1],1),n.length<3&&this.coordinates.splice(t[0],1))};Zl.prototype.getCoordinate=function(e){const t=e.split(".").map(i=>parseInt(i,10)),n=this.coordinates[t[0]];return JSON.parse(JSON.stringify(n[t[1]]))};Zl.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};Zl.prototype.updateCoordinate=function(e,t,n){this.changed();const i=e.split("."),s=parseInt(i[0],10),d=parseInt(i[1],10);this.coordinates[s]===void 0&&(this.coordinates[s]=[]),this.coordinates[s][d]=[t,n]};const lge={MultiPoint:Sf,MultiLineString:qu,MultiPolygon:Zl},kE=(e,t,n,i,s)=>{const d=n.split("."),f=parseInt(d[0],10),o=d[1]?d.slice(1).join("."):null;return e[f][t](o,i,s)},ll=function(e,t){if(hl.call(this,e,t),delete this.coordinates,this.model=lge[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};ll.prototype=Object.create(hl.prototype);ll.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(n=>new t(this.ctx,{id:wD(),type:si.FEATURE,properties:{},geometry:{coordinates:n,type:this.type.replace("Multi","")}}))};ll.prototype.isValid=function(){return this.features.every(e=>e.isValid())};ll.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};ll.prototype.getCoordinate=function(e){return kE(this.features,"getCoordinate",e)};ll.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===si.POLYGON?e.getCoordinates():e.coordinates)))};ll.prototype.updateCoordinate=function(e,t,n){kE(this.features,"updateCoordinate",e,t,n),this.changed()};ll.prototype.addCoordinate=function(e,t,n){kE(this.features,"addCoordinate",e,t,n),this.changed()};ll.prototype.removeCoordinate=function(e){kE(this.features,"removeCoordinate",e),this.changed()};ll.prototype.getFeatures=function(){return this.features};function qi(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}qi.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};qi.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,n)=>(t[n.feature_id]===void 0&&(t[n.feature_id]=!0,this._ctx.store.get(n.feature_id).changed()),t),{})};qi.prototype.getSelected=function(){return this._ctx.store.getSelected()};qi.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};qi.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};qi.prototype.getFeature=function(e){return this._ctx.store.get(e)};qi.prototype.select=function(e){return this._ctx.store.select(e)};qi.prototype.deselect=function(e){return this._ctx.store.deselect(e)};qi.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};qi.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};qi.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};qi.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};qi.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};qi.prototype.changeMode=function(e,t={},n={}){return this._ctx.events.changeMode(e,t,n)};qi.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};qi.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};qi.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};qi.prototype.featuresAt=function(e,t,n="click"){if(n!=="click"&&n!=="touch")throw new Error("invalid buffer type");return kv[n](e,t,this._ctx)};qi.prototype.newFeature=function(e){const t=e.geometry.type;return t===si.POINT?new Sf(this._ctx,e):t===si.LINE_STRING?new qu(this._ctx,e):t===si.POLYGON?new Zl(this._ctx,e):new ll(this._ctx,e)};qi.prototype.isInstanceOf=function(e,t){if(e===si.POINT)return t instanceof Sf;if(e===si.LINE_STRING)return t instanceof qu;if(e===si.POLYGON)return t instanceof Zl;if(e==="MultiFeature")return t instanceof ll;throw new Error(`Unknown feature class: ${e}`)};qi.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};qi.prototype.onSetup=function(){};qi.prototype.onDrag=function(){};qi.prototype.onClick=function(){};qi.prototype.onMouseMove=function(){};qi.prototype.onMouseDown=function(){};qi.prototype.onMouseUp=function(){};qi.prototype.onMouseOut=function(){};qi.prototype.onKeyUp=function(){};qi.prototype.onKeyDown=function(){};qi.prototype.onTouchStart=function(){};qi.prototype.onTouchMove=function(){};qi.prototype.onTouchEnd=function(){};qi.prototype.onTap=function(){};qi.prototype.onStop=function(){};qi.prototype.onTrash=function(){};qi.prototype.onCombineFeature=function(){};qi.prototype.onUncombineFeature=function(){};qi.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const gG={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},cge=Object.keys(gG);function uge(e){const t=Object.keys(e);return function(n,i={}){let s={};const d=t.reduce((o,y)=>(o[y]=e[y],o),new qi(n));function f(o){return y=>d[o](s,y)}return{start(){s=d.onSetup(i),cge.forEach(o=>{const y=gG[o];let b=()=>!1;e[y]&&(b=()=>!0),this.on(o,b,f(y))})},stop(){d.onStop(s)},trash(){d.onTrash(s)},combineFeatures(){d.onCombineFeatures(s)},uncombineFeatures(){d.onUncombineFeatures(s)},render(o,y){d.toDisplayFeatures(s,o,y)}}}}function dge(e){const t=Object.keys(e.options.modes).reduce((A,D)=>(A[D]=uge(e.options.modes[D]),A),{});let n={},i={};const s={};let d=null,f=null;s.drag=function(A,D){D({point:A.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:va.DRAG}),f.drag(A)):A.originalEvent.stopPropagation()},s.mousedrag=function(A){s.drag(A,D=>!XR(n,D))},s.touchdrag=function(A){s.drag(A,D=>!ZR(i,D))},s.mousemove=function(A){if((A.originalEvent.buttons!==void 0?A.originalEvent.buttons:A.originalEvent.which)===1)return s.mousedrag(A);const k=xS(A,e);A.featureTarget=k,f.mousemove(A)},s.mousedown=function(A){n={time:new Date().getTime(),point:A.point};const D=xS(A,e);A.featureTarget=D,f.mousedown(A)},s.mouseup=function(A){const D=xS(A,e);A.featureTarget=D,XR(n,{point:A.point,time:new Date().getTime()})?f.click(A):f.mouseup(A)},s.mouseout=function(A){f.mouseout(A)},s.touchstart=function(A){if(!e.options.touchEnabled)return;i={time:new Date().getTime(),point:A.point};const D=kv.touch(A,null,e)[0];A.featureTarget=D,f.touchstart(A)},s.touchmove=function(A){if(e.options.touchEnabled)return f.touchmove(A),s.touchdrag(A)},s.touchend=function(A){if(A.originalEvent.preventDefault(),!e.options.touchEnabled)return;const D=kv.touch(A,null,e)[0];A.featureTarget=D,ZR(i,{time:new Date().getTime(),point:A.point})?f.tap(A):f.touchend(A)};const o=A=>!(A===8||A===46||A>=48&&A<=57);s.keydown=function(A){(A.srcElement||A.target).classList.contains(Cl.CANVAS)&&((A.keyCode===8||A.keyCode===46)&&e.options.controls.trash?(A.preventDefault(),f.trash()):o(A.keyCode)?f.keydown(A):A.keyCode===49&&e.options.controls.point?y(lo.DRAW_POINT):A.keyCode===50&&e.options.controls.line_string?y(lo.DRAW_LINE_STRING):A.keyCode===51&&e.options.controls.polygon&&y(lo.DRAW_POLYGON))},s.keyup=function(A){o(A.keyCode)&&f.keyup(A)},s.zoomend=function(){e.store.changeZoom()},s.data=function(A){if(A.dataType==="style"){const{setup:D,map:k,options:B,store:N}=e;B.styles.some(V=>k.getLayer(V.id))||(D.addLayers(),N.setDirty(),N.render())}};function y(A,D,k={}){f.stop();const B=t[A];if(B===void 0)throw new Error(`${A} is not valid`);d=A;const N=B(e,D);f=GR(N,e),k.silent||e.map.fire(cl.MODE_CHANGE,{mode:A}),e.store.setDirty(),e.store.render()}const b={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function C(A){let D=!1;Object.keys(A).forEach(k=>{if(b[k]===void 0)throw new Error("Invalid action type");b[k]!==A[k]&&(D=!0),b[k]=A[k]}),D&&e.map.fire(cl.ACTIONABLE,{actions:b})}return{start(){d=e.options.defaultMode,f=GR(t[d](e),e)},changeMode:y,actionable:C,currentModeName(){return d},currentModeRender(A,D){return f.render(A,D)},fire(A,D){e.map&&e.map.fire(A,D)},addEventListeners(){e.map.on("mousemove",s.mousemove),e.map.on("mousedown",s.mousedown),e.map.on("mouseup",s.mouseup),e.map.on("data",s.data),e.map.on("touchmove",s.touchmove),e.map.on("touchstart",s.touchstart),e.map.on("touchend",s.touchend),e.container.addEventListener("mouseout",s.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",s.keydown),e.container.addEventListener("keyup",s.keyup))},removeEventListeners(){e.map.off("mousemove",s.mousemove),e.map.off("mousedown",s.mousedown),e.map.off("mouseup",s.mouseup),e.map.off("data",s.data),e.map.off("touchmove",s.touchmove),e.map.off("touchstart",s.touchstart),e.map.off("touchend",s.touchend),e.container.removeEventListener("mouseout",s.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",s.keydown),e.container.removeEventListener("keyup",s.keyup))},trash(A){f.trash(A)},combineFeatures(){f.combineFeatures()},uncombineFeatures(){f.uncombineFeatures()},getMode(){return d}}}function hb(e){return[].concat(e).filter(t=>t!==void 0)}function hge(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(dc.HOT)!==void 0))return y();const n=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:n});let i=[],s=[];e.isDirty?s=e.getAllIds():(i=e.getChangedIds().filter(b=>e.get(b)!==void 0),s=e.sources.hot.filter(b=>b.properties.id&&i.indexOf(b.properties.id)===-1&&e.get(b.properties.id)!==void 0).map(b=>b.properties.id)),e.sources.hot=[];const d=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(b=>{const C=b.properties.id||b.properties.parent;return i.indexOf(C)===-1});const f=d!==e.sources.cold.length||s.length>0;i.forEach(b=>o(b,"hot")),s.forEach(b=>o(b,"cold"));function o(b,C){const A=e.get(b).internal(n);e.ctx.events.currentModeRender(A,D=>{D.properties.mode=n,e.sources[C].push(D)})}f&&e.ctx.map.getSource(dc.COLD).setData({type:si.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(dc.HOT).setData({type:si.FEATURE_COLLECTION,features:e.sources.hot}),y();function y(){e.isDirty=!1,e.clearChangedIds()}}function aa(e){this._features={},this._featureIds=new pc,this._selectedFeatureIds=new pc,this._selectedCoordinates=[],this._changedFeatureIds=new pc,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,hge.call(this),this._emitSelectionChange&&(this.ctx.events.fire(cl.SELECTION_CHANGE,{features:this.getSelected().map(n=>n.toGeoJSON()),points:this.getSelectedCoordinates().map(n=>({type:si.FEATURE,properties:{},geometry:{type:si.POINT,coordinates:n.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(cl.RENDER,{})}))},this.isDirty=!1}aa.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};aa.prototype.setDirty=function(){return this.isDirty=!0,this};aa.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const i=this.get(e);this.ctx.events.fire(cl.CREATE,{features:[i.toGeoJSON()]})}return this};aa.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(cl.UPDATE,{action:t.action?t.action:db.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};aa.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};aa.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};aa.prototype.getAllIds=function(){return this._featureIds.values()};aa.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};aa.prototype.delete=function(e,t={}){const n=[];return hb(e).forEach(i=>{this._featureIds.has(i)&&(this._featureIds.delete(i),this._selectedFeatureIds.delete(i),t.silent||n.indexOf(this._features[i])===-1&&n.push(this._features[i].toGeoJSON()),delete this._features[i],this.isDirty=!0)}),n.length&&this.ctx.events.fire(cl.DELETE,{features:n}),vG(this,t),this};aa.prototype.get=function(e){return this._features[e]};aa.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};aa.prototype.select=function(e,t={}){return hb(e).forEach(n=>{this._selectedFeatureIds.has(n)||(this._selectedFeatureIds.add(n),this._changedFeatureIds.add(n),t.silent||(this._emitSelectionChange=!0))}),this};aa.prototype.deselect=function(e,t={}){return hb(e).forEach(n=>{this._selectedFeatureIds.has(n)&&(this._selectedFeatureIds.delete(n),this._changedFeatureIds.add(n),t.silent||(this._emitSelectionChange=!0))}),vG(this,t),this};aa.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};aa.prototype.setSelected=function(e,t={}){return e=hb(e),this.deselect(this._selectedFeatureIds.values().filter(n=>e.indexOf(n)===-1),{silent:t.silent}),this.select(e.filter(n=>!this._selectedFeatureIds.has(n)),{silent:t.silent}),this};aa.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};aa.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};aa.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};aa.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};aa.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};aa.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};aa.prototype.setFeatureProperty=function(e,t,n,i={}){this.get(e).setProperty(t,n),this.featureChanged(e,{silent:i.silent,action:db.CHANGE_PROPERTIES})};function vG(e,t={}){const n=e._selectedCoordinates.filter(i=>e._selectedFeatureIds.has(i.feature_id));e._selectedCoordinates.length!==n.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=n}aa.prototype.storeMapConfig=function(){dG.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};aa.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};aa.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const fge=["mode","feature","mouse"];function pge(e){const t={};let n=null,i={mode:null,feature:null,mouse:null},s={mode:null,feature:null,mouse:null};function d(){f({mode:null,feature:null,mouse:null}),o()}function f(D){s=Object.assign(s,D)}function o(){if(!e.container)return;const D=[],k=[];fge.forEach(B=>{s[B]!==i[B]&&(D.push(`${B}-${i[B]}`),s[B]!==null&&k.push(`${B}-${s[B]}`))}),D.length>0&&e.container.classList.remove(...D),k.length>0&&e.container.classList.add(...k),i=Object.assign(i,s)}function y(D,k={}){const B=document.createElement("button");return B.className=`${Cl.CONTROL_BUTTON} ${k.className}`,B.setAttribute("title",k.title),k.container.appendChild(B),B.addEventListener("click",N=>{if(N.preventDefault(),N.stopPropagation(),N.target===n){b(),k.onDeactivate();return}C(D),k.onActivate()},!0),B}function b(){n&&(n.classList.remove(Cl.ACTIVE_BUTTON),n=null)}function C(D){b();const k=t[D];k&&k&&D!=="trash"&&(k.classList.add(Cl.ACTIVE_BUTTON),n=k)}function P(){const D=e.options.controls,k=document.createElement("div");return k.className=`${Cl.CONTROL_GROUP} ${Cl.CONTROL_BASE}`,D&&(D[El.LINE]&&(t[El.LINE]=y(El.LINE,{container:k,className:Cl.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(lo.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),D[El.POLYGON]&&(t[El.POLYGON]=y(El.POLYGON,{container:k,className:Cl.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(lo.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),D[El.POINT]&&(t[El.POINT]=y(El.POINT,{container:k,className:Cl.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(lo.DRAW_POINT),onDeactivate:()=>e.events.trash()})),D.trash&&(t.trash=y("trash",{container:k,className:Cl.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),D.combine_features&&(t.combine_features=y("combineFeatures",{container:k,className:Cl.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),D.uncombine_features&&(t.uncombine_features=y("uncombineFeatures",{container:k,className:Cl.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),k}function A(){Object.keys(t).forEach(D=>{const k=t[D];k.parentNode&&k.parentNode.removeChild(k),delete t[D]})}return{setActiveButton:C,queueMapClasses:f,updateMapClasses:o,clearMapClasses:d,addButtons:P,removeButtons:A}}function mge(e){let t=null,n=null;const i={onRemove(){return e.map.off("load",i.connect),clearInterval(n),i.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",i.connect),clearInterval(n),i.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(s){if(e.map=s,e.events=dge(e),e.ui=pge(e),e.container=s.getContainer(),e.store=new aa(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=s.boxZoom.isEnabled(),s.boxZoom.disable();const d=s.dragPan.isEnabled();s.dragPan.disable(),s.dragPan.enable(),d||s.dragPan.disable()}return s.loaded()?i.connect():(s.on("load",i.connect),n=setInterval(()=>{s.loaded()&&i.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(dc.COLD,{data:{type:si.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(dc.HOT,{data:{type:si.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(s=>{e.map.addLayer(s)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(s=>{e.map.getLayer(s.id)&&e.map.removeLayer(s.id)}),e.map.getSource(dc.COLD)&&e.map.removeSource(dc.COLD),e.map.getSource(dc.HOT)&&e.map.removeSource(dc.HOT)}};return e.setup=i,i}const fP="#3bb2d0",g0="#fbb03b",y5="#fff",_G=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],g0,fP],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],g0,fP],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":y5}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],g0,fP]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":y5}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":g0}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":g0}}];function FE(e){return function(t){const n=t.featureTarget;return!n||!n.properties?!1:n.properties.meta===e}}function yG(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function sm(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ps.ACTIVE&&e.featureTarget.properties.meta===Fs.FEATURE}function SD(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ps.INACTIVE&&e.featureTarget.properties.meta===Fs.FEATURE}function NE(e){return e.featureTarget===void 0}function CD(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===Fs.FEATURE}function fb(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===Fs.VERTEX}function _C(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function BE(e){return e.keyCode===27}function $E(e){return e.keyCode===13}function gge(){return!0}const vge=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:sm,isEnterKey:$E,isEscapeKey:BE,isFeature:CD,isInactiveFeature:SD,isOfMetaType:FE,isShiftDown:_C,isShiftMousedown:yG,isTrue:gge,isVertex:fb,noTarget:NE},Symbol.toStringTag,{value:"Module"}));function Wh(e,t){this.x=e,this.y=t}Wh.prototype={clone(){return new Wh(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),n=Math.sin(e),i=t*this.x-n*this.y,s=n*this.x+t*this.y;return this.x=i,this.y=s,this},_rotateAround(e,t){const n=Math.cos(e),i=Math.sin(e),s=t.x+n*(this.x-t.x)-i*(this.y-t.y),d=t.y+i*(this.x-t.x)+n*(this.y-t.y);return this.x=s,this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Wh};Wh.convert=function(e){if(e instanceof Wh)return e;if(Array.isArray(e))return new Wh(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new Wh(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function ED(e,t){const n=t.getBoundingClientRect();return new Wh(e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0))}function Fv(e,t,n,i){return{type:si.FEATURE,properties:{meta:Fs.VERTEX,parent:e,coord_path:n,active:i?ps.ACTIVE:ps.INACTIVE},geometry:{type:si.POINT,coordinates:t}}}function xG(e,t,n){const i=t.geometry.coordinates,s=n.geometry.coordinates;if(i[1]>KR||i[1]<qR||s[1]>KR||s[1]<qR)return null;const d={lng:(i[0]+s[0])/2,lat:(i[1]+s[1])/2};return{type:si.FEATURE,properties:{meta:Fs.MIDPOINT,parent:e,lng:d.lng,lat:d.lat,coord_path:n.properties.coord_path},geometry:{type:si.POINT,coordinates:[d.lng,d.lat]}}}function jE(e,t={},n=null){const{type:i,coordinates:s}=e.geometry,d=e.properties&&e.properties.id;let f=[];i===si.POINT?f.push(Fv(d,s,n,y(n))):i===si.POLYGON?s.forEach((C,P)=>{o(C,n!==null?`${n}.${P}`:String(P))}):i===si.LINE_STRING?o(s,n):i.indexOf(si.MULTI_PREFIX)===0&&b();function o(C,P){let A="",D=null;C.forEach((k,B)=>{const N=P!=null?`${P}.${B}`:String(B),j=Fv(d,k,N,y(N));if(t.midpoints&&D){const K=xG(d,D,j);K&&f.push(K)}D=j;const V=JSON.stringify(k);A!==V&&f.push(j),B===0&&(A=V)})}function y(C){return t.selectedPaths?t.selectedPaths.indexOf(C)!==-1:!1}function b(){const C=i.replace(si.MULTI_PREFIX,"");s.forEach((P,A)=>{const D={type:si.FEATURE,properties:e.properties,geometry:{type:C,coordinates:P}};f=f.concat(jE(D,t,A))})}return f}const eu={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:Lw,LAT_MAX:zw,LAT_RENDERED_MIN:x5,LAT_RENDERED_MAX:b5,LNG_MIN:w5,LNG_MAX:S5}=hG;function _ge(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],n=[e.geometry.coordinates].flat(t),i=n.map(o=>o[0]),s=n.map(o=>o[1]),d=o=>Math.min.apply(null,o),f=o=>Math.max.apply(null,o);return[d(i),d(s),f(i),f(s)]}function TD(e,t){let n=Lw,i=zw,s=Lw,d=zw,f=S5,o=w5;e.forEach(b=>{const C=_ge(b),P=C[1],A=C[3],D=C[0],k=C[2];P>n&&(n=P),A<i&&(i=A),A>s&&(s=A),P<d&&(d=P),D<f&&(f=D),k>o&&(o=k)});const y=t;return n+y.lat>b5&&(y.lat=b5-n),s+y.lat>zw&&(y.lat=zw-s),i+y.lat<x5&&(y.lat=x5-i),d+y.lat<Lw&&(y.lat=Lw-d),f+y.lng<=w5&&(y.lng+=Math.ceil(Math.abs(y.lng)/360)*360),o+y.lng>=S5&&(y.lng-=Math.ceil(Math.abs(y.lng)/360)*360),y}function ID(e,t){const n=TD(e.map(i=>i.toGeoJSON()),t);e.forEach(i=>{const s=i.getCoordinates(),d=b=>{const C={lng:b[0]+n.lng,lat:b[1]+n.lat};return[C.lng,C.lat]},f=b=>b.map(C=>d(C)),o=b=>b.map(C=>f(C));let y;i.type===si.POINT?y=d(s):i.type===si.LINE_STRING||i.type===si.MULTI_POINT?y=s.map(d):i.type===si.POLYGON||i.type===si.MULTI_LINE_STRING?y=s.map(f):i.type===si.MULTI_POLYGON&&(y=s.map(o)),i.incomingCoords(y)})}const Yo={};Yo.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(n=>this.getFeature(n)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};Yo.fireUpdate=function(){this.fire(cl.UPDATE,{action:db.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};Yo.fireActionable=function(){const e=this.getSelected(),t=e.filter(d=>this.isInstanceOf("MultiFeature",d));let n=!1;if(e.length>1){n=!0;const d=e[0].type.replace("Multi","");e.forEach(f=>{f.type.replace("Multi","")!==d&&(n=!1)})}const i=t.length>0,s=e.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:i,trash:s})};Yo.getUniqueIds=function(e){return e.length?e.map(n=>n.properties.id).filter(n=>n!==void 0).reduce((n,i)=>(n.add(i),n),new pc).values():[]};Yo.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};Yo.onStop=function(){eu.enable(this)};Yo.onMouseMove=function(e,t){return CD(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};Yo.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};Yo.onTap=Yo.onClick=function(e,t){if(NE(t))return this.clickAnywhere(e,t);if(FE(Fs.VERTEX)(t))return this.clickOnVertex(e,t);if(CD(t))return this.clickOnFeature(e,t)};Yo.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(n=>this.doRender(n))),eu.enable(this),this.stopExtendedInteractions(e)};Yo.clickOnVertex=function(e,t){this.changeMode(lo.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:va.MOVE})};Yo.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Yo.clickOnFeature=function(e,t){eu.disable(this),this.stopExtendedInteractions(e);const n=_C(t),i=this.getSelectedIds(),s=t.featureTarget.properties.id,d=this.isSelected(s);if(!n&&d&&this.getFeature(s).type!==si.POINT)return this.changeMode(lo.DIRECT_SELECT,{featureId:s});d&&n?(this.deselect(s),this.updateUIClasses({mouse:va.POINTER}),i.length===1&&eu.enable(this)):!d&&n?(this.select(s),this.updateUIClasses({mouse:va.MOVE})):!d&&!n&&(i.forEach(f=>this.doRender(f)),this.setSelected(s),this.updateUIClasses({mouse:va.MOVE})),this.doRender(s)};Yo.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),sm(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&yG(t))return this.startBoxSelect(e,t)};Yo.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=ED(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};Yo.onTouchStart=function(e,t){if(sm(t))return this.startOnActiveFeature(e,t)};Yo.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};Yo.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:va.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(Cl.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const n=ED(t.originalEvent,this.map.getContainer()),i=Math.min(e.boxSelectStartLocation.x,n.x),s=Math.max(e.boxSelectStartLocation.x,n.x),d=Math.min(e.boxSelectStartLocation.y,n.y),f=Math.max(e.boxSelectStartLocation.y,n.y),o=`translate(${i}px, ${d}px)`;e.boxSelectElement.style.transform=o,e.boxSelectElement.style.WebkitTransform=o,e.boxSelectElement.style.width=`${s-i}px`,e.boxSelectElement.style.height=`${f-d}px`};Yo.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};ID(this.getSelected(),n),e.dragMoveLocation=t.lngLat};Yo.onTouchEnd=Yo.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const n=[e.boxSelectStartLocation,ED(t.originalEvent,this.map.getContainer())],i=this.featuresAt(null,n,"click"),s=this.getUniqueIds(i).filter(d=>!this.isSelected(d));s.length&&(this.select(s),s.forEach(d=>this.doRender(d)),this.updateUIClasses({mouse:va.MOVE}))}this.stopExtendedInteractions(e)};Yo.toDisplayFeatures=function(e,t,n){t.properties.active=this.isSelected(t.properties.id)?ps.ACTIVE:ps.INACTIVE,n(t),this.fireActionable(),!(t.properties.active!==ps.ACTIVE||t.geometry.type===si.POINT)&&jE(t).forEach(n)};Yo.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};Yo.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],n=[],i=e[0].type.replace("Multi","");for(let s=0;s<e.length;s++){const d=e[s];if(d.type.replace("Multi","")!==i)return;d.type.includes("Multi")?d.getCoordinates().forEach(f=>{t.push(f)}):t.push(d.getCoordinates()),n.push(d.toGeoJSON())}if(n.length>1){const s=this.newFeature({type:si.FEATURE,properties:n[0].properties,geometry:{type:`Multi${i}`,coordinates:t}});this.addFeature(s),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([s.id]),this.fire(cl.COMBINE_FEATURES,{createdFeatures:[s.toGeoJSON()],deletedFeatures:n})}this.fireActionable()};Yo.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],n=[];for(let i=0;i<e.length;i++){const s=e[i];this.isInstanceOf("MultiFeature",s)&&(s.getFeatures().forEach(d=>{this.addFeature(d),d.properties=s.properties,t.push(d.toGeoJSON()),this.select([d.id])}),this.deleteFeature(s.id,{silent:!0}),n.push(s.toGeoJSON()))}t.length>1&&this.fire(cl.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:n}),this.fireActionable()};const bG=FE(Fs.VERTEX),wG=FE(Fs.MIDPOINT),Jo={};Jo.fireUpdate=function(){this.fire(cl.UPDATE,{action:db.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};Jo.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};Jo.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Jo.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};Jo.onVertex=function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties,i=e.selectedCoordPaths.indexOf(n.coord_path);!_C(t)&&i===-1?e.selectedCoordPaths=[n.coord_path]:_C(t)&&i===-1&&e.selectedCoordPaths.push(n.coord_path);const s=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(s)};Jo.onMidpoint=function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties;e.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),e.selectedCoordPaths=[n.coord_path]};Jo.pathsToCoordinates=function(e,t){return t.map(n=>({feature_id:e,coord_path:n}))};Jo.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};Jo.dragFeature=function(e,t,n){ID(this.getSelected(),n),e.dragMoveLocation=t.lngLat};Jo.dragVertex=function(e,t,n){const i=e.selectedCoordPaths.map(f=>e.feature.getCoordinate(f)),s=i.map(f=>({type:si.FEATURE,properties:{},geometry:{type:si.POINT,coordinates:f}})),d=TD(s,n);for(let f=0;f<i.length;f++){const o=i[f];e.feature.updateCoordinate(e.selectedCoordPaths[f],o[0]+d.lng,o[1]+d.lat)}};Jo.clickNoTarget=function(){this.changeMode(lo.SIMPLE_SELECT)};Jo.clickInactive=function(){this.changeMode(lo.SIMPLE_SELECT)};Jo.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};Jo.onSetup=function(e){const t=e.featureId,n=this.getFeature(t);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===si.POINT)throw new TypeError("direct_select mode doesn't handle point features");const i={featureId:t,feature:n,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,i.selectedCoordPaths)),this.setSelected(t),eu.disable(this),this.setActionableState({trash:!0}),i};Jo.onStop=function(){eu.enable(this),this.clearSelectedCoordinates()};Jo.toDisplayFeatures=function(e,t,n){e.featureId===t.properties.id?(t.properties.active=ps.ACTIVE,n(t),jE(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(n)):(t.properties.active=ps.INACTIVE,n(t)),this.fireActionable(e)};Jo.onTrash=function(e){e.selectedCoordPaths.sort((t,n)=>n.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(lo.SIMPLE_SELECT,{}))};Jo.onMouseMove=function(e,t){const n=sm(t),i=bG(t),s=wG(t),d=e.selectedCoordPaths.length===0;return n&&d?this.updateUIClasses({mouse:va.MOVE}):i&&!d?this.updateUIClasses({mouse:va.MOVE}):this.updateUIClasses({mouse:va.NONE}),(i||n||s)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};Jo.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};Jo.onTouchStart=Jo.onMouseDown=function(e,t){if(bG(t))return this.onVertex(e,t);if(sm(t))return this.onFeature(e,t);if(wG(t))return this.onMidpoint(e,t)};Jo.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat};Jo.onClick=function(e,t){if(NE(t))return this.clickNoTarget(e,t);if(sm(t))return this.clickActiveFeature(e,t);if(SD(t))return this.clickInactive(e,t);this.stopDragging(e)};Jo.onTap=function(e,t){if(NE(t))return this.clickNoTarget(e,t);if(sm(t))return this.clickActiveFeature(e,t);if(SD(t))return this.clickInactive(e,t)};Jo.onTouchEnd=Jo.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const Vu={};Vu.onSetup=function(){const e=this.newFeature({type:si.FEATURE,properties:{},geometry:{type:si.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:va.ADD}),this.activateUIButton(El.POINT),this.setActionableState({trash:!0}),{point:e}};Vu.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT)};Vu.onTap=Vu.onClick=function(e,t){this.updateUIClasses({mouse:va.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(cl.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.point.id]})};Vu.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Vu.toDisplayFeatures=function(e,t,n){const i=t.properties.id===e.point.id;if(t.properties.active=i?ps.ACTIVE:ps.INACTIVE,!i)return n(t)};Vu.onTrash=Vu.stopDrawingAndRemove;Vu.onKeyUp=function(e,t){if(BE(t)||$E(t))return this.stopDrawingAndRemove(e,t)};function yC(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const tu={};tu.onSetup=function(){const e=this.newFeature({type:si.FEATURE,properties:{},geometry:{type:si.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),eu.disable(this),this.updateUIClasses({mouse:va.ADD}),this.activateUIButton(El.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};tu.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&yC(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:va.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};tu.clickOnVertex=function(e){return this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};tu.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),fb(t)&&this.updateUIClasses({mouse:va.POINTER})};tu.onTap=tu.onClick=function(e,t){return fb(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};tu.onKeyUp=function(e,t){BE(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT)):$E(t)&&this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};tu.onStop=function(e){this.updateUIClasses({mouse:va.NONE}),eu.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(cl.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT,{},{silent:!0})))};tu.toDisplayFeatures=function(e,t,n){const i=t.properties.id===e.polygon.id;if(t.properties.active=i?ps.ACTIVE:ps.INACTIVE,!i)return n(t);if(t.geometry.coordinates.length===0)return;const s=t.geometry.coordinates[0].length;if(!(s<3)){if(t.properties.meta=Fs.FEATURE,n(Fv(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),s>3){const d=t.geometry.coordinates[0].length-3;n(Fv(e.polygon.id,t.geometry.coordinates[0][d],`0.${d}`,!1))}if(s<=4){const d=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:si.FEATURE,properties:t.properties,geometry:{coordinates:d,type:si.LINE_STRING}}),s===3)return}return n(t)}};tu.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT)};const nu={};nu.onSetup=function(e){e=e||{};const t=e.featureId;let n,i,s="forward";if(t){if(n=this.getFeature(t),!n)throw new Error("Could not find a feature with the provided featureId");let d=e.from;if(d&&d.type==="Feature"&&d.geometry&&d.geometry.type==="Point"&&(d=d.geometry),d&&d.type==="Point"&&d.coordinates&&d.coordinates.length===2&&(d=d.coordinates),!d||!Array.isArray(d))throw new Error("Please use the `from` property to indicate which point to continue the line from");const f=n.coordinates.length-1;if(n.coordinates[f][0]===d[0]&&n.coordinates[f][1]===d[1])i=f+1,n.addCoordinate(i,...n.coordinates[f]);else if(n.coordinates[0][0]===d[0]&&n.coordinates[0][1]===d[1])s="backwards",i=0,n.addCoordinate(i,...n.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else n=this.newFeature({type:si.FEATURE,properties:{},geometry:{type:si.LINE_STRING,coordinates:[]}}),i=0,this.addFeature(n);return this.clearSelectedFeatures(),eu.disable(this),this.updateUIClasses({mouse:va.ADD}),this.activateUIButton(El.LINE),this.setActionableState({trash:!0}),{line:n,currentVertexPosition:i,direction:s}};nu.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&yC(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&yC(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:va.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};nu.clickOnVertex=function(e){return this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.line.id]})};nu.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),fb(t)&&this.updateUIClasses({mouse:va.POINTER})};nu.onTap=nu.onClick=function(e,t){if(fb(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};nu.onKeyUp=function(e,t){$E(t)?this.changeMode(lo.SIMPLE_SELECT,{featureIds:[e.line.id]}):BE(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT))};nu.onStop=function(e){eu.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(cl.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT,{},{silent:!0})))};nu.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(lo.SIMPLE_SELECT)};nu.toDisplayFeatures=function(e,t,n){const i=t.properties.id===e.line.id;if(t.properties.active=i?ps.ACTIVE:ps.INACTIVE,!i)return n(t);t.geometry.coordinates.length<2||(t.properties.meta=Fs.FEATURE,n(Fv(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),n(t))};const SG={simple_select:Yo,direct_select:Jo,draw_point:Vu,draw_polygon:tu,draw_line_string:nu},yge={defaultMode:lo.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:_G,modes:SG,controls:{},userProperties:!1,suppressAPIEvents:!0},xge={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},bge={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function C5(e,t){return e.map(n=>n.source?n:Object.assign({},n,{id:`${n.id}.${t}`,source:t==="hot"?dc.HOT:dc.COLD}))}function wge(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},bge,e.controls):t.controls=Object.assign({},xge,e.controls),t=Object.assign({},yge,t),t.styles=C5(t.styles,"cold").concat(C5(t.styles,"hot")),t}var Sge=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,s,d;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(s=i;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(d=Object.keys(t),i=d.length,i!==Object.keys(n).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,d[s]))return!1;for(s=i;s--!==0;){var f=d[s];if(!e(t[f],n[f]))return!1}return!0}return t!==t&&n!==n};const E5=jv(Sge);var Cge=Tge,Ege={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Tge(e){if(!e||!e.type)return null;var t=Ege[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const Ige=jv(Cge);function CG(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(n=>n).sort())===JSON.stringify(t.map(n=>n).sort())}const Pge={Polygon:Zl,LineString:qu,Point:Sf,MultiPolygon:ll,MultiLineString:ll,MultiPoint:ll};function Mge(e,t){t.modes=lo;const n=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(i){return kv.click({point:i},null,e).map(d=>d.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:si.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(i=>e.store.get(i)).map(i=>i.toGeoJSON())}},t.getSelectedPoints=function(){return{type:si.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(i=>({type:si.FEATURE,properties:{},geometry:{type:si.POINT,coordinates:i.coordinates}}))}},t.set=function(i){if(i.type===void 0||i.type!==si.FEATURE_COLLECTION||!Array.isArray(i.features))throw new Error("Invalid FeatureCollection");const s=e.store.createRenderBatch();let d=e.store.getAllIds().slice();const f=t.add(i),o=new pc(f);return d=d.filter(y=>!o.has(y)),d.length&&t.delete(d),s(),f},t.add=function(i){const d=JSON.parse(JSON.stringify(Ige(i))).features.map(f=>{if(f.id=f.id||wD(),f.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(f.id)===void 0||e.store.get(f.id).type!==f.geometry.type){const o=Pge[f.geometry.type];if(o===void 0)throw new Error(`Invalid geometry type: ${f.geometry.type}.`);const y=new o(e,f);e.store.add(y,{silent:n})}else{const o=e.store.get(f.id),y=o.properties;o.properties=f.properties,E5(y,f.properties)||e.store.featureChanged(o.id,{silent:n}),E5(o.getCoordinates(),f.geometry.coordinates)||o.incomingCoords(f.geometry.coordinates)}return f.id});return e.store.render(),d},t.get=function(i){const s=e.store.get(i);if(s)return s.toGeoJSON()},t.getAll=function(){return{type:si.FEATURE_COLLECTION,features:e.store.getAll().map(i=>i.toGeoJSON())}},t.delete=function(i){return e.store.delete(i,{silent:n}),t.getMode()===lo.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(lo.SIMPLE_SELECT,void 0,{silent:n}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:n}),t.getMode()===lo.DIRECT_SELECT?e.events.changeMode(lo.SIMPLE_SELECT,void 0,{silent:n}):e.store.render(),t},t.changeMode=function(i,s={}){return i===lo.SIMPLE_SELECT&&t.getMode()===lo.SIMPLE_SELECT?(CG(s.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(s.featureIds,{silent:n}),e.store.render()),t):(i===lo.DIRECT_SELECT&&t.getMode()===lo.DIRECT_SELECT&&s.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(i,s,{silent:n}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:n}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:n}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:n}),t},t.setFeatureProperty=function(i,s,d){return e.store.setFeatureProperty(i,s,d,{silent:n}),t},t}const Rge=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:vge,ModeHandler:GR,StringSet:pc,constrainFeatureMovement:TD,createMidPoint:xG,createSupplementaryPoints:jE,createVertex:Fv,doubleClickZoom:eu,euclideanDistance:bD,featuresAt:kv,getFeatureAtAndSetCursors:xS,isClick:XR,isEventAtCoordinates:yC,isTap:ZR,mapEventToBoundingBox:pG,moveFeatures:ID,sortFeatures:fG,stringSetsAreEqual:CG,theme:_G,toDenseArray:hb},Symbol.toStringTag,{value:"Module"})),Age=function(e,t){e=wge(e);const n={options:e};t=Mge(n,t),n.api=t;const i=mge(n);return t.onAdd=i.onAdd,t.onRemove=i.onRemove,t.types=El,t.options=e,t};function VE(e){Age(e,this)}VE.modes=SG;VE.constants=hG;VE.lib=Rge;/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function pb(e){return e+.5|0}const qh=(e,t,n)=>Math.max(Math.min(e,n),t);function M0(e){return qh(pb(e*2.55),0,255)}function sf(e){return qh(pb(e*255),0,255)}function Cd(e){return qh(pb(e/2.55)/100,0,1)}function T5(e){return qh(pb(e*100),0,100)}const lc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},YR=[..."0123456789ABCDEF"],Oge=e=>YR[e&15],Dge=e=>YR[(e&240)>>4]+YR[e&15],kw=e=>(e&240)>>4===(e&15),Lge=e=>kw(e.r)&&kw(e.g)&&kw(e.b)&&kw(e.a);function zge(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&lc[e[1]]*17,g:255&lc[e[2]]*17,b:255&lc[e[3]]*17,a:t===5?lc[e[4]]*17:255}:(t===7||t===9)&&(n={r:lc[e[1]]<<4|lc[e[2]],g:lc[e[3]]<<4|lc[e[4]],b:lc[e[5]]<<4|lc[e[6]],a:t===9?lc[e[7]]<<4|lc[e[8]]:255})),n}const kge=(e,t)=>e<255?t(e):"";function Fge(e){var t=Lge(e)?Oge:Dge;return e?"#"+t(e.r)+t(e.g)+t(e.b)+kge(e.a,t):void 0}const Nge=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function EG(e,t,n){const i=t*Math.min(n,1-n),s=(d,f=(d+e/30)%12)=>n-i*Math.max(Math.min(f-3,9-f,1),-1);return[s(0),s(8),s(4)]}function Bge(e,t,n){const i=(s,d=(s+e/60)%6)=>n-n*t*Math.max(Math.min(d,4-d,1),0);return[i(5),i(3),i(1)]}function $ge(e,t,n){const i=EG(e,1,.5);let s;for(t+n>1&&(s=1/(t+n),t*=s,n*=s),s=0;s<3;s++)i[s]*=1-t-n,i[s]+=t;return i}function jge(e,t,n,i,s){return e===s?(t-n)/i+(t<n?6:0):t===s?(n-e)/i+2:(e-t)/i+4}function PD(e){const n=e.r/255,i=e.g/255,s=e.b/255,d=Math.max(n,i,s),f=Math.min(n,i,s),o=(d+f)/2;let y,b,C;return d!==f&&(C=d-f,b=o>.5?C/(2-d-f):C/(d+f),y=jge(n,i,s,C,d),y=y*60+.5),[y|0,b||0,o]}function MD(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(sf)}function RD(e,t,n){return MD(EG,e,t,n)}function Vge(e,t,n){return MD($ge,e,t,n)}function Uge(e,t,n){return MD(Bge,e,t,n)}function TG(e){return(e%360+360)%360}function Hge(e){const t=Nge.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?M0(+t[5]):sf(+t[5]));const s=TG(+t[2]),d=+t[3]/100,f=+t[4]/100;return t[1]==="hwb"?i=Vge(s,d,f):t[1]==="hsv"?i=Uge(s,d,f):i=RD(s,d,f),{r:i[0],g:i[1],b:i[2],a:n}}function Gge(e,t){var n=PD(e);n[0]=TG(n[0]+t),n=RD(n),e.r=n[0],e.g=n[1],e.b=n[2]}function Wge(e){if(!e)return;const t=PD(e),n=t[0],i=T5(t[1]),s=T5(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${s}%, ${Cd(e.a)})`:`hsl(${n}, ${i}%, ${s}%)`}const I5={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},P5={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qge(){const e={},t=Object.keys(P5),n=Object.keys(I5);let i,s,d,f,o;for(i=0;i<t.length;i++){for(f=o=t[i],s=0;s<n.length;s++)d=n[s],o=o.replace(d,I5[d]);d=parseInt(P5[f],16),e[o]=[d>>16&255,d>>8&255,d&255]}return e}let Fw;function Kge(e){Fw||(Fw=qge(),Fw.transparent=[0,0,0,0]);const t=Fw[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Xge=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Zge(e){const t=Xge.exec(e);let n=255,i,s,d;if(t){if(t[7]!==i){const f=+t[7];n=t[8]?M0(f):qh(f*255,0,255)}return i=+t[1],s=+t[3],d=+t[5],i=255&(t[2]?M0(i):qh(i,0,255)),s=255&(t[4]?M0(s):qh(s,0,255)),d=255&(t[6]?M0(d):qh(d,0,255)),{r:i,g:s,b:d,a:n}}}function Yge(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Cd(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const pP=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Gg=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Jge(e,t,n){const i=Gg(Cd(e.r)),s=Gg(Cd(e.g)),d=Gg(Cd(e.b));return{r:sf(pP(i+n*(Gg(Cd(t.r))-i))),g:sf(pP(s+n*(Gg(Cd(t.g))-s))),b:sf(pP(d+n*(Gg(Cd(t.b))-d))),a:e.a+n*(t.a-e.a)}}function Nw(e,t,n){if(e){let i=PD(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=RD(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function IG(e,t){return e&&Object.assign(t||{},e)}function M5(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=sf(e[3]))):(t=IG(e,{r:0,g:0,b:0,a:1}),t.a=sf(t.a)),t}function Qge(e){return e.charAt(0)==="r"?Zge(e):Hge(e)}class Nx{constructor(t){if(t instanceof Nx)return t;const n=typeof t;let i;n==="object"?i=M5(t):n==="string"&&(i=zge(t)||Kge(t)||Qge(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=IG(this._rgb);return t&&(t.a=Cd(t.a)),t}set rgb(t){this._rgb=M5(t)}rgbString(){return this._valid?Yge(this._rgb):void 0}hexString(){return this._valid?Fge(this._rgb):void 0}hslString(){return this._valid?Wge(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,s=t.rgb;let d;const f=n===d?.5:n,o=2*f-1,y=i.a-s.a,b=((o*y===-1?o:(o+y)/(1+o*y))+1)/2;d=1-b,i.r=255&b*i.r+d*s.r+.5,i.g=255&b*i.g+d*s.g+.5,i.b=255&b*i.b+d*s.b+.5,i.a=f*i.a+(1-f)*s.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=Jge(this._rgb,t._rgb,n)),this}clone(){return new Nx(this.rgb)}alpha(t){return this._rgb.a=sf(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=pb(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Nw(this._rgb,2,t),this}darken(t){return Nw(this._rgb,2,-t),this}saturate(t){return Nw(this._rgb,1,t),this}desaturate(t){return Nw(this._rgb,1,-t),this}rotate(t){return Gge(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function _d(){}const eve=(()=>{let e=0;return()=>e++})();function ro(e){return e==null}function ga(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function uo(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function La(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function $l(e,t){return La(e)?e:t}function Bi(e,t){return typeof e>"u"?t:e}const tve=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,PG=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function ra(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function $o(e,t,n,i){let s,d,f;if(ga(e))for(d=e.length,s=0;s<d;s++)t.call(n,e[s],s);else if(uo(e))for(f=Object.keys(e),d=f.length,s=0;s<d;s++)t.call(n,e[f[s]],f[s])}function xC(e,t){let n,i,s,d;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(s=e[n],d=t[n],s.datasetIndex!==d.datasetIndex||s.index!==d.index)return!1;return!0}function bC(e){if(ga(e))return e.map(bC);if(uo(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let s=0;for(;s<i;++s)t[n[s]]=bC(e[n[s]]);return t}return e}function MG(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function nve(e,t,n,i){if(!MG(e))return;const s=t[e],d=n[e];uo(s)&&uo(d)?Bx(s,d,i):t[e]=bC(d)}function Bx(e,t,n){const i=ga(t)?t:[t],s=i.length;if(!uo(e))return e;n=n||{};const d=n.merger||nve;let f;for(let o=0;o<s;++o){if(f=i[o],!uo(f))continue;const y=Object.keys(f);for(let b=0,C=y.length;b<C;++b)d(y[b],e,f,n)}return e}function X0(e,t){return Bx(e,t,{merger:rve})}function rve(e,t,n){if(!MG(e))return;const i=t[e],s=n[e];uo(i)&&uo(s)?X0(i,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=bC(s))}const R5={"":e=>e,x:e=>e.x,y:e=>e.y};function ive(e){const t=e.split("."),n=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function ove(e){const t=ive(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function gf(e,t){return(R5[t]||(R5[t]=ove(t)))(e)}function AD(e){return e.charAt(0).toUpperCase()+e.slice(1)}const $x=e=>typeof e<"u",vf=e=>typeof e=="function",A5=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function ave(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Po=Math.PI,ha=2*Po,sve=ha+Po,wC=Number.POSITIVE_INFINITY,lve=Po/180,$a=Po/2,xp=Po/4,O5=Po*2/3,Kh=Math.log10,zu=Math.sign;function Z0(e,t,n){return Math.abs(e-t)<n}function D5(e){const t=Math.round(e);e=Z0(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Kh(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function cve(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((s,d)=>s-d).pop(),t}function uve(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Nv(e){return!uve(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function dve(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function RG(e,t,n){let i,s,d;for(i=0,s=e.length;i<s;i++)d=e[i][n],isNaN(d)||(t.min=Math.min(t.min,d),t.max=Math.max(t.max,d))}function Hc(e){return e*(Po/180)}function OD(e){return e*(180/Po)}function L5(e){if(!La(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function AG(e,t){const n=t.x-e.x,i=t.y-e.y,s=Math.sqrt(n*n+i*i);let d=Math.atan2(i,n);return d<-.5*Po&&(d+=ha),{angle:d,distance:s}}function JR(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function hve(e,t){return(e-t+sve)%ha-Po}function Ls(e){return(e%ha+ha)%ha}function jx(e,t,n,i){const s=Ls(e),d=Ls(t),f=Ls(n),o=Ls(d-s),y=Ls(f-s),b=Ls(s-d),C=Ls(s-f);return s===d||s===f||i&&d===f||o>y&&b<C}function hs(e,t,n){return Math.max(t,Math.min(n,e))}function fve(e){return hs(e,-32768,32767)}function Pd(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function DD(e,t,n){n=n||(f=>e[f]<t);let i=e.length-1,s=0,d;for(;i-s>1;)d=s+i>>1,n(d)?s=d:i=d;return{lo:s,hi:i}}const Md=(e,t,n,i)=>DD(e,n,i?s=>{const d=e[s][t];return d<n||d===n&&e[s+1][t]===n}:s=>e[s][t]<n),pve=(e,t,n)=>DD(e,n,i=>e[i][t]>=n);function mve(e,t,n){let i=0,s=e.length;for(;i<s&&e[i]<t;)i++;for(;s>i&&e[s-1]>n;)s--;return i>0||s<e.length?e.slice(i,s):e}const OG=["push","pop","shift","splice","unshift"];function gve(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),OG.forEach(n=>{const i="_onData"+AD(n),s=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...d){const f=s.apply(this,d);return e._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...d)}),f}})})}function z5(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(OG.forEach(d=>{delete e[d]}),delete e._chartjs)}function DG(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const LG=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function zG(e,t){let n=[],i=!1;return function(...s){n=s,i||(i=!0,LG.call(window,()=>{i=!1,e.apply(t,n)}))}}function vve(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const LD=e=>e==="start"?"left":e==="end"?"right":"center",As=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,_ve=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function kG(e,t,n){const i=t.length;let s=0,d=i;if(e._sorted){const{iScale:f,vScale:o,_parsed:y}=e,b=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,C=f.axis,{min:P,max:A,minDefined:D,maxDefined:k}=f.getUserBounds();if(D){if(s=Math.min(Md(y,C,P).lo,n?i:Md(t,C,f.getPixelForValue(P)).lo),b){const B=y.slice(0,s+1).reverse().findIndex(N=>!ro(N[o.axis]));s-=Math.max(0,B)}s=hs(s,0,i-1)}if(k){let B=Math.max(Md(y,f.axis,A,!0).hi+1,n?0:Md(t,C,f.getPixelForValue(A),!0).hi+1);if(b){const N=y.slice(B-1).findIndex(j=>!ro(j[o.axis]));B+=Math.max(0,N)}d=hs(B,s,i)-s}else d=i-s}return{start:s,count:d}}function FG(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,s={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=s,!0;const d=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,s),d}const Bw=e=>e===0||e===1,k5=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*ha/n)),F5=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*ha/n)+1,Y0={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*$a)+1,easeOutSine:e=>Math.sin(e*$a),easeInOutSine:e=>-.5*(Math.cos(Po*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Bw(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Bw(e)?e:k5(e,.075,.3),easeOutElastic:e=>Bw(e)?e:F5(e,.075,.3),easeInOutElastic(e){return Bw(e)?e:e<.5?.5*k5(e*2,.1125,.45):.5+.5*F5(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Y0.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Y0.easeInBounce(e*2)*.5:Y0.easeOutBounce(e*2-1)*.5+.5};function zD(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function N5(e){return zD(e)?e:new Nx(e)}function mP(e){return zD(e)?e:new Nx(e).saturate(.5).darken(.1).hexString()}const yve=["x","y","borderWidth","radius","tension"],xve=["color","borderColor","backgroundColor"];function bve(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:xve},numbers:{type:"number",properties:yve}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function wve(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const B5=new Map;function Sve(e,t){t=t||{};const n=e+JSON.stringify(t);let i=B5.get(n);return i||(i=new Intl.NumberFormat(e,t),B5.set(n,i)),i}function mb(e,t,n){return Sve(t,n).format(e)}const NG={values(e){return ga(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let s,d=e;if(n.length>1){const b=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(b<1e-4||b>1e15)&&(s="scientific"),d=Cve(e,n)}const f=Kh(Math.abs(d)),o=isNaN(f)?1:Math.max(Math.min(-1*Math.floor(f),20),0),y={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(y,this.options.ticks.format),mb(e,i,y)},logarithmic(e,t,n){if(e===0)return"0";const i=n[t].significand||e/Math.pow(10,Math.floor(Kh(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?NG.numeric.call(this,e,t,n):""}};function Cve(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var UE={formatters:NG};function Eve(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:UE.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Yp=Object.create(null),QR=Object.create(null);function J0(e,t){if(!t)return e;const n=t.split(".");for(let i=0,s=n.length;i<s;++i){const d=n[i];e=e[d]||(e[d]=Object.create(null))}return e}function gP(e,t,n){return typeof t=="string"?Bx(J0(e,t),n):Bx(J0(e,""),t)}class Tve{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>mP(s.backgroundColor),this.hoverBorderColor=(i,s)=>mP(s.borderColor),this.hoverColor=(i,s)=>mP(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return gP(this,t,n)}get(t){return J0(this,t)}describe(t,n){return gP(QR,t,n)}override(t,n){return gP(Yp,t,n)}route(t,n,i,s){const d=J0(this,t),f=J0(this,i),o="_"+n;Object.defineProperties(d,{[o]:{value:d[n],writable:!0},[n]:{enumerable:!0,get(){const y=this[o],b=f[s];return uo(y)?Object.assign({},b,y):Bi(y,b)},set(y){this[o]=y}}})}apply(t){t.forEach(n=>n(this))}}var _a=new Tve({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[bve,wve,Eve]);function Ive(e){return!e||ro(e.size)||ro(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function SC(e,t,n,i,s){let d=t[s];return d||(d=t[s]=e.measureText(s).width,n.push(s)),d>i&&(i=d),i}function Pve(e,t,n,i){i=i||{};let s=i.data=i.data||{},d=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},d=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let f=0;const o=n.length;let y,b,C,P,A;for(y=0;y<o;y++)if(P=n[y],P!=null&&!ga(P))f=SC(e,s,d,f,P);else if(ga(P))for(b=0,C=P.length;b<C;b++)A=P[b],A!=null&&!ga(A)&&(f=SC(e,s,d,f,A));e.restore();const D=d.length/2;if(D>n.length){for(y=0;y<D;y++)delete s[d[y]];d.splice(0,D)}return f}function bp(e,t,n){const i=e.currentDevicePixelRatio,s=n!==0?Math.max(n/2,.5):0;return Math.round((t-s)*i)/i+s}function $5(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function eA(e,t,n,i){BG(e,t,n,i,null)}function BG(e,t,n,i,s){let d,f,o,y,b,C,P,A;const D=t.pointStyle,k=t.rotation,B=t.radius;let N=(k||0)*lve;if(D&&typeof D=="object"&&(d=D.toString(),d==="[object HTMLImageElement]"||d==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(N),e.drawImage(D,-D.width/2,-D.height/2,D.width,D.height),e.restore();return}if(!(isNaN(B)||B<=0)){switch(e.beginPath(),D){default:s?e.ellipse(n,i,s/2,B,0,0,ha):e.arc(n,i,B,0,ha),e.closePath();break;case"triangle":C=s?s/2:B,e.moveTo(n+Math.sin(N)*C,i-Math.cos(N)*B),N+=O5,e.lineTo(n+Math.sin(N)*C,i-Math.cos(N)*B),N+=O5,e.lineTo(n+Math.sin(N)*C,i-Math.cos(N)*B),e.closePath();break;case"rectRounded":b=B*.516,y=B-b,f=Math.cos(N+xp)*y,P=Math.cos(N+xp)*(s?s/2-b:y),o=Math.sin(N+xp)*y,A=Math.sin(N+xp)*(s?s/2-b:y),e.arc(n-P,i-o,b,N-Po,N-$a),e.arc(n+A,i-f,b,N-$a,N),e.arc(n+P,i+o,b,N,N+$a),e.arc(n-A,i+f,b,N+$a,N+Po),e.closePath();break;case"rect":if(!k){y=Math.SQRT1_2*B,C=s?s/2:y,e.rect(n-C,i-y,2*C,2*y);break}N+=xp;case"rectRot":P=Math.cos(N)*(s?s/2:B),f=Math.cos(N)*B,o=Math.sin(N)*B,A=Math.sin(N)*(s?s/2:B),e.moveTo(n-P,i-o),e.lineTo(n+A,i-f),e.lineTo(n+P,i+o),e.lineTo(n-A,i+f),e.closePath();break;case"crossRot":N+=xp;case"cross":P=Math.cos(N)*(s?s/2:B),f=Math.cos(N)*B,o=Math.sin(N)*B,A=Math.sin(N)*(s?s/2:B),e.moveTo(n-P,i-o),e.lineTo(n+P,i+o),e.moveTo(n+A,i-f),e.lineTo(n-A,i+f);break;case"star":P=Math.cos(N)*(s?s/2:B),f=Math.cos(N)*B,o=Math.sin(N)*B,A=Math.sin(N)*(s?s/2:B),e.moveTo(n-P,i-o),e.lineTo(n+P,i+o),e.moveTo(n+A,i-f),e.lineTo(n-A,i+f),N+=xp,P=Math.cos(N)*(s?s/2:B),f=Math.cos(N)*B,o=Math.sin(N)*B,A=Math.sin(N)*(s?s/2:B),e.moveTo(n-P,i-o),e.lineTo(n+P,i+o),e.moveTo(n+A,i-f),e.lineTo(n-A,i+f);break;case"line":f=s?s/2:Math.cos(N)*B,o=Math.sin(N)*B,e.moveTo(n-f,i-o),e.lineTo(n+f,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(N)*(s?s/2:B),i+Math.sin(N)*B);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Rd(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function HE(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function GE(e){e.restore()}function Mve(e,t,n,i,s){if(!t)return e.lineTo(n.x,n.y);if(s==="middle"){const d=(t.x+n.x)/2;e.lineTo(d,t.y),e.lineTo(d,n.y)}else s==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Rve(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function Ave(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),ro(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Ove(e,t,n,i,s){if(s.strikethrough||s.underline){const d=e.measureText(i),f=t-d.actualBoundingBoxLeft,o=t+d.actualBoundingBoxRight,y=n-d.actualBoundingBoxAscent,b=n+d.actualBoundingBoxDescent,C=s.strikethrough?(y+b)/2:b;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(f,C),e.lineTo(o,C),e.stroke()}}function Dve(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Jp(e,t,n,i,s,d={}){const f=ga(t)?t:[t],o=d.strokeWidth>0&&d.strokeColor!=="";let y,b;for(e.save(),e.font=s.string,Ave(e,d),y=0;y<f.length;++y)b=f[y],d.backdrop&&Dve(e,d.backdrop),o&&(d.strokeColor&&(e.strokeStyle=d.strokeColor),ro(d.strokeWidth)||(e.lineWidth=d.strokeWidth),e.strokeText(b,n,i,d.maxWidth)),e.fillText(b,n,i,d.maxWidth),Ove(e,n,i,b,d),i+=Number(s.lineHeight);e.restore()}function Vx(e,t){const{x:n,y:i,w:s,h:d,radius:f}=t;e.arc(n+f.topLeft,i+f.topLeft,f.topLeft,1.5*Po,Po,!0),e.lineTo(n,i+d-f.bottomLeft),e.arc(n+f.bottomLeft,i+d-f.bottomLeft,f.bottomLeft,Po,$a,!0),e.lineTo(n+s-f.bottomRight,i+d),e.arc(n+s-f.bottomRight,i+d-f.bottomRight,f.bottomRight,$a,0,!0),e.lineTo(n+s,i+f.topRight),e.arc(n+s-f.topRight,i+f.topRight,f.topRight,0,-$a,!0),e.lineTo(n+f.topLeft,i)}const Lve=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,zve=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function kve(e,t){const n=(""+e).match(Lve);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const Fve=e=>+e||0;function kD(e,t){const n={},i=uo(t),s=i?Object.keys(t):t,d=uo(e)?i?f=>Bi(e[f],e[t[f]]):f=>e[f]:()=>e;for(const f of s)n[f]=Fve(d(f));return n}function $G(e){return kD(e,{top:"y",right:"x",bottom:"y",left:"x"})}function $p(e){return kD(e,["topLeft","topRight","bottomLeft","bottomRight"])}function js(e){const t=$G(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function rs(e,t){e=e||{},t=t||_a.font;let n=Bi(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=Bi(e.style,t.style);i&&!(""+i).match(zve)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:Bi(e.family,t.family),lineHeight:kve(Bi(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:Bi(e.weight,t.weight),string:""};return s.string=Ive(s),s}function R0(e,t,n,i){let s,d,f;for(s=0,d=e.length;s<d;++s)if(f=e[s],f!==void 0&&f!==void 0)return f}function Nve(e,t,n){const{min:i,max:s}=e,d=PG(t,(s-i)/2),f=(o,y)=>n&&o===0?0:o+y;return{min:f(i,-Math.abs(d)),max:f(s,d)}}function Cf(e,t){return Object.assign(Object.create(e),t)}function FD(e,t=[""],n,i,s=()=>e[0]){const d=n||e;typeof i>"u"&&(i=HG("_fallback",e));const f={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:d,_fallback:i,_getTarget:s,override:o=>FD([o,...e],t,d,i)};return new Proxy(f,{deleteProperty(o,y){return delete o[y],delete o._keys,delete e[0][y],!0},get(o,y){return VG(o,y,()=>Wve(y,t,e,o))},getOwnPropertyDescriptor(o,y){return Reflect.getOwnPropertyDescriptor(o._scopes[0],y)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(o,y){return V5(o).includes(y)},ownKeys(o){return V5(o)},set(o,y,b){const C=o._storage||(o._storage=s());return o[y]=C[y]=b,delete o._keys,!0}})}function Bv(e,t,n,i){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:jG(e,i),setContext:d=>Bv(e,d,n,i),override:d=>Bv(e.override(d),t,n,i)};return new Proxy(s,{deleteProperty(d,f){return delete d[f],delete e[f],!0},get(d,f,o){return VG(d,f,()=>$ve(d,f,o))},getOwnPropertyDescriptor(d,f){return d._descriptors.allKeys?Reflect.has(e,f)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,f)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(d,f){return Reflect.has(e,f)},ownKeys(){return Reflect.ownKeys(e)},set(d,f,o){return e[f]=o,delete d[f],!0}})}function jG(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:n,indexable:i,isScriptable:vf(n)?n:()=>n,isIndexable:vf(i)?i:()=>i}}const Bve=(e,t)=>e?e+AD(t):t,ND=(e,t)=>uo(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function VG(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const i=n();return e[t]=i,i}function $ve(e,t,n){const{_proxy:i,_context:s,_subProxy:d,_descriptors:f}=e;let o=i[t];return vf(o)&&f.isScriptable(t)&&(o=jve(t,o,e,n)),ga(o)&&o.length&&(o=Vve(t,o,e,f.isIndexable)),ND(t,o)&&(o=Bv(o,s,d&&d[t],f)),o}function jve(e,t,n,i){const{_proxy:s,_context:d,_subProxy:f,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let y=t(d,f||i);return o.delete(e),ND(e,y)&&(y=BD(s._scopes,s,e,y)),y}function Vve(e,t,n,i){const{_proxy:s,_context:d,_subProxy:f,_descriptors:o}=n;if(typeof d.index<"u"&&i(e))return t[d.index%t.length];if(uo(t[0])){const y=t,b=s._scopes.filter(C=>C!==y);t=[];for(const C of y){const P=BD(b,s,e,C);t.push(Bv(P,d,f&&f[e],o))}}return t}function UG(e,t,n){return vf(e)?e(t,n):e}const Uve=(e,t)=>e===!0?t:typeof e=="string"?gf(t,e):void 0;function Hve(e,t,n,i,s){for(const d of t){const f=Uve(n,d);if(f){e.add(f);const o=UG(f._fallback,n,s);if(typeof o<"u"&&o!==n&&o!==i)return o}else if(f===!1&&typeof i<"u"&&n!==i)return null}return!1}function BD(e,t,n,i){const s=t._rootScopes,d=UG(t._fallback,n,i),f=[...e,...s],o=new Set;o.add(i);let y=j5(o,f,n,d||n,i);return y===null||typeof d<"u"&&d!==n&&(y=j5(o,f,d,y,i),y===null)?!1:FD(Array.from(o),[""],s,d,()=>Gve(t,n,i))}function j5(e,t,n,i,s){for(;n;)n=Hve(e,t,n,i,s);return n}function Gve(e,t,n){const i=e._getTarget();t in i||(i[t]={});const s=i[t];return ga(s)&&uo(n)?n:s||{}}function Wve(e,t,n,i){let s;for(const d of t)if(s=HG(Bve(d,e),n),typeof s<"u")return ND(e,s)?BD(n,i,e,s):s}function HG(e,t){for(const n of t){if(!n)continue;const i=n[e];if(typeof i<"u")return i}}function V5(e){let t=e._keys;return t||(t=e._keys=qve(e._scopes)),t}function qve(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function GG(e,t,n,i){const{iScale:s}=e,{key:d="r"}=this._parsing,f=new Array(i);let o,y,b,C;for(o=0,y=i;o<y;++o)b=o+n,C=t[b],f[o]={r:s.parse(gf(C,d),b)};return f}const Kve=Number.EPSILON||1e-14,$v=(e,t)=>t<e.length&&!e[t].skip&&e[t],WG=e=>e==="x"?"y":"x";function Xve(e,t,n,i){const s=e.skip?t:e,d=t,f=n.skip?t:n,o=JR(d,s),y=JR(f,d);let b=o/(o+y),C=y/(o+y);b=isNaN(b)?0:b,C=isNaN(C)?0:C;const P=i*b,A=i*C;return{previous:{x:d.x-P*(f.x-s.x),y:d.y-P*(f.y-s.y)},next:{x:d.x+A*(f.x-s.x),y:d.y+A*(f.y-s.y)}}}function Zve(e,t,n){const i=e.length;let s,d,f,o,y,b=$v(e,0);for(let C=0;C<i-1;++C)if(y=b,b=$v(e,C+1),!(!y||!b)){if(Z0(t[C],0,Kve)){n[C]=n[C+1]=0;continue}s=n[C]/t[C],d=n[C+1]/t[C],o=Math.pow(s,2)+Math.pow(d,2),!(o<=9)&&(f=3/Math.sqrt(o),n[C]=s*f*t[C],n[C+1]=d*f*t[C])}}function Yve(e,t,n="x"){const i=WG(n),s=e.length;let d,f,o,y=$v(e,0);for(let b=0;b<s;++b){if(f=o,o=y,y=$v(e,b+1),!o)continue;const C=o[n],P=o[i];f&&(d=(C-f[n])/3,o[`cp1${n}`]=C-d,o[`cp1${i}`]=P-d*t[b]),y&&(d=(y[n]-C)/3,o[`cp2${n}`]=C+d,o[`cp2${i}`]=P+d*t[b])}}function Jve(e,t="x"){const n=WG(t),i=e.length,s=Array(i).fill(0),d=Array(i);let f,o,y,b=$v(e,0);for(f=0;f<i;++f)if(o=y,y=b,b=$v(e,f+1),!!y){if(b){const C=b[t]-y[t];s[f]=C!==0?(b[n]-y[n])/C:0}d[f]=o?b?zu(s[f-1])!==zu(s[f])?0:(s[f-1]+s[f])/2:s[f-1]:s[f]}Zve(e,s,d),Yve(e,d,t)}function $w(e,t,n){return Math.max(Math.min(e,n),t)}function Qve(e,t){let n,i,s,d,f,o=Rd(e[0],t);for(n=0,i=e.length;n<i;++n)f=d,d=o,o=n<i-1&&Rd(e[n+1],t),d&&(s=e[n],f&&(s.cp1x=$w(s.cp1x,t.left,t.right),s.cp1y=$w(s.cp1y,t.top,t.bottom)),o&&(s.cp2x=$w(s.cp2x,t.left,t.right),s.cp2y=$w(s.cp2y,t.top,t.bottom)))}function e_e(e,t,n,i,s){let d,f,o,y;if(t.spanGaps&&(e=e.filter(b=>!b.skip)),t.cubicInterpolationMode==="monotone")Jve(e,s);else{let b=i?e[e.length-1]:e[0];for(d=0,f=e.length;d<f;++d)o=e[d],y=Xve(b,o,e[Math.min(d+1,f-(i?0:1))%f],t.tension),o.cp1x=y.previous.x,o.cp1y=y.previous.y,o.cp2x=y.next.x,o.cp2y=y.next.y,b=o}t.capBezierPoints&&Qve(e,n)}function $D(){return typeof window<"u"&&typeof document<"u"}function jD(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function CC(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const WE=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function t_e(e,t){return WE(e).getPropertyValue(t)}const n_e=["top","right","bottom","left"];function jp(e,t,n){const i={};n=n?"-"+n:"";for(let s=0;s<4;s++){const d=n_e[s];i[d]=parseFloat(e[t+"-"+d+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const r_e=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function i_e(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:s,offsetY:d}=i;let f=!1,o,y;if(r_e(s,d,e.target))o=s,y=d;else{const b=t.getBoundingClientRect();o=i.clientX-b.left,y=i.clientY-b.top,f=!0}return{x:o,y,box:f}}function Ip(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,s=WE(n),d=s.boxSizing==="border-box",f=jp(s,"padding"),o=jp(s,"border","width"),{x:y,y:b,box:C}=i_e(e,n),P=f.left+(C&&o.left),A=f.top+(C&&o.top);let{width:D,height:k}=t;return d&&(D-=f.width+o.width,k-=f.height+o.height),{x:Math.round((y-P)/D*n.width/i),y:Math.round((b-A)/k*n.height/i)}}function o_e(e,t,n){let i,s;if(t===void 0||n===void 0){const d=e&&jD(e);if(!d)t=e.clientWidth,n=e.clientHeight;else{const f=d.getBoundingClientRect(),o=WE(d),y=jp(o,"border","width"),b=jp(o,"padding");t=f.width-b.width-y.width,n=f.height-b.height-y.height,i=CC(o.maxWidth,d,"clientWidth"),s=CC(o.maxHeight,d,"clientHeight")}}return{width:t,height:n,maxWidth:i||wC,maxHeight:s||wC}}const Xh=e=>Math.round(e*10)/10;function a_e(e,t,n,i){const s=WE(e),d=jp(s,"margin"),f=CC(s.maxWidth,e,"clientWidth")||wC,o=CC(s.maxHeight,e,"clientHeight")||wC,y=o_e(e,t,n);let{width:b,height:C}=y;if(s.boxSizing==="content-box"){const A=jp(s,"border","width"),D=jp(s,"padding");b-=D.width+A.width,C-=D.height+A.height}return b=Math.max(0,b-d.width),C=Math.max(0,i?b/i:C-d.height),b=Xh(Math.min(b,f,y.maxWidth)),C=Xh(Math.min(C,o,y.maxHeight)),b&&!C&&(C=Xh(b/2)),(t!==void 0||n!==void 0)&&i&&y.height&&C>y.height&&(C=y.height,b=Xh(Math.floor(C*i))),{width:b,height:C}}function U5(e,t,n){const i=t||1,s=Xh(e.height*i),d=Xh(e.width*i);e.height=Xh(e.height),e.width=Xh(e.width);const f=e.canvas;return f.style&&(n||!f.style.height&&!f.style.width)&&(f.style.height=`${e.height}px`,f.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||f.height!==s||f.width!==d?(e.currentDevicePixelRatio=i,f.height=s,f.width=d,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const s_e=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};$D()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function H5(e,t){const n=t_e(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Pp(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function l_e(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function c_e(e,t,n,i){const s={x:e.cp2x,y:e.cp2y},d={x:t.cp1x,y:t.cp1y},f=Pp(e,s,n),o=Pp(s,d,n),y=Pp(d,t,n),b=Pp(f,o,n),C=Pp(o,y,n);return Pp(b,C,n)}const u_e=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},d_e=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function bv(e,t,n){return e?u_e(t,n):d_e()}function qG(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function KG(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function XG(e){return e==="angle"?{between:jx,compare:hve,normalize:Ls}:{between:Pd,compare:(t,n)=>t-n,normalize:t=>t}}function G5({start:e,end:t,count:n,loop:i,style:s}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:s}}function h_e(e,t,n){const{property:i,start:s,end:d}=n,{between:f,normalize:o}=XG(i),y=t.length;let{start:b,end:C,loop:P}=e,A,D;if(P){for(b+=y,C+=y,A=0,D=y;A<D&&f(o(t[b%y][i]),s,d);++A)b--,C--;b%=y,C%=y}return C<b&&(C+=y),{start:b,end:C,loop:P,style:e.style}}function ZG(e,t,n){if(!n)return[e];const{property:i,start:s,end:d}=n,f=t.length,{compare:o,between:y,normalize:b}=XG(i),{start:C,end:P,loop:A,style:D}=h_e(e,t,n),k=[];let B=!1,N=null,j,V,K;const Y=()=>y(s,K,j)&&o(s,K)!==0,Z=()=>o(d,j)===0||y(d,K,j),te=()=>B||Y(),ne=()=>!B||Z();for(let se=C,ee=C;se<=P;++se)V=t[se%f],!V.skip&&(j=b(V[i]),j!==K&&(B=y(j,s,d),N===null&&te()&&(N=o(j,s)===0?se:ee),N!==null&&ne()&&(k.push(G5({start:N,end:se,loop:A,count:f,style:D})),N=null),ee=se,K=j));return N!==null&&k.push(G5({start:N,end:P,loop:A,count:f,style:D})),k}function YG(e,t){const n=[],i=e.segments;for(let s=0;s<i.length;s++){const d=ZG(i[s],e.points,t);d.length&&n.push(...d)}return n}function f_e(e,t,n,i){let s=0,d=t-1;if(n&&!i)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,n&&(d+=s);d>s&&e[d%t].skip;)d--;return d%=t,{start:s,end:d}}function p_e(e,t,n,i){const s=e.length,d=[];let f=t,o=e[t],y;for(y=t+1;y<=n;++y){const b=e[y%s];b.skip||b.stop?o.skip||(i=!1,d.push({start:t%s,end:(y-1)%s,loop:i}),t=f=b.stop?y:null):(f=y,o.skip&&(t=y)),o=b}return f!==null&&d.push({start:t%s,end:f%s,loop:i}),d}function m_e(e,t){const n=e.points,i=e.options.spanGaps,s=n.length;if(!s)return[];const d=!!e._loop,{start:f,end:o}=f_e(n,s,d,i);if(i===!0)return W5(e,[{start:f,end:o,loop:d}],n,t);const y=o<f?o+s:o,b=!!e._fullLoop&&f===0&&o===s-1;return W5(e,p_e(n,f,y,b),n,t)}function W5(e,t,n,i){return!i||!i.setContext||!n?t:g_e(e,t,n,i)}function g_e(e,t,n,i){const s=e._chart.getContext(),d=q5(e.options),{_datasetIndex:f,options:{spanGaps:o}}=e,y=n.length,b=[];let C=d,P=t[0].start,A=P;function D(k,B,N,j){const V=o?-1:1;if(k!==B){for(k+=y;n[k%y].skip;)k-=V;for(;n[B%y].skip;)B+=V;k%y!==B%y&&(b.push({start:k%y,end:B%y,loop:N,style:j}),C=j,P=B%y)}}for(const k of t){P=o?P:k.start;let B=n[P%y],N;for(A=P+1;A<=k.end;A++){const j=n[A%y];N=q5(i.setContext(Cf(s,{type:"segment",p0:B,p1:j,p0DataIndex:(A-1)%y,p1DataIndex:A%y,datasetIndex:f}))),v_e(N,C)&&D(P,A-1,k.loop,C),B=j,C=N}P<A-1&&D(P,A-1,k.loop,C)}return b}function q5(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function v_e(e,t){if(!t)return!1;const n=[],i=function(s,d){return zD(d)?(n.includes(d)||n.push(d),n.indexOf(d)):d};return JSON.stringify(e,i)!==JSON.stringify(t,i)}function jw(e,t,n){return e.options.clip?e[n]:t[n]}function __e(e,t){const{xScale:n,yScale:i}=e;return n&&i?{left:jw(n,t,"left"),right:jw(n,t,"right"),top:jw(i,t,"top"),bottom:jw(i,t,"bottom")}:t}function JG(e,t){const n=t._clip;if(n.disabled)return!1;const i=__e(t,e.chartArea);return{left:n.left===!1?0:i.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:i.right+(n.right===!0?0:n.right),top:n.top===!1?0:i.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:i.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class y_e{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,s){const d=n.listeners[s],f=n.duration;d.forEach(o=>o({chart:t,initial:n.initial,numSteps:f,currentStep:Math.min(i-n.start,f)}))}_refresh(){this._request||(this._running=!0,this._request=LG.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const d=i.items;let f=d.length-1,o=!1,y;for(;f>=0;--f)y=d[f],y._active?(y._total>i.duration&&(i.duration=y._total),y.tick(t),o=!0):(d[f]=d[d.length-1],d.pop());o&&(s.draw(),this._notify(s,i,t,"progress")),d.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),n+=d.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var xd=new y_e;const K5="transparent",x_e={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=N5(e||K5),s=i.valid&&N5(t||K5);return s&&s.valid?s.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class b_e{constructor(t,n,i,s){const d=n[i];s=R0([t.to,s,d,t.from]);const f=R0([t.from,d,s]);this._active=!0,this._fn=t.fn||x_e[t.type||typeof f],this._easing=Y0[t.easing]||Y0.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=f,this._to=s,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const s=this._target[this._prop],d=i-this._start,f=this._duration-d;this._start=i,this._duration=Math.floor(Math.max(f,t.duration)),this._total+=d,this._loop=!!t.loop,this._to=R0([t.to,n,s,t.from]),this._from=R0([t.from,s,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,s=this._prop,d=this._from,f=this._loop,o=this._to;let y;if(this._active=d!==o&&(f||n<i),!this._active){this._target[s]=o,this._notify(!0);return}if(n<0){this._target[s]=d;return}y=n/i%2,y=f&&y>1?2-y:y,y=this._easing(Math.min(1,Math.max(0,y))),this._target[s]=this._fn(d,o,y)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][n]()}}class QG{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!uo(t))return;const n=Object.keys(_a.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const d=t[s];if(!uo(d))return;const f={};for(const o of n)f[o]=d[o];(ga(d.properties)&&d.properties||[s]).forEach(o=>{(o===s||!i.has(o))&&i.set(o,f)})})}_animateOptions(t,n){const i=n.options,s=S_e(t,i);if(!s)return[];const d=this._createAnimations(s,i);return i.$shared&&w_e(t.options.$animations,i).then(()=>{t.options=i},()=>{}),d}_createAnimations(t,n){const i=this._properties,s=[],d=t.$animations||(t.$animations={}),f=Object.keys(n),o=Date.now();let y;for(y=f.length-1;y>=0;--y){const b=f[y];if(b.charAt(0)==="$")continue;if(b==="options"){s.push(...this._animateOptions(t,n));continue}const C=n[b];let P=d[b];const A=i.get(b);if(P)if(A&&P.active()){P.update(A,C,o);continue}else P.cancel();if(!A||!A.duration){t[b]=C;continue}d[b]=P=new b_e(A,t,b,C),s.push(P)}return s}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return xd.add(this._chart,i),!0}}function w_e(e,t){const n=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const d=e[i[s]];d&&d.active()&&n.push(d.wait())}return Promise.all(n)}function S_e(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function X5(e,t){const n=e&&e.options||{},i=n.reverse,s=n.min===void 0?t:0,d=n.max===void 0?t:0;return{start:i?d:s,end:i?s:d}}function C_e(e,t,n){if(n===!1)return!1;const i=X5(e,n),s=X5(t,n);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function E_e(e){let t,n,i,s;return uo(e)?(t=e.top,n=e.right,i=e.bottom,s=e.left):t=n=i=s=e,{top:t,right:n,bottom:i,left:s,disabled:e===!1}}function eW(e,t){const n=[],i=e._getSortedDatasetMetas(t);let s,d;for(s=0,d=i.length;s<d;++s)n.push(i[s].index);return n}function Z5(e,t,n,i={}){const s=e.keys,d=i.mode==="single";let f,o,y,b;if(t===null)return;let C=!1;for(f=0,o=s.length;f<o;++f){if(y=+s[f],y===n){if(C=!0,i.all)continue;break}b=e.values[y],La(b)&&(d||t===0||zu(t)===zu(b))&&(t+=b)}return!C&&!i.all?0:t}function T_e(e,t){const{iScale:n,vScale:i}=t,s=n.axis==="x"?"x":"y",d=i.axis==="x"?"x":"y",f=Object.keys(e),o=new Array(f.length);let y,b,C;for(y=0,b=f.length;y<b;++y)C=f[y],o[y]={[s]:C,[d]:e[C]};return o}function vP(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function I_e(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function P_e(e){const{min:t,max:n,minDefined:i,maxDefined:s}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}function M_e(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function Y5(e,t,n,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const d=e[s.index];if(n&&d>0||!n&&d<0)return s.index}return null}function J5(e,t){const{chart:n,_cachedMeta:i}=e,s=n._stacks||(n._stacks={}),{iScale:d,vScale:f,index:o}=i,y=d.axis,b=f.axis,C=I_e(d,f,i),P=t.length;let A;for(let D=0;D<P;++D){const k=t[D],{[y]:B,[b]:N}=k,j=k._stacks||(k._stacks={});A=j[b]=M_e(s,C,B),A[o]=N,A._top=Y5(A,f,!0,i.type),A._bottom=Y5(A,f,!1,i.type);const V=A._visualValues||(A._visualValues={});V[o]=N}}function _P(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function R_e(e,t){return Cf(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function A_e(e,t,n){return Cf(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function v0(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const s of t){const d=s._stacks;if(!d||d[i]===void 0||d[i][n]===void 0)return;delete d[i][n],d[i]._visualValues!==void 0&&d[i]._visualValues[n]!==void 0&&delete d[i]._visualValues[n]}}}const yP=e=>e==="reset"||e==="none",Q5=(e,t)=>t?e:Object.assign({},e),O_e=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:eW(n,!0),values:null};class Xc{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=vP(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&v0(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),s=(P,A,D,k)=>P==="x"?A:P==="r"?k:D,d=n.xAxisID=Bi(i.xAxisID,_P(t,"x")),f=n.yAxisID=Bi(i.yAxisID,_P(t,"y")),o=n.rAxisID=Bi(i.rAxisID,_P(t,"r")),y=n.indexAxis,b=n.iAxisID=s(y,d,f,o),C=n.vAxisID=s(y,f,d,o);n.xScale=this.getScaleForId(d),n.yScale=this.getScaleForId(f),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(b),n.vScale=this.getScaleForId(C)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&z5(this._data,this),t._stacked&&v0(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(uo(n)){const s=this._cachedMeta;this._data=T_e(n,s)}else if(i!==n){if(i){z5(i,this);const s=this._cachedMeta;v0(s),s._parsed=[]}n&&Object.isExtensible(n)&&gve(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const d=n._stacked;n._stacked=vP(n.vScale,n),n.stack!==i.stack&&(s=!0,v0(n),n.stack=i.stack),this._resyncElements(t),(s||d!==n._stacked)&&(J5(this,n._parsed),n._stacked=vP(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:s}=this,{iScale:d,_stacked:f}=i,o=d.axis;let y=t===0&&n===s.length?!0:i._sorted,b=t>0&&i._parsed[t-1],C,P,A;if(this._parsing===!1)i._parsed=s,i._sorted=!0,A=s;else{ga(s[t])?A=this.parseArrayData(i,s,t,n):uo(s[t])?A=this.parseObjectData(i,s,t,n):A=this.parsePrimitiveData(i,s,t,n);const D=()=>P[o]===null||b&&P[o]<b[o];for(C=0;C<n;++C)i._parsed[C+t]=P=A[C],y&&(D()&&(y=!1),b=P);i._sorted=y}f&&J5(this,A)}parsePrimitiveData(t,n,i,s){const{iScale:d,vScale:f}=t,o=d.axis,y=f.axis,b=d.getLabels(),C=d===f,P=new Array(s);let A,D,k;for(A=0,D=s;A<D;++A)k=A+i,P[A]={[o]:C||d.parse(b[k],k),[y]:f.parse(n[k],k)};return P}parseArrayData(t,n,i,s){const{xScale:d,yScale:f}=t,o=new Array(s);let y,b,C,P;for(y=0,b=s;y<b;++y)C=y+i,P=n[C],o[y]={x:d.parse(P[0],C),y:f.parse(P[1],C)};return o}parseObjectData(t,n,i,s){const{xScale:d,yScale:f}=t,{xAxisKey:o="x",yAxisKey:y="y"}=this._parsing,b=new Array(s);let C,P,A,D;for(C=0,P=s;C<P;++C)A=C+i,D=n[A],b[C]={x:d.parse(gf(D,o),A),y:f.parse(gf(D,y),A)};return b}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const s=this.chart,d=this._cachedMeta,f=n[t.axis],o={keys:eW(s,!0),values:n._stacks[t.axis]._visualValues};return Z5(o,f,d.index,{mode:i})}updateRangeFromParsed(t,n,i,s){const d=i[n.axis];let f=d===null?NaN:d;const o=s&&i._stacks[n.axis];s&&o&&(s.values=o,f=Z5(s,d,this._cachedMeta.index)),t.min=Math.min(t.min,f),t.max=Math.max(t.max,f)}getMinMax(t,n){const i=this._cachedMeta,s=i._parsed,d=i._sorted&&t===i.iScale,f=s.length,o=this._getOtherScale(t),y=O_e(n,i,this.chart),b={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:C,max:P}=P_e(o);let A,D;function k(){D=s[A];const B=D[o.axis];return!La(D[t.axis])||C>B||P<B}for(A=0;A<f&&!(!k()&&(this.updateRangeFromParsed(b,t,D,y),d));++A);if(d){for(A=f-1;A>=0;--A)if(!k()){this.updateRangeFromParsed(b,t,D,y);break}}return b}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let s,d,f;for(s=0,d=n.length;s<d;++s)f=n[s][t.axis],La(f)&&i.push(f);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,s=n.vScale,d=this.getParsed(t);return{label:i?""+i.getLabelForValue(d[i.axis]):"",value:s?""+s.getLabelForValue(d[s.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=E_e(Bi(this.options.clip,C_e(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,s=i.data||[],d=n.chartArea,f=[],o=this._drawStart||0,y=this._drawCount||s.length-o,b=this.options.drawActiveElementsOnTop;let C;for(i.dataset&&i.dataset.draw(t,d,o,y),C=o;C<o+y;++C){const P=s[C];P.hidden||(P.active&&b?f.push(P):P.draw(t,d))}for(C=0;C<f.length;++C)f[C].draw(t,d)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const s=this.getDataset();let d;if(t>=0&&t<this._cachedMeta.data.length){const f=this._cachedMeta.data[t];d=f.$context||(f.$context=A_e(this.getContext(),t,f)),d.parsed=this.getParsed(t),d.raw=s.data[t],d.index=d.dataIndex=t}else d=this.$context||(this.$context=R_e(this.chart.getContext(),this.index)),d.dataset=s,d.index=d.datasetIndex=this.index;return d.active=!!n,d.mode=i,d}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const s=n==="active",d=this._cachedDataOpts,f=t+"-"+n,o=d[f],y=this.enableOptionSharing&&$x(i);if(o)return Q5(o,y);const b=this.chart.config,C=b.datasetElementScopeKeys(this._type,t),P=s?[`${t}Hover`,"hover",t,""]:[t,""],A=b.getOptionScopes(this.getDataset(),C),D=Object.keys(_a.elements[t]),k=()=>this.getContext(i,s,n),B=b.resolveNamedOptions(A,D,k,P);return B.$shared&&(B.$shared=y,d[f]=Object.freeze(Q5(B,y))),B}_resolveAnimations(t,n,i){const s=this.chart,d=this._cachedDataOpts,f=`animation-${n}`,o=d[f];if(o)return o;let y;if(s.options.animation!==!1){const C=this.chart.config,P=C.datasetAnimationScopeKeys(this._type,n),A=C.getOptionScopes(this.getDataset(),P);y=C.createResolver(A,this.getContext(t,i,n))}const b=new QG(s,y&&y.animations);return y&&y._cacheable&&(d[f]=Object.freeze(b)),b}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||yP(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),s=this._sharedOptions,d=this.getSharedOptions(i),f=this.includeOptions(n,d)||d!==s;return this.updateSharedOptions(d,n,i),{sharedOptions:d,includeOptions:f}}updateElement(t,n,i,s){yP(s)?Object.assign(t,i):this._resolveAnimations(n,s).update(t,i)}updateSharedOptions(t,n,i){t&&!yP(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,s){t.active=s;const d=this.getStyle(n,s);this._resolveAnimations(n,i,s).update(t,{options:!s&&this.getSharedOptions(d)||d})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[o,y,b]of this._syncList)this[o](y,b);this._syncList=[];const s=i.length,d=n.length,f=Math.min(d,s);f&&this.parse(0,f),d>s?this._insertElements(s,d-s,t):d<s&&this._removeElements(d,s-d)}_insertElements(t,n,i=!0){const s=this._cachedMeta,d=s.data,f=t+n;let o;const y=b=>{for(b.length+=n,o=b.length-1;o>=f;o--)b[o]=b[o-n]};for(y(d),o=t;o<f;++o)d[o]=new this.dataElementType;this._parsing&&y(s._parsed),this.parse(t,n),i&&this.updateElements(d,t,n,"reset")}updateElements(t,n,i,s){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,n);i._stacked&&v0(i,s)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,s]=t;this[n](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Er(Xc,"defaults",{}),Er(Xc,"datasetElementType",null),Er(Xc,"dataElementType",null);function D_e(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let s=0,d=n.length;s<d;s++)i=i.concat(n[s].controller.getAllParsedValues(e));e._cache.$bar=DG(i.sort((s,d)=>s-d))}return e._cache.$bar}function L_e(e){const t=e.iScale,n=D_e(t,e.type);let i=t._length,s,d,f,o;const y=()=>{f===32767||f===-32768||($x(o)&&(i=Math.min(i,Math.abs(f-o)||i)),o=f)};for(s=0,d=n.length;s<d;++s)f=t.getPixelForValue(n[s]),y();for(o=void 0,s=0,d=t.ticks.length;s<d;++s)f=t.getPixelForTick(s),y();return i}function z_e(e,t,n,i){const s=n.barThickness;let d,f;return ro(s)?(d=t.min*n.categoryPercentage,f=n.barPercentage):(d=s*i,f=1),{chunk:d/i,ratio:f,start:t.pixels[e]-d/2}}function k_e(e,t,n,i){const s=t.pixels,d=s[e];let f=e>0?s[e-1]:null,o=e<s.length-1?s[e+1]:null;const y=n.categoryPercentage;f===null&&(f=d-(o===null?t.end-t.start:o-d)),o===null&&(o=d+d-f);const b=d-(d-Math.min(f,o))/2*y;return{chunk:Math.abs(o-f)/2*y/i,ratio:n.barPercentage,start:b}}function F_e(e,t,n,i){const s=n.parse(e[0],i),d=n.parse(e[1],i),f=Math.min(s,d),o=Math.max(s,d);let y=f,b=o;Math.abs(f)>Math.abs(o)&&(y=o,b=f),t[n.axis]=b,t._custom={barStart:y,barEnd:b,start:s,end:d,min:f,max:o}}function tW(e,t,n,i){return ga(e)?F_e(e,t,n,i):t[n.axis]=n.parse(e,i),t}function e4(e,t,n,i){const s=e.iScale,d=e.vScale,f=s.getLabels(),o=s===d,y=[];let b,C,P,A;for(b=n,C=n+i;b<C;++b)A=t[b],P={},P[s.axis]=o||s.parse(f[b],b),y.push(tW(A,P,d,b));return y}function xP(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function N_e(e,t,n){return e!==0?zu(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function B_e(e){let t,n,i,s,d;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(s="end",d="start"):(s="start",d="end"),{start:n,end:i,reverse:t,top:s,bottom:d}}function $_e(e,t,n,i){let s=t.borderSkipped;const d={};if(!s){e.borderSkipped=d;return}if(s===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:f,end:o,reverse:y,top:b,bottom:C}=B_e(e);s==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?s=b:(n._bottom||0)===i?s=C:(d[t4(C,f,o,y)]=!0,s=b)),d[t4(s,f,o,y)]=!0,e.borderSkipped=d}function t4(e,t,n,i){return i?(e=j_e(e,t,n),e=n4(e,n,t)):e=n4(e,t,n),e}function j_e(e,t,n){return e===t?n:e===n?t:e}function n4(e,t,n){return e==="start"?t:e==="end"?n:e}function V_e(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class bS extends Xc{parsePrimitiveData(t,n,i,s){return e4(t,n,i,s)}parseArrayData(t,n,i,s){return e4(t,n,i,s)}parseObjectData(t,n,i,s){const{iScale:d,vScale:f}=t,{xAxisKey:o="x",yAxisKey:y="y"}=this._parsing,b=d.axis==="x"?o:y,C=f.axis==="x"?o:y,P=[];let A,D,k,B;for(A=i,D=i+s;A<D;++A)B=n[A],k={},k[d.axis]=d.parse(gf(B,b),A),P.push(tW(gf(B,C),k,f,A));return P}updateRangeFromParsed(t,n,i,s){super.updateRangeFromParsed(t,n,i,s);const d=i._custom;d&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,d.min),t.max=Math.max(t.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:s}=n,d=this.getParsed(t),f=d._custom,o=xP(f)?"["+f.start+", "+f.end+"]":""+s.getLabelForValue(d[s.axis]);return{label:""+i.getLabelForValue(d[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,s){const d=s==="reset",{index:f,_cachedMeta:{vScale:o}}=this,y=o.getBasePixel(),b=o.isHorizontal(),C=this._getRuler(),{sharedOptions:P,includeOptions:A}=this._getSharedOptions(n,s);for(let D=n;D<n+i;D++){const k=this.getParsed(D),B=d||ro(k[o.axis])?{base:y,head:y}:this._calculateBarValuePixels(D),N=this._calculateBarIndexPixels(D,C),j=(k._stacks||{})[o.axis],V={horizontal:b,base:B.base,enableBorderRadius:!j||xP(k._custom)||f===j._top||f===j._bottom,x:b?B.head:N.center,y:b?N.center:B.head,height:b?N.size:Math.abs(B.size),width:b?Math.abs(B.size):N.size};A&&(V.options=P||this.resolveDataElementOptions(D,t[D].active?"active":s));const K=V.options||t[D].options;$_e(V,K,j,f),V_e(V,K,C.ratio),this.updateElement(t[D],D,V,s)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(C=>C.controller.options.grouped),d=i.options.stacked,f=[],o=this._cachedMeta.controller.getParsed(n),y=o&&o[i.axis],b=C=>{const P=C._parsed.find(D=>D[i.axis]===y),A=P&&P[C.vScale.axis];if(ro(A)||isNaN(A))return!0};for(const C of s)if(!(n!==void 0&&b(C))&&((d===!1||f.indexOf(C.stack)===-1||d===void 0&&C.stack===void 0)&&f.push(C.stack),C.index===t))break;return f.length||f.push(void 0),f}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[Bi(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,i){const s=this._getStacks(t,i),d=n!==void 0?s.indexOf(n):-1;return d===-1?s.length-1:d}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,s=[];let d,f;for(d=0,f=n.data.length;d<f;++d)s.push(i.getPixelForValue(this.getParsed(d)[i.axis],d));const o=t.barThickness;return{min:o||L_e(n),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i,index:s},options:{base:d,minBarLength:f}}=this,o=d||0,y=this.getParsed(t),b=y._custom,C=xP(b);let P=y[n.axis],A=0,D=i?this.applyStack(n,y,i):P,k,B;D!==P&&(A=D-P,D=P),C&&(P=b.barStart,D=b.barEnd-b.barStart,P!==0&&zu(P)!==zu(b.barEnd)&&(A=0),A+=P);const N=!ro(d)&&!C?d:A;let j=n.getPixelForValue(N);if(this.chart.getDataVisibility(t)?k=n.getPixelForValue(A+D):k=j,B=k-j,Math.abs(B)<f){B=N_e(B,n,o)*f,P===o&&(j-=B/2);const V=n.getPixelForDecimal(0),K=n.getPixelForDecimal(1),Y=Math.min(V,K),Z=Math.max(V,K);j=Math.max(Math.min(j,Z),Y),k=j+B,i&&!C&&(y._stacks[n.axis]._visualValues[s]=n.getValueForPixel(k)-n.getValueForPixel(j))}if(j===n.getPixelForValue(o)){const V=zu(B)*n.getLineWidthForValue(o)/2;j+=V,B-=V}return{size:B,base:j,head:k,center:k+B/2}}_calculateBarIndexPixels(t,n){const i=n.scale,s=this.options,d=s.skipNull,f=Bi(s.maxBarThickness,1/0);let o,y;const b=this._getAxisCount();if(n.grouped){const C=d?this._getStackCount(t):n.stackCount,P=s.barThickness==="flex"?k_e(t,n,s,C*b):z_e(t,n,s,C*b),A=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,D=this._getAxis().indexOf(Bi(A,this.getFirstScaleIdForIndexAxis())),k=this._getStackIndex(this.index,this._cachedMeta.stack,d?t:void 0)+D;o=P.start+P.chunk*k+P.chunk/2,y=Math.min(f,P.chunk*P.ratio)}else o=i.getPixelForValue(this.getParsed(t)[i.axis],t),y=Math.min(f,n.min*n.ratio);return{base:o-y/2,head:o+y/2,center:o,size:y}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,s=i.length;let d=0;for(;d<s;++d)this.getParsed(d)[n.axis]!==null&&!i[d].hidden&&i[d].draw(this._ctx)}}Er(bS,"id","bar"),Er(bS,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Er(bS,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class wS extends Xc{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,s){const d=super.parsePrimitiveData(t,n,i,s);for(let f=0;f<d.length;f++)d[f]._custom=this.resolveDataElementOptions(f+i).radius;return d}parseArrayData(t,n,i,s){const d=super.parseArrayData(t,n,i,s);for(let f=0;f<d.length;f++){const o=n[i+f];d[f]._custom=Bi(o[2],this.resolveDataElementOptions(f+i).radius)}return d}parseObjectData(t,n,i,s){const d=super.parseObjectData(t,n,i,s);for(let f=0;f<d.length;f++){const o=n[i+f];d[f]._custom=Bi(o&&o.r&&+o.r,this.resolveDataElementOptions(f+i).radius)}return d}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:d}=n,f=this.getParsed(t),o=s.getLabelForValue(f.x),y=d.getLabelForValue(f.y),b=f._custom;return{label:i[t]||"",value:"("+o+", "+y+(b?", "+b:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,s){const d=s==="reset",{iScale:f,vScale:o}=this._cachedMeta,{sharedOptions:y,includeOptions:b}=this._getSharedOptions(n,s),C=f.axis,P=o.axis;for(let A=n;A<n+i;A++){const D=t[A],k=!d&&this.getParsed(A),B={},N=B[C]=d?f.getPixelForDecimal(.5):f.getPixelForValue(k[C]),j=B[P]=d?o.getBasePixel():o.getPixelForValue(k[P]);B.skip=isNaN(N)||isNaN(j),b&&(B.options=y||this.resolveDataElementOptions(A,D.active?"active":s),d&&(B.options.radius=0)),this.updateElement(D,A,B,s)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,n);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const d=s.radius;return n!=="active"&&(s.radius=0),s.radius+=Bi(i&&i._custom,d),s}}Er(wS,"id","bubble"),Er(wS,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Er(wS,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function U_e(e,t,n){let i=1,s=1,d=0,f=0;if(t<ha){const o=e,y=o+t,b=Math.cos(o),C=Math.sin(o),P=Math.cos(y),A=Math.sin(y),D=(K,Y,Z)=>jx(K,o,y,!0)?1:Math.max(Y,Y*n,Z,Z*n),k=(K,Y,Z)=>jx(K,o,y,!0)?-1:Math.min(Y,Y*n,Z,Z*n),B=D(0,b,P),N=D($a,C,A),j=k(Po,b,P),V=k(Po+$a,C,A);i=(B-j)/2,s=(N-V)/2,d=-(B+j)/2,f=-(N+V)/2}return{ratioX:i,ratioY:s,offsetX:d,offsetY:f}}class zp extends Xc{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let d=y=>+i[y];if(uo(i[t])){const{key:y="value"}=this._parsing;d=b=>+gf(i[b],y)}let f,o;for(f=t,o=t+n;f<o;++f)s._parsed[f]=d(f)}}_getRotation(){return Hc(this.options.rotation-90)}_getCircumference(){return Hc(this.options.circumference)}_getRotationExtents(){let t=ha,n=-ha;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const s=this.chart.getDatasetMeta(i).controller,d=s._getRotation(),f=s._getCircumference();t=Math.min(t,d),n=Math.max(n,d+f)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,s=this._cachedMeta,d=s.data,f=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-f)/2,0),y=Math.min(tve(this.options.cutout,o),1),b=this._getRingWeight(this.index),{circumference:C,rotation:P}=this._getRotationExtents(),{ratioX:A,ratioY:D,offsetX:k,offsetY:B}=U_e(P,C,y),N=(i.width-f)/A,j=(i.height-f)/D,V=Math.max(Math.min(N,j)/2,0),K=PG(this.options.radius,V),Y=Math.max(K*y,0),Z=(K-Y)/this._getVisibleDatasetWeightTotal();this.offsetX=k*K,this.offsetY=B*K,s.total=this.calculateTotal(),this.outerRadius=K-Z*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Z*b,0),this.updateElements(d,0,d.length,t)}_circumference(t,n){const i=this.options,s=this._cachedMeta,d=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*d/ha)}updateElements(t,n,i,s){const d=s==="reset",f=this.chart,o=f.chartArea,b=f.options.animation,C=(o.left+o.right)/2,P=(o.top+o.bottom)/2,A=d&&b.animateScale,D=A?0:this.innerRadius,k=A?0:this.outerRadius,{sharedOptions:B,includeOptions:N}=this._getSharedOptions(n,s);let j=this._getRotation(),V;for(V=0;V<n;++V)j+=this._circumference(V,d);for(V=n;V<n+i;++V){const K=this._circumference(V,d),Y=t[V],Z={x:C+this.offsetX,y:P+this.offsetY,startAngle:j,endAngle:j+K,circumference:K,outerRadius:k,innerRadius:D};N&&(Z.options=B||this.resolveDataElementOptions(V,Y.active?"active":s)),j+=K,this.updateElement(Y,V,Z,s)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,s;for(s=0;s<n.length;s++){const d=t._parsed[s];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(s)&&!n[s].hidden&&(i+=Math.abs(d))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?ha*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,s=i.data.labels||[],d=mb(n._parsed[t],i.options.locale);return{label:s[t]||"",value:d}}getMaxBorderWidth(t){let n=0;const i=this.chart;let s,d,f,o,y;if(!t){for(s=0,d=i.data.datasets.length;s<d;++s)if(i.isDatasetVisible(s)){f=i.getDatasetMeta(s),t=f.data,o=f.controller;break}}if(!t)return 0;for(s=0,d=t.length;s<d;++s)y=o.resolveDataElementOptions(s),y.borderAlign!=="inner"&&(n=Math.max(n,y.borderWidth||0,y.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,s=t.length;i<s;++i){const d=this.resolveDataElementOptions(i);n=Math.max(n,d.offset||0,d.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(Bi(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Er(zp,"id","doughnut"),Er(zp,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Er(zp,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Er(zp,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data,{labels:{pointStyle:i,textAlign:s,color:d,useBorderRadius:f,borderRadius:o}}=t.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((y,b)=>{const P=t.getDatasetMeta(0).controller.getStyle(b);return{text:y,fillStyle:P.backgroundColor,fontColor:d,hidden:!t.getDataVisibility(b),lineDash:P.borderDash,lineDashOffset:P.borderDashOffset,lineJoin:P.borderJoinStyle,lineWidth:P.borderWidth,strokeStyle:P.borderColor,textAlign:s,pointStyle:i,borderRadius:f&&(o||P.borderRadius),index:b}}):[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}}});class SS extends Xc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:s=[],_dataset:d}=n,f=this.chart._animationsDisabled;let{start:o,count:y}=kG(n,s,f);this._drawStart=o,this._drawCount=y,FG(n)&&(o=0,y=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!d._decimated,i.points=s;const b=this.resolveDatasetElementOptions(t);this.options.showLine||(b.borderWidth=0),b.segment=this.options.segment,this.updateElement(i,void 0,{animated:!f,options:b},t),this.updateElements(s,o,y,t)}updateElements(t,n,i,s){const d=s==="reset",{iScale:f,vScale:o,_stacked:y,_dataset:b}=this._cachedMeta,{sharedOptions:C,includeOptions:P}=this._getSharedOptions(n,s),A=f.axis,D=o.axis,{spanGaps:k,segment:B}=this.options,N=Nv(k)?k:Number.POSITIVE_INFINITY,j=this.chart._animationsDisabled||d||s==="none",V=n+i,K=t.length;let Y=n>0&&this.getParsed(n-1);for(let Z=0;Z<K;++Z){const te=t[Z],ne=j?te:{};if(Z<n||Z>=V){ne.skip=!0;continue}const se=this.getParsed(Z),ee=ro(se[D]),de=ne[A]=f.getPixelForValue(se[A],Z),fe=ne[D]=d||ee?o.getBasePixel():o.getPixelForValue(y?this.applyStack(o,se,y):se[D],Z);ne.skip=isNaN(de)||isNaN(fe)||ee,ne.stop=Z>0&&Math.abs(se[A]-Y[A])>N,B&&(ne.parsed=se,ne.raw=b.data[Z]),P&&(ne.options=C||this.resolveDataElementOptions(Z,te.active?"active":s)),j||this.updateElement(te,Z,ne,s),Y=se}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const d=s[0].size(this.resolveDataElementOptions(0)),f=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,d,f)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Er(SS,"id","line"),Er(SS,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Er(SS,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Q0 extends Xc{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,s=i.data.labels||[],d=mb(n._parsed[t].r,i.options.locale);return{label:s[t]||"",value:d}}parseObjectData(t,n,i,s){return GG.bind(this)(t,n,i,s)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const d=this.getParsed(s).r;!isNaN(d)&&this.chart.getDataVisibility(s)&&(d<n.min&&(n.min=d),d>n.max&&(n.max=d))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,s=Math.min(n.right-n.left,n.bottom-n.top),d=Math.max(s/2,0),f=Math.max(i.cutoutPercentage?d/100*i.cutoutPercentage:1,0),o=(d-f)/t.getVisibleDatasetCount();this.outerRadius=d-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,n,i,s){const d=s==="reset",f=this.chart,y=f.options.animation,b=this._cachedMeta.rScale,C=b.xCenter,P=b.yCenter,A=b.getIndexAngle(0)-.5*Po;let D=A,k;const B=360/this.countVisibleElements();for(k=0;k<n;++k)D+=this._computeAngle(k,s,B);for(k=n;k<n+i;k++){const N=t[k];let j=D,V=D+this._computeAngle(k,s,B),K=f.getDataVisibility(k)?b.getDistanceFromCenterForValue(this.getParsed(k).r):0;D=V,d&&(y.animateScale&&(K=0),y.animateRotate&&(j=V=A));const Y={x:C,y:P,innerRadius:0,outerRadius:K,startAngle:j,endAngle:V,options:this.resolveDataElementOptions(k,N.active?"active":s)};this.updateElement(N,k,Y,s)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?Hc(this.resolveDataElementOptions(t,n).angle||i):0}}Er(Q0,"id","polarArea"),Er(Q0,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Er(Q0,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return n.labels.map((d,f)=>{const y=t.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:y.backgroundColor,strokeStyle:y.borderColor,fontColor:s,lineWidth:y.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(f),index:f}})}return[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class tA extends zp{}Er(tA,"id","pie"),Er(tA,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class CS extends Xc{getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,s){return GG.bind(this)(t,n,i,s)}update(t){const n=this._cachedMeta,i=n.dataset,s=n.data||[],d=n.iScale.getLabels();if(i.points=s,t!=="resize"){const f=this.resolveDatasetElementOptions(t);this.options.showLine||(f.borderWidth=0);const o={_loop:!0,_fullLoop:d.length===s.length,options:f};this.updateElement(i,void 0,o,t)}this.updateElements(s,0,s.length,t)}updateElements(t,n,i,s){const d=this._cachedMeta.rScale,f=s==="reset";for(let o=n;o<n+i;o++){const y=t[o],b=this.resolveDataElementOptions(o,y.active?"active":s),C=d.getPointPositionForValue(o,this.getParsed(o).r),P=f?d.xCenter:C.x,A=f?d.yCenter:C.y,D={x:P,y:A,angle:C.angle,skip:isNaN(P)||isNaN(A),options:b};this.updateElement(y,o,D,s)}}}Er(CS,"id","radar"),Er(CS,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Er(CS,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class ES extends Xc{getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:d}=n,f=this.getParsed(t),o=s.getLabelForValue(f.x),y=d.getLabelForValue(f.y);return{label:i[t]||"",value:"("+o+", "+y+")"}}update(t){const n=this._cachedMeta,{data:i=[]}=n,s=this.chart._animationsDisabled;let{start:d,count:f}=kG(n,i,s);if(this._drawStart=d,this._drawCount=f,FG(n)&&(d=0,f=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:y}=n;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!y._decimated,o.points=i;const b=this.resolveDatasetElementOptions(t);b.segment=this.options.segment,this.updateElement(o,void 0,{animated:!s,options:b},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(i,d,f,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,i,s){const d=s==="reset",{iScale:f,vScale:o,_stacked:y,_dataset:b}=this._cachedMeta,C=this.resolveDataElementOptions(n,s),P=this.getSharedOptions(C),A=this.includeOptions(s,P),D=f.axis,k=o.axis,{spanGaps:B,segment:N}=this.options,j=Nv(B)?B:Number.POSITIVE_INFINITY,V=this.chart._animationsDisabled||d||s==="none";let K=n>0&&this.getParsed(n-1);for(let Y=n;Y<n+i;++Y){const Z=t[Y],te=this.getParsed(Y),ne=V?Z:{},se=ro(te[k]),ee=ne[D]=f.getPixelForValue(te[D],Y),de=ne[k]=d||se?o.getBasePixel():o.getPixelForValue(y?this.applyStack(o,te,y):te[k],Y);ne.skip=isNaN(ee)||isNaN(de)||se,ne.stop=Y>0&&Math.abs(te[D]-K[D])>j,N&&(ne.parsed=te,ne.raw=b.data[Y]),A&&(ne.options=P||this.resolveDataElementOptions(Y,Z.active?"active":s)),V||this.updateElement(Z,Y,ne,s),K=te}this.updateSharedOptions(P,s,C)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let o=0;for(let y=n.length-1;y>=0;--y)o=Math.max(o,n[y].size(this.resolveDataElementOptions(y))/2);return o>0&&o}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!n.length)return s;const d=n[0].size(this.resolveDataElementOptions(0)),f=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(s,d,f)/2}}Er(ES,"id","scatter"),Er(ES,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Er(ES,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var H_e=Object.freeze({__proto__:null,BarController:bS,BubbleController:wS,DoughnutController:zp,LineController:SS,PieController:tA,PolarAreaController:Q0,RadarController:CS,ScatterController:ES});function wp(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class VD{constructor(t){Er(this,"options");this.options=t||{}}static override(t){Object.assign(VD.prototype,t)}init(){}formats(){return wp()}parse(){return wp()}format(){return wp()}add(){return wp()}diff(){return wp()}startOf(){return wp()}endOf(){return wp()}}var G_e={_date:VD};function W_e(e,t,n,i){const{controller:s,data:d,_sorted:f}=e,o=s._cachedMeta.iScale,y=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&t!=="r"&&f&&d.length){const b=o._reversePixels?pve:Md;if(i){if(s._sharedOptions){const C=d[0],P=typeof C.getRange=="function"&&C.getRange(t);if(P){const A=b(d,t,n-P),D=b(d,t,n+P);return{lo:A.lo,hi:D.hi}}}}else{const C=b(d,t,n);if(y){const{vScale:P}=s._cachedMeta,{_parsed:A}=e,D=A.slice(0,C.lo+1).reverse().findIndex(B=>!ro(B[P.axis]));C.lo-=Math.max(0,D);const k=A.slice(C.hi).findIndex(B=>!ro(B[P.axis]));C.hi+=Math.max(0,k)}return C}}return{lo:0,hi:d.length-1}}function qE(e,t,n,i,s){const d=e.getSortedVisibleDatasetMetas(),f=n[t];for(let o=0,y=d.length;o<y;++o){const{index:b,data:C}=d[o],{lo:P,hi:A}=W_e(d[o],t,f,s);for(let D=P;D<=A;++D){const k=C[D];k.skip||i(k,b,D)}}}function q_e(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,s){const d=t?Math.abs(i.x-s.x):0,f=n?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(f,2))}}function bP(e,t,n,i,s){const d=[];return!s&&!e.isPointInArea(t)||qE(e,n,t,function(o,y,b){!s&&!Rd(o,e.chartArea,0)||o.inRange(t.x,t.y,i)&&d.push({element:o,datasetIndex:y,index:b})},!0),d}function K_e(e,t,n,i){let s=[];function d(f,o,y){const{startAngle:b,endAngle:C}=f.getProps(["startAngle","endAngle"],i),{angle:P}=AG(f,{x:t.x,y:t.y});jx(P,b,C)&&s.push({element:f,datasetIndex:o,index:y})}return qE(e,n,t,d),s}function X_e(e,t,n,i,s,d){let f=[];const o=q_e(n);let y=Number.POSITIVE_INFINITY;function b(C,P,A){const D=C.inRange(t.x,t.y,s);if(i&&!D)return;const k=C.getCenterPoint(s);if(!(!!d||e.isPointInArea(k))&&!D)return;const N=o(t,k);N<y?(f=[{element:C,datasetIndex:P,index:A}],y=N):N===y&&f.push({element:C,datasetIndex:P,index:A})}return qE(e,n,t,b),f}function wP(e,t,n,i,s,d){return!d&&!e.isPointInArea(t)?[]:n==="r"&&!i?K_e(e,t,n,s):X_e(e,t,n,i,s,d)}function r4(e,t,n,i,s){const d=[],f=n==="x"?"inXRange":"inYRange";let o=!1;return qE(e,n,t,(y,b,C)=>{y[f]&&y[f](t[n],s)&&(d.push({element:y,datasetIndex:b,index:C}),o=o||y.inRange(t.x,t.y,s))}),i&&!o?[]:d}var Z_e={modes:{index(e,t,n,i){const s=Ip(t,e),d=n.axis||"x",f=n.includeInvisible||!1,o=n.intersect?bP(e,s,d,i,f):wP(e,s,d,!1,i,f),y=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(b=>{const C=o[0].index,P=b.data[C];P&&!P.skip&&y.push({element:P,datasetIndex:b.index,index:C})}),y):[]},dataset(e,t,n,i){const s=Ip(t,e),d=n.axis||"xy",f=n.includeInvisible||!1;let o=n.intersect?bP(e,s,d,i,f):wP(e,s,d,!1,i,f);if(o.length>0){const y=o[0].datasetIndex,b=e.getDatasetMeta(y).data;o=[];for(let C=0;C<b.length;++C)o.push({element:b[C],datasetIndex:y,index:C})}return o},point(e,t,n,i){const s=Ip(t,e),d=n.axis||"xy",f=n.includeInvisible||!1;return bP(e,s,d,i,f)},nearest(e,t,n,i){const s=Ip(t,e),d=n.axis||"xy",f=n.includeInvisible||!1;return wP(e,s,d,n.intersect,i,f)},x(e,t,n,i){const s=Ip(t,e);return r4(e,s,"x",n.intersect,i)},y(e,t,n,i){const s=Ip(t,e);return r4(e,s,"y",n.intersect,i)}}};const nW=["left","top","right","bottom"];function _0(e,t){return e.filter(n=>n.pos===t)}function i4(e,t){return e.filter(n=>nW.indexOf(n.pos)===-1&&n.box.axis===t)}function y0(e,t){return e.sort((n,i)=>{const s=t?i:n,d=t?n:i;return s.weight===d.weight?s.index-d.index:s.weight-d.weight})}function Y_e(e){const t=[];let n,i,s,d,f,o;for(n=0,i=(e||[]).length;n<i;++n)s=e[n],{position:d,options:{stack:f,stackWeight:o=1}}=s,t.push({index:n,box:s,pos:d,horizontal:s.isHorizontal(),weight:s.weight,stack:f&&d+f,stackWeight:o});return t}function J_e(e){const t={};for(const n of e){const{stack:i,pos:s,stackWeight:d}=n;if(!i||!nW.includes(s))continue;const f=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});f.count++,f.weight+=d}return t}function Q_e(e,t){const n=J_e(e),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let d,f,o;for(d=0,f=e.length;d<f;++d){o=e[d];const{fullSize:y}=o.box,b=n[o.stack],C=b&&o.stackWeight/b.weight;o.horizontal?(o.width=C?C*i:y&&t.availableWidth,o.height=s):(o.width=i,o.height=C?C*s:y&&t.availableHeight)}return n}function eye(e){const t=Y_e(e),n=y0(t.filter(b=>b.box.fullSize),!0),i=y0(_0(t,"left"),!0),s=y0(_0(t,"right")),d=y0(_0(t,"top"),!0),f=y0(_0(t,"bottom")),o=i4(t,"x"),y=i4(t,"y");return{fullSize:n,leftAndTop:i.concat(d),rightAndBottom:s.concat(y).concat(f).concat(o),chartArea:_0(t,"chartArea"),vertical:i.concat(s).concat(y),horizontal:d.concat(f).concat(o)}}function o4(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function rW(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function tye(e,t,n,i){const{pos:s,box:d}=n,f=e.maxPadding;if(!uo(s)){n.size&&(e[s]-=n.size);const P=i[n.stack]||{size:0,count:1};P.size=Math.max(P.size,n.horizontal?d.height:d.width),n.size=P.size/P.count,e[s]+=n.size}d.getPadding&&rW(f,d.getPadding());const o=Math.max(0,t.outerWidth-o4(f,e,"left","right")),y=Math.max(0,t.outerHeight-o4(f,e,"top","bottom")),b=o!==e.w,C=y!==e.h;return e.w=o,e.h=y,n.horizontal?{same:b,other:C}:{same:C,other:b}}function nye(e){const t=e.maxPadding;function n(i){const s=Math.max(t[i]-e[i],0);return e[i]+=s,s}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function rye(e,t){const n=t.maxPadding;function i(s){const d={left:0,top:0,right:0,bottom:0};return s.forEach(f=>{d[f]=Math.max(t[f],n[f])}),d}return i(e?["left","right"]:["top","bottom"])}function A0(e,t,n,i){const s=[];let d,f,o,y,b,C;for(d=0,f=e.length,b=0;d<f;++d){o=e[d],y=o.box,y.update(o.width||t.w,o.height||t.h,rye(o.horizontal,t));const{same:P,other:A}=tye(t,n,o,i);b|=P&&s.length,C=C||A,y.fullSize||s.push(o)}return b&&A0(s,t,n,i)||C}function Vw(e,t,n,i,s){e.top=n,e.left=t,e.right=t+i,e.bottom=n+s,e.width=i,e.height=s}function a4(e,t,n,i){const s=n.padding;let{x:d,y:f}=t;for(const o of e){const y=o.box,b=i[o.stack]||{placed:0,weight:1},C=o.stackWeight/b.weight||1;if(o.horizontal){const P=t.w*C,A=b.size||y.height;$x(b.start)&&(f=b.start),y.fullSize?Vw(y,s.left,f,n.outerWidth-s.right-s.left,A):Vw(y,t.left+b.placed,f,P,A),b.start=f,b.placed+=P,f=y.bottom}else{const P=t.h*C,A=b.size||y.width;$x(b.start)&&(d=b.start),y.fullSize?Vw(y,d,s.top,A,n.outerHeight-s.bottom-s.top):Vw(y,d,t.top+b.placed,A,P),b.start=d,b.placed+=P,d=y.right}}t.x=d,t.y=f}var ks={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const s=js(e.options.layout.padding),d=Math.max(t-s.width,0),f=Math.max(n-s.height,0),o=eye(e.boxes),y=o.vertical,b=o.horizontal;$o(e.boxes,B=>{typeof B.beforeLayout=="function"&&B.beforeLayout()});const C=y.reduce((B,N)=>N.box.options&&N.box.options.display===!1?B:B+1,0)||1,P=Object.freeze({outerWidth:t,outerHeight:n,padding:s,availableWidth:d,availableHeight:f,vBoxMaxWidth:d/2/C,hBoxMaxHeight:f/2}),A=Object.assign({},s);rW(A,js(i));const D=Object.assign({maxPadding:A,w:d,h:f,x:s.left,y:s.top},s),k=Q_e(y.concat(b),P);A0(o.fullSize,D,P,k),A0(y,D,P,k),A0(b,D,P,k)&&A0(y,D,P,k),nye(D),a4(o.leftAndTop,D,P,k),D.x+=D.w,D.y+=D.h,a4(o.rightAndBottom,D,P,k),e.chartArea={left:D.left,top:D.top,right:D.left+D.w,bottom:D.top+D.h,height:D.h,width:D.w},$o(o.chartArea,B=>{const N=B.box;Object.assign(N,e.chartArea),N.update(D.w,D.h,{left:0,top:0,right:0,bottom:0})})}};class iW{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,s){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,s?Math.floor(n/s):i)}}isAttached(t){return!0}updateConfig(t){}}class iye extends iW{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const TS="$chartjs",oye={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},s4=e=>e===null||e==="";function aye(e,t){const n=e.style,i=e.getAttribute("height"),s=e.getAttribute("width");if(e[TS]={initial:{height:i,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",s4(s)){const d=H5(e,"width");d!==void 0&&(e.width=d)}if(s4(i))if(e.style.height==="")e.height=e.width/(t||2);else{const d=H5(e,"height");d!==void 0&&(e.height=d)}return e}const oW=s_e?{passive:!0}:!1;function sye(e,t,n){e&&e.addEventListener(t,n,oW)}function lye(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,oW)}function cye(e,t){const n=oye[e.type]||e.type,{x:i,y:s}=Ip(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:s!==void 0?s:null}}function EC(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function uye(e,t,n){const i=e.canvas,s=new MutationObserver(d=>{let f=!1;for(const o of d)f=f||EC(o.addedNodes,i),f=f&&!EC(o.removedNodes,i);f&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}function dye(e,t,n){const i=e.canvas,s=new MutationObserver(d=>{let f=!1;for(const o of d)f=f||EC(o.removedNodes,i),f=f&&!EC(o.addedNodes,i);f&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}const Ux=new Map;let l4=0;function aW(){const e=window.devicePixelRatio;e!==l4&&(l4=e,Ux.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function hye(e,t){Ux.size||window.addEventListener("resize",aW),Ux.set(e,t)}function fye(e){Ux.delete(e),Ux.size||window.removeEventListener("resize",aW)}function pye(e,t,n){const i=e.canvas,s=i&&jD(i);if(!s)return;const d=zG((o,y)=>{const b=s.clientWidth;n(o,y),b<s.clientWidth&&n()},window),f=new ResizeObserver(o=>{const y=o[0],b=y.contentRect.width,C=y.contentRect.height;b===0&&C===0||d(b,C)});return f.observe(s),hye(e,d),f}function SP(e,t,n){n&&n.disconnect(),t==="resize"&&fye(e)}function mye(e,t,n){const i=e.canvas,s=zG(d=>{e.ctx!==null&&n(cye(d,e))},e);return sye(i,t,s),s}class gye extends iW{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(aye(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[TS])return!1;const i=n[TS].initial;["height","width"].forEach(d=>{const f=i[d];ro(f)?n.removeAttribute(d):n.setAttribute(d,f)});const s=i.style||{};return Object.keys(s).forEach(d=>{n.style[d]=s[d]}),n.width=n.width,delete n[TS],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const s=t.$proxies||(t.$proxies={}),f={attach:uye,detach:dye,resize:pye}[n]||mye;s[n]=f(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),s=i[n];if(!s)return;({attach:SP,detach:SP,resize:SP}[n]||lye)(t,n,s),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,s){return a_e(t,n,i,s)}isAttached(t){const n=t&&jD(t);return!!(n&&n.isConnected)}}function vye(e){return!$D()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?iye:gye}var Xw;let $d=(Xw=class{constructor(){Er(this,"x");Er(this,"y");Er(this,"active",!1);Er(this,"options");Er(this,"$animations")}tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return Nv(this.x)&&Nv(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const s={};return t.forEach(d=>{s[d]=i[d]&&i[d].active()?i[d]._to:this[d]}),s}},Er(Xw,"defaults",{}),Er(Xw,"defaultRoutes"),Xw);function _ye(e,t){const n=e.options.ticks,i=yye(e),s=Math.min(n.maxTicksLimit||i,i),d=n.major.enabled?bye(t):[],f=d.length,o=d[0],y=d[f-1],b=[];if(f>s)return wye(t,b,d,f/s),b;const C=xye(d,t,s);if(f>0){let P,A;const D=f>1?Math.round((y-o)/(f-1)):null;for(Uw(t,b,C,ro(D)?0:o-D,o),P=0,A=f-1;P<A;P++)Uw(t,b,C,d[P],d[P+1]);return Uw(t,b,C,y,ro(D)?t.length:y+D),b}return Uw(t,b,C),b}function yye(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),s=e._maxLength/n;return Math.floor(Math.min(i,s))}function xye(e,t,n){const i=Sye(e),s=t.length/n;if(!i)return Math.max(s,1);const d=cve(i);for(let f=0,o=d.length-1;f<o;f++){const y=d[f];if(y>s)return y}return Math.max(s,1)}function bye(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function wye(e,t,n,i){let s=0,d=n[0],f;for(i=Math.ceil(i),f=0;f<e.length;f++)f===d&&(t.push(e[f]),s++,d=n[s*i])}function Uw(e,t,n,i,s){const d=Bi(i,0),f=Math.min(Bi(s,e.length),e.length);let o=0,y,b,C;for(n=Math.ceil(n),s&&(y=s-i,n=y/Math.floor(y/n)),C=d;C<0;)o++,C=Math.round(d+o*n);for(b=Math.max(d,0);b<f;b++)b===C&&(t.push(e[b]),o++,C=Math.round(d+o*n))}function Sye(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const Cye=e=>e==="left"?"right":e==="right"?"left":e,c4=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,u4=(e,t)=>Math.min(t||e,e);function d4(e,t){const n=[],i=e.length/t,s=e.length;let d=0;for(;d<s;d+=i)n.push(e[Math.floor(d)]);return n}function Eye(e,t,n){const i=e.ticks.length,s=Math.min(t,i-1),d=e._startPixel,f=e._endPixel,o=1e-6;let y=e.getPixelForTick(s),b;if(!(n&&(i===1?b=Math.max(y-d,f-y):t===0?b=(e.getPixelForTick(1)-y)/2:b=(y-e.getPixelForTick(s-1))/2,y+=s<t?b:-b,y<d-o||y>f+o)))return y}function Tye(e,t){$o(e,n=>{const i=n.gc,s=i.length/2;let d;if(s>t){for(d=0;d<s;++d)delete n.data[i[d]];i.splice(0,s)}})}function x0(e){return e.drawTicks?e.tickLength:0}function h4(e,t){if(!e.display)return 0;const n=rs(e.font,t),i=js(e.padding);return(ga(e.text)?e.text.length:1)*n.lineHeight+i.height}function Iye(e,t){return Cf(e,{scale:t,type:"scale"})}function Pye(e,t,n){return Cf(e,{tick:n,index:t,type:"tick"})}function Mye(e,t,n){let i=LD(e);return(n&&t!=="right"||!n&&t==="right")&&(i=Cye(i)),i}function Rye(e,t,n,i){const{top:s,left:d,bottom:f,right:o,chart:y}=e,{chartArea:b,scales:C}=y;let P=0,A,D,k;const B=f-s,N=o-d;if(e.isHorizontal()){if(D=As(i,d,o),uo(n)){const j=Object.keys(n)[0],V=n[j];k=C[j].getPixelForValue(V)+B-t}else n==="center"?k=(b.bottom+b.top)/2+B-t:k=c4(e,n,t);A=o-d}else{if(uo(n)){const j=Object.keys(n)[0],V=n[j];D=C[j].getPixelForValue(V)-N+t}else n==="center"?D=(b.left+b.right)/2-N+t:D=c4(e,n,t);k=As(i,f,s),P=n==="left"?-$a:$a}return{titleX:D,titleY:k,maxWidth:A,rotation:P}}class lm extends $d{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:s}=this;return t=$l(t,Number.POSITIVE_INFINITY),n=$l(n,Number.NEGATIVE_INFINITY),i=$l(i,Number.POSITIVE_INFINITY),s=$l(s,Number.NEGATIVE_INFINITY),{min:$l(t,i),max:$l(n,s),minDefined:La(t),maxDefined:La(n)}}getMinMax(t){let{min:n,max:i,minDefined:s,maxDefined:d}=this.getUserBounds(),f;if(s&&d)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let y=0,b=o.length;y<b;++y)f=o[y].controller.getMinMax(this,t),s||(n=Math.min(n,f.min)),d||(i=Math.max(i,f.max));return n=d&&n>i?i:n,i=s&&n>i?n:i,{min:$l(n,$l(i,n)),max:$l(i,$l(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ra(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:s,grace:d,ticks:f}=this.options,o=f.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Nve(this,d,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const y=o<this.ticks.length;this._convertTicksToLabels(y?d4(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),f.display&&(f.autoSkip||f.source==="auto")&&(this.ticks=_ye(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),y&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ra(this.options.afterUpdate,[this])}beforeSetDimensions(){ra(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ra(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ra(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ra(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,s,d;for(i=0,s=t.length;i<s;i++)d=t[i],d.label=ra(n.callback,[d.value,i,t],this)}afterTickToLabelConversion(){ra(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ra(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=u4(this.ticks.length,t.ticks.maxTicksLimit),s=n.minRotation||0,d=n.maxRotation;let f=s,o,y,b;if(!this._isVisible()||!n.display||s>=d||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const C=this._getLabelSizes(),P=C.widest.width,A=C.highest.height,D=hs(this.chart.width-P,0,this.maxWidth);o=t.offset?this.maxWidth/i:D/(i-1),P+6>o&&(o=D/(i-(t.offset?.5:1)),y=this.maxHeight-x0(t.grid)-n.padding-h4(t.title,this.chart.options.font),b=Math.sqrt(P*P+A*A),f=OD(Math.min(Math.asin(hs((C.highest.height+6)/o,-1,1)),Math.asin(hs(y/b,-1,1))-Math.asin(hs(A/b,-1,1)))),f=Math.max(s,Math.min(d,f))),this.labelRotation=f}afterCalculateLabelRotation(){ra(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ra(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:s,grid:d}}=this,f=this._isVisible(),o=this.isHorizontal();if(f){const y=h4(s,n.options.font);if(o?(t.width=this.maxWidth,t.height=x0(d)+y):(t.height=this.maxHeight,t.width=x0(d)+y),i.display&&this.ticks.length){const{first:b,last:C,widest:P,highest:A}=this._getLabelSizes(),D=i.padding*2,k=Hc(this.labelRotation),B=Math.cos(k),N=Math.sin(k);if(o){const j=i.mirror?0:N*P.width+B*A.height;t.height=Math.min(this.maxHeight,t.height+j+D)}else{const j=i.mirror?0:B*P.width+N*A.height;t.width=Math.min(this.maxWidth,t.width+j+D)}this._calculatePadding(b,C,N,B)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,s){const{ticks:{align:d,padding:f},position:o}=this.options,y=this.labelRotation!==0,b=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const C=this.getPixelForTick(0)-this.left,P=this.right-this.getPixelForTick(this.ticks.length-1);let A=0,D=0;y?b?(A=s*t.width,D=i*n.height):(A=i*t.height,D=s*n.width):d==="start"?D=n.width:d==="end"?A=t.width:d!=="inner"&&(A=t.width/2,D=n.width/2),this.paddingLeft=Math.max((A-C+f)*this.width/(this.width-C),0),this.paddingRight=Math.max((D-P+f)*this.width/(this.width-P),0)}else{let C=n.height/2,P=t.height/2;d==="start"?(C=0,P=t.height):d==="end"&&(C=n.height,P=0),this.paddingTop=C+f,this.paddingBottom=P+f}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ra(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)ro(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=d4(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,i){const{ctx:s,_longestTextCache:d}=this,f=[],o=[],y=Math.floor(n/u4(n,i));let b=0,C=0,P,A,D,k,B,N,j,V,K,Y,Z;for(P=0;P<n;P+=y){if(k=t[P].label,B=this._resolveTickFontOptions(P),s.font=N=B.string,j=d[N]=d[N]||{data:{},gc:[]},V=B.lineHeight,K=Y=0,!ro(k)&&!ga(k))K=SC(s,j.data,j.gc,K,k),Y=V;else if(ga(k))for(A=0,D=k.length;A<D;++A)Z=k[A],!ro(Z)&&!ga(Z)&&(K=SC(s,j.data,j.gc,K,Z),Y+=V);f.push(K),o.push(Y),b=Math.max(K,b),C=Math.max(Y,C)}Tye(d,n);const te=f.indexOf(b),ne=o.indexOf(C),se=ee=>({width:f[ee]||0,height:o[ee]||0});return{first:se(0),last:se(n-1),widest:se(te),highest:se(ne),widths:f,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return fve(this._alignToPixels?bp(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=Pye(this.getContext(),t,i))}return this.$context||(this.$context=Iye(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Hc(this.labelRotation),i=Math.abs(Math.cos(n)),s=Math.abs(Math.sin(n)),d=this._getLabelSizes(),f=t.autoSkipPadding||0,o=d?d.widest.width+f:0,y=d?d.highest.height+f:0;return this.isHorizontal()?y*i>o*s?o/i:y/s:y*s<o*i?y/i:o/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,s=this.options,{grid:d,position:f,border:o}=s,y=d.offset,b=this.isHorizontal(),P=this.ticks.length+(y?1:0),A=x0(d),D=[],k=o.setContext(this.getContext()),B=k.display?k.width:0,N=B/2,j=function(xe){return bp(i,xe,B)};let V,K,Y,Z,te,ne,se,ee,de,fe,ye,ge;if(f==="top")V=j(this.bottom),ne=this.bottom-A,ee=V-N,fe=j(t.top)+N,ge=t.bottom;else if(f==="bottom")V=j(this.top),fe=t.top,ge=j(t.bottom)-N,ne=V+N,ee=this.top+A;else if(f==="left")V=j(this.right),te=this.right-A,se=V-N,de=j(t.left)+N,ye=t.right;else if(f==="right")V=j(this.left),de=t.left,ye=j(t.right)-N,te=V+N,se=this.left+A;else if(n==="x"){if(f==="center")V=j((t.top+t.bottom)/2+.5);else if(uo(f)){const xe=Object.keys(f)[0],Te=f[xe];V=j(this.chart.scales[xe].getPixelForValue(Te))}fe=t.top,ge=t.bottom,ne=V+N,ee=ne+A}else if(n==="y"){if(f==="center")V=j((t.left+t.right)/2);else if(uo(f)){const xe=Object.keys(f)[0],Te=f[xe];V=j(this.chart.scales[xe].getPixelForValue(Te))}te=V-N,se=te-A,de=t.left,ye=t.right}const we=Bi(s.ticks.maxTicksLimit,P),Se=Math.max(1,Math.ceil(P/we));for(K=0;K<P;K+=Se){const xe=this.getContext(K),Te=d.setContext(xe),ze=o.setContext(xe),Ue=Te.lineWidth,We=Te.color,Be=ze.dash||[],Xe=ze.dashOffset,qe=Te.tickWidth,at=Te.tickColor,Ke=Te.tickBorderDash||[],tt=Te.tickBorderDashOffset;Y=Eye(this,K,y),Y!==void 0&&(Z=bp(i,Y,Ue),b?te=se=de=ye=Z:ne=ee=fe=ge=Z,D.push({tx1:te,ty1:ne,tx2:se,ty2:ee,x1:de,y1:fe,x2:ye,y2:ge,width:Ue,color:We,borderDash:Be,borderDashOffset:Xe,tickWidth:qe,tickColor:at,tickBorderDash:Ke,tickBorderDashOffset:tt}))}return this._ticksLength=P,this._borderValue=V,D}_computeLabelItems(t){const n=this.axis,i=this.options,{position:s,ticks:d}=i,f=this.isHorizontal(),o=this.ticks,{align:y,crossAlign:b,padding:C,mirror:P}=d,A=x0(i.grid),D=A+C,k=P?-C:D,B=-Hc(this.labelRotation),N=[];let j,V,K,Y,Z,te,ne,se,ee,de,fe,ye,ge="middle";if(s==="top")te=this.bottom-k,ne=this._getXAxisLabelAlignment();else if(s==="bottom")te=this.top+k,ne=this._getXAxisLabelAlignment();else if(s==="left"){const Se=this._getYAxisLabelAlignment(A);ne=Se.textAlign,Z=Se.x}else if(s==="right"){const Se=this._getYAxisLabelAlignment(A);ne=Se.textAlign,Z=Se.x}else if(n==="x"){if(s==="center")te=(t.top+t.bottom)/2+D;else if(uo(s)){const Se=Object.keys(s)[0],xe=s[Se];te=this.chart.scales[Se].getPixelForValue(xe)+D}ne=this._getXAxisLabelAlignment()}else if(n==="y"){if(s==="center")Z=(t.left+t.right)/2-D;else if(uo(s)){const Se=Object.keys(s)[0],xe=s[Se];Z=this.chart.scales[Se].getPixelForValue(xe)}ne=this._getYAxisLabelAlignment(A).textAlign}n==="y"&&(y==="start"?ge="top":y==="end"&&(ge="bottom"));const we=this._getLabelSizes();for(j=0,V=o.length;j<V;++j){K=o[j],Y=K.label;const Se=d.setContext(this.getContext(j));se=this.getPixelForTick(j)+d.labelOffset,ee=this._resolveTickFontOptions(j),de=ee.lineHeight,fe=ga(Y)?Y.length:1;const xe=fe/2,Te=Se.color,ze=Se.textStrokeColor,Ue=Se.textStrokeWidth;let We=ne;f?(Z=se,ne==="inner"&&(j===V-1?We=this.options.reverse?"left":"right":j===0?We=this.options.reverse?"right":"left":We="center"),s==="top"?b==="near"||B!==0?ye=-fe*de+de/2:b==="center"?ye=-we.highest.height/2-xe*de+de:ye=-we.highest.height+de/2:b==="near"||B!==0?ye=de/2:b==="center"?ye=we.highest.height/2-xe*de:ye=we.highest.height-fe*de,P&&(ye*=-1),B!==0&&!Se.showLabelBackdrop&&(Z+=de/2*Math.sin(B))):(te=se,ye=(1-fe)*de/2);let Be;if(Se.showLabelBackdrop){const Xe=js(Se.backdropPadding),qe=we.heights[j],at=we.widths[j];let Ke=ye-Xe.top,tt=0-Xe.left;switch(ge){case"middle":Ke-=qe/2;break;case"bottom":Ke-=qe;break}switch(ne){case"center":tt-=at/2;break;case"right":tt-=at;break;case"inner":j===V-1?tt-=at:j>0&&(tt-=at/2);break}Be={left:tt,top:Ke,width:at+Xe.width,height:qe+Xe.height,color:Se.backdropColor}}N.push({label:Y,font:ee,textOffset:ye,options:{rotation:B,color:Te,strokeColor:ze,strokeWidth:Ue,textAlign:We,textBaseline:ge,translation:[Z,te],backdrop:Be}})}return N}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Hc(this.labelRotation))return t==="top"?"left":"right";let s="center";return n.align==="start"?s="left":n.align==="end"?s="right":n.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:s,padding:d}}=this.options,f=this._getLabelSizes(),o=t+d,y=f.widest.width;let b,C;return n==="left"?s?(C=this.right+d,i==="near"?b="left":i==="center"?(b="center",C+=y/2):(b="right",C+=y)):(C=this.right-o,i==="near"?b="right":i==="center"?(b="center",C-=y/2):(b="left",C=this.left)):n==="right"?s?(C=this.left+d,i==="near"?b="right":i==="center"?(b="center",C-=y/2):(b="left",C-=y)):(C=this.left+o,i==="near"?b="left":i==="center"?(b="center",C+=y/2):(b="right",C=this.right)):b="right",{textAlign:b,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:s,width:d,height:f}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,s,d,f),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const s=this.ticks.findIndex(d=>d.value===t);return s>=0?n.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let d,f;const o=(y,b,C)=>{!C.width||!C.color||(i.save(),i.lineWidth=C.width,i.strokeStyle=C.color,i.setLineDash(C.borderDash||[]),i.lineDashOffset=C.borderDashOffset,i.beginPath(),i.moveTo(y.x,y.y),i.lineTo(b.x,b.y),i.stroke(),i.restore())};if(n.display)for(d=0,f=s.length;d<f;++d){const y=s[d];n.drawOnChartArea&&o({x:y.x1,y:y.y1},{x:y.x2,y:y.y2},y),n.drawTicks&&o({x:y.tx1,y:y.ty1},{x:y.tx2,y:y.ty2},{color:y.tickColor,width:y.tickWidth,borderDash:y.tickBorderDash,borderDashOffset:y.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:i,grid:s}}=this,d=i.setContext(this.getContext()),f=i.display?d.width:0;if(!f)return;const o=s.setContext(this.getContext(0)).lineWidth,y=this._borderValue;let b,C,P,A;this.isHorizontal()?(b=bp(t,this.left,f)-f/2,C=bp(t,this.right,o)+o/2,P=A=y):(P=bp(t,this.top,f)-f/2,A=bp(t,this.bottom,o)+o/2,b=C=y),n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.beginPath(),n.moveTo(b,P),n.lineTo(C,A),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&HE(i,s);const d=this.getLabelItems(t);for(const f of d){const o=f.options,y=f.font,b=f.label,C=f.textOffset;Jp(i,b,0,C,y,o)}s&&GE(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:s}}=this;if(!i.display)return;const d=rs(i.font),f=js(i.padding),o=i.align;let y=d.lineHeight/2;n==="bottom"||n==="center"||uo(n)?(y+=f.bottom,ga(i.text)&&(y+=d.lineHeight*(i.text.length-1))):y+=f.top;const{titleX:b,titleY:C,maxWidth:P,rotation:A}=Rye(this,y,n,o);Jp(t,i.text,0,0,d,{color:i.color,maxWidth:P,rotation:A,textAlign:Mye(o,n,s),textBaseline:"middle",translation:[b,C]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=Bi(t.grid&&t.grid.z,-1),s=Bi(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==lm.prototype.draw?[{z:n,draw:d=>{this.draw(d)}}]:[{z:i,draw:d=>{this.drawBackground(),this.drawGrid(d),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:n,draw:d=>{this.drawLabels(d)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let d,f;for(d=0,f=n.length;d<f;++d){const o=n[d];o[i]===this.id&&(!t||o.type===t)&&s.push(o)}return s}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return rs(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Hw{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;Dye(n)&&(i=this.register(n));const s=this.items,d=t.id,f=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+t);return d in s||(s[d]=t,Aye(t,f,i),this.override&&_a.override(t.id,t.overrides)),f}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,s=this.scope;i in n&&delete n[i],s&&i in _a[s]&&(delete _a[s][i],this.override&&delete Yp[i])}}function Aye(e,t,n){const i=Bx(Object.create(null),[n?_a.get(n):{},_a.get(t),e.defaults]);_a.set(t,i),e.defaultRoutes&&Oye(t,e.defaultRoutes),e.descriptors&&_a.describe(t,e.descriptors)}function Oye(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),s=i.pop(),d=[e].concat(i).join("."),f=t[n].split("."),o=f.pop(),y=f.join(".");_a.route(d,s,y,o)})}function Dye(e){return"id"in e&&"defaults"in e}class Lye{constructor(){this.controllers=new Hw(Xc,"datasets",!0),this.elements=new Hw($d,"elements"),this.plugins=new Hw(Object,"plugins"),this.scales=new Hw(lm,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(s=>{const d=i||this._getRegistryForType(s);i||d.isForType(s)||d===this.plugins&&s.id?this._exec(t,d,s):$o(s,f=>{const o=i||this._getRegistryForType(f);this._exec(t,o,f)})})}_exec(t,n,i){const s=AD(t);ra(i["before"+s],[],i),n[t](i),ra(i["after"+s],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const s=n.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var Iu=new Lye;class zye{constructor(){this._init=void 0}notify(t,n,i,s){if(n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const d=s?this._descriptors(t).filter(s):this._descriptors(t),f=this._notify(d,t,n,i);return n==="afterDestroy"&&(this._notify(d,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),f}_notify(t,n,i,s){s=s||{};for(const d of t){const f=d.plugin,o=f[i],y=[n,s,d.options];if(ra(o,y,f)===!1&&s.cancelable)return!1}return!0}invalidate(){ro(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,s=Bi(i.options&&i.options.plugins,{}),d=kye(i);return s===!1&&!n?[]:Nye(t,d,s,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,s=(d,f)=>d.filter(o=>!f.some(y=>o.plugin.id===y.plugin.id));this._notify(s(n,i),t,"stop"),this._notify(s(i,n),t,"start")}}function kye(e){const t={},n=[],i=Object.keys(Iu.plugins.items);for(let d=0;d<i.length;d++)n.push(Iu.getPlugin(i[d]));const s=e.plugins||[];for(let d=0;d<s.length;d++){const f=s[d];n.indexOf(f)===-1&&(n.push(f),t[f.id]=!0)}return{plugins:n,localIds:t}}function Fye(e,t){return!t&&e===!1?null:e===!0?{}:e}function Nye(e,{plugins:t,localIds:n},i,s){const d=[],f=e.getContext();for(const o of t){const y=o.id,b=Fye(i[y],s);b!==null&&d.push({plugin:o,options:Bye(e.config,{plugin:o,local:n[y]},b,f)})}return d}function Bye(e,{plugin:t,local:n},i,s){const d=e.pluginScopeKeys(t),f=e.getOptionScopes(i,d);return n&&t.defaults&&f.push(t.defaults),e.createResolver(f,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function nA(e,t){const n=_a.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function $ye(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function jye(e,t){return e===t?"_index_":"_value_"}function f4(e){if(e==="x"||e==="y"||e==="r")return e}function Vye(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function rA(e,...t){if(f4(e))return e;for(const n of t){const i=n.axis||Vye(n.position)||e.length>1&&f4(e[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function p4(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Uye(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(i=>i.xAxisID===e||i.yAxisID===e);if(n.length)return p4(e,"x",n[0])||p4(e,"y",n[0])}return{}}function Hye(e,t){const n=Yp[e.type]||{scales:{}},i=t.scales||{},s=nA(e.type,t),d=Object.create(null);return Object.keys(i).forEach(f=>{const o=i[f];if(!uo(o))return console.error(`Invalid scale configuration for scale: ${f}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${f}`);const y=rA(f,o,Uye(f,e),_a.scales[o.type]),b=jye(y,s),C=n.scales||{};d[f]=X0(Object.create(null),[{axis:y},o,C[y],C[b]])}),e.data.datasets.forEach(f=>{const o=f.type||e.type,y=f.indexAxis||nA(o,t),C=(Yp[o]||{}).scales||{};Object.keys(C).forEach(P=>{const A=$ye(P,y),D=f[A+"AxisID"]||A;d[D]=d[D]||Object.create(null),X0(d[D],[{axis:A},i[D],C[P]])})}),Object.keys(d).forEach(f=>{const o=d[f];X0(o,[_a.scales[o.type],_a.scale])}),d}function sW(e){const t=e.options||(e.options={});t.plugins=Bi(t.plugins,{}),t.scales=Hye(e,t)}function lW(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function Gye(e){return e=e||{},e.data=lW(e.data),sW(e),e}const m4=new Map,cW=new Set;function Gw(e,t){let n=m4.get(e);return n||(n=t(),m4.set(e,n),cW.add(n)),n}const b0=(e,t,n)=>{const i=gf(t,n);i!==void 0&&e.add(i)};class Wye{constructor(t){this._config=Gye(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=lW(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),sW(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Gw(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Gw(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Gw(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return Gw(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let s=i.get(t);return(!s||n)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,n,i){const{options:s,type:d}=this,f=this._cachedScopes(t,i),o=f.get(n);if(o)return o;const y=new Set;n.forEach(C=>{t&&(y.add(t),C.forEach(P=>b0(y,t,P))),C.forEach(P=>b0(y,s,P)),C.forEach(P=>b0(y,Yp[d]||{},P)),C.forEach(P=>b0(y,_a,P)),C.forEach(P=>b0(y,QR,P))});const b=Array.from(y);return b.length===0&&b.push(Object.create(null)),cW.has(n)&&f.set(n,b),b}chartOptionScopes(){const{options:t,type:n}=this;return[t,Yp[n]||{},_a.datasets[n]||{},{type:n},_a,QR]}resolveNamedOptions(t,n,i,s=[""]){const d={$shared:!0},{resolver:f,subPrefixes:o}=g4(this._resolverCache,t,s);let y=f;if(Kye(f,n)){d.$shared=!1,i=vf(i)?i():i;const b=this.createResolver(t,i,o);y=Bv(f,i,b)}for(const b of n)d[b]=y[b];return d}createResolver(t,n,i=[""],s){const{resolver:d}=g4(this._resolverCache,t,i);return uo(n)?Bv(d,n,void 0,s):d}}function g4(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const s=n.join();let d=i.get(s);return d||(d={resolver:FD(t,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},i.set(s,d)),d}const qye=e=>uo(e)&&Object.getOwnPropertyNames(e).some(t=>vf(e[t]));function Kye(e,t){const{isScriptable:n,isIndexable:i}=jG(e);for(const s of t){const d=n(s),f=i(s),o=(f||d)&&e[s];if(d&&(vf(o)||qye(o))||f&&ga(o))return!0}return!1}var Xye="4.5.1";const Zye=["top","bottom","left","right","chartArea"];function v4(e,t){return e==="top"||e==="bottom"||Zye.indexOf(e)===-1&&t==="x"}function _4(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function y4(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),ra(n&&n.onComplete,[e],t)}function Yye(e){const t=e.chart,n=t.options.animation;ra(n&&n.onProgress,[e],t)}function uW(e){return $D()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const IS={},x4=e=>{const t=uW(e);return Object.values(IS).filter(n=>n.canvas===t).pop()};function Jye(e,t,n){const i=Object.keys(e);for(const s of i){const d=+s;if(d>=t){const f=e[s];delete e[s],(n>0||d>t)&&(e[d+n]=f)}}}function Qye(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}class Mu{static register(...t){Iu.add(...t),b4()}static unregister(...t){Iu.remove(...t),b4()}constructor(t,n){const i=this.config=new Wye(n),s=uW(t),d=x4(s);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const f=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||vye(s)),this.platform.updateConfig(i);const o=this.platform.acquireContext(s,f.aspectRatio),y=o&&o.canvas,b=y&&y.height,C=y&&y.width;if(this.id=eve(),this.ctx=o,this.canvas=y,this.width=C,this.height=b,this._options=f,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new zye,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=vve(P=>this.update(P),f.resizeDelay||0),this._dataChanges=[],IS[this.id]=this,!o||!y){console.error("Failed to create chart: can't acquire context from the given item");return}xd.listen(this,"complete",y4),xd.listen(this,"progress",Yye),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:s,_aspectRatio:d}=this;return ro(t)?n&&d?d:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Iu}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():U5(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return $5(this.canvas,this.ctx),this}stop(){return xd.stop(this),this}resize(t,n){xd.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,s=this.canvas,d=i.maintainAspectRatio&&this.aspectRatio,f=this.platform.getMaximumSize(s,t,n,d),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=f.width,this.height=f.height,this._aspectRatio=this.aspectRatio,U5(this,o,!0)&&(this.notifyPlugins("resize",{size:f}),ra(i.onResize,[this,f],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};$o(n,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,s=Object.keys(i).reduce((f,o)=>(f[o]=!1,f),{});let d=[];n&&(d=d.concat(Object.keys(n).map(f=>{const o=n[f],y=rA(f,o),b=y==="r",C=y==="x";return{options:o,dposition:b?"chartArea":C?"bottom":"left",dtype:b?"radialLinear":C?"category":"linear"}}))),$o(d,f=>{const o=f.options,y=o.id,b=rA(y,o),C=Bi(o.type,f.dtype);(o.position===void 0||v4(o.position,b)!==v4(f.dposition))&&(o.position=f.dposition),s[y]=!0;let P=null;if(y in i&&i[y].type===C)P=i[y];else{const A=Iu.getScale(C);P=new A({id:y,type:C,ctx:this.ctx,chart:this}),i[P.id]=P}P.init(o,t)}),$o(s,(f,o)=>{f||delete i[o]}),$o(i,f=>{ks.configure(this,f,f.options),ks.addBox(this,f)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((s,d)=>s.index-d.index),i>n){for(let s=n;s<i;++s)this._destroyDatasetMeta(s);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(_4("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,s)=>{n.filter(d=>d===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=n.length;i<s;i++){const d=n[i];let f=this.getDatasetMeta(i);const o=d.type||this.config.type;if(f.type&&f.type!==o&&(this._destroyDatasetMeta(i),f=this.getDatasetMeta(i)),f.type=o,f.indexAxis=d.indexAxis||nA(o,this.options),f.order=d.order||0,f.index=i,f.label=""+d.label,f.visible=this.isDatasetVisible(i),f.controller)f.controller.updateIndex(i),f.controller.linkScales();else{const y=Iu.getController(o),{datasetElementType:b,dataElementType:C}=_a.datasets[o];Object.assign(y,{dataElementType:Iu.getElement(C),datasetElementType:b&&Iu.getElement(b)}),f.controller=new y(this,i),t.push(f.controller)}}return this._updateMetasets(),t}_resetElements(){$o(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let f=0;for(let b=0,C=this.data.datasets.length;b<C;b++){const{controller:P}=this.getDatasetMeta(b),A=!s&&d.indexOf(P)===-1;P.buildOrUpdateElements(A),f=Math.max(+P.getMaxOverflow(),f)}f=this._minPadding=i.layout.autoPadding?f:0,this._updateLayout(f),s||$o(d,b=>{b.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(_4("z","_idx"));const{_active:o,_lastEvent:y}=this;y?this._eventHandler(y,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){$o(this.scales,t=>{ks.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!A5(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:d}of n){const f=i==="_removeElements"?-d:d;Jye(t,s,f)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=d=>new Set(t.filter(f=>f[0]===d).map((f,o)=>o+","+f.splice(1).join(","))),s=i(0);for(let d=1;d<n;d++)if(!A5(s,i(d)))return;return Array.from(s).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ks.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],$o(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,d)=>{s._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,vf(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(n),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xd.has(this)?this.attached&&!xd.running(this)&&xd.start(this):(this.draw(),y4({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let s,d;for(s=0,d=n.length;s<d;++s){const f=n[s];(!t||f.visible)&&i.push(f)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i={meta:t,index:t.index,cancelable:!0},s=JG(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(s&&HE(n,s),t.controller.draw(),s&&GE(n),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return Rd(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,s){const d=Z_e.modes[n];return typeof d=="function"?d(this,t,i,s):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let s=i.filter(d=>d&&d._dataset===n).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=Cf(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const s=i?"show":"hide",d=this.getDatasetMeta(t),f=d.controller._resolveAnimations(void 0,s);$x(n)?(d.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),f.update(d,{visible:i}),this.update(o=>o.datasetIndex===t?s:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),xd.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),$5(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete IS[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(d,f)=>{n.addEventListener(this,d,f),t[d]=f},s=(d,f,o)=>{d.offsetX=f,d.offsetY=o,this._eventHandler(d)};$o(this.options.events,d=>i(d,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(y,b)=>{n.addEventListener(this,y,b),t[y]=b},s=(y,b)=>{t[y]&&(n.removeEventListener(this,y,b),delete t[y])},d=(y,b)=>{this.canvas&&this.resize(y,b)};let f;const o=()=>{s("attach",o),this.attached=!0,this.resize(),i("resize",d),i("detach",f)};f=()=>{this.attached=!1,s("resize",d),this._stop(),this._resize(0,0),i("attach",o)},n.isAttached(this.canvas)?o():f()}unbindEvents(){$o(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},$o(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const s=i?"set":"remove";let d,f,o,y;for(n==="dataset"&&(d=this.getDatasetMeta(t[0].datasetIndex),d.controller["_"+s+"DatasetHoverStyle"]()),o=0,y=t.length;o<y;++o){f=t[o];const b=f&&this.getDatasetMeta(f.datasetIndex).controller;b&&b[s+"HoverStyle"](f.element,f.datasetIndex,f.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:d,index:f})=>{const o=this.getDatasetMeta(d);if(!o)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:o.data[f],index:f}});!xC(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,i){const s=this.options.hover,d=(y,b)=>y.filter(C=>!b.some(P=>C.datasetIndex===P.datasetIndex&&C.index===P.index)),f=d(n,t),o=i?t:d(t,n);f.length&&this.updateHoverStyle(f,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},s=f=>(f.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const d=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(d||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:s=[],options:d}=this,f=n,o=this._getActiveElements(t,s,i,f),y=ave(t),b=Qye(t,this._lastEvent,i,y);i&&(this._lastEvent=null,ra(d.onHover,[t,o,this],this),y&&ra(d.onClick,[t,o,this],this));const C=!xC(o,s);return(C||n)&&(this._active=o,this._updateHoverStyles(o,s,n)),this._lastEvent=b,C}_getActiveElements(t,n,i,s){if(t.type==="mouseout")return[];if(!i)return n;const d=this.options.hover;return this.getElementsAtEventForMode(t,d.mode,d,s)}}Er(Mu,"defaults",_a),Er(Mu,"instances",IS),Er(Mu,"overrides",Yp),Er(Mu,"registry",Iu),Er(Mu,"version",Xye),Er(Mu,"getChart",x4);function b4(){return $o(Mu.instances,e=>e._plugins.invalidate())}function e0e(e,t,n){const{startAngle:i,x:s,y:d,outerRadius:f,innerRadius:o,options:y}=t,{borderWidth:b,borderJoinStyle:C}=y,P=Math.min(b/f,Ls(i-n));if(e.beginPath(),e.arc(s,d,f-b/2,i+P/2,n-P/2),o>0){const A=Math.min(b/o,Ls(i-n));e.arc(s,d,o+b/2,n-A/2,i+A/2,!0)}else{const A=Math.min(b/2,f*Ls(i-n));if(C==="round")e.arc(s,d,A,n-Po/2,i+Po/2,!0);else if(C==="bevel"){const D=2*A*A,k=-D*Math.cos(n+Po/2)+s,B=-D*Math.sin(n+Po/2)+d,N=D*Math.cos(i+Po/2)+s,j=D*Math.sin(i+Po/2)+d;e.lineTo(k,B),e.lineTo(N,j)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function t0e(e,t,n){const{startAngle:i,pixelMargin:s,x:d,y:f,outerRadius:o,innerRadius:y}=t;let b=s/o;e.beginPath(),e.arc(d,f,o,i-b,n+b),y>s?(b=s/y,e.arc(d,f,y,n+b,i-b,!0)):e.arc(d,f,s,n+$a,i-$a),e.closePath(),e.clip()}function n0e(e){return kD(e,["outerStart","outerEnd","innerStart","innerEnd"])}function r0e(e,t,n,i){const s=n0e(e.options.borderRadius),d=(n-t)/2,f=Math.min(d,i*t/2),o=y=>{const b=(n-Math.min(d,y))*i/2;return hs(y,0,Math.min(d,b))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:hs(s.innerStart,0,f),innerEnd:hs(s.innerEnd,0,f)}}function Wg(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function TC(e,t,n,i,s,d){const{x:f,y:o,startAngle:y,pixelMargin:b,innerRadius:C}=t,P=Math.max(t.outerRadius+i+n-b,0),A=C>0?C+i+n+b:0;let D=0;const k=s-y;if(i){const Se=C>0?C-i:0,xe=P>0?P-i:0,Te=(Se+xe)/2,ze=Te!==0?k*Te/(Te+i):k;D=(k-ze)/2}const B=Math.max(.001,k*P-n/Po)/P,N=(k-B)/2,j=y+N+D,V=s-N-D,{outerStart:K,outerEnd:Y,innerStart:Z,innerEnd:te}=r0e(t,A,P,V-j),ne=P-K,se=P-Y,ee=j+K/ne,de=V-Y/se,fe=A+Z,ye=A+te,ge=j+Z/fe,we=V-te/ye;if(e.beginPath(),d){const Se=(ee+de)/2;if(e.arc(f,o,P,ee,Se),e.arc(f,o,P,Se,de),Y>0){const Ue=Wg(se,de,f,o);e.arc(Ue.x,Ue.y,Y,de,V+$a)}const xe=Wg(ye,V,f,o);if(e.lineTo(xe.x,xe.y),te>0){const Ue=Wg(ye,we,f,o);e.arc(Ue.x,Ue.y,te,V+$a,we+Math.PI)}const Te=(V-te/A+(j+Z/A))/2;if(e.arc(f,o,A,V-te/A,Te,!0),e.arc(f,o,A,Te,j+Z/A,!0),Z>0){const Ue=Wg(fe,ge,f,o);e.arc(Ue.x,Ue.y,Z,ge+Math.PI,j-$a)}const ze=Wg(ne,j,f,o);if(e.lineTo(ze.x,ze.y),K>0){const Ue=Wg(ne,ee,f,o);e.arc(Ue.x,Ue.y,K,j-$a,ee)}}else{e.moveTo(f,o);const Se=Math.cos(ee)*P+f,xe=Math.sin(ee)*P+o;e.lineTo(Se,xe);const Te=Math.cos(de)*P+f,ze=Math.sin(de)*P+o;e.lineTo(Te,ze)}e.closePath()}function i0e(e,t,n,i,s){const{fullCircles:d,startAngle:f,circumference:o}=t;let y=t.endAngle;if(d){TC(e,t,n,i,y,s);for(let b=0;b<d;++b)e.fill();isNaN(o)||(y=f+(o%ha||ha))}return TC(e,t,n,i,y,s),e.fill(),y}function o0e(e,t,n,i,s){const{fullCircles:d,startAngle:f,circumference:o,options:y}=t,{borderWidth:b,borderJoinStyle:C,borderDash:P,borderDashOffset:A,borderRadius:D}=y,k=y.borderAlign==="inner";if(!b)return;e.setLineDash(P||[]),e.lineDashOffset=A,k?(e.lineWidth=b*2,e.lineJoin=C||"round"):(e.lineWidth=b,e.lineJoin=C||"bevel");let B=t.endAngle;if(d){TC(e,t,n,i,B,s);for(let N=0;N<d;++N)e.stroke();isNaN(o)||(B=f+(o%ha||ha))}k&&t0e(e,t,B),y.selfJoin&&B-f>=Po&&D===0&&C!=="miter"&&e0e(e,t,B),d||(TC(e,t,n,i,B,s),e.stroke())}class O0 extends $d{constructor(n){super();Er(this,"circumference");Er(this,"endAngle");Er(this,"fullCircles");Er(this,"innerRadius");Er(this,"outerRadius");Er(this,"pixelMargin");Er(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,i,s){const d=this.getProps(["x","y"],s),{angle:f,distance:o}=AG(d,{x:n,y:i}),{startAngle:y,endAngle:b,innerRadius:C,outerRadius:P,circumference:A}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),D=(this.options.spacing+this.options.borderWidth)/2,k=Bi(A,b-y),B=jx(f,y,b)&&y!==b,N=k>=ha||B,j=Pd(o,C+D,P+D);return N&&j}getCenterPoint(n){const{x:i,y:s,startAngle:d,endAngle:f,innerRadius:o,outerRadius:y}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:b,spacing:C}=this.options,P=(d+f)/2,A=(o+y+C+b)/2;return{x:i+Math.cos(P)*A,y:s+Math.sin(P)*A}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:i,circumference:s}=this,d=(i.offset||0)/4,f=(i.spacing||0)/2,o=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=s>ha?Math.floor(s/ha):0,s===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const y=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(y)*d,Math.sin(y)*d);const b=1-Math.sin(Math.min(Po,s||0)),C=d*b;n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,i0e(n,this,C,f,o),o0e(n,this,C,f,o),n.restore()}}Er(O0,"id","arc"),Er(O0,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Er(O0,"defaultRoutes",{backgroundColor:"backgroundColor"}),Er(O0,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function dW(e,t,n=t){e.lineCap=Bi(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Bi(n.borderDash,t.borderDash)),e.lineDashOffset=Bi(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Bi(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Bi(n.borderWidth,t.borderWidth),e.strokeStyle=Bi(n.borderColor,t.borderColor)}function a0e(e,t,n){e.lineTo(n.x,n.y)}function s0e(e){return e.stepped?Mve:e.tension||e.cubicInterpolationMode==="monotone"?Rve:a0e}function hW(e,t,n={}){const i=e.length,{start:s=0,end:d=i-1}=n,{start:f,end:o}=t,y=Math.max(s,f),b=Math.min(d,o),C=s<f&&d<f||s>o&&d>o;return{count:i,start:y,loop:t.loop,ilen:b<y&&!C?i+b-y:b-y}}function l0e(e,t,n,i){const{points:s,options:d}=t,{count:f,start:o,loop:y,ilen:b}=hW(s,n,i),C=s0e(d);let{move:P=!0,reverse:A}=i||{},D,k,B;for(D=0;D<=b;++D)k=s[(o+(A?b-D:D))%f],!k.skip&&(P?(e.moveTo(k.x,k.y),P=!1):C(e,B,k,A,d.stepped),B=k);return y&&(k=s[(o+(A?b:0))%f],C(e,B,k,A,d.stepped)),!!y}function c0e(e,t,n,i){const s=t.points,{count:d,start:f,ilen:o}=hW(s,n,i),{move:y=!0,reverse:b}=i||{};let C=0,P=0,A,D,k,B,N,j;const V=Y=>(f+(b?o-Y:Y))%d,K=()=>{B!==N&&(e.lineTo(C,N),e.lineTo(C,B),e.lineTo(C,j))};for(y&&(D=s[V(0)],e.moveTo(D.x,D.y)),A=0;A<=o;++A){if(D=s[V(A)],D.skip)continue;const Y=D.x,Z=D.y,te=Y|0;te===k?(Z<B?B=Z:Z>N&&(N=Z),C=(P*C+Y)/++P):(K(),e.lineTo(Y,Z),k=te,P=0,B=N=Z),j=Z}K()}function iA(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?c0e:l0e}function u0e(e){return e.stepped?l_e:e.tension||e.cubicInterpolationMode==="monotone"?c_e:Pp}function d0e(e,t,n,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,n,i)&&s.closePath()),dW(e,t.options),e.stroke(s)}function h0e(e,t,n,i){const{segments:s,options:d}=t,f=iA(t);for(const o of s)dW(e,d,o.style),e.beginPath(),f(e,t,o,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const f0e=typeof Path2D=="function";function p0e(e,t,n,i){f0e&&!t.options.segment?d0e(e,t,n,i):h0e(e,t,n,i)}class Zh extends $d{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;e_e(this._points,i,t,s,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=m_e(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,s=t[n],d=this.points,f=YG(this,{property:n,start:s,end:s});if(!f.length)return;const o=[],y=u0e(i);let b,C;for(b=0,C=f.length;b<C;++b){const{start:P,end:A}=f[b],D=d[P],k=d[A];if(D===k){o.push(D);continue}const B=Math.abs((s-D[n])/(k[n]-D[n])),N=y(D,k,B,i.stepped);N[n]=t[n],o.push(N)}return o.length===1?o[0]:o}pathSegment(t,n,i){return iA(this)(t,this,n,i)}path(t,n,i){const s=this.segments,d=iA(this);let f=this._loop;n=n||0,i=i||this.points.length-n;for(const o of s)f&=d(t,this,o,{start:n,end:n+i-1});return!!f}draw(t,n,i,s){const d=this.options||{};(this.points||[]).length&&d.borderWidth&&(t.save(),p0e(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Er(Zh,"id","line"),Er(Zh,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Er(Zh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Er(Zh,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function w4(e,t,n,i){const s=e.options,{[n]:d}=e.getProps([n],i);return Math.abs(t-d)<s.radius+s.hitRadius}class PS extends $d{constructor(n){super();Er(this,"parsed");Er(this,"skip");Er(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,i,s){const d=this.options,{x:f,y:o}=this.getProps(["x","y"],s);return Math.pow(n-f,2)+Math.pow(i-o,2)<Math.pow(d.hitRadius+d.radius,2)}inXRange(n,i){return w4(this,n,"x",i)}inYRange(n,i){return w4(this,n,"y",i)}getCenterPoint(n){const{x:i,y:s}=this.getProps(["x","y"],n);return{x:i,y:s}}size(n){n=n||this.options||{};let i=n.radius||0;i=Math.max(i,i&&n.hoverRadius||0);const s=i&&n.borderWidth||0;return(i+s)*2}draw(n,i){const s=this.options;this.skip||s.radius<.1||!Rd(this,i,this.size(s)/2)||(n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.fillStyle=s.backgroundColor,eA(n,s,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Er(PS,"id","point"),Er(PS,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Er(PS,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function fW(e,t){const{x:n,y:i,base:s,width:d,height:f}=e.getProps(["x","y","base","width","height"],t);let o,y,b,C,P;return e.horizontal?(P=f/2,o=Math.min(n,s),y=Math.max(n,s),b=i-P,C=i+P):(P=d/2,o=n-P,y=n+P,b=Math.min(i,s),C=Math.max(i,s)),{left:o,top:b,right:y,bottom:C}}function Yh(e,t,n,i){return e?0:hs(t,n,i)}function m0e(e,t,n){const i=e.options.borderWidth,s=e.borderSkipped,d=$G(i);return{t:Yh(s.top,d.top,0,n),r:Yh(s.right,d.right,0,t),b:Yh(s.bottom,d.bottom,0,n),l:Yh(s.left,d.left,0,t)}}function g0e(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,d=$p(s),f=Math.min(t,n),o=e.borderSkipped,y=i||uo(s);return{topLeft:Yh(!y||o.top||o.left,d.topLeft,0,f),topRight:Yh(!y||o.top||o.right,d.topRight,0,f),bottomLeft:Yh(!y||o.bottom||o.left,d.bottomLeft,0,f),bottomRight:Yh(!y||o.bottom||o.right,d.bottomRight,0,f)}}function v0e(e){const t=fW(e),n=t.right-t.left,i=t.bottom-t.top,s=m0e(e,n/2,i/2),d=g0e(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:d},inner:{x:t.left+s.l,y:t.top+s.t,w:n-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,d.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(s.b,s.r))}}}}function CP(e,t,n,i){const s=t===null,d=n===null,o=e&&!(s&&d)&&fW(e,i);return o&&(s||Pd(t,o.left,o.right))&&(d||Pd(n,o.top,o.bottom))}function _0e(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function y0e(e,t){e.rect(t.x,t.y,t.w,t.h)}function EP(e,t,n={}){const i=e.x!==n.x?-t:0,s=e.y!==n.y?-t:0,d=(e.x+e.w!==n.x+n.w?t:0)-i,f=(e.y+e.h!==n.y+n.h?t:0)-s;return{x:e.x+i,y:e.y+s,w:e.w+d,h:e.h+f,radius:e.radius}}class MS extends $d{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:s}}=this,{inner:d,outer:f}=v0e(this),o=_0e(f.radius)?Vx:y0e;t.save(),(f.w!==d.w||f.h!==d.h)&&(t.beginPath(),o(t,EP(f,n,d)),t.clip(),o(t,EP(d,-n,f)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),o(t,EP(d,n)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,n,i){return CP(this,t,n,i)}inXRange(t,n){return CP(this,t,null,n)}inYRange(t,n){return CP(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:s,horizontal:d}=this.getProps(["x","y","base","horizontal"],t);return{x:d?(n+s)/2:n,y:d?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Er(MS,"id","bar"),Er(MS,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Er(MS,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var x0e=Object.freeze({__proto__:null,ArcElement:O0,BarElement:MS,LineElement:Zh,PointElement:PS});const oA=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],S4=oA.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function pW(e){return oA[e%oA.length]}function mW(e){return S4[e%S4.length]}function b0e(e,t){return e.borderColor=pW(t),e.backgroundColor=mW(t),++t}function w0e(e,t){return e.backgroundColor=e.data.map(()=>pW(t++)),t}function S0e(e,t){return e.backgroundColor=e.data.map(()=>mW(t++)),t}function C0e(e){let t=0;return(n,i)=>{const s=e.getDatasetMeta(i).controller;s instanceof zp?t=w0e(n,t):s instanceof Q0?t=S0e(n,t):s&&(t=b0e(n,t))}}function C4(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function E0e(e){return e&&(e.borderColor||e.backgroundColor)}function T0e(){return _a.borderColor!=="rgba(0,0,0,0.1)"||_a.backgroundColor!=="rgba(0,0,0,0.1)"}var I0e={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:i},options:s}=e.config,{elements:d}=s,f=C4(i)||E0e(s)||d&&C4(d)||T0e();if(!n.forceOverride&&f)return;const o=C0e(e);i.forEach(o)}};function P0e(e,t,n,i,s){const d=s.samples||i;if(d>=n)return e.slice(t,t+n);const f=[],o=(n-2)/(d-2);let y=0;const b=t+n-1;let C=t,P,A,D,k,B;for(f[y++]=e[C],P=0;P<d-2;P++){let N=0,j=0,V;const K=Math.floor((P+1)*o)+1+t,Y=Math.min(Math.floor((P+2)*o)+1,n)+t,Z=Y-K;for(V=K;V<Y;V++)N+=e[V].x,j+=e[V].y;N/=Z,j/=Z;const te=Math.floor(P*o)+1+t,ne=Math.min(Math.floor((P+1)*o)+1,n)+t,{x:se,y:ee}=e[C];for(D=k=-1,V=te;V<ne;V++)k=.5*Math.abs((se-N)*(e[V].y-ee)-(se-e[V].x)*(j-ee)),k>D&&(D=k,A=e[V],B=V);f[y++]=A,C=B}return f[y++]=e[b],f}function M0e(e,t,n,i){let s=0,d=0,f,o,y,b,C,P,A,D,k,B;const N=[],j=t+n-1,V=e[t].x,Y=e[j].x-V;for(f=t;f<t+n;++f){o=e[f],y=(o.x-V)/Y*i,b=o.y;const Z=y|0;if(Z===C)b<k?(k=b,P=f):b>B&&(B=b,A=f),s=(d*s+o.x)/++d;else{const te=f-1;if(!ro(P)&&!ro(A)){const ne=Math.min(P,A),se=Math.max(P,A);ne!==D&&ne!==te&&N.push({...e[ne],x:s}),se!==D&&se!==te&&N.push({...e[se],x:s})}f>0&&te!==D&&N.push(e[te]),N.push(o),C=Z,d=0,k=B=b,P=A=D=f}}return N}function gW(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function E4(e){e.data.datasets.forEach(t=>{gW(t)})}function R0e(e,t){const n=t.length;let i=0,s;const{iScale:d}=e,{min:f,max:o,minDefined:y,maxDefined:b}=d.getUserBounds();return y&&(i=hs(Md(t,d.axis,f).lo,0,n-1)),b?s=hs(Md(t,d.axis,o).hi+1,i,n)-i:s=n-i,{start:i,count:s}}var A0e={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){E4(e);return}const i=e.width;e.data.datasets.forEach((s,d)=>{const{_data:f,indexAxis:o}=s,y=e.getDatasetMeta(d),b=f||s.data;if(R0([o,e.options.indexAxis])==="y"||!y.controller.supportsDecimation)return;const C=e.scales[y.xAxisID];if(C.type!=="linear"&&C.type!=="time"||e.options.parsing)return;let{start:P,count:A}=R0e(y,b);const D=n.threshold||4*i;if(A<=D){gW(s);return}ro(f)&&(s._data=b,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(B){this._data=B}}));let k;switch(n.algorithm){case"lttb":k=P0e(b,P,A,i,n);break;case"min-max":k=M0e(b,P,A,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}s._decimated=k})},destroy(e){E4(e)}};function O0e(e,t,n){const i=e.segments,s=e.points,d=t.points,f=[];for(const o of i){let{start:y,end:b}=o;b=KE(y,b,s);const C=aA(n,s[y],s[b],o.loop);if(!t.segments){f.push({source:o,target:C,start:s[y],end:s[b]});continue}const P=YG(t,C);for(const A of P){const D=aA(n,d[A.start],d[A.end],A.loop),k=ZG(o,s,D);for(const B of k)f.push({source:B,target:A,start:{[n]:T4(C,D,"start",Math.max)},end:{[n]:T4(C,D,"end",Math.min)}})}}return f}function aA(e,t,n,i){if(i)return;let s=t[e],d=n[e];return e==="angle"&&(s=Ls(s),d=Ls(d)),{property:e,start:s,end:d}}function D0e(e,t){const{x:n=null,y:i=null}=e||{},s=t.points,d=[];return t.segments.forEach(({start:f,end:o})=>{o=KE(f,o,s);const y=s[f],b=s[o];i!==null?(d.push({x:y.x,y:i}),d.push({x:b.x,y:i})):n!==null&&(d.push({x:n,y:y.y}),d.push({x:n,y:b.y}))}),d}function KE(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function T4(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function vW(e,t){let n=[],i=!1;return ga(e)?(i=!0,n=e):n=D0e(e,t),n.length?new Zh({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function I4(e){return e&&e.fill!==!1}function L0e(e,t,n){let s=e[t].fill;const d=[t];let f;if(!n)return s;for(;s!==!1&&d.indexOf(s)===-1;){if(!La(s))return s;if(f=e[s],!f)return!1;if(f.visible)return s;d.push(s),s=f.fill}return!1}function z0e(e,t,n){const i=B0e(e);if(uo(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return La(s)&&Math.floor(s)===s?k0e(i[0],t,s,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function k0e(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function F0e(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:uo(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function N0e(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:uo(e)?i=e.value:i=t.getBaseValue(),i}function B0e(e){const t=e.options,n=t.fill;let i=Bi(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function $0e(e){const{scale:t,index:n,line:i}=e,s=[],d=i.segments,f=i.points,o=j0e(t,n);o.push(vW({x:null,y:t.bottom},i));for(let y=0;y<d.length;y++){const b=d[y];for(let C=b.start;C<=b.end;C++)V0e(s,f[C],o)}return new Zh({points:s,options:{}})}function j0e(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const d=i[s];if(d.index===t)break;d.hidden||n.unshift(d.dataset)}return n}function V0e(e,t,n){const i=[];for(let s=0;s<n.length;s++){const d=n[s],{first:f,last:o,point:y}=U0e(d,t,"x");if(!(!y||f&&o)){if(f)i.unshift(y);else if(e.push(y),!o)break}}e.push(...i)}function U0e(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const s=i[n],d=e.segments,f=e.points;let o=!1,y=!1;for(let b=0;b<d.length;b++){const C=d[b],P=f[C.start][n],A=f[C.end][n];if(Pd(s,P,A)){o=s===P,y=s===A;break}}return{first:o,last:y,point:i}}class _W{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:s,y:d,radius:f}=this;return n=n||{start:0,end:ha},t.arc(s,d,f,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:s}=this,d=t.angle;return{x:n+Math.cos(d)*s,y:i+Math.sin(d)*s,angle:d}}}function H0e(e){const{chart:t,fill:n,line:i}=e;if(La(n))return G0e(t,n);if(n==="stack")return $0e(e);if(n==="shape")return!0;const s=W0e(e);return s instanceof _W?s:vW(s,i)}function G0e(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function W0e(e){return(e.scale||{}).getPointPositionForValue?K0e(e):q0e(e)}function q0e(e){const{scale:t={},fill:n}=e,i=F0e(n,t);if(La(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function K0e(e){const{scale:t,fill:n}=e,i=t.options,s=t.getLabels().length,d=i.reverse?t.max:t.min,f=N0e(n,t,d),o=[];if(i.grid.circular){const y=t.getPointPositionForValue(0,d);return new _W({x:y.x,y:y.y,radius:t.getDistanceFromCenterForValue(f)})}for(let y=0;y<s;++y)o.push(t.getPointPositionForValue(y,f));return o}function TP(e,t,n){const i=H0e(t),{chart:s,index:d,line:f,scale:o,axis:y}=t,b=f.options,C=b.fill,P=b.backgroundColor,{above:A=P,below:D=P}=C||{},k=s.getDatasetMeta(d),B=JG(s,k);i&&f.points.length&&(HE(e,n),X0e(e,{line:f,target:i,above:A,below:D,area:n,scale:o,axis:y,clip:B}),GE(e))}function X0e(e,t){const{line:n,target:i,above:s,below:d,area:f,scale:o,clip:y}=t,b=n._loop?"angle":t.axis;e.save();let C=d;d!==s&&(b==="x"?(P4(e,i,f.top),IP(e,{line:n,target:i,color:s,scale:o,property:b,clip:y}),e.restore(),e.save(),P4(e,i,f.bottom)):b==="y"&&(M4(e,i,f.left),IP(e,{line:n,target:i,color:d,scale:o,property:b,clip:y}),e.restore(),e.save(),M4(e,i,f.right),C=s)),IP(e,{line:n,target:i,color:C,scale:o,property:b,clip:y}),e.restore()}function P4(e,t,n){const{segments:i,points:s}=t;let d=!0,f=!1;e.beginPath();for(const o of i){const{start:y,end:b}=o,C=s[y],P=s[KE(y,b,s)];d?(e.moveTo(C.x,C.y),d=!1):(e.lineTo(C.x,n),e.lineTo(C.x,C.y)),f=!!t.pathSegment(e,o,{move:f}),f?e.closePath():e.lineTo(P.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function M4(e,t,n){const{segments:i,points:s}=t;let d=!0,f=!1;e.beginPath();for(const o of i){const{start:y,end:b}=o,C=s[y],P=s[KE(y,b,s)];d?(e.moveTo(C.x,C.y),d=!1):(e.lineTo(n,C.y),e.lineTo(C.x,C.y)),f=!!t.pathSegment(e,o,{move:f}),f?e.closePath():e.lineTo(n,P.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function IP(e,t){const{line:n,target:i,property:s,color:d,scale:f,clip:o}=t,y=O0e(n,i,s);for(const{source:b,target:C,start:P,end:A}of y){const{style:{backgroundColor:D=d}={}}=b,k=i!==!0;e.save(),e.fillStyle=D,Z0e(e,f,o,k&&aA(s,P,A)),e.beginPath();const B=!!n.pathSegment(e,b);let N;if(k){B?e.closePath():R4(e,i,A,s);const j=!!i.pathSegment(e,C,{move:B,reverse:!0});N=B&&j,N||R4(e,i,P,s)}e.closePath(),e.fill(N?"evenodd":"nonzero"),e.restore()}}function Z0e(e,t,n,i){const s=t.chart.chartArea,{property:d,start:f,end:o}=i||{};if(d==="x"||d==="y"){let y,b,C,P;d==="x"?(y=f,b=s.top,C=o,P=s.bottom):(y=s.left,b=f,C=s.right,P=o),e.beginPath(),n&&(y=Math.max(y,n.left),C=Math.min(C,n.right),b=Math.max(b,n.top),P=Math.min(P,n.bottom)),e.rect(y,b,C-y,P-b),e.clip()}}function R4(e,t,n,i){const s=t.interpolate(n,i);s&&e.lineTo(s.x,s.y)}var Y0e={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,s=[];let d,f,o,y;for(f=0;f<i;++f)d=e.getDatasetMeta(f),o=d.dataset,y=null,o&&o.options&&o instanceof Zh&&(y={visible:e.isDatasetVisible(f),index:f,fill:z0e(o,f,i),chart:e,axis:d.controller.options.indexAxis,scale:d.vScale,line:o}),d.$filler=y,s.push(y);for(f=0;f<i;++f)y=s[f],!(!y||y.fill===!1)&&(y.fill=L0e(s,f,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",s=e.getSortedVisibleDatasetMetas(),d=e.chartArea;for(let f=s.length-1;f>=0;--f){const o=s[f].$filler;o&&(o.line.updateControlPoints(d,o.axis),i&&o.fill&&TP(e.ctx,o,d))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const d=i[s].$filler;I4(d)&&TP(e.ctx,d,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!I4(i)||n.drawTime!=="beforeDatasetDraw"||TP(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const A4=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},J0e=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class O4 extends $d{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=ra(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=rs(i.font),d=s.size,f=this._computeTitleHeight(),{boxWidth:o,itemHeight:y}=A4(i,d);let b,C;n.font=s.string,this.isHorizontal()?(b=this.maxWidth,C=this._fitRows(f,d,o,y)+10):(C=this.maxHeight,b=this._fitCols(f,s,o,y)+10),this.width=Math.min(b,t.maxWidth||this.maxWidth),this.height=Math.min(C,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,s){const{ctx:d,maxWidth:f,options:{labels:{padding:o}}}=this,y=this.legendHitBoxes=[],b=this.lineWidths=[0],C=s+o;let P=t;d.textAlign="left",d.textBaseline="middle";let A=-1,D=-C;return this.legendItems.forEach((k,B)=>{const N=i+n/2+d.measureText(k.text).width;(B===0||b[b.length-1]+N+2*o>f)&&(P+=C,b[b.length-(B>0?0:1)]=0,D+=C,A++),y[B]={left:0,top:D,row:A,width:N,height:s},b[b.length-1]+=N+o}),P}_fitCols(t,n,i,s){const{ctx:d,maxHeight:f,options:{labels:{padding:o}}}=this,y=this.legendHitBoxes=[],b=this.columnSizes=[],C=f-t;let P=o,A=0,D=0,k=0,B=0;return this.legendItems.forEach((N,j)=>{const{itemWidth:V,itemHeight:K}=Q0e(i,n,d,N,s);j>0&&D+K+2*o>C&&(P+=A+o,b.push({width:A,height:D}),k+=A+o,B++,A=D=0),y[j]={left:k,top:D,col:B,width:V,height:K},A=Math.max(A,V),D+=K+o}),P+=A,b.push({width:A,height:D}),P}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:s},rtl:d}}=this,f=bv(d,this.left,this.width);if(this.isHorizontal()){let o=0,y=As(i,this.left+s,this.right-this.lineWidths[o]);for(const b of n)o!==b.row&&(o=b.row,y=As(i,this.left+s,this.right-this.lineWidths[o])),b.top+=this.top+t+s,b.left=f.leftForLtr(f.x(y),b.width),y+=b.width+s}else{let o=0,y=As(i,this.top+t+s,this.bottom-this.columnSizes[o].height);for(const b of n)b.col!==o&&(o=b.col,y=As(i,this.top+t+s,this.bottom-this.columnSizes[o].height)),b.top=y,b.left+=this.left+s,b.left=f.leftForLtr(f.x(b.left),b.width),y+=b.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;HE(t,this),this._draw(),GE(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:s}=this,{align:d,labels:f}=t,o=_a.color,y=bv(t.rtl,this.left,this.width),b=rs(f.font),{padding:C}=f,P=b.size,A=P/2;let D;this.drawTitle(),s.textAlign=y.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=b.string;const{boxWidth:k,boxHeight:B,itemHeight:N}=A4(f,P),j=function(te,ne,se){if(isNaN(k)||k<=0||isNaN(B)||B<0)return;s.save();const ee=Bi(se.lineWidth,1);if(s.fillStyle=Bi(se.fillStyle,o),s.lineCap=Bi(se.lineCap,"butt"),s.lineDashOffset=Bi(se.lineDashOffset,0),s.lineJoin=Bi(se.lineJoin,"miter"),s.lineWidth=ee,s.strokeStyle=Bi(se.strokeStyle,o),s.setLineDash(Bi(se.lineDash,[])),f.usePointStyle){const de={radius:B*Math.SQRT2/2,pointStyle:se.pointStyle,rotation:se.rotation,borderWidth:ee},fe=y.xPlus(te,k/2),ye=ne+A;BG(s,de,fe,ye,f.pointStyleWidth&&k)}else{const de=ne+Math.max((P-B)/2,0),fe=y.leftForLtr(te,k),ye=$p(se.borderRadius);s.beginPath(),Object.values(ye).some(ge=>ge!==0)?Vx(s,{x:fe,y:de,w:k,h:B,radius:ye}):s.rect(fe,de,k,B),s.fill(),ee!==0&&s.stroke()}s.restore()},V=function(te,ne,se){Jp(s,se.text,te,ne+N/2,b,{strikethrough:se.hidden,textAlign:y.textAlign(se.textAlign)})},K=this.isHorizontal(),Y=this._computeTitleHeight();K?D={x:As(d,this.left+C,this.right-i[0]),y:this.top+C+Y,line:0}:D={x:this.left+C,y:As(d,this.top+Y+C,this.bottom-n[0].height),line:0},qG(this.ctx,t.textDirection);const Z=N+C;this.legendItems.forEach((te,ne)=>{s.strokeStyle=te.fontColor,s.fillStyle=te.fontColor;const se=s.measureText(te.text).width,ee=y.textAlign(te.textAlign||(te.textAlign=f.textAlign)),de=k+A+se;let fe=D.x,ye=D.y;y.setWidth(this.width),K?ne>0&&fe+de+C>this.right&&(ye=D.y+=Z,D.line++,fe=D.x=As(d,this.left+C,this.right-i[D.line])):ne>0&&ye+Z>this.bottom&&(fe=D.x=fe+n[D.line].width+C,D.line++,ye=D.y=As(d,this.top+Y+C,this.bottom-n[D.line].height));const ge=y.x(fe);if(j(ge,ye,te),fe=_ve(ee,fe+k+A,K?fe+de:this.right,t.rtl),V(y.x(fe),ye,te),K)D.x+=de+C;else if(typeof te.text!="string"){const we=b.lineHeight;D.y+=yW(te,we)+C}else D.y+=Z}),KG(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=rs(n.font),s=js(n.padding);if(!n.display)return;const d=bv(t.rtl,this.left,this.width),f=this.ctx,o=n.position,y=i.size/2,b=s.top+y;let C,P=this.left,A=this.width;if(this.isHorizontal())A=Math.max(...this.lineWidths),C=this.top+b,P=As(t.align,P,this.right-A);else{const k=this.columnSizes.reduce((B,N)=>Math.max(B,N.height),0);C=b+As(t.align,this.top,this.bottom-k-t.labels.padding-this._computeTitleHeight())}const D=As(o,P,P+A);f.textAlign=d.textAlign(LD(o)),f.textBaseline="middle",f.strokeStyle=n.color,f.fillStyle=n.color,f.font=i.string,Jp(f,n.text,D,C,i)}_computeTitleHeight(){const t=this.options.title,n=rs(t.font),i=js(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,s,d;if(Pd(t,this.left,this.right)&&Pd(n,this.top,this.bottom)){for(d=this.legendHitBoxes,i=0;i<d.length;++i)if(s=d[i],Pd(t,s.left,s.left+s.width)&&Pd(n,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!nxe(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,d=J0e(s,i);s&&!d&&ra(n.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!d&&ra(n.onHover,[t,i,this],this)}else i&&ra(n.onClick,[t,i,this],this)}}function Q0e(e,t,n,i,s){const d=exe(i,e,t,n),f=txe(s,i,t.lineHeight);return{itemWidth:d,itemHeight:f}}function exe(e,t,n,i){let s=e.text;return s&&typeof s!="string"&&(s=s.reduce((d,f)=>d.length>f.length?d:f)),t+n.size/2+i.measureText(s).width}function txe(e,t,n){let i=e;return typeof t.text!="string"&&(i=yW(t,n)),i}function yW(e,t){const n=e.text?e.text.length:0;return t*n}function nxe(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var rxe={id:"legend",_element:O4,start(e,t,n){const i=e.legend=new O4({ctx:e.ctx,options:n,chart:e});ks.configure(e,i,n),ks.addBox(e,i)},stop(e){ks.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;ks.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,s=n.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:s,color:d,useBorderRadius:f,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(y=>{const b=y.controller.getStyle(n?0:void 0),C=js(b.borderWidth);return{text:t[y.index].label,fillStyle:b.backgroundColor,fontColor:d,hidden:!y.visible,lineCap:b.borderCapStyle,lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:(C.width+C.height)/4,strokeStyle:b.borderColor,pointStyle:i||b.pointStyle,rotation:b.rotation,textAlign:s||b.textAlign,borderRadius:f&&(o||b.borderRadius),datasetIndex:y.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class UD extends $d{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const s=ga(i.text)?i.text.length:1;this._padding=js(i.padding);const d=s*rs(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:s,right:d,options:f}=this,o=f.align;let y=0,b,C,P;return this.isHorizontal()?(C=As(o,i,d),P=n+t,b=d-i):(f.position==="left"?(C=i+t,P=As(o,s,n),y=Po*-.5):(C=d-t,P=As(o,n,s),y=Po*.5),b=s-n),{titleX:C,titleY:P,maxWidth:b,rotation:y}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=rs(n.font),d=i.lineHeight/2+this._padding.top,{titleX:f,titleY:o,maxWidth:y,rotation:b}=this._drawArgs(d);Jp(t,n.text,0,0,i,{color:n.color,maxWidth:y,rotation:b,textAlign:LD(n.align),textBaseline:"middle",translation:[f,o]})}}function ixe(e,t){const n=new UD({ctx:e.ctx,options:t,chart:e});ks.configure(e,n,t),ks.addBox(e,n),e.titleBlock=n}var oxe={id:"title",_element:UD,start(e,t,n){ixe(e,n)},stop(e){const t=e.titleBlock;ks.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;ks.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ww=new WeakMap;var axe={id:"subtitle",start(e,t,n){const i=new UD({ctx:e.ctx,options:n,chart:e});ks.configure(e,i,n),ks.addBox(e,i),Ww.set(e,i)},stop(e){ks.removeBox(e,Ww.get(e)),Ww.delete(e)},beforeUpdate(e,t,n){const i=Ww.get(e);ks.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const D0={average(e){if(!e.length)return!1;let t,n,i=new Set,s=0,d=0;for(t=0,n=e.length;t<n;++t){const o=e[t].element;if(o&&o.hasValue()){const y=o.tooltipPosition();i.add(y.x),s+=y.y,++d}}return d===0||i.size===0?!1:{x:[...i].reduce((o,y)=>o+y)/i.size,y:s/d}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,s=Number.POSITIVE_INFINITY,d,f,o;for(d=0,f=e.length;d<f;++d){const y=e[d].element;if(y&&y.hasValue()){const b=y.getCenterPoint(),C=JR(t,b);C<s&&(s=C,o=y)}}if(o){const y=o.tooltipPosition();n=y.x,i=y.y}return{x:n,y:i}}};function Eu(e,t){return t&&(ga(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function bd(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function sxe(e,t){const{element:n,datasetIndex:i,index:s}=t,d=e.getDatasetMeta(i).controller,{label:f,value:o}=d.getLabelAndValue(s);return{chart:e,label:f,parsed:d.getParsed(s),raw:e.data.datasets[i].data[s],formattedValue:o,dataset:d.getDataset(),dataIndex:s,datasetIndex:i,element:n}}function D4(e,t){const n=e.chart.ctx,{body:i,footer:s,title:d}=e,{boxWidth:f,boxHeight:o}=t,y=rs(t.bodyFont),b=rs(t.titleFont),C=rs(t.footerFont),P=d.length,A=s.length,D=i.length,k=js(t.padding);let B=k.height,N=0,j=i.reduce((Y,Z)=>Y+Z.before.length+Z.lines.length+Z.after.length,0);if(j+=e.beforeBody.length+e.afterBody.length,P&&(B+=P*b.lineHeight+(P-1)*t.titleSpacing+t.titleMarginBottom),j){const Y=t.displayColors?Math.max(o,y.lineHeight):y.lineHeight;B+=D*Y+(j-D)*y.lineHeight+(j-1)*t.bodySpacing}A&&(B+=t.footerMarginTop+A*C.lineHeight+(A-1)*t.footerSpacing);let V=0;const K=function(Y){N=Math.max(N,n.measureText(Y).width+V)};return n.save(),n.font=b.string,$o(e.title,K),n.font=y.string,$o(e.beforeBody.concat(e.afterBody),K),V=t.displayColors?f+2+t.boxPadding:0,$o(i,Y=>{$o(Y.before,K),$o(Y.lines,K),$o(Y.after,K)}),V=0,n.font=C.string,$o(e.footer,K),n.restore(),N+=k.width,{width:N,height:B}}function lxe(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function cxe(e,t,n,i){const{x:s,width:d}=i,f=n.caretSize+n.caretPadding;if(e==="left"&&s+d+f>t.width||e==="right"&&s-d-f<0)return!0}function uxe(e,t,n,i){const{x:s,width:d}=n,{width:f,chartArea:{left:o,right:y}}=e;let b="center";return i==="center"?b=s<=(o+y)/2?"left":"right":s<=d/2?b="left":s>=f-d/2&&(b="right"),cxe(b,e,t,n)&&(b="center"),b}function L4(e,t,n){const i=n.yAlign||t.yAlign||lxe(e,n);return{xAlign:n.xAlign||t.xAlign||uxe(e,t,n,i),yAlign:i}}function dxe(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function hxe(e,t,n){let{y:i,height:s}=e;return t==="top"?i+=n:t==="bottom"?i-=s+n:i-=s/2,i}function z4(e,t,n,i){const{caretSize:s,caretPadding:d,cornerRadius:f}=e,{xAlign:o,yAlign:y}=n,b=s+d,{topLeft:C,topRight:P,bottomLeft:A,bottomRight:D}=$p(f);let k=dxe(t,o);const B=hxe(t,y,b);return y==="center"?o==="left"?k+=b:o==="right"&&(k-=b):o==="left"?k-=Math.max(C,A)+s:o==="right"&&(k+=Math.max(P,D)+s),{x:hs(k,0,i.width-t.width),y:hs(B,0,i.height-t.height)}}function qw(e,t,n){const i=js(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function k4(e){return Eu([],bd(e))}function fxe(e,t,n){return Cf(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function F4(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const xW={beforeTitle:_d,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:_d,beforeBody:_d,beforeLabel:_d,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return ro(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:_d,afterBody:_d,beforeFooter:_d,footer:_d,afterFooter:_d};function wl(e,t,n,i){const s=e[t].call(n,i);return typeof s>"u"?xW[t].call(n,i):s}class sA extends $d{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&n.options.animation&&i.animations,d=new QG(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=fxe(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,s=wl(i,"beforeTitle",this,t),d=wl(i,"title",this,t),f=wl(i,"afterTitle",this,t);let o=[];return o=Eu(o,bd(s)),o=Eu(o,bd(d)),o=Eu(o,bd(f)),o}getBeforeBody(t,n){return k4(wl(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:i}=n,s=[];return $o(t,d=>{const f={before:[],lines:[],after:[]},o=F4(i,d);Eu(f.before,bd(wl(o,"beforeLabel",this,d))),Eu(f.lines,wl(o,"label",this,d)),Eu(f.after,bd(wl(o,"afterLabel",this,d))),s.push(f)}),s}getAfterBody(t,n){return k4(wl(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:i}=n,s=wl(i,"beforeFooter",this,t),d=wl(i,"footer",this,t),f=wl(i,"afterFooter",this,t);let o=[];return o=Eu(o,bd(s)),o=Eu(o,bd(d)),o=Eu(o,bd(f)),o}_createItems(t){const n=this._active,i=this.chart.data,s=[],d=[],f=[];let o=[],y,b;for(y=0,b=n.length;y<b;++y)o.push(sxe(this.chart,n[y]));return t.filter&&(o=o.filter((C,P,A)=>t.filter(C,P,A,i))),t.itemSort&&(o=o.sort((C,P)=>t.itemSort(C,P,i))),$o(o,C=>{const P=F4(t.callbacks,C);s.push(wl(P,"labelColor",this,C)),d.push(wl(P,"labelPointStyle",this,C)),f.push(wl(P,"labelTextColor",this,C))}),this.labelColors=s,this.labelPointStyles=d,this.labelTextColors=f,this.dataPoints=o,o}update(t,n){const i=this.options.setContext(this.getContext()),s=this._active;let d,f=[];if(!s.length)this.opacity!==0&&(d={opacity:0});else{const o=D0[i.position].call(this,s,this._eventPosition);f=this._createItems(i),this.title=this.getTitle(f,i),this.beforeBody=this.getBeforeBody(f,i),this.body=this.getBody(f,i),this.afterBody=this.getAfterBody(f,i),this.footer=this.getFooter(f,i);const y=this._size=D4(this,i),b=Object.assign({},o,y),C=L4(this.chart,i,b),P=z4(i,b,C,this.chart);this.xAlign=C.xAlign,this.yAlign=C.yAlign,d={opacity:1,x:P.x,y:P.y,width:y.width,height:y.height,caretX:o.x,caretY:o.y}}this._tooltipItems=f,this.$context=void 0,d&&this._resolveAnimations().update(this,d),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,s){const d=this.getCaretPosition(t,i,s);n.lineTo(d.x1,d.y1),n.lineTo(d.x2,d.y2),n.lineTo(d.x3,d.y3)}getCaretPosition(t,n,i){const{xAlign:s,yAlign:d}=this,{caretSize:f,cornerRadius:o}=i,{topLeft:y,topRight:b,bottomLeft:C,bottomRight:P}=$p(o),{x:A,y:D}=t,{width:k,height:B}=n;let N,j,V,K,Y,Z;return d==="center"?(Y=D+B/2,s==="left"?(N=A,j=N-f,K=Y+f,Z=Y-f):(N=A+k,j=N+f,K=Y-f,Z=Y+f),V=N):(s==="left"?j=A+Math.max(y,C)+f:s==="right"?j=A+k-Math.max(b,P)-f:j=this.caretX,d==="top"?(K=D,Y=K-f,N=j-f,V=j+f):(K=D+B,Y=K+f,N=j+f,V=j-f),Z=K),{x1:N,x2:j,x3:V,y1:K,y2:Y,y3:Z}}drawTitle(t,n,i){const s=this.title,d=s.length;let f,o,y;if(d){const b=bv(i.rtl,this.x,this.width);for(t.x=qw(this,i.titleAlign,i),n.textAlign=b.textAlign(i.titleAlign),n.textBaseline="middle",f=rs(i.titleFont),o=i.titleSpacing,n.fillStyle=i.titleColor,n.font=f.string,y=0;y<d;++y)n.fillText(s[y],b.x(t.x),t.y+f.lineHeight/2),t.y+=f.lineHeight+o,y+1===d&&(t.y+=i.titleMarginBottom-o)}}_drawColorBox(t,n,i,s,d){const f=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:y,boxWidth:b}=d,C=rs(d.bodyFont),P=qw(this,"left",d),A=s.x(P),D=y<C.lineHeight?(C.lineHeight-y)/2:0,k=n.y+D;if(d.usePointStyle){const B={radius:Math.min(b,y)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},N=s.leftForLtr(A,b)+b/2,j=k+y/2;t.strokeStyle=d.multiKeyBackground,t.fillStyle=d.multiKeyBackground,eA(t,B,N,j),t.strokeStyle=f.borderColor,t.fillStyle=f.backgroundColor,eA(t,B,N,j)}else{t.lineWidth=uo(f.borderWidth)?Math.max(...Object.values(f.borderWidth)):f.borderWidth||1,t.strokeStyle=f.borderColor,t.setLineDash(f.borderDash||[]),t.lineDashOffset=f.borderDashOffset||0;const B=s.leftForLtr(A,b),N=s.leftForLtr(s.xPlus(A,1),b-2),j=$p(f.borderRadius);Object.values(j).some(V=>V!==0)?(t.beginPath(),t.fillStyle=d.multiKeyBackground,Vx(t,{x:B,y:k,w:b,h:y,radius:j}),t.fill(),t.stroke(),t.fillStyle=f.backgroundColor,t.beginPath(),Vx(t,{x:N,y:k+1,w:b-2,h:y-2,radius:j}),t.fill()):(t.fillStyle=d.multiKeyBackground,t.fillRect(B,k,b,y),t.strokeRect(B,k,b,y),t.fillStyle=f.backgroundColor,t.fillRect(N,k+1,b-2,y-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:s}=this,{bodySpacing:d,bodyAlign:f,displayColors:o,boxHeight:y,boxWidth:b,boxPadding:C}=i,P=rs(i.bodyFont);let A=P.lineHeight,D=0;const k=bv(i.rtl,this.x,this.width),B=function(se){n.fillText(se,k.x(t.x+D),t.y+A/2),t.y+=A+d},N=k.textAlign(f);let j,V,K,Y,Z,te,ne;for(n.textAlign=f,n.textBaseline="middle",n.font=P.string,t.x=qw(this,N,i),n.fillStyle=i.bodyColor,$o(this.beforeBody,B),D=o&&N!=="right"?f==="center"?b/2+C:b+2+C:0,Y=0,te=s.length;Y<te;++Y){for(j=s[Y],V=this.labelTextColors[Y],n.fillStyle=V,$o(j.before,B),K=j.lines,o&&K.length&&(this._drawColorBox(n,t,Y,k,i),A=Math.max(P.lineHeight,y)),Z=0,ne=K.length;Z<ne;++Z)B(K[Z]),A=P.lineHeight;$o(j.after,B)}D=0,A=P.lineHeight,$o(this.afterBody,B),t.y-=d}drawFooter(t,n,i){const s=this.footer,d=s.length;let f,o;if(d){const y=bv(i.rtl,this.x,this.width);for(t.x=qw(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=y.textAlign(i.footerAlign),n.textBaseline="middle",f=rs(i.footerFont),n.fillStyle=i.footerColor,n.font=f.string,o=0;o<d;++o)n.fillText(s[o],y.x(t.x),t.y+f.lineHeight/2),t.y+=f.lineHeight+i.footerSpacing}}drawBackground(t,n,i,s){const{xAlign:d,yAlign:f}=this,{x:o,y}=t,{width:b,height:C}=i,{topLeft:P,topRight:A,bottomLeft:D,bottomRight:k}=$p(s.cornerRadius);n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.beginPath(),n.moveTo(o+P,y),f==="top"&&this.drawCaret(t,n,i,s),n.lineTo(o+b-A,y),n.quadraticCurveTo(o+b,y,o+b,y+A),f==="center"&&d==="right"&&this.drawCaret(t,n,i,s),n.lineTo(o+b,y+C-k),n.quadraticCurveTo(o+b,y+C,o+b-k,y+C),f==="bottom"&&this.drawCaret(t,n,i,s),n.lineTo(o+D,y+C),n.quadraticCurveTo(o,y+C,o,y+C-D),f==="center"&&d==="left"&&this.drawCaret(t,n,i,s),n.lineTo(o,y+P),n.quadraticCurveTo(o,y,o+P,y),n.closePath(),n.fill(),s.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,s=i&&i.x,d=i&&i.y;if(s||d){const f=D0[t.position].call(this,this._active,this._eventPosition);if(!f)return;const o=this._size=D4(this,t),y=Object.assign({},f,this._size),b=L4(n,t,y),C=z4(t,y,b,n);(s._to!==C.x||d._to!==C.y)&&(this.xAlign=b.xAlign,this.yAlign=b.yAlign,this.width=o.width,this.height=o.height,this.caretX=f.x,this.caretY=f.y,this._resolveAnimations().update(this,C))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const s={width:this.width,height:this.height},d={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const f=js(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(t.save(),t.globalAlpha=i,this.drawBackground(d,t,s,n),qG(t,n.textDirection),d.y+=f.top,this.drawTitle(d,t,n),this.drawBody(d,t,n),this.drawFooter(d,t,n),KG(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,s=t.map(({datasetIndex:o,index:y})=>{const b=this.chart.getDatasetMeta(o);if(!b)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:b.data[y],index:y}}),d=!xC(i,s),f=this._positionChanged(s,n);(d||f)&&(this._active=s,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,d=this._active||[],f=this._getActiveElements(t,d,n,i),o=this._positionChanged(f,t),y=n||!xC(f,d)||o;return y&&(this._active=f,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),y}_getActiveElements(t,n,i,s){const d=this.options;if(t.type==="mouseout")return[];if(!s)return n.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const f=this.chart.getElementsAtEventForMode(t,d.mode,d,i);return d.reverse&&f.reverse(),f}_positionChanged(t,n){const{caretX:i,caretY:s,options:d}=this,f=D0[d.position].call(this,t,n);return f!==!1&&(i!==f.x||s!==f.y)}}Er(sA,"positioners",D0);var pxe={id:"tooltip",_element:sA,positioners:D0,afterInit(e,t,n){n&&(e.tooltip=new sA({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:xW},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},mxe=Object.freeze({__proto__:null,Colors:I0e,Decimation:A0e,Filler:Y0e,Legend:rxe,SubTitle:axe,Title:oxe,Tooltip:pxe});const gxe=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function vxe(e,t,n,i){const s=e.indexOf(t);if(s===-1)return gxe(e,t,n,i);const d=e.lastIndexOf(t);return s!==d?n:s}const _xe=(e,t)=>e===null?null:hs(Math.round(e),0,t);function N4(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class lA extends lm{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:s,label:d}of n)i[s]===d&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(ro(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:vxe(i,t,Bi(n,t),this._addedLabels),_xe(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,s=[];let d=this.getLabels();d=t===0&&n===d.length-1?d:d.slice(t,n+1),this._valueRange=Math.max(d.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let f=t;f<=n;f++)s.push({value:f});return s}getLabelForValue(t){return N4.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Er(lA,"id","category"),Er(lA,"defaults",{ticks:{callback:N4}});function yxe(e,t){const n=[],{bounds:s,step:d,min:f,max:o,precision:y,count:b,maxTicks:C,maxDigits:P,includeBounds:A}=e,D=d||1,k=C-1,{min:B,max:N}=t,j=!ro(f),V=!ro(o),K=!ro(b),Y=(N-B)/(P+1);let Z=D5((N-B)/k/D)*D,te,ne,se,ee;if(Z<1e-14&&!j&&!V)return[{value:B},{value:N}];ee=Math.ceil(N/Z)-Math.floor(B/Z),ee>k&&(Z=D5(ee*Z/k/D)*D),ro(y)||(te=Math.pow(10,y),Z=Math.ceil(Z*te)/te),s==="ticks"?(ne=Math.floor(B/Z)*Z,se=Math.ceil(N/Z)*Z):(ne=B,se=N),j&&V&&d&&dve((o-f)/d,Z/1e3)?(ee=Math.round(Math.min((o-f)/Z,C)),Z=(o-f)/ee,ne=f,se=o):K?(ne=j?f:ne,se=V?o:se,ee=b-1,Z=(se-ne)/ee):(ee=(se-ne)/Z,Z0(ee,Math.round(ee),Z/1e3)?ee=Math.round(ee):ee=Math.ceil(ee));const de=Math.max(L5(Z),L5(ne));te=Math.pow(10,ro(y)?de:y),ne=Math.round(ne*te)/te,se=Math.round(se*te)/te;let fe=0;for(j&&(A&&ne!==f?(n.push({value:f}),ne<f&&fe++,Z0(Math.round((ne+fe*Z)*te)/te,f,B4(f,Y,e))&&fe++):ne<f&&fe++);fe<ee;++fe){const ye=Math.round((ne+fe*Z)*te)/te;if(V&&ye>o)break;n.push({value:ye})}return V&&A&&se!==o?n.length&&Z0(n[n.length-1].value,o,B4(o,Y,e))?n[n.length-1].value=o:n.push({value:o}):(!V||se===o)&&n.push({value:se}),n}function B4(e,t,{horizontal:n,minRotation:i}){const s=Hc(i),d=(n?Math.sin(s):Math.cos(s))||.001,f=.75*t*(""+e).length;return Math.min(t/d,f)}class IC extends lm{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return ro(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:s,max:d}=this;const f=y=>s=n?s:y,o=y=>d=i?d:y;if(t){const y=zu(s),b=zu(d);y<0&&b<0?o(0):y>0&&b>0&&f(0)}if(s===d){let y=d===0?1:Math.abs(d*.05);o(d+y),t||f(s-y)}this.min=s,this.max=d}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),n=n||11),n&&(s=Math.min(n,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},d=this._range||this,f=yxe(s,d);return t.bounds==="ticks"&&RG(f,this,"value"),t.reverse?(f.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),f}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-n)/Math.max(t.length-1,1)/2;n-=s,i+=s}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return mb(t,this.chart.options.locale,this.options.ticks.format)}}class cA extends IC{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=La(t)?t:0,this.max=La(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=Hc(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,d.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Er(cA,"id","linear"),Er(cA,"defaults",{ticks:{callback:UE.formatters.numeric}});const Hx=e=>Math.floor(Kh(e)),Sp=(e,t)=>Math.pow(10,Hx(e)+t);function $4(e){return e/Math.pow(10,Hx(e))===1}function j4(e,t,n){const i=Math.pow(10,n),s=Math.floor(e/i);return Math.ceil(t/i)-s}function xxe(e,t){const n=t-e;let i=Hx(n);for(;j4(e,t,i)>10;)i++;for(;j4(e,t,i)<10;)i--;return Math.min(i,Hx(e))}function bxe(e,{min:t,max:n}){t=$l(e.min,t);const i=[],s=Hx(t);let d=xxe(t,n),f=d<0?Math.pow(10,Math.abs(d)):1;const o=Math.pow(10,d),y=s>d?Math.pow(10,s):0,b=Math.round((t-y)*f)/f,C=Math.floor((t-y)/o/10)*o*10;let P=Math.floor((b-C)/Math.pow(10,d)),A=$l(e.min,Math.round((y+C+P*Math.pow(10,d))*f)/f);for(;A<n;)i.push({value:A,major:$4(A),significand:P}),P>=10?P=P<15?15:20:P++,P>=20&&(d++,P=2,f=d>=0?1:f),A=Math.round((y+C+P*Math.pow(10,d))*f)/f;const D=$l(e.max,A);return i.push({value:D,major:$4(D),significand:P}),i}class uA extends lm{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=IC.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return La(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=La(t)?Math.max(0,t):null,this.max=La(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!La(this._userMin)&&(this.min=t===Sp(this.min,0)?Sp(this.min,-1):Sp(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,s=this.max;const d=o=>i=t?i:o,f=o=>s=n?s:o;i===s&&(i<=0?(d(1),f(10)):(d(Sp(i,-1)),f(Sp(s,1)))),i<=0&&d(Sp(s,-1)),s<=0&&f(Sp(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=bxe(n,this);return t.bounds==="ticks"&&RG(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":mb(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Kh(t),this._valueRange=Kh(this.max)-Kh(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Kh(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}Er(uA,"id","logarithmic"),Er(uA,"defaults",{ticks:{callback:UE.formatters.logarithmic,major:{enabled:!0}}});function dA(e){const t=e.ticks;if(t.display&&e.display){const n=js(t.backdropPadding);return Bi(t.font&&t.font.size,_a.font.size)+n.height}return 0}function wxe(e,t,n){return n=ga(n)?n:[n],{w:Pve(e,t.string,n),h:n.length*t.lineHeight}}function V4(e,t,n,i,s){return e===i||e===s?{start:t-n/2,end:t+n/2}:e<i||e>s?{start:t-n,end:t}:{start:t,end:t+n}}function Sxe(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],s=[],d=e._pointLabels.length,f=e.options.pointLabels,o=f.centerPointLabels?Po/d:0;for(let y=0;y<d;y++){const b=f.setContext(e.getPointLabelContext(y));s[y]=b.padding;const C=e.getPointPosition(y,e.drawingArea+s[y],o),P=rs(b.font),A=wxe(e.ctx,P,e._pointLabels[y]);i[y]=A;const D=Ls(e.getIndexAngle(y)+o),k=Math.round(OD(D)),B=V4(k,C.x,A.w,0,180),N=V4(k,C.y,A.h,90,270);Cxe(n,t,D,B,N)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=Ixe(e,i,s)}function Cxe(e,t,n,i,s){const d=Math.abs(Math.sin(n)),f=Math.abs(Math.cos(n));let o=0,y=0;i.start<t.l?(o=(t.l-i.start)/d,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/d,e.r=Math.max(e.r,t.r+o)),s.start<t.t?(y=(t.t-s.start)/f,e.t=Math.min(e.t,t.t-y)):s.end>t.b&&(y=(s.end-t.b)/f,e.b=Math.max(e.b,t.b+y))}function Exe(e,t,n){const i=e.drawingArea,{extra:s,additionalAngle:d,padding:f,size:o}=n,y=e.getPointPosition(t,i+s+f,d),b=Math.round(OD(Ls(y.angle+$a))),C=Rxe(y.y,o.h,b),P=Pxe(b),A=Mxe(y.x,o.w,P);return{visible:!0,x:y.x,y:C,textAlign:P,left:A,top:C,right:A+o.w,bottom:C+o.h}}function Txe(e,t){if(!t)return!0;const{left:n,top:i,right:s,bottom:d}=e;return!(Rd({x:n,y:i},t)||Rd({x:n,y:d},t)||Rd({x:s,y:i},t)||Rd({x:s,y:d},t))}function Ixe(e,t,n){const i=[],s=e._pointLabels.length,d=e.options,{centerPointLabels:f,display:o}=d.pointLabels,y={extra:dA(d)/2,additionalAngle:f?Po/s:0};let b;for(let C=0;C<s;C++){y.padding=n[C],y.size=t[C];const P=Exe(e,C,y);i.push(P),o==="auto"&&(P.visible=Txe(P,b),P.visible&&(b=P))}return i}function Pxe(e){return e===0||e===180?"center":e<180?"left":"right"}function Mxe(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function Rxe(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function Axe(e,t,n){const{left:i,top:s,right:d,bottom:f}=n,{backdropColor:o}=t;if(!ro(o)){const y=$p(t.borderRadius),b=js(t.backdropPadding);e.fillStyle=o;const C=i-b.left,P=s-b.top,A=d-i+b.width,D=f-s+b.height;Object.values(y).some(k=>k!==0)?(e.beginPath(),Vx(e,{x:C,y:P,w:A,h:D,radius:y}),e.fill()):e.fillRect(C,P,A,D)}}function Oxe(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let s=t-1;s>=0;s--){const d=e._pointLabelItems[s];if(!d.visible)continue;const f=i.setContext(e.getPointLabelContext(s));Axe(n,f,d);const o=rs(f.font),{x:y,y:b,textAlign:C}=d;Jp(n,e._pointLabels[s],y,b+o.lineHeight/2,o,{color:f.color,textAlign:C,textBaseline:"middle"})}}function bW(e,t,n,i){const{ctx:s}=e;if(n)s.arc(e.xCenter,e.yCenter,t,0,ha);else{let d=e.getPointPosition(0,t);s.moveTo(d.x,d.y);for(let f=1;f<i;f++)d=e.getPointPosition(f,t),s.lineTo(d.x,d.y)}}function Dxe(e,t,n,i,s){const d=e.ctx,f=t.circular,{color:o,lineWidth:y}=t;!f&&!i||!o||!y||n<0||(d.save(),d.strokeStyle=o,d.lineWidth=y,d.setLineDash(s.dash||[]),d.lineDashOffset=s.dashOffset,d.beginPath(),bW(e,n,f,i),d.closePath(),d.stroke(),d.restore())}function Lxe(e,t,n){return Cf(e,{label:n,index:t,type:"pointLabel"})}class L0 extends IC{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=js(dA(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=La(t)&&!isNaN(t)?t:0,this.max=La(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/dA(this.options))}generateTickLabels(t){IC.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const s=ra(this.options.pointLabels.callback,[n,i],this);return s||s===0?s:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?Sxe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,s){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,s))}getIndexAngle(t){const n=ha/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ls(t*n+Hc(i))}getDistanceFromCenterForValue(t){if(ro(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(ro(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return Lxe(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const s=this.getIndexAngle(t)-$a+i;return{x:Math.cos(s)*n+this.xCenter,y:Math.sin(s)*n+this.yCenter,angle:s}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:s,bottom:d}=this._pointLabelItems[t];return{left:n,top:i,right:s,bottom:d}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),bW(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:s,border:d}=n,f=this._pointLabels.length;let o,y,b;if(n.pointLabels.display&&Oxe(this,f),s.display&&this.ticks.forEach((C,P)=>{if(P!==0||P===0&&this.min<0){y=this.getDistanceFromCenterForValue(C.value);const A=this.getContext(P),D=s.setContext(A),k=d.setContext(A);Dxe(this,D,y,f,k)}}),i.display){for(t.save(),o=f-1;o>=0;o--){const C=i.setContext(this.getPointLabelContext(o)),{color:P,lineWidth:A}=C;!A||!P||(t.lineWidth=A,t.strokeStyle=P,t.setLineDash(C.borderDash),t.lineDashOffset=C.borderDashOffset,y=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),b=this.getPointPosition(o,y),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(b.x,b.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let d,f;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,y)=>{if(y===0&&this.min>=0&&!n.reverse)return;const b=i.setContext(this.getContext(y)),C=rs(b.font);if(d=this.getDistanceFromCenterForValue(this.ticks[y].value),b.showLabelBackdrop){t.font=C.string,f=t.measureText(o.label).width,t.fillStyle=b.backdropColor;const P=js(b.backdropPadding);t.fillRect(-f/2-P.left,-d-C.size/2-P.top,f+P.width,C.size+P.height)}Jp(t,o.label,0,-d,C,{color:b.color,strokeColor:b.textStrokeColor,strokeWidth:b.textStrokeWidth})}),t.restore()}drawTitle(){}}Er(L0,"id","radialLinear"),Er(L0,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:UE.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),Er(L0,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Er(L0,"descriptors",{angleLines:{_fallback:"grid"}});const XE={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Pl=Object.keys(XE);function U4(e,t){return e-t}function H4(e,t){if(ro(t))return null;const n=e._adapter,{parser:i,round:s,isoWeekday:d}=e._parseOpts;let f=t;return typeof i=="function"&&(f=i(f)),La(f)||(f=typeof i=="string"?n.parse(f,i):n.parse(f)),f===null?null:(s&&(f=s==="week"&&(Nv(d)||d===!0)?n.startOf(f,"isoWeek",d):n.startOf(f,s)),+f)}function G4(e,t,n,i){const s=Pl.length;for(let d=Pl.indexOf(e);d<s-1;++d){const f=XE[Pl[d]],o=f.steps?f.steps:Number.MAX_SAFE_INTEGER;if(f.common&&Math.ceil((n-t)/(o*f.size))<=i)return Pl[d]}return Pl[s-1]}function zxe(e,t,n,i,s){for(let d=Pl.length-1;d>=Pl.indexOf(n);d--){const f=Pl[d];if(XE[f].common&&e._adapter.diff(s,i,f)>=t-1)return f}return Pl[n?Pl.indexOf(n):0]}function kxe(e){for(let t=Pl.indexOf(e)+1,n=Pl.length;t<n;++t)if(XE[Pl[t]].common)return Pl[t]}function W4(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:s}=DD(n,t),d=n[i]>=t?n[i]:n[s];e[d]=!0}}function Fxe(e,t,n,i){const s=e._adapter,d=+s.startOf(t[0].value,i),f=t[t.length-1].value;let o,y;for(o=d;o<=f;o=+s.add(o,1,i))y=n[o],y>=0&&(t[y].major=!0);return t}function q4(e,t,n){const i=[],s={},d=t.length;let f,o;for(f=0;f<d;++f)o=t[f],s[o]=f,i.push({value:o,major:!1});return d===0||!n?i:Fxe(e,i,s,n)}class Gx extends lm{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const i=t.time||(t.time={}),s=this._adapter=new G_e._date(t.adapters.date);s.init(n),X0(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:H4(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:s,max:d,minDefined:f,maxDefined:o}=this.getUserBounds();function y(b){!f&&!isNaN(b.min)&&(s=Math.min(s,b.min)),!o&&!isNaN(b.max)&&(d=Math.max(d,b.max))}(!f||!o)&&(y(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&y(this.getMinMax(!1))),s=La(s)&&!isNaN(s)?s:+n.startOf(Date.now(),i),d=La(d)&&!isNaN(d)?d:+n.endOf(Date.now(),i)+1,this.min=Math.min(s,d-1),this.max=Math.max(s+1,d)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const d=this.min,f=this.max,o=mve(s,d,f);return this._unit=n.unit||(i.autoSkip?G4(n.minUnit,this.min,this.max,this._getLabelCapacity(d)):zxe(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:kxe(this._unit),this.initOffsets(s),t.reverse&&o.reverse(),q4(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,i=0,s,d;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?n=1-s:n=(this.getDecimalForValue(t[1])-s)/2,d=this.getDecimalForValue(t[t.length-1]),t.length===1?i=d:i=(d-this.getDecimalForValue(t[t.length-2]))/2);const f=t.length<3?.5:.25;n=hs(n,0,f),i=hs(i,0,f),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,s=this.options,d=s.time,f=d.unit||G4(d.minUnit,n,i,this._getLabelCapacity(n)),o=Bi(s.ticks.stepSize,1),y=f==="week"?d.isoWeekday:!1,b=Nv(y)||y===!0,C={};let P=n,A,D;if(b&&(P=+t.startOf(P,"isoWeek",y)),P=+t.startOf(P,b?"day":f),t.diff(i,n,f)>1e5*o)throw new Error(n+" and "+i+" are too far apart with stepSize of "+o+" "+f);const k=s.ticks.source==="data"&&this.getDataTimestamps();for(A=P,D=0;A<i;A=+t.add(A,o,f),D++)W4(C,A,k);return(A===i||s.bounds==="ticks"||D===1)&&W4(C,A,k),Object.keys(C).sort(U4).map(B=>+B)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}format(t,n){const s=this.options.time.displayFormats,d=this._unit,f=n||s[d];return this._adapter.format(t,f)}_tickFormatFunction(t,n,i,s){const d=this.options,f=d.ticks.callback;if(f)return ra(f,[t,n,i],this);const o=d.time.displayFormats,y=this._unit,b=this._majorUnit,C=y&&o[y],P=b&&o[b],A=i[n],D=b&&P&&A&&A.major;return this._adapter.format(t,s||(D?P:C))}generateTickLabels(t){let n,i,s;for(n=0,i=t.length;n<i;++n)s=t[n],s.label=this._tickFormatFunction(s.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,s=Hc(this.isHorizontal()?n.maxRotation:n.minRotation),d=Math.cos(s),f=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:i*d+o*f,h:i*f+o*d}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,s=i[n.unit]||i.millisecond,d=this._tickFormatFunction(t,0,q4(this,[t],this._majorUnit),s),f=this._getLabelSize(d),o=Math.floor(this.isHorizontal()?this.width/f.w:this.height/f.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(n=0,i=s.length;n<i;++n)t=t.concat(s[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const s=this.getLabels();for(n=0,i=s.length;n<i;++n)t.push(H4(this,s[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return DG(t.sort(U4))}}Er(Gx,"id","time"),Er(Gx,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Kw(e,t,n){let i=0,s=e.length-1,d,f,o,y;n?(t>=e[i].pos&&t<=e[s].pos&&({lo:i,hi:s}=Md(e,"pos",t)),{pos:d,time:o}=e[i],{pos:f,time:y}=e[s]):(t>=e[i].time&&t<=e[s].time&&({lo:i,hi:s}=Md(e,"time",t)),{time:d,pos:o}=e[i],{time:f,pos:y}=e[s]);const b=f-d;return b?o+(y-o)*(t-d)/b:o}class hA extends Gx{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Kw(n,this.min),this._tableRange=Kw(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,s=[],d=[];let f,o,y,b,C;for(f=0,o=t.length;f<o;++f)b=t[f],b>=n&&b<=i&&s.push(b);if(s.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(f=0,o=s.length;f<o;++f)C=s[f+1],y=s[f-1],b=s[f],Math.round((C+y)/2)!==b&&d.push({time:b,pos:f/(o-1)});return d}_generate(){const t=this.min,n=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(n)||i.length===1)&&i.push(n),i.sort((s,d)=>s-d)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Kw(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return Kw(this._table,i*this._tableRange+this._minPos,!0)}}Er(hA,"id","timeseries"),Er(hA,"defaults",Gx.defaults);var Nxe=Object.freeze({__proto__:null,CategoryScale:lA,LinearScale:cA,LogarithmicScale:uA,RadialLinearScale:L0,TimeScale:Gx,TimeSeriesScale:hA});const Bxe=[H_e,x0e,mxe,Nxe];Mu.register(...Bxe);const wW=e=>e-273.15;al.accessToken="pk.eyJ1IjoibmdvY3R0ZCIsImEiOiJjbWJibmlod3MwMmluMnFyMG1xMWt0dTdrIn0.ok5SgmXGrHFLeMPf-OG5_w";const qg=new Intl.NumberFormat("vi-VN",{maximumFractionDigits:2}),$xe=()=>{const e=Array.from({length:30},(o,y)=>{const b=new Date;return b.setDate(b.getDate()-(29-y)),b}),t=e.map(()=>.55+Math.random()*.35),n=t.map(o=>Math.max(0,o-(.08+Math.random()*.05))),i=t.map(o=>Math.max(0,.35+Math.random()*.15-(o-.5)*.2)),s=Array.from({length:7},(o,y)=>{const b=new Date;return b.setDate(b.getDate()-(6-y)),b}),d=s.map(()=>Math.round(Math.random()*25)),f=s.map(()=>8+Math.round(Math.random()*4));return{days:e,ndvi:t,evi:n,ndwi:i,last7:s,rain7:d,sun7:f,yieldAvg:1.8+Math.random()*.8,weatherCaps:[" Nng nh"," t my"," C ma ro"," Ma va"," Nng gin on"],logs:[{key:"1",date:"-3",place:"Yn M",action:"Ti nc",cost:15e4},{key:"2",date:"-2",place:"Tam ip",action:"Phun thuc su",cost:2e5},{key:"3",date:"-1",place:"Nho Quan",action:"Bn phn",cost:32e4},{key:"4",date:"Hm nay",place:"Gia Vin",action:"Thu hi",cost:0}],audits:[{key:"1",ts:"-2h",user:"manager01",action:"DUYT KHUYN CO",detail:"AOI_2025_10_21_01"},{key:"2",ts:"-1h",user:"manager01",action:"TO AOI",detail:"AOI_2025_10_23_02"},{key:"3",ts:"-10m",user:"analyst",action:"CP NHT LP RI RO",detail:"risk-heat v0.2"}]}},jxe=()=>{var at;const e=I.useRef(null),t=I.useRef(null),n=I.useRef(null),[i]=I.useState($xe()),[s,d]=I.useState(29),[f,o]=I.useState(!1),[y,b]=I.useState([]),[C,P]=I.useState({"tea-regions":!0,"tea-plots":!0,"risk-heat":!0,events:!0}),A=I.useRef(null),D=I.useRef(null),k=I.useRef(null),B=I.useRef(null);I.useEffect(()=>{if(t.current){const Ke=t.current.getContext("2d");k.current=new Mu(Ke,{type:"line",data:{labels:i.days.map(tt=>tt.toLocaleDateString("vi-VN")),datasets:[{label:"NDVI",data:i.ndvi,borderColor:"#059669",tension:.3},{label:"EVI",data:i.evi,borderColor:"#10b981",tension:.3},{label:"NDWI",data:i.ndwi,borderColor:"#06b6d4",tension:.3}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:tt=>`${tt.dataset.label}: ${qg.format(tt.parsed.y)}`}}},scales:{y:{beginAtZero:!0,max:1.2}}}})}return()=>{var Ke,tt;(Ke=k.current)==null||Ke.destroy(),(tt=B.current)==null||tt.destroy()}},[i]),I.useEffect(()=>{if(!e.current)return;const Ke=new al.Map({container:e.current,style:"mapbox://styles/mapbox/outdoors-v12",center:[106,20.25],zoom:10.5,pitch:30,bearing:-20});A.current=Ke,Ke.addControl(new al.NavigationControl,"top-right"),Ke.addControl(new al.ScaleControl({maxWidth:120,unit:"metric"}));const tt=new VE({displayControlsDefault:!1,controls:{polygon:!0,trash:!0},defaultMode:"simple_select"});Ke.addControl(tt,"top-left"),D.current=tt;const vt={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Vng ch A",risk:.3},geometry:{type:"Polygon",coordinates:[[[105.95,20.25],[106.02,20.25],[106.02,20.3],[105.95,20.3],[105.95,20.25]]]}}]};return Ke.on("load",()=>{Ke.addSource("tea-regions",{type:"geojson",data:vt}),Ke.addLayer({id:"tea-regions",type:"fill",source:"tea-regions",paint:{"fill-color":["interpolate",["linear"],["get","risk"],0,"#93c5fd",.5,"#fbbf24",1,"#ef4444"],"fill-opacity":.35}})}),()=>{Ke.remove()}},[]);const N=Ke=>{var tt;if(d(Ke),(tt=A.current)!=null&&tt.getLayer("risk-heat")){const vt=.6+Ke/29*.8;A.current.setPaintProperty("risk-heat","heatmap-intensity",vt)}},j=()=>{var tt,vt;const Ke=!f;o(Ke),Ke?(tt=D.current)==null||tt.changeMode("draw_polygon"):(vt=D.current)==null||vt.changeMode("simple_select")},V=()=>{var ft;const Ke=(ft=D.current)==null?void 0:ft.getAll();if(!(Ke!=null&&Ke.features.length)){alert("Cha c AOI no c v.");return}const tt=Ke.features[Ke.features.length-1],Pt={id:"AOI_"+new Date().toISOString().replace(/[-:.TZ]/g,"").slice(0,14),date:new Date().toLocaleString("vi-VN"),status:" gi",coords:tt.geometry.coordinates[0].slice(0,3).map(Nt=>Nt.map(Rt=>Rt.toFixed(4)).join(","))};b(Nt=>[Pt,...Nt]),alert(" gi khuyn co (FCM demo).")},K=()=>{const tt=[["Ngy","X/Huyn","Hot ng","Chi ph"]].concat(i.logs.map(Nt=>[Nt.date,Nt.place,Nt.action,Nt.cost])).map(Nt=>Nt.map(Rt=>'"'+String(Rt).replaceAll('"','""')+'"').join(",")).join(`
`),vt=new Blob([tt],{type:"text/csv;charset=utf-8;"}),Pt=URL.createObjectURL(vt),ft=document.createElement("a");ft.href=Pt,ft.download="nhat-ky-nong-ho.csv",ft.click(),URL.revokeObjectURL(Pt)},Y=()=>{const{jsPDF:Ke}=window.jspdf,tt=new Ke({unit:"pt",format:"a4"});tt.setFontSize(14),tt.text("Bo co tng hp nht k nng h",40,40),tt.setFontSize(10);let vt=70;i.logs.forEach(Pt=>{tt.text(`${Pt.date} | ${Pt.place} | ${Pt.action} | ${qg.format(Pt.cost)} `,40,vt),vt+=18,vt>780&&(tt.addPage(),vt=40)}),tt.save("bao-cao-nhat-ky.pdf")},Z=(Ke,tt)=>{var vt;P(Pt=>({...Pt,[Ke]:tt})),(vt=A.current)!=null&&vt.getLayer(Ke)&&A.current.setLayoutProperty(Ke,"visibility",tt?"visible":"none")},te=Ke=>Ke.reduce((tt,vt)=>tt+vt,0)/Ke.length,ne=te(i.ndvi),se=te(i.ndwi),ee=te(i.evi),de=[{title:"Thi gian",dataIndex:"ts",key:"ts"},{title:"Ngi dng",dataIndex:"user",key:"user"},{title:"Hnh ng",dataIndex:"action",key:"action"},{title:"Chi tit",dataIndex:"detail",key:"detail"}],[fe,ye]=I.useState([]),[ge,we]=I.useState({}),[Se,xe]=I.useState(""),[Te,ze]=I.useState(0),[Ue,We]=I.useState([]),Be=async()=>{try{const Ke=await fetch("https://api.openweathermap.org/data/2.5/forecast?lat=21.0245&lon=105.8412&appid=723262eea804eb2695383fc4d482da35");if(!Ke.ok)throw new Error(`HTTP error! status: ${Ke.status}`);const tt=await Ke.json();console.log("data",tt),ye(tt.list)}catch(Ke){console.log("Error:",Ke)}},Xe=async()=>{try{const Ke=await fetch("https://api.openweathermap.org/data/2.5/weather?q=Hanoi&appid=723262eea804eb2695383fc4d482da35");if(!Ke.ok)throw new Error(`HTTP error! status: ${Ke.status}`);const tt=await Ke.json();console.log("data",tt),we(tt)}catch(Ke){console.log("Error:",Ke)}},qe=async()=>{fetch("http://103.163.119.247:33612/nhatky").then(Ke=>{if(!Ke.ok)throw new Error("Network response was not ok");return Ke.json()}).then(Ke=>{Ke.success&&We(Ke.data)}).catch(Ke=>{console.log("error",Ke)})};return I.useEffect(()=>{Be(),Xe(),qe()},[]),I.useEffect(()=>{if(n.current){B.current&&B.current.destroy();const vt=Array.from({length:7},(Rt,pt)=>{const yt=new Date;return yt.setDate(yt.getDate()-(6-pt)),yt.toLocaleDateString("vi-VN")}),Pt=fe.map(Rt=>wW(Rt.main.temp)),ft=fe.map(Rt=>{var pt;return((pt=Rt==null?void 0:Rt.rain)==null?void 0:pt["3h"])||0}),Nt=n.current.getContext("2d");B.current=new Mu(Nt,{type:"bar",data:{labels:vt,datasets:[{label:"Nhit  (C)",data:Pt,backgroundColor:"#f59e0b"},{label:"Lng ma (mm)",data:ft,backgroundColor:"#3b82f6"}]},options:{responsive:!0,scales:{y:{beginAtZero:!0}}}})}const tt=fe.slice(0,7).reduce((vt,Pt)=>{var Nt;return vt+(((Nt=Pt==null?void 0:Pt.rain)==null?void 0:Nt["3h"])||0)},0);ze(tt)},[fe]),I.useEffect(()=>{var tt,vt;const Ke=(vt=(tt=ge==null?void 0:ge.weather)==null?void 0:tt[0])==null?void 0:vt.main;if(Ke)switch(Ke){case"Clear":xe(" Tri nng");break;case"Clouds":xe(" Nhiu my");break;case"Rain":xe(" Ma");break;case"Drizzle":xe(" Ma phn");break;case"Thunderstorm":xe(" Ging bo");break;case"Snow":xe(" Tuyt");break;case"Mist":xe(" Sng m");break;case"Smoke":xe(" Khi");break;case"Haze":xe(" M nh");break;case"Dust":xe(" Bi");break;case"Fog":xe(" Sng m dy");break;case"Sand":xe(" Bo ct");break;case"Ash":xe(" Tro ni la");break;case"Squall":xe(" Gi git");break;case"Tornado":xe(" Lc xoy");break;default:xe(" Thi tit bnh thng")}},[ge]),Ee.jsxs("div",{className:"manager-dashboard",children:[Ee.jsx("header",{className:"dashboard-header",children:Ee.jsxs("div",{className:"header-content",children:[Ee.jsxs("div",{className:"logo-section",children:[Ee.jsx("div",{className:"logo",children:"Tea"}),Ee.jsxs("div",{children:[Ee.jsx("h1",{children:"Dashboard Nh qun l"}),Ee.jsx("span",{className:"tagline",children:"Gim st vng/l ch  NDVI/EVI/NDWI  Khuyn co AOI  FCM"})]})]}),Ee.jsxs("div",{className:"header-actions",children:[Ee.jsx("div",{className:"weather-info",children:Ee.jsx("span",{children:Se})}),Ee.jsxs("div",{className:"date-info",children:[Ee.jsx("span",{children:"Hm nay:"}),Ee.jsx("strong",{children:new Date().toLocaleDateString("vi-VN")})]}),Ee.jsx(AE,{overlay:Ee.jsx(pf,{children:Ee.jsx(pf.Item,{icon:Ee.jsx(Ume,{}),danger:!0,onClick:()=>{localStorage.clear(),sessionStorage.clear(),window.location.href="/login"},children:"ng xut"},"logout")}),placement:"bottomRight",arrow:!0,children:Ee.jsx("div",{className:"user-avatar",style:{cursor:"pointer"},children:""})})]})]})}),Ee.jsxs("div",{className:"dashboard-content",children:[Ee.jsx("aside",{className:"sidebar",children:Ee.jsxs(Sl,{className:"sidebar-card",children:[Ee.jsx("h3",{children:"Menu"}),Ee.jsxs("nav",{className:"sidebar-nav",children:[Ee.jsx("a",{href:"#mapPanel",children:"Tng quan"}),Ee.jsx("a",{href:"#indicesPanel",children:"Ch s GEE"}),Ee.jsx("a",{href:"#weatherPanel",children:"Thi tit"}),Ee.jsx("a",{href:"#logsPanel",children:"Nht k nng h"}),Ee.jsx("a",{href:"#aoiPanel",children:"Khuyn co (AOI)"}),Ee.jsx("a",{href:"#reportPanel",children:"Bo co & Audit"})]})]})}),Ee.jsxs("main",{className:"main-content",children:[Ee.jsxs("section",{className:"info-cards",children:[Ee.jsxs(Sl,{className:"info-card",children:[Ee.jsx("p",{className:"card-label",children:"NDVI TB"}),Ee.jsx("h3",{className:"card-value text-green-700",children:qg.format(ne)}),Ee.jsx("p",{className:"card-desc",children:""})]}),Ee.jsxs(Sl,{className:"info-card",children:[Ee.jsx("p",{className:"card-label",children:"EVI TB"}),Ee.jsx("h3",{className:"card-value text-emerald-700",children:qg.format(ee)}),Ee.jsx("p",{className:"card-desc",children:"30 ngy"})]}),Ee.jsxs(Sl,{className:"info-card",children:[Ee.jsx("p",{className:"card-label",children:"NDWI TB"}),Ee.jsx("h3",{className:"card-value text-cyan-700",children:qg.format(se)}),Ee.jsx("p",{className:"card-desc",children:" m tn"})]}),Ee.jsxs(Sl,{className:"info-card",children:[Ee.jsx("p",{className:"card-label",children:"Ma 7 ngy"}),Ee.jsx("h3",{className:"card-value text-blue-700",children:Te}),Ee.jsx("p",{className:"card-desc",children:"mm"})]}),Ee.jsxs(Sl,{className:"info-card",children:[Ee.jsx("p",{className:"card-label",children:"Nng sut d bo"}),Ee.jsx("h3",{className:"card-value text-amber-700",children:qg.format(i.yieldAvg)}),Ee.jsx("p",{className:"card-desc",children:"tn/ha"})]})]}),Ee.jsx("section",{id:"mapPanel",className:"map-panel",children:Ee.jsxs(Sl,{children:[Ee.jsxs("div",{className:"card-header",children:[Ee.jsx("h3",{children:"Bn  vng/l ch & lp ri ro"}),Ee.jsxs(mC,{children:[Ee.jsxs("div",{className:"time-slider",children:[Ee.jsx("span",{children:"Thi gian"}),Ee.jsx(Dde,{min:0,max:29,value:s,onChange:N,style:{width:120}}),Ee.jsx("span",{className:"time-label",children:(at=i.days[s])==null?void 0:at.toLocaleDateString("vi-VN")})]}),Ee.jsx(Uc,{type:"primary",icon:Ee.jsx(zme,{}),onClick:j,className:f?"active-draw":"",children:"V AOI"}),Ee.jsx(Uc,{type:"primary",icon:Ee.jsx(Wme,{}),onClick:V,disabled:!f,children:"Gi FCM"})]})]}),Ee.jsx("div",{ref:e,className:"map-container"}),Ee.jsxs("div",{className:"layer-controls",children:[Ee.jsx(Au,{checked:C["tea-regions"],onChange:Ke=>Z("tea-regions",Ke.target.checked),children:"Vng ch"}),Ee.jsx(Au,{checked:C["tea-plots"],onChange:Ke=>Z("tea-plots",Ke.target.checked),children:"L ch"}),Ee.jsx(Au,{checked:C["risk-heat"],onChange:Ke=>Z("risk-heat",Ke.target.checked),children:"Ri ro"}),Ee.jsx(Au,{checked:C.events,onChange:Ke=>Z("events",Ke.target.checked),children:"S kin"})]})]})}),Ee.jsxs("section",{id:"indicesPanel",className:"charts-section",children:[Ee.jsx("div",{className:"chart-main",children:Ee.jsxs(Sl,{children:[Ee.jsxs("div",{className:"card-header",children:[Ee.jsx("h3",{children:"Chui ch s NDVI / EVI / NDWI (30 ngy)"}),Ee.jsx("span",{className:"chart-source",children:"Ngun: GEE (demo d liu gi lp)"})]}),Ee.jsx("canvas",{ref:t,height:"110"})]})}),Ee.jsx("div",{id:"weatherPanel",className:"chart-weather",children:Ee.jsxs(Sl,{children:[Ee.jsx("h3",{children:"Nhit   Lng ma (7 ngy)"}),Ee.jsx("canvas",{ref:n,height:"180"})]})})]}),Ee.jsxs("section",{id:"logsPanel",className:"logs-section",children:[Ee.jsx("div",{className:"logs-table",children:Ee.jsxs(Sl,{children:[Ee.jsxs("div",{className:"card-header",children:[Ee.jsx("h3",{children:"Nht k nng h gn y"}),Ee.jsxs(mC,{children:[Ee.jsx(Uc,{icon:Ee.jsx(m5,{}),onClick:K,children:"Xut CSV"}),Ee.jsx(Uc,{icon:Ee.jsx(m5,{}),onClick:Y,children:"Xut PDF"})]})]}),Ee.jsx(ju,{dataSource:i.logs,columns:Ue,pagination:!1,size:"small"})]})}),Ee.jsx("div",{id:"aoiPanel",className:"aoi-list",children:Ee.jsxs(Sl,{children:[Ee.jsx("h3",{children:"Khuyn co vng (AOI)"}),Ee.jsxs("div",{className:"aoi-items",children:[y.map(Ke=>Ee.jsxs("div",{className:"aoi-item",children:[Ee.jsxs("div",{className:"aoi-info",children:[Ee.jsx("div",{className:"aoi-title",children:Ke.id}),Ee.jsxs("div",{className:"aoi-meta",children:[Ke.date,"  ",Ee.jsx(cG,{color:"green",children:Ke.status})]}),Ee.jsxs("div",{className:"aoi-coords",children:["Mu ta : ",Ke.coords]})]}),Ee.jsx(Uc,{size:"small",icon:Ee.jsx($me,{}),children:"Xem trn bn "})]},Ke.id)),y.length===0&&Ee.jsx("div",{className:"empty-aoi",children:"Cha c khuyn co no"})]})]})})]}),Ee.jsx("section",{id:"reportPanel",className:"audit-section",children:Ee.jsxs(Sl,{children:[Ee.jsx("h3",{children:"Audit Log"}),Ee.jsx(ju,{dataSource:i.audits,columns:de,pagination:!1,size:"small"})]})})]})]})]})};function Vxe(){const[e,t]=I.useState({username:"",password:""}),[n,i]=I.useState(!1),[s,d]=I.useState("");_6(),GC();const f=b=>{const{name:C,value:P}=b.target;t(A=>({...A,[C]:P})),s&&d("")},o=b=>{switch(b){case"NGUOIDUNG":return"/farmer";case"ADMIN":return"/manager";case"NGHIENCUU":return"/researcher";default:return"/"}},y=async b=>{var C;if(b.preventDefault(),i(!0),d(""),!e.username||!e.password){d("Vui lng nhp y  tn ng nhp v mt khu."),i(!1);return}try{const P=await fetch("http://103.163.119.247:33612/dangnhap",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({us:e.username,pa:e.password})});if(!P.ok)throw new Error("Request failed");const A=await P.json();if(A.success){localStorage.setItem("user",JSON.stringify(A));const D=(C=A.data)==null?void 0:C.role;console.log("userRole",D);const k=o(D);console.log("redirectPath",k),window.location.href=k}else d("Ti khon hoc mt khu khng chnh xc.")}catch(P){console.error("Login error:",P),d("Li kt ni. Vui lng th li sau.")}finally{i(!1)}};return Ee.jsx("div",{className:"login-container",children:Ee.jsx("div",{className:"login-background",children:Ee.jsxs("div",{className:"login-card",children:[Ee.jsxs("div",{className:"login-header",children:[Ee.jsx("div",{className:"login-logo",children:Ee.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Ee.jsx("path",{d:"M12 3l9 4.5-9 4.5-9-4.5L12 3z",fill:"#059669"}),Ee.jsx("path",{d:"M21 12l-9 4.5-9-4.5",stroke:"#34d399",strokeWidth:"1.2"}),Ee.jsx("path",{d:"M21 16.5L12 21 3 16.5",stroke:"#a7f3d0",strokeWidth:"1.2"})]})}),Ee.jsxs("div",{className:"login-title",children:[Ee.jsx("h1",{children:"ng nhp"}),Ee.jsx("p",{children:"H thng gim st sinh trng ch"})]})]}),Ee.jsxs("form",{className:"login-form",onSubmit:y,children:[s&&Ee.jsxs("div",{className:"error-message",children:[Ee.jsx("span",{children:""}),s]}),Ee.jsxs("div",{className:"form-group",children:[Ee.jsx("label",{htmlFor:"username",children:"Tn ng nhp"}),Ee.jsx("input",{type:"text",id:"username",name:"username",value:e.username,onChange:f,placeholder:"Tn ng nhp",required:!0,disabled:n})]}),Ee.jsxs("div",{className:"form-group",children:[Ee.jsx("label",{htmlFor:"password",children:"Mt khu"}),Ee.jsx("input",{type:"password",id:"password",name:"password",value:e.password,onChange:f,placeholder:"",required:!0,disabled:n})]}),Ee.jsx("button",{type:"submit",className:"login-button",disabled:n,children:n?Ee.jsxs(Ee.Fragment,{children:[Ee.jsx("div",{className:"loading-spinner"}),"ang ng nhp..."]}):"ng nhp"})]}),Ee.jsxs("div",{className:"login-footer",children:[Ee.jsx("p",{children:" 2025 Tea Monitor - Phin bn demo"}),Ee.jsx("div",{className:"login-hint",children:Ee.jsx("span",{children:" Mo: Chn vai tr v bm nt demo  t ng in thng tin"})})]})]})})})}const Uxe=()=>{const[e,t]=I.useState({date:new Date().toISOString().split("T")[0],type:"tuoi",cost:0,plot:"",note:"",lat:"",long:""}),[n,i]=I.useState(null),s=b=>{const{name:C,value:P}=b.target;t(A=>({...A,[C]:C==="cost"?Number(P):P}))},d=b=>{b.target.files&&b.target.files[0]&&i(b.target.files[0])},f=async b=>{b.preventDefault();try{const C=new FormData;C.append("date",e.date),C.append("hanhdong",e.type),C.append("chiphi",e.cost.toString()),C.append("noidung",e.note),C.append("lat",e.lat),C.append("long",e.long),C.append("lo",e.plot),n&&C.append("nhatky",n);const P=await fetch("http://103.163.119.247:33612/nhatky",{method:"POST",body:C});if(!P.ok)throw new Error(`Upload failed: ${P.status}`);const A=await P.json();console.log("Response:",A),A.success&&(o(),alert("Lu nht k thnh cng!"))}catch(C){console.error("Error:",C),alert("Li khi lu nht k!")}},o=()=>{t({date:new Date().toISOString().split("T")[0],type:"tuoi",cost:0,plot:"",note:"",lat:"",long:""}),i(null);const b=document.querySelector('input[type="file"]');b&&(b.value="")},y=[{id:1,name:"PO1 - L PO1"},{id:2,name:"PO2 - L PO2"},{id:3,name:"PO3 - L PO3"},{id:4,name:"PO4 - L PO4"},{id:5,name:"PO5 - L PO5"},{id:6,name:"PO6 - L PO6"}];return Ee.jsxs("form",{id:"form-log",onSubmit:f,children:[Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Ngy thc hin"}),Ee.jsx("input",{type:"date",name:"date",value:e.date,onChange:s,required:!0})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Loi cng vic"}),Ee.jsxs("select",{name:"type",value:e.type,onChange:s,required:!0,children:[Ee.jsx("option",{value:"tuoi",children:"Ti"}),Ee.jsx("option",{value:"bon",children:"Bn phn"}),Ee.jsx("option",{value:"phun",children:"Phun thuc"}),Ee.jsx("option",{value:"thu-hai",children:"Thu hi"})]})]})]}),Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Chi ph (VN)"}),Ee.jsx("input",{type:"number",name:"cost",value:e.cost,onChange:s,min:"0",step:"1000",placeholder:"0"})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"L ch"}),Ee.jsxs("select",{name:"plot",value:e.plot,onChange:s,children:[Ee.jsx("option",{value:"",children:"Chn l"}),y.map(b=>Ee.jsxs("option",{value:b.id,children:[b.id,"  ",b.name]},b.id))]})]})]}),Ee.jsx("label",{children:"Ghi ch"}),Ee.jsx("textarea",{name:"note",value:e.note,onChange:s,placeholder:"M t chi tit cng vic...",id:"log-note",rows:3}),Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"V "}),Ee.jsx("input",{type:"text",name:"lat",value:e.lat,placeholder:"Nhp v ",onChange:s})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Kinh "}),Ee.jsx("input",{type:"text",name:"long",value:e.long,placeholder:"Nhp kinh ",onChange:s})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"nh hin trng"}),Ee.jsx("input",{type:"file",accept:"image/*",onChange:d}),n&&Ee.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:[" chn: ",n.name]})]})]}),Ee.jsxs("div",{className:"form-actions",children:[Ee.jsx("button",{className:"btn",type:"submit",children:"Lu nht k"}),Ee.jsx("button",{className:"btn ghost",type:"button",onClick:o,children:"Xa"})]})]})},Hxe=({activeTab:e})=>{const[t,n]=I.useState({type:"sau-benh",plot:"",desc:"",lat:"",long:"",status:"",level:""}),[i,s]=I.useState(null),d=C=>{const{name:P,value:A}=C.target;n(D=>({...D,[P]:A}))},f=C=>{C.target.files&&C.target.files[0]&&s(C.target.files[0])},o=async C=>{C.preventDefault();try{const P=new FormData;P.append("ngay",new Date().toISOString().split("T")[0]),P.append("lo",t.plot),P.append("long",t.long),P.append("lat",t.lat),P.append("mucdo",t.level),P.append("trangthai",t.status),P.append("mota",t.desc),i&&P.append("saubenh",i);const A=await fetch("http://103.163.119.247:33612/saubenh",{method:"POST",body:P});if(!A.ok)throw new Error("Upload failed");const D=await A.json();if(console.log("Response:",D),D.success){n({type:"sau-benh",plot:"",desc:"",lat:"",long:"",status:"",level:""}),s(null);const k=document.querySelector('input[type="file"]');k&&(k.value=""),alert("Gi bo co thnh cng!")}}catch(P){console.error("Error:",P),alert("Li khi gi bo co!")}},y=()=>{n({type:"sau-benh",plot:"",desc:"",lat:"",long:"",status:"",level:""}),s(null);const C=document.querySelector('input[type="file"]');C&&(C.value="")},b=[{id:1,name:"PO1 - L PO1"},{id:2,name:"PO2 - L PO2"},{id:3,name:"PO3 - L PO3"},{id:4,name:"PO4 - L PO4"},{id:5,name:"PO5 - L PO5"},{id:6,name:"PO6 - L PO6"}];return Ee.jsx("div",{id:"tab-report",className:`tab-content ${e==="report"?"active":""}`,children:Ee.jsxs("form",{id:"form-incident",onSubmit:o,children:[Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Loi s c"}),Ee.jsxs("select",{name:"type",value:t.type,onChange:d,required:!0,children:[Ee.jsx("option",{value:"sau-benh",children:"Su bnh"}),Ee.jsx("option",{value:"ung",children:"ng"}),Ee.jsx("option",{value:"han",children:"Hn"}),Ee.jsx("option",{value:"suong-muoi",children:"Sng mui"}),Ee.jsx("option",{value:"khac",children:"Khc"})]})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"L ch"}),Ee.jsxs("select",{name:"plot",value:t.plot,onChange:d,children:[Ee.jsx("option",{value:"",children:"Chn l"}),b.map(C=>Ee.jsxs("option",{value:C.id,children:[C.id,"  ",C.name]},C.id))]})]})]}),Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Trng thi"}),Ee.jsxs("select",{name:"status",value:t.status,onChange:d,children:[Ee.jsx("option",{value:"",children:"Chn trng thi"}),Ee.jsx("option",{value:"moi-phat-hien",children:"Mi pht hin"}),Ee.jsx("option",{value:"dang-xu-ly",children:"ang x l"}),Ee.jsx("option",{value:"da-xu-ly",children:" x l"})]})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Mc "}),Ee.jsxs("select",{name:"level",value:t.level,onChange:d,children:[Ee.jsx("option",{value:"",children:"Chn mc "}),Ee.jsx("option",{value:"nhe",children:"Nh"}),Ee.jsx("option",{value:"trung-binh",children:"Trung bnh"}),Ee.jsx("option",{value:"nang",children:"Nng"})]})]})]}),Ee.jsx("label",{children:"M t"}),Ee.jsx("textarea",{name:"desc",value:t.desc,onChange:d,placeholder:"Triu chng, mc ...",rows:3}),Ee.jsxs("div",{className:"row",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{children:"V "}),Ee.jsx("input",{type:"text",name:"lat",value:t.lat,placeholder:"Nhp v ",onChange:d})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"Kinh "}),Ee.jsx("input",{type:"text",name:"long",value:t.long,placeholder:"Nhp kinh ",onChange:d})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{children:"nh hin trng"}),Ee.jsx("input",{type:"file",accept:"image/*",onChange:f}),i&&Ee.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:[" chn: ",i.name]})]})]}),Ee.jsxs("div",{className:"form-actions",children:[Ee.jsx("button",{className:"btn",type:"submit",children:"Gi bo co"}),Ee.jsx("button",{className:"btn ghost",type:"button",onClick:y,children:"Xa"})]})]})})},Gxe=({activeTab:e})=>{const[t,n]=I.useState([]),[i,s]=I.useState([]);return Ee.jsxs("div",{id:"tab-advice",className:`tab-content ${e==="advice"?"active":""}`,children:[Ee.jsx("div",{className:"list",id:"advice-list",children:t.map((d,f)=>Ee.jsxs("div",{className:"item",children:[Ee.jsxs("h4",{children:[" ",d.title,"  ",d.time]}),Ee.jsxs("p",{children:["L: ",d.plot,"  ",d.note]})]},f))}),Ee.jsx("hr",{}),Ee.jsx("div",{className:"list",id:"weather-list",children:i.map((d,f)=>Ee.jsxs("div",{className:"item",children:[Ee.jsxs("h4",{children:[" ",d.day]}),Ee.jsxs("p",{children:["Tmin/Tmax: ",d.tmin,"",d.tmax,"C  Ma: ",d.rain,"mm  RH: ",d.rh,"%  GDD: ",d.gdd,"  ETo: ",d.eto]})]},f))})]})};al.accessToken="pk.eyJ1IjoibmdvY3R0ZCIsImEiOiJjbWJibmlod3MwMmluMnFyMG1xMWt0dTdrIn0.ok5SgmXGrHFLeMPf-OG5_w";const PP={type:"FeatureCollection",features:[{type:"Feature",properties:{id:"P01",name:"L P01",area:.8,ndvi:.72},geometry:{type:"Polygon",coordinates:[[[105.94,20.26],[105.943,20.26],[105.943,20.258],[105.94,20.258],[105.94,20.26]]]}},{type:"Feature",properties:{id:"P02",name:"L P02",area:1.1,ndvi:.61},geometry:{type:"Polygon",coordinates:[[[105.952,20.255],[105.956,20.255],[105.956,20.252],[105.952,20.252],[105.952,20.255]]]}},{type:"Feature",properties:{id:"P03",name:"L P03",area:.6,ndvi:.45},geometry:{type:"Polygon",coordinates:[[[105.962,20.262],[105.966,20.262],[105.966,20.259],[105.962,20.259],[105.962,20.262]]]}}]},Wxe=()=>{const e={type:"FeatureCollection",features:[]},t=105.935,n=20.248,i=8,s=7,d=.0045,f=.0045;for(let o=0;o<s;o++)for(let y=0;y<i;y++){const b=t+y*d,C=n+o*f,P=b+d,A=C+f,D=+(.35+Math.random()*.45).toFixed(2);e.features.push({type:"Feature",properties:{ndvi:D},geometry:{type:"Polygon",coordinates:[[[b,C],[P,C],[P,A],[b,A],[b,C]]]}})}return e},qxe={type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Khuyn co ti nh",level:"info",msg:"Duy tr 57 mm/ngy trong 3 ngy ti."},geometry:{type:"Point",coordinates:[105.948,20.256]}}]},Kxe={type:"FeatureCollection",features:[{type:"Feature",properties:{type:"sau-benh",desc:"Pht hin b xt nh, l chm vng",plot:"P02"},geometry:{type:"Point",coordinates:[105.954,20.2535]}}]},Xxe=e=>({tuoi:"Ti",bon:"Bn phn",phun:"Phun thuc","thu-hai":"Thu hi"})[e]||e,MP=e=>e.toLocaleString("vi-VN");function Zxe(){var te,ne,se;const e=I.useRef(null),t=I.useRef(null),[n,i]=I.useState("log"),[s,d]=I.useState({plots:!0,ndvi:!0,alerts:!0,incidents:!0}),[f,o]=I.useState(""),[y,b]=I.useState({ndvi:"",rain:"",gdd:""}),[C,P]=I.useState([]),[A,D]=I.useState({}),[k,B]=I.useState({logs:[],incidents:[],costTotal:0});I.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(ee=>{const{latitude:de,longitude:fe}=ee.coords,ye=`${fe.toFixed(5)}, ${de.toFixed(5)}`;setLogForm(ge=>({...ge,gps:ye})),setIncidentForm(ge=>({...ge,gps:ye}))})},[]),I.useEffect(()=>{const ee=new al.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v12",center:[105.95,20.25],zoom:11});return e.current=ee,ee.addControl(new al.NavigationControl({visualizePitch:!0}),"bottom-right"),ee.addControl(new al.ScaleControl({maxWidth:120,unit:"metric"}),"bottom-left"),ee.on("load",()=>{const de=Wxe();ee.addSource("plots",{type:"geojson",data:PP}),ee.addSource("ndvi",{type:"geojson",data:de}),ee.addSource("advisories",{type:"geojson",data:qxe}),ee.addSource("incidents",{type:"geojson",data:Kxe}),ee.addLayer({id:"plots-fill",type:"fill",source:"plots",paint:{"fill-color":["interpolate",["linear"],["get","ndvi"],.3,"#fef3c7",.5,"#a7f3d0",.7,"#34d399"],"fill-opacity":.6}}),ee.addLayer({id:"plots-line",type:"line",source:"plots",paint:{"line-color":"#065f46","line-width":1.2}}),ee.addLayer({id:"ndvi-fill",type:"fill",source:"ndvi",paint:{"fill-color":["interpolate",["linear"],["get","ndvi"],.3,"#fee2e2",.45,"#fde68a",.6,"#86efac",.75,"#22c55e"],"fill-opacity":.35}}),ee.addLayer({id:"advisories-sym",type:"symbol",source:"advisories",layout:{"icon-image":"marker-15","icon-size":1.2,"text-field":["get","title"],"text-size":12,"text-offset":[0,1.2],"text-anchor":"top"},paint:{"text-color":"#1f2937"}}),ee.addLayer({id:"incidents-sym",type:"symbol",source:"incidents",layout:{"icon-image":"marker-15","icon-size":1.2,"text-field":["get","type"],"text-size":12,"text-offset":[0,1.2],"text-anchor":"top"},paint:{"text-color":"#991b1b"}}),ee.on("click","plots-fill",ge=>{const we=ge.features[0],{id:Se,name:xe,area:Te,ndvi:ze}=we.properties,Ue=`
          <strong>${xe}</strong><br/>
          M: ${Se}  Din tch: ${Te} ha<br/>
          NDVI hin ti: <b>${ze}</b><br/>
          <button id="btn-log-${Se}" class="map-popup-btn">Ghi nht k</button>
        `;new al.Popup().setLngLat(ge.lngLat).setHTML(Ue).addTo(ee),b(We=>({...We,ndvi:ze})),o(Se),setLogForm(We=>({...We,plot:Se})),setIncidentForm(We=>({...We,plot:Se})),setTimeout(()=>{const We=document.getElementById(`btn-log-${Se}`);We&&(We.onclick=()=>{var Be;i("log"),(Be=document.getElementById("log-note"))==null||Be.focus()})},50)});const fe=PP.features.flatMap(ge=>ge.geometry.coordinates[0]),ye=fe.reduce((ge,we)=>ge.extend(we),new al.LngLatBounds(fe[0],fe[0]));ee.fitBounds(ye,{padding:60})}),()=>ee.remove()},[]),I.useEffect(()=>{const ee=e.current;if(!ee||!ee.isStyleLoaded())return;const de=fe=>fe?"visible":"none";ee.setLayoutProperty("plots-line","visibility",de(s.plots)),ee.setLayoutProperty("plots-fill","visibility",de(s.plots)),ee.setLayoutProperty("ndvi-fill","visibility",de(s.ndvi)),ee.setLayoutProperty("advisories-sym","visibility",de(s.alerts)),ee.setLayoutProperty("incidents-sym","visibility",de(s.incidents))},[s]);const N=ee=>{d(de=>({...de,[ee]:!de[ee]}))},j=PP.features.reduce((ee,de)=>ee+(de.properties.area||0),0),V=j?Math.round(k.costTotal/j):0,[K,Y]=I.useState(""),Z=async()=>{try{const ee=await fetch("https://api.openweathermap.org/data/2.5/weather?q=Hanoi&appid=723262eea804eb2695383fc4d482da35");if(!ee.ok)throw new Error(`HTTP error! status: ${ee.status}`);const de=await ee.json();console.log("data",de),D(de)}catch(ee){console.log("Error:",ee)}};return I.useEffect(()=>{Z()},[]),Ee.jsxs("div",{className:"farmer-app",children:[Ee.jsxs("header",{children:[Ee.jsxs("div",{className:"brand",children:[Ee.jsx("div",{className:"logo","aria-hidden":"true"}),Ee.jsx("h1",{children:"Gim st ch  Giao din Nng h"})]}),Ee.jsxs("div",{className:"actions",children:[Ee.jsxs("span",{className:"pill",children:[" Thi tit:"," ",Ee.jsxs("strong",{children:[wW((te=A==null?void 0:A.main)==null?void 0:te.temp),"C"]})]}),Ee.jsxs("span",{className:"pill",children:[" ",Ee.jsx("span",{children:k.incidents.length})]}),Ee.jsx("span",{className:"pill",children:(se=(ne=JSON.parse(localStorage.getItem("user")))==null?void 0:ne.data)==null?void 0:se.ten})]})]}),Ee.jsxs(Yue,{gutter:16,className:"layout",children:[Ee.jsxs(x$,{span:14,className:"map-container",children:[Ee.jsx("div",{ref:t,id:"map"}),Ee.jsxs("div",{className:"controls",children:[Ee.jsxs("div",{className:"control",children:[Ee.jsx("h3",{children:"Lp d liu"}),Ee.jsxs("label",{children:[Ee.jsx("input",{type:"checkbox",checked:s.plots,onChange:()=>N("plots")}),"L ch ca ti"]}),Ee.jsxs("label",{children:[Ee.jsx("input",{type:"checkbox",checked:s.ndvi,onChange:()=>N("ndvi")}),"NDVI (gi lp)"]}),Ee.jsxs("label",{children:[Ee.jsx("input",{type:"checkbox",checked:s.alerts,onChange:()=>N("alerts")}),"Khuyn co"]}),Ee.jsxs("label",{children:[Ee.jsx("input",{type:"checkbox",checked:s.incidents,onChange:()=>N("incidents")}),"S c hin trng"]})]}),Ee.jsxs("div",{className:"control",children:[Ee.jsx("h3",{children:"Thng tin nhanh l"}),Ee.jsxs("div",{className:"kpi",children:[Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"NDVI"}),Ee.jsx("div",{className:"val",children:y.ndvi})]}),Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"Ma (mm)"}),Ee.jsx("div",{className:"val",children:y.rain})]}),Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"GDD"}),Ee.jsx("div",{className:"val",children:y.gdd})]})]})]})]})]}),Ee.jsxs(x$,{span:10,className:"sidebar",children:[Ee.jsxs("div",{className:"card",children:[Ee.jsx("div",{className:"tabs",role:"tablist",children:[{id:"log",label:" Nht k"},{id:"advice",label:" Khuyn co & Thi tit"},{id:"report",label:" Bo co hin trng"},{id:"stats",label:" Chi ph & Thng k"}].map(ee=>Ee.jsx("div",{className:`tab ${n===ee.id?"active":""}`,onClick:()=>i(ee.id),role:"tab",children:ee.label},ee.id))}),Ee.jsxs("div",{id:"tab-log",className:`tab-content ${n==="log"?"active":""}`,children:[Ee.jsx(Uxe,{}),Ee.jsx("hr",{}),Ee.jsx("div",{className:"list",id:"log-list",children:k.logs.map(ee=>Ee.jsxs("div",{className:"item",children:[Ee.jsxs("h4",{children:[ee.date,"  ",Xxe(ee.type),"  L ",ee.plot]}),Ee.jsx("p",{children:ee.note||""}),Ee.jsxs("p",{children:["Chi ph: ",MP(parseInt(ee.cost)||0),"  GPS:"," ",ee.gps||""]})]},ee.id))})]}),Ee.jsx(Gxe,{activeTab:n}),Ee.jsx(Hxe,{activeTab:n}),Ee.jsxs("div",{id:"tab-stats",className:`tab-content ${n==="stats"?"active":""}`,children:[Ee.jsxs("div",{className:"kpi",children:[Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"Tng chi ph"}),Ee.jsx("div",{className:"val",children:MP(k.costTotal)})]}),Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"S nht k"}),Ee.jsx("div",{className:"val",children:k.logs.length})]}),Ee.jsxs("div",{className:"metric",children:[Ee.jsx("h5",{children:"Chi ph/ha"}),Ee.jsx("div",{className:"val",children:MP(V)})]})]}),Ee.jsx("div",{className:"chart-note",children:"(Biu  ch minh ha, kt ni backend s v ng)"})]})]}),Ee.jsx("footer",{children:" 2025  Nn tng gim st sinh trng ch (giao din mu nng h)"})]})]})]})}function Yxe(){var i;const[e,t]=I.useState(null);I.useEffect(()=>{const s=localStorage.getItem("user");s&&t(JSON.parse(s))},[]);const n=(i=JSON.parse(localStorage.getItem("user")))==null?void 0:i.data;return Ee.jsx("div",{className:"app",children:Ee.jsx("main",{className:"main-content",children:Ee.jsxs(EY,{children:[Ee.jsx(Tp,{path:"/login",element:Ee.jsx(Vxe,{})}),(n==null?void 0:n.role)==="NGUOIDUNG"&&Ee.jsx(Tp,{path:"/farmer",element:Ee.jsx(Zxe,{})}),(n==null?void 0:n.role)==="ADMIN"&&Ee.jsx(Tp,{path:"/manager",element:Ee.jsx(jxe,{})}),(n==null?void 0:n.role)==="NGHIENCUU"&&Ee.jsx(Tp,{path:"/researcher",element:Ee.jsx(LY,{})}),Ee.jsx(Tp,{path:"/",element:n?n.role==="NGUOIDUNG"?Ee.jsx(Su,{to:"/farmer"}):n.role==="ADMIN"?Ee.jsx(Su,{to:"/researcher"}):n.role==="QUANLY"?Ee.jsx(Su,{to:"/manager"}):Ee.jsx(Su,{to:"/login"}):Ee.jsx(Su,{to:"/login"})}),Ee.jsx(Tp,{path:"*",element:n?n.role==="NGUOIDUNG"?Ee.jsx(Su,{to:"/farmer"}):n.role==="ADMIN"?Ee.jsx(Su,{to:"/researcher"}):n.role==="QUANLY"?Ee.jsx(Su,{to:"/manager"}):Ee.jsx(Su,{to:"/login"}):Ee.jsx(Su,{to:"/login"})})]})})})}s6(document.getElementById("root")).render(Ee.jsx(Wt.StrictMode,{children:Ee.jsx(PY,{children:Ee.jsx(Yxe,{})})}));
